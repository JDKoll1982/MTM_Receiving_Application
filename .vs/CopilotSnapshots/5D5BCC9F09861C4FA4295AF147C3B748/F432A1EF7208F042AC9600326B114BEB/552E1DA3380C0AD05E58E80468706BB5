using System;
using MTM_Receiving_Application.Module_Core.Models.Enums;

namespace MTM_Receiving_Application.Module_Core.Models.Core;

/// <summary>
/// Factory for creating Model_Dao_Result instances to avoid self-referencing cycles in model classes.
/// </summary>
public static class Model_Dao_Result_Factory
{
    public static Model_Dao_Result Failure(string message, Exception? ex = null)
    {
        if (string.IsNullOrWhiteSpace(message))
        {
            throw new ArgumentException("Failure message cannot be null or whitespace.", nameof(message));
        }

        return new Model_Dao_Result
        {
            Success = false,
            ErrorMessage = message,
            Exception = ex,
            Severity = Enum_ErrorSeverity.Error
        };
    }

    public static Model_Dao_Result Success(int affectedRows = 0)
    {
        if (affectedRows < 0)
        {
            throw new ArgumentOutOfRangeException(nameof(affectedRows), affectedRows, "Affected rows cannot be negative.");
        }

        return new Model_Dao_Result
        {
            Success = true,
            AffectedRows = affectedRows,
            ErrorMessage = string.Empty
        };
    }

    public static Model_Dao_Result<T> Failure<T>(string message, Exception? ex = null)
    {
        if (string.IsNullOrWhiteSpace(message))
        {
            throw new ArgumentException("Failure message cannot be null or whitespace.", nameof(message));
        }

        return new Model_Dao_Result<T>
        {
            Success = false,
            ErrorMessage = message,
            Exception = ex,
            Severity = Enum_ErrorSeverity.Error
        };
    }

    public static Model_Dao_Result<T> Success<T>(T data, int affectedRows = 0)
    {
        if (affectedRows < 0)
        {
            throw new ArgumentOutOfRangeException(nameof(affectedRows), affectedRows, "Affected rows cannot be negative.");
        }

        return new Model_Dao_Result<T>
        {
            Success = true,
            Data = data,
            AffectedRows = affectedRows,
            ErrorMessage = string.Empty
        };
    }
}

