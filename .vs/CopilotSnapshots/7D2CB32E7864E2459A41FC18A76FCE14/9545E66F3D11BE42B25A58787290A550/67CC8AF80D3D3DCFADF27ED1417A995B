using MTM_Receiving_Application.Module_Core.Converters;

namespace MTM_Receiving_Application.Tests.Module_Core.Converters;

/// <summary>
/// Unit tests for <see cref="Converter_BoolToString"/>.
/// Tests conversion of boolean values to custom string representations using pipe-delimited parameter.
/// Format: "TrueString|FalseString"
/// </summary>
[Trait("Category", "Unit")]
[Trait("Type", "Converter")]
public class Converter_BoolToString_Tests
{
    private readonly Converter_BoolToString _sut;

    public Converter_BoolToString_Tests()
    {
        _sut = new();
    }

    [Theory]
    [InlineData(true, "Yes|No", "Yes")]
    [InlineData(false, "Yes|No", "No")]
    [InlineData(true, "Active|Inactive", "Active")]
    [InlineData(false, "Active|Inactive", "Inactive")]
    [InlineData(true, "✓|✗", "✓")]
    [InlineData(false, "✓|✗", "✗")]
    public void Convert_WithBooleanAndValidParameter_ReturnsCorrectString(bool input, string parameter, string expected)
    {
        // Act
        var result = _sut.Convert(input, typeof(string), parameter, "en-US");

        // Assert
        result.Should().Be(expected);
    }

    [Fact]
    public void Convert_WithNullValue_ReturnsEmptyString()
    {
        // Act
        var result = _sut.Convert(null, typeof(string), "Yes|No", "en-US");

        // Assert
        result.Should().Be(string.Empty);
    }

    [Theory]
    [InlineData(true, null)]
    [InlineData(false, null)]
    public void Convert_WithNullParameter_ReturnsBooleanToString(bool input, object? parameter)
    {
        // Act
        var result = _sut.Convert(input, typeof(string), parameter, "en-US");

        // Assert
        result.Should().Be(input.ToString());
    }

    [Theory]
    [InlineData(true, "OnlyOneValue")]
    [InlineData(false, "OnlyOneValue")]
    public void Convert_WithInvalidParameter_ReturnsBooleanToString(bool input, string parameter)
    {
        // Act
        var result = _sut.Convert(input, typeof(string), parameter, "en-US");

        // Assert
        result.Should().Be(input.ToString());
    }

    [Theory]
    [InlineData("true", "Yes|No")]
    [InlineData(1, "Yes|No")]
    public void Convert_WithNonBooleanValue_ReturnsValueToString(object input, string parameter)
    {
        // Act
        var result = _sut.Convert(input, typeof(string), parameter, "en-US");

        // Assert
        result.Should().Be(input.ToString());
    }

    [Theory]
    [InlineData(true, "Yes|No|Maybe")]
    [InlineData(false, "Yes|No|Maybe")]
    public void Convert_WithMoreThanTwoParts_ReturnsOriginalBooleanString(bool input, string parameter)
    {
        // Act
        var result = _sut.Convert(input, typeof(string), parameter, "en-US");

        // Assert
        result.Should().Be(input.ToString());
    }

    [Fact]
    public void ConvertBack_ThrowsNotImplementedException()
    {
        // Act
        Action act = () => _sut.ConvertBack("Yes", typeof(bool), "Yes|No", "en-US");

        // Assert
        act.Should().Throw<NotImplementedException>();
    }
}
