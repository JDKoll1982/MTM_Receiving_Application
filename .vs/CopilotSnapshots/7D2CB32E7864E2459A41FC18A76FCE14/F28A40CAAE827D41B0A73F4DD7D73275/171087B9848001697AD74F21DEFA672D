using MTM_Receiving_Application.Module_Core.Converters;

namespace MTM_Receiving_Application.Tests.Module_Core.Converters;

/// <summary>
/// Unit tests for <see cref="Converter_LoadNumberToOneBased"/>.
/// Tests bidirectional conversion between zero-based (internal) and one-based (display) load numbers.
/// </summary>
[Trait("Category", "Unit")]
[Trait("Type", "Converter")]
public class Converter_LoadNumberToOneBased_Tests
{
    private readonly Converter_LoadNumberToOneBased _sut;

    public Converter_LoadNumberToOneBased_Tests()
    {
        _sut = new();
    }

    [Theory]
    [InlineData(0, 1)]
    [InlineData(1, 2)]
    [InlineData(5, 6)]
    [InlineData(10, 11)]
    [InlineData(99, 100)]
    public void Convert_WithIntegerValue_ReturnsOneBasedValue(int input, int expected)
    {
        // Act
        var result = _sut.Convert(input, typeof(int), null, "en-US");

        // Assert
        result.Should().Be(expected);
    }

    [Theory]
    [InlineData(null)]
    [InlineData("text")]
    [InlineData(3.14)]
    [InlineData(true)]
    public void Convert_WithNonIntegerValue_ReturnsValueAsIs(object? input)
    {
        // Act
        var result = _sut.Convert(input, typeof(int), null, "en-US");

        // Assert
        result.Should().Be(input);
    }

    [Theory]
    [InlineData("1", 0)]
    [InlineData("2", 1)]
    [InlineData("6", 5)]
    [InlineData("11", 10)]
    [InlineData("100", 99)]
    public void ConvertBack_WithValidStringValue_ReturnsZeroBasedValue(string input, int expected)
    {
        // Act
        var result = _sut.ConvertBack(input, typeof(int), null, "en-US");

        // Assert
        result.Should().Be(expected);
    }

    [Theory]
    [InlineData("")]
    [InlineData("abc")]
    [InlineData("12.34")]
    public void ConvertBack_WithInvalidString_ReturnsValueAsIs(string input)
    {
        // Act
        var result = _sut.ConvertBack(input, typeof(int), null, "en-US");

        // Assert
        result.Should().Be(input);
    }

    [Theory]
    [InlineData(null)]
    [InlineData(42)]
    [InlineData(true)]
    public void ConvertBack_WithNonStringValue_ReturnsValueAsIs(object? input)
    {
        // Act
        var result = _sut.ConvertBack(input, typeof(int), null, "en-US");

        // Assert
        result.Should().Be(input);
    }

    [Theory]
    [InlineData(0)]
    [InlineData(1)]
    [InlineData(5)]
    [InlineData(10)]
    [InlineData(99)]
    public void Convert_RoundTrip_PreservesValue(int originalValue)
    {
        // Act - Convert to one-based
        var oneBasedResult = _sut.Convert(originalValue, typeof(int), null, "en-US");

        // Act - Convert back to zero-based
        var zeroBasedResult = _sut.ConvertBack(oneBasedResult.ToString(), typeof(int), null, "en-US");

        // Assert
        zeroBasedResult.Should().Be(originalValue);
    }

    [Fact]
    public void Convert_WithNegativeValue_ReturnsNegativeOneBased()
    {
        // Act
        var result = _sut.Convert(-5, typeof(int), null, "en-US");

        // Assert
        result.Should().Be(-4);
    }

    [Fact]
    public void ConvertBack_WithZeroString_ReturnsNegativeOne()
    {
        // Act
        var result = _sut.ConvertBack("0", typeof(int), null, "en-US");

        // Assert
        result.Should().Be(-1);
    }
}
