<UserControl
    x:Class="MTM_Receiving_Application.Module_Settings.Views.View_Settings_Template"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:icons="using:Material.Icons.WinUI3"
    xmlns:converters="using:MTM_Receiving_Application.Module_Core.Converters"
    mc:Ignorable="d">

    <UserControl.Resources>
        <!-- Converters -->
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:InverseBoolConverter x:Key="InverseBoolConverter"/>
        
        <!-- Card Style -->
        <Style x:Key="SettingsCardStyle" TargetType="Grid">
            <Setter Property="Background" Value="{ThemeResource CardBackgroundFillColorDefaultBrush}"/>
            <Setter Property="BorderBrush" Value="{ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <!-- Section Header Style -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <!-- Setting Item Style -->
        <Style x:Key="SettingItemStyle" TargetType="Grid">
            <Setter Property="Padding" Value="0,8"/>
            <Setter Property="BorderBrush" Value="{ThemeResource DividerStrokeColorDefaultBrush}"/>
        </Style>

        <!-- Setting Label Style -->
        <Style x:Key="SettingLabelStyle" TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <!-- Setting Description Style -->
        <Style x:Key="SettingDescriptionStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="{ThemeResource TextFillColorSecondaryBrush}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,2,0,0"/>
        </Style>

        <!-- Validation Error Style -->
        <Style x:Key="ValidationErrorStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="{ThemeResource SystemFillColorCriticalBrush}"/>
            <Setter Property="Margin" Value="0,4,0,0"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Padding="24" Spacing="16" MaxWidth="1200">
                
                <!-- Header with Back Button -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" 
                            Command="{x:Bind ViewModel.BackCommand}"
                            Style="{StaticResource AccentButtonStyle}"
                            VerticalAlignment="Center">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <icons:MaterialIcon Kind="ArrowLeft" Width="16" Height="16"/>
                            <TextBlock Text="Back"/>
                        </StackPanel>
                    </Button>

                    <StackPanel Grid.Column="1" 
                                Orientation="Horizontal" 
                                Spacing="12" 
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                        <icons:MaterialIcon Kind="{x:Bind ViewModel.CategoryIcon, Mode=OneWay}" 
                                          Width="28" Height="28" 
                                          Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                        <TextBlock Text="{x:Bind ViewModel.CategoryTitle, Mode=OneWay}" 
                                   Style="{StaticResource TitleTextBlockStyle}"/>
                    </StackPanel>

                    <!-- Save Status Indicator -->
                    <StackPanel Grid.Column="2" 
                                Orientation="Horizontal" 
                                Spacing="8"
                                VerticalAlignment="Center"
                                Visibility="{x:Bind ViewModel.IsSaving, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                        <ProgressRing IsActive="True" Width="16" Height="16"/>
                        <TextBlock Text="Saving..." 
                                   FontSize="12" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </Grid>

                <!-- Search/Filter Box -->
                <Grid Style="{StaticResource SettingsCardStyle}">
                    <TextBox PlaceholderText="Search settings..." 
                             Text="{x:Bind ViewModel.SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <TextBox.Resources>
                            <SolidColorBrush x:Key="TextControlBorderBrush" Color="Transparent"/>
                        </TextBox.Resources>
                    </TextBox>
                </Grid>

                <!-- SECTION 1: Example Category -->
                <Grid Style="{StaticResource SettingsCardStyle}">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Category Name" Style="{StaticResource SectionHeaderStyle}"/>

                        <!-- Setting Item: Text Input -->
                        <Grid Style="{StaticResource SettingItemStyle}" BorderThickness="0,0,0,1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Setting Name" Style="{StaticResource SettingLabelStyle}"/>
                                    <Button Background="Transparent" 
                                            BorderThickness="0" 
                                            Padding="4"
                                            ToolTipService.ToolTip="This is a helpful description of what this setting does and how it affects the application.">
                                        <icons:MaterialIcon Kind="InformationOutline" 
                                                          Width="16" Height="16"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="Brief description of setting" 
                                           Style="{StaticResource SettingDescriptionStyle}"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Spacing="4">
                                <TextBox PlaceholderText="Enter value..."
                                         Text="{x:Bind ViewModel.SampleTextSetting, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         IsEnabled="{x:Bind ViewModel.IsSettingLocked, Mode=OneWay, Converter={StaticResource InverseBoolConverter}}"/>
                                
                                <!-- Validation Error (conditionally visible) -->
                                <TextBlock Text="Validation error message"
                                           Style="{StaticResource ValidationErrorStyle}"
                                           Visibility="Collapsed"/>
                            </StackPanel>
                        </Grid>

                        <!-- Setting Item: Number Input -->
                        <Grid Style="{StaticResource SettingItemStyle}" BorderThickness="0,0,0,1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Numeric Setting" Style="{StaticResource SettingLabelStyle}"/>
                                    <Button Background="Transparent" 
                                            BorderThickness="0" 
                                            Padding="4"
                                            ToolTipService.ToolTip="Range: 1-100. Controls how many items to display.">
                                        <icons:MaterialIcon Kind="InformationOutline" 
                                                          Width="16" Height="16"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="Valid range: 1-100" 
                                           Style="{StaticResource SettingDescriptionStyle}"/>
                            </StackPanel>

                            <NumberBox Grid.Column="1"
                                       Value="{x:Bind ViewModel.SampleNumberSetting, Mode=TwoWay}"
                                       Minimum="1"
                                       Maximum="100"
                                       SpinButtonPlacementMode="Inline"/>
                        </Grid>

                        <!-- Setting Item: Toggle Switch -->
                        <Grid Style="{StaticResource SettingItemStyle}" BorderThickness="0,0,0,1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Enable Feature" Style="{StaticResource SettingLabelStyle}"/>
                                    <Button Background="Transparent" 
                                            BorderThickness="0" 
                                            Padding="4"
                                            ToolTipService.ToolTip="Enable or disable this feature">
                                        <icons:MaterialIcon Kind="InformationOutline" 
                                                          Width="16" Height="16"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="Toggle to enable/disable" 
                                           Style="{StaticResource SettingDescriptionStyle}"/>
                            </StackPanel>

                            <ToggleSwitch Grid.Column="1"
                                          IsOn="{x:Bind ViewModel.SampleToggleSetting, Mode=TwoWay}"
                                          OnContent="Enabled"
                                          OffContent="Disabled"/>
                        </Grid>

                        <!-- Setting Item: ComboBox -->
                        <Grid Style="{StaticResource SettingItemStyle}" BorderThickness="0,0,0,1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Selection Setting" Style="{StaticResource SettingLabelStyle}"/>
                                    <Button Background="Transparent" 
                                            BorderThickness="0" 
                                            Padding="4"
                                            ToolTipService.ToolTip="Choose from available options">
                                        <icons:MaterialIcon Kind="InformationOutline" 
                                                          Width="16" Height="16"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="Select an option" 
                                           Style="{StaticResource SettingDescriptionStyle}"/>
                            </StackPanel>

                            <ComboBox Grid.Column="1"
                                      ItemsSource="{x:Bind ViewModel.SampleOptions, Mode=OneWay}"
                                      SelectedItem="{x:Bind ViewModel.SelectedOption, Mode=TwoWay}"
                                      HorizontalAlignment="Stretch"/>
                        </Grid>

                        <!-- Setting Item: File/Folder Picker -->
                        <Grid Style="{StaticResource SettingItemStyle}" BorderThickness="0,0,0,1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="File Path" Style="{StaticResource SettingLabelStyle}"/>
                                    <Button Background="Transparent" 
                                            BorderThickness="0" 
                                            Padding="4"
                                            ToolTipService.ToolTip="Select folder path for exports">
                                        <icons:MaterialIcon Kind="InformationOutline" 
                                                          Width="16" Height="16"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="Path to export folder" 
                                           Style="{StaticResource SettingDescriptionStyle}"/>
                            </StackPanel>

                            <Grid Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBox Grid.Column="0"
                                         Text="{x:Bind ViewModel.SamplePathSetting, Mode=TwoWay}"
                                         PlaceholderText="C:\Path\To\Folder"
                                         Margin="0,0,8,0"/>

                                <Button Grid.Column="1"
                                        Command="{x:Bind ViewModel.BrowseFolderCommand}"
                                        Margin="0,0,8,0">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <icons:MaterialIcon Kind="FolderOpen" Width="16" Height="16"/>
                                        <TextBlock Text="Browse"/>
                                    </StackPanel>
                                </Button>

                                <Button Grid.Column="2"
                                        Command="{x:Bind ViewModel.TestConnectionCommand}"
                                        ToolTipService.ToolTip="Test if path is accessible">
                                    <icons:MaterialIcon Kind="CheckCircleOutline" Width="16" Height="16"/>
                                </Button>
                            </Grid>
                        </Grid>

                        <!-- Setting Item: Password (Sensitive) -->
                        <Grid Style="{StaticResource SettingItemStyle}" BorderThickness="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Password" Style="{StaticResource SettingLabelStyle}"/>
                                    <Button Background="Transparent" 
                                            BorderThickness="0" 
                                            Padding="4"
                                            ToolTipService.ToolTip="Enter secure password">
                                        <icons:MaterialIcon Kind="InformationOutline" 
                                                          Width="16" Height="16"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    </Button>
                                </StackPanel>
                                <TextBlock Text="Stored securely" 
                                           Style="{StaticResource SettingDescriptionStyle}"/>
                            </StackPanel>

                            <PasswordBox Grid.Column="1"
                                         Password="{x:Bind ViewModel.SamplePasswordSetting, Mode=TwoWay}"
                                         PlaceholderText="Enter password..."
                                         PasswordRevealMode="Peek"/>
                        </Grid>
                    </StackPanel>
                </Grid>

                <!-- SECTION 2: Actions -->
                <Grid Style="{StaticResource SettingsCardStyle}">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Actions" Style="{StaticResource SectionHeaderStyle}"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" 
                                       Text="Reset all settings in this category to default values"
                                       VerticalAlignment="Center"/>

                            <Button Grid.Column="1"
                                    Command="{x:Bind ViewModel.ResetToDefaultsCommand}"
                                    Style="{StaticResource AccentButtonStyle}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <icons:MaterialIcon Kind="Restore" Width="16" Height="16"/>
                                    <TextBlock Text="Restore Defaults"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </StackPanel>
                </Grid>

                <!-- Bottom Spacing -->
                <Border Height="24"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Overlay: Locked Settings Message -->
        <Grid Background="{ThemeResource SmokeFillColorDefaultBrush}"
              Visibility="{x:Bind ViewModel.ShowLockedMessage, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="24"
                    MaxWidth="400"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                <StackPanel Spacing="16">
                    <icons:MaterialIcon Kind="Lock" Width="48" Height="48" 
                                      Foreground="{ThemeResource SystemFillColorCriticalBrush}"
                                      HorizontalAlignment="Center"/>
                    <TextBlock Text="Settings Locked" 
                               Style="{StaticResource SubtitleTextBlockStyle}"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="These settings have been locked by your administrator. Contact your IT department to make changes."
                               TextWrapping="Wrap"
                               TextAlignment="Center"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    <Button Content="Close" 
                            Command="{x:Bind ViewModel.CloseLockedMessageCommand}"
                            HorizontalAlignment="Center"
                            Style="{StaticResource AccentButtonStyle}"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>
