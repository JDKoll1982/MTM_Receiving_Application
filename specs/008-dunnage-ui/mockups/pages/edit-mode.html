<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Mode</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/winui-theme.css">
</head>

<body>
    <div class="wizard-container">
        <div class="wizard-step">
            <!-- InfoBar for status messages -->
            <div class="infobar infobar-info margin-bottom-lg">
                <span class="infobar-icon">‚ÑπÔ∏è</span>
                <span>Workflow cleared. Please select a mode.</span>
            </div>

            <div class="flex flex-between margin-bottom-lg">
                <h2 class="subtitle-text">Edit Mode</h2>
                <button class="button button-accent" onclick="goBackToModeSelection()">Mode Selection</button>
            </div>

            <!-- Load Data From Toolbar -->
            <div class="card margin-bottom-lg">
                <h3 class="body-strong margin-bottom-md">Load Data From:</h3>
                <div class="flex spacing-md" style="flex-wrap: wrap;">
                    <button class="button" onclick="loadFromMemory()">üìÅ Current Memory</button>
                    <button class="button" onclick="loadFromLabels()">üè∑Ô∏è Current Labels</button>
                    <button class="button" onclick="loadFromHistory()">üìú History</button>
                </div>
            </div>

            <!-- Search and Filter Controls -->
            <div class="card margin-bottom-lg">
                <h3 class="body-strong margin-bottom-md">Search & Filter</h3>
                <div class="flex spacing-md" style="flex-wrap: wrap;">
                    <div class="form-group" style="flex: 1; min-width: 200px; margin-bottom: 0;">
                        <label class="form-label">Search</label>
                        <input type="text" class="textbox" id="searchInput"
                            placeholder="Search by Part ID, PO, Location..." oninput="filterRecords()">
                    </div>

                    <div class="form-group" style="flex: 0 0 180px; margin-bottom: 0;">
                        <label class="form-label">Type Filter</label>
                        <div class="combobox">
                            <select id="typeFilter" onchange="filterRecords()">
                                <option value="">All Types</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group" style="flex: 0 0 180px; margin-bottom: 0;">
                        <label class="form-label">Date Range</label>
                        <div class="combobox">
                            <select id="dateFilter" onchange="filterRecords()">
                                <option value="all">All Time</option>
                                <option value="today">Today</option>
                                <option value="week">This Week</option>
                                <option value="month">This Month</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group" style="flex: 0 0 100px; margin-bottom: 0;">
                        <label class="form-label">&nbsp;</label>
                        <button class="button" onclick="clearFilters()" style="width: 100%;">Clear</button>
                    </div>
                </div>
            </div>

            <!-- Results Info -->
            <div class="flex flex-between margin-bottom-md">
                <div class="body-text text-secondary">
                    Showing <span id="resultCount">0</span> of <span id="totalCount">0</span> records
                </div>
                <div class="flex spacing-sm">
                    <button class="button" onclick="selectAllRecords()">‚òëÔ∏è Select All</button>
                    <button class="button" onclick="deleteSelected()" id="deleteBtn" disabled>
                        üóëÔ∏è Remove Row
                    </button>
                </div>
            </div>

            <!-- History DataGrid -->
            <div style="overflow-x: auto; max-height: 400px; overflow-y: auto;">
                <table class="datagrid" id="historyGrid">
                    <thead style="position: sticky; top: 0; background: var(--card-background-secondary); z-index: 10;">
                        <tr>
                            <th style="width: 40px;">
                                <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                            </th>
                            <th style="width: 60px;">#</th>
                            <th style="width: 120px;">Date/Time</th>
                            <th style="width: 150px;">Type</th>
                            <th style="width: 130px;">Part ID</th>
                            <th style="width: 80px;">Qty</th>
                            <th style="width: 120px;">PO Number</th>
                            <th style="width: 120px;">Location</th>
                            <th style="width: 100px;">User</th>
                            <th style="width: 100px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <!-- Dynamically populated -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination-controls margin-top-lg">
                <button class="button" onclick="firstPageEdit()">‚èÆÔ∏è</button>
                <button class="button" id="editPrevPageBtn" onclick="previousPageEdit()" disabled>
                    ‚óÄ
                </button>
                <span class="pagination-info">
                    Page <input type="number" id="pageInput" min="1" value="1" style="width: 50px; text-align: center;">
                    of <span id="editPageTotal">1</span>
                    <button class="button" onclick="goToPage()">Go</button>
                </span>
                <button class="button" id="editNextPageBtn" onclick="nextPageEdit()" disabled>
                    ‚ñ∂
                </button>
                <button class="button" onclick="lastPageEdit()">‚è≠Ô∏è</button>
            </div>

            <div class="flex flex-end margin-top-lg">
                <button class="button button-accent" onclick="saveAllEdits()">Save & Finish</button>
            </div>
        </div>
    </div>

    <!-- Edit Dialog (Modal) -->
    <div id="editDialog" class="modal hidden">
        <div class="modal-content">
            <div class="flex flex-between margin-bottom-lg">
                <h3 class="subtitle-text">Edit Record</h3>
                <button class="button" onclick="closeEditDialog()" style="padding: 4px 12px;">‚úï</button>
            </div>

            <div class="form-container" style="max-width: 500px;">
                <div class="form-group">
                    <label class="form-label">Type</label>
                    <div class="combobox">
                        <select id="editType">
                            <!-- Populated from dunnageTypes -->
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Part ID</label>
                    <input type="text" class="textbox" id="editPartId">
                </div>

                <div class="form-group">
                    <label class="form-label">Quantity</label>
                    <input type="number" class="numberbox" id="editQuantity" min="1">
                </div>

                <div class="form-group">
                    <label class="form-label">PO Number</label>
                    <input type="text" class="textbox" id="editPO">
                </div>

                <div class="form-group">
                    <label class="form-label">Location</label>
                    <input type="text" class="textbox" id="editLocation">
                </div>

                <div class="button-group">
                    <button class="button" onclick="closeEditDialog()">Cancel</button>
                    <button class="button button-accent" onclick="saveEdit()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="../js/wizard-data.js"></script>
    <script src="../js/edit-mode.js"></script>
</body>

</html>