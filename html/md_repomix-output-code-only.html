<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: User Provided Header</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_repomix-output-code-only.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">User Provided Header </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md87"></a></p>
<p>MTM Receiving Application - Code-Only Minimal Token Export</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md88"></a>
Files</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md89"></a>
File: App.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Application</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.App&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:local</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Converters&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">Application.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">ResourceDictionary</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ResourceDictionary.MergedDictionaries</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">XamlControlsResources</span> <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;using:Microsoft.UI.Xaml.Controls&quot;</span> /&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ResourceDictionary</span> <span class="keyword">Source</span>=<span class="stringliteral">&quot;ms-appx:///Module_Core/Themes/MaterialIcons.xaml&quot;</span>/&gt;</div>
<div class="line">                <span class="comment">&lt;!-- Other merged dictionaries here --&gt;</span></div>
<div class="line">            &lt;/<span class="keywordtype">ResourceDictionary.MergedDictionaries</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Other app resources here --&gt;</span></div>
<div class="line">        &lt;/<span class="keywordtype">ResourceDictionary</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Application.Resources</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Application</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md90"></a>
File: Module_Core/Contracts/Services/IService_CSVWriter.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_CSVWriter</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_CSVWriteResult&gt; WriteToCSVAsync(List&lt;Model_ReceivingLoad&gt; loads);</div>
<div class="line"><span class="keyword">public</span> Task WriteToFileAsync(<span class="keywordtype">string</span> filePath, List&lt;Model_ReceivingLoad&gt; loads, <span class="keywordtype">bool</span> append = <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">public</span> Task&lt;List&lt;Model_ReceivingLoad&gt;&gt; ReadFromCSVAsync(<span class="keywordtype">string</span> filePath);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_CSVDeleteResult&gt; ClearCSVFilesAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_CSVExistenceResult&gt; CheckCSVFilesExistAsync();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetLocalCSVPath();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetNetworkCSVPath();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md91"></a>
File: Module_Core/Contracts/Services/IService_Dispatcher.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Dispatcher</div>
<div class="line">⋮----</div>
<div class="line">public IService_DispatcherTimer CreateTimer();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> TryEnqueue(Action callback);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md92"></a>
File: Module_Core/Contracts/Services/IService_ErrorHandler.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_ErrorHandler</div>
<div class="line">⋮----</div>
<div class="line">public Task HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task LogErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task ShowErrorDialogAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task HandleDaoErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task ShowUserErrorAsync(string message, string title, string method);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> HandleException(Exception ex, Enum_ErrorSeverity severity, <span class="keywordtype">string</span> method, <span class="keywordtype">string</span> className);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md93"></a>
File: Module_Core/Contracts/Services/IService_Help.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Help</div>
<div class="line">⋮----</div>
<div class="line">public Task ShowHelpAsync(string helpKey);</div>
<div class="line"><span class="keyword">public</span> Task ShowContextualHelpAsync(Enum_DunnageWorkflowStep step);</div>
<div class="line"><span class="keyword">public</span> Task ShowContextualHelpAsync(Enum_ReceivingWorkflowStep step);</div>
<div class="line"><span class="keyword">public</span> Model_HelpContent? GetHelpContent(<span class="keywordtype">string</span> key);</div>
<div class="line"><span class="keyword">public</span> List&lt;Model_HelpContent&gt; GetHelpByCategory(<span class="keywordtype">string</span> category);</div>
<div class="line"><span class="keyword">public</span> List&lt;Model_HelpContent&gt; SearchHelp(<span class="keywordtype">string</span> searchTerm);</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; IsDismissedAsync(<span class="keywordtype">string</span> helpKey);</div>
<div class="line"><span class="keyword">public</span> Task SetDismissedAsync(<span class="keywordtype">string</span> helpKey, <span class="keywordtype">bool</span> isDismissed);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetDunnageWorkflowHelp(Enum_DunnageWorkflowStep step);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetReceivingWorkflowHelp(Enum_ReceivingWorkflowStep step);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetTip(<span class="keywordtype">string</span> viewName);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetPlaceholder(<span class="keywordtype">string</span> fieldName);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetTooltip(<span class="keywordtype">string</span> elementName);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetInfoBarMessage(<span class="keywordtype">string</span> messageKey);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md94"></a>
File: Module_Core/Contracts/Services/IService_InforVisual.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_InforVisual</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;Model_InforVisualPO?&gt;&gt; GetPOWithPartsAsync(string poNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_InforVisualPart?&gt;&gt; GetPartByIDAsync(<span class="keywordtype">string</span> partID);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;decimal&gt;&gt; GetSameDayReceivingQuantityAsync(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> partID, DateTime date);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetRemainingQuantityAsync(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> partID);</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; TestConnectionAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md95"></a>
File: Module_Core/Contracts/Services/IService_LoggingUtility.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_LoggingUtility</div>
<div class="line">⋮----</div>
<div class="line">public void LogInfo(string message, string? context = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> LogWarning(<span class="keywordtype">string</span> message, <span class="keywordtype">string</span>? context = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> LogError(<span class="keywordtype">string</span> message, Exception? exception = <span class="keyword">null</span>, <span class="keywordtype">string</span>? context = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> LogCritical(<span class="keywordtype">string</span> message, Exception? exception = <span class="keyword">null</span>, <span class="keywordtype">string</span>? context = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> LogFatal(<span class="keywordtype">string</span> message, Exception? exception = <span class="keyword">null</span>, <span class="keywordtype">string</span>? context = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> Task LogInfoAsync(<span class="keywordtype">string</span> message, <span class="keywordtype">string</span>? context = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> Task LogWarningAsync(<span class="keywordtype">string</span> message, <span class="keywordtype">string</span>? context = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> Task LogErrorAsync(<span class="keywordtype">string</span> message, Exception? exception = <span class="keyword">null</span>, <span class="keywordtype">string</span>? context = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetCurrentLogFilePath();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> EnsureLogDirectoryExists();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">int</span> ArchiveOldLogs(<span class="keywordtype">int</span> daysToKeep = 30);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md96"></a>
File: Module_Core/Contracts/Services/IService_Notification.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Notification : INotifyPropertyChanged</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ShowStatus(string message, InfoBarSeverity severity = InfoBarSeverity.Informational);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md97"></a>
File: Module_Core/Contracts/Services/IService_OnStartup_AppLifecycle.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_OnStartup_AppLifecycle</div>
<div class="line">⋮----</div>
<div class="line">public Task StartAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md98"></a>
File: Module_Core/Contracts/Services/IService_Pagination.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Pagination</div>
<div class="line">⋮----</div>
<div class="line">public event EventHandler PageChanged;</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> SetSource&lt;T&gt;(IEnumerable&lt;T&gt; source);</div>
<div class="line"><span class="keyword">public</span> IEnumerable&lt;T&gt; GetCurrentPageItems&lt;T&gt;();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> NextPage();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> PreviousPage();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> FirstPage();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> LastPage();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> GoToPage(<span class="keywordtype">int</span> pageNumber);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md99"></a>
File: Module_Core/Contracts/Services/IService_SessionManager.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_SessionManager</div>
<div class="line">⋮----</div>
<div class="line">public Task SaveSessionAsync(Model_ReceivingSession session);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_ReceivingSession?&gt; LoadSessionAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; ClearSessionAsync();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> SessionExists();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetSessionFilePath();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md100"></a>
File: Module_Core/Contracts/Services/IService_UserSessionManager.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_UserSessionManager</div>
<div class="line">⋮----</div>
<div class="line">public Model_UserSession CreateSession(</div>
<div class="line">⋮----</div>
<div class="line">public void UpdateLastActivity();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> StartTimeoutMonitoring();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> StopTimeoutMonitoring();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> IsSessionTimedOut();</div>
<div class="line"><span class="keyword">public</span> Task EndSessionAsync(<span class="keywordtype">string</span> reason);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md101"></a>
File: Module_Core/Contracts/Services/IService_ViewModelRegistry.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_ViewModelRegistry</div>
<div class="line">⋮----</div>
<div class="line">public void Register(object viewModel);</div>
<div class="line"><span class="keyword">public</span> IEnumerable&lt;T&gt; GetViewModels&lt;T&gt;();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ClearAllInputs();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md102"></a>
File: Module_Core/Contracts/Services/ITimer.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_DispatcherTimer</div>
<div class="line">⋮----</div>
<div class="line">public void Start();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Stop();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md103"></a>
File: Module_Core/Contracts/Services/IWindowService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Window</div>
<div class="line">⋮----</div>
<div class="line">public XamlRoot? GetXamlRoot();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md104"></a>
File: Module_Core/Contracts/Services/Navigation/IService_Navigation.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Navigation</div>
<div class="line">⋮----</div>
<div class="line">public bool NavigateTo(Frame frame, Type pageType, object? parameter = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> NavigateTo(Frame frame, <span class="keywordtype">string</span> pageTypeName, <span class="keywordtype">object</span>? parameter = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ClearNavigation(Frame frame);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> CanGoBack(Frame frame);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> GoBack(Frame frame);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md105"></a>
File: Module_Core/Data/InforVisual/Dao_InforVisualConnection.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_InforVisualConnection</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; TestConnectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">await using var connection = new SqlConnection(_connectionString);</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(isConnected);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_InforVisualPO&gt;&gt;&gt; GetPOWithPartsAsync(<span class="keywordtype">string</span> poNumber)</div>
<div class="line">⋮----</div>
<div class="line">var query = Helper_SqlQueryLoader.LoadAndPrepareQuery(<span class="stringliteral">&quot;01_GetPOWithParts.sql&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await using var command = new SqlCommand(query, connection);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@PoNumber&quot;</span>, poNumber);</div>
<div class="line">⋮----</div>
<div class="line">await using var reader = await command.ExecuteReaderAsync();</div>
<div class="line">while (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">poLines.Add(new Model_InforVisualPO</div>
<div class="line">⋮----</div>
<div class="line">PoNumber = reader[<span class="stringliteral">&quot;PoNumber&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PoLine = Convert.ToInt32(reader[<span class="stringliteral">&quot;PoLine&quot;</span>]),</div>
<div class="line">PartNumber = reader[<span class="stringliteral">&quot;PartNumber&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PartDescription = reader[<span class="stringliteral">&quot;PartDescription&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">OrderedQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;OrderedQty&quot;</span>]),</div>
<div class="line">ReceivedQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;ReceivedQty&quot;</span>]),</div>
<div class="line">RemainingQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;RemainingQty&quot;</span>]),</div>
<div class="line">UnitOfMeasure = reader[<span class="stringliteral">&quot;UnitOfMeasure&quot;</span>].ToString() ?? <span class="stringliteral">&quot;EA&quot;</span>,</div>
<div class="line">⋮----</div>
<div class="line">VendorCode = reader[<span class="stringliteral">&quot;VendorCode&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">VendorName = reader[<span class="stringliteral">&quot;VendorName&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PoStatus = reader[<span class="stringliteral">&quot;PoStatus&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">SiteId = reader[<span class="stringliteral">&quot;SiteId&quot;</span>].ToString() ?? <span class="stringliteral">&quot;002&quot;</span></div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(poLines);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">bool</span>&gt;&gt; ValidatePoNumberAsync(<span class="keywordtype">string</span> poNumber)</div>
<div class="line">⋮----</div>
<div class="line">var query = Helper_SqlQueryLoader.LoadAndPrepareQuery(<span class="stringliteral">&quot;02_ValidatePONumber.sql&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">var count = (<span class="keywordtype">int</span>?)await command.ExecuteScalarAsync() ?? 0;</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(isValid);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_InforVisualPart?&gt;&gt; GetPartByNumberAsync(<span class="keywordtype">string</span> partNumber)</div>
<div class="line">⋮----</div>
<div class="line">var query = Helper_SqlQueryLoader.LoadAndPrepareQuery(<span class="stringliteral">&quot;03_GetPartByNumber.sql&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@PartNumber&quot;</span>, partNumber);</div>
<div class="line">⋮----</div>
<div class="line">if (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">var part = new Model_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line">Description = reader[<span class="stringliteral">&quot;Description&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">UnitCost = reader[<span class="stringliteral">&quot;UnitCost&quot;</span>] != DBNull.Value ? Convert.ToDecimal(reader[<span class="stringliteral">&quot;UnitCost&quot;</span>]) : 0,</div>
<div class="line">PrimaryUom = reader[<span class="stringliteral">&quot;PrimaryUom&quot;</span>].ToString() ?? <span class="stringliteral">&quot;EA&quot;</span>,</div>
<div class="line">OnHandQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;OnHandQty&quot;</span>]),</div>
<div class="line">AllocatedQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;AllocatedQty&quot;</span>]),</div>
<div class="line">AvailableQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;AvailableQty&quot;</span>]),</div>
<div class="line">DefaultSite = reader[<span class="stringliteral">&quot;DefaultSite&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PartStatus = reader[<span class="stringliteral">&quot;PartStatus&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">ProductLine = reader[<span class="stringliteral">&quot;ProductLine&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_InforVisualPart&gt;&gt;&gt; SearchPartsByDescriptionAsync(</div>
<div class="line">⋮----</div>
<div class="line">var query = Helper_SqlQueryLoader.LoadAndPrepareQuery(<span class="stringliteral">&quot;04_SearchPartsByDescription.sql&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@SearchTerm&quot;</span>, searchTerm);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@MaxResults&quot;</span>, maxResults);</div>
<div class="line">⋮----</div>
<div class="line">parts.Add(new Model_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(parts);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md106"></a>
File: Module_Core/Data/InforVisual/Dao_InforVisualPart.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line">private static void ValidateReadOnlyConnection(string connectionString)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(connectionString))</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line">var builder = <span class="keyword">new</span> SqlConnectionStringBuilder(connectionString);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_InforVisualPart&gt;&gt; GetByPartNumberAsync(<span class="keywordtype">string</span> partNumber)</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using</span> var connection = <span class="keyword">new</span> SqlConnection(_connectionString);</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">var query = Helper_SqlQueryLoader.LoadAndPrepareQuery(<span class="stringliteral">&quot;03_GetPartByNumber.sql&quot;</span>);</div>
<div class="line">await <span class="keyword">using </span>var command = <span class="keyword">new</span> SqlCommand(query, connection);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@PartNumber&quot;</span>, partNumber);</div>
<div class="line">await <span class="keyword">using </span>var reader = await command.ExecuteReaderAsync();</div>
<div class="line"><span class="keywordflow">if</span> (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">var part = <span class="keyword">new</span> Model_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line">PartNumber = reader[<span class="stringliteral">&quot;PartNumber&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">Description = reader[<span class="stringliteral">&quot;Description&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PartType = reader[<span class="stringliteral">&quot;PartType&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">UnitCost = Convert.ToDecimal(reader[<span class="stringliteral">&quot;UnitCost&quot;</span>]),</div>
<div class="line">PrimaryUom = reader[<span class="stringliteral">&quot;PrimaryUom&quot;</span>].ToString() ?? <span class="stringliteral">&quot;EA&quot;</span>,</div>
<div class="line">OnHandQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;OnHandQty&quot;</span>]),</div>
<div class="line">AllocatedQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;AllocatedQty&quot;</span>]),</div>
<div class="line">AvailableQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;AvailableQty&quot;</span>]),</div>
<div class="line">DefaultSite = reader[<span class="stringliteral">&quot;DefaultSite&quot;</span>].ToString() ?? <span class="stringliteral">&quot;002&quot;</span>,</div>
<div class="line">PartStatus = reader[<span class="stringliteral">&quot;PartStatus&quot;</span>].ToString() ?? <span class="stringliteral">&quot;ACTIVE&quot;</span>,</div>
<div class="line">ProductLine = reader[<span class="stringliteral">&quot;ProductLine&quot;</span>].ToString() ?? string.Empty</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(part);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_InforVisualPart&gt;&gt;&gt; SearchPartsByDescriptionAsync(</div>
<div class="line">⋮----</div>
<div class="line">var query = Helper_SqlQueryLoader.LoadAndPrepareQuery(<span class="stringliteral">&quot;04_SearchPartsByDescription.sql&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@SearchTerm&quot;</span>, searchTerm);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@MaxResults&quot;</span>, maxResults);</div>
<div class="line">⋮----</div>
<div class="line">while (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">list.Add(<span class="keyword">new</span> Model_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(list);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md107"></a>
File: Module_Core/Data/InforVisual/Dao_InforVisualPO.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_InforVisualPO</div>
<div class="line">⋮----</div>
<div class="line">private static void ValidateReadOnlyConnection(string connectionString)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(connectionString))</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line">var builder = <span class="keyword">new</span> SqlConnectionStringBuilder(connectionString);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_InforVisualPO&gt;&gt;&gt; GetByPoNumberAsync(<span class="keywordtype">string</span> poNumber)</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using</span> var connection = <span class="keyword">new</span> SqlConnection(_connectionString);</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">var query = Helper_SqlQueryLoader.LoadAndPrepareQuery(<span class="stringliteral">&quot;01_GetPOWithParts.sql&quot;</span>);</div>
<div class="line">await <span class="keyword">using </span>var command = <span class="keyword">new</span> SqlCommand(query, connection);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@PoNumber&quot;</span>, poNumber);</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using </span>var reader = await command.ExecuteReaderAsync();</div>
<div class="line"><span class="keywordflow">while</span> (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">list.Add(<span class="keyword">new</span> Model_InforVisualPO</div>
<div class="line">⋮----</div>
<div class="line">PoNumber = reader[<span class="stringliteral">&quot;PoNumber&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PoLine = Convert.ToInt32(reader[<span class="stringliteral">&quot;PoLine&quot;</span>]),</div>
<div class="line">PartNumber = reader[<span class="stringliteral">&quot;PartNumber&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PartDescription = reader[<span class="stringliteral">&quot;PartDescription&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">OrderedQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;OrderedQty&quot;</span>]),</div>
<div class="line">ReceivedQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;ReceivedQty&quot;</span>]),</div>
<div class="line">RemainingQty = Convert.ToDecimal(reader[<span class="stringliteral">&quot;RemainingQty&quot;</span>]),</div>
<div class="line">UnitOfMeasure = reader[<span class="stringliteral">&quot;UnitOfMeasure&quot;</span>].ToString() ?? <span class="stringliteral">&quot;EA&quot;</span>,</div>
<div class="line">DueDate = reader[<span class="stringliteral">&quot;DueDate&quot;</span>] == DBNull.Value ? <span class="keyword">null</span> : Convert.ToDateTime(reader[<span class="stringliteral">&quot;DueDate&quot;</span>]),</div>
<div class="line">VendorCode = reader[<span class="stringliteral">&quot;VendorCode&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">VendorName = reader[<span class="stringliteral">&quot;VendorName&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PoStatus = reader[<span class="stringliteral">&quot;PoStatus&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">SiteId = reader[<span class="stringliteral">&quot;SiteId&quot;</span>].ToString() ?? <span class="stringliteral">&quot;002&quot;</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(list);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; ValidatePoNumberAsync(<span class="keywordtype">string</span> poNumber)</div>
<div class="line">⋮----</div>
<div class="line">var query = Helper_SqlQueryLoader.LoadAndPrepareQuery(<span class="stringliteral">&quot;02_ValidatePONumber.sql&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">var count = Convert.ToInt32(await command.ExecuteScalarAsync());</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(isValid);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md108"></a>
File: Module_Core/Helpers/Database/Helper_SqlQueryLoader.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Helper_SqlQueryLoader</div>
<div class="line">⋮----</div>
<div class="line">public static string LoadInforVisualQuery(string resourcePath)</div>
<div class="line">⋮----</div>
<div class="line">var assembly = Assembly.GetExecutingAssembly();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">using </span>var stream = assembly.GetManifestResourceStream(resourceName);</div>
<div class="line">⋮----</div>
<div class="line">var filePath = Path.Combine(baseDir, <span class="stringliteral">&quot;Database&quot;</span>, <span class="stringliteral">&quot;InforVisualScripts&quot;</span>, <span class="stringliteral">&quot;Queries&quot;</span>, resourcePath);</div>
<div class="line"><span class="keywordflow">if</span> (File.Exists(filePath))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> File.ReadAllText(filePath);</div>
<div class="line">⋮----</div>
<div class="line">var solutionRoot = Directory.GetParent(baseDir)?.Parent?.Parent?.Parent?.FullName;</div>
<div class="line">⋮----</div>
<div class="line">filePath = Path.Combine(solutionRoot, <span class="stringliteral">&quot;Database&quot;</span>, <span class="stringliteral">&quot;InforVisualScripts&quot;</span>, <span class="stringliteral">&quot;Queries&quot;</span>, resourcePath);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">throw</span> <span class="keyword">new</span> FileNotFoundException($<span class="stringliteral">&quot;SQL query file not found: {resourcePath}. Resource name attempted: {resourceName}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">using </span>var reader = <span class="keyword">new</span> StreamReader(stream);</div>
<div class="line"><span class="keywordflow">return</span> reader.ReadToEnd();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException($<span class="stringliteral">&quot;Failed to load SQL query from {resourcePath}: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">string</span> CleanQuery(<span class="keywordtype">string</span> sql)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(sql))</div>
<div class="line">⋮----</div>
<div class="line">var lines = sql.Split(<span class="keyword">new</span>[] { <span class="stringliteral">&quot;\r\n&quot;</span>, <span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot;\n&quot;</span> }, StringSplitOptions.None);</div>
<div class="line">⋮----</div>
<div class="line">var trimmedLine = line.Trim();</div>
<div class="line"><span class="keywordflow">if</span> (trimmedLine.StartsWith(<span class="stringliteral">&quot;--&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">var commentIndex = line.IndexOf(<span class="stringliteral">&quot;--&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">var lineWithoutComment = line.Substring(0, commentIndex).TrimEnd();</div>
<div class="line"><span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(lineWithoutComment))</div>
<div class="line">⋮----</div>
<div class="line">cleanedLines.Add(lineWithoutComment);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(line))</div>
<div class="line">⋮----</div>
<div class="line">cleanedLines.Add(line);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keywordtype">string</span>.Join(Environment.NewLine, cleanedLines);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">string</span> ExtractQueryFromFile(<span class="keywordtype">string</span> sqlFileContent)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(sqlFileContent))</div>
<div class="line">⋮----</div>
<div class="line">var lines = sqlFileContent.Split(<span class="keyword">new</span>[] { <span class="stringliteral">&quot;\r\n&quot;</span>, <span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot;\n&quot;</span> }, StringSplitOptions.None);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (trimmedLine.StartsWith(<span class="stringliteral">&quot;DECLARE&quot;</span>, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">(trimmedLine.StartsWith(<span class="stringliteral">&quot;SELECT&quot;</span>, StringComparison.OrdinalIgnoreCase) ||</div>
<div class="line">trimmedLine.StartsWith(<span class="stringliteral">&quot;WITH&quot;</span>, StringComparison.OrdinalIgnoreCase) ||</div>
<div class="line">trimmedLine.StartsWith(<span class="stringliteral">&quot;INSERT&quot;</span>, StringComparison.OrdinalIgnoreCase) ||</div>
<div class="line">trimmedLine.StartsWith(<span class="stringliteral">&quot;UPDATE&quot;</span>, StringComparison.OrdinalIgnoreCase) ||</div>
<div class="line">trimmedLine.StartsWith(<span class="stringliteral">&quot;DELETE&quot;</span>, StringComparison.OrdinalIgnoreCase)))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (foundQueryStart &amp;&amp; !<span class="keywordtype">string</span>.IsNullOrWhiteSpace(line))</div>
<div class="line">⋮----</div>
<div class="line">queryLines.Add(line);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keywordtype">string</span>.Join(Environment.NewLine, queryLines);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">string</span> LoadAndPrepareQuery(<span class="keywordtype">string</span> resourcePath)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> extractedQuery.Trim();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md109"></a>
File: Module_Core/Helpers/UI/Helper_MaterialIcons.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Helper_MaterialIcons</div>
<div class="line">⋮----</div>
<div class="line">public static List&lt;MaterialIconKind&gt; GetAllIcons()</div>
<div class="line">⋮----</div>
<div class="line">_allIcons = Enum.GetValues&lt;MaterialIconKind&gt;().ToList();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;MaterialIconKind&gt; SearchIcons(<span class="keywordtype">string</span> searchText)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(searchText))</div>
<div class="line">⋮----</div>
<div class="line">searchText = searchText.ToLower().Trim();</div>
<div class="line"><span class="keywordflow">return</span> all.Where(k =&gt; k.ToString().ToLower().Contains(searchText));</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md110"></a>
File: Module_Core/Helpers/UI/Helper_WindowExtensions.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Helper_WindowExtensions</div>
<div class="line">⋮----</div>
<div class="line">public static void SetWindowSize(this Window window, int width, int height)</div>
<div class="line">⋮----</div>
<div class="line">var appWindow = window.GetAppWindow();</div>
<div class="line">appWindow.Resize(<span class="keyword">new</span> Windows.Graphics.SizeInt32(width, height));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> CenterOnScreen(<span class="keyword">this</span> Window window)</div>
<div class="line">⋮----</div>
<div class="line">appWindow.Move(<span class="keyword">new</span> Windows.Graphics.PointInt32(x, y));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> SetFixedSize(<span class="keyword">this</span> Window window, <span class="keywordtype">bool</span> disableMaximize = <span class="keyword">true</span>, <span class="keywordtype">bool</span> disableMinimize = <span class="keyword">true</span>)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> HideTitleBarIcon(<span class="keyword">this</span> Window window)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> UseCustomTitleBar(<span class="keyword">this</span> Window window, UIElement? customTitleBarElement = <span class="keyword">null</span>)</div>
<div class="line">⋮----</div>
<div class="line">window.SetTitleBar(customTitleBarElement);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> MakeTitleBarTransparent(<span class="keyword">this</span> Window window)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> AppWindow GetAppWindow(<span class="keyword">this</span> Window window)</div>
<div class="line">⋮----</div>
<div class="line">var hWnd = WindowNative.GetWindowHandle(window);</div>
<div class="line">var windowId = Microsoft.UI.Win32Interop.GetWindowIdFromWindow(hWnd);</div>
<div class="line"><span class="keywordflow">return</span> AppWindow.GetFromWindowId(windowId);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md111"></a>
File: Module_Core/Helpers/UI/Helper_WorkflowHelpContentGenerator.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Helper_WorkflowHelpContentGenerator</div>
<div class="line">⋮----</div>
<div class="line">public static UIElement GenerateHelpContent(Enum_ReceivingWorkflowStep step)</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreateModeSelectionHelp()</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreateManualEntryHelp()</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreatePOEntryHelp()</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreateLoadEntryHelp()</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreateWeightQuantityHelp()</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreateHeatLotHelp()</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreatePackageTypeHelp()</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreateReviewHelp()</div>
<div class="line">⋮----</div>
<div class="line">private static UIElement CreateDefaultHelp()</div>
<div class="line">⋮----</div>
<div class="line">var stack = <span class="keyword">new</span> StackPanel { Spacing = 12, Padding = <span class="keyword">new</span> Thickness(4), MaxWidth = 450 };</div>
<div class="line">var title = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">var description = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">stack.Children.Add(title);</div>
<div class="line">stack.Children.Add(description);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> UIElement CreateHelpPanel(<span class="keywordtype">string</span> title, <span class="keywordtype">string</span> description, (<span class="keywordtype">string</span> header, <span class="keywordtype">string</span> content)[] sections)</div>
<div class="line">⋮----</div>
<div class="line">var mainStack = <span class="keyword">new</span> StackPanel { Spacing = 20, Padding = <span class="keyword">new</span> Thickness(4), MaxWidth = 450 };</div>
<div class="line">var titleStack = <span class="keyword">new</span> StackPanel { Spacing = 8 };</div>
<div class="line">var titleText = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">var underline = <span class="keyword">new</span> Border</div>
<div class="line">⋮----</div>
<div class="line">CornerRadius = <span class="keyword">new</span> CornerRadius(1),</div>
<div class="line">⋮----</div>
<div class="line">var descText = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">titleStack.Children.Add(titleText);</div>
<div class="line">titleStack.Children.Add(underline);</div>
<div class="line">titleStack.Children.Add(descText);</div>
<div class="line">mainStack.Children.Add(titleStack);</div>
<div class="line">⋮----</div>
<div class="line">var border = <span class="keyword">new</span> Border</div>
<div class="line">⋮----</div>
<div class="line">Padding = <span class="keyword">new</span> Thickness(16),</div>
<div class="line">CornerRadius = <span class="keyword">new</span> CornerRadius(8),</div>
<div class="line">BorderThickness = <span class="keyword">new</span> Thickness(1),</div>
<div class="line">⋮----</div>
<div class="line">var sectionStack = <span class="keyword">new</span> StackPanel { Spacing = 8 };</div>
<div class="line">var headerText = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">var contentText = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">sectionStack.Children.Add(headerText);</div>
<div class="line">sectionStack.Children.Add(contentText);</div>
<div class="line">⋮----</div>
<div class="line">mainStack.Children.Add(border);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md112"></a>
File: Module_Core/Models/Core/Model_Dao_Result_Generic.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_Dao_Result&lt;T&gt; : Model_Dao_Result</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md113"></a>
File: Module_Core/Models/Core/Model_Dao_Result.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_Dao_Result</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md114"></a>
File: Module_Core/Models/Core/Model_HelpContent.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_HelpContent : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Enum_HelpType _helpType = Enum_HelpType.Info;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Enum_HelpSeverity _severity = Enum_HelpSeverity.Info;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _lastUpdated = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrEmpty(Icon) &amp;&amp; Enum.TryParse&lt;MaterialIconKind&gt;(Icon, true, out var kind))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md115"></a>
File: Module_Core/Models/Enums/Enum_DataSourceType.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md116"></a>
File: Module_Core/Models/Enums/Enum_ErrorSeverity.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md117"></a>
File: Module_Core/Models/Enums/Enum_HelpSeverity.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md118"></a>
File: Module_Core/Models/Enums/Enum_HelpType.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md119"></a>
File: Module_Core/Models/Enums/Enum_InfoBarSeverity.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md120"></a>
File: Module_Core/Models/Enums/Enum_LabelType.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md121"></a>
File: Module_Core/Models/Enums/Enum_PackageType.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md122"></a>
File: Module_Core/Models/Enums/Enum_ReceivingWorkflowStep.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md123"></a>
File: Module_Core/Models/Enums/Enum_ValidationSeverity.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md124"></a>
File: Module_Core/Models/Systems/Model_AppSettings.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_AppSettings</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md125"></a>
File: Module_Core/Models/Systems/Model_CreateUserResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_CreateUserResult</div>
<div class="line">⋮----</div>
<div class="line">public static Model_CreateUserResult SuccessResult(int employeeNumber) =&gt; <span class="keyword">new</span>()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Model_CreateUserResult ErrorResult(<span class="keywordtype">string</span> message) =&gt; <span class="keyword">new</span>()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md126"></a>
File: Module_Core/Models/Systems/Model_SessionTimedOutEventArgs.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_SessionTimedOutEventArgs : EventArgs</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md127"></a>
File: Module_Core/Services/Database/Service_ErrorHandler.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_ErrorHandler : IService_ErrorHandler</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _loggingService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line">_loggingService = loggingService ?? throw new ArgumentNullException(nameof(loggingService));</div>
<div class="line">_windowService = windowService ?? throw new ArgumentNullException(nameof(windowService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task LogErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">return Task.Run(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">_loggingService.LogInfo(errorMessage);</div>
<div class="line">⋮----</div>
<div class="line">_loggingService.LogWarning(errorMessage);</div>
<div class="line">⋮----</div>
<div class="line">_loggingService.LogError(errorMessage, exception);</div>
<div class="line">⋮----</div>
<div class="line">_loggingService.LogCritical(errorMessage, exception);</div>
<div class="line">⋮----</div>
<div class="line">_loggingService.LogFatal(errorMessage, exception);</div>
<div class="line">⋮----</div>
<div class="line">public async Task ShowErrorDialogAsync(</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_loggingService.LogWarning(&quot;Cannot show dialog - XamlRoot is null&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">_loggingService.LogError($&quot;Failed to show error dialog: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task HandleDaoErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task ShowUserErrorAsync(string message, string title, string method)</div>
<div class="line">⋮----</div>
<div class="line">public void HandleException(Exception ex, Enum_ErrorSeverity severity, string method, string className)</div>
<div class="line">⋮----</div>
<div class="line">private static string GetDialogTitle(Enum_ErrorSeverity severity)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md128"></a>
File: Module_Core/Services/Database/Service_InforVisualConnect.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_InforVisualConnect : IService_InforVisual</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_InforVisualConnection _dao;</div>
<div class="line">⋮----</div>
<div class="line">_dao = dao ?? throw new ArgumentNullException(nameof(dao));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; TestConnectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dao.TestConnectionAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_InforVisualPO?&gt;&gt; GetPOWithPartsAsync(string poNumber)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(poNumber))</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dao.GetPOWithPartsAsync(cleanPoNumber);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_InforVisualPart?&gt;&gt; GetPartByIDAsync(string partID)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(partID))</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dao.GetPartByNumberAsync(partID);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;decimal&gt;&gt; GetSameDayReceivingQuantityAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetRemainingQuantityAsync(string poNumber, string partID)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dao.GetPOWithPartsAsync(poNumber);</div>
<div class="line">⋮----</div>
<div class="line">var matchingLine = result.Data.FirstOrDefault(line =&gt;</div>
<div class="line">line.PartNumber.Equals(partID, StringComparison.OrdinalIgnoreCase));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_InforVisualPO ConvertToServiceModel(List&lt;Models.InforVisual.Model_InforVisualPO&gt; poLines)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_InforVisualPO</div>
<div class="line">⋮----</div>
<div class="line">Parts = poLines.ConvertAll(line =&gt; new Model_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line">POLineNumber = line.PoLine.ToString(),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_InforVisualPart ConvertPartToServiceModel(Models.InforVisual.Model_InforVisualPart daoPart)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_Dao_Result&lt;Model_InforVisualPO?&gt; CreateMockPO(string poNumber)</div>
<div class="line">⋮----</div>
<div class="line">var mockPO = new Model_InforVisualPO</div>
<div class="line">⋮----</div>
<div class="line">new Model_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_Dao_Result&lt;Model_InforVisualPart?&gt; CreateMockPart(string partID)</div>
<div class="line">⋮----</div>
<div class="line">var mockPart = new Model_InforVisualPart</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md129"></a>
File: Module_Core/Services/Help/Service_Help.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Help : IService_Help</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Dispatcher _dispatcher;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task ShowHelpAsync(string helpKey)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Help content not found for key: {helpKey}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_dispatcher.TryEnqueue(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync(&quot;Failed to retrieve HelpDialog from DI container&quot;);</div>
<div class="line">tcs.SetResult(false);</div>
<div class="line">⋮----</div>
<div class="line">dialog.SetHelpContent(content);</div>
<div class="line">dialog.XamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync(&quot;XamlRoot is null, cannot show help dialog&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await dialog.ShowAsync();</div>
<div class="line">await _logger.LogInfoAsync($&quot;Displayed help for: {helpKey}&quot;);</div>
<div class="line">tcs.SetResult(true);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error in UI thread: {ex.Message}&quot;);</div>
<div class="line">tcs.SetException(ex);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error showing help for key {helpKey}: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task ShowContextualHelpAsync(Enum_DunnageWorkflowStep step)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task ShowContextualHelpAsync(Enum_ReceivingWorkflowStep step)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_HelpContent? GetHelpContent(string key)</div>
<div class="line">⋮----</div>
<div class="line">return _helpContentCache.TryGetValue(key, out var content) ? content : null;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> List&lt;Model_HelpContent&gt; GetHelpByCategory(string category)</div>
<div class="line">⋮----</div>
<div class="line">.Where(c =&gt; c.Category.Equals(category, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">.OrderBy(c =&gt; c.Title)</div>
<div class="line">.ToList();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> List&lt;Model_HelpContent&gt; SearchHelp(string searchTerm)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(searchTerm))</div>
<div class="line">⋮----</div>
<div class="line">var term = searchTerm.ToLower();</div>
<div class="line">⋮----</div>
<div class="line">.Where(c =&gt; c.Title.ToLower().Contains(term) || c.Content.ToLower().Contains(term))</div>
<div class="line">.OrderByDescending(c =&gt; c.Title.ToLower().Contains(term))</div>
<div class="line">.ThenBy(c =&gt; c.Title)</div>
<div class="line">.Take(20)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; IsDismissedAsync(string helpKey)</div>
<div class="line">⋮----</div>
<div class="line">return _dismissedTips.Contains(helpKey);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task SetDismissedAsync(string helpKey, bool isDismissed)</div>
<div class="line">⋮----</div>
<div class="line">_dismissedTips.Add(helpKey);</div>
<div class="line">⋮----</div>
<div class="line">_dismissedTips.Remove(helpKey);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetDunnageWorkflowHelp(Enum_DunnageWorkflowStep step)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetReceivingWorkflowHelp(Enum_ReceivingWorkflowStep step)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTip(string viewName)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string fieldName)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string elementName)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetInfoBarMessage(string messageKey)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void InitializeHelpContent()</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Dunnage Workflow Help Content</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Receiving Workflow Help Content</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Admin Help Content</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Tooltips</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Placeholders</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Tips</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// InfoBar Messages</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void InitializeDunnageHelp()</div>
<div class="line">⋮----</div>
<div class="line">AddHelpContent(new Model_HelpContent</div>
<div class="line">⋮----</div>
<div class="line">private void InitializeReceivingHelp()</div>
<div class="line">⋮----</div>
<div class="line">private void InitializeAdminHelp()</div>
<div class="line">⋮----</div>
<div class="line">private void InitializeTooltips()</div>
<div class="line">⋮----</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.FirstPage&quot;, Content = &quot;First Page&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.PreviousPage&quot;, Content = &quot;Previous Page&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.NextPage&quot;, Content = &quot;Next Page&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.LastPage&quot;, Content = &quot;Last Page&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.QuickGuidedWizard&quot;, Content = &quot;Skip mode selection and go directly to Guided Wizard&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.QuickManualEntry&quot;, Content = &quot;Skip mode selection and go directly to Manual Entry&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.QuickEditMode&quot;, Content = &quot;Skip mode selection and go directly to Edit Mode&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.ReturnToModeSelection&quot;, Content = &quot;Return to mode selection (clears current work)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.ShowHelp&quot;, Content = &quot;Click for help about current step&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.Refresh&quot;, Content = &quot;Refresh parts list&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.AddMultipleRows&quot;, Content = &quot;Add multiple rows at once (up to 100)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.AutoFill&quot;, Content = &quot;Auto-fill from last entry for this Part ID&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.FillBlanks&quot;, Content = &quot;Copy PO, Location, and specs from last row to empty fields&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SortForPrinting&quot;, Content = &quot;Sort by Part ID â†’ PO â†’ Type&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.LoadSessionMemory&quot;, Content = &quot;Load unsaved loads from current session&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.LoadRecentCSV&quot;, Content = &quot;Load from most recent CSV export&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.LoadHistoricalData&quot;, Content = &quot;Load historical loads from database&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.CreateType&quot;, Content = &quot;Create a new dunnage type&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.EditType&quot;, Content = &quot;Edit selected type&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.DeleteType&quot;, Content = &quot;Delete selected type with impact analysis&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.ReturnToAdmin&quot;, Content = &quot;Return to admin main navigation&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.CreatePart&quot;, Content = &quot;Create a new dunnage part&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.EditPart&quot;, Content = &quot;Edit selected part&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.DeletePart&quot;, Content = &quot;Delete selected part&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.RemoveSelectedRows&quot;, Content = &quot;Remove all selected rows&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.FilterLastWeek&quot;, Content = &quot;Show loads from last 7 days&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.FilterToday&quot;, Content = &quot;Show loads from today only&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.FilterThisWeek&quot;, Content = &quot;Show loads from this week (Mon-Sun)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.FilterThisMonth&quot;, Content = &quot;Show loads from this month&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.FilterThisQuarter&quot;, Content = &quot;Show loads from this quarter&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.FilterShowAll&quot;, Content = &quot;Show all loads from last year&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SaveChanges&quot;, Content = &quot;Save all changes to database&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SelectAll&quot;, Content = &quot;Select or deselect all rows&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.RemoveRow&quot;, Content = &quot;Remove selected rows&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.ClearFilters&quot;, Content = &quot;Remove all date filters&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.GoToPage&quot;, Content = &quot;Go to specified page&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SaveAndFinish&quot;, Content = &quot;Save all changes and finish&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.AddRow&quot;, Content = &quot;Add a new row to the grid&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.HelpDunnageTypes&quot;, Content = &quot;Click for help about dunnage types&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Field.TypeName&quot;, Content = &quot;Enter a unique descriptive name for this dunnage type&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SelectIcon&quot;, Content = &quot;Click to browse and select an icon from the icon library&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Field.SpecName&quot;, Content = &quot;Enter a unique name for this specification field&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Field.SpecType&quot;, Content = &quot;Select the data type for this field&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Field.MinValue&quot;, Content = &quot;Minimum allowed value (optional)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Field.MaxValue&quot;, Content = &quot;Maximum allowed value (optional)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Field.Unit&quot;, Content = &quot;Unit of measurement to display (optional)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Field.Required&quot;, Content = &quot;Check if this field must be filled when creating parts&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.AddSpec&quot;, Content = &quot;Add this specification to the list below&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.List.Specs&quot;, Content = &quot;List of specifications defined for this type&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.RemoveSpec&quot;, Content = &quot;Remove this specification&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.AddAnother&quot;, Content = &quot;Add another load to the current batch&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SaveAndGenerate&quot;, Content = &quot;Save all entries to database and generate labels&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.ModeSelection&quot;, Content = &quot;Return to mode selection (clears current work)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.StepHelp&quot;, Content = &quot;Click for help about the current step&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.BackStep&quot;, Content = &quot;Go back to previous step&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.NextStep&quot;, Content = &quot;Proceed to next step&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SaveAndReview&quot;, Content = &quot;Save entry and proceed to review&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.StartNew&quot;, Content = &quot;Start a new receiving entry&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.ResetCSV&quot;, Content = &quot;Clear the CSV data and start over&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.LoadPO&quot;, Content = &quot;Load purchase order details from Infor Visual&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SwitchToNonPO&quot;, Content = &quot;Switch to non-PO entry mode for items without purchase orders&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.LookupPart&quot;, Content = &quot;Look up part details in the system&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Tooltip.Button.SwitchToPO&quot;, Content = &quot;Switch to PO entry mode&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">⋮----</div>
<div class="line">private void InitializePlaceholders()</div>
<div class="line">⋮----</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.Quantity&quot;, Content = &quot;Enter quantity...&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.PONumber&quot;, Content = &quot;Enter PO number (optional)...&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.Location&quot;, Content = &quot;Enter location...&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.PartSelection&quot;, Content = &quot;Choose a part...&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.HeatLotNumber&quot;, Content = &quot;Enter heat/lot number or leave blank&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.PONumberReceiving&quot;, Content = &quot;Enter PO (e.g., 66868 or PO-066868)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.PartID&quot;, Content = &quot;Enter Part ID (e.g., MMC-001, MMF-456)&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.Weight&quot;, Content = &quot;Enter weight...&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.QuantityNumber&quot;, Content = &quot;Enter whole number&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.StartDate&quot;, Content = &quot;Start Date&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">AddHelpContent(new Model_HelpContent { Key = &quot;Placeholder.Field.EndDate&quot;, Content = &quot;End Date&quot;, HelpType = Enum_HelpType.Tip });</div>
<div class="line">⋮----</div>
<div class="line">private void InitializeTips()</div>
<div class="line">⋮----</div>
<div class="line">private void InitializeInfoBarMessages()</div>
<div class="line">⋮----</div>
<div class="line">private void AddHelpContent(Model_HelpContent content)</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrEmpty(content.Key))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md130"></a>
File: Module_Core/Services/Navigation/Service_Navigation.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Navigation : IService_Navigation</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool NavigateTo(Frame frame, Type pageType, object? parameter = null)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Navigation frame is null&quot;, null, &quot;Service_Navigation&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Page type is null&quot;, null, &quot;Service_Navigation&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = frame.Navigate(pageType, parameter);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Navigated to {pageType.Name}&quot;, &quot;Service_Navigation&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Failed to navigate to {pageType.Name}&quot;, &quot;Service_Navigation&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Navigation error: {ex.Message}&quot;, ex, &quot;Service_Navigation&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool NavigateTo(Frame frame, string pageTypeName, object? parameter = null)</div>
<div class="line">⋮----</div>
<div class="line">var pageType = Type.GetType(pageTypeName);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Could not find type: {pageTypeName}&quot;, null, &quot;Service_Navigation&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ClearNavigation(Frame frame)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Navigation cleared&quot;, &quot;Service_Navigation&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool CanGoBack(Frame frame)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void GoBack(Frame frame)</div>
<div class="line">⋮----</div>
<div class="line">frame.GoBack();</div>
<div class="line">_logger.LogInfo(&quot;Navigated back&quot;, &quot;Service_Navigation&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md131"></a>
File: Module_Core/Services/Service_Dispatcher.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Dispatcher : IService_Dispatcher</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly DispatcherQueue _dispatcherQueue;</div>
<div class="line">⋮----</div>
<div class="line">_dispatcherQueue = dispatcherQueue ?? throw new ArgumentNullException(nameof(dispatcherQueue));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> IService_DispatcherTimer CreateTimer()</div>
<div class="line">⋮----</div>
<div class="line">return new Service_DispatcherTimerWrapper(_dispatcherQueue.CreateTimer());</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool TryEnqueue(Action callback)</div>
<div class="line">⋮----</div>
<div class="line">return _dispatcherQueue.TryEnqueue(() =&gt; callback());</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md132"></a>
File: Module_Core/Services/Service_DispatcherTimerWrapper.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_DispatcherTimerWrapper : IService_DispatcherTimer</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly DispatcherQueueTimer _timer;</div>
<div class="line">⋮----</div>
<div class="line">_timer = timer ?? throw new ArgumentNullException(nameof(timer));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Start() =&gt; _timer.Start();</div>
<div class="line"><span class="keyword">public</span> void Stop() =&gt; _timer.Stop();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md133"></a>
File: Module_Core/Services/Service_Notification.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Service_Notification : ObservableObject, IService_Notification</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Dispatcher _dispatcher;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> InfoBarSeverity _statusSeverity = InfoBarSeverity.Informational;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ShowStatus(string message, InfoBarSeverity severity = InfoBarSeverity.Informational)</div>
<div class="line">⋮----</div>
<div class="line">Task.Delay(5000).ContinueWith(_ =&gt;</div>
<div class="line">⋮----</div>
<div class="line">_dispatcher.TryEnqueue(() =&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md134"></a>
File: Module_Core/Services/Service_Pagination.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Pagination : IService_Pagination</div>
<div class="line">⋮----</div>
<div class="line">return (int)Math.Ceiling((double)TotalItems / PageSize);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void SetSource&lt;T&gt;(IEnumerable&lt;T&gt; source)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> IEnumerable&lt;T&gt; GetCurrentPageItems&lt;T&gt;()</div>
<div class="line">⋮----</div>
<div class="line">.Skip((CurrentPage - 1) * PageSize)</div>
<div class="line">.Take(PageSize)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool NextPage()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool PreviousPage()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool FirstPage()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool LastPage()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool GoToPage(int pageNumber)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnPageChanged()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md135"></a>
File: Module_Core/Services/Service_Window.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Window : IService_Window</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> XamlRoot? GetXamlRoot()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md136"></a>
File: Module_Core/Services/UI/Service_ViewModelRegistry.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_ViewModelRegistry : IService_ViewModelRegistry</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Register(object viewModel)</div>
<div class="line">⋮----</div>
<div class="line">_viewModels.Add(new WeakReference&lt;object&gt;(viewModel));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> IEnumerable&lt;T&gt; GetViewModels&lt;T&gt;()</div>
<div class="line">⋮----</div>
<div class="line">.Select(r =&gt; r.TryGetTarget(out var target) ? target : null)</div>
<div class="line">.Where(t =&gt; t != null &amp;&amp; t is T)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ClearAllInputs()</div>
<div class="line">⋮----</div>
<div class="line">if (vmRef.TryGetTarget(out var vm))</div>
<div class="line">⋮----</div>
<div class="line">resettable.ResetToDefaults();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void Cleanup()</div>
<div class="line">⋮----</div>
<div class="line">_viewModels.RemoveAll(r =&gt; !r.TryGetTarget(out _));</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md137"></a>
File: Module_Core/Themes/MaterialIcons.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">ResourceDictionary</span> <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">                    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">                    <span class="keyword">xmlns:local</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">Style</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;local:MaterialIcon&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;IsTabStop&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;False&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;FlowDirection&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;LeftToRight&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Template&quot;</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">Setter.Value</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">ControlTemplate</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;local:MaterialIcon&quot;</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{TemplateBinding Background}&quot;</span></div>
<div class="line">                  <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{TemplateBinding BorderBrush}&quot;</span></div>
<div class="line">                  <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;{TemplateBinding BorderThickness}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Viewbox</span> <span class="keyword">FlowDirection</span>=<span class="stringliteral">&quot;{TemplateBinding FlowDirection}&quot;</span>&gt;</div>
<div class="line">              &lt;<span class="keywordtype">Canvas</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;24&quot;</span></div>
<div class="line">                      <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Path</span> <span class="keyword">Data</span>=<span class="stringliteral">&quot;{Binding Data, RelativeSource={RelativeSource TemplatedParent}}&quot;</span></div>
<div class="line">                      <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{TemplateBinding Foreground}&quot;</span> /&gt;</div>
<div class="line">              &lt;/<span class="keywordtype">Canvas</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Viewbox</span>&gt;</div>
<div class="line">          &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ControlTemplate</span>&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">Setter.Value</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Setter</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">Style</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">Style</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;local:MaterialIconText&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;IsTabStop&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;False&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;FlowDirection&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;LeftToRight&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Spacing&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;5&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Template&quot;</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">Setter.Value</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">ControlTemplate</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;local:MaterialIconText&quot;</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;{TemplateBinding Orientation}&quot;</span></div>
<div class="line">                      <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;{TemplateBinding Spacing}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">local:MaterialIcon</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;{TemplateBinding IconSize}&quot;</span></div>
<div class="line">                                <span class="keyword">Height</span>=<span class="stringliteral">&quot;{TemplateBinding IconSize}&quot;</span></div>
<div class="line">                                <span class="keyword">Animation</span>=<span class="stringliteral">&quot;{TemplateBinding Animation}&quot;</span></div>
<div class="line">                                <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{TemplateBinding Kind}&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{TemplateBinding Text}&quot;</span> /&gt;</div>
<div class="line">          &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ControlTemplate</span>&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">Setter.Value</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Setter</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">Style</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ResourceDictionary</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md138"></a>
File: Module_Dunnage/Enums/Enum_DunnageWorkflowStep.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md139"></a>
File: Module_Dunnage/Models/Model_DunnageLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_DunnageLine</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md140"></a>
File: Module_Dunnage/Models/Model_DunnagePart.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_DunnagePart : INotifyPropertyChanged</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdDate = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> <span class="keyword">virtual</span> void OnPropertyChanged([CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> bool SetField&lt;T&gt;(ref T field, T value, [CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">if (EqualityComparer&lt;T&gt;.Default.Equals(field, value))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void DeserializeSpecValues()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(SpecValues))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md141"></a>
File: Module_Dunnage/Models/Model_DunnageSession.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_DunnageSession : INotifyPropertyChanged</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> <span class="keyword">virtual</span> void OnPropertyChanged([CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> bool SetField&lt;T&gt;(ref T field, T value, [CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">if (EqualityComparer&lt;T&gt;.Default.Equals(field, value))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md142"></a>
File: Module_Dunnage/Models/Model_DunnageSpec.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_DunnageSpec : INotifyPropertyChanged</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdDate = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> <span class="keyword">virtual</span> void OnPropertyChanged([CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> bool SetField&lt;T&gt;(ref T field, T value, [CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">if (EqualityComparer&lt;T&gt;.Default.Equals(field, value))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void DeserializeSpecs()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(SpecValue))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md143"></a>
File: Module_Dunnage/Models/Model_DunnageType.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_DunnageType : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdDate = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrEmpty(Icon) &amp;&amp; Enum.TryParse&lt;MaterialIconKind&gt;(Icon, true, out var kind))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md144"></a>
File: Module_Dunnage/Models/Model_IconDefinition.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_IconDefinition : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> MaterialIconKind _kind;</div>
<div class="line">⋮----</div>
<div class="line">get =&gt; Kind.ToString();</div>
<div class="line">⋮----</div>
<div class="line">else if (LegacyMapping.TryGetValue(value, out var legacyResult))</div>
<div class="line">⋮----</div>
<div class="line">Name = legacyResult.ToString();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md145"></a>
File: Module_Dunnage/Models/Model_InventoriedDunnage.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_InventoriedDunnage : INotifyPropertyChanged</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdDate = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> <span class="keyword">virtual</span> void OnPropertyChanged([CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> bool SetField&lt;T&gt;(ref T field, T value, [CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">if (EqualityComparer&lt;T&gt;.Default.Equals(field, value))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md146"></a>
File: Module_Dunnage/Models/Model_SpecInput.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_SpecInput : ObservableObject</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md147"></a>
File: Module_Dunnage/Models/Model_SpecItem.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_SpecItem</div>
<div class="line">⋮----</div>
<div class="line">parts.Add($<span class="stringliteral">&quot;Min: {MinValue.Value}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">parts.Add($<span class="stringliteral">&quot;Max: {MaxValue.Value}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(Unit))</div>
<div class="line">⋮----</div>
<div class="line">parts.Add(Unit);</div>
<div class="line">⋮----</div>
<div class="line">desc += $<span class="stringliteral">&quot; ({string.Join(&quot;</span>, <span class="stringliteral">&quot;, parts)})&quot;</span>;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md148"></a>
File: Module_Dunnage/Models/SpecDefinition.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>SpecDefinition</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md149"></a>
File: Module_Dunnage/Views/View_Dunnage_AdminInventoryView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_AdminInventoryView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource ApplicationPageBackgroundThemeBrush}&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_StringFormat</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;DateTimeToStringConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manage Inventoried Parts&quot;</span> </div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Configure parts that require inventory tracking&quot;</span> </div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Toolbar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Add&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Add Part to List&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowAddToListCommand}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Add a part to the inventory tracking list&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Edit&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Edit Entry&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowEditEntryCommand}&quot;</span></div>
<div class="line">                <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HasSelection, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Edit the selected inventory entry&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Delete&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Remove from List&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowRemoveConfirmationCommand}&quot;</span></div>
<div class="line">                <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HasSelection, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Remove the selected part from inventory tracking&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Back&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Back to Admin Hub&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.BackToHubCommand}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Return to the admin hub&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- DataGrid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> </div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> </div>
<div class="line">            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGrid</span></div>
<div class="line">                    <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.InventoriedParts, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedInventoriedPart, Mode=TwoWay}&quot;</span></div>
<div class="line">                    <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                    <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                    <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                    <span class="keyword">CanUserReorderColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span></div>
<div class="line">                    <span class="keyword">AlternatingRowBackground</span>=<span class="stringliteral">&quot;{ThemeResource SubtleFillColorSecondaryBrush}&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                        <span class="comment">&lt;!-- Part ID Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartId}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Inventory Method Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Inventory Method&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding InventoryMethod}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Notes Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Notes&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Notes}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;3*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Date Added Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Date Added&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CreatedDate, Converter={StaticResource DateTimeToStringConverter}}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Added By Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Added By&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CreatedBy}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Last Modified Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Last Modified&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding ModifiedDate, Converter={StaticResource DateTimeToStringConverter}}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Modified By Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Modified By&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding ModifiedBy}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Empty State --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> </div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> </div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.InventoriedParts.Count, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> </div>
<div class="line">                        <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7C3;&quot;</span> </div>
<div class="line">                        <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;72&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;No inventoried parts found&quot;</span> </div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;Click &#39;Add Part to List&#39; to configure parts that require inventory tracking&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> </div>
<div class="line">                <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> </div>
<div class="line">                <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;|&quot;</span></div>
<div class="line">                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0,8,0&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Total Parts:&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.InventoriedParts.Count, Mode=OneWay}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md150"></a>
File: Module_Dunnage/Views/View_Dunnage_AdminMainView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_AdminMainView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:local</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Views&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource ApplicationPageBackgroundThemeBrush}&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">        <span class="comment">&lt;!-- Main Navigation Hub (4-card view) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsMainNavigationVisible, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,24&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Dunnage Management&quot;</span> </div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manage types, parts, specifications, and inventory&quot;</span> </div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- 4 Navigation Cards (2x2 Grid) --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Type Management Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                    <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NavigateToManageTypesCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,12&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span></div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> </div>
<div class="line">                            <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7C3;&quot;</span> </div>
<div class="line">                            <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemAccentColor}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manage Types&quot;</span> </div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add, edit, and delete dunnage types&quot;</span></div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                            <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Spec Management Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                    <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NavigateToManageSpecsCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;12,0,0,12&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span></div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> </div>
<div class="line">                            <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8FD;&quot;</span> </div>
<div class="line">                            <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemAccentColor}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manage Specs&quot;</span> </div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Define specifications for each type&quot;</span></div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                            <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Part Management Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                    <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NavigateToManagePartsCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,12,0&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span></div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> </div>
<div class="line">                            <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8F1;&quot;</span> </div>
<div class="line">                            <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemAccentColor}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manage Parts&quot;</span> </div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add and edit dunnage part numbers&quot;</span></div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                            <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Inventoried List Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                    <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NavigateToInventoriedListCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;12,12,0,0&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span></div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> </div>
<div class="line">                            <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8EF;&quot;</span> </div>
<div class="line">                            <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemAccentColor}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Inventoried List&quot;</span> </div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manage inventory tracking settings&quot;</span></div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                            <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,24,0,0&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ProgressRing</span> </div>
<div class="line">                    <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> </div>
<div class="line">                    <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Type Management Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManageTypesVisible, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">local:View_Dunnage_AdminTypesView</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Spec Management Section (placeholder) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManageSpecsVisible, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8FD;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;72&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Spec Management&quot;</span> </div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;This view will be implemented in a future phase&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Back to Main Menu&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToMainNavigationCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Part Management Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManagePartsVisible, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">local:View_Dunnage_AdminPartsView</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Inventoried List Section (placeholder) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsInventoriedListVisible, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8EF;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;72&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Inventoried List&quot;</span> </div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;This view will be implemented in a future phase&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Back to Main Menu&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToMainNavigationCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md151"></a>
File: Module_Dunnage/Views/View_Dunnage_AdminMainView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_AdminMainView : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md152"></a>
File: Module_Dunnage/Views/View_Dunnage_AdminPartsView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_AdminPartsView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource ApplicationPageBackgroundThemeBrush}&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manage Dunnage Parts&quot;</span> </div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add, edit, and search dunnage parts with spec values&quot;</span> </div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Toolbar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Add&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Add New Part&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.CreatePart&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Edit&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Edit Part&quot;</span></div>
<div class="line">                <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanEdit, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.EditPart&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Delete&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Delete Part&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowDeleteConfirmationCommand}&quot;</span></div>
<div class="line">                <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanDelete, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.DeletePart&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Back&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Back to Admin Hub&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToAdminHubCommand}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.ReturnToAdmin&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Search and Filter Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Search Box --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">TextBox</span> </div>
<div class="line">                <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SearchText, Mode=TwoWay}&quot;</span></div>
<div class="line">                <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Search by Part ID...&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox.KeyboardAccelerators</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">KeyboardAccelerator</span> <span class="keyword">Key</span>=<span class="stringliteral">&quot;Enter&quot;</span> <span class="keyword">Invoked</span>=<span class="stringliteral">&quot;OnSearchKeyboardAccelerator&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">TextBox.KeyboardAccelerators</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">TextBox</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Type Filter --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">ComboBox</span> </div>
<div class="line">                <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AvailableTypes, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedFilterType, Mode=TwoWay}&quot;</span></div>
<div class="line">                <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Filter by Type&quot;</span></div>
<div class="line">                <span class="keyword">DisplayMemberPath</span>=<span class="stringliteral">&quot;DunnageType&quot;</span></div>
<div class="line">                <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;200&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Filter Buttons --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Search&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SearchPartsCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Filter by Type&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FilterByTypeCommand}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Clear&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ClearFiltersCommand}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- DataGrid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> </div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> </div>
<div class="line">            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGrid</span></div>
<div class="line">                    <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Parts, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPart, Mode=TwoWay}&quot;</span></div>
<div class="line">                    <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                    <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                    <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                    <span class="keyword">CanUserReorderColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span></div>
<div class="line">                    <span class="keyword">AlternatingRowBackground</span>=<span class="stringliteral">&quot;{ThemeResource SubtleFillColorSecondaryBrush}&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                        <span class="comment">&lt;!-- Part ID Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartId}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Type Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Type&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding DunnageTypeName}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Spec Values Column (Note: Dynamic spec columns would require code-behind) --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Specifications&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding DunnageSpecValuesJson}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Date Added Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Date Added&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CreatedDate, Converter={StaticResource DateTimeToStringConverter}}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Added By Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Added By&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CreatedBy}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Empty State --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> </div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> </div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Parts.Count, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> </div>
<div class="line">                        <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8F1;&quot;</span> </div>
<div class="line">                        <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;72&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;No parts found&quot;</span> </div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;Try adjusting your filters or add a new part&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Pagination Controls --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Record Count --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Showing&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Parts.Count, Mode=OneWay}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;of&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TotalRecords, Mode=OneWay}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;parts&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Pagination Buttons --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;First&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FirstPageCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanNavigatePrevious, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Previous&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PreviousPageCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanNavigatePrevious, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;12,0,12,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Page&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentPage, Mode=OneWay}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;of&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TotalPages, Mode=OneWay}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Next&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NextPageCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanNavigateNext, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Last&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastPageCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanNavigateNext, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;5&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> </div>
<div class="line">                <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> </div>
<div class="line">                <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md153"></a>
File: Module_Dunnage/Views/View_Dunnage_AdminPartsView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_AdminPartsView : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPageLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.LoadPartsCommand.ExecuteAsync(null);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnSearchKeyboardAccelerator(KeyboardAccelerator sender, KeyboardAcceleratorInvokedEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.SearchPartsCommand.ExecuteAsync(null);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md154"></a>
File: Module_Dunnage/Views/View_Dunnage_AdminTypesView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_AdminTypesView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:materialIcons</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource ApplicationPageBackgroundThemeBrush}&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IconCodeToGlyph</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IconCodeToGlyphConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_StringFormat</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;DateTimeToStringConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manage Dunnage Types&quot;</span> </div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add, edit, and delete dunnage types with impact analysis&quot;</span> </div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Toolbar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Add&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Add New Type&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.CreateType&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Edit&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Edit Type&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowEditTypeCommand}&quot;</span></div>
<div class="line">                <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanEdit, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.EditType&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Delete&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Delete Type&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowDeleteConfirmationCommand}&quot;</span></div>
<div class="line">                <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanDelete, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.DeleteType&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Back&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Back to Admin Hub&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToAdminHubCommand}&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.ReturnToAdmin&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- DataGrid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> </div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> </div>
<div class="line">            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGrid</span></div>
<div class="line">                    <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Types, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedType, Mode=TwoWay}&quot;</span></div>
<div class="line">                    <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                    <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                    <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                    <span class="keyword">CanUserReorderColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span></div>
<div class="line">                    <span class="keyword">AlternatingRowBackground</span>=<span class="stringliteral">&quot;{ThemeResource SubtleFillColorSecondaryBrush}&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                        <span class="comment">&lt;!-- Icon Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Icon&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;60&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> </div>
<div class="line">                                        <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{Binding IconKind}&quot;</span> </div>
<div class="line">                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;24&quot;</span> </div>
<div class="line">                                        <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span></div>
<div class="line">                                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                        <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Type Name Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Type Name&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding DunnageType}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Date Added Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Date Added&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding DateAdded, Converter={StaticResource DateTimeToStringConverter}}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Added By Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Added By&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding AddedBy}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Last Modified Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Last Modified&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding LastModified, Converter={StaticResource DateTimeToStringConverter}}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Modified By Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Modified By&quot;</span> </div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding ModifiedBy}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span></div>
<div class="line">                            <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Empty State --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> </div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> </div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Types.Count, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> </div>
<div class="line">                        <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7C3;&quot;</span> </div>
<div class="line">                        <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;72&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;No types found&quot;</span> </div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;Click &#39;Add New Type&#39; to create your first dunnage type&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> </div>
<div class="line">                <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> </div>
<div class="line">                <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;|&quot;</span></div>
<div class="line">                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0,8,0&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Total Types:&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Types.Count, Mode=OneWay}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md155"></a>
File: Module_Dunnage/Views/View_Dunnage_Control_IconPickerControl.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_Control_IconPickerControl&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:materialIcons</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:icons</span>=<span class="stringliteral">&quot;using:Material.Icons&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span> /&gt;</div>
<div class="line">        </div>
<div class="line">        &lt;<span class="keywordtype">Style</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IconGridViewItemStyle&quot;</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;GridViewItem&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;HorizontalContentAlignment&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;VerticalContentAlignment&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Margin&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;2&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Padding&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;0&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;CornerRadius&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;4&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;MinWidth&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;40&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;MinHeight&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;40&quot;</span> /&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Style</span>&gt;</div>
<div class="line"> </div>
<div class="line">        &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IconTemplate&quot;</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;icons:MaterialIconKind&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Border</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;40&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;40&quot;</span> </div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span> </div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> </div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;4&quot;</span> </div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ToString()}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">        </div>
<div class="line">        &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;RecentIconTemplate&quot;</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_IconDefinition&quot;</span>&gt;</div>
<div class="line">             &lt;<span class="keywordtype">Border</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;40&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;40&quot;</span> </div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span> </div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> </div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;4&quot;</span> </div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind Name}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind Kind}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Recently Used Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind RecentlyUsedIcons.Count, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Recently Used&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">GridView</span></div>
<div class="line">                <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;RecentIconsGrid&quot;</span></div>
<div class="line">                <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;60&quot;</span></div>
<div class="line">                <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind RecentlyUsedIcons, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">ItemTemplate</span>=<span class="stringliteral">&quot;{StaticResource RecentIconTemplate}&quot;</span></div>
<div class="line">                <span class="keyword">ItemContainerStyle</span>=<span class="stringliteral">&quot;{StaticResource IconGridViewItemStyle}&quot;</span></div>
<div class="line">                <span class="keyword">SelectionChanged</span>=<span class="stringliteral">&quot;OnRecentIconSelectionChanged&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">GridView.ItemsPanel</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ItemsPanelTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ItemsWrapGrid</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">MaximumRowsOrColumns</span>=<span class="stringliteral">&quot;6&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">ItemsPanelTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">GridView.ItemsPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">GridView</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Search Box --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">            <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;SearchBox&quot;</span></div>
<div class="line">            <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Search icons...&quot;</span></div>
<div class="line">            <span class="keyword">TextChanged</span>=<span class="stringliteral">&quot;OnSearchTextChanged&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- All Icons Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">GridView</span></div>
<div class="line">            <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;AllIconsGrid&quot;</span></div>
<div class="line">            <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">            <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind SelectedIcon, Mode=TwoWay}&quot;</span></div>
<div class="line">            <span class="keyword">ItemTemplate</span>=<span class="stringliteral">&quot;{StaticResource IconTemplate}&quot;</span></div>
<div class="line">            <span class="keyword">ItemContainerStyle</span>=<span class="stringliteral">&quot;{StaticResource IconGridViewItemStyle}&quot;</span></div>
<div class="line">            <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;300&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">GridView.ItemsPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ItemsPanelTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ItemsWrapGrid</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">MaximumRowsOrColumns</span>=<span class="stringliteral">&quot;6&quot;</span> /&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ItemsPanelTemplate</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">GridView.ItemsPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">GridView</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md156"></a>
File: Module_Dunnage/Views/View_Dunnage_DetailsEntryView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_DetailsEntryView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:views</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Views&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;views:View_Dunnage_DetailsEntryView&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Enter Details&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTip(&#39;Dunnage.DetailsEntry&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Inventory Notification --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                 <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsInventoryNotificationVisible, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Informational&quot;</span></div>
<div class="line">                 <span class="keyword">Title</span>=<span class="stringliteral">&quot;Inventory Action Required&quot;</span></div>
<div class="line">                 <span class="keyword">Message</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.InventoryNotificationMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                 <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Details Form --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                </div>
<div class="line">                <span class="comment">&lt;!-- PO Number and Location Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- PO Number --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;PO Number&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PoNumberTextBox&quot;</span></div>
<div class="line">                                     <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoNumber, Mode=TwoWay}&quot;</span></div>
<div class="line">                                     <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.PONumber&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                     <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Leave blank for non-PO dunnage&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Location --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Location&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Location, Mode=TwoWay}&quot;</span></div>
<div class="line">                                     <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.Location&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                     <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Where this dunnage is located&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Specifications Card (Read-Only) --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Specifications (from selected part)&quot;</span></div>
<div class="line">                                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        </div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            <span class="comment">&lt;!-- Column 1: Text Specs --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span> </div>
<div class="line">                                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HasTextSpecs, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ItemsRepeater</span> <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TextSpecs, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">ItemsRepeater.ItemTemplate</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,6&quot;</span>&gt;</div>
<div class="line">                                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding SpecName}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding Value, Mode=OneWay}&quot;</span> </div>
<div class="line">                                                         <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                                                         <span class="keyword">Width</span>=<span class="stringliteral">&quot;180&quot;</span>/&gt;</div>
<div class="line">                                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">ItemsRepeater.ItemTemplate</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">ItemsRepeater</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            <span class="comment">&lt;!-- Column 2: Number Specs --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HasNumberSpecs, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ItemsRepeater</span> <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NumberSpecs, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">ItemsRepeater.ItemTemplate</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,6&quot;</span>&gt;</div>
<div class="line">                                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding SpecName}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding Value, Mode=OneWay}&quot;</span> </div>
<div class="line">                                                         <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                                                         <span class="keyword">Width</span>=<span class="stringliteral">&quot;180&quot;</span>/&gt;</div>
<div class="line">                                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">ItemsRepeater.ItemTemplate</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">ItemsRepeater</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            <span class="comment">&lt;!-- Column 3: Boolean Specs --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HasBooleanSpecs, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ItemsRepeater</span> <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.BooleanSpecs, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">ItemsRepeater.ItemTemplate</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{Binding SpecName}&quot;</span> </div>
<div class="line">                                                      <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{Binding Value, Mode=OneWay}&quot;</span> </div>
<div class="line">                                                      <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                                                      <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,6&quot;</span>/&gt;</div>
<div class="line">                                        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">ItemsRepeater.ItemTemplate</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">ItemsRepeater</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Placeholder when no specs --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;No specifications configured for this type.&quot;</span></div>
<div class="line">                                   <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                                   <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SpecInputs.Count, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=&#39;Inverse&#39;}&quot;</span></div>
<div class="line">                                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Info Panel Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE946;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Note&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                                   <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;• PO Number: Use if receiving against a purchase order&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">LineBreak</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;• Location: Physical location of the dunnage&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">LineBreak</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;• Specifications: Pre-filled from the selected part&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md157"></a>
File: Module_Dunnage/Views/View_Dunnage_DetailsEntryView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_DetailsEntryView : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, PoNumberTextBox);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.LoadSpecsForSelectedPartAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md158"></a>
File: Module_Dunnage/Views/View_Dunnage_Dialog_AddMultipleRowsDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_Dialog_AddMultipleRowsDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Add Multiple Rows&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Add&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonClick</span>=<span class="stringliteral">&quot;ContentDialog_PrimaryButtonClick&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">            <span class="keyword">Text</span>=<span class="stringliteral">&quot;How many rows would you like to add?&quot;</span> </div>
<div class="line">            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">        </div>
<div class="line">        &lt;<span class="keywordtype">NumberBox</span> </div>
<div class="line">            <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;RowCountNumberBox&quot;</span></div>
<div class="line">            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Number of Rows&quot;</span></div>
<div class="line">            <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">            <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;100&quot;</span></div>
<div class="line">            <span class="keyword">Value</span>=<span class="stringliteral">&quot;10&quot;</span></div>
<div class="line">            <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">            <span class="keyword">ValidationMode</span>=<span class="stringliteral">&quot;InvalidInputOverwritten&quot;</span></div>
<div class="line">            <span class="keyword">AcceptsExpression</span>=<span class="stringliteral">&quot;False&quot;</span>/&gt;</div>
<div class="line">        </div>
<div class="line">        &lt;<span class="keywordtype">InfoBar</span> </div>
<div class="line">            <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">            <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Informational&quot;</span></div>
<div class="line">            <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">            <span class="keyword">Message</span>=<span class="stringliteral">&quot;Maximum 100 rows can be added at once. Each row will be initialized with default values (Quantity = 1).&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md159"></a>
File: Module_Dunnage/Views/View_Dunnage_Dialog_AddMultipleRowsDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_Dialog_AddMultipleRowsDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, RowCountNumberBox);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ContentDialog_PrimaryButtonClick(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md160"></a>
File: Module_Dunnage/Views/View_Dunnage_Dialog_AddToInventoriedListDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_Dialog_AddToInventoriedListDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Add Part to Inventoried List&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Add to List&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonClick</span>=<span class="stringliteral">&quot;OnPrimaryButtonClick&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;500&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- Part ID Selection --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ComboBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PartIdComboBox&quot;</span></div>
<div class="line">                      <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Select a part...&quot;</span></div>
<div class="line">                      <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                      <span class="keyword">IsEditable</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                      <span class="keyword">TextSubmitted</span>=<span class="stringliteral">&quot;PartIdComboBox_TextSubmitted&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PartIdError&quot;</span></div>
<div class="line">                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID is required&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemErrorTextColor}&quot;</span></div>
<div class="line">                       <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span></div>
<div class="line">                       <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,-8,0,0&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Inventory Method --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Inventory Method&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ComboBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;InventoryMethodComboBox&quot;</span></div>
<div class="line">                      <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                      <span class="keyword">SelectedIndex</span>=<span class="stringliteral">&quot;2&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Adjust In&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Receive In&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Both&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">ComboBox</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Adjust In: Only triggers during inventory adjustments&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlDisabledBaseMediumLowBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                       <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,-8,0,0&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Receive In: Only triggers during receiving transactions&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlDisabledBaseMediumLowBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Both: Triggers for both adjust and receive operations&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlDisabledBaseMediumLowBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Notes --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Notes (optional)&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NotesTextBox&quot;</span></div>
<div class="line">                     <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Add any notes or special instructions...&quot;</span></div>
<div class="line">                     <span class="keyword">AcceptsReturn</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                     <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                     <span class="keyword">Height</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md161"></a>
File: Module_Dunnage/Views/View_Dunnage_Dialog_AddToInventoriedListDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_Dialog_AddToInventoriedListDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_DunnagePart _daoPart;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_InventoriedDunnage _daoInventory;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadPartsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoPart.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">PartIdComboBox.ItemsSource = result.Data.ConvertAll(p =&gt; p.PartId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void PartIdComboBox_TextSubmitted(ComboBox sender, ComboBoxTextSubmittedEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrWhiteSpace(args.Text))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPrimaryButtonClick(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">var deferral = args.GetDeferral();</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(partId))</div>
<div class="line">⋮----</div>
<div class="line">var checkResult = await _daoInventory.GetByPartAsync(partId);</div>
<div class="line">⋮----</div>
<div class="line">var errorDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">await errorDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var insertResult = await _daoInventory.InsertAsync(</div>
<div class="line">⋮----</div>
<div class="line">deferral.Complete();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md162"></a>
File: Module_Dunnage/Views/View_Dunnage_Dialog_Dunnage_AddTypeDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_Dialog_Dunnage_AddTypeDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Views.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:materialIcons</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;Root&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Add New Dunnage Type&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Save Type&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;750&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonCommand</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SaveTypeCommand}&quot;</span></div>
<div class="line">    <span class="keyword">IsPrimaryButtonEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanSave, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Duplicate Warning InfoBar --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">InfoBar</span></div>
<div class="line">                <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Warning&quot;</span></div>
<div class="line">                <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowDuplicateWarning, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Title</span>=<span class="stringliteral">&quot;Duplicate Type Name&quot;</span></div>
<div class="line">                <span class="keyword">Message</span>=<span class="stringliteral">&quot;A type with this name already exists.&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">InfoBar.ActionButton</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">HyperlinkButton</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;View Existing Type&quot;</span> /&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">InfoBar.ActionButton</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">InfoBar</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Field Limit Warning InfoBar --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">InfoBar</span></div>
<div class="line">                <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Informational&quot;</span></div>
<div class="line">                <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowFieldLimitWarning, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Title</span>=<span class="stringliteral">&quot;Many Custom Fields&quot;</span></div>
<div class="line">                <span class="keyword">Message</span>=<span class="stringliteral">&quot;You have added 10+ custom fields. Consider grouping similar fields for better usability.&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Basic Information Section --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Basic Information&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Type Name --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Type Name&quot;</span></div>
<div class="line">                    <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter dunnage type name (e.g., Pallet - 48x40)&quot;</span></div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TypeName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TypeNameError, Mode=OneWay, Converter={StaticResource ErrorToBrushConverter}}&quot;</span></div>
<div class="line">                    <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;100&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span></div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TypeNameError, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Red&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TypeNameError, Mode=OneWay, Converter={StaticResource StringToVisibilityConverter}}&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,-8,0,0&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Icon Picker Button --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Icon&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> /&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;SelectIconButton&quot;</span></div>
<div class="line">                        <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnSelectIconClick&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16,12&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Click to browse and select an icon from the icon library&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> </div>
<div class="line">                            <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedIcon, Mode=OneWay}&quot;</span> </div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;32&quot;</span> </div>
<div class="line">                            <span class="keyword">Height</span>=<span class="stringliteral">&quot;32&quot;</span></div>
<div class="line">                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Click to select icon&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedIcon, Mode=OneWay}&quot;</span></div>
<div class="line">                                <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Custom Specifications Section --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Custom Specifications&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Add New Field Form --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span></div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add Custom Field&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Field Name&quot;</span></div>
<div class="line">                            <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter field name (e.g., Width, Material)&quot;</span></div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FieldName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FieldNameError, Mode=OneWay, Converter={StaticResource ErrorToBrushConverter}}&quot;</span></div>
<div class="line">                            <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;100&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,-8,0,0&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span></div>
<div class="line">                                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FieldNameError, Mode=OneWay}&quot;</span></div>
<div class="line">                                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Red&quot;</span></div>
<div class="line">                                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FieldNameError, Mode=OneWay, Converter={StaticResource StringToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span></div>
<div class="line">                                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FieldCharacterCount, Mode=OneWay}&quot;</span></div>
<div class="line">                                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                                <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span> /&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;/100 characters&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span> /&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">ComboBox</span></div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Field Type&quot;</span></div>
<div class="line">                            <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FieldType, Mode=TwoWay}&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">x:String</span>&gt;<span class="keyword">Text</span>&lt;/<span class="keywordtype">x:String</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">x:String</span>&gt;<span class="keyword">Number</span>&lt;/<span class="keywordtype">x:String</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">x:String</span>&gt;<span class="keyword">Dropdown</span>&lt;/<span class="keywordtype">x:String</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">x:String</span>&gt;<span class="keyword">Yes</span>/<span class="keyword">No</span>&lt;/<span class="keywordtype">x:String</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">ComboBox</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">CheckBox</span></div>
<div class="line">                            <span class="keyword">Content</span>=<span class="stringliteral">&quot;Required field&quot;</span></div>
<div class="line">                            <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsFieldRequired, Mode=TwoWay}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">Button</span></div>
<div class="line">                            <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.EditingField, Mode=OneWay, Converter={StaticResource EditingFieldToTextConverter}}&quot;</span></div>
<div class="line">                            <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddFieldCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanAddField, Mode=OneWay}&quot;</span></div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Field Preview List --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span></div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Custom Fields Preview&quot;</span></div>
<div class="line">                    <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CustomFields.Count, Mode=OneWay, Converter={StaticResource CountToVisibilityConverter}}&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">ItemsRepeater</span></div>
<div class="line">                    <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CustomFields, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ItemsRepeater.ItemTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_CustomFieldDefinition&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Border</span></div>
<div class="line">                                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,4&quot;</span></div>
<div class="line">                                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span> /&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                                    <span class="comment">&lt;!-- Drag Handle --&gt;</span></div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE76F;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                                    <span class="comment">&lt;!-- Field Info --&gt;</span></div>
<div class="line">                                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind FieldName}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> /&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span></div>
<div class="line">                                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind GetSummary()}&quot;</span></div>
<div class="line">                                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                                            <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span> /&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                                    <span class="comment">&lt;!-- Edit/Delete Buttons --&gt;</span></div>
<div class="line">                                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">Button</span></div>
<div class="line">                                            <span class="keyword">Content</span>=<span class="stringliteral">&quot;Edit&quot;</span></div>
<div class="line">                                            <span class="keyword">Command</span>=<span class="stringliteral">&quot;{Binding EditFieldCommand}&quot;</span></div>
<div class="line">                                            <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{x:Bind}&quot;</span></div>
<div class="line">                                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TextBlockButtonStyle}&quot;</span> /&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">Button</span></div>
<div class="line">                                            <span class="keyword">Content</span>=<span class="stringliteral">&quot;Delete&quot;</span></div>
<div class="line">                                            <span class="keyword">Command</span>=<span class="stringliteral">&quot;{Binding DeleteFieldCommand}&quot;</span></div>
<div class="line">                                            <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{x:Bind}&quot;</span></div>
<div class="line">                                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TextBlockButtonStyle}&quot;</span></div>
<div class="line">                                            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Red&quot;</span> /&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">ItemsRepeater.ItemTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ItemsRepeater</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span></div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;No custom fields added yet. Click &#39;Add Field&#39; to create one.&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CustomFields.Count, Mode=OneWay, Converter={StaticResource InverseCountToVisibilityConverter}}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md163"></a>
File: Module_Dunnage/Views/View_Dunnage_Dialog_Dunnage_AddTypeDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_Dialog_Dunnage_AddTypeDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnSelectIconClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var iconSelector = new View_Shared_IconSelectorWindow();</div>
<div class="line">iconSelector.SetInitialSelection(ViewModel.SelectedIcon);</div>
<div class="line">iconSelector.Activate();</div>
<div class="line">var selectedIcon = await iconSelector.WaitForSelectionAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md164"></a>
File: Module_Dunnage/Views/View_Dunnage_EditModeView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_EditModeView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:enums</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Models.Enums&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;Root&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_DecimalToString</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;DecimalToStringConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Toolbar - T154: 3 data source buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Main Toolbar Area --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                <span class="comment">&lt;!-- Load Data Section - T154 --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Load Data From:&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,4,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadFromCurrentMemoryCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LoadSessionMemory&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE81D;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Current Memory&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadFromCurrentLabelsCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LoadRecentCSV&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8E5;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Current Labels&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadFromHistoryCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LoadHistoricalData&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74C;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;History&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Separator --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Edit Actions Section --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectAllCommand}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B3;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Select All&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RemoveSelectedRowsCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.RemoveSelectedRows&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74D;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Remove Selected&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Date Filter Toolbar - T164: Dynamic button text --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Filter Date:&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">CalendarDatePicker</span> <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FromDate, Mode=TwoWay}&quot;</span> </div>
<div class="line">                                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.StartDate&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                   <span class="keyword">Width</span>=<span class="stringliteral">&quot;140&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;to&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">CalendarDatePicker</span> <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ToDate, Mode=TwoWay}&quot;</span> </div>
<div class="line">                                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.EndDate&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                   <span class="keyword">Width</span>=<span class="stringliteral">&quot;140&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                <span class="comment">&lt;!-- T158, T159, T160, T161, T162, T163, T164: Date filter buttons with dynamic text --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastWeekButtonText, Mode=OneTime}&quot;</span> </div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterLastWeekCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterLastWeek&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TodayButtonText, Mode=OneTime}&quot;</span> </div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterTodayCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterToday&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ThisWeekButtonText, Mode=OneTime}&quot;</span> </div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterThisWeekCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterThisWeek&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ThisMonthButtonText, Mode=OneTime}&quot;</span> </div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterThisMonthCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterThisMonth&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ThisQuarterButtonText, Mode=OneTime}&quot;</span> </div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterThisQuarterCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterThisQuarter&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Show All&quot;</span> </div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterShowAllCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterShowAll&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Data Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">controls:DataGrid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                          <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;EditModeDataGrid&quot;</span></div>
<div class="line">                          <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FilteredLoads, Mode=OneWay}&quot;</span></div>
<div class="line">                          <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                          <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                          <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                          <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;All&quot;</span></div>
<div class="line">                          <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                          <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                          <span class="keyword">KeyDown</span>=<span class="stringliteral">&quot;EditModeDataGrid_KeyDown&quot;</span></div>
<div class="line">                          <span class="keyword">CurrentCellChanged</span>=<span class="stringliteral">&quot;EditModeDataGrid_CurrentCellChanged&quot;</span></div>
<div class="line">                          <span class="keyword">Tapped</span>=<span class="stringliteral">&quot;EditModeDataGrid_Tapped&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;50&quot;</span> <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;False&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{Binding IsSelected, Mode=TwoWay}&quot;</span> </div>
<div class="line">                                      <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> </div>
<div class="line">                                      <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                      <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                      <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Load #&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding LoadNumber}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Type&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding TypeName}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartId}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Quantity&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Quantity}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;PO Number&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PoNumber}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Location&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Location}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Created Date&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CreatedDate}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Created By&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CreatedBy}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Footer: Pagination and Save --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Pagination Controls --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FirstPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FirstPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE892;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PreviousPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.PreviousPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE76B;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Page&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentPage, Mode=OneWay}&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;of&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TotalPages, Mode=OneWay}&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NextPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.NextPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE76C;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LastPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE893;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Save Button --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Save Changes&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SaveAllCommand}&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.SaveChanges&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md165"></a>
File: Module_Dunnage/Views/View_Dunnage_EditModeView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_EditModeView : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void EditModeDataGrid_CurrentCellChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">grid?.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_EditModeView] CurrentCellChanged: BeginEdit for Row={grid.SelectedIndex}, Col={grid.CurrentColumn.Header}&quot;);</div>
<div class="line">grid.BeginEdit();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void EditModeDataGrid_KeyDown(object sender, KeyRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var shiftState = InputKeyboardSource.GetKeyStateForCurrentThread(VirtualKey.Shift);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_EditModeView] KeyDown: Key={e.Key}, Shift={isShiftDown}, OriginalSource={e.OriginalSource}, CurrentColumn={grid.CurrentColumn?.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void EditModeDataGrid_Tapped(object sender, TappedRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_EditModeView] Tapped: OriginalSource={e.OriginalSource}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_EditModeView] Tapped: Grid empty&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_EditModeView] Tapped: SelectedItem is null (Header or empty space). Selecting first editable cell.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_EditModeView] Tapped: Cell clicked. Enqueuing BeginEdit.&quot;);</div>
<div class="line">grid.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_EditModeView] Tapped: BeginEdit for Row={grid.SelectedIndex}, Col={grid.CurrentColumn.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SelectFirstEditableCell(DataGrid grid)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_EditModeView] SelectFirstEditableCell: Starting&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var firstEditable = grid.Columns.OrderBy(c =&gt; c.DisplayIndex).FirstOrDefault(c =&gt; !c.IsReadOnly);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_EditModeView] SelectFirstEditableCell: Found editable column {firstEditable.Header}. Setting CurrentColumn and calling BeginEdit.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">grid.Focus(Microsoft.UI.Xaml.FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_EditModeView] SelectFirstEditableCell: BeginEdit called for column {firstEditable.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_EditModeView] SelectFirstEditableCell: No editable column found.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_EditModeView] SelectFirstEditableCell: Grid has no items (Count={itemCount})&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md166"></a>
File: Module_Dunnage/Views/View_Dunnage_ManualEntryView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_ManualEntryView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:enums</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Models.Enums&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;Root&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_DecimalToString</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;DecimalToStringConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_LoadNumberToOneBased</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;LoadNumberConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Toolbar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">HorizontalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Disabled&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddRowCommand}&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.AddRow&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE710;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add Row&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddMultipleRowsCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.AddMultipleRows&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE710;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add Multiple&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RemoveRowCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.RemoveRow&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74D;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Remove Row&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AutoFillCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.AutoFill&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74E;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Auto-Fill&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FillBlankSpacesCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FillBlanks&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B7;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Fill Blank Spaces&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SortForPrintingCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.SortForPrinting&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8CB;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Sort&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Data Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">controls:DataGrid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                          <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ManualEntryDataGrid&quot;</span></div>
<div class="line">                          <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Loads, Mode=OneWay}&quot;</span></div>
<div class="line">                          <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedLoad, Mode=TwoWay}&quot;</span></div>
<div class="line">                          <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                          <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                          <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                          <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;All&quot;</span></div>
<div class="line">                          <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                          <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                          <span class="keyword">KeyDown</span>=<span class="stringliteral">&quot;ManualEntryDataGrid_KeyDown&quot;</span></div>
<div class="line">                          <span class="keyword">CurrentCellChanged</span>=<span class="stringliteral">&quot;ManualEntryDataGrid_CurrentCellChanged&quot;</span></div>
<div class="line">                          <span class="keyword">Tapped</span>=<span class="stringliteral">&quot;ManualEntryDataGrid_Tapped&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Load #&quot;</span> </div>
<div class="line">                                           <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding LoadNumber, Converter={StaticResource LoadNumberConverter}}&quot;</span> </div>
<div class="line">                                           <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span> </div>
<div class="line">                                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Type&quot;</span> </div>
<div class="line">                                           <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding TypeName}&quot;</span> </div>
<div class="line">                                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                                           <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartId}&quot;</span> </div>
<div class="line">                                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Quantity&quot;</span> </div>
<div class="line">                                           <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Quantity}&quot;</span> </div>
<div class="line">                                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;PO Number&quot;</span> </div>
<div class="line">                                           <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PoNumber}&quot;</span> </div>
<div class="line">                                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Location&quot;</span> </div>
<div class="line">                                           <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Location}&quot;</span> </div>
<div class="line">                                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Home Location&quot;</span> </div>
<div class="line">                                           <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding HomeLocation}&quot;</span> </div>
<div class="line">                                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Navigation --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=&quot;<span class="keyword">Save</span> &amp;<span class="keyword">amp</span>; <span class="keyword">Finish</span><span class="stringliteral">&quot; Command=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.SaveAllCommand</span>}<span class="stringliteral">&quot; Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">AccentButtonStyle</span>}<span class="stringliteral">&quot; ToolTipService.ToolTip=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.GetTooltip</span>(<span class="stringliteral">&#39;Button.SaveAndFinish&#39;</span>), <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}&quot;/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md167"></a>
File: Module_Dunnage/Views/View_Dunnage_ManualEntryView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_ManualEntryView : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void Loads_CollectionChanged(object? sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_ManualEntryView] Loads_CollectionChanged: New row added&quot;);</div>
<div class="line">ManualEntryDataGrid.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_ManualEntryView] Loads_CollectionChanged: Selecting new item LoadNumber={newItem.LoadNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">ManualEntryDataGrid.ScrollIntoView(newItem, ManualEntryDataGrid.Columns.FirstOrDefault());</div>
<div class="line">_ = Task.Run(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line">await Task.Delay(100);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ManualEntryDataGrid_CurrentCellChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">grid?.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_ManualEntryView] CurrentCellChanged: BeginEdit for Row={grid.SelectedIndex}, Col={grid.CurrentColumn.Header}&quot;);</div>
<div class="line">grid.BeginEdit();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ManualEntryDataGrid_KeyDown(object sender, KeyRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var shiftState = InputKeyboardSource.GetKeyStateForCurrentThread(VirtualKey.Shift);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_ManualEntryView] KeyDown: Key={e.Key}, Shift={isShiftDown}, OriginalSource={e.OriginalSource}, CurrentColumn={grid.CurrentColumn?.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ManualEntryDataGrid_Tapped(object sender, TappedRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_ManualEntryView] Tapped: OriginalSource={e.OriginalSource}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_ManualEntryView] Tapped: Grid empty, triggering AddRow command.&quot;);</div>
<div class="line">if (ViewModel.AddRowCommand.CanExecute(null))</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.AddRowCommand.Execute(null);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_ManualEntryView] Tapped: SelectedItem is null (Header or empty space). Selecting first editable cell.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_ManualEntryView] Tapped: Cell clicked. Enqueuing BeginEdit.&quot;);</div>
<div class="line">grid.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_ManualEntryView] Tapped: BeginEdit for Row={grid.SelectedIndex}, Col={grid.CurrentColumn.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SelectFirstEditableCell(DataGrid grid)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_ManualEntryView] SelectFirstEditableCell: Starting&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var firstEditable = grid.Columns.OrderBy(c =&gt; c.DisplayIndex).FirstOrDefault(c =&gt; !c.IsReadOnly);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_ManualEntryView] SelectFirstEditableCell: Found editable column {firstEditable.Header}. Setting CurrentColumn and calling BeginEdit.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">grid.Focus(Microsoft.UI.Xaml.FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_ManualEntryView] SelectFirstEditableCell: BeginEdit called for column {firstEditable.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[Dunnage_ManualEntryView] SelectFirstEditableCell: No editable column found.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[Dunnage_ManualEntryView] SelectFirstEditableCell: Grid has no items (Count={itemCount})&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md168"></a>
File: Module_Dunnage/Views/View_Dunnage_ModeSelectionView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_ModeSelectionView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;32&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">                <span class="comment">&lt;!-- Guided Wizard Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectGuidedModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Guided Wizard Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE771;&quot;</span> </div>
<div class="line">                                      <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> </div>
<div class="line">                                      <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Guided Wizard&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Step-by-step workflow for dunnage receiving with validation at each stage.&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Guided Mode Checkbox --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                              <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsGuidedModeDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetGuidedAsDefaultCommand}&quot;</span></div>
<div class="line">                              <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                              <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Tooltip.Button.QuickGuidedWizard&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Manual Entry Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectManualModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Manual Entry Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7F0;&quot;</span> </div>
<div class="line">                                      <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> </div>
<div class="line">                                      <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manual Entry&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Bulk grid entry for receiving multiple dunnage items simultaneously.&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Manual Mode Checkbox --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                              <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManualModeDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetManualAsDefaultCommand}&quot;</span></div>
<div class="line">                              <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                              <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Tooltip.Button.QuickManualEntry&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Edit Mode Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectEditModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Edit Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE70F;&quot;</span> </div>
<div class="line">                                      <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> </div>
<div class="line">                                      <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Edit Mode&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Load historical dunnage records for editing and correction.&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Edit Mode Checkbox --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                              <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsEditModeDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetEditAsDefaultCommand}&quot;</span></div>
<div class="line">                              <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                              <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.QuickEditMode&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md169"></a>
File: Module_Dunnage/Views/View_Dunnage_ModeSelectionView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_ModeSelectionView : UserControl</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md170"></a>
File: Module_Dunnage/Views/View_Dunnage_PartSelectionView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_PartSelectionView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mi</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:views</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Views&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;views:View_Dunnage_PartSelectionView&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_EmptyStringToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;EmptyStringToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,24&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Select Part - &quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">mi:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedTypeIconKind, Mode=OneWay}&quot;</span> </div>
<div class="line">                                 <span class="keyword">Width</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span></div>
<div class="line">                                 <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                                 <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedTypeName, Mode=OneWay}&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTip(&#39;Dunnage.PartSelection&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Inventory Notification --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                 <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsInventoryNotificationVisible, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Warning&quot;</span></div>
<div class="line">                 <span class="keyword">Message</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.InventoryNotificationMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Part Selection Form --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">                </div>
<div class="line">                <span class="comment">&lt;!-- Part Dropdown --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Select Part&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ComboBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PartNumberComboBox&quot;</span></div>
<div class="line">                              <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AvailableParts, Mode=OneWay}&quot;</span></div>
<div class="line">                              <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPart, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">DisplayMemberPath</span>=<span class="stringliteral">&quot;PartId&quot;</span></div>
<div class="line">                              <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.PartSelection&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                              <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;300&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Part Details Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsPartSelected, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                                   <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part Details&quot;</span> </div>
<div class="line">                                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Details Grid --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Part ID --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID:&quot;</span> </div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPart.PartId, Mode=OneWay}&quot;</span> </div>
<div class="line">                                       <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Type --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;Type:&quot;</span> </div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">mi:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedTypeIconKind, Mode=OneWay}&quot;</span> </div>
<div class="line">                                                 <span class="keyword">Width</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                                 <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedTypeName, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Inventory Method (if applicable) --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> </div>
<div class="line">                                    <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> </div>
<div class="line">                                    <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsInventoryNotificationVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE946;&quot;</span> </div>
<div class="line">                                      <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> </div>
<div class="line">                                      <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorCautionBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Inventory Method:&quot;</span> </div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.InventoryMethod, Mode=OneWay}&quot;</span> </div>
<div class="line">                                       <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorCautionBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.QuickAddPartCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Left&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE710;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add New Part&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadPartsCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Left&quot;</span></div>
<div class="line">                            <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.Refresh&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE72C;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Refresh Parts&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md171"></a>
File: Module_Dunnage/Views/View_Dunnage_PartSelectionView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_PartSelectionView : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, PartNumberComboBox);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;Dunnage_PartSelectionView: OnLoaded called&quot;);</div>
<div class="line">await ViewModel.InitializeAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md172"></a>
File: Module_Dunnage/Views/View_Dunnage_QuantityEntryView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_QuantityEntryView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mi</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:views</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Views&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;views:View_Dunnage_QuantityEntryView&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_EmptyStringToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;EmptyStringToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Enter Quantity&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Specify how many labels you need to generate.&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Context Banner --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Selection Summary&quot;</span></div>
<div class="line">                           <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span></div>
<div class="line">                           <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;13&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Type:&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">mi:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedTypeIconKind, Mode=OneWay}&quot;</span> </div>
<div class="line">                                     <span class="keyword">Width</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                     <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedTypeName, Mode=OneWay}&quot;</span></div>
<div class="line">                               <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span></div>
<div class="line">                               <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part:&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPartName, Mode=OneWay}&quot;</span></div>
<div class="line">                               <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span></div>
<div class="line">                               <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Quantity Input --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                <span class="comment">&lt;!-- Quantity Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Quantity&quot;</span></div>
<div class="line">                                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;QuantityNumberBox&quot;</span></div>
<div class="line">                                   <span class="keyword">Value</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Quantity, Mode=TwoWay}&quot;</span></div>
<div class="line">                                   <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                   <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;9999&quot;</span></div>
<div class="line">                                   <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                                   <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.Quantity&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Validation Message --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ValidationMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                                   <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorCriticalBrush}&quot;</span></div>
<div class="line">                                   <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ValidationMessage, Mode=OneWay, Converter={StaticResource EmptyStringToVisibilityConverter}}&quot;</span></div>
<div class="line">                                   <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                                   <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Info Panel Card --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE946;&quot;</span> </div>
<div class="line">                                      <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> </div>
<div class="line">                                      <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Tip&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTip(&#39;Dunnage.QuantityEntry&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                   <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                                   <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                                   <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md173"></a>
File: Module_Dunnage/Views/View_Dunnage_QuantityEntryView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_QuantityEntryView : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, QuantityNumberBox);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.LoadContextData();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md174"></a>
File: Module_Dunnage/Views/View_Dunnage_QuickAddPartDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_QuickAddPartDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Add New Dunnage Part&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Add Part&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonClick</span>=<span class="stringliteral">&quot;OnPrimaryButtonClick&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonStyle</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">    <span class="keyword">Width</span>=<span class="stringliteral">&quot;500&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;500&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;20&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Instructions --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Enter details for the new dunnage part&quot;</span></div>
<div class="line">                <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Type Display (Read-only) --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Dunnage Type&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                               <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;TypeNameTextBlock&quot;</span></div>
<div class="line">                               <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Part ID Field --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID (Auto-generated)&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> </div>
<div class="line">                    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PartIdTextBox&quot;</span></div>
<div class="line">                    <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Auto-generated based on dimensions&quot;</span></div>
<div class="line">                    <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID is generated from Type and Dimensions&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Specifications Section --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Specifications&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Enter dimensions to generate the Part ID&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">&lt;!-- Width --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Width (in)&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;WidthNumberBox&quot;</span> </div>
<div class="line">                                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                   <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Hidden&quot;</span></div>
<div class="line">                                   <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                   <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;999&quot;</span></div>
<div class="line">                                   <span class="keyword">SmallChange</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                   <span class="keyword">LargeChange</span>=<span class="stringliteral">&quot;10&quot;</span></div>
<div class="line">                                   <span class="keyword">ValueChanged</span>=<span class="stringliteral">&quot;OnDimensionChanged&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">&lt;!-- Height --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Height (in)&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;HeightNumberBox&quot;</span> </div>
<div class="line">                                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                   <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Hidden&quot;</span></div>
<div class="line">                                   <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                   <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;999&quot;</span></div>
<div class="line">                                   <span class="keyword">SmallChange</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                   <span class="keyword">LargeChange</span>=<span class="stringliteral">&quot;10&quot;</span></div>
<div class="line">                                   <span class="keyword">ValueChanged</span>=<span class="stringliteral">&quot;OnDimensionChanged&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">&lt;!-- Depth --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Depth (in)&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;DepthNumberBox&quot;</span> </div>
<div class="line">                                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                   <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Hidden&quot;</span></div>
<div class="line">                                   <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                   <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;999&quot;</span></div>
<div class="line">                                   <span class="keyword">SmallChange</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                   <span class="keyword">LargeChange</span>=<span class="stringliteral">&quot;10&quot;</span></div>
<div class="line">                                   <span class="keyword">ValueChanged</span>=<span class="stringliteral">&quot;OnDimensionChanged&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Dynamic Specs Container --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;DynamicSpecsPanel&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Additional Notes --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Additional Notes (Optional)&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> </div>
<div class="line">                    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NotesTextBox&quot;</span></div>
<div class="line">                    <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Any additional specifications or notes&quot;</span></div>
<div class="line">                    <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                    <span class="keyword">AcceptsReturn</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;500&quot;</span></div>
<div class="line">                    <span class="keyword">Height</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md175"></a>
File: Module_Dunnage/Views/View_Dunnage_QuickAddTypeDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_QuickAddTypeDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:materialIcons</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:local</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Views&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Add New Dunnage Type&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Add Type&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonClick</span>=<span class="stringliteral">&quot;OnPrimaryButtonClick&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonStyle</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">    <span class="keyword">Width</span>=<span class="stringliteral">&quot;900&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">ContentDialog.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IconCodeToGlyph</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IconCodeToGlyphConverter&quot;</span>/&gt;</div>
<div class="line">        <span class="comment">&lt;!-- Help Button Style --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Style</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;HelpButtonStyle&quot;</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;Button&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Background&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;Transparent&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Padding&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;8&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;CornerRadius&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;4&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Style</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">ContentDialog.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span> <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;600&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Header with Help Button --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Enter details for the new dunnage type&quot;</span></div>
<div class="line">                    <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;HelpButton&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span></div>
<div class="line">                        <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Top&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource HelpButtonStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Click for help about dunnage types&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE946;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Help&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button.Flyout</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Flyout</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;400&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Dunnage Types&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">Border</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Left&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;60&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>&gt;<span class="keyword">Define</span> <span class="keyword">categories</span> <span class="keyword">of</span> <span class="keyword">dunnage</span> <span class="keyword">materials</span> <span class="keyword">for</span> <span class="keyword">receiving</span> <span class="keyword">classification.</span>&lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                </div>
<div class="line">                                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;6&quot;</span> <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Type Name&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;13&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>&gt;<span class="keyword">Choose</span> <span class="keyword">a</span> <span class="keyword">descriptive</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="stringliteral">&#39;Pallet&#39;</span>, <span class="stringliteral">&#39;Crate&#39;</span>, <span class="keyword">or</span> <span class="stringliteral">&#39;Foam Insert&#39;</span>. <span class="keyword">This</span> <span class="keyword">will</span> <span class="keyword">be</span> <span class="keyword">displayed</span> <span class="keyword">in</span> <span class="keyword">selection</span> <span class="keyword">lists.</span>&lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                                </div>
<div class="line">                                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;6&quot;</span> <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Specifications&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;13&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>&gt;<span class="keyword">Add</span> <span class="keyword">custom</span> <span class="keyword">fields</span> <span class="keyword">to</span> <span class="keyword">capture</span> <span class="keyword">specific</span> <span class="keyword">data</span> <span class="keyword">for</span> <span class="keyword">this</span> <span class="keyword">type.</span> <span class="keyword">For</span> <span class="keyword">example</span>, <span class="stringliteral">&#39;Material&#39;</span> (<span class="keyword">Text</span>), <span class="stringliteral">&#39;Weight Capacity&#39;</span> (<span class="keyword">Number</span> <span class="keyword">with</span> <span class="keyword">unit</span> <span class="stringliteral">&#39;lbs&#39;</span>), <span class="keyword">or</span> <span class="stringliteral">&#39;Recyclable&#39;</span> (<span class="keyword">Boolean</span>).&lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                                </div>
<div class="line">                                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorAttentionBackgroundBrush}&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;6&quot;</span> <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorAttentionBrush}&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE946;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorAttentionBrush}&quot;</span>/&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Tip&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorAttentionBrush}&quot;</span>/&gt;</div>
<div class="line">                                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;11&quot;</span>&gt;<span class="keyword">Required</span> <span class="keyword">specs</span> <span class="keyword">must</span> <span class="keyword">be</span> <span class="keyword">filled</span> <span class="keyword">when</span> <span class="keyword">creating</span> <span class="keyword">new</span> <span class="keyword">parts.</span> <span class="keyword">Use</span> <span class="keyword">Number</span> <span class="keyword">type</span> <span class="keyword">for</span> <span class="keyword">measurements</span> <span class="keyword">and</span> <span class="keyword">validation.</span>&lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Flyout</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button.Flyout</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Type Name Field --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Type Name&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> </div>
<div class="line">                    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;TypeNameTextBox&quot;</span></div>
<div class="line">                    <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;e.g., Pallet, Crate, Blocking&quot;</span></div>
<div class="line">                    <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;100&quot;</span></div>
<div class="line">                    <span class="keyword">TextChanged</span>=<span class="stringliteral">&quot;OnTypeNameChanged&quot;</span></div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Enter a unique descriptive name for this dunnage type&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ValidationTextBlock&quot;</span></div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Type name is required&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorCriticalBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Icon Selection --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Select Icon&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;Choose an icon to represent this type&quot;</span></div>
<div class="line">                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;SelectIconButton&quot;</span></div>
<div class="line">                        <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnSelectIconClick&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16,12&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Click to browse and select an icon from the icon library&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;SelectedIconDisplay&quot;</span> </div>
<div class="line">                                  <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind SelectedIconKind, Mode=OneWay}&quot;</span> </div>
<div class="line">                                  <span class="keyword">Width</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span></div>
<div class="line">                                  <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Click to select icon&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;SelectedIconNameText&quot;</span></div>
<div class="line">                                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;Box&quot;</span></div>
<div class="line">                                       <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Specifications --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Specifications&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;Define custom fields to capture specific data for this dunnage type&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            </div>
<div class="line">                <span class="comment">&lt;!-- Add Spec Form --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> </div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;6&quot;</span> </div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource SurfaceStrokeColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NewSpecNameBox&quot;</span> </div>
<div class="line">                                     <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Field Name (e.g. Material, Weight)&quot;</span></div>
<div class="line">                                     <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Enter a unique name for this specification field&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">ComboBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NewSpecTypeCombo&quot;</span> </div>
<div class="line">                                      <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                      <span class="keyword">SelectedIndex</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                                      <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                                      <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Select the data type for this field&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Text&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Number&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Boolean&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">ComboBox</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Number Type Options --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NumberOptionsPanel&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Number Validation&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NewSpecMinValueBox&quot;</span> </div>
<div class="line">                                           <span class="keyword">Header</span>=<span class="stringliteral">&quot;Min Value&quot;</span> </div>
<div class="line">                                           <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Optional&quot;</span></div>
<div class="line">                                           <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Compact&quot;</span></div>
<div class="line">                                           <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Minimum allowed value (optional)&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NewSpecMaxValueBox&quot;</span> </div>
<div class="line">                                           <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                           <span class="keyword">Header</span>=<span class="stringliteral">&quot;Max Value&quot;</span> </div>
<div class="line">                                           <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Optional&quot;</span></div>
<div class="line">                                           <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Compact&quot;</span></div>
<div class="line">                                           <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Maximum allowed value (optional)&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NewSpecUnitBox&quot;</span> </div>
<div class="line">                                         <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                                         <span class="keyword">Header</span>=<span class="stringliteral">&quot;Unit&quot;</span> </div>
<div class="line">                                         <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;e.g. inches, lbs&quot;</span></div>
<div class="line">                                         <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Unit of measurement (optional)&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        </div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NewSpecRequiredCheck&quot;</span> </div>
<div class="line">                                          <span class="keyword">Content</span>=<span class="stringliteral">&quot;Required Field&quot;</span></div>
<div class="line">                                          <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Check if this field is required&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Add Field&quot;</span> </div>
<div class="line">                                    <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnAddSpecClick&quot;</span> </div>
<div class="line">                                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Add this specification to the list below&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">ListView</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;SpecsListView&quot;</span> </div>
<div class="line">                          <span class="keyword">Height</span>=<span class="stringliteral">&quot;130&quot;</span></div>
<div class="line">                          <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                          <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource SurfaceStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                          <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;6&quot;</span></div>
<div class="line">                          <span class="keyword">Padding</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                          <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;List of specifications defined for this type&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_SpecItem&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;0,4&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;2&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind Name}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;13&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind Description}&quot;</span> </div>
<div class="line">                                           <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;11&quot;</span> </div>
<div class="line">                                           <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorAttentionBackgroundBrush}&quot;</span></div>
<div class="line">                                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;3&quot;</span></div>
<div class="line">                                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;6,2&quot;</span></div>
<div class="line">                                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span></div>
<div class="line">                                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind IsRequiredVisibility}&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Required&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;10&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> </div>
<div class="line">                                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;&amp;#xE74D;&quot;</span></div>
<div class="line">                                    <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;Segoe MDL2 Assets&quot;</span></div>
<div class="line">                                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Remove this specification&quot;</span></div>
<div class="line">                                    <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnRemoveSpecClick&quot;</span> </div>
<div class="line">                                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtleButtonStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">ListView</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md176"></a>
File: Module_Dunnage/Views/View_Dunnage_QuickAddTypeDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_QuickAddTypeDialog : ContentDialog, INotifyPropertyChanged</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> MaterialIconKind _selectedIcon = MaterialIconKind.PackageVariantClosed;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnSpecTypeChanged(object sender, SelectionChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var type = item.Content.ToString();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void InitializeForEdit(string typeName, string iconName, Dictionary&lt;string, SpecDefinition&gt; specs)</div>
<div class="line">⋮----</div>
<div class="line">SelectedIconNameText.Text = kind.ToString();</div>
<div class="line">⋮----</div>
<div class="line">Specs.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Specs.Add(new Model_SpecItem</div>
<div class="line">⋮----</div>
<div class="line">private void OnAddSpecClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">private void AddSpec()</div>
<div class="line">⋮----</div>
<div class="line">var name = NewSpecNameBox.Text.Trim();</div>
<div class="line">if (string.IsNullOrWhiteSpace(name))</div>
<div class="line">⋮----</div>
<div class="line">if (Specs.Any(s =&gt; s.Name.Equals(name, System.StringComparison.OrdinalIgnoreCase)))</div>
<div class="line">⋮----</div>
<div class="line">var type = typeItem?.Content.ToString() ?? &quot;Text&quot;;</div>
<div class="line">⋮----</div>
<div class="line">unit = NewSpecUnitBox.Text.Trim();</div>
<div class="line">if (!double.IsNaN(NewSpecMinValueBox.Value))</div>
<div class="line">⋮----</div>
<div class="line">if (!double.IsNaN(NewSpecMaxValueBox.Value))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnRemoveSpecClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">Specs.Remove(spec);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnSelectIconClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var hwnd = WinRT.Interop.WindowNative.GetWindowHandle(iconWindow);</div>
<div class="line">var windowId = Microsoft.UI.Win32Interop.GetWindowIdFromWindow(hwnd);</div>
<div class="line">var appWindow = Microsoft.UI.Windowing.AppWindow.GetFromWindowId(windowId);</div>
<div class="line">iconWindow.Activate();</div>
<div class="line">⋮----</div>
<div class="line">iconWindow.Closed += (s, args) =&gt; tcs.SetResult(true);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnTypeNameChanged(object sender, TextChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnPrimaryButtonClick(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">var input = TypeNameTextBox.Text.Trim();</div>
<div class="line">if (string.IsNullOrWhiteSpace(input))</div>
<div class="line">⋮----</div>
<div class="line">if (!char.IsUpper(input[0]))</div>
<div class="line">⋮----</div>
<div class="line">if (input.Contains(&quot; &quot;))</div>
<div class="line">⋮----</div>
<div class="line">if (!AlphanumericRegex().IsMatch(input))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> static partial System.Text.RegularExpressions.Regex AlphanumericRegex();</div>
<div class="line"><span class="keyword">private</span> void ShowError(string message)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnPropertyChanged([CallerMemberName] string? propertyName = null)</div>
<div class="line">⋮----</div>
<div class="line">PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md177"></a>
File: Module_Dunnage/Views/View_Dunnage_ReviewView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_ReviewView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mi</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:views</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Views&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;views:View_Dunnage_ReviewView&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_EmptyStringToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;EmptyStringToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Success Message --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                 <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsSuccessMessageVisible, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Success&quot;</span></div>
<div class="line">                 <span class="keyword">Message</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SuccessMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;False&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">InfoBar.ActionButton</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Start New Entry&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StartNewEntryCommand}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">InfoBar.ActionButton</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">InfoBar</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Content Section with View Toggle --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Single Entry View --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsSingleView, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Entry Counter --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                       <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12,6&quot;</span></div>
<div class="line">                       <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8,8,0,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8FD;&quot;</span> </div>
<div class="line">                                 <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> </div>
<div class="line">                                 <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;White&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                                   <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;White&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Entry&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntryIndex, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;of&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadCount, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Single Entry Form --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                           <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                           <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1,0,1,1&quot;</span></div>
<div class="line">                           <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;0,0,8,8&quot;</span></div>
<div class="line">                           <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;900&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Left Column --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Load Details&quot;</span> </div>
<div class="line">                                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                                          <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,8&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Type&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">mi:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentLoad.TypeIconKind, Mode=OneWay}&quot;</span> </div>
<div class="line">                                                         <span class="keyword">Width</span>=<span class="stringliteral">&quot;18&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;18&quot;</span></div>
<div class="line">                                                         <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentLoad.TypeName, Mode=OneWay}&quot;</span> </div>
<div class="line">                                                  <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentLoad.PartId, Mode=OneWay}&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Quantity&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentLoad.Quantity, Mode=OneWay}&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Right Column --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;12,0,0,0&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Additional Information&quot;</span> </div>
<div class="line">                                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                                          <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,8&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;PO Number&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentLoad.PoNumber, Mode=OneWay}&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Location&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentLoad.Location, Mode=OneWay}&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Inventory Method&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentLoad.InventoryMethod, Mode=OneWay}&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Navigation Bar for Single View --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Back&quot;</span> </div>
<div class="line">                                 <span class="keyword">Label</span>=<span class="stringliteral">&quot;Previous&quot;</span> </div>
<div class="line">                                 <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PreviousEntryCommand}&quot;</span></div>
<div class="line">                                 <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanGoBack, Mode=OneWay}&quot;</span></div>
<div class="line">                                 <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Previous Entry&quot;</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Forward&quot;</span> </div>
<div class="line">                                 <span class="keyword">Label</span>=<span class="stringliteral">&quot;Next&quot;</span> </div>
<div class="line">                                 <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NextEntryCommand}&quot;</span></div>
<div class="line">                                 <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanGoNext, Mode=OneWay}&quot;</span></div>
<div class="line">                                 <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Next Entry&quot;</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;ViewAll&quot;</span> </div>
<div class="line">                                 <span class="keyword">Label</span>=<span class="stringliteral">&quot;Table View&quot;</span> </div>
<div class="line">                                 <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SwitchToTableViewCommand}&quot;</span></div>
<div class="line">                                 <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Switch to Table View&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Table View (DataGrid) --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsTableView, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                       <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                       <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                       <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGrid</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ReviewDataGrid&quot;</span></div>
<div class="line">                                      <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SessionLoads, Mode=OneWay}&quot;</span></div>
<div class="line">                                      <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                                      <span class="keyword">CanUserReorderColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                                      <span class="keyword">CanUserResizeColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                                      <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                                      <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;None&quot;</span></div>
<div class="line">                                      <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                                      <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                                      <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Type&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding TypeName}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartId}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Quantity&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Quantity}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;PO Number&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PoNumber}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Location&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Location}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Inventory Method&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding InventoryMethod}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Navigation Bar for Table View --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Label</span>=<span class="stringliteral">&quot;Single View&quot;</span> </div>
<div class="line">                                 <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SwitchToSingleViewCommand}&quot;</span></div>
<div class="line">                                 <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Switch to Single View&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">AppBarButton.Icon</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8FD;&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">AppBarButton.Icon</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">AppBarButton</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                   <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddAnotherCommand}&quot;</span></div>
<div class="line">                   <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Add Another Load&quot;</span></div>
<div class="line">                   <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.AddAnother&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE710;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add Another&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> </div>
<div class="line">                   <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SaveAllCommand}&quot;</span></div>
<div class="line">                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                   <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanSave, Mode=OneWay}&quot;</span></div>
<div class="line">                   <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Save to Database&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74E;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Save All&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md178"></a>
File: Module_Dunnage/Views/View_Dunnage_ReviewView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_ReviewView : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.LoadSessionLoads();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md179"></a>
File: Module_Receiving/Models/Model_Application_Variables.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_Application_Variables</div>
<div class="line">⋮----</div>
<div class="line">public string LogDirectory { <span class="keyword">get</span>; <span class="keyword">set</span>; } = Path.Combine(</div>
<div class="line">Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md180"></a>
File: Module_Receiving/Models/Model_CSVDeleteResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_CSVDeleteResult</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md181"></a>
File: Module_Receiving/Models/Model_CSVExistenceResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_CSVExistenceResult</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md182"></a>
File: Module_Receiving/Models/Model_CSVWriteResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_CSVWriteResult</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md183"></a>
File: Module_Receiving/Models/Model_InforVisualPart.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_InforVisualPart</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md184"></a>
File: Module_Receiving/Models/Model_InforVisualPO.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_InforVisualPO</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md185"></a>
File: Module_Receiving/Models/Model_PackageTypePreference.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_PackageTypePreference</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md186"></a>
File: Module_Receiving/Models/Model_SaveResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_SaveResult</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md187"></a>
File: Module_Receiving/Models/Model_UserPreference.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_UserPreference : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _lastUpdated;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md188"></a>
File: Module_Receiving/Models/Model_WorkflowStepResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_WorkflowStepResult</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md189"></a>
File: Module_Receiving/Views/View_Receiving_EditMode.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_EditMode&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Receiving.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:enums</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Models.Enums&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;Root&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_DecimalToString</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;DecimalToStringConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Toolbar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Main Toolbar Area --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                <span class="comment">&lt;!-- Load Data Section --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Load Data From:&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,4,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadFromCurrentMemoryCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LoadSessionMemory&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8A7;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Current Memory&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadFromCurrentLabelsCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LoadRecentCSV&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8E5;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Current Labels&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadFromHistoryCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LoadHistoricalData&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74C;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;History&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Separator --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Edit Actions Section --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectAllCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.SelectAll&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B3;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectAllButtonText, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RemoveRowCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.RemoveRow&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74D;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Remove Row&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Date Filter Toolbar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Filter Date:&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">CalendarDatePicker</span> <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FilterStartDate, Mode=TwoWay}&quot;</span> </div>
<div class="line">                                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.StartDate&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                   <span class="keyword">Width</span>=<span class="stringliteral">&quot;140&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;to&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">CalendarDatePicker</span> <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FilterEndDate, Mode=TwoWay}&quot;</span> </div>
<div class="line">                                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.EndDate&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                   <span class="keyword">Width</span>=<span class="stringliteral">&quot;140&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Last Week&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterLastWeekCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterLastWeek&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Today&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterTodayCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterToday&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;This Week&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterThisWeekCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterThisWeek&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ThisMonthButtonText, Mode=OneWay}&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterThisMonthCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterThisMonth&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ThisQuarterButtonText, Mode=OneWay}&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterThisQuarterCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FilterThisQuarter&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Show All&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetFilterShowAllCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.ClearFilters&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Data Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">controls:DataGrid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                          <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;EditModeDataGrid&quot;</span></div>
<div class="line">                          <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Loads, Mode=OneWay}&quot;</span></div>
<div class="line">                          <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedLoad, Mode=TwoWay}&quot;</span></div>
<div class="line">                          <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                          <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                          <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                          <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;All&quot;</span></div>
<div class="line">                          <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                          <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                          <span class="keyword">KeyDown</span>=<span class="stringliteral">&quot;EditModeDataGrid_KeyDown&quot;</span></div>
<div class="line">                          <span class="keyword">CurrentCellChanged</span>=<span class="stringliteral">&quot;EditModeDataGrid_CurrentCellChanged&quot;</span></div>
<div class="line">                          <span class="keyword">Tapped</span>=<span class="stringliteral">&quot;EditModeDataGrid_Tapped&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;50&quot;</span> <span class="keyword">CanUserResize</span>=<span class="stringliteral">&quot;False&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{Binding IsSelected, Mode=TwoWay}&quot;</span> </div>
<div class="line">                                      <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> </div>
<div class="line">                                      <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                      <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                      <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Load #&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding LoadNumber}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartID}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Weight/Qty&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding WeightQuantity, Converter={StaticResource DecimalToStringConverter}}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Heat/Lot&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding HeatLotNumber}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Pkg Type&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PackageType}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Pkgs/Load&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PackagesPerLoad}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Wt/Pkg&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding WeightPerPackage, Converter={StaticResource DecimalToStringConverter}}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Footer: Pagination and Save --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Pagination Controls --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FirstPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FirstPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE892;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PreviousPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.PreviousPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE76B;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Page&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GotoPageNumber, Mode=TwoWay}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;60&quot;</span> <span class="keyword">HorizontalContentAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;of&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.TotalPages, Mode=OneWay}&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Go&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GoToPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.GoToPage&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Rectangle</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">Fill</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseLowBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NextPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.NextPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE76C;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastPageCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LastPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE893;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Save Button --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=&quot;<span class="keyword">Save</span> &amp;<span class="keyword">amp</span>; <span class="keyword">Finish</span><span class="stringliteral">&quot; Command=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.SaveCommand</span>}<span class="stringliteral">&quot; Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">AccentButtonStyle</span>}<span class="stringliteral">&quot; ToolTipService.ToolTip=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.GetTooltip</span>(<span class="stringliteral">&#39;Button.SaveAndFinish&#39;</span>), <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}&quot;/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md190"></a>
File: Module_Receiving/Views/View_Receiving_EditMode.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_EditMode : UserControl</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void EditModeDataGrid_CurrentCellChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">grid?.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[EditModeView] CurrentCellChanged: BeginEdit for Row={grid.SelectedIndex}, Col={grid.CurrentColumn.Header}&quot;);</div>
<div class="line">grid.BeginEdit();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void EditModeDataGrid_KeyDown(object sender, KeyRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var shiftState = InputKeyboardSource.GetKeyStateForCurrentThread(VirtualKey.Shift);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[EditModeView] KeyDown: Key={e.Key}, Shift={isShiftDown}, OriginalSource={e.OriginalSource}, CurrentColumn={grid.CurrentColumn?.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void EditModeDataGrid_Tapped(object sender, TappedRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[EditModeView] Tapped: OriginalSource={e.OriginalSource}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[EditModeView] Tapped: SelectedItem is null (Header or empty space). Selecting first editable cell.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[EditModeView] Tapped: Cell clicked. Enqueuing BeginEdit.&quot;);</div>
<div class="line">grid.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[EditModeView] Tapped: BeginEdit for Row={grid.SelectedIndex}, Col={grid.CurrentColumn.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SelectFirstEditableCell(DataGrid grid)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[EditModeView] SelectFirstEditableCell: Starting&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var firstEditable = grid.Columns.OrderBy(c =&gt; c.DisplayIndex).FirstOrDefault(c =&gt; !c.IsReadOnly);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[EditModeView] SelectFirstEditableCell: Found editable column {firstEditable.Header}. Setting CurrentColumn and calling BeginEdit.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">grid.Focus(Microsoft.UI.Xaml.FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[EditModeView] SelectFirstEditableCell: BeginEdit called for column {firstEditable.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[EditModeView] SelectFirstEditableCell: No editable column found.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[EditModeView] SelectFirstEditableCell: Grid has no items (Count={itemCount})&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md191"></a>
File: Module_Receiving/Views/View_Receiving_HeatLot.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_HeatLot&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_StringFormat</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;StringFormatConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        <span class="comment">&lt;!-- Content Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Load Entries&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                            <span class="keyword">Content</span>=<span class="stringliteral">&quot;Auto-Fill&quot;</span> </div>
<div class="line">                            <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AutoFillCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                            <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Fill blank heat numbers from rows above&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">            </div>
<div class="line">                &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span> <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;500&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ItemsControl</span> <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Loads, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ItemsControl.ItemTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">Border</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span> </div>
<div class="line">                                       <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span> </div>
<div class="line">                                       <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span> </div>
<div class="line">                                       <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span> </div>
<div class="line">                                       <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                                       <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                        &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                        </div>
<div class="line">                                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> </div>
<div class="line">                                                         <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                                         <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding LoadNumber, Converter={StaticResource StringFormatConverter}, ConverterParameter=&#39;Load #{0}&#39;}&quot;</span> </div>
<div class="line">                                                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                        </div>
<div class="line">                                        &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                                <span class="keyword">Header</span>=<span class="stringliteral">&quot;Heat/Lot Number (Optional)&quot;</span></div>
<div class="line">                                                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding HeatLotNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span></div>
<div class="line">                                                <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter heat/lot number or leave blank&quot;</span></div>
<div class="line">                                                <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Heat Lot Number&quot;</span>/&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">ItemsControl.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">ItemsControl</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md192"></a>
File: Module_Receiving/Views/View_Receiving_HeatLot.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_HeatLot : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void HeatLotView_Loaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.OnNavigatedToAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md193"></a>
File: Module_Receiving/Views/View_Receiving_LoadEntry.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_LoadEntry&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;32&quot;</span></div>
<div class="line">                <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;500&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> </div>
<div class="line">                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span></div>
<div class="line">                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                             <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPartInfo, Mode=OneWay}&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                               <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span></div>
<div class="line">                               <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                               <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NumberOfLoadsNumberBox&quot;</span></div>
<div class="line">                           <span class="keyword">Header</span>=<span class="stringliteral">&quot;Number of Loads (1-99)&quot;</span></div>
<div class="line">                           <span class="keyword">Value</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NumberOfLoads, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span></div>
<div class="line">                           <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                           <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;99&quot;</span></div>
<div class="line">                           <span class="keyword">SmallChange</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                           <span class="keyword">LargeChange</span>=<span class="stringliteral">&quot;10&quot;</span></div>
<div class="line">                           <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;250&quot;</span></div>
<div class="line">                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                           <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Number of Loads&quot;</span>/&gt;</div>
<div class="line">                       </div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Enter the total number of skids/loads for this part.&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                           <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                           <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md194"></a>
File: Module_Receiving/Views/View_Receiving_LoadEntry.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_LoadEntry : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, NumberOfLoadsNumberBox);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md195"></a>
File: Module_Receiving/Views/View_Receiving_ManualEntry.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_ManualEntry&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Receiving.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:enums</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Models.Enums&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;Root&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_DecimalToString</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;DecimalToStringConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Toolbar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;AddRowButton&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddRowCommand}&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.AddRow&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE710;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add Row&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddMultipleRowsCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.AddMultipleRows&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE710;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add Multiple&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RemoveRowCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.RemoveRow&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74D;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Remove Row&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AutoFillCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.AutoFill&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74E;&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Auto-Fill&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Data Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">controls:DataGrid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                          <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ManualEntryDataGrid&quot;</span></div>
<div class="line">                          <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Loads, Mode=OneWay}&quot;</span></div>
<div class="line">                          <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedLoad, Mode=TwoWay}&quot;</span></div>
<div class="line">                          <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                          <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                          <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                          <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;All&quot;</span></div>
<div class="line">                          <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                          <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                          <span class="keyword">KeyDown</span>=<span class="stringliteral">&quot;ManualEntryDataGrid_KeyDown&quot;</span></div>
<div class="line">                          <span class="keyword">CurrentCellChanged</span>=<span class="stringliteral">&quot;ManualEntryDataGrid_CurrentCellChanged&quot;</span></div>
<div class="line">                          <span class="keyword">Tapped</span>=<span class="stringliteral">&quot;ManualEntryDataGrid_Tapped&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Load #&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding LoadNumber}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartID}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Weight/Qty&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding WeightQuantity, Converter={StaticResource DecimalToStringConverter}}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Heat/Lot&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding HeatLotNumber}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Pkg Type&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PackageType}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Pkgs/Load&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PackagesPerLoad}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Wt/Pkg&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding WeightPerPackage, Converter={StaticResource DecimalToStringConverter}}&quot;</span> <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Navigation --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=&quot;<span class="keyword">Save</span> &amp;<span class="keyword">amp</span>; <span class="keyword">Finish</span><span class="stringliteral">&quot; Command=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.SaveCommand</span>}<span class="stringliteral">&quot; Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">AccentButtonStyle</span>}<span class="stringliteral">&quot; ToolTipService.ToolTip=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.GetTooltip</span>(<span class="stringliteral">&#39;Button.SaveAndFinish&#39;</span>), <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}&quot;/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md196"></a>
File: Module_Receiving/Views/View_Receiving_ModeSelection.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_ModeSelection&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Receiving.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;32&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">                <span class="comment">&lt;!-- Guided Mode Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectGuidedModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Guided Wizard Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE771;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Guided Wizard&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Step-by-step process for standard receiving workflow.&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Guided Mode Checkbox --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                              <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsGuidedModeDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetGuidedAsDefaultCommand}&quot;</span></div>
<div class="line">                              <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                              <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.QuickGuidedWizard&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Manual Mode Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectManualModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Manual Entry Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7F0;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manual Entry&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Customizable grid for bulk data entry and editing.&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Manual Mode Checkbox --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                              <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManualModeDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetManualAsDefaultCommand}&quot;</span></div>
<div class="line">                              <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                              <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.QuickManualEntry&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Edit Mode Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectEditModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Edit Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE70F;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Edit Mode&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Edit existing loads without adding new ones.&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Edit Mode Checkbox --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                              <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsEditModeDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetEditAsDefaultCommand}&quot;</span></div>
<div class="line">                              <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                              <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.QuickEditMode&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md197"></a>
File: Module_Receiving/Views/View_Receiving_ModeSelection.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_ModeSelection : UserControl</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md198"></a>
File: Module_Receiving/Views/View_Receiving_PackageType.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_PackageType&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_StringFormat</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;StringFormatConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">&lt;!-- Package Type Selection --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Top&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Package Type (Applied to all loads)&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ComboBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PackageTypeComboBox&quot;</span></div>
<div class="line">                              <span class="keyword">Header</span>=<span class="stringliteral">&quot;Type&quot;</span></div>
<div class="line">                              <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PackageTypes, Mode=OneWay}&quot;</span></div>
<div class="line">                              <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPackageType, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Width</span>=<span class="stringliteral">&quot;200&quot;</span></div>
<div class="line">                              <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Package Type&quot;</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Custom Name&quot;</span></div>
<div class="line">                             <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CustomPackageTypeName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span></div>
<div class="line">                             <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsCustomTypeVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                             <span class="keyword">Width</span>=<span class="stringliteral">&quot;200&quot;</span></div>
<div class="line">                             <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Custom Package Name&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Save as default for this part&quot;</span> </div>
<div class="line">                          <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsSaveAsDefault, Mode=TwoWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Loads List --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ItemsControl</span> <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Loads, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ItemsControl.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,8&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16,12&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;250&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding LoadNumber, Converter={StaticResource StringFormatConverter}, ConverterParameter=&#39;#{0}&#39;}&quot;</span> </div>
<div class="line">                                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                       <span class="keyword">Header</span>=<span class="stringliteral">&quot;Packages per Load&quot;</span></div>
<div class="line">                                       <span class="keyword">Value</span>=<span class="stringliteral">&quot;{Binding PackagesPerLoad, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span></div>
<div class="line">                                       <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                       <span class="keyword">SmallChange</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                       <span class="keyword">LargeChange</span>=<span class="stringliteral">&quot;5&quot;</span></div>
<div class="line">                                       <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                                       <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Packages per Load&quot;</span>/&gt;</div>
<div class="line">                                       </div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;16,0,0,0&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Weight per Package&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding WeightPerPackage, Converter={StaticResource StringFormatConverter}, ConverterParameter=&#39;{}{0:N2} lbs&#39;}&quot;</span> </div>
<div class="line">                                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ItemsControl.ItemTemplate</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">ItemsControl</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md199"></a>
File: Module_Receiving/Views/View_Receiving_PackageType.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_PackageType : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, PackageTypeComboBox);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void PackageTypeView_Loaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.OnNavigatedToAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md200"></a>
File: Module_Receiving/Views/View_Receiving_POEntry.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_POEntry&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_DecimalToInt</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;DecimalToIntConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Input Section (Row 0) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- PO Entry Mode --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsNonPOItem, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                        <span class="comment">&lt;!-- PO Number Input with Icon --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8A5;&quot;</span> </div>
<div class="line">                                         <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                         <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Purchase Order Number&quot;</span> </div>
<div class="line">                                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PoNumberTextBox&quot;</span></div>
<div class="line">                                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span> </div>
<div class="line">                                    <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.PONumber&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                    <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;400&quot;</span></div>
<div class="line">                                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                                    <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                    <span class="keyword">LostFocus</span>=<span class="stringliteral">&quot;POTextBox_LostFocus&quot;</span></div>
<div class="line">                                    <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Purchase Order Number&quot;</span>/&gt;</div>
<div class="line">                            </div>
<div class="line">                            <span class="comment">&lt;!-- Validation Message --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoValidationMessage, Mode=OneWay}&quot;</span> </div>
<div class="line">                                      <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorCriticalBrush}&quot;</span></div>
<div class="line">                                      <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                                      <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsLoadPOEnabled, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>/&gt;</div>
<div class="line">                            </div>
<div class="line">                            <span class="comment">&lt;!-- PO Status Display --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">Border</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8,4&quot;</span></div>
<div class="line">                                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span></div>
<div class="line">                                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorSecondaryBrush}&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8C9;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Status:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoStatusDescription, Mode=OneWay}&quot;</span> </div>
<div class="line">                                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                                              <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                   <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LoadPOCommand}&quot;</span> </div>
<div class="line">                                   <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsLoadPOEnabled, Mode=OneWay}&quot;</span></div>
<div class="line">                                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                                   <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Load Purchase Order&quot;</span></div>
<div class="line">                                   <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LoadPO&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE896;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Load PO&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                   <span class="keyword">Content</span>=<span class="stringliteral">&quot;Switch to Non-PO&quot;</span> </div>
<div class="line">                                   <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ToggleNonPOCommand}&quot;</span></div>
<div class="line">                                   <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.SwitchToNonPO&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Non-PO Entry Mode --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsNonPOItem, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                        <span class="comment">&lt;!-- Part ID Input with Icon --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B7;&quot;</span> </div>
<div class="line">                                         <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                         <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part Identifier&quot;</span> </div>
<div class="line">                                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PartIDTextBox&quot;</span></div>
<div class="line">                                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PartID, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span> </div>
<div class="line">                                    <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetPlaceholder(&#39;Field.PartID&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                                    <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;400&quot;</span></div>
<div class="line">                                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                                    <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Part Identifier&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Package Type Display (Auto-detected) --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> </div>
<div class="line">                                         <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                         <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Package Type (Auto-detected)&quot;</span> </div>
<div class="line">                                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PackageType, Mode=OneWay}&quot;</span></div>
<div class="line">                                      <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                                      <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemAccentColor}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                   <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LookupPartCommand}&quot;</span> </div>
<div class="line">                                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                                   <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Look Up Part&quot;</span></div>
<div class="line">                                   <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LookupPart&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE721;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Look Up Part&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                   <span class="keyword">Content</span>=<span class="stringliteral">&quot;Switch to PO Entry&quot;</span> </div>
<div class="line">                                   <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ToggleNonPOCommand}&quot;</span></div>
<div class="line">                                   <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.SwitchToPO&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Loading Indicator --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ProgressBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                    <span class="keyword">IsIndeterminate</span>=<span class="stringliteral">&quot;True&quot;</span> </div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Bottom&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,-10&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Parts Grid Section (Row 1) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsPartsListVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8FD;&quot;</span> </div>
<div class="line">                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Available Parts&quot;</span> </div>
<div class="line">                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGrid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                  <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Parts, Mode=OneWay}&quot;</span></div>
<div class="line">                                  <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPart, Mode=TwoWay}&quot;</span></div>
<div class="line">                                  <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                                  <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                                  <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                                  <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                                  <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                                  <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Parts List&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartID}&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Description&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Description}&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Remaining Qty&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding RemainingQuantity}&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Qty Ordered&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding QtyOrdered, Converter={StaticResource DecimalToIntConverter}}&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Line #&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding POLineNumber}&quot;</span> </div>
<div class="line">                                                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md201"></a>
File: Module_Receiving/Views/View_Receiving_POEntry.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_POEntry : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, PoNumberTextBox);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void POTextBox_LostFocus(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.PoTextBoxLostFocusCommand.Execute(null);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md202"></a>
File: Module_Receiving/Views/View_Receiving_Review.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_Review&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;UserControl_Loaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Content Section with View Toggle --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Single Entry View --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsSingleView, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Entry Counter --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                       <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12,6&quot;</span></div>
<div class="line">                       <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8,8,0,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8FD;&quot;</span> </div>
<div class="line">                                 <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                 <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;White&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                                  <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;White&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Entry&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.DisplayIndex, Mode=OneWay}&quot;</span> </div>
<div class="line">                                 <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;Bold&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;of&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Loads.Count, Mode=OneWay}&quot;</span> </div>
<div class="line">                                 <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;Bold&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Single Entry Form --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                           <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                           <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1,0,1,1&quot;</span></div>
<div class="line">                           <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;0,0,8,8&quot;</span></div>
<div class="line">                           <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;900&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>&gt;</div>
<div class="line">                            <span class="comment">&lt;!-- Load Number (Read-only) --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> </div>
<div class="line">                                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span></div>
<div class="line">                                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Load Number&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntry.LoadNumber, Mode=OneWay}&quot;</span> </div>
<div class="line">                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                                        <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource ControlFillColorDisabledBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- PO Number --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8A5;&quot;</span> </div>
<div class="line">                                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span></div>
<div class="line">                                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Purchase Order Number&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntry.PoNumber, Mode=OneWay}&quot;</span> </div>
<div class="line">                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Part ID --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B7;&quot;</span> </div>
<div class="line">                                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span></div>
<div class="line">                                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntry.PartID, Mode=OneWay}&quot;</span> </div>
<div class="line">                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Remaining Quantity --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE9F9;&quot;</span> </div>
<div class="line">                                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span></div>
<div class="line">                                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Remaining Quantity&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntry.RemainingQuantity, Mode=OneWay}&quot;</span> </div>
<div class="line">                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemAccentColor}&quot;</span></div>
<div class="line">                                        <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Weight/Quantity --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xEA8B;&quot;</span> </div>
<div class="line">                                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span></div>
<div class="line">                                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Weight/Quantity&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntry.WeightQuantity, Mode=OneWay}&quot;</span> </div>
<div class="line">                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;12,0,0,0&quot;</span>&gt;</div>
<div class="line">                            <span class="comment">&lt;!-- Heat/Lot Number --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B4;&quot;</span> </div>
<div class="line">                                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span></div>
<div class="line">                                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Heat/Lot Number&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntry.HeatLotNumber, Mode=OneWay}&quot;</span> </div>
<div class="line">                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Packages Per Load --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> </div>
<div class="line">                                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span></div>
<div class="line">                                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Packages Per Load&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntry.PackagesPerLoad, Mode=OneWay}&quot;</span> </div>
<div class="line">                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Package Type --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> </div>
<div class="line">                                             <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span></div>
<div class="line">                                             <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Package Type&quot;</span> </div>
<div class="line">                                              <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentEntry.PackageTypeName, Mode=OneWay}&quot;</span> </div>
<div class="line">                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Navigation Bar for Single View --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Back&quot;</span> </div>
<div class="line">                                 <span class="keyword">Label</span>=<span class="stringliteral">&quot;Previous&quot;</span> </div>
<div class="line">                                 <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PreviousEntryCommand}&quot;</span></div>
<div class="line">                                 <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanGoBack, Mode=OneWay}&quot;</span></div>
<div class="line">                                 <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Previous Entry&quot;</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Forward&quot;</span> </div>
<div class="line">                                 <span class="keyword">Label</span>=<span class="stringliteral">&quot;Next&quot;</span> </div>
<div class="line">                                 <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NextEntryCommand}&quot;</span></div>
<div class="line">                                 <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanGoNext, Mode=OneWay}&quot;</span></div>
<div class="line">                                 <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Next Entry&quot;</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;ViewAll&quot;</span> </div>
<div class="line">                                 <span class="keyword">Label</span>=<span class="stringliteral">&quot;Table View&quot;</span> </div>
<div class="line">                                 <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SwitchToTableViewCommand}&quot;</span></div>
<div class="line">                                 <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Switch to Table View&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Table View (DataGrid) --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsTableView, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                       <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                       <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                       <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGrid</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ReviewDataGrid&quot;</span></div>
<div class="line">                                      <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Loads, Mode=OneWay}&quot;</span></div>
<div class="line">                                      <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                                      <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                                      <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                                      <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                                      <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                                      <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Receiving Entries Table&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Load #&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding LoadNumber}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;PO Number&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PoNumber, TargetNullValue=&#39;N/A&#39;}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartID}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Remaining Qty&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding RemainingQuantity}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Weight/Qty&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding WeightQuantity}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Heat/Lot #&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding HeatLotNumber}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Pkgs&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PackagesPerLoad}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Pkg Type&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PackageTypeName}&quot;</span> </div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Navigation Bar for Table View --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Label</span>=<span class="stringliteral">&quot;Single View&quot;</span> </div>
<div class="line">                                 <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SwitchToSingleViewCommand}&quot;</span></div>
<div class="line">                                 <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Switch to Single View&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">AppBarButton.Icon</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8A9;&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">AppBarButton.Icon</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">AppBarButton</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                   <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddAnotherPartCommand}&quot;</span></div>
<div class="line">                   <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Add Another Part or PO&quot;</span></div>
<div class="line">                   <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.AddAnother&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE710;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Add Another Part/PO&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> </div>
<div class="line">                   <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SaveCommand}&quot;</span></div>
<div class="line">                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                   <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Save to Database&quot;</span></div>
<div class="line">                   <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.SaveAndGenerate&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74E;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Save to Database&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md203"></a>
File: Module_Receiving/Views/View_Receiving_Review.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_Review : UserControl</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void UserControl_Loaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.OnNavigatedToAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md204"></a>
File: Module_Receiving/Views/View_Receiving_WeightQuantity.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_WeightQuantity&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_StringFormat</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;StringFormatConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_DoubleToDecimal</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;DoubleToDecimalConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">&lt;!-- Info Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16,12&quot;</span></div>
<div class="line">                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xEA8B;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;White&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoQuantityInfo, Mode=OneWay}&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span></div>
<div class="line">                           <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;White&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Warning Banner --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                 <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HasWarning, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Warning&quot;</span></div>
<div class="line">                 <span class="keyword">Message</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.WarningMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                 <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Loads List with Fixed Height --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ItemsControl</span> <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Loads, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ItemsControl.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,8&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16,12&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding LoadNumber, Converter={StaticResource StringFormatConverter}, ConverterParameter=&#39;Load #{0}&#39;}&quot;</span> </div>
<div class="line">                                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                       <span class="keyword">Header</span>=<span class="stringliteral">&quot;Weight/Quantity&quot;</span></div>
<div class="line">                                       <span class="keyword">Value</span>=<span class="stringliteral">&quot;{Binding WeightQuantity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource DoubleToDecimalConverter}}&quot;</span></div>
<div class="line">                                       <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                       <span class="keyword">SmallChange</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                       <span class="keyword">LargeChange</span>=<span class="stringliteral">&quot;10&quot;</span></div>
<div class="line">                                       <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                                      <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter whole number&quot;</span></div>
<div class="line">                                       <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Weight Quantity&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ItemsControl.ItemTemplate</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">ItemsControl</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md205"></a>
File: Module_Receiving/Views/View_Receiving_WeightQuantity.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_WeightQuantity : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void WeightQuantityView_Loaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.OnNavigatedToAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md206"></a>
File: Module_Receiving/Views/View_Receiving_Workflow.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Receiving.Views.View_Receiving_Workflow&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Receiving.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:views</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Receiving.Views&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BoolToString</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BoolToStringConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_StringFormat</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;StringFormatConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Content Area --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;16,12,16,16&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Mode Selection View --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_ModeSelection</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsModeSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- Manual Entry View --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_ManualEntry</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManualEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Edit Mode View --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_EditMode</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsEditModeVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- PO Entry View --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_POEntry</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsPOEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_LoadEntry</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsLoadEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_WeightQuantity</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsWeightQuantityEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_HeatLot</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsHeatLotEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_PackageType</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsPackageTypeEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">views:View_Receiving_Review</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsReviewVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- Saving Progress --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsSavingVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                        <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ProgressRing</span> <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;True&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;64&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;64&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SaveProgressMessage, Mode=OneWay}&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ProgressBar</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SaveProgressValue, Mode=OneWay}&quot;</span> <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;100&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;300&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Completion Summary --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsCompleteVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                        <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;600&quot;</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE930;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;64&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorSuccessBrush}&quot;</span> </div>
<div class="line">                          <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.Success, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE783;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;64&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemFillColorCriticalBrush}&quot;</span> </div>
<div class="line">                          <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.Success, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=&#39;Inverse&#39;}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Success!&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                           <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.Success, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Save Failed&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                           <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.Success, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=&#39;Inverse&#39;}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.LoadsSaved, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Run</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot; loads saved successfully.&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">TextBlock</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Save Details:&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Local CSV:&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Saved&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Green&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.LocalCSVSuccess, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Failed&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Red&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.LocalCSVSuccess, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=&#39;Inverse&#39;}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Network CSV:&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Saved&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Green&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.NetworkCSVSuccess, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Failed&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Red&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.NetworkCSVSuccess, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=&#39;Inverse&#39;}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Database:&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Saved&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Green&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.DatabaseSuccess, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Failed&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Red&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastSaveResult.DatabaseSuccess, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=&#39;Inverse&#39;}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Start New Entry&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StartNewEntryCommand}&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.StartNew&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Reset CSV&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ResetCSVCommand}&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.ResetCSV&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Navigation Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- Left-aligned buttons --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Left&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Mode Selection&quot;</span> </div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToModeSelectionCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">Background</span>=<span class="stringliteral">&quot;Transparent&quot;</span> </div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource SystemAccentColor}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Reset CSV&quot;</span> </div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ResetCSVCommand}&quot;</span> </div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsModeSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=&#39;Inverse&#39;}&quot;</span></div>
<div class="line">                        <span class="keyword">Background</span>=<span class="stringliteral">&quot;Transparent&quot;</span> </div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;Transparent&quot;</span> </div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Red&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.ResetCSV&#39;), Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- Center help button --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                    <span class="keyword">Grid.ColumnSpan</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                    <span class="keyword">Canvas.ZIndex</span>=<span class="stringliteral">&quot;1000&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Click</span>=<span class="stringliteral">&quot;HelpButton_Click&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12,8&quot;</span></div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.StepHelp&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE946;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Help&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- Right-aligned navigation buttons --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Back&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PreviousStepCommand}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Next&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NextStepCommand}&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md207"></a>
File: Module_Reporting/Views/View_Reporting_Main.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Reporting.Views.View_Reporting_Main&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource ApplicationPageBackgroundThemeBrush}&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,24&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Title, Mode=OneWay}&quot;</span> </div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Select date range and modules to generate end-of-day reports&quot;</span> </div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Date Range Selection --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,24&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Date Range&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">CalendarDatePicker</span> </div>
<div class="line">                    <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Start Date&quot;</span></div>
<div class="line">                    <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StartDate, Mode=TwoWay}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">CalendarDatePicker</span> </div>
<div class="line">                    <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;End Date&quot;</span></div>
<div class="line">                    <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.EndDate, Mode=TwoWay}&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                    <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Check Availability&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CheckAvailabilityCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Bottom&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Module Selection --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,24&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Select Modules&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Receiving&quot;</span></div>
<div class="line">                        <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsReceivingChecked, Mode=TwoWay}&quot;</span></div>
<div class="line">                        <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsReceivingEnabled, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReceivingCount, Mode=OneWay}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;28,0,0,0&quot;</span></div>
<div class="line">                        <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Generate Report&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GenerateReceivingReportCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,4,0,0&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Dunnage&quot;</span></div>
<div class="line">                        <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsDunnageChecked, Mode=TwoWay}&quot;</span></div>
<div class="line">                        <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsDunnageEnabled, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.DunnageCount, Mode=OneWay}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;28,0,0,0&quot;</span></div>
<div class="line">                        <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Generate Report&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GenerateDunnageReportCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,4,0,0&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Routing&quot;</span></div>
<div class="line">                        <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsRoutingChecked, Mode=TwoWay}&quot;</span></div>
<div class="line">                        <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsRoutingEnabled, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RoutingCount, Mode=OneWay}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;28,0,0,0&quot;</span></div>
<div class="line">                        <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Generate Report&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GenerateRoutingReportCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,4,0,0&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Volvo&quot;</span></div>
<div class="line">                        <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsVolvoChecked, Mode=TwoWay}&quot;</span></div>
<div class="line">                        <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsVolvoEnabled, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.VolvoCount, Mode=OneWay}&quot;</span></div>
<div class="line">                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;28,0,0,0&quot;</span></div>
<div class="line">                        <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Generate Report&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GenerateVolvoReportCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,4,0,0&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Report Data Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> </div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> </div>
<div class="line">            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource SystemControlForegroundBaseMediumLowBrush}&quot;</span></div>
<div class="line">            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentModuleName, Mode=OneWay}&quot;</span> </div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">ListView</span> </div>
<div class="line">                        <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReportData, Mode=OneWay}&quot;</span></div>
<div class="line">                        <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;None&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding CreatedDate, Mode=OneWay}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;Bold&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding PartNumber, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding PONumber, Mode=OneWay}&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Gray&quot;</span>/&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">ListView</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Save&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Export to CSV&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ExportToCSVCommand}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Copy&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Copy Email Format&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CopyEmailFormatCommand}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Refresh&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Check Availability&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CheckAvailabilityCommand}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md208"></a>
File: Module_Reporting/Views/View_Reporting_Main.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Reporting_Main : Page</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md209"></a>
File: Module_Routing/Enums/Enum_RoutingMode.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md210"></a>
File: Module_Routing/Views/RoutingWizardContainerView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>RoutingWizardContainerView : Page</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md211"></a>
File: Module_Routing/Views/RoutingWizardStep1View.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>RoutingWizardStep1View : Page</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md212"></a>
File: Module_Routing/Views/RoutingWizardStep3View.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>RoutingWizardStep3View : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnPageLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.LoadReviewData();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md213"></a>
File: Module_Settings/Enums/Enum_SettingsWorkflowStep.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md214"></a>
File: Module_Settings/Interfaces/IService_UserPreferences.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_UserPreferences</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;Model_UserPreference&gt;&gt; GetLatestUserPreferenceAsync(string username);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateDefaultModeAsync(<span class="keywordtype">string</span> username, <span class="keywordtype">string</span> defaultMode);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateDefaultReceivingModeAsync(<span class="keywordtype">string</span> username, <span class="keywordtype">string</span> defaultMode);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateDefaultDunnageModeAsync(<span class="keywordtype">string</span> username, <span class="keywordtype">string</span> defaultMode);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md215"></a>
File: Module_Settings/Services/Service_SettingsWorkflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_SettingsWorkflow : IService_SettingsWorkflow</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Enum_SettingsWorkflowStep _currentStep = Enum_SettingsWorkflowStep.ModeSelection;</div>
<div class="line"><span class="keyword">public</span> void GoToStep(Enum_SettingsWorkflowStep step)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void GoBack()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Reset()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md216"></a>
File: Module_Shared/ViewModels/ViewModel_Shared_Base.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">partial class </span>ViewModel_Shared_Base : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">protected</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> InfoBarSeverity _statusSeverity = InfoBarSeverity.Informational;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ShowStatus(string message, InfoBarSeverity severity = InfoBarSeverity.Informational)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md217"></a>
File: Module_Shared/ViewModels/ViewModel_Shared_HelpDialog.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Shared_HelpDialog : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task LoadHelpContentAsync(Model_HelpContent content)</div>
<div class="line">⋮----</div>
<div class="line">IsDismissed = await _helpService.IsDismissedAsync(content.Key);</div>
<div class="line">⋮----</div>
<div class="line">RelatedTopics.Clear();</div>
<div class="line">⋮----</div>
<div class="line">var relatedContent = _helpService.GetHelpContent(relatedKey);</div>
<div class="line">⋮----</div>
<div class="line">RelatedTopics.Add(relatedContent);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private async Task ViewRelatedTopicAsync()</div>
<div class="line">⋮----</div>
<div class="line">public async Task LoadRelatedTopicAsync(Model_HelpContent? relatedContent)</div>
<div class="line">⋮----</div>
<div class="line">private async Task CopyContentAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (HelpContent != null &amp;&amp; !string.IsNullOrEmpty(HelpContent.Content))</div>
<div class="line">⋮----</div>
<div class="line">dataPackage.SetText(HelpContent.Content);</div>
<div class="line">Windows.ApplicationModel.DataTransfer.Clipboard.SetContent(dataPackage);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Help content copied to clipboard&quot;);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnIsDismissedChanged(bool value)</div>
<div class="line">⋮----</div>
<div class="line">if (HelpContent != null &amp;&amp; !string.IsNullOrEmpty(HelpContent.Key))</div>
<div class="line">⋮----</div>
<div class="line">_ = _helpService.SetDismissedAsync(HelpContent.Key, value);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md218"></a>
File: Module_Shared/ViewModels/ViewModel_Shared_NewUserSetup.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Shared_NewUserSetup : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Authentication _authService;</div>
<div class="line">⋮----</div>
<div class="line">_authService = authService ?? throw new ArgumentNullException(nameof(authService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task LoadDepartmentsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var departmentList = await _authService.GetActiveDepartmentsAsync();</div>
<div class="line">Departments.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Departments.Add(dept);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded {Departments.Count} departments for new user setup&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;bool&gt; CreateAccountAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (!int.TryParse(EmployeeNumber, out int empNum) || empNum &lt;= 0)</div>
<div class="line">⋮----</div>
<div class="line">var pinValidation = await _authService.ValidatePinAsync(Pin, empNum);</div>
<div class="line">⋮----</div>
<div class="line">var newUser = new Model_User</div>
<div class="line">⋮----</div>
<div class="line">var result = await _authService.CreateNewUserAsync(newUser, CreatedBy, progress);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;New user account created: {FullName} (Emp #{NewEmployeeNumber}) by {CreatedBy}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Failed to create account for {WindowsUsername}: {ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public bool ValidatePinFormat(string pin)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(pin))</div>
<div class="line">⋮----</div>
<div class="line">if (!char.IsDigit(c))</div>
<div class="line">⋮----</div>
<div class="line">public bool ValidatePinMatch(string pin, string confirmPin)</div>
<div class="line">⋮----</div>
<div class="line">return !string.IsNullOrWhiteSpace(pin) &amp;&amp; pin == confirmPin;</div>
<div class="line">⋮----</div>
<div class="line">public bool ValidateFullName(string fullName)</div>
<div class="line">⋮----</div>
<div class="line">return !string.IsNullOrWhiteSpace(fullName) &amp;&amp; fullName.Trim().Length &gt;= 2;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md219"></a>
File: Module_Shared/ViewModels/ViewModel_Shared_SharedTerminalLogin.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Shared_SharedTerminalLogin : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Authentication _authService;</div>
<div class="line">⋮----</div>
<div class="line">_authService = authService ?? throw new ArgumentNullException(nameof(authService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; LoginAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(Username))</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(Pin))</div>
<div class="line">⋮----</div>
<div class="line">var result = await _authService.AuthenticateByPinAsync(Username, Pin, progress);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;PIN authentication successful for user: {Username}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;PIN authentication failed for user: {Username}. Attempt {AttemptCount}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md220"></a>
File: Module_Shared/ViewModels/ViewModel_Shared_SplashScreen.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Shared_SplashScreen : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void UpdateProgress(double percentage, string message)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void SetIndeterminate(string message)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Reset()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md221"></a>
File: Module_Shared/Views/View_Shared_HelpDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Shared.Views.View_Shared_HelpDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mi</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Models.Core&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HelpContent.Title, Mode=OneWay}&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Close&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">Width</span>=<span class="stringliteral">&quot;700&quot;</span></div>
<div class="line">    <span class="keyword">Height</span>=<span class="stringliteral">&quot;600&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">ContentDialog.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Style</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;HelpHeaderStyle&quot;</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;TextBlock&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;FontSize&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;24&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;FontWeight&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Margin&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;12,0,0,0&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Style</span>&gt;</div>
<div class="line">        </div>
<div class="line">        &lt;<span class="keywordtype">Style</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;HelpContentStyle&quot;</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;TextBlock&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;FontSize&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;14&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;TextWrapping&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;Wrap&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;LineHeight&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;22&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Style</span>&gt;</div>
<div class="line"> </div>
<div class="line">        &lt;<span class="keywordtype">Style</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;RelatedTopicStyle&quot;</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;TextBlock&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;FontSize&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;14&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;Margin&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;8,4&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Style</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">ContentDialog.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">mi:MaterialIcon</span> </div>
<div class="line">                <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HelpContent.IconKind, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;32&quot;</span> </div>
<div class="line">                <span class="keyword">Height</span>=<span class="stringliteral">&quot;32&quot;</span></div>
<div class="line">                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HelpContent.Title, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource HelpHeaderStyle}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Content Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HelpContent.Content, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource HelpContentStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Related Topics Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Expander</span> </div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Related Topics&quot;</span></div>
<div class="line">            <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span></div>
<div class="line">            <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">            <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsRelatedHelpAvailable, Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ListView</span> </div>
<div class="line">                <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RelatedTopics, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;None&quot;</span></div>
<div class="line">                <span class="keyword">IsItemClickEnabled</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                <span class="keyword">ItemClick</span>=<span class="stringliteral">&quot;RelatedTopics_ItemClick&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_HelpContent&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">mi:MaterialIcon</span> </div>
<div class="line">                                <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind IconKind}&quot;</span></div>
<div class="line">                                <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> </div>
<div class="line">                                <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,8,0&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind Title}&quot;</span></div>
<div class="line">                                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource RelatedTopicStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ListView.ItemContainerStyle</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Style</span> <span class="keyword">TargetType</span>=<span class="stringliteral">&quot;ListViewItem&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Setter</span> <span class="keyword">Property</span>=<span class="stringliteral">&quot;HorizontalContentAlignment&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Style</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ListView.ItemContainerStyle</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">ListView</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Expander</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Footer Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,12,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">CheckBox</span> </div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Don&#39;t show this again&quot;</span></div>
<div class="line">                <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsDismissed, Mode=TwoWay}&quot;</span></div>
<div class="line">                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CanDismiss, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Left&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Copy&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CopyContentCommand}&quot;</span></div>
<div class="line">                <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;12,0,0,0&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">KeyboardAccelerator</span> <span class="keyword">Key</span>=<span class="stringliteral">&quot;C&quot;</span> <span class="keyword">Modifiers</span>=<span class="stringliteral">&quot;Control&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md222"></a>
File: Module_Shared/Views/View_Shared_HelpDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Shared_HelpDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void SetHelpContent(Model_HelpContent content)</div>
<div class="line">⋮----</div>
<div class="line">_ = ViewModel.LoadHelpContentAsync(content);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void RelatedTopics_ItemClick(object sender, Microsoft.UI.Xaml.Controls.ItemClickEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.LoadRelatedTopicAsync(relatedContent);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md223"></a>
File: Module_Shared/Views/View_Shared_IconSelectorWindow.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Window</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Shared.Views.View_Shared_IconSelectorWindow&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:materialIcons</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Select Icon&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource ApplicationPageBackgroundThemeBrush}&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Custom Title Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;AppTitleBar&quot;</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;32&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;Transparent&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Icon Library&quot;</span> </div>
<div class="line">                       <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> </div>
<div class="line">                       <span class="keyword">Margin</span>=<span class="stringliteral">&quot;16,0,0,0&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header &amp; Search --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;32,16,32,16&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource DividerStrokeColorDefaultBrush}&quot;</span> <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;0,0,0,1&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;SearchBox&quot;</span> </div>
<div class="line">                         <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                         <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Search icons (e.g. &#39;box&#39;, &#39;truck&#39;)...&quot;</span> </div>
<div class="line">                         <span class="keyword">TextChanged</span>=<span class="stringliteral">&quot;OnSearchTextChanged&quot;</span></div>
<div class="line">                         <span class="keyword">Height</span>=<span class="stringliteral">&quot;36&quot;</span></div>
<div class="line">                         <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span>/&gt;</div>
<div class="line">                         </div>
<div class="line">                &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ShowAllIconsCheckBox&quot;</span> </div>
<div class="line">                          <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                          <span class="keyword">Content</span>=<span class="stringliteral">&quot;Show all icons&quot;</span> </div>
<div class="line">                          <span class="keyword">Checked</span>=<span class="stringliteral">&quot;OnShowAllIconsChanged&quot;</span></div>
<div class="line">                          <span class="keyword">Unchecked</span>=<span class="stringliteral">&quot;OnShowAllIconsChanged&quot;</span></div>
<div class="line">                          <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Icon Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Viewbox</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Stretch</span>=<span class="stringliteral">&quot;Uniform&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">GridView</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;IconGridView&quot;</span> </div>
<div class="line">                      <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                      <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                      <span class="keyword">IsItemClickEnabled</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                      <span class="keyword">ItemClick</span>=<span class="stringliteral">&quot;OnIconItemClick&quot;</span></div>
<div class="line">                      <span class="keyword">ScrollViewer.VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Disabled&quot;</span></div>
<div class="line">                      <span class="keyword">Width</span>=<span class="stringliteral">&quot;900&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;650&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">GridView.ItemsPanel</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ItemsPanelTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ItemsWrapGrid</span> <span class="keyword">MaximumRowsOrColumns</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">ItemsPanelTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">GridView.ItemsPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">GridView.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Border</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;200&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;140&quot;</span></div>
<div class="line">                                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{Binding Name}&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">VisualStateManager.VisualStateGroups</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">VisualStateGroup</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;CommonStates&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">VisualState</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;Normal&quot;</span> /&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">VisualState</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PointerOver&quot;</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">Storyboard</span>&gt;</div>
<div class="line">                                            &lt;<span class="keywordtype">ObjectAnimationUsingKeyFrames</span> <span class="keyword">Storyboard.TargetName</span>=<span class="stringliteral">&quot;ContentPanel&quot;</span> <span class="keyword">Storyboard.TargetProperty</span>=<span class="stringliteral">&quot;Background&quot;</span>&gt;</div>
<div class="line">                                                &lt;<span class="keywordtype">DiscreteObjectKeyFrame</span> <span class="keyword">KeyTime</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorSecondaryBrush}&quot;</span> /&gt;</div>
<div class="line">                                            &lt;/<span class="keywordtype">ObjectAnimationUsingKeyFrames</span>&gt;</div>
<div class="line">                                        &lt;/<span class="keywordtype">Storyboard</span>&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">VisualState</span>&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">VisualStateGroup</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">VisualStateManager.VisualStateGroups</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ContentPanel&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{Binding Kind}&quot;</span> </div>
<div class="line">                                          <span class="keyword">Width</span>=<span class="stringliteral">&quot;40&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;40&quot;</span></div>
<div class="line">                                          <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding Name}&quot;</span> </div>
<div class="line">                                           <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span> </div>
<div class="line">                                           <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> </div>
<div class="line">                                           <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                           <span class="keyword">MaxLines</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                                           <span class="keyword">TextTrimming</span>=<span class="stringliteral">&quot;CharacterEllipsis&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">GridView.ItemTemplate</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">GridView</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Viewbox</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Footer --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;32,20&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource DividerStrokeColorDefaultBrush}&quot;</span> <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;0,1,0,0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;CancelButton&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Cancel&quot;</span> <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnCancelClick&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;36&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Left&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;FirstPageButton&quot;</span> <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnFirstPageClick&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;44&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;36&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;First Page&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;PageFirst&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PreviousPageButton&quot;</span> <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnPreviousPageClick&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;44&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;36&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Previous Page&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;ChevronLeft&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16,0&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;36&quot;</span> <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span> <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PageInfoTextBlock&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Page 1 of 1&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NextPageButton&quot;</span> <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnNextPageClick&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;44&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;36&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Next Page&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;ChevronRight&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;LastPageButton&quot;</span> <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnLastPageClick&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;44&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;36&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Last Page&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">Kind</span>=<span class="stringliteral">&quot;PageLast&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Window</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md224"></a>
File: Module_Shared/Views/View_Shared_IconSelectorWindow.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Shared_IconSelectorWindow : Window</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;Failed to get logging service: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var hwnd = WinRT.Interop.WindowNative.GetWindowHandle(this);</div>
<div class="line">var windowId = Microsoft.UI.Win32Interop.GetWindowIdFromWindow(hwnd);</div>
<div class="line">var appWindow = Microsoft.UI.Windowing.AppWindow.GetFromWindowId(windowId);</div>
<div class="line">⋮----</div>
<div class="line">appWindow.Resize(windowSize);</div>
<div class="line">var displayArea = Microsoft.UI.Windowing.DisplayArea.GetFromWindowId(windowId, Microsoft.UI.Windowing.DisplayAreaFallback.Primary);</div>
<div class="line">⋮----</div>
<div class="line">appWindow.Move(new Windows.Graphics.PointInt32 { X = centerX, Y = centerY });</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void SetInitialSelection(MaterialIconKind iconKind)</div>
<div class="line">⋮----</div>
<div class="line">DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">var iconInfo = _allIcons.FirstOrDefault(i =&gt; i.Kind == iconKind);</div>
<div class="line">⋮----</div>
<div class="line">IconGridView.ScrollIntoView(iconInfo);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;MaterialIconKind?&gt; WaitForSelectionAsync()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void LoadIcons()</div>
<div class="line">⋮----</div>
<div class="line">var icons = Helper_MaterialIcons.GetAllIcons();</div>
<div class="line">_allIcons = icons.ConvertAll(k =&gt; new IconInfo(k.ToString(), k));</div>
<div class="line">⋮----</div>
<div class="line">.Where(i =&gt; commonIconNames.Contains(i.Name))</div>
<div class="line">.ToList();</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;Error loading icons: {ex}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdateGridView()</div>
<div class="line">⋮----</div>
<div class="line">_totalPages = (int)Math.Ceiling((double)_filteredIcons.Count / ICONS_PER_PAGE);</div>
<div class="line">⋮----</div>
<div class="line">.Skip((_currentPage - 1) * ICONS_PER_PAGE)</div>
<div class="line">.Take(ICONS_PER_PAGE)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnSearchTextChanged(object sender, TextChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var searchText = SearchBox.Text.ToLower().Trim();</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(searchText))</div>
<div class="line">⋮----</div>
<div class="line">.Where(i =&gt; i.Name.ToLower().Contains(searchText))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnShowAllIconsChanged(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnIconItemClick(object sender, ItemClickEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnPreviousPageClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnNextPageClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnFirstPageClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnLastPageClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnCancelClick(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> class IconInfo</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md225"></a>
File: Module_Shared/Views/View_Shared_NewUserSetupDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Shared.Views.View_Shared_NewUserSetupDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Create Your Account&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Create Account&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonStyle</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">    <span class="keyword">Width</span>=<span class="stringliteral">&quot;480&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header with Icon and Welcome --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20,16,20,12&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                          <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                          <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE77B;&quot;</span> </div>
<div class="line">                          <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;32&quot;</span></div>
<div class="line">                          <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                          <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                          <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,16,0&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Welcome to MTM Receiving&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                               <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Let&#39;s set up your account to get started&quot;</span> </div>
<div class="line">                               <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Main Content - Using Grid for compact two-column layout with ScrollViewer --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                      <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span> </div>
<div class="line">                      <span class="keyword">HorizontalScrollBarVisibility</span>=<span class="stringliteral">&quot;Disabled&quot;</span></div>
<div class="line">                      <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;480&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20,12&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Row 0: Full Name (spans both columns) --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Grid.ColumnSpan</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                              <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE77B;&quot;</span> </div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Full Name *&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;FullNameTextBox&quot;</span></div>
<div class="line">                         <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter your full name&quot;</span></div>
<div class="line">                         <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;100&quot;</span></div>
<div class="line">                         <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Row 1: Employee Number &amp; Windows Username --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                              <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8D4;&quot;</span> </div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Employee Number *&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;EmployeeNumberTextBox&quot;</span></div>
<div class="line">                         <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;e.g., 6229&quot;</span></div>
<div class="line">                         <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;10&quot;</span></div>
<div class="line">                         <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                         <span class="keyword">InputScope</span>=<span class="stringliteral">&quot;Number&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                              <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE910;&quot;</span> </div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Windows Username&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span></div>
<div class="line">                               <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;WindowsUsernameTextBox&quot;</span></div>
<div class="line">                         <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                         <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource ControlAltFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                         <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;-1&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Row 2: Department &amp; Shift --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                              <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE716;&quot;</span> </div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Department *&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ComboBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;DepartmentComboBox&quot;</span></div>
<div class="line">                          <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Select department&quot;</span></div>
<div class="line">                          <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                          <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                          <span class="keyword">SelectionChanged</span>=<span class="stringliteral">&quot;DepartmentComboBox_SelectionChanged&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                              <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE823;&quot;</span> </div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Shift *&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ComboBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ShiftComboBox&quot;</span></div>
<div class="line">                          <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Select shift&quot;</span></div>
<div class="line">                          <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                          <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;1st Shift&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;2nd Shift&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ComboBoxItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;3rd Shift&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ComboBox</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Row 3: Custom Department (Visible when &quot;Other&quot; selected, spans both columns) --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;CustomDepartmentPanel&quot;</span> </div>
<div class="line">                        <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> </div>
<div class="line">                        <span class="keyword">Grid.ColumnSpan</span>=<span class="stringliteral">&quot;2&quot;</span> </div>
<div class="line">                        <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span> </div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                              <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE70F;&quot;</span> </div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Custom Department Name *&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;CustomDepartmentTextBox&quot;</span></div>
<div class="line">                         <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter department name&quot;</span></div>
<div class="line">                         <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;50&quot;</span></div>
<div class="line">                         <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;3&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Row 4: PIN Fields --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                              <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE72E;&quot;</span> </div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;4-Digit PIN *&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">PasswordBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PinPasswordBox&quot;</span></div>
<div class="line">                             <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Create PIN&quot;</span></div>
<div class="line">                             <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                             <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;5&quot;</span></div>
<div class="line">                             <span class="keyword">PasswordRevealMode</span>=<span class="stringliteral">&quot;Peek&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;For shared terminal login&quot;</span> </div>
<div class="line">                           <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorTertiaryBrush}&quot;</span></div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                              <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8C9;&quot;</span> </div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                              <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Confirm PIN *&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">PasswordBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ConfirmPinPasswordBox&quot;</span></div>
<div class="line">                             <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Re-enter PIN&quot;</span></div>
<div class="line">                             <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                             <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;6&quot;</span></div>
<div class="line">                             <span class="keyword">PasswordRevealMode</span>=<span class="stringliteral">&quot;Peek&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Row 5: ERP Credentials Section (Optional) --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Expander</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ErpExpander&quot;</span></div>
<div class="line">                      <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;5&quot;</span> </div>
<div class="line">                      <span class="keyword">Grid.ColumnSpan</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                      <span class="keyword">Header</span>=<span class="stringliteral">&quot;ERP System Access (Optional)&quot;</span></div>
<div class="line">                      <span class="keyword">IsExpanded</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                      <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                      <span class="keyword">HorizontalContentAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                      <span class="keyword">VerticalContentAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Expander.HeaderTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;{StaticResource SymbolThemeFontFamily}&quot;</span> </div>
<div class="line">                                      <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE89F;&quot;</span> </div>
<div class="line">                                      <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding}&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Expander.HeaderTemplate</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12,8,0,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ConfigureErpCheckBox&quot;</span></div>
<div class="line">                              <span class="keyword">Content</span>=<span class="stringliteral">&quot;Configure Visual/Infor ERP credentials&quot;</span></div>
<div class="line">                              <span class="keyword">Checked</span>=<span class="stringliteral">&quot;ConfigureErpCheckBox_Checked&quot;</span></div>
<div class="line">                              <span class="keyword">Unchecked</span>=<span class="stringliteral">&quot;ConfigureErpCheckBox_Unchecked&quot;</span></div>
<div class="line">                              <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;7&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ErpCredentialsPanel&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Warning&quot;</span> </div>
<div class="line">                                 <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;True&quot;</span> </div>
<div class="line">                                 <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                                 <span class="keyword">Message</span>=<span class="stringliteral">&quot;Credentials are stored in plain text for ERP integration.&quot;</span>/&gt;</div>
<div class="line">                        </div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Visual/Infor Username&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;VisualUsernameTextBox&quot;</span></div>
<div class="line">                                     <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;ERP username&quot;</span></div>
<div class="line">                                     <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;50&quot;</span></div>
<div class="line">                                     <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;8&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Visual/Infor Password&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">PasswordBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;VisualPasswordBox&quot;</span></div>
<div class="line">                                         <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;ERP password&quot;</span></div>
<div class="line">                                         <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;100&quot;</span></div>
<div class="line">                                         <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;9&quot;</span></div>
<div class="line">                                         <span class="keyword">PasswordRevealMode</span>=<span class="stringliteral">&quot;Peek&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Expander</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Footer: Status Bar &amp; Progress --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;6&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20,8,20,16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressBar</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;LoadingProgressBar&quot;</span> </div>
<div class="line">                         <span class="keyword">IsIndeterminate</span>=<span class="stringliteral">&quot;True&quot;</span> </div>
<div class="line">                         <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span></div>
<div class="line">                         <span class="keyword">Height</span>=<span class="stringliteral">&quot;4&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;StatusInfoBar&quot;</span></div>
<div class="line">                     <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                     <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md226"></a>
File: Module_Shared/Views/View_Shared_NewUserSetupDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Shared_NewUserSetupDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">ViewModel = viewModel ?? throw new ArgumentNullException(nameof(viewModel));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnDialogClosing(ContentDialog sender, ContentDialogClosingEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnDialogLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">FullNameTextBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async System.Threading.Tasks.Task LoadDepartmentsAsync()</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.LoadDepartmentsAsync();</div>
<div class="line">DepartmentComboBox.Items.Clear();</div>
<div class="line">⋮----</div>
<div class="line">DepartmentComboBox.Items.Add(dept);</div>
<div class="line">⋮----</div>
<div class="line">DepartmentComboBox.Items.Add(&quot;Other&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void DepartmentComboBox_SelectionChanged(object sender, SelectionChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">string selectedDept = DepartmentComboBox.SelectedItem.ToString() ?? string.Empty;</div>
<div class="line">⋮----</div>
<div class="line">CustomDepartmentTextBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ConfigureErpCheckBox_Checked(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">_ = DispatcherQueue.TryEnqueue(Microsoft.UI.Dispatching.DispatcherQueuePriority.Normal, () =&gt;</div>
<div class="line">⋮----</div>
<div class="line">VisualUsernameTextBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ConfigureErpCheckBox_Unchecked(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnCreateAccountButtonClick(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(employeeNumber))</div>
<div class="line">⋮----</div>
<div class="line">EmployeeNumberTextBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">if (!int.TryParse(employeeNumber, out int empNum) || empNum &lt;= 0)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(fullName))</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(department))</div>
<div class="line">⋮----</div>
<div class="line">DepartmentComboBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(shift))</div>
<div class="line">⋮----</div>
<div class="line">ShiftComboBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(pin))</div>
<div class="line">⋮----</div>
<div class="line">PinPasswordBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">if (pin.Length != 4 || !pin.All(char.IsDigit))</div>
<div class="line">⋮----</div>
<div class="line">ConfirmPinPasswordBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">bool success = await ViewModel.CreateAccountAsync();</div>
<div class="line">⋮----</div>
<div class="line">await System.Threading.Tasks.Task.Delay(2000);</div>
<div class="line">⋮----</div>
<div class="line">private void OnCancelButtonClick(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">private void ShowValidationError(string message)</div>
<div class="line">⋮----</div>
<div class="line">private void SetLoadingState(bool isLoading)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md227"></a>
File: Module_Shared/Views/View_Shared_SharedTerminalLoginDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Shared.Views.View_Shared_SharedTerminalLoginDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Shared Terminal Login&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Login&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonStyle</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">    <span class="keyword">Width</span>=<span class="stringliteral">&quot;400&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">        <span class="comment">&lt;!-- Instructions --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Please enter your credentials to continue&quot;</span></div>
<div class="line">            <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Username Field --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Username&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBox</span> </div>
<div class="line">                <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;UsernameTextBox&quot;</span></div>
<div class="line">                <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter your username&quot;</span></div>
<div class="line">                <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;50&quot;</span></div>
<div class="line">                <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- PIN Field --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;4-Digit PIN&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">PasswordBox</span> </div>
<div class="line">                <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PinPasswordBox&quot;</span></div>
<div class="line">                <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter 4-digit PIN&quot;</span></div>
<div class="line">                <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                <span class="keyword">TabIndex</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">PasswordRevealMode</span>=<span class="stringliteral">&quot;Peek&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Attempt Counter (Hidden initially, shown after first failure) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">            <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;AttemptCounterTextBlock&quot;</span></div>
<div class="line">            <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;Gold&quot;</span></div>
<div class="line">            <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span></div>
<div class="line">            <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Error InfoBar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">InfoBar</span> </div>
<div class="line">            <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ErrorInfoBar&quot;</span></div>
<div class="line">            <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Error&quot;</span></div>
<div class="line">            <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">            <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">            <span class="keyword">Title</span>=<span class="stringliteral">&quot;Login Failed&quot;</span></div>
<div class="line">            <span class="keyword">Message</span>=<span class="stringliteral">&quot;Invalid username or PIN. Please try again.&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md228"></a>
File: Module_Shared/Views/View_Shared_SharedTerminalLoginDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Shared_SharedTerminalLoginDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">ViewModel = viewModel ?? throw new ArgumentNullException(nameof(viewModel));</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, UsernameTextBox);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPrimaryButtonClick(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(username))</div>
<div class="line">⋮----</div>
<div class="line">UsernameTextBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(pin))</div>
<div class="line">⋮----</div>
<div class="line">PinPasswordBox.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">if (pin.Length != 4 || !int.TryParse(pin, out _))</div>
<div class="line">⋮----</div>
<div class="line">bool success = await ViewModel.LoginAsync();</div>
<div class="line">⋮----</div>
<div class="line">await System.Threading.Tasks.Task.Delay(5000);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnCloseButtonClick(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md229"></a>
File: Module_Shared/Views/View_Shared_SplashScreenWindow.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Window</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Shared.Views.View_Shared_SplashScreenWindow&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;MTM Receiving Application&quot;</span>   </div>
<div class="line">    &gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;32&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Logo and Branding --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">FontFamily</span>=<span class="stringliteral">&quot;Segoe Fluent Icons&quot;</span> </div>
<div class="line">                      <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8F1;&quot;</span> </div>
<div class="line">                      <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;64&quot;</span></div>
<div class="line">                      <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                      <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;MTM Receiving Application&quot;</span> </div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                       <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Version 1.0.0&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;MTM Manufacturing&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorTertiaryBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Progress Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,40,0,0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;StatusMessageTextBlock&quot;</span></div>
<div class="line">                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;Initializing...&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">ProgressBar</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;MainProgressBar&quot;</span></div>
<div class="line">                         <span class="keyword">Height</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                         <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                         <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;100&quot;</span></div>
<div class="line">                         <span class="keyword">Value</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                         <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ProgressPercentageTextBlock&quot;</span></div>
<div class="line">                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;0%&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Copyright --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span></div>
<div class="line">                   <span class="keyword">Text</span>=<span class="stringliteral">&quot;© 2025 MTM Manufacturing. All rights reserved.&quot;</span></div>
<div class="line">                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                   <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorTertiaryBrush}&quot;</span></div>
<div class="line">                   <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                   <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,28,0,0&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Window</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md230"></a>
File: Module_Shared/Views/View_Shared_SplashScreenWindow.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Shared_SplashScreenWindow : Window</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SplashScreenWindow_Closed(object sender, WindowEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">Application.Current.Exit();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ConfigureWindow()</div>
<div class="line">⋮----</div>
<div class="line">this.UseCustomTitleBar();</div>
<div class="line">this.HideTitleBarIcon();</div>
<div class="line">this.MakeTitleBarTransparent();</div>
<div class="line">this.SetWindowSize(WindowWidth, WindowHeight);</div>
<div class="line">this.SetFixedSize(disableMaximize: true, disableMinimize: true);</div>
<div class="line">this.CenterOnScreen();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ViewModel_PropertyChanged(object? sender, System.ComponentModel.PropertyChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">DispatcherQueue.TryEnqueue(Microsoft.UI.Dispatching.DispatcherQueuePriority.Normal, () =&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md231"></a>
File: Module_Volvo/Views/View_Volvo_History.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Volvo_History : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPageLoaded(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.FilterCommand.ExecuteAsync(null);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md232"></a>
File: Module_Volvo/Views/View_Volvo_Settings.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Volvo_Settings : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPageLoaded(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.RefreshCommand.ExecuteAsync(null);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md233"></a>
File: Module_Core/Behaviors/AuditBehavior.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>AuditBehavior&lt;TRequest, TResponse&gt; : IPipelineBehavior&lt;TRequest, TResponse&gt;</div>
<div class="line">where TRequest : IRequest&lt;TResponse&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;TResponse&gt; Handle(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInformation(</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md234"></a>
File: Module_Core/Behaviors/LoggingBehavior.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>LoggingBehavior&lt;TRequest, TResponse&gt; : IPipelineBehavior&lt;TRequest, TResponse&gt;</div>
<div class="line">where TRequest : IRequest&lt;TResponse&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;TResponse&gt; Handle(</div>
<div class="line">⋮----</div>
<div class="line">var requestGuid = Guid.NewGuid().ToString();</div>
<div class="line">_logger.LogInformation(</div>
<div class="line">⋮----</div>
<div class="line">var stopwatch = Stopwatch.StartNew();</div>
<div class="line">⋮----</div>
<div class="line">stopwatch.Stop();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md235"></a>
File: Module_Core/Behaviors/ValidationBehavior.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>ValidationBehavior&lt;TRequest, TResponse&gt; : IPipelineBehavior&lt;TRequest, TResponse&gt;</div>
<div class="line">where TRequest : IRequest&lt;TResponse&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;TResponse&gt; Handle(</div>
<div class="line">⋮----</div>
<div class="line">if (!_validators.Any())</div>
<div class="line">⋮----</div>
<div class="line">var validationResults = await Task.WhenAll(</div>
<div class="line">_validators.Select(v =&gt; v.ValidateAsync(context, cancellationToken)));</div>
<div class="line">⋮----</div>
<div class="line">.SelectMany(r =&gt; r.Errors)</div>
<div class="line">.Where(f =&gt; f != null)</div>
<div class="line">.ToList();</div>
<div class="line">if (failures.Any())</div>
<div class="line">⋮----</div>
<div class="line">throw new ValidationException(failures);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md236"></a>
File: Module_Core/Contracts/Services/IService_Focus.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Focus</div>
<div class="line">⋮----</div>
<div class="line">public void SetFocus(Control control);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> SetFocusFirstInput(DependencyObject container);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> AttachFocusOnVisibility(FrameworkElement view, Control? targetControl = <span class="keyword">null</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md237"></a>
File: Module_Core/Contracts/ViewModels/IResettableViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IResettableViewModel</div>
<div class="line">⋮----</div>
<div class="line">public void ResetToDefaults();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md238"></a>
File: Module_Core/Converters/Converter_BooleanToVisibility.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_BooleanToVisibility : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">if (parameter is string s &amp;&amp; s.Equals(&quot;Inverse&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md239"></a>
File: Module_Core/Converters/Converter_BoolToString.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_BoolToString : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">var parts = paramString.Split(&#39;|&#39;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md240"></a>
File: Module_Core/Converters/Converter_DecimalToInt.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_DecimalToInt : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">return ((int)decimalValue).ToString(&quot;N0&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return ((int)doubleValue).ToString(&quot;N0&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return ((int)floatValue).ToString(&quot;N0&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">if (value is string strValue &amp;&amp; decimal.TryParse(strValue, out decimal result))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md241"></a>
File: Module_Core/Converters/Converter_DecimalToString.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_DecimalToString : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">return d == 0 ? string.Empty : d.ToString(&quot;G29&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(s))</div>
<div class="line">⋮----</div>
<div class="line">if (decimal.TryParse(s, out decimal result))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md242"></a>
File: Module_Core/Converters/Converter_DoubleToDecimal.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_DoubleToDecimal : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">return System.Convert.ToDouble(d);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">return System.Convert.ToDecimal(d);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md243"></a>
File: Module_Core/Converters/Converter_EmptyStringToVisibility.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_EmptyStringToVisibility : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">bool isVisible = !string.IsNullOrWhiteSpace(stringValue);</div>
<div class="line">if (parameter is string s &amp;&amp; s.Equals(&quot;Inverse&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md244"></a>
File: Module_Core/Converters/Converter_IconCodeToGlyph.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_IconCodeToGlyph : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">if (value is string iconCode &amp;&amp; !string.IsNullOrWhiteSpace(iconCode))</div>
<div class="line">⋮----</div>
<div class="line">if (iconCode.StartsWith(&quot;&amp;#x&quot;) &amp;&amp; iconCode.EndsWith(&quot;;&quot;))</div>
<div class="line">⋮----</div>
<div class="line">string hex = iconCode.Substring(3, iconCode.Length - 4);</div>
<div class="line">if (int.TryParse(hex, System.Globalization.NumberStyles.HexNumber, null, out int code))</div>
<div class="line">⋮----</div>
<div class="line">return ((char)code).ToString();</div>
<div class="line">⋮----</div>
<div class="line">if (iconCode.Length == 4 &amp;&amp; int.TryParse(iconCode, System.Globalization.NumberStyles.HexNumber, null, out int rawCode))</div>
<div class="line">⋮----</div>
<div class="line">return ((char)rawCode).ToString();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md245"></a>
File: Module_Core/Converters/Converter_LoadNumberToOneBased.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_LoadNumberToOneBased : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">if (value is string strValue &amp;&amp; int.TryParse(strValue, out int displayNumber))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md246"></a>
File: Module_Core/Converters/Converter_StringFormat.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_StringFormat : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">return string.Format(format, value);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md247"></a>
File: Module_Core/Defaults/InforVisualDefaults.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>InforVisualDefaults</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md248"></a>
File: Module_Core/Defaults/WorkstationDefaults.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>WorkstationDefaults</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md249"></a>
File: Module_Core/Models/Core/Model_Dao_Result_Factory.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Model_Dao_Result_Factory</div>
<div class="line">⋮----</div>
<div class="line">public static Model_Dao_Result Failure(string? message, Exception? ex = <span class="keyword">null</span>)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_Dao_Result</div>
<div class="line">⋮----</div>
<div class="line">ErrorMessage = <span class="keywordtype">string</span>.IsNullOrWhiteSpace(message) ? <span class="stringliteral">&quot;Operation failed.&quot;</span> : message,</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Model_Dao_Result Success(<span class="keywordtype">int</span> affectedRows = 0)</div>
<div class="line">⋮----</div>
<div class="line">AffectedRows = Math.Max(0, affectedRows),</div>
<div class="line">⋮----</div>
<div class="line">public static Model_Dao_Result&lt;T&gt; Failure&lt;T&gt;(<span class="keywordtype">string</span>? message, Exception? ex = null)</div>
<div class="line">⋮----</div>
<div class="line">public static Model_Dao_Result&lt;T&gt; Success&lt;T&gt;(T data, <span class="keywordtype">int</span> affectedRows = 0)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md250"></a>
File: Module_Core/Models/InforVisual/Model_InforVisualConnection.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_InforVisualConnection</div>
<div class="line">⋮----</div>
<div class="line">public string GetConnectionString()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md251"></a>
File: Module_Core/Models/InforVisual/Model_InforVisualPart.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_InforVisualPart : ObservableObject</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md252"></a>
File: Module_Core/Models/InforVisual/Model_InforVisualPO.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_InforVisualPO : ObservableObject</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md253"></a>
File: Module_Core/Models/Reporting/Model_ReportRow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReportRow</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md254"></a>
File: Module_Core/Models/Systems/Model_AuthenticationResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_AuthenticationResult</div>
<div class="line">⋮----</div>
<div class="line">public static Model_AuthenticationResult SuccessResult(Model_User user)</div>
<div class="line">⋮----</div>
<div class="line">ArgumentNullException.ThrowIfNull(user);</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_AuthenticationResult</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Model_AuthenticationResult ErrorResult(<span class="keywordtype">string</span> message)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(message))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(<span class="stringliteral">&quot;Error message cannot be null or whitespace.&quot;</span>, nameof(message));</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md255"></a>
File: Module_Core/Models/Systems/Model_UserSession.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_UserSession</div>
<div class="line">⋮----</div>
<div class="line">public void UpdateLastActivity()</div>
<div class="line">⋮----</div>
<div class="line">ArgumentNullException.ThrowIfNull(user);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md256"></a>
File: Module_Core/Models/Systems/Model_ValidationResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ValidationResult</div>
<div class="line">⋮----</div>
<div class="line">public static Model_ValidationResult Valid() =&gt; <span class="keyword">new</span>()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Model_ValidationResult Invalid(<span class="keywordtype">string</span>? message) =&gt; <span class="keyword">new</span>()</div>
<div class="line">⋮----</div>
<div class="line">ErrorMessage = <span class="keywordtype">string</span>.IsNullOrWhiteSpace(message) ? <span class="stringliteral">&quot;Validation failed.&quot;</span> : message</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md257"></a>
File: Module_Core/Services/Authentication/Service_UserSessionManager.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_UserSessionManager : IService_UserSessionManager</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_User _daoUser;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Dispatcher _dispatcherService;</div>
<div class="line">⋮----</div>
<div class="line">_daoUser = daoUser ?? throw new ArgumentNullException(nameof(daoUser));</div>
<div class="line">_dispatcherService = dispatcherService ?? throw new ArgumentNullException(nameof(dispatcherService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_UserSession CreateSession(</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentNullException(nameof(user));</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentNullException(nameof(workstationConfig));</div>
<div class="line">⋮----</div>
<div class="line">CurrentSession = new Model_UserSession</div>
<div class="line">⋮----</div>
<div class="line">public void UpdateLastActivity()</div>
<div class="line">⋮----</div>
<div class="line">public void StartTimeoutMonitoring()</div>
<div class="line">⋮----</div>
<div class="line">throw new InvalidOperationException(&quot;Cannot start timeout monitoring without an active session&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_timeoutTimer = _dispatcherService.CreateTimer();</div>
<div class="line">_timeoutTimer.Interval = TimeSpan.FromSeconds(TimerIntervalSeconds);</div>
<div class="line">⋮----</div>
<div class="line">_timeoutTimer.Start();</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Session timeout monitoring started. Timeout: {CurrentSession.TimeoutDuration.TotalMinutes} minutes&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public void StopTimeoutMonitoring()</div>
<div class="line">⋮----</div>
<div class="line">_timeoutTimer.Stop();</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;Session timeout monitoring stopped&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public bool IsSessionTimedOut()</div>
<div class="line">⋮----</div>
<div class="line">public async Task EndSessionAsync(string reason)</div>
<div class="line">⋮----</div>
<div class="line">await _daoUser.LogUserActivityAsync(</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Session ended. Reason: {reason}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Failed to log session end: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void OnTimerTick(object? sender, object args)</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(</div>
<div class="line">⋮----</div>
<div class="line">SessionTimedOut?.Invoke(this, new Model_SessionTimedOutEventArgs</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md258"></a>
File: Module_Core/Services/Database/Service_LoggingUtility.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_LoggingUtility : IService_LoggingUtility</div>
<div class="line">⋮----</div>
<div class="line">_logDirectory = Path.Combine(</div>
<div class="line">Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),</div>
<div class="line">⋮----</div>
<div class="line">System.Threading.Tasks.Task.Factory.StartNew(ProcessLogQueue,</div>
<div class="line">⋮----</div>
<div class="line">private void ProcessLogQueue()</div>
<div class="line">⋮----</div>
<div class="line">foreach (var logEntry in _logQueue.GetConsumingEnumerable())</div>
<div class="line">⋮----</div>
<div class="line">File.AppendAllText(logFilePath, logEntry, Encoding.UTF8);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Background logging failed: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public void LogInfo(string message, string? context = null)</div>
<div class="line">⋮----</div>
<div class="line">public void LogWarning(string message, string? context = null)</div>
<div class="line">⋮----</div>
<div class="line">public void LogError(string message, Exception? exception = null, string? context = null)</div>
<div class="line">⋮----</div>
<div class="line">public void LogCritical(string message, Exception? exception = null, string? context = null)</div>
<div class="line">⋮----</div>
<div class="line">public void LogFatal(string message, Exception? exception = null, string? context = null)</div>
<div class="line">⋮----</div>
<div class="line">public Task LogInfoAsync(string message, string? context = null)</div>
<div class="line">⋮----</div>
<div class="line">public Task LogErrorAsync(string message, Exception? exception = null, string? context = null)</div>
<div class="line">⋮----</div>
<div class="line">public string GetCurrentLogFilePath()</div>
<div class="line">⋮----</div>
<div class="line">return Path.Combine(_logDirectory, fileName);</div>
<div class="line">⋮----</div>
<div class="line">public bool EnsureLogDirectoryExists()</div>
<div class="line">⋮----</div>
<div class="line">if (!Directory.Exists(_logDirectory))</div>
<div class="line">⋮----</div>
<div class="line">Directory.CreateDirectory(_logDirectory);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Failed to create log directory: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public int ArchiveOldLogs(int daysToKeep = 30)</div>
<div class="line">⋮----</div>
<div class="line">var cutoffDate = DateTime.Now.AddDays(-daysToKeep);</div>
<div class="line">var archiveDirectory = Path.Combine(_logDirectory, &quot;archive&quot;);</div>
<div class="line">foreach (var file in Directory.GetFiles(_logDirectory, &quot;app_*.log&quot;))</div>
<div class="line">⋮----</div>
<div class="line">var fileInfo = new FileInfo(file);</div>
<div class="line">⋮----</div>
<div class="line">if (!Directory.Exists(archiveDirectory))</div>
<div class="line">⋮----</div>
<div class="line">Directory.CreateDirectory(archiveDirectory);</div>
<div class="line">⋮----</div>
<div class="line">string archivePath = Path.Combine(archiveDirectory, fileInfo.Name);</div>
<div class="line">if (File.Exists(archivePath))</div>
<div class="line">⋮----</div>
<div class="line">File.Delete(archivePath);</div>
<div class="line">⋮----</div>
<div class="line">File.Move(file, archivePath);</div>
<div class="line">⋮----</div>
<div class="line">private void WriteLog(string severity, string message, Exception? exception, string? context)</div>
<div class="line">⋮----</div>
<div class="line">var logEntry = new StringBuilder();</div>
<div class="line">logEntry.AppendLine($&quot;[{DateTime.Now:yyyy-MM-dd HH:mm:ss.fff}] [{severity}] {(context != null ? $&quot;[{context}]&quot; : &quot;&quot;)}&quot;);</div>
<div class="line">logEntry.AppendLine($&quot;Message: {message}&quot;);</div>
<div class="line">if (!string.IsNullOrEmpty(context))</div>
<div class="line">⋮----</div>
<div class="line">logEntry.AppendLine($&quot;Context: User={Environment.UserName}, Machine={Environment.MachineName}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">logEntry.AppendLine($&quot;Exception: {exception.GetType().FullName}: {exception.Message}&quot;);</div>
<div class="line">logEntry.AppendLine($&quot;Stack Trace:&quot;);</div>
<div class="line">logEntry.AppendLine(exception.StackTrace);</div>
<div class="line">⋮----</div>
<div class="line">logEntry.AppendLine($&quot;Inner Exception: {innerException.GetType().FullName}: {innerException.Message}&quot;);</div>
<div class="line">logEntry.AppendLine(innerException.StackTrace);</div>
<div class="line">⋮----</div>
<div class="line">logEntry.AppendLine();</div>
<div class="line">_logQueue.Add(logEntry.ToString());</div>
<div class="line">System.Diagnostics.Debug.Write(logEntry.ToString());</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;LOGGING FAILED: {ex.Message}&quot;);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Original message: {message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public Task LogWarningAsync(string message, string? context = null)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md259"></a>
File: Module_Core/Services/Service_Focus.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Focus : IService_Focus</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void SetFocus(Control control)</div>
<div class="line">⋮----</div>
<div class="line">control.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">control.Focus(FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void SetFocusFirstInput(DependencyObject container)</div>
<div class="line">⋮----</div>
<div class="line">fe.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void AttachFocusOnVisibility(FrameworkElement view, Control? targetControl = null)</div>
<div class="line">⋮----</div>
<div class="line">view.RegisterPropertyChangedCallback(UIElement.VisibilityProperty, (_, _) =&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Control? FindFirstFocusableChild(DependencyObject parent)</div>
<div class="line">⋮----</div>
<div class="line">int childrenCount = VisualTreeHelper.GetChildrenCount(parent);</div>
<div class="line">⋮----</div>
<div class="line">var child = VisualTreeHelper.GetChild(parent, i);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool IsFocusable(Control control)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md260"></a>
File: Module_Dunnage/Contracts/IService_DunnageAdminWorkflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_DunnageAdminWorkflow</div>
<div class="line">⋮----</div>
<div class="line">public Task NavigateToSectionAsync(Enum_DunnageAdminSection section);</div>
<div class="line"><span class="keyword">public</span> Task NavigateToHubAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; CanNavigateAwayAsync();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> MarkDirty();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> MarkClean();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md261"></a>
File: Module_Dunnage/Contracts/IService_DunnageCSVWriter.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_DunnageCSVWriter</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_CSVWriteResult&gt; WriteToCsvAsync(List&lt;Model_DunnageLoad&gt; loads, string typeName);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_CSVWriteResult&gt; WriteToCSVAsync(List&lt;Model_DunnageLoad&gt; loads);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_CSVWriteResult&gt; WriteDynamicCsvAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_CSVWriteResult&gt; ExportSelectedLoadsAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; IsNetworkPathAvailableAsync(<span class="keywordtype">int</span> timeout = 3);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetLocalCsvPath(<span class="keywordtype">string</span> filename);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetNetworkCsvPath(<span class="keywordtype">string</span> filename);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_CSVDeleteResult&gt; ClearCSVFilesAsync(<span class="keywordtype">string</span>? filenamePattern = <span class="keyword">null</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md262"></a>
File: Module_Dunnage/Contracts/IService_DunnageWorkflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_DunnageWorkflow</div>
<div class="line">⋮----</div>
<div class="line">public event EventHandler StepChanged;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; StartWorkflowAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_WorkflowStepResult&gt; AdvanceToNextStepAsync();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> GoToStep(Enum_DunnageWorkflowStep step);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_SaveResult&gt; SaveSessionAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_SaveResult&gt; SaveToCSVOnlyAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_SaveResult&gt; SaveToDatabaseOnlyAsync();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ClearSession();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_CSVDeleteResult&gt; ResetCSVFilesAsync();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> AddCurrentLoadToSession();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md263"></a>
File: Module_Dunnage/Contracts/IService_MySQL_Dunnage.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_MySQL_Dunnage</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageType&gt;&gt;&gt; GetAllTypesAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_DunnageType&gt;&gt; GetTypeByIdAsync(<span class="keywordtype">int</span> typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertTypeAsync(<span class="keywordtype">string</span> typeName, <span class="keywordtype">string</span> icon);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; InsertTypeAsync(Model_DunnageType type);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateTypeAsync(Model_DunnageType type);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; DeleteTypeAsync(<span class="keywordtype">int</span> typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; CheckDuplicateTypeNameAsync(<span class="keywordtype">string</span> typeName);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageSpec&gt;&gt;&gt; GetSpecsForTypeAsync(<span class="keywordtype">int</span> typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; InsertSpecAsync(Model_DunnageSpec spec);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateSpecAsync(Model_DunnageSpec spec);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; DeleteSpecAsync(<span class="keywordtype">int</span> specId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; DeleteSpecsByTypeIdAsync(<span class="keywordtype">int</span> typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;List&lt;string&gt;&gt; GetAllSpecKeysAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; GetAllPartsAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; GetPartsByTypeAsync(<span class="keywordtype">int</span> typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_DunnagePart&gt;&gt; GetPartByIdAsync(<span class="keywordtype">string</span> partId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; InsertPartAsync(Model_DunnagePart part);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdatePartAsync(Model_DunnagePart part);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; DeletePartAsync(<span class="keywordtype">string</span> partId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; SearchPartsAsync(<span class="keywordtype">string</span> searchText, <span class="keywordtype">int</span>? typeId = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; SaveLoadsAsync(List&lt;Model_DunnageLoad&gt; loads);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageLoad&gt;&gt;&gt; GetLoadsByDateRangeAsync(DateTime start, DateTime end);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageLoad&gt;&gt;&gt; GetAllLoadsAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_DunnageLoad&gt;&gt; GetLoadByIdAsync(<span class="keywordtype">string</span> loadUuid);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateLoadAsync(Model_DunnageLoad load);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; DeleteLoadAsync(<span class="keywordtype">string</span> loadUuid);</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; IsPartInventoriedAsync(<span class="keywordtype">string</span> partId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_InventoriedDunnage&gt;&gt; GetInventoryDetailsAsync(<span class="keywordtype">string</span> partId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_InventoriedDunnage&gt;&gt;&gt; GetAllInventoriedPartsAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; AddToInventoriedListAsync(Model_InventoriedDunnage item);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; RemoveFromInventoriedListAsync(<span class="keywordtype">string</span> partId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateInventoriedPartAsync(Model_InventoriedDunnage item);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetPartCountByTypeIdAsync(<span class="keywordtype">int</span> typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetTransactionCountByPartIdAsync(<span class="keywordtype">string</span> partId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetTransactionCountByTypeIdAsync(<span class="keywordtype">int</span> typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetPartCountBySpecKeyAsync(<span class="keywordtype">int</span> typeId, <span class="keywordtype">string</span> specKey);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetPartCountByTypeAsync(<span class="keywordtype">int</span> typeId) =&gt; GetPartCountByTypeIdAsync(typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetTransactionCountByTypeAsync(<span class="keywordtype">int</span> typeId) =&gt; GetTransactionCountByTypeIdAsync(typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetTransactionCountByPartAsync(<span class="keywordtype">string</span> partId) =&gt; GetTransactionCountByPartIdAsync(partId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; InsertCustomFieldAsync(<span class="keywordtype">int</span> typeId, Model_CustomFieldDefinition field);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_CustomFieldDefinition&gt;&gt;&gt; GetCustomFieldsByTypeAsync(<span class="keywordtype">int</span> typeId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; DeleteCustomFieldAsync(<span class="keywordtype">int</span> fieldId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpsertUserPreferenceAsync(<span class="keywordtype">string</span> key, <span class="keywordtype">string</span> value);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_IconDefinition&gt;&gt;&gt; GetRecentlyUsedIconsAsync(<span class="keywordtype">int</span> count);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md264"></a>
File: Module_Dunnage/Data/Dao_DunnageLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Dao_DunnageLine</div>
<div class="line">⋮----</div>
<div class="line">public static void SetErrorHandler(IService_ErrorHandler errorHandler)</div>
<div class="line">⋮----</div>
<div class="line">public static async Task&lt;Model_Dao_Result&gt; InsertDunnageLineAsync(Model_DunnageLine line)</div>
<div class="line">⋮----</div>
<div class="line">string connectionString = Helper_Database_Variables.GetConnectionString(useProduction: <span class="keyword">true</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Line1&quot;</span>, line.Line1 ?? <span class="keywordtype">string</span>.Empty),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Line2&quot;</span>, line.Line2 ?? <span class="keywordtype">string</span>.Empty),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_PONumber&quot;</span>, line.PONumber),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Date&quot;</span>, line.Date),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_EmployeeNumber&quot;</span>, line.EmployeeNumber),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_VendorName&quot;</span>, line.VendorName ?? <span class="stringliteral">&quot;Unknown&quot;</span>),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Location&quot;</span>, line.Location ?? <span class="keywordtype">string</span>.Empty),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Status&quot;</span>, MySqlDbType.Int32) { Direction = System.Data.ParameterDirection.Output },</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_ErrorMsg&quot;</span>, MySqlDbType.VarChar, 500) { Direction = System.Data.ParameterDirection.Output }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (!Helper_Database_StoredProcedure.ValidateParameters(parameters))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_Dao_Result</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line">var errorResult = <span class="keyword">new</span> Model_Dao_Result</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md265"></a>
File: Module_Dunnage/Data/Dao_DunnagePart.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_DunnagePart</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; GetByTypeAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;Dao_DunnagePart: GetByTypeAsync called for typeId={typeId}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;Dao_DunnagePart: GetByTypeAsync returned {result.Data?.Count ?? 0} parts. Success: {result.IsSuccess}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;Model_DunnagePart&gt;&gt; GetByIdAsync(<span class="keywordtype">string</span> partId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertAsync(<span class="keywordtype">string</span> partId, <span class="keywordtype">int</span> typeId, <span class="keywordtype">string</span> specValues, <span class="keywordtype">string</span> homeLocation, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line">var pNewId = <span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_new_id&quot;</span>, MySqlDbType.Int32)</div>
<div class="line">⋮----</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_part_id&quot;</span>, partId),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_type_id&quot;</span>, typeId),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_spec_values&quot;</span>, specValues),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_home_location&quot;</span>, homeLocation),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_user&quot;</span>, user),</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success&lt;<span class="keywordtype">int</span>&gt;(Convert.ToInt32(pNewId.Value));</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; UpdateAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">string</span> specValues, <span class="keywordtype">string</span> homeLocation, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; CountTransactionsAsync(<span class="keywordtype">string</span> partId)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;transaction_count&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; SearchAsync(<span class="keywordtype">string</span> searchText, <span class="keywordtype">int</span>? typeId = null)</div>
<div class="line">⋮----</div>
<div class="line">private Model_DunnagePart MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_DunnagePart</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">PartId = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;part_id&quot;</span>)),</div>
<div class="line">TypeId = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;type_id&quot;</span>)),</div>
<div class="line">SpecValues = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;spec_values&quot;</span>)) ? <span class="stringliteral">&quot;{}&quot;</span> : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;spec_values&quot;</span>)),</div>
<div class="line">HomeLocation = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;home_location&quot;</span>)) ? <span class="keywordtype">string</span>.Empty : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;home_location&quot;</span>)),</div>
<div class="line">CreatedBy = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">ModifiedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>)) ? null : reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md266"></a>
File: Module_Dunnage/Data/Dao_DunnageSpec.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_DunnageSpec</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageSpec&gt;&gt;&gt; GetByTypeAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageSpec&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;Model_DunnageSpec&gt;&gt; GetByIdAsync(int id)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertAsync(int typeId, string specKey, string specValue, string user)</div>
<div class="line">⋮----</div>
<div class="line">var pNewId = <span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_new_id&quot;</span>, MySqlDbType.Int32)</div>
<div class="line">⋮----</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_type_id&quot;</span>, typeId),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_spec_key&quot;</span>, specKey),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_spec_value&quot;</span>, specValue),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_user&quot;</span>, user),</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success&lt;<span class="keywordtype">int</span>&gt;(Convert.ToInt32(pNewId.Value));</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; UpdateAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">string</span> specValue, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; DeleteByIdAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; DeleteByTypeAsync(<span class="keywordtype">int</span> typeId)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; CountPartsUsingSpecAsync(<span class="keywordtype">int</span> typeId, <span class="keywordtype">string</span> specKey)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;part_count&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;<span class="keywordtype">string</span>&gt;&gt;&gt; GetAllSpecKeysAsync()</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;SpecKey&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">private Model_DunnageSpec MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_DunnageSpec</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">TypeId = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;type_id&quot;</span>)),</div>
<div class="line">SpecKey = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;spec_key&quot;</span>)),</div>
<div class="line">SpecValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;spec_value&quot;</span>)) ? <span class="stringliteral">&quot;{}&quot;</span> : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;spec_value&quot;</span>)),</div>
<div class="line">CreatedBy = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">ModifiedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>)) ? null : reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md267"></a>
File: Module_Dunnage/Data/Dao_DunnageUserPreference.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_DunnageUserPreference</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; UpsertAsync(string userId, string key, string value)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_IconDefinition&gt;&gt;&gt; GetRecentlyUsedIconsAsync(string userId, int count)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; <span class="keyword">new</span> Model_IconDefinition</div>
<div class="line">⋮----</div>
<div class="line">IconName = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;icon_name&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md268"></a>
File: Module_Dunnage/Enums/Enum_DunnageAdminSection.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md269"></a>
File: Module_Dunnage/Models/Model_CustomFieldDefinition.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_CustomFieldDefinition : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdDate = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetSummary()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md270"></a>
File: Module_Dunnage/Models/Model_DunnageLoad.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_DunnageLoad : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Guid _loadUuid;</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrEmpty(TypeIcon) &amp;&amp; Enum.TryParse&lt;MaterialIconKind&gt;(TypeIcon, true, out var kind))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _receivedDate = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdDate = DateTime.Now;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md271"></a>
File: Module_Dunnage/Services/Service_MySQL_Dunnage.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_MySQL_Dunnage : IService_MySQL_Dunnage</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_DunnageLoad _daoDunnageLoad;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_DunnageType _daoDunnageType;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_DunnagePart _daoDunnagePart;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_DunnageSpec _daoDunnageSpec;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_InventoriedDunnage _daoInventoriedDunnage;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_DunnageCustomField _daoCustomField;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_DunnageUserPreference _daoUserPreference;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageType&gt;&gt;&gt; GetAllTypesAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageType.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_DunnageType&gt;&gt; GetTypeByIdAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageType.GetByIdAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertTypeAsync(string typeName, string icon)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageType.InsertAsync(typeName, icon, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertTypeAsync(Model_DunnageType type)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Inserting new dunnage type: {type.TypeName} (Icon: {type.Icon}) by user: {CurrentUser}&quot;);</div>
<div class="line">var result = await _daoDunnageType.InsertAsync(type.TypeName, type.Icon, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully inserted dunnage type &#39;{type.TypeName}&#39; with ID: {type.Id}&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Success();</div>
<div class="line">⋮----</div>
<div class="line">if (result.ErrorMessage.Contains(&quot;Duplicate entry&quot;))</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Failed to insert dunnage type &#39;{type.TypeName}&#39;: Duplicate entry&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;The dunnage type name &#39;{type.TypeName}&#39; is already in use.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to insert dunnage type &#39;{type.TypeName}&#39;: {result.ErrorMessage}&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Failure(result.ErrorMessage);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in InsertTypeAsync for type &#39;{type.TypeName}&#39;: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error inserting dunnage type: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpdateTypeAsync(Model_DunnageType type)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Updating dunnage type ID {type.Id}: {type.TypeName} (Icon: {type.Icon}) by user: {CurrentUser}&quot;);</div>
<div class="line">var result = await _daoDunnageType.UpdateAsync(type.Id, type.TypeName, type.Icon, CurrentUser);</div>
<div class="line">if (!result.IsSuccess &amp;&amp; result.ErrorMessage.Contains(&quot;Duplicate entry&quot;))</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Failed to update dunnage type ID {type.Id}: Duplicate entry for &#39;{type.TypeName}&#39;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully updated dunnage type ID {type.Id}: {type.TypeName}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to update dunnage type ID {type.Id}: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in UpdateTypeAsync for type ID {type.Id}: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error updating dunnage type: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeleteTypeAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Attempting to delete dunnage type ID {typeId} by user: {CurrentUser}&quot;);</div>
<div class="line">var partsResult = await _daoDunnagePart.GetByTypeAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Cannot delete dunnage type ID {typeId}: Used by {partsResult.Data.Count} parts&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Cannot delete type. It is used by {partsResult.Data.Count} parts.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var specsResult = await _daoDunnageSpec.GetByTypeAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Cannot delete dunnage type ID {typeId}: Has {specsResult.Data.Count} specifications defined&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Cannot delete type. It has {specsResult.Data.Count} specifications defined. Please delete them first.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoDunnageType.DeleteAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully deleted dunnage type ID {typeId}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to delete dunnage type ID {typeId}: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in DeleteTypeAsync for type ID {typeId}: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error deleting dunnage type: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; CheckDuplicateTypeNameAsync(string typeName)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoDunnageType.CheckDuplicateNameAsync(typeName);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageSpec&gt;&gt;&gt; GetSpecsForTypeAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageSpec.GetByTypeAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertSpecAsync(Model_DunnageSpec spec)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Inserting spec &#39;{spec.SpecKey}&#39; for type ID {spec.TypeId} by user: {CurrentUser}&quot;);</div>
<div class="line">var result = await _daoDunnageSpec.InsertAsync(spec.TypeId, spec.SpecKey, spec.SpecValue, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully inserted spec &#39;{spec.SpecKey}&#39; with ID: {spec.Id}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to insert spec &#39;{spec.SpecKey}&#39; for type ID {spec.TypeId}: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in InsertSpecAsync for spec &#39;{spec.SpecKey}&#39;: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error inserting spec: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpdateSpecAsync(Model_DunnageSpec spec)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Updating spec ID {spec.Id}: {spec.SpecKey} = {spec.SpecValue} by user: {CurrentUser}&quot;);</div>
<div class="line">var result = await _daoDunnageSpec.UpdateAsync(spec.Id, spec.SpecValue, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully updated spec ID {spec.Id}: {spec.SpecKey}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to update spec ID {spec.Id}: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in UpdateSpecAsync for spec ID {spec.Id}: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error updating spec: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeleteSpecAsync(int specId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageSpec.DeleteByIdAsync(specId);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error deleting spec: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeleteSpecsByTypeIdAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;List&lt;string&gt;&gt; GetAllSpecKeysAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoDunnageSpec.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">.Select(s =&gt; s.SpecKey)</div>
<div class="line">.Distinct()</div>
<div class="line">.Order()</div>
<div class="line">.ToList();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; GetAllPartsAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnagePart.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; GetPartsByTypeAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Service_MySQL_Dunnage: GetPartsByTypeAsync called for typeId={typeId}&quot;, &quot;DunnageService&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoDunnagePart.GetByTypeAsync(typeId);</div>
<div class="line">_logger.LogInfo($&quot;Service_MySQL_Dunnage: GetPartsByTypeAsync returned {result.Data?.Count ?? 0} parts&quot;, &quot;DunnageService&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_DunnagePart&gt;&gt; GetPartByIdAsync(string partId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnagePart.GetByIdAsync(partId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertPartAsync(Model_DunnagePart part)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Inserting new dunnage part: {part.PartId} (Type ID: {part.TypeId}, Home Location: {part.HomeLocation}) by user: {CurrentUser}&quot;);</div>
<div class="line">var result = await _daoDunnagePart.InsertAsync(part.PartId, part.TypeId, part.SpecValues, part.HomeLocation, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully inserted dunnage part &#39;{part.PartId}&#39; with ID: {part.Id}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to insert dunnage part &#39;{part.PartId}&#39;: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in InsertPartAsync for part &#39;{part.PartId}&#39;: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error inserting part: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpdatePartAsync(Model_DunnagePart part)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Updating dunnage part ID {part.Id} (Part ID: {part.PartId}, Home Location: {part.HomeLocation}) by user: {CurrentUser}&quot;);</div>
<div class="line">var result = await _daoDunnagePart.UpdateAsync(part.Id, part.SpecValues, part.HomeLocation, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully updated dunnage part ID {part.Id}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to update dunnage part ID {part.Id}: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in UpdatePartAsync for part ID {part.Id}: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error updating part: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeletePartAsync(string partId)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Delete part not implemented in DAO yet.&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnagePart&gt;&gt;&gt; SearchPartsAsync(string searchText, int? typeId)</div>
<div class="line">⋮----</div>
<div class="line">result = await _daoDunnagePart.GetByTypeAsync(typeId.Value);</div>
<div class="line">⋮----</div>
<div class="line">result = await _daoDunnagePart.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(searchText))</div>
<div class="line">⋮----</div>
<div class="line">var filtered = result.Data.Where(p =&gt;</div>
<div class="line">p.PartId.Contains(searchText, StringComparison.OrdinalIgnoreCase) ||</div>
<div class="line">p.DunnageTypeName.Contains(searchText, StringComparison.OrdinalIgnoreCase)</div>
<div class="line">).ToList();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; SaveLoadsAsync(List&lt;Model_DunnageLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;SaveLoadsAsync called with no loads to save&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Saving batch of {loads.Count} dunnage loads by user: {CurrentUser}&quot;);</div>
<div class="line">var result = await _daoDunnageLoad.InsertBatchAsync(loads, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">var totalQuantity = loads.Sum(l =&gt; l.Quantity);</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully saved {loads.Count} dunnage loads (Total Quantity: {totalQuantity})&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to save {loads.Count} dunnage loads: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in SaveLoadsAsync for {loads?.Count ?? 0} loads: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error saving loads: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageLoad&gt;&gt;&gt; GetLoadsByDateRangeAsync(DateTime start, DateTime end)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageLoad.GetByDateRangeAsync(start, end);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageLoad&gt;&gt;&gt; GetAllLoadsAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageLoad.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_DunnageLoad&gt;&gt; GetLoadByIdAsync(string loadUuid)</div>
<div class="line">⋮----</div>
<div class="line">if (Guid.TryParse(loadUuid, out var guid))</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageLoad.GetByIdAsync(guid);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpdateLoadAsync(Model_DunnageLoad load)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Update load not implemented in DAO yet.&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeleteLoadAsync(string loadUuid)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Delete load not implemented in DAO yet.&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; IsPartInventoriedAsync(string partId)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoInventoriedDunnage.CheckAsync(partId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_InventoriedDunnage&gt;&gt; GetInventoryDetailsAsync(string partId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoInventoriedDunnage.GetByPartAsync(partId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_InventoriedDunnage&gt;&gt;&gt; GetAllInventoriedPartsAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await _daoInventoriedDunnage.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; AddToInventoriedListAsync(Model_InventoriedDunnage item)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Adding part &#39;{item.PartId}&#39; to inventoried list (Method: {item.InventoryMethod}) by user: {CurrentUser}&quot;);</div>
<div class="line">var result = await _daoInventoriedDunnage.InsertAsync(item.PartId, item.InventoryMethod ?? string.Empty, item.Notes ?? string.Empty, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully added part &#39;{item.PartId}&#39; to inventoried list with ID: {item.Id}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to add part &#39;{item.PartId}&#39; to inventoried list: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in AddToInventoriedListAsync for part &#39;{item.PartId}&#39;: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error adding to inventory list: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; RemoveFromInventoriedListAsync(string partId)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Remove from inventory list not implemented in DAO yet.&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpdateInventoriedPartAsync(Model_InventoriedDunnage item)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoInventoriedDunnage.UpdateAsync(item.Id, item.InventoryMethod ?? string.Empty, item.Notes ?? string.Empty, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error updating inventory item: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetPartCountByTypeIdAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageType.CountPartsAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetTransactionCountByPartIdAsync(string partId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnagePart.CountTransactionsAsync(partId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetTransactionCountByTypeIdAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageType.CountTransactionsAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetPartCountBySpecKeyAsync(int typeId, string specKey)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoDunnageSpec.CountPartsUsingSpecAsync(typeId, specKey);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertCustomFieldAsync(int typeId, Model_CustomFieldDefinition field)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoCustomField.InsertAsync(typeId, field, CurrentUser);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error inserting custom field: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_CustomFieldDefinition&gt;&gt;&gt; GetCustomFieldsByTypeAsync(int typeId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoCustomField.GetByTypeAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeleteCustomFieldAsync(int fieldId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoCustomField.DeleteAsync(fieldId);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error deleting custom field: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpsertUserPreferenceAsync(string key, string value)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoUserPreference.UpsertAsync(CurrentUser, key, value);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error saving user preference: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_IconDefinition&gt;&gt;&gt; GetRecentlyUsedIconsAsync(int count)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoUserPreference.GetRecentlyUsedIconsAsync(CurrentUser, count);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void HandleException(Exception ex, Enum_ErrorSeverity severity, string method, string className)</div>
<div class="line">⋮----</div>
<div class="line">_ = _errorHandler.HandleErrorAsync($&quot;Error in {method} ({className}): {ex.Message}&quot;, severity, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md272"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_AdminPartsViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_AdminParts : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageAdminWorkflow _adminWorkflow;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Pagination _paginationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadPartsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var typesResult = await _dunnageService.GetAllTypesAsync();</div>
<div class="line">⋮----</div>
<div class="line">AvailableTypes.Clear();</div>
<div class="line">⋮----</div>
<div class="line">AvailableTypes.Add(type);</div>
<div class="line">⋮----</div>
<div class="line">var partsResult = await _dunnageService.GetAllPartsAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(partsResult, &quot;LoadPartsAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.SetSource(_allParts);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Loaded {TotalRecords} dunnage parts&quot;, &quot;PartManagement&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">private async Task FilterByTypeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.GetPartsByTypeAsync(SelectedFilterType.Id);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(result, &quot;FilterByTypeAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SearchPartsAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(SearchText))</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.SearchPartsAsync(SearchText);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(result, &quot;SearchPartsAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ClearFiltersAsync()</div>
<div class="line">⋮----</div>
<div class="line">private void NextPage()</div>
<div class="line">⋮----</div>
<div class="line">if (_paginationService.NextPage())</div>
<div class="line">⋮----</div>
<div class="line">private void PreviousPage()</div>
<div class="line">⋮----</div>
<div class="line">if (_paginationService.PreviousPage())</div>
<div class="line">⋮----</div>
<div class="line">private void FirstPage()</div>
<div class="line">⋮----</div>
<div class="line">if (_paginationService.FirstPage())</div>
<div class="line">⋮----</div>
<div class="line">private void LastPage()</div>
<div class="line">⋮----</div>
<div class="line">if (_paginationService.LastPage())</div>
<div class="line">⋮----</div>
<div class="line">private void LoadPage()</div>
<div class="line">⋮----</div>
<div class="line">Parts.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Parts.Add(item);</div>
<div class="line">⋮----</div>
<div class="line">private void OnPageChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">private void UpdateNavigationButtons()</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowDeleteConfirmationAsync()</div>
<div class="line">⋮----</div>
<div class="line">var countResult = await _dunnageService.GetTransactionCountByPartAsync(SelectedPart.PartId);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(countResult, &quot;GetTransactionCountByPartAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">var warningDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">XamlRoot = _windowService.GetXamlRoot()</div>
<div class="line">⋮----</div>
<div class="line">await warningDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var confirmDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var result = await confirmDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">private async Task DeletePartAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.DeletePartAsync(SelectedPart.PartId);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(result, &quot;DeletePartAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Deleted part: {SelectedPart.PartId}&quot;, &quot;PartManagement&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ReturnToAdminHubAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _adminWorkflow.NavigateToHubAsync();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedPartChanged(Model_DunnagePart? value)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md273"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_DetailsEntryViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_DetailsEntry : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Dispatcher _dispatcher;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnWorkflowStepChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">_dispatcher.TryEnqueue(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task LoadSpecsForSelectedPartAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;No type selected in workflow session&quot;, null, &quot;DetailsEntry&quot;);</div>
<div class="line">SpecInputs.Clear();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loading specs for type ID: {selectedTypeId}&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">var specsResult = await _dunnageService.GetSpecsForTypeAsync(selectedTypeId);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;No specs found for type {selectedTypeId}: {specsResult.ErrorMessage}&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded {specs.Count} specs from database&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (selectedPart != null &amp;&amp; !string.IsNullOrWhiteSpace(selectedPart.SpecValues))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded spec values from part: {selectedPart.SpecValues}&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to parse part spec values: {ex.Message}&quot;, ex, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">TextSpecs.Clear();</div>
<div class="line">NumberSpecs.Clear();</div>
<div class="line">BooleanSpecs.Clear();</div>
<div class="line">⋮----</div>
<div class="line">var specType = specValueDict.ContainsKey(&quot;type&quot;) ? specValueDict[&quot;type&quot;]?.ToString()?.ToLowerInvariant() ?? &quot;text&quot; : &quot;text&quot;;</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrWhiteSpace(defaultValue))</div>
<div class="line">⋮----</div>
<div class="line">typedValue = double.Parse(defaultValue);</div>
<div class="line">⋮----</div>
<div class="line">typedValue = bool.Parse(defaultValue);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Failed to convert value &#39;{defaultValue}&#39; to type &#39;{specType}&#39;: {ex.Message}&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var input = new Model_SpecInput</div>
<div class="line">⋮----</div>
<div class="line">Unit = specValueDict.ContainsKey(&quot;unit&quot;) ? specValueDict[&quot;unit&quot;]?.ToString() : null,</div>
<div class="line">IsRequired = specValueDict.ContainsKey(&quot;required&quot;) &amp;&amp; bool.Parse(specValueDict[&quot;required&quot;]?.ToString() ?? &quot;false&quot;),</div>
<div class="line">⋮----</div>
<div class="line">SpecInputs.Add(input);</div>
<div class="line">var typeFromDb = specValueDict.ContainsKey(&quot;type&quot;) ? specValueDict[&quot;type&quot;]?.ToString() ?? &quot;null&quot; : &quot;not found&quot;;</div>
<div class="line">_logger.LogInfo($&quot;Processing spec: {spec.SpecKey}, Type from DB: {typeFromDb}, Normalized: {specType}&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">BooleanSpecs.Add(input);</div>
<div class="line">_logger.LogInfo($&quot;Added {spec.SpecKey} to BooleanSpecs&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">NumberSpecs.Add(input);</div>
<div class="line">_logger.LogInfo($&quot;Added {spec.SpecKey} to NumberSpecs&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">TextSpecs.Add(input);</div>
<div class="line">_logger.LogInfo($&quot;Added {spec.SpecKey} to TextSpecs&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Created {SpecInputs.Count} spec input controls (Text: {TextSpecs.Count}, Number: {NumberSpecs.Count}, Boolean: {BooleanSpecs.Count})&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var isInventoried = await _dunnageService.IsPartInventoriedAsync(selectedPart.PartId);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">private Dictionary&lt;string, object&gt; ParseSpecValue(string specValue)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(specValue))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to parse spec value JSON: {ex.Message}&quot;, ex, &quot;DetailsEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnPoNumberChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(value))</div>
<div class="line">⋮----</div>
<div class="line">private void UpdateInventoryMessage()</div>
<div class="line">⋮----</div>
<div class="line">private bool ValidateInputs()</div>
<div class="line">⋮----</div>
<div class="line">foreach (var spec in SpecInputs.Where(s =&gt; s.IsRequired))</div>
<div class="line">⋮----</div>
<div class="line">if (spec.Value == null || string.IsNullOrWhiteSpace(spec.Value.ToString()))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void GoBack()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Navigating back to Quantity Entry&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.QuantityEntry);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task GoNextAsync()</div>
<div class="line">⋮----</div>
<div class="line">var specValues = SpecInputs.ToDictionary(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Details saved, navigating to Review&quot;, &quot;DetailsEntry&quot;);</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.Review);</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md274"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_ManualEntryViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_ManualEntry : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageCSVWriter _csvWriter;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var typesResult = await _dunnageService.GetAllTypesAsync();</div>
<div class="line">⋮----</div>
<div class="line">AvailableTypes.Clear();</div>
<div class="line">⋮----</div>
<div class="line">AvailableTypes.Add(type);</div>
<div class="line">⋮----</div>
<div class="line">var partsResult = await _dunnageService.GetAllPartsAsync();</div>
<div class="line">⋮----</div>
<div class="line">AvailableParts.Clear();</div>
<div class="line">⋮----</div>
<div class="line">AvailableParts.Add(part);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Manual Entry initialized&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">private void AddRow()</div>
<div class="line">⋮----</div>
<div class="line">var newLoad = new Model_DunnageLoad</div>
<div class="line">⋮----</div>
<div class="line">Loads.Add(newLoad);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Added new row, total: {Loads.Count}&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task AddMultipleRowsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Cannot show dialog: XamlRoot is null&quot;, null, &quot;ManualEntry&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Unable to display dialog&quot;, Enum_ErrorSeverity.Error, null, true);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Added {count} rows via dialog, total: {Loads.Count}&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void RemoveRow()</div>
<div class="line">⋮----</div>
<div class="line">Loads.Remove(SelectedLoad);</div>
<div class="line">SelectedLoad = Loads.LastOrDefault();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Removed row, total: {Loads.Count}&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void FillBlankSpaces()</div>
<div class="line">⋮----</div>
<div class="line">var lastLoad = Loads.LastOrDefault();</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.PoNumber) &amp;&amp; !string.IsNullOrWhiteSpace(lastLoad.PoNumber))</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.Location) &amp;&amp; !string.IsNullOrWhiteSpace(lastLoad.Location))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Fill blank spaces executed&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void SortForPrinting()</div>
<div class="line">⋮----</div>
<div class="line">.OrderBy(l =&gt; l.PartId)</div>
<div class="line">.ThenBy(l =&gt; l.PoNumber)</div>
<div class="line">.ThenBy(l =&gt; l.TypeName)</div>
<div class="line">.ToList();</div>
<div class="line">Loads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Loads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Sort for printing executed&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task AutoFillAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(SelectedLoad.PartId))</div>
<div class="line">⋮----</div>
<div class="line">var partResult = await _dunnageService.GetPartByIdAsync(SelectedLoad.PartId);</div>
<div class="line">⋮----</div>
<div class="line">var type = AvailableTypes.FirstOrDefault(t =&gt; t.Id == part.TypeId);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Auto-filled {part.SpecValuesDict.Count} spec values for Part ID: {SelectedLoad.PartId}&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(SelectedLoad.InventoryMethod))</div>
<div class="line">⋮----</div>
<div class="line">SelectedLoad.InventoryMethod = string.IsNullOrWhiteSpace(SelectedLoad.PoNumber) ? &quot;Adjust In&quot; : &quot;Receive In&quot;;</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Auto-fill completed for Part ID: {SelectedLoad.PartId}&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SaveToHistoryAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.SaveLoadsAsync(Loads.ToList());</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Saved {Loads.Count} loads to history&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(result, &quot;SaveToHistoryAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SaveAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.TypeName) || string.IsNullOrWhiteSpace(load.PartId))</div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _dunnageService.SaveLoadsAsync(Loads.ToList());</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(saveResult, &quot;SaveAllAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">var csvResult = await _csvWriter.WriteToCSVAsync(Loads.ToList());</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Saved {Loads.Count} loads&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ReturnToModeSelectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync().AsTask();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User confirmed return to mode selection, clearing loads&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.ClearSession();</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.ModeSelection);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to return to mode selection: {ex.Message}&quot;, ex, &quot;ManualEntry&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to return to mode selection&quot;, Enum_ErrorSeverity.Error, ex, true);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User cancelled return to mode selection&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadSpecColumnsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var specKeys = await _dunnageService.GetAllSpecKeysAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded {SpecColumnHeaders.Count} dynamic spec columns&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to load spec columns: {ex.Message}&quot;, ex, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task OnPartIdChangedAsync(Model_DunnageLoad load)</div>
<div class="line">⋮----</div>
<div class="line">if (load == null || string.IsNullOrWhiteSpace(load.PartId))</div>
<div class="line">⋮----</div>
<div class="line">var partResult = await _dunnageService.GetPartByIdAsync(load.PartId);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Auto-populated data for Part ID: {load.PartId}&quot;, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error auto-populating part data: {ex.Message}&quot;, ex, &quot;ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdateCanSave()</div>
<div class="line">⋮----</div>
<div class="line">CanSave = Loads.Any(l =&gt; !string.IsNullOrWhiteSpace(l.TypeName) || !string.IsNullOrWhiteSpace(l.PartId));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md275"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_PartSelectionViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_PartSelection : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService; <span class="keyword">private</span> readonly IService_Help _helpService; <span class="keyword">private</span> readonly IService_Dispatcher _dispatcher;</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;PartSelection: ViewModel constructed and subscribed to StepChanged&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnWorkflowStepChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;PartSelection: Workflow step changed to {_workflowService.CurrentStep}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;PartSelection: Step is PartSelection, calling InitializeAsync via dispatcher&quot;, &quot;PartSelection&quot;);</div>
<div class="line">_dispatcher.TryEnqueue(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrEmpty(SelectedTypeIcon) &amp;&amp; Enum.TryParse&lt;MaterialIconKind&gt;(SelectedTypeIcon, true, out var kind))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;PartSelection: InitializeAsync called&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;PartSelection: InitializeAsync returning because IsBusy is true&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;PartSelection: SelectedTypeId={SelectedTypeId}, SelectedTypeName={SelectedTypeName}, SelectedTypeIcon={SelectedTypeIcon}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;PartSelection: {StatusMessage}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;PartSelection: Failed to initialize: {ex.Message}&quot;, ex, &quot;PartSelection&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">private async Task LoadPartsAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;PartSelection: LoadPartsAsync called with SelectedTypeId={SelectedTypeId}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;PartSelection: SelectedTypeId is 0, returning from LoadPartsAsync&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;PartSelection: Calling _dunnageService.GetPartsByTypeAsync({SelectedTypeId})&quot;, &quot;PartSelection&quot;);</div>
<div class="line">var result = await _dunnageService.GetPartsByTypeAsync(SelectedTypeId);</div>
<div class="line">⋮----</div>
<div class="line">AvailableParts.Clear();</div>
<div class="line">⋮----</div>
<div class="line">AvailableParts.Add(part);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;PartSelection: Successfully loaded {AvailableParts.Count} parts&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;PartSelection: Failed to load parts: {result.ErrorMessage}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;PartSelection: Error in LoadPartsAsync: {ex.Message}&quot;, ex, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedPartChanged(Model_DunnagePart? oldValue, Model_DunnagePart? newValue)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Part selected via ComboBox: {newValue.PartId}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Updated workflow session with selected part: {newValue.PartId}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">SelectPartCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">private async Task CheckInventoryStatusAsync(Model_DunnagePart part)</div>
<div class="line">⋮----</div>
<div class="line">var isInventoried = await _dunnageService.IsPartInventoriedAsync(part.PartId);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Part {part.PartId} is inventoried - showing notification&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error checking inventory status: {ex.Message}&quot;, ex, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void UpdateInventoryMessage()</div>
<div class="line">⋮----</div>
<div class="line">private void GoBack()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Returning to Type Selection&quot;, &quot;PartSelection&quot;);</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.TypeSelection);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SelectPartAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Selected part: {SelectedPart.PartId}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.QuantityEntry);</div>
<div class="line">⋮----</div>
<div class="line">private async Task QuickAddPartAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Quick Add Part requested for type {SelectedTypeName}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">var specsResult = await _dunnageService.GetSpecsForTypeAsync(SelectedTypeId);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Cannot show dialog: XamlRoot is null&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Adding new part: {partId} for type {SelectedTypeName}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">var newPart = new Model_DunnagePart</div>
<div class="line">⋮----</div>
<div class="line">var insertResult = await _dunnageService.InsertPartAsync(newPart);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully added part: {partId}&quot;, &quot;PartSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var addedPart = AvailableParts.FirstOrDefault(p =&gt; p.PartId == partId);</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md276"></a>
File: Module_Dunnage/Views/View_Dunnage_AdminInventoryView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_AdminInventoryView : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> override async void OnNavigatedTo(NavigationEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">base.OnNavigatedTo(e);</div>
<div class="line">App.GetService&lt;IService_LoggingUtility&gt;().LogInfo(&quot;Admin Inventory View loaded&quot;, &quot;AdminInventoryView&quot;);</div>
<div class="line">await ViewModel.InitializeAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md277"></a>
File: Module_Dunnage/Views/View_Dunnage_AdminTypesView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_AdminTypesView : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPageLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">App.GetService&lt;IService_LoggingUtility&gt;().LogInfo(&quot;Admin Types View loaded&quot;, &quot;AdminTypesView&quot;);</div>
<div class="line">await ViewModel.LoadTypesCommand.ExecuteAsync(null);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md278"></a>
File: Module_Dunnage/Views/View_Dunnage_Control_IconPickerControl.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_Control_IconPickerControl : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> static readonly DependencyProperty SelectedIconProperty =</div>
<div class="line">DependencyProperty.Register(</div>
<div class="line">⋮----</div>
<div class="line">new PropertyMetadata(MaterialIconKind.PackageVariantClosed, OnSelectedIconChanged));</div>
<div class="line"><span class="keyword">public</span> static readonly DependencyProperty RecentlyUsedIconsProperty =</div>
<div class="line">⋮----</div>
<div class="line">new PropertyMetadata(default(ObservableCollection&lt;Model_IconDefinition&gt;)));</div>
<div class="line">⋮----</div>
<div class="line">_allIcons = Helper_MaterialIcons.GetAllIcons();</div>
<div class="line">_filteredIcons = new ObservableCollection&lt;MaterialIconKind&gt;(_allIcons.Take(200));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> static void OnSelectedIconChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var recent = control.RecentlyUsedIcons.FirstOrDefault(x =&gt; x.Kind == kind);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnRecentIconSelectionChanged(object sender, SelectionChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnSearchTextChanged(object sender, TextChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">_filteredIcons.Clear();</div>
<div class="line">var matches = Helper_MaterialIcons.SearchIcons(searchText).Take(200);</div>
<div class="line">⋮----</div>
<div class="line">_filteredIcons.Add(icon);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md279"></a>
File: Module_Dunnage/Views/View_Dunnage_QuickAddPartDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_QuickAddPartDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void GenerateSpecFields()</div>
<div class="line">⋮----</div>
<div class="line">if (string.Equals(spec.SpecKey, &quot;Width&quot;, System.StringComparison.OrdinalIgnoreCase) ||</div>
<div class="line">string.Equals(spec.SpecKey, &quot;Height&quot;, System.StringComparison.OrdinalIgnoreCase) ||</div>
<div class="line">string.Equals(spec.SpecKey, &quot;Depth&quot;, System.StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">def = new SpecDefinition { DataType = <span class="stringliteral">&quot;Text&quot;</span> };</div>
<div class="line">⋮----</div>
<div class="line">var stackPanel = <span class="keyword">new</span> StackPanel { Spacing = 4 };</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(def.Unit))</div>
<div class="line">⋮----</div>
<div class="line">var label = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(label);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keywordtype">string</span>.Equals(def.DataType, <span class="stringliteral">&quot;Number&quot;</span>, System.StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">var numberBox = <span class="keyword">new</span> NumberBox</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.Equals(def.DataType, <span class="stringliteral">&quot;Boolean&quot;</span>, System.StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">var checkBox = <span class="keyword">new</span> CheckBox</div>
<div class="line">⋮----</div>
<div class="line">var textBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">PlaceholderText = $<span class="stringliteral">&quot;Enter {spec.SpecKey.ToLower()}&quot;</span>,</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(inputControl);</div>
<div class="line">DynamicSpecsPanel.Children.Add(stackPanel);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> OnDimensionChanged(NumberBox sender, NumberBoxValueChangedEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> UpdatePartId()</div>
<div class="line">⋮----</div>
<div class="line">parts.Add(TypeName);</div>
<div class="line">⋮----</div>
<div class="line">if (kvp.Value is TextBox tb &amp;&amp; !<span class="keywordtype">string</span>.IsNullOrWhiteSpace(tb.Text))</div>
<div class="line">⋮----</div>
<div class="line">textSpecs.Add(tb.Text.Trim());</div>
<div class="line">⋮----</div>
<div class="line">if (!<span class="keywordtype">double</span>.IsNaN(WidthNumberBox.Value) &amp;&amp; WidthNumberBox.Value &gt; 0)</div>
<div class="line">⋮----</div>
<div class="line">numbers.Add(WidthNumberBox.Value);</div>
<div class="line">⋮----</div>
<div class="line">if (!<span class="keywordtype">double</span>.IsNaN(HeightNumberBox.Value) &amp;&amp; HeightNumberBox.Value &gt; 0)</div>
<div class="line">⋮----</div>
<div class="line">numbers.Add(HeightNumberBox.Value);</div>
<div class="line">⋮----</div>
<div class="line">if (!<span class="keywordtype">double</span>.IsNaN(DepthNumberBox.Value) &amp;&amp; DepthNumberBox.Value &gt; 0)</div>
<div class="line">⋮----</div>
<div class="line">numbers.Add(DepthNumberBox.Value);</div>
<div class="line">⋮----</div>
<div class="line">if (kvp.Value is NumberBox nb &amp;&amp; !<span class="keywordtype">double</span>.IsNaN(nb.Value) &amp;&amp; nb.Value &gt; 0)</div>
<div class="line">⋮----</div>
<div class="line">numbers.Add(nb.Value);</div>
<div class="line">⋮----</div>
<div class="line">var formattedNumbers = numbers.Select(n =&gt;</div>
<div class="line">n == Math.Floor(n) ? ((<span class="keywordtype">int</span>)n).ToString() : n.ToString(<span class="stringliteral">&quot;0.##&quot;</span>)</div>
<div class="line">⋮----</div>
<div class="line">parts.Add($<span class="stringliteral">&quot;({string.Join(&quot;</span>x<span class="stringliteral">&quot;, formattedNumbers)})&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// 4. Boolean specs (only if true, abbreviated if &gt;2 words)</span></div>
<div class="line">⋮----</div>
<div class="line">var words = specName.Split(new[] { <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;_&#39;</span> }, System.StringSplitOptions.RemoveEmptyEntries);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Abbreviate: use first letter of each word</span></div>
<div class="line">boolSpecs.Add(<span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot;&quot;</span>, words.Select(w =&gt; <span class="keywordtype">char</span>.ToUpper(w[0]))));</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Use full name</span></div>
<div class="line">boolSpecs.Add(specName);</div>
<div class="line">⋮----</div>
<div class="line">parts.Add(<span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot;, &quot;</span>, boolSpecs));</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Add text specs if any</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Insert text specs after type name</span></div>
<div class="line">parts.Insert(1, <span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot;, &quot;</span>, textSpecs));</div>
<div class="line">⋮----</div>
<div class="line">PartIdTextBox.Text = <span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot; - &quot;</span>, parts);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> OnPrimaryButtonClick(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Set Part ID</span></div>
<div class="line">PartId = PartIdTextBox.Text.Trim();</div>
<div class="line"><span class="comment">// Build spec values dictionary</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Add dynamic specs</span></div>
<div class="line">⋮----</div>
<div class="line">specValues[kvp.Key] = tb.Text.Trim();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">else</span> if (kvp.Value is NumberBox nb &amp;&amp; !<span class="keywordtype">double</span>.IsNaN(nb.Value))</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Add dimensions if provided</span></div>
<div class="line">⋮----</div>
<div class="line">if (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(NotesTextBox.Text))</div>
<div class="line">⋮----</div>
<div class="line">specValues[<span class="stringliteral">&quot;Notes&quot;</span>] = NotesTextBox.Text.Trim();</div>
<div class="line">⋮----</div>
<div class="line">SpecValuesJson = JsonSerializer.Serialize(specValues);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md280"></a>
File: Module_Dunnage/Views/View_Dunnage_TypeSelectionView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">UserControl</span> <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_dunnage_typeselectionView&quot;</span></div>
<div class="line">             <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;RootUserControl&quot;</span></div>
<div class="line">             <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">             <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">             <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">             <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">             <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.ViewModels&quot;</span></div>
<div class="line">             <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Models&quot;</span></div>
<div class="line">             <span class="keyword">xmlns:materialIcons</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">             <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">             <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">             <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_IconCodeToGlyph</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IconCodeToGlyphConverter&quot;</span> /&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">UserControl.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                    <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,32&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Select Dunnage Type&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTip(&#39;Dunnage.TypeSelection&#39;), Mode=OneWay}&quot;</span></div>
<div class="line">                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span> /&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- 3x3 Type Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">GridView</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                  <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.DisplayedTypes, Mode=OneWay}&quot;</span></div>
<div class="line">                  <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedType, Mode=TwoWay}&quot;</span></div>
<div class="line">                  <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;None&quot;</span></div>
<div class="line">                  <span class="keyword">IsItemClickEnabled</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                  <span class="keyword">ItemClick</span>=<span class="stringliteral">&quot;TypeCard_ItemClick&quot;</span></div>
<div class="line">                  <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;960&quot;</span></div>
<div class="line">                  <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">GridView.ItemsPanel</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ItemsPanelTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ItemsWrapGrid</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                                   <span class="keyword">MaximumRowsOrColumns</span>=<span class="stringliteral">&quot;3&quot;</span> /&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ItemsPanelTemplate</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">GridView.ItemsPanel</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">GridView.ItemTemplate</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_DunnageType&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Border</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span></div>
<div class="line">                            <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Border.ContextFlyout</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">MenuFlyout</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">MenuFlyoutItem</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Edit&quot;</span></div>
<div class="line">                                                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Edit&quot;</span></div>
<div class="line">                                                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{Binding ElementName=RootUserControl, Path=ViewModel.EditTypeCommand}&quot;</span></div>
<div class="line">                                                <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{x:Bind}&quot;</span> /&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">MenuFlyoutItem</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Delete&quot;</span></div>
<div class="line">                                                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Delete&quot;</span></div>
<div class="line">                                                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{Binding ElementName=RootUserControl, Path=ViewModel.DeleteTypeCommand}&quot;</span></div>
<div class="line">                                                <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{x:Bind}&quot;</span> /&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">MenuFlyout</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Border.ContextFlyout</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span> /&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Icon --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">materialIcons:MaterialIcon</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                                        <span class="keyword">Kind</span>=<span class="stringliteral">&quot;{x:Bind IconKind, Mode=OneWay}&quot;</span></div>
<div class="line">                                                        <span class="keyword">Width</span>=<span class="stringliteral">&quot;48&quot;</span></div>
<div class="line">                                                        <span class="keyword">Height</span>=<span class="stringliteral">&quot;48&quot;</span></div>
<div class="line">                                                        <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                                                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,12&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                            <span class="comment">&lt;!-- Type Name --&gt;</span></div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind TypeName}&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                                       <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> /&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">GridView.ItemTemplate</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">GridView</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Pagination Controls --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                    <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,32,0,0&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- First Page --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FirstPageCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.FirstPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE892;&quot;</span></div>
<div class="line">                          <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Previous Page --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PreviousPageCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.PreviousPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE76B;&quot;</span></div>
<div class="line">                          <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Page Info --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Border</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16,8&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span></div>
<div class="line">                    <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;120&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PageInfo, Mode=OneWay}&quot;</span></div>
<div class="line">                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                           <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Next Page --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NextPageCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.NextPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE76C;&quot;</span></div>
<div class="line">                          <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Last Page --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LastPageCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GetTooltip(&#39;Button.LastPage&#39;), Mode=OneWay}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE893;&quot;</span></div>
<div class="line">                          <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Quick Add Button --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.QuickAddTypeCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;32,0,0,0&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                            <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE710;&quot;</span></div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> /&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Quick Add Type&quot;</span> /&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">UserControl</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md281"></a>
File: Module_Dunnage/Views/View_Dunnage_TypeSelectionView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_dunnage_typeselectionView : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;dunnage_typeselectionView: OnLoaded called&quot;);</div>
<div class="line">await ViewModel.InitializeAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void TypeCard_ItemClick(object sender, ItemClickEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.SelectTypeCommand.ExecuteAsync(type);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md282"></a>
File: Module_Receiving/Contracts/IService_MySQL_PackagePreferences.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_MySQL_PackagePreferences</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_PackageTypePreference?&gt; GetPreferenceAsync(string partID);</div>
<div class="line"><span class="keyword">public</span> Task SavePreferenceAsync(Model_PackageTypePreference preference);</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; DeletePreferenceAsync(<span class="keywordtype">string</span> partID);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md283"></a>
File: Module_Receiving/Contracts/IService_MySQL_Receiving.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_MySQL_Receiving</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;int&gt; SaveReceivingLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads);</div>
<div class="line"><span class="keyword">public</span> Task&lt;List&lt;Model_ReceivingLoad&gt;&gt; GetReceivingHistoryAsync(<span class="keywordtype">string</span> partID, DateTime startDate, DateTime endDate);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_ReceivingLoad&gt;&gt;&gt; GetAllReceivingLoadsAsync(DateTime startDate, DateTime endDate);</div>
<div class="line"><span class="keyword">public</span> Task&lt;int&gt; UpdateReceivingLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads);</div>
<div class="line"><span class="keyword">public</span> Task&lt;int&gt; DeleteReceivingLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads);</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; TestConnectionAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md284"></a>
File: Module_Receiving/Contracts/IService_MySQL_ReceivingLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_MySQL_ReceivingLine</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&gt; InsertReceivingLineAsync(Model_ReceivingLine line);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md285"></a>
File: Module_Receiving/Contracts/IService_ReceivingValidation.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_ReceivingValidation</div>
<div class="line">⋮----</div>
<div class="line">public Model_ReceivingValidationResult ValidatePONumber(string poNumber);</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidatePartID(<span class="keywordtype">string</span> partID);</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidateNumberOfLoads(<span class="keywordtype">int</span> numLoads);</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidateWeightQuantity(decimal weightQuantity);</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidatePackageCount(<span class="keywordtype">int</span> packagesPerLoad);</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidateHeatLotNumber(<span class="keywordtype">string</span> heatLotNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_ReceivingValidationResult&gt; ValidateAgainstPOQuantityAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_ReceivingValidationResult&gt; CheckSameDayReceivingAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidateReceivingLoad(Model_ReceivingLoad load);</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidateSession(List&lt;Model_ReceivingLoad&gt; loads);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_ReceivingValidationResult&gt; ValidatePartExistsInVisualAsync(<span class="keywordtype">string</span> partID);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md286"></a>
File: Module_Receiving/Contracts/IService_ReceivingWorkflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_ReceivingWorkflow</div>
<div class="line">⋮----</div>
<div class="line">public void RaiseStatusMessage(string message);</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">event</span> EventHandler StepChanged;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; StartWorkflowAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_ReceivingWorkflowStepResult&gt; AdvanceToNextStepAsync();</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingWorkflowStepResult GoToPreviousStep();</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingWorkflowStepResult GoToStep(Enum_ReceivingWorkflowStep step);</div>
<div class="line"><span class="keyword">public</span> Task AddCurrentPartToSessionAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_SaveResult&gt; SaveSessionAsync(IProgress&lt;string&gt;? messageProgress = <span class="keyword">null</span>, IProgress&lt;int&gt;? percentProgress = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ClearUIInputs();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_SaveResult&gt; SaveToCSVOnlyAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_SaveResult&gt; SaveToDatabaseOnlyAsync();</div>
<div class="line"><span class="keyword">public</span> Task ResetWorkflowAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_CSVDeleteResult&gt; ResetCSVFilesAsync();</div>
<div class="line"><span class="keyword">public</span> Task PersistSessionAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md287"></a>
File: Module_Receiving/Data/Dao_PackageTypePreference.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_PackageTypePreference</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_UserPreference&gt;&gt; GetByUserAsync(<span class="keywordtype">string</span> username)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; <span class="keyword">new</span> Model_UserPreference</div>
<div class="line">⋮----</div>
<div class="line">Username = reader[<span class="stringliteral">&quot;username&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PreferredPackageType = reader[<span class="stringliteral">&quot;preferred_package_type&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">Workstation = reader[<span class="stringliteral">&quot;workstation&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">LastUpdated = Convert.ToDateTime(reader[<span class="stringliteral">&quot;last_modified&quot;</span>])</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpsertAsync(Model_UserPreference preference)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_PackageTypePreference?&gt;&gt; GetPreferenceAsync(<span class="keywordtype">string</span> partID)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; <span class="keyword">new</span> Model_PackageTypePreference</div>
<div class="line">⋮----</div>
<div class="line">PreferenceID = Convert.ToInt32(reader[<span class="stringliteral">&quot;PreferenceID&quot;</span>]),</div>
<div class="line">PartID = reader[<span class="stringliteral">&quot;PartID&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PackageTypeName = reader[<span class="stringliteral">&quot;PackageTypeName&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">CustomTypeName = reader[<span class="stringliteral">&quot;CustomTypeName&quot;</span>] == DBNull.Value ? <span class="keyword">null</span> : reader[<span class="stringliteral">&quot;CustomTypeName&quot;</span>].ToString(),</div>
<div class="line">LastModified = Convert.ToDateTime(reader[<span class="stringliteral">&quot;LastModified&quot;</span>])</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(result.Data);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; SavePreferenceAsync(Model_PackageTypePreference preference)</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure(result.ErrorMessage);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; DeletePreferenceAsync(<span class="keywordtype">string</span> partID)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(<span class="keyword">true</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md288"></a>
File: Module_Receiving/Data/Dao_ReceivingLoad.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_ReceivingLoad</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">string</span>? CleanPONumber(<span class="keywordtype">string</span>? poNumber)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(poNumber))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> poNumber.Replace(<span class="stringliteral">&quot;PO-&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, StringComparison.OrdinalIgnoreCase).Trim();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; SaveLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using </span>var connection = <span class="keyword">new</span> MySqlConnection(_connectionString);</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">await <span class="keyword">using </span>var transaction = await connection.BeginTransactionAsync();</div>
<div class="line">⋮----</div>
<div class="line">{ <span class="stringliteral">&quot;LoadID&quot;</span>, load.LoadID.ToString() },</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteInTransactionAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(result.ErrorMessage, result.Exception);</div>
<div class="line">⋮----</div>
<div class="line">await transaction.CommitAsync();</div>
<div class="line">⋮----</div>
<div class="line">await transaction.RollbackAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; UpdateLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; DeleteLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line">{ <span class="stringliteral">&quot;p_LoadID&quot;</span>, load.LoadID.ToString() }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReceivingLoad&gt;&gt;&gt; GetHistoryAsync(<span class="keywordtype">string</span> partID, DateTime startDate, DateTime endDate)</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteDataTableAsync(</div>
<div class="line">⋮----</div>
<div class="line">loads.Add(MapRowToLoad(row));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(loads);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReceivingLoad&gt;&gt;&gt; GetAllAsync(DateTime startDate, DateTime endDate)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_ReceivingLoad MapRowToLoad(DataRow row)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_ReceivingLoad</div>
<div class="line">⋮----</div>
<div class="line">LoadID = Guid.Parse(row[<span class="stringliteral">&quot;LoadID&quot;</span>]?.ToString() ?? Guid.Empty.ToString()),</div>
<div class="line">⋮----</div>
<div class="line">PoNumber = row[<span class="stringliteral">&quot;PONumber&quot;</span>] == DBNull.Value ? null : row[<span class="stringliteral">&quot;PONumber&quot;</span>].ToString(),</div>
<div class="line">⋮----</div>
<div class="line">LoadNumber = Convert.ToInt32(row[<span class="stringliteral">&quot;LoadNumber&quot;</span>]),</div>
<div class="line">WeightQuantity = Convert.ToDecimal(row[<span class="stringliteral">&quot;WeightQuantity&quot;</span>]),</div>
<div class="line">⋮----</div>
<div class="line">PackagesPerLoad = Convert.ToInt32(row[<span class="stringliteral">&quot;PackagesPerLoad&quot;</span>]),</div>
<div class="line">⋮----</div>
<div class="line">WeightPerPackage = Convert.ToDecimal(row[<span class="stringliteral">&quot;WeightPerPackage&quot;</span>]),</div>
<div class="line">IsNonPOItem = Convert.ToBoolean(row[<span class="stringliteral">&quot;IsNonPOItem&quot;</span>]),</div>
<div class="line">ReceivedDate = Convert.ToDateTime(row[<span class="stringliteral">&quot;ReceivedDate&quot;</span>])</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md289"></a>
File: Module_Receiving/Models/Model_ReceivingLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingLine</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md290"></a>
File: Module_Receiving/Models/Model_ReceivingLoad.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_ReceivingLoad : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Guid _loadID = Guid.NewGuid();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Enum_PackageType _packageType = Enum_PackageType.Skid;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _receivedDate = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line">partial void OnPartIDChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(value))</div>
<div class="line">⋮----</div>
<div class="line">var upperValue = value.ToUpperInvariant();</div>
<div class="line">if (upperValue.Contains(&quot;MMC&quot;))</div>
<div class="line">⋮----</div>
<div class="line">else if (upperValue.Contains(&quot;MMF&quot;))</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[Model_ReceivingLoad] OnPartIDChanged error: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnPackageTypeChanged(Enum_PackageType value)</div>
<div class="line">⋮----</div>
<div class="line">PackageTypeName = value.ToString();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnPackageTypeNameChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnWeightQuantityChanged(decimal value)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnPackagesPerLoadChanged(int value)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void CalculateWeightPerPackage()</div>
<div class="line">⋮----</div>
<div class="line">WeightPerPackage = Math.Round(WeightQuantity / PackagesPerLoad, 0);</div>
<div class="line">⋮----</div>
<div class="line">string.IsNullOrEmpty(PoNumber) ? &quot;N/A&quot; : PoNumber;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md291"></a>
File: Module_Receiving/Models/Model_ReceivingSession.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingSession</div>
<div class="line">⋮----</div>
<div class="line">public Guid SessionID { <span class="keyword">get</span>; <span class="keyword">set</span>; } = Guid.NewGuid();</div>
<div class="line">⋮----</div>
<div class="line">Loads?.Select(l =&gt; l.PartID).Distinct().ToList() ?? <span class="keyword">new</span> List&lt;string&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md292"></a>
File: Module_Receiving/Models/Model_ReceivingValidationResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingValidationResult</div>
<div class="line">⋮----</div>
<div class="line">public static Model_ReceivingValidationResult Success() =&gt; <span class="keyword">new</span>() { IsValid = <span class="keyword">true</span> };</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Model_ReceivingValidationResult Error(<span class="keywordtype">string</span> message) =&gt; <span class="keyword">new</span>()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Model_ReceivingValidationResult Warning(<span class="keywordtype">string</span> message) =&gt; <span class="keyword">new</span>()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md293"></a>
File: Module_Receiving/Models/Model_ReceivingWorkflowStepResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingWorkflowStepResult</div>
<div class="line">⋮----</div>
<div class="line">public static Model_ReceivingWorkflowStepResult SuccessResult(Enum_ReceivingWorkflowStep newStep, string message = <span class="stringliteral">&quot;&quot;</span>) =&gt; <span class="keyword">new</span>()</div>
<div class="line">⋮----</div>
<div class="line">public static Model_ReceivingWorkflowStepResult ErrorResult(List&lt;<span class="keywordtype">string</span>&gt; errors) =&gt; new()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md294"></a>
File: Module_Receiving/Services/Service_CSVWriter.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_CSVWriter : IService_CSVWriter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_sessionManager = sessionManager ?? throw new ArgumentNullException(nameof(sessionManager));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">var appDataPath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);</div>
<div class="line">var appDir = Path.Combine(appDataPath, &quot;MTM_Receiving_Application&quot;);</div>
<div class="line">if (!Directory.Exists(appDir))</div>
<div class="line">⋮----</div>
<div class="line">Directory.CreateDirectory(appDir);</div>
<div class="line">⋮----</div>
<div class="line">_localCSVPath = Path.Combine(appDir, &quot;ReceivingData.csv&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> string GetNetworkCSVPathInternal()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Resolving network CSV path...&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var userDir = Path.Combine(networkBase, userName);</div>
<div class="line">_logger.LogInfo($&quot;Checking network directory: {userDir}&quot;);</div>
<div class="line">if (!Directory.Exists(userDir))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Creating network directory: {userDir}&quot;);</div>
<div class="line">Directory.CreateDirectory(userDir);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Failed to create network directory: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Path.Combine(userDir, &quot;ReceivingData.csv&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error resolving network path: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_CSVWriteResult&gt; WriteToCSVAsync(List&lt;Model_ReceivingLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Starting WriteToCSVAsync for {loads?.Count ?? 0} loads.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentException(&quot;Loads list cannot be null or empty&quot;, nameof(loads));</div>
<div class="line">⋮----</div>
<div class="line">var result = new Model_CSVWriteResult { RecordsWritten = loads.Count };</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($<span class="stringliteral">&quot;Writing to local CSV: {_localCSVPath}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(<span class="stringliteral">&quot;Local CSV write successful.&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($<span class="stringliteral">&quot;Local CSV write failed: {ex.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;Failed to write local CSV file&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(<span class="stringliteral">&quot;Attempting network CSV write...&quot;</span>);</div>
<div class="line">var networkPath = await Task.Run(() =&gt; GetNetworkCSVPathInternal());</div>
<div class="line">_logger.LogInfo($<span class="stringliteral">&quot;Network path resolved: {networkPath}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(<span class="stringliteral">&quot;Network CSV write successful.&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($<span class="stringliteral">&quot;Network CSV write failed: {ex.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task WriteToFileAsync(<span class="keywordtype">string</span> filePath, List&lt;Model_ReceivingLoad&gt; loads, <span class="keywordtype">bool</span> append = <span class="keyword">true</span>)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($<span class="stringliteral">&quot;WriteToFileAsync called for: {filePath}, Append: {append}&quot;</span>);</div>
<div class="line">await Task.Run(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">bool</span> isNewFile = !File.Exists(filePath) || !append;</div>
<div class="line">_logger.LogInfo($<span class="stringliteral">&quot;File exists check for {filePath}: {!isNewFile}&quot;</span>);</div>
<div class="line">var config = new CsvConfiguration(CultureInfo.InvariantCulture)</div>
<div class="line">⋮----</div>
<div class="line">await using var stream = new FileStream(filePath, fileMode, FileAccess.Write, FileShare.Read);</div>
<div class="line">await using var writer = new StreamWriter(stream);</div>
<div class="line">await using var csv = new CsvWriter(writer, config);</div>
<div class="line">⋮----</div>
<div class="line">csv.NextRecord();</div>
<div class="line">⋮----</div>
<div class="line">csv.WriteRecord(load);</div>
<div class="line">⋮----</div>
<div class="line">await writer.FlushAsync();</div>
<div class="line">_logger.LogInfo($<span class="stringliteral">&quot;Successfully wrote to {filePath}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($<span class="stringliteral">&quot;Error writing to file {filePath}: {ex.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;List&lt;Model_ReceivingLoad&gt;&gt; ReadFromCSVAsync(<span class="keywordtype">string</span> filePath)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($<span class="stringliteral">&quot;ReadFromCSVAsync called for: {filePath}&quot;</span>);</div>
<div class="line">return await Task.Run(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">if (!File.Exists(filePath))</div>
<div class="line">⋮----</div>
<div class="line">throw new FileNotFoundException($<span class="stringliteral">&quot;CSV file not found: {filePath}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">using var reader = new StreamReader(filePath);</div>
<div class="line">using var csv = new CsvReader(reader, config);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($<span class="stringliteral">&quot;Successfully read {loads.Count} records from {filePath}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($<span class="stringliteral">&quot;Error reading from file {filePath}: {ex.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_CSVDeleteResult&gt; ClearCSVFilesAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = new Model_CSVDeleteResult();</div>
<div class="line">if (File.Exists(_localCSVPath))</div>
<div class="line">⋮----</div>
<div class="line">await Task.Run(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">using var writer = new StreamWriter(_localCSVPath);</div>
<div class="line">using var csv = new CsvWriter(writer, CultureInfo.InvariantCulture);</div>
<div class="line">⋮----</div>
<div class="line">if (File.Exists(networkPath))</div>
<div class="line">⋮----</div>
<div class="line">using var writer = new StreamWriter(networkPath);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_CSVExistenceResult&gt; CheckCSVFilesExistAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = new Model_CSVExistenceResult();</div>
<div class="line">⋮----</div>
<div class="line">result.LocalExists = File.Exists(_localCSVPath);</div>
<div class="line">⋮----</div>
<div class="line">result.NetworkExists = File.Exists(networkPath);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">string</span> GetLocalCSVPath() =&gt; _localCSVPath;</div>
<div class="line">public <span class="keywordtype">string</span> GetNetworkCSVPath() =&gt; GetNetworkCSVPathInternal();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md295"></a>
File: Module_Receiving/Services/Service_MySQL_PackagePreferences.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_MySQL_PackagePreferences : IService_MySQL_PackagePreferences</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_PackageTypePreference _dao;</div>
<div class="line">⋮----</div>
<div class="line">_dao = dao ?? throw new ArgumentNullException(nameof(dao));</div>
<div class="line">⋮----</div>
<div class="line">_dao = new Dao_PackageTypePreference(connectionString);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_PackageTypePreference?&gt; GetPreferenceAsync(string partID)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(partID))</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentException(&quot;Part ID cannot be null or empty&quot;, nameof(partID));</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dao.GetPreferenceAsync(partID);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task SavePreferenceAsync(Model_PackageTypePreference preference)</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentNullException(nameof(preference));</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dao.SavePreferenceAsync(preference);</div>
<div class="line">⋮----</div>
<div class="line">throw new Exception(result.ErrorMessage);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; DeletePreferenceAsync(string partID)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dao.DeletePreferenceAsync(partID);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md296"></a>
File: Module_Receiving/Services/Service_MySQL_Receiving.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_MySQL_Receiving : IService_MySQL_Receiving</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_ReceivingLoad _receivingLoadDao;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">⋮----</div>
<div class="line">_receivingLoadDao = new Dao_ReceivingLoad(connectionString);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;int&gt; SaveReceivingLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Saving {loads.Count} loads to database.&quot;);</div>
<div class="line">var result = await _receivingLoadDao.SaveLoadsAsync(loads);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully saved {result.Data} loads.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to save loads: {result.ErrorMessage}&quot;, result.Exception);</div>
<div class="line">throw new InvalidOperationException(result.ErrorMessage, result.Exception);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;int&gt; UpdateReceivingLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Updating {loads.Count} loads in database.&quot;);</div>
<div class="line">var result = await _receivingLoadDao.UpdateLoadsAsync(loads);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully updated {result.Data} loads.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to update loads: {result.ErrorMessage}&quot;, result.Exception);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;int&gt; DeleteReceivingLoadsAsync(List&lt;Model_ReceivingLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Deleting {loads.Count} loads from database.&quot;);</div>
<div class="line">var result = await _receivingLoadDao.DeleteLoadsAsync(loads);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully deleted {result.Data} loads.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to delete loads: {result.ErrorMessage}&quot;, result.Exception);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;List&lt;Model_ReceivingLoad&gt;&gt; GetReceivingHistoryAsync(string partID, DateTime startDate, DateTime endDate)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _receivingLoadDao.GetHistoryAsync(partID, startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to get receiving history: {result.ErrorMessage}&quot;, result.Exception);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReceivingLoad&gt;&gt;&gt; GetAllReceivingLoadsAsync(DateTime startDate, DateTime endDate)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Retrieving all receiving loads from {startDate:yyyy-MM-dd} to {endDate:yyyy-MM-dd}&quot;);</div>
<div class="line">var result = await _receivingLoadDao.GetAllAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Retrieved {result.Data?.Count ?? 0} receiving loads from database&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to retrieve receiving loads: {result.ErrorMessage}&quot;, result.Exception);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; TestConnectionAsync()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md297"></a>
File: Module_Receiving/Services/Service_MySQL_ReceivingLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_MySQL_ReceivingLine : IService_MySQL_ReceivingLine</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_ReceivingLine _receivingLineDao;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertReceivingLineAsync(Model_ReceivingLine line)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _receivingLineDao.InsertReceivingLineAsync(line);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md298"></a>
File: Module_Receiving/Services/Service_ReceivingWorkflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_ReceivingWorkflow : IService_ReceivingWorkflow</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_SessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly IService_CSVWriter _csvWriter;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Receiving _mysqlReceiving;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingValidation _validation;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ViewModelRegistry _viewModelRegistry;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void RaiseStatusMessage(string message)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Enum_ReceivingWorkflowStep _currentStep = Enum_ReceivingWorkflowStep.ModeSelection;</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Changing step from {_currentStep} to {value}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Step changed to {value} (event fired)&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_sessionManager = sessionManager ?? throw new ArgumentNullException(nameof(sessionManager));</div>
<div class="line">_csvWriter = csvWriter ?? throw new ArgumentNullException(nameof(csvWriter));</div>
<div class="line">_mysqlReceiving = mysqlReceiving ?? throw new ArgumentNullException(nameof(mysqlReceiving));</div>
<div class="line">_validation = validation ?? throw new ArgumentNullException(nameof(validation));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">_viewModelRegistry = viewModelRegistry ?? throw new ArgumentNullException(nameof(viewModelRegistry));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; StartWorkflowAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Starting receiving workflow.&quot;);</div>
<div class="line">var existingSession = await _sessionManager.LoadSessionAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Restoring existing session.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">CurrentSession = new Model_ReceivingSession();</div>
<div class="line">⋮----</div>
<div class="line">if (currentUser != null &amp;&amp; !string.IsNullOrEmpty(currentUser.DefaultReceivingMode))</div>
<div class="line">⋮----</div>
<div class="line">switch (currentUser.DefaultReceivingMode.ToLower())</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Starting in Guided mode (default)&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Starting in Manual Entry mode (default)&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Starting in Edit mode (default)&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Invalid default mode, showing mode selection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;No default mode set, showing mode selection&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_ReceivingWorkflowStepResult&gt; AdvanceToNextStepAsync()</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingWorkflowStepResult.SuccessResult(CurrentStep);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrEmpty(CurrentPONumber) &amp;&amp; !IsNonPOItem)</div>
<div class="line">⋮----</div>
<div class="line">validationErrors.Add(&quot;PO Number is required.&quot;);</div>
<div class="line">return Model_ReceivingWorkflowStepResult.ErrorResult(validationErrors);</div>
<div class="line">⋮----</div>
<div class="line">validationErrors.Add(&quot;Part selection is required.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">validationErrors.Add(&quot;Number of loads must be at least 1.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = _validation.ValidateWeightQuantity(load.WeightQuantity);</div>
<div class="line">⋮----</div>
<div class="line">validationErrors.Add($&quot;Load {load.LoadNumber}: {result.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = _validation.ValidateHeatLotNumber(load.HeatLotNumber);</div>
<div class="line">⋮----</div>
<div class="line">var result = _validation.ValidatePackageCount(load.PackagesPerLoad);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.PackageTypeName))</div>
<div class="line">⋮----</div>
<div class="line">validationErrors.Add($&quot;Load {load.LoadNumber}: Package Type is required.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Transitioning from Review to Saving...&quot;);</div>
<div class="line">⋮----</div>
<div class="line">validationErrors.Add($&quot;Cannot advance from step {CurrentStep}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Persisting session...&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Session persisted.&quot;);</div>
<div class="line">return Model_ReceivingWorkflowStepResult.SuccessResult(CurrentStep, $&quot;Advanced to {CurrentStep}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void GenerateLoads()</div>
<div class="line">⋮----</div>
<div class="line">CurrentSession.Loads.Remove(load);</div>
<div class="line">⋮----</div>
<div class="line">_currentBatchLoads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">var load = new Model_ReceivingLoad</div>
<div class="line">⋮----</div>
<div class="line">CurrentSession.Loads.Add(load);</div>
<div class="line">_currentBatchLoads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingWorkflowStepResult GoToPreviousStep()</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingWorkflowStepResult.ErrorResult(new List&lt;string&gt; { $&quot;Cannot go back from step {CurrentStep}&quot; });</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingWorkflowStepResult.SuccessResult(CurrentStep, $&quot;Returned to {CurrentStep}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingWorkflowStepResult GoToStep(Enum_ReceivingWorkflowStep step)</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingWorkflowStepResult.SuccessResult(CurrentStep, $&quot;Navigated to {CurrentStep}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task AddCurrentPartToSessionAsync()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ClearUIInputs()</div>
<div class="line">⋮----</div>
<div class="line">_viewModelRegistry.ClearAllInputs();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_SaveResult&gt; SaveToCSVOnlyAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = new Model_SaveResult();</div>
<div class="line">var validation = _validation.ValidateSession(CurrentSession.Loads);</div>
<div class="line">⋮----</div>
<div class="line">var csvResult = await _csvWriter.WriteToCSVAsync(CurrentSession.Loads);</div>
<div class="line">⋮----</div>
<div class="line">result.LocalCSVPath = _csvWriter.GetLocalCSVPath();</div>
<div class="line">result.NetworkCSVPath = _csvWriter.GetNetworkCSVPath();</div>
<div class="line">⋮----</div>
<div class="line">result.Errors.Add($&quot;Local CSV write failed: {csvResult.LocalError}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">result.Warnings.Add($&quot;Network CSV write failed: {csvResult.NetworkError}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">result.Errors.Add($&quot;CSV save failed: {ex.Message}&quot;);</div>
<div class="line">_logger.LogError(&quot;CSV save failed&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_SaveResult&gt; SaveToDatabaseOnlyAsync()</div>
<div class="line">⋮----</div>
<div class="line">int savedCount = await _mysqlReceiving.SaveReceivingLoadsAsync(CurrentSession.Loads);</div>
<div class="line">⋮----</div>
<div class="line">result.Errors.Add($&quot;Database save failed: {ex.Message}&quot;);</div>
<div class="line">_logger.LogError(&quot;Database save failed&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_SaveResult&gt; SaveSessionAsync(IProgress&lt;string&gt;? messageProgress = null, IProgress&lt;int&gt;? percentProgress = null)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Starting session save.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Validating session before save...&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Session validation failed: {string.Join(&quot;, &quot;, validation.Errors)}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Reporting progress: Saving to local CSV...&quot;);</div>
<div class="line">⋮----</div>
<div class="line">result.Errors.AddRange(csvResult.Errors);</div>
<div class="line">result.Warnings.AddRange(csvResult.Warnings);</div>
<div class="line">_logger.LogInfo(&quot;Reporting progress: Saving to database...&quot;);</div>
<div class="line">⋮----</div>
<div class="line">result.Errors.AddRange(dbResult.Errors);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Reporting progress: Finalizing...&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Save completed successfully. Clearing session.&quot;);</div>
<div class="line">await _sessionManager.ClearSessionAsync();</div>
<div class="line">CurrentSession.Loads.Clear();</div>
<div class="line">await _csvWriter.ClearCSVFilesAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Save completed with errors. Success: {result.Success}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Unexpected error during save session&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">result.Errors.Add($&quot;Unexpected error: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task ResetWorkflowAsync()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_CSVDeleteResult&gt; ResetCSVFilesAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Resetting CSV files requested.&quot;);</div>
<div class="line">return await _csvWriter.ClearCSVFilesAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task PersistSessionAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _sessionManager.SaveSessionAsync(CurrentSession);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md299"></a>
File: Module_Receiving/Services/Service_SessionManager.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_SessionManager : IService_SessionManager</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">var appDataPath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);</div>
<div class="line">var appFolder = Path.Combine(appDataPath, &quot;MTM_Receiving_Application&quot;);</div>
<div class="line">if (!Directory.Exists(appFolder))</div>
<div class="line">⋮----</div>
<div class="line">Directory.CreateDirectory(appFolder);</div>
<div class="line">⋮----</div>
<div class="line">_sessionPath = Path.Combine(appFolder, &quot;session.json&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task SaveSessionAsync(Model_ReceivingSession session)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;SaveSessionAsync started.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentNullException(nameof(session));</div>
<div class="line">⋮----</div>
<div class="line">var options = new JsonSerializerOptions</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Serializing session...&quot;);</div>
<div class="line">var json = JsonSerializer.Serialize(session, options);</div>
<div class="line">_logger.LogInfo($&quot;Writing session to file: {_sessionPath}&quot;);</div>
<div class="line">await File.WriteAllTextAsync(_sessionPath, json);</div>
<div class="line">_logger.LogInfo(&quot;Session saved successfully.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to save session to file: {ex.Message}&quot;, ex);</div>
<div class="line">throw new InvalidOperationException(&quot;Failed to save session to file&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_ReceivingSession?&gt; LoadSessionAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (!File.Exists(_sessionPath))</div>
<div class="line">⋮----</div>
<div class="line">var json = await File.ReadAllTextAsync(_sessionPath);</div>
<div class="line">⋮----</div>
<div class="line">File.Delete(_sessionPath);</div>
<div class="line">⋮----</div>
<div class="line">throw new InvalidOperationException(&quot;Failed to load session from file&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; ClearSessionAsync()</div>
<div class="line">⋮----</div>
<div class="line">await Task.Run(() =&gt; File.Delete(_sessionPath));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool SessionExists()</div>
<div class="line">⋮----</div>
<div class="line">return File.Exists(_sessionPath);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetSessionFilePath()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md300"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_EditMode.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_EditMode : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Receiving _mysqlService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_CSVWriter _csvWriter;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Pagination _paginationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Enum_DataSourceType _currentDataSource = Enum_DataSourceType.Memory;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTimeOffset _filterStartDate = DateTimeOffset.Now.AddDays(-7);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTimeOffset _filterEndDate = DateTimeOffset.Now;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> string _thisMonthButtonText = DateTime.Now.ToString(&quot;MMMM&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Edit Mode initialized&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> static string GetQuarterText(DateTime date)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnPageChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdatePagedDisplay()</div>
<div class="line">⋮----</div>
<div class="line">Loads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Loads.Add(item);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NotifyPaginationCommands()</div>
<div class="line">⋮----</div>
<div class="line">NextPageCommand.NotifyCanExecuteChanged();</div>
<div class="line">PreviousPageCommand.NotifyCanExecuteChanged();</div>
<div class="line">FirstPageCommand.NotifyCanExecuteChanged();</div>
<div class="line">LastPageCommand.NotifyCanExecuteChanged();</div>
<div class="line">GoToPageCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void Loads_CollectionChanged(object? sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void Load_PropertyChanged(object? sender, System.ComponentModel.PropertyChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">RemoveRowCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NotifyCommands()</div>
<div class="line">⋮----</div>
<div class="line">SaveCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">SelectAllCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnFilterStartDateChanged(DateTimeOffset value) =&gt; ApplyDateFilter();</div>
<div class="line">partial void OnFilterEndDateChanged(DateTimeOffset value) =&gt; ApplyDateFilter();</div>
<div class="line"><span class="keyword">private</span> void ApplyDateFilter()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void FilterAndPaginate()</div>
<div class="line">⋮----</div>
<div class="line">var end = FilterEndDate.Date.AddDays(1).AddTicks(-1);</div>
<div class="line">⋮----</div>
<div class="line">_filteredLoads = _allLoads.Where(l =&gt; l.ReceivedDate &gt;= start &amp;&amp; l.ReceivedDate &lt;= end).ToList();</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.SetSource(_filteredLoads);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetFilterLastWeekAsync()</div>
<div class="line">⋮----</div>
<div class="line">FilterStartDate = DateTime.Today.AddDays(-7);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetFilterTodayAsync()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetFilterThisWeekAsync()</div>
<div class="line">⋮----</div>
<div class="line">var start = today.AddDays(-(int)today.DayOfWeek);</div>
<div class="line">var end = start.AddDays(6);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetFilterThisMonthAsync()</div>
<div class="line">⋮----</div>
<div class="line">FilterStartDate = new DateTime(today.Year, today.Month, 1);</div>
<div class="line">FilterEndDate = FilterStartDate.AddMonths(1).AddDays(-1);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetFilterThisQuarterAsync()</div>
<div class="line">⋮----</div>
<div class="line">FilterStartDate = new DateTime(today.Year, 3 * quarter - 2, 1);</div>
<div class="line">FilterEndDate = FilterStartDate.AddMonths(3).AddDays(-1);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetFilterShowAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">FilterStartDate = DateTime.Today.AddYears(-1);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void PreviousPage() =&gt; _paginationService.PreviousPage();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NextPage() =&gt; _paginationService.NextPage();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void FirstPage() =&gt; _paginationService.FirstPage();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void LastPage() =&gt; _paginationService.LastPage();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void GoToPage() =&gt; _paginationService.GoToPage(GotoPageNumber);</div>
<div class="line"><span class="keyword">private</span> bool CanGoNext() =&gt; _paginationService.HasNextPage;</div>
<div class="line"><span class="keyword">private</span> bool CanGoPrevious() =&gt; _paginationService.HasPreviousPage;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadFromCurrentMemoryAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Loading data from current memory&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_deletedLoads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_allLoads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">_allLoads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully loaded {_allLoads.Count} loads from current memory&quot;);</div>
<div class="line">⋮----</div>
<div class="line">FilterStartDate = DateTimeOffset.Now.AddYears(-1);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to load from current memory: {ex.Message}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to load data from current session&quot;, Enum_ErrorSeverity.Error, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task LoadFromCurrentLabelsAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User initiated Current Labels (CSV) load&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowErrorDialogAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to load from labels: {ex.Message}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to load data from label file&quot;, Enum_ErrorSeverity.Error, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task&lt;bool&gt; TryLoadFromDefaultCsvAsync()</div>
<div class="line">⋮----</div>
<div class="line">string localPath = _csvWriter.GetLocalCSVPath();</div>
<div class="line">if (File.Exists(localPath))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Attempting to load from local CSV: {localPath}&quot;);</div>
<div class="line">var loadedData = await _csvWriter.ReadFromCSVAsync(localPath);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.CurrentSession.Loads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully loaded {_allLoads.Count} loads from local labels&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Failed to load from local labels: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">string networkPath = _csvWriter.GetNetworkCSVPath();</div>
<div class="line">if (File.Exists(networkPath))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Attempting to load from network labels: {networkPath}&quot;);</div>
<div class="line">var loadedData = await _csvWriter.ReadFromCSVAsync(networkPath);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully loaded {_allLoads.Count} loads from network labels&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Failed to load from network labels: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task LoadFromHistoryAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User initiated history load&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loading receiving history from {startDate:yyyy-MM-dd} to {endDate:yyyy-MM-dd}&quot;);</div>
<div class="line">var result = await _mysqlService.GetAllReceivingLoadsAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully loaded {_allLoads.Count} loads from history&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to load from history: {ex.Message}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to load data from history&quot;, Enum_ErrorSeverity.Error, ex);</div>
<div class="line">⋮----</div>
<div class="line">private void SelectAll()</div>
<div class="line">⋮----</div>
<div class="line">bool anyUnselected = Loads.Any(l =&gt; !l.IsSelected);</div>
<div class="line">⋮----</div>
<div class="line">private bool CanSelectAll() =&gt; Loads.Count &gt; 0;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void RemoveRow()</div>
<div class="line">⋮----</div>
<div class="line">var selectedLoads = Loads.Where(l =&gt; l.IsSelected).ToList();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Removing {selectedLoads.Count} selected loads&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_deletedLoads.Add(load);</div>
<div class="line">_workflowService.CurrentSession.Loads.Remove(load);</div>
<div class="line">_allLoads.Remove(load);</div>
<div class="line">_filteredLoads.Remove(load);</div>
<div class="line">Loads.Remove(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Removing load {SelectedLoad.LoadNumber} (Part ID: {SelectedLoad.PartID})&quot;);</div>
<div class="line">_deletedLoads.Add(SelectedLoad);</div>
<div class="line">_workflowService.CurrentSession.Loads.Remove(SelectedLoad);</div>
<div class="line">_allLoads.Remove(SelectedLoad);</div>
<div class="line">_filteredLoads.Remove(SelectedLoad);</div>
<div class="line">Loads.Remove(SelectedLoad);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;RemoveRow called with no selected load(s)&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool CanRemoveRow() =&gt; Loads.Any(l =&gt; l.IsSelected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SaveAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Validating and saving {_filteredLoads.Count} loads from edit mode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.HeatLotNumber))</div>
<div class="line">⋮----</div>
<div class="line">var errorMessage = string.Join(&quot;\n&quot;, validationErrors);</div>
<div class="line">_logger.LogWarning($&quot;Edit mode validation failed: {validationErrors.Count} errors&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _workflowService.AdvanceToNextStepAsync();</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrEmpty(_currentCsvPath))</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;No label file path available for saving.&quot;, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Overwriting label file: {_currentCsvPath}&quot;);</div>
<div class="line">await _csvWriter.WriteToFileAsync(_currentCsvPath, _allLoads, append: false);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowErrorDialogAsync(&quot;Success&quot;, &quot;Label file updated successfully.&quot;, Enum_ErrorSeverity.Info);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Updating history records&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Deleting {_deletedLoads.Count} removed records&quot;);</div>
<div class="line">deleted = await _mysqlService.DeleteReceivingLoadsAsync(_deletedLoads);</div>
<div class="line">⋮----</div>
<div class="line">updated = await _mysqlService.UpdateReceivingLoadsAsync(_filteredLoads);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowErrorDialogAsync(&quot;Success&quot;, $&quot;History updated successfully.\n{updated} records updated.\n{deleted} records deleted.&quot;, Enum_ErrorSeverity.Info);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Edit mode save completed successfully for source: {CurrentDataSource}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to save edit mode data: {ex.Message}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to save receiving data&quot;, Enum_ErrorSeverity.Critical, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool CanSave()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ReturnToModeSelectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Cannot show dialog: XamlRoot is null&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Unable to display dialog&quot;, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync().AsTask();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User confirmed return to mode selection, resetting workflow&quot;);</div>
<div class="line">await _workflowService.ResetWorkflowAsync();</div>
<div class="line">_workflowService.GoToStep(Enum_ReceivingWorkflowStep.ModeSelection);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to reset workflow: {ex.Message}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to return to mode selection&quot;, Enum_ErrorSeverity.Error, ex);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User cancelled return to mode selection&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> System.Collections.Generic.List&lt;string&gt; ValidateLoads(IEnumerable&lt;Model_ReceivingLoad&gt; loadsToValidate)</div>
<div class="line">⋮----</div>
<div class="line">if (!loadsToValidate.Any() &amp;&amp; _deletedLoads.Count == 0)</div>
<div class="line">⋮----</div>
<div class="line">errors.Add(&quot;No loads to save&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.PartID))</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Load #{load.LoadNumber}: Part ID is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Load #{load.LoadNumber}: Weight/Quantity must be greater than zero&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Load #{load.LoadNumber}: Packages per load must be greater than zero&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md301"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_ManualEntry.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_ManualEntry : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Receiving _mysqlService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task AutoFillAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Starting Auto-Fill Blank Spaces operation&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(currentLoad.PartID))</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrWhiteSpace(prev.PartID))</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrWhiteSpace(currentLoad.PartID))</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(currentLoad.PoNumber) &amp;&amp; !string.IsNullOrWhiteSpace(sourceLoad.PoNumber))</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(currentLoad.HeatLotNumber) &amp;&amp; !string.IsNullOrWhiteSpace(sourceLoad.HeatLotNumber))</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(currentLoad.PackageTypeName) &amp;&amp; !string.IsNullOrWhiteSpace(sourceLoad.PackageTypeName))</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(currentLoad.UserId))</div>
<div class="line">⋮----</div>
<div class="line">if (i &gt; 0 &amp;&amp; !string.IsNullOrWhiteSpace(Loads[i - 1].UserId))</div>
<div class="line">⋮----</div>
<div class="line">else if (Loads.Count &gt; 0 &amp;&amp; !string.IsNullOrWhiteSpace(Loads[0].UserId))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Auto-Fill Blank Spaces completed. Updated {filledCount} fields across {Loads.Count} rows.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Auto-fill failed: {ex.Message}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Auto-fill failed&quot;, Enum_ErrorSeverity.Error, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void AddRow()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task AddMultipleRowsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">if (int.TryParse(inputTextBox.Text, out int count) &amp;&amp; count &gt; 0 &amp;&amp; count &lt;= 50)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Adding {count} new rows to manual entry grid&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Invalid row count entered: {inputTextBox.Text}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Please enter a valid number between 1 and 50.&quot;, Enum_ErrorSeverity.Warning);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void AddNewLoad()</div>
<div class="line">⋮----</div>
<div class="line">var newLoad = new Model_ReceivingLoad</div>
<div class="line">⋮----</div>
<div class="line">LoadID = System.Guid.NewGuid(),</div>
<div class="line">⋮----</div>
<div class="line">Loads.Add(newLoad);</div>
<div class="line">_workflowService.CurrentSession.Loads.Add(newLoad);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void RemoveRow()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Removing load {SelectedLoad.LoadNumber} (Part ID: {SelectedLoad.PartID})&quot;);</div>
<div class="line">_workflowService.CurrentSession.Loads.Remove(SelectedLoad);</div>
<div class="line">Loads.Remove(SelectedLoad);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;RemoveRow called with no selected load&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SaveAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Saving {Loads.Count} loads from manual entry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.HeatLotNumber))</div>
<div class="line">⋮----</div>
<div class="line">await _workflowService.AdvanceToNextStepAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to save manual entry data: {ex.Message}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to save receiving data&quot;, Enum_ErrorSeverity.Critical, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ReturnToModeSelectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Cannot show dialog: XamlRoot is null&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Unable to display dialog&quot;, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync().AsTask();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User confirmed return to mode selection, resetting workflow&quot;);</div>
<div class="line">await _workflowService.ResetWorkflowAsync();</div>
<div class="line">_workflowService.GoToStep(Enum_ReceivingWorkflowStep.ModeSelection);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to reset workflow: {ex.Message}&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to return to mode selection&quot;, Enum_ErrorSeverity.Error, ex);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User cancelled return to mode selection&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.ManualEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md302"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_PackageType.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_PackageType : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_PackagePreferences _preferencesService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingValidation _validationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnStepChanged(object? sender, System.EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task OnNavigatedToAsync()</div>
<div class="line">⋮----</div>
<div class="line">Loads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Loads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadPreferencesAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrEmpty(partId))</div>
<div class="line">⋮----</div>
<div class="line">var preference = await _preferencesService.GetPreferenceAsync(partId);</div>
<div class="line">⋮----</div>
<div class="line">if (PackageTypes.Contains(preference.PackageTypeName))</div>
<div class="line">⋮----</div>
<div class="line">if (partID.StartsWith(&quot;MMC&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">else if (partID.StartsWith(&quot;MMF&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedPackageTypeChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">SavePreferenceAsync().ConfigureAwait(false);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnCustomPackageTypeNameChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnIsSaveAsDefaultChanged(bool value)</div>
<div class="line">⋮----</div>
<div class="line">DeletePreferenceAsync().ConfigureAwait(false);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdateLoadsPackageType()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SavePreferenceAsync()</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.RaiseStatusMessage(&quot;Part ID too long (max 50 chars).&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(typeName))</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.RaiseStatusMessage(&quot;Please enter a package type name.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.RaiseStatusMessage(&quot;Package type name too long (max 50 chars).&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (!_regex.IsMatch(typeName))</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.RaiseStatusMessage(&quot;Invalid characters in package type name.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var preference = new Model_PackageTypePreference</div>
<div class="line">⋮----</div>
<div class="line">await _preferencesService.SavePreferenceAsync(preference);</div>
<div class="line">_workflowService.RaiseStatusMessage(&quot;Preference saved.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(msg, Enum_ErrorSeverity.Warning, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task DeletePreferenceAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _preferencesService.DeletePreferenceAsync(partId);</div>
<div class="line">_workflowService.RaiseStatusMessage(&quot;Preference deleted.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to delete preference&quot;, Enum_ErrorSeverity.Warning, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.PackageType&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md303"></a>
File: Module_Receiving/Views/View_Receiving_ManualEntry.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_ManualEntry : UserControl</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this, AddRowButton);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void Loads_CollectionChanged(object? sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[ManualEntryView] Loads_CollectionChanged: New row added&quot;);</div>
<div class="line">ManualEntryDataGrid.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[ManualEntryView] Loads_CollectionChanged: Selecting new item LoadNumber={newItem.LoadNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">ManualEntryDataGrid.ScrollIntoView(newItem, ManualEntryDataGrid.Columns.FirstOrDefault());</div>
<div class="line">_ = Task.Run(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line">await Task.Delay(100);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ManualEntryDataGrid_CurrentCellChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">grid?.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[ManualEntryView] CurrentCellChanged: BeginEdit for Row={grid.SelectedIndex}, Col={grid.CurrentColumn.Header}&quot;);</div>
<div class="line">grid.BeginEdit();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ManualEntryDataGrid_KeyDown(object sender, KeyRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var shiftState = InputKeyboardSource.GetKeyStateForCurrentThread(VirtualKey.Shift);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[ManualEntryView] KeyDown: Key={e.Key}, Shift={isShiftDown}, OriginalSource={e.OriginalSource}, CurrentColumn={grid.CurrentColumn?.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ManualEntryDataGrid_Tapped(object sender, TappedRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[ManualEntryView] Tapped: OriginalSource={e.OriginalSource}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[ManualEntryView] Tapped: Grid empty, triggering AddRow command.&quot;);</div>
<div class="line">if (ViewModel.AddRowCommand.CanExecute(null))</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.AddRowCommand.Execute(null);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[ManualEntryView] Tapped: SelectedItem is null (Header or empty space). Selecting first editable cell.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[ManualEntryView] Tapped: Cell clicked. Enqueuing BeginEdit.&quot;);</div>
<div class="line">grid.DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[ManualEntryView] Tapped: BeginEdit for Row={grid.SelectedIndex}, Col={grid.CurrentColumn.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SelectFirstEditableCell(DataGrid grid)</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[ManualEntryView] SelectFirstEditableCell: Starting&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var firstEditable = grid.Columns.OrderBy(c =&gt; c.DisplayIndex).FirstOrDefault(c =&gt; !c.IsReadOnly);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[ManualEntryView] SelectFirstEditableCell: Found editable column {firstEditable.Header}. Setting CurrentColumn and calling BeginEdit.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">grid.Focus(Microsoft.UI.Xaml.FocusState.Programmatic);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[ManualEntryView] SelectFirstEditableCell: BeginEdit called for column {firstEditable.Header}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine(&quot;[ManualEntryView] SelectFirstEditableCell: No editable column found.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Debug.WriteLine($&quot;[ManualEntryView] SelectFirstEditableCell: Grid has no items (Count={itemCount})&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md304"></a>
File: Module_Reporting/Contracts/IService_Reporting.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Reporting</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetReceivingHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetDunnageHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetRoutingHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetVolvoHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;Dictionary&lt;string, int&gt;&gt;&gt; CheckAvailabilityAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;string&gt;&gt; ExportToCSVAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;string&gt;&gt; FormatForEmailAsync(</div>
<div class="line">⋮----</div>
<div class="line">public string NormalizePONumber(string? poNumber);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md305"></a>
File: Module_Routing/Constants/Constant_Routing.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Constant_Routing</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md306"></a>
File: Module_Routing/Constants/Constant_RoutingConfiguration.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Constant_RoutingConfiguration</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md307"></a>
File: Module_Routing/Data/Dao_RoutingRecipient.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_RoutingRecipient</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetAllActiveRecipientsAsync()</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetTopRecipientsByUsageAsync(<span class="keywordtype">int</span> employeeNumber, <span class="keywordtype">int</span> topCount = 5)</div>
<div class="line">⋮----</div>
<div class="line">private Model_RoutingRecipient MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_RoutingRecipient</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">Name = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;name&quot;</span>)),</div>
<div class="line">Location = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;location&quot;</span>)),</div>
<div class="line">Department = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;department&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;department&quot;</span>)),</div>
<div class="line">IsActive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_active&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">UpdatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;updated_date&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">private Model_RoutingRecipient MapFromReaderWithUsage(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">recipient.UsageCount = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;usage_count&quot;</span>));</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md308"></a>
File: Module_Routing/Enums/Enum_Routing_WorkflowStep.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md309"></a>
File: Module_Routing/Interfaces/IDao_RoutingLabel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IDao_RoutingLabel</div>
<div class="line">⋮----</div>
<div class="line">Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertLabelAsync(Model_RoutingLabel label);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; UpdateLabelAsync(Model_RoutingLabel label);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;Model_RoutingLabel&gt;&gt; GetLabelByIdAsync(<span class="keywordtype">int</span> labelId);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingLabel&gt;&gt;&gt; GetAllLabelsAsync(<span class="keywordtype">int</span> limit = 100, <span class="keywordtype">int</span> offset = 0);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; DeleteLabelAsync(<span class="keywordtype">int</span> labelId);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; MarkLabelExportedAsync(<span class="keywordtype">int</span> labelId);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;Model_RoutingLabel&gt;&gt; CheckDuplicateLabelAsync(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> lineNumber, <span class="keywordtype">int</span> recipientId, <span class="keywordtype">int</span> hoursWindow = 24);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;(<span class="keywordtype">bool</span> Exists, <span class="keywordtype">int</span>? ExistingLabelId)&gt;&gt; CheckDuplicateAsync(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> lineNumber, <span class="keywordtype">int</span> recipientId, DateTime createdWithinDate);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; MarkExportedAsync(List&lt;int&gt; labelIds);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md310"></a>
File: Module_Routing/Interfaces/IDao_RoutingLabelHistory.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IDao_RoutingLabelHistory</div>
<div class="line">⋮----</div>
<div class="line">Task&lt;Model_Dao_Result&gt; InsertHistoryAsync(Model_RoutingLabelHistory history);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; InsertHistoryBatchAsync(List&lt;Model_RoutingLabelHistory&gt; historyEntries);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingLabelHistory&gt;&gt;&gt; GetHistoryByLabelAsync(<span class="keywordtype">int</span> labelId);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md311"></a>
File: Module_Routing/Interfaces/IDao_RoutingRecipient.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IDao_RoutingRecipient</div>
<div class="line">⋮----</div>
<div class="line">Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetAllActiveRecipientsAsync();</div>
<div class="line">Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetTopRecipientsByUsageAsync(<span class="keywordtype">int</span> employeeNumber, <span class="keywordtype">int</span> topCount = 5);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md312"></a>
File: Module_Routing/Interfaces/IDao_RoutingUsageTracking.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IDao_RoutingUsageTracking</div>
<div class="line">⋮----</div>
<div class="line">Task&lt;Model_Dao_Result&gt; IncrementUsageAsync(int employeeNumber, int recipientId);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md313"></a>
File: Module_Routing/Models/Model_RoutingLabelHistory.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_RoutingLabelHistory</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md314"></a>
File: Module_Routing/Models/Model_RoutingOtherReason.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_RoutingOtherReason</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md315"></a>
File: Module_Routing/Models/Model_RoutingRecipient.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_RoutingRecipient</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md316"></a>
File: Module_Routing/Models/Model_RoutingUsageTracking.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_RoutingUsageTracking</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md317"></a>
File: Module_Routing/Models/Model_RoutingUserPreference.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_RoutingUserPreference</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md318"></a>
File: Module_Routing/Services/IRoutingInforVisualService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IRoutingInforVisualService</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;bool&gt;&gt; ValidatePoNumberAsync(string poNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_InforVisualPOLine&gt;&gt;&gt; GetPoLinesAsync(<span class="keywordtype">string</span> poNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_InforVisualPOLine&gt;&gt; GetPoLineAsync(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> lineNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;bool&gt;&gt; CheckConnectionAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md319"></a>
File: Module_Routing/Services/IRoutingService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IRoutingService</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;int&gt;&gt; CreateLabelAsync(Model_RoutingLabel label);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateLabelAsync(Model_RoutingLabel label, <span class="keywordtype">int</span> editedByEmployeeNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_RoutingLabel&gt;&gt; GetLabelByIdAsync(<span class="keywordtype">int</span> labelId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingLabel&gt;&gt;&gt; GetAllLabelsAsync(<span class="keywordtype">int</span> limit = 100, <span class="keywordtype">int</span> offset = 0);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;(<span class="keywordtype">bool</span> Exists, <span class="keywordtype">int</span>? ExistingLabelId)&gt;&gt; CheckDuplicateLabelAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; ExportLabelToCsvAsync(Model_RoutingLabel label);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; RegenerateLabelCsvAsync(<span class="keywordtype">int</span> labelId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; ResetCsvFileAsync();</div>
<div class="line"><span class="keyword">public</span> Model_Dao_Result ValidateLabel(Model_RoutingLabel label);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md320"></a>
File: Module_Routing/Services/IRoutingUsageTrackingService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IRoutingUsageTrackingService</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&gt; IncrementUsageCountAsync(int employeeNumber, int recipientId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetUsageCountAsync(<span class="keywordtype">int</span> employeeNumber, <span class="keywordtype">int</span> recipientId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetEmployeeLabelCountAsync(<span class="keywordtype">int</span> employeeNumber);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md321"></a>
File: Module_Routing/Services/IRoutingUserPreferenceService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IRoutingUserPreferenceService</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;Model_RoutingUserPreference&gt;&gt; GetUserPreferenceAsync(int employeeNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; SaveUserPreferenceAsync(Model_RoutingUserPreference preference);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; ResetToDefaultsAsync(<span class="keywordtype">int</span> employeeNumber);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md322"></a>
File: Module_Routing/Views/RoutingEditModeView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>RoutingEditModeView : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPageLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.InitializeAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnDataGridDoubleTapped(object sender, DoubleTappedRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await EditSelectedLabelCommand.ExecuteAsync(null);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task EditSelectedLabelCommand_ExecuteAsync(object? parameter)</div>
<div class="line">⋮----</div>
<div class="line">var editedLabel = new Model_RoutingLabel</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var grid = new Grid</div>
<div class="line">⋮----</div>
<div class="line">Padding = new Thickness(24)</div>
<div class="line">⋮----</div>
<div class="line">grid.RowDefinitions.Add(new RowDefinition { Height = GridLength.Auto });</div>
<div class="line">⋮----</div>
<div class="line">grid.ColumnDefinitions.Add(new ColumnDefinition { Width = GridLength.Auto });</div>
<div class="line">grid.ColumnDefinitions.Add(new ColumnDefinition { Width = new GridLength(1, GridUnitType.Star) });</div>
<div class="line">var poLabel = new TextBlock { Text = <span class="stringliteral">&quot;PO Number:&quot;</span>, VerticalAlignment = VerticalAlignment.Center };</div>
<div class="line">var poValue = <span class="keyword">new</span> TextBox { Text = editedLabel.PONumber ?? <span class="stringliteral">&quot;N/A&quot;</span>, IsReadOnly = <span class="keyword">true</span> };</div>
<div class="line">Grid.SetRow(poLabel, 0);</div>
<div class="line">Grid.SetColumn(poLabel, 0);</div>
<div class="line">Grid.SetRow(poValue, 0);</div>
<div class="line">Grid.SetColumn(poValue, 1);</div>
<div class="line">grid.Children.Add(poLabel);</div>
<div class="line">grid.Children.Add(poValue);</div>
<div class="line">var partLabel = <span class="keyword">new</span> TextBlock { Text = <span class="stringliteral">&quot;Part Description:&quot;</span>, VerticalAlignment = VerticalAlignment.Center };</div>
<div class="line">var partValue = <span class="keyword">new</span> TextBox { Text = editedLabel.Description ?? <span class="stringliteral">&quot;N/A&quot;</span>, IsReadOnly = <span class="keyword">true</span> };</div>
<div class="line">Grid.SetRow(partLabel, 1);</div>
<div class="line">Grid.SetColumn(partLabel, 0);</div>
<div class="line">Grid.SetRow(partValue, 1);</div>
<div class="line">Grid.SetColumn(partValue, 1);</div>
<div class="line">grid.Children.Add(partLabel);</div>
<div class="line">grid.Children.Add(partValue);</div>
<div class="line">var recipientLabel = <span class="keyword">new</span> TextBlock { Text = <span class="stringliteral">&quot;Recipient:&quot;</span>, VerticalAlignment = VerticalAlignment.Center };</div>
<div class="line">var recipientCombo = <span class="keyword">new</span> ComboBox</div>
<div class="line">⋮----</div>
<div class="line">Grid.SetRow(recipientLabel, 2);</div>
<div class="line">Grid.SetColumn(recipientLabel, 0);</div>
<div class="line">Grid.SetRow(recipientCombo, 2);</div>
<div class="line">Grid.SetColumn(recipientCombo, 1);</div>
<div class="line">grid.Children.Add(recipientLabel);</div>
<div class="line">grid.Children.Add(recipientCombo);</div>
<div class="line">var qtyLabel = <span class="keyword">new</span> TextBlock { Text = <span class="stringliteral">&quot;Quantity:&quot;</span>, VerticalAlignment = VerticalAlignment.Center };</div>
<div class="line">var qtyBox = <span class="keyword">new</span> NumberBox</div>
<div class="line">⋮----</div>
<div class="line">Grid.SetRow(qtyLabel, 3);</div>
<div class="line">Grid.SetColumn(qtyLabel, 0);</div>
<div class="line">Grid.SetRow(qtyBox, 3);</div>
<div class="line">Grid.SetColumn(qtyBox, 1);</div>
<div class="line">grid.Children.Add(qtyLabel);</div>
<div class="line">grid.Children.Add(qtyBox);</div>
<div class="line">var dateLabel = <span class="keyword">new</span> TextBlock { Text = <span class="stringliteral">&quot;Created Date:&quot;</span>, VerticalAlignment = VerticalAlignment.Center };</div>
<div class="line">var dateValue = <span class="keyword">new</span> TextBox { Text = editedLabel.CreatedDate.ToString(<span class="stringliteral">&quot;g&quot;</span>), IsReadOnly = <span class="keyword">true</span> };</div>
<div class="line">Grid.SetRow(dateLabel, 4);</div>
<div class="line">Grid.SetColumn(dateLabel, 0);</div>
<div class="line">Grid.SetRow(dateValue, 4);</div>
<div class="line">Grid.SetColumn(dateValue, 1);</div>
<div class="line">grid.Children.Add(dateLabel);</div>
<div class="line">grid.Children.Add(dateValue);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.SaveEditedLabelCommand.ExecuteAsync(editedLabel);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md323"></a>
File: Module_Routing/Views/RoutingManualEntryView.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Routing.Views.RoutingManualEntryView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manual Entry Mode&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Enter multiple labels and save in batch&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- DataGrid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">controls:DataGrid</span> </div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">            <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Labels, Mode=OneWay}&quot;</span></div>
<div class="line">            <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedLabel, Mode=TwoWay}&quot;</span></div>
<div class="line">            <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">            <span class="keyword">CanUserReorderColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">            <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">            <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;All&quot;</span></div>
<div class="line">            <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;All&quot;</span></div>
<div class="line">            <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">            <span class="keyword">AlternatingRowBackground</span>=<span class="stringliteral">&quot;#F5F5F5&quot;</span></div>
<div class="line">            <span class="keyword">CellEditEnding</span>=<span class="stringliteral">&quot;OnCellEditEnding&quot;</span>&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                <span class="comment">&lt;!-- PO Number --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;PO Number&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PONumber, Mode=TwoWay}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Line --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Line&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding POLine, Mode=TwoWay}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Recipient - Using Template Column since WinUI DataGridComboBoxColumn has different API --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Recipient&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;200&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{Binding RecipientName}&quot;</span> </div>
<div class="line">                                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8,0&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellEditingTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">ComboBox</span> </div>
<div class="line">                                <span class="keyword">SelectedValue</span>=<span class="stringliteral">&quot;{Binding RecipientID, Mode=TwoWay}&quot;</span></div>
<div class="line">                                <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{Binding DataContext.AllRecipients, RelativeSource={RelativeSource Mode=TemplatedParent}}&quot;</span></div>
<div class="line">                                <span class="keyword">DisplayMemberPath</span>=<span class="stringliteral">&quot;Name&quot;</span></div>
<div class="line">                                <span class="keyword">SelectedValuePath</span>=<span class="stringliteral">&quot;Id&quot;</span></div>
<div class="line">                                <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellEditingTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Quantity --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Quantity&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Quantity, Mode=TwoWay}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Part ID (Read-Only, auto-populated) --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartID, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Add Row&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddNewRowCommand}&quot;</span></div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Delete Row&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.DeleteSelectedRowCommand}&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Save All Labels&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SaveAllLabelsCommand}&quot;</span></div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> </div>
<div class="line">                <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> </div>
<div class="line">                <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.LabelCount, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource SystemAccentColor}&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;labels ready to save&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md324"></a>
File: Module_Routing/Views/RoutingManualEntryView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>RoutingManualEntryView : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPageLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.InitializeAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnCellEditEnding(object sender, DataGridCellEditEndingEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">if (e.Column.Header.ToString() == &quot;PO Number&quot; &amp;&amp; !e.Cancel)</div>
<div class="line">⋮----</div>
<div class="line">_ = DispatcherQueue.TryEnqueue(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.ValidatePOAsync(label);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md325"></a>
File: Module_Routing/Views/RoutingModeSelectionView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>RoutingModeSelectionView : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPageLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.SetNavigationFrame(this.Frame);</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.InitializeAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md326"></a>
File: Module_Routing/Views/RoutingWizardStep2View.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>RoutingWizardStep2View : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnPageLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.LoadRecipientsCommand.ExecuteAsync(null);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ListView_KeyDown(object sender, KeyRoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.ProceedToStep3Command.Execute(null);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md327"></a>
File: Module_Settings/Interfaces/IService_SettingsWorkflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_SettingsWorkflow</div>
<div class="line">⋮----</div>
<div class="line">public void GoToStep(Enum_SettingsWorkflowStep step);</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> GoBack();</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Reset();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md328"></a>
File: Module_Settings/Models/Model_ConnectionTestResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_ConnectionTestResult : ObservableObject</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md329"></a>
File: Module_Settings/Models/Model_DaoTestResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_DaoTestResult : ObservableObject</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md330"></a>
File: Module_Settings/Models/Model_SettingValue.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_SettingValue</div>
<div class="line">⋮----</div>
<div class="line">public string AsString() =&gt; RawValue ?? <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">int</span> AsInt() =&gt; <span class="keywordtype">int</span>.TryParse(RawValue, out var val) ? val : 0;</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">bool</span> AsBool() =&gt; <span class="keywordtype">bool</span>.TryParse(RawValue, out var val) &amp;&amp; val;</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">double</span> AsDouble() =&gt; <span class="keywordtype">double</span>.TryParse(RawValue, out var val) ? val : 0.0;</div>
<div class="line"><span class="keyword">public</span> T? AsJson&lt;T&gt;()</div>
<div class="line">⋮----</div>
<div class="line">return <span class="keywordtype">string</span>.IsNullOrWhiteSpace(RawValue)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">object</span>? AsTyped()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md331"></a>
File: Module_Settings/Models/Model_StoredProcedureTestResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_StoredProcedureTestResult : ObservableObject</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md332"></a>
File: Module_Settings/Models/Model_TableTestResult.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_TableTestResult : ObservableObject</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md333"></a>
File: Module_Settings/Services/Service_UserPreferences.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_UserPreferences : IService_UserPreferences</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_User _userDao;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_UserPreference&gt;&gt; GetLatestUserPreferenceAsync(string username)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(normalizedUsername))</div>
<div class="line">⋮----</div>
<div class="line">var userResult = await _userDao.GetUserByWindowsUsernameAsync(normalizedUsername);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(</div>
<div class="line">⋮----</div>
<div class="line">var preference = new Model_UserPreference</div>
<div class="line">⋮----</div>
<div class="line">DefaultReceivingMode = string.IsNullOrWhiteSpace(userResult.Data.DefaultReceivingMode)</div>
<div class="line">⋮----</div>
<div class="line">DefaultDunnageMode = string.IsNullOrWhiteSpace(userResult.Data.DefaultDunnageMode)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(preference);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error getting user preference for {username}&quot;, ex, &quot;UserPreferences&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateDefaultModeAsync(string username, string defaultMode)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Default mode update skipped: user not found ({normalizedUsername})&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var normalizedMode = string.IsNullOrWhiteSpace(defaultMode)</div>
<div class="line">⋮----</div>
<div class="line">: defaultMode.Trim().ToLowerInvariant();</div>
<div class="line">var result = await _userDao.UpdateDefaultModeAsync(userResult.Data.EmployeeNumber, normalizedMode);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Default mode update failed (non-blocking): {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error updating default mode for {username} (non-blocking)&quot;, ex, &quot;UserPreferences&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateDefaultReceivingModeAsync(string username, string defaultMode)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Receiving default update skipped: user not found ({normalizedUsername})&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _userDao.UpdateDefaultReceivingModeAsync(userResult.Data.EmployeeNumber, normalizedMode);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Receiving default update failed (non-blocking): {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error updating receiving default for {username} (non-blocking)&quot;, ex, &quot;UserPreferences&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateDefaultDunnageModeAsync(string username, string defaultMode)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Dunnage default update skipped: user not found ({normalizedUsername})&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _userDao.UpdateDefaultDunnageModeAsync(userResult.Data.EmployeeNumber, normalizedMode);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Dunnage default update failed (non-blocking): {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error updating dunnage default for {username} (non-blocking)&quot;, ex, &quot;UserPreferences&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md334"></a>
File: Module_Settings/Views/View_Settings_DatabaseTest.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Settings_DatabaseTest : Page</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Constructor started&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Attempting to get ViewModel from DI&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] ViewModel obtained: {ViewModel != null}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">throw new InvalidOperationException(&quot;Failed to obtain ViewModel from DI - returned null&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] Failed to create ViewModel: {ex.Message}&quot;);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] Exception type: {ex.GetType().FullName}&quot;);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] Stack trace: {ex.StackTrace}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Calling InitializeComponent()&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] InitializeComponent() completed&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] InitializeComponent() FAILED: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Setting DataContext&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Attempting to get Focus service&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Attaching focus service&quot;);</div>
<div class="line">focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Focus service is null&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] Focus service failed (non-critical): {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Attaching Loaded event handler&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Constructor completed&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnLoaded(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] OnLoaded event fired&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] Executing RunAllTestsCommand&quot;);</div>
<div class="line">await ViewModel.RunAllTestsCommand.ExecuteAsync(null);</div>
<div class="line">System.Diagnostics.Debug.WriteLine(&quot;[DatabaseTestView] RunAllTestsCommand completed&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] Cannot run tests - ViewModel: {ViewModel != null}, Command: {ViewModel?.RunAllTestsCommand != null}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] Error running database tests: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnSchemaTabClick(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnStoredProceduresTabClick(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnDaosTabClick(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnLogsTabClick(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdateTabVisibility()</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;[DatabaseTestView] Selected tab: {ViewModel.SelectedTab}&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md335"></a>
File: Module_Shared/ViewModels/ViewModel_Shared_MainWindow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Shared_MainWindow : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnNotificationServicePropertyChanged(object? sender, PropertyChangedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdateUserDisplay(Model_User user)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md336"></a>
File: Module_Volvo/Contracts/IService_Volvo.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Volvo</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;Dictionary&lt;string, int&gt;&gt;&gt; CalculateComponentExplosionAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;string&gt;&gt; GenerateLabelCsvAsync(int shipmentId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;string&gt; FormatEmailTextAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_VolvoEmailData&gt; FormatEmailDataAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> FormatEmailAsHtml(Model_VolvoEmailData emailData);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; ValidateShipmentAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;(<span class="keywordtype">int</span> ShipmentId, <span class="keywordtype">int</span> ShipmentNumber)&gt;&gt; SaveShipmentAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_VolvoShipment?&gt;&gt; GetPendingShipmentAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;(Model_VolvoShipment? Shipment, List&lt;Model_VolvoShipmentLine&gt; Lines)&gt;&gt; GetPendingShipmentWithLinesAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; CompleteShipmentAsync(<span class="keywordtype">int</span> shipmentId, <span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> receiverNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPart&gt;&gt;&gt; GetActivePartsAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoShipment&gt;&gt;&gt; GetHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoShipmentLine&gt;&gt;&gt; GetShipmentLinesAsync(<span class="keywordtype">int</span> shipmentId);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdateShipmentAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;string&gt;&gt; ExportHistoryToCsvAsync(</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md337"></a>
File: Module_Volvo/Contracts/IService_VolvoMasterData.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_VolvoMasterData</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPart&gt;&gt;&gt; GetAllPartsAsync(bool includeInactive = <span class="keyword">false</span>);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_VolvoPart?&gt;&gt; GetPartByNumberAsync(<span class="keywordtype">string</span> partNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; AddPartAsync(Model_VolvoPart part, List&lt;Model_VolvoPartComponent&gt;? components = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; UpdatePartAsync(Model_VolvoPart part, List&lt;Model_VolvoPartComponent&gt;? components = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&gt; DeactivatePartAsync(<span class="keywordtype">string</span> partNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPartComponent&gt;&gt;&gt; GetComponentsAsync(<span class="keywordtype">string</span> partNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;(<span class="keywordtype">int</span> New, <span class="keywordtype">int</span> Updated, <span class="keywordtype">int</span> Unchanged)&gt;&gt; ImportCsvAsync(<span class="keywordtype">string</span> csvFilePath);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;string&gt;&gt; ExportCsvAsync(<span class="keywordtype">string</span> csvFilePath, <span class="keywordtype">bool</span> includeInactive = <span class="keyword">false</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md338"></a>
File: Module_Volvo/Interfaces/IDao_VolvoPart.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IDao_VolvoPart</div>
<div class="line">⋮----</div>
<div class="line">Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPart&gt;&gt;&gt; GetAllAsync(bool includeInactive = <span class="keyword">false</span>);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;Model_VolvoPart&gt;&gt; GetByPartNumberAsync(<span class="keywordtype">string</span> partNumber);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertAsync(Model_VolvoPart part);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_VolvoPart part);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; DeactivateAsync(<span class="keywordtype">string</span> partNumber);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md339"></a>
File: Module_Volvo/Interfaces/IDao_VolvoShipment.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IDao_VolvoShipment</div>
<div class="line">⋮----</div>
<div class="line">Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoShipment&gt;&gt;&gt; GetAllAsync(bool includeArchived = <span class="keyword">false</span>);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;Model_VolvoShipment&gt;&gt; GetByIdAsync(<span class="keywordtype">int</span> shipmentId);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;Model_VolvoShipment&gt;&gt; GetPendingAsync();</div>
<div class="line">Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertAsync(Model_VolvoShipment shipment);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_VolvoShipment shipment);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; ArchiveAsync(<span class="keywordtype">int</span> shipmentId);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md340"></a>
File: Module_Volvo/Interfaces/IDao_VolvoShipmentLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IDao_VolvoShipmentLine</div>
<div class="line">⋮----</div>
<div class="line">Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoShipmentLine&gt;&gt;&gt; GetByShipmentIdAsync(int shipmentId);</div>
<div class="line">Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertAsync(Model_VolvoShipmentLine line);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_VolvoShipmentLine line);</div>
<div class="line">Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> lineId);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md341"></a>
File: Module_Volvo/Models/Model_EmailRecipient.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_EmailRecipient</div>
<div class="line">⋮----</div>
<div class="line">public string ToOutlookFormat()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md342"></a>
File: Module_Volvo/Models/Model_VolvoEmailData.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_VolvoEmailData</div>
<div class="line">⋮----</div>
<div class="line">public class DiscrepancyLineItem</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md343"></a>
File: Module_Volvo/Models/Model_VolvoPartComponent.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_VolvoPartComponent</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md344"></a>
File: Module_Volvo/Models/Model_VolvoShipment.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_VolvoShipment</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md345"></a>
File: Module_Volvo/Models/VolvoShipmentStatus.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>VolvoShipmentStatus</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md346"></a>
File: Module_Volvo/Services/IService_VolvoAuthorization.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_VolvoAuthorization</div>
<div class="line">⋮----</div>
<div class="line">Task&lt;Model_Dao_Result&gt; CanManageShipmentsAsync();</div>
<div class="line">Task&lt;Model_Dao_Result&gt; CanManageMasterDataAsync();</div>
<div class="line">Task&lt;Model_Dao_Result&gt; CanCompleteShipmentsAsync();</div>
<div class="line">Task&lt;Model_Dao_Result&gt; CanGenerateLabelsAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md347"></a>
File: Module_Volvo/Views/VolvoPartAddEditDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Volvo.Views.VolvoPartAddEditDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Add/Edit Volvo Part&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Save&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonClick</span>=<span class="stringliteral">&quot;OnSaveClicked&quot;</span></div>
<div class="line">    <span class="keyword">Width</span>=<span class="stringliteral">&quot;500&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">        <span class="comment">&lt;!-- Part Number --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PartNumberTextBox&quot;</span></div>
<div class="line">                 <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part Number&quot;</span></div>
<div class="line">                 <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;e.g., V-EMB-500&quot;</span></div>
<div class="line">                 <span class="keyword">MaxLength</span>=<span class="stringliteral">&quot;50&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Quantity Per Skid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;QuantityPerSkidNumberBox&quot;</span></div>
<div class="line">                   <span class="keyword">Header</span>=<span class="stringliteral">&quot;Quantity Per Skid&quot;</span></div>
<div class="line">                   <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;e.g., 88&quot;</span></div>
<div class="line">                   <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                   <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;10000&quot;</span></div>
<div class="line">                   <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                   <span class="keyword">Value</span>=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Historical Integrity Warning (Edit Mode Only) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;EditModeWarning&quot;</span></div>
<div class="line">                 <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Warning&quot;</span></div>
<div class="line">                 <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                 <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                 <span class="keyword">Message</span>=<span class="stringliteral">&quot;Changes to quantity will NOT affect past shipments. Historical piece counts are preserved.&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Component Section (Simplified - Future Enhancement) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Expander</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Components (Advanced)&quot;</span> <span class="keyword">IsExpanded</span>=<span class="stringliteral">&quot;False&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Component management will be available in a future update.&quot;</span> </div>
<div class="line">                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                          <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;For now, use CSV import to define components.&quot;</span> </div>
<div class="line">                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span></div>
<div class="line">                          <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Expander</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md348"></a>
File: MTM_Receiving_Application.Tests/Fixtures/DatabaseFixture.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class </span>DatabaseFixture : IDisposable</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Dispose()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md349"></a>
File: MTM_Receiving_Application.Tests/Fixtures/ServiceCollectionFixture.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class </span>ServiceCollectionFixture : IDisposable</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Dispose()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md350"></a>
File: MTM_Receiving_Application.Tests/Helpers/TestHelper.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>TestHelper</div>
<div class="line">⋮----</div>
<div class="line">public static string NewGuidString() =&gt; Guid.NewGuid().ToString(<span class="stringliteral">&quot;N&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md351"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_BooleanToVisibility_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_BooleanToVisibility_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_BooleanToVisibility _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithBooleanValue_ReturnsExpectedVisibility(<span class="keywordtype">bool</span> input, <span class="keywordtype">string</span>? parameter, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), parameter, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNullValue_ReturnsCollapsed()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(null, typeof(Visibility), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(Visibility.Collapsed);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNonBooleanValue_ReturnsCollapsed(<span class="keywordtype">object</span> input)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithUnknownParameter_IgnoresParameter()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(true, typeof(Visibility), <span class="stringliteral">&quot;SomeOtherParam&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(Visibility.Visible);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_ThrowsNotImplementedException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; _sut.ConvertBack(Visibility.Visible, typeof(<span class="keywordtype">bool</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">act.Should().Throw&lt;NotImplementedException&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md352"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_BoolToString_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_BoolToString_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_BoolToString _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithBooleanAndValidParameter_ReturnsCorrectString(<span class="keywordtype">bool</span> input, <span class="keywordtype">string</span> parameter, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">string</span>), parameter, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNullValue_ReturnsEmptyString()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(null, typeof(<span class="keywordtype">string</span>), <span class="stringliteral">&quot;Yes|No&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(<span class="keywordtype">string</span>.Empty);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNullParameter_ReturnsBooleanToString(<span class="keywordtype">bool</span> input, <span class="keywordtype">object</span>? parameter)</div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(input.ToString());</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithInvalidParameter_ReturnsBooleanToString(<span class="keywordtype">bool</span> input, <span class="keywordtype">string</span> parameter)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNonBooleanValue_ReturnsValueToString(<span class="keywordtype">object</span> input, <span class="keywordtype">string</span> parameter)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithMoreThanTwoParts_ReturnsOriginalBooleanString(<span class="keywordtype">bool</span> input, <span class="keywordtype">string</span> parameter)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_ThrowsNotImplementedException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; _sut.ConvertBack(<span class="stringliteral">&quot;Yes&quot;</span>, typeof(<span class="keywordtype">bool</span>), <span class="stringliteral">&quot;Yes|No&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">act.Should().Throw&lt;NotImplementedException&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md353"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_DecimalToString_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_DecimalToString_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_DecimalToString _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithDecimalValue_ReturnsExpectedString(decimal input, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">string</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithVeryPreciseDecimal_ReturnsPreciseString()</div>
<div class="line">⋮----</div>
<div class="line">result.Should().BeOfType&lt;<span class="keywordtype">string</span>&gt;();</div>
<div class="line">⋮----</div>
<div class="line">resultString.Should().NotBeNullOrEmpty();</div>
<div class="line">resultString.Should().StartWith(<span class="stringliteral">&quot;0.12345678901234&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithZero_ReturnsEmptyString()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(0m, typeof(<span class="keywordtype">string</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(<span class="keywordtype">string</span>.Empty);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNonDecimalValue_ReturnsEmptyString(<span class="keywordtype">object</span>? input)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithValidString_ReturnsDecimal(<span class="keywordtype">string</span> input, decimal expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.ConvertBack(input, typeof(decimal), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithEmptyOrWhitespaceString_ReturnsZero(<span class="keywordtype">string</span>? input)</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Act</span></div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(0m);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithInvalidString_ReturnsZero(<span class="keywordtype">string</span> input)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithNonStringValue_ReturnsZero()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.ConvertBack(42, typeof(decimal), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_RoundTrip_PreservesValue()</div>
<div class="line">⋮----</div>
<div class="line">var stringResult = _sut.Convert(originalValue, typeof(<span class="keywordtype">string</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">var decimalResult = _sut.ConvertBack(stringResult, typeof(decimal), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">decimalResult.Should().Be(originalValue);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md354"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_DoubleToDecimal_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_DoubleToDecimal_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_DoubleToDecimal _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithDecimalValue_ReturnsDouble(decimal input, <span class="keywordtype">double</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">double</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNonDecimalValue_ReturnsZeroDouble(<span class="keywordtype">object</span>? input)</div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(0.0);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ConvertBack_WithDoubleValue_ReturnsDecimal(<span class="keywordtype">double</span> input, decimal expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.ConvertBack(input, typeof(decimal), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ConvertBack_WithNonDoubleValue_ReturnsZeroDecimal(<span class="keywordtype">object</span>? input)</div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(0m);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_RoundTrip_PreservesValue()</div>
<div class="line">⋮----</div>
<div class="line">var doubleResult = _sut.Convert(originalValue, typeof(<span class="keywordtype">double</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">var decimalResult = _sut.ConvertBack(doubleResult, typeof(decimal), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">decimalResult.Should().Be(originalValue);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithLargeDecimalValue_HandlesWithinDoubleRange()</div>
<div class="line">⋮----</div>
<div class="line">result.Should().BeOfType&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line">((<span class="keywordtype">double</span>)result).Should().BeApproximately(79228162514264.0, 0.1);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithLargeDoubleValue_HandlesWithinDecimalRange()</div>
<div class="line">⋮----</div>
<div class="line">result.Should().BeOfType&lt;decimal&gt;();</div>
<div class="line">((decimal)result).Should().BeApproximately(79228162514264m, 1m);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md355"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_EmptyStringToVisibility_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_EmptyStringToVisibility_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_EmptyStringToVisibility _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithStringValue_ReturnsExpectedVisibility(<span class="keywordtype">string</span>? input, <span class="keywordtype">object</span>? parameter, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Act</span></div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), parameter, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithInverseParameter_ReturnsInvertedVisibility(<span class="keywordtype">string</span>? input, <span class="keywordtype">string</span> parameter, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNonStringValue_ReturnsCollapsed(<span class="keywordtype">object</span> input)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(Visibility.Collapsed);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithUnknownParameter_IgnoresParameter()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(<span class="stringliteral">&quot;Hello&quot;</span>, typeof(Visibility), <span class="stringliteral">&quot;SomeOtherParam&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(Visibility.Visible);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_ThrowsNotImplementedException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; _sut.ConvertBack(Visibility.Visible, typeof(<span class="keywordtype">string</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">act.Should().Throw&lt;NotImplementedException&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md356"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_EnumToVisibility_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_EnumToVisibility_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_EnumToVisibility _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithEnumValue_ReturnsExpectedVisibility(TestEnum input, <span class="keywordtype">string</span> parameter, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), parameter, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNullValue_ReturnsCollapsed()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(null, typeof(Visibility), <span class="stringliteral">&quot;First&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(Visibility.Collapsed);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNullParameter_ReturnsCollapsed()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(TestEnum.First, typeof(Visibility), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithBothNull_ReturnsCollapsed()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(null, typeof(Visibility), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithStringValue_ComparesCorrectly(<span class="keywordtype">string</span> input, <span class="keywordtype">string</span> parameter, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNumericValue_ComparesAsString(<span class="keywordtype">int</span> input, <span class="keywordtype">string</span> parameter, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_ThrowsNotImplementedException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; _sut.ConvertBack(Visibility.Visible, typeof(TestEnum), <span class="stringliteral">&quot;First&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">act.Should().Throw&lt;NotImplementedException&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md357"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_IconCodeToGlyph_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_IconCodeToGlyph_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_IconCodeToGlyph _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithHtmlEntityFormat_ReturnsGlyphCharacter(<span class="keywordtype">string</span> input, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">string</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithRawHexFormat_ReturnsGlyphCharacter(<span class="keywordtype">string</span> input, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNullOrWhitespace_ReturnsDefaultIcon(<span class="keywordtype">string</span>? input)</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Act</span></div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(<span class="stringliteral">&quot;\uE7B8&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithInvalidHexValue_ReturnsInputAsIs(<span class="keywordtype">string</span> input)</div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(input);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNonFourCharacterHex_ReturnsInputAsIs(<span class="keywordtype">string</span> input)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithSingleCharacterString_ReturnsInputAsIs()</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNonStringValue_ReturnsDefaultIcon(<span class="keywordtype">object</span> input)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_ThrowsNotImplementedException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; _sut.ConvertBack(<span class="stringliteral">&quot;\uE7B8&quot;</span>, typeof(<span class="keywordtype">string</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">act.Should().Throw&lt;NotImplementedException&gt;();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithLowercaseHex_HandlesCorrectly(<span class="keywordtype">string</span> input)</div>
<div class="line">⋮----</div>
<div class="line">var lowercaseInput = input.ToLower();</div>
<div class="line">var result = _sut.Convert(lowercaseInput, typeof(<span class="keywordtype">string</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().NotBeNull();</div>
<div class="line">result.Should().BeOfType&lt;<span class="keywordtype">string</span>&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md358"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_IntToVisibility_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_IntToVisibility_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_IntToVisibility _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNoParameter_ShowsWhenValueGreaterThanZero(<span class="keywordtype">int</span> input, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithInverseParameter_ShowsWhenValueIsZero(<span class="keywordtype">int</span> input, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), <span class="stringliteral">&quot;Inverse&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithInverseParameterCaseInsensitive_WorksCorrectly(<span class="keywordtype">int</span> input, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), <span class="stringliteral">&quot;inverse&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNumericStringParameter_ShowsWhenValueMatchesParameter(<span class="keywordtype">int</span> input, <span class="keywordtype">string</span> parameter, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(Visibility), parameter, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithDirectIntParameter_ShowsWhenValueMatchesParameter(<span class="keywordtype">int</span> input, <span class="keywordtype">int</span> parameter, Visibility expected)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNullValue_ReturnsCollapsed()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(null, typeof(Visibility), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(Visibility.Collapsed);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNonNumericStringParameter_FallsBackToGreaterThanZero(<span class="keywordtype">string</span> parameter)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(5, typeof(Visibility), parameter, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(Visibility.Visible);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNonIntegerValue_TreatsAsZero(<span class="keywordtype">object</span> input)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_ThrowsNotImplementedException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; _sut.ConvertBack(Visibility.Visible, typeof(<span class="keywordtype">int</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">act.Should().Throw&lt;NotImplementedException&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md359"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_LoadNumberToOneBased_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_LoadNumberToOneBased_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_LoadNumberToOneBased _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithIntegerValue_ReturnsOneBasedValue(<span class="keywordtype">int</span> input, <span class="keywordtype">int</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">int</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNonIntegerValue_ReturnsValueAsIs(<span class="keywordtype">object</span>? input)</div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(input);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ConvertBack_WithValidStringValue_ReturnsZeroBasedValue(<span class="keywordtype">string</span> input, <span class="keywordtype">int</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.ConvertBack(input, typeof(<span class="keywordtype">int</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ConvertBack_WithInvalidString_ReturnsValueAsIs(<span class="keywordtype">string</span> input)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ConvertBack_WithNonStringValue_ReturnsValueAsIs(<span class="keywordtype">object</span>? input)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_RoundTrip_PreservesValue(<span class="keywordtype">int</span> originalValue)</div>
<div class="line">⋮----</div>
<div class="line">var oneBasedResult = _sut.Convert(originalValue, typeof(<span class="keywordtype">int</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">var zeroBasedResult = _sut.ConvertBack(oneBasedResult.ToString(), typeof(<span class="keywordtype">int</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">zeroBasedResult.Should().Be(originalValue);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNegativeValue_ReturnsNegativeOneBased()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(-5, typeof(<span class="keywordtype">int</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(-4);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithZeroString_ReturnsNegativeOne()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.ConvertBack(<span class="stringliteral">&quot;0&quot;</span>, typeof(<span class="keywordtype">int</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(-1);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md360"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_StringFormat_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_StringFormat_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_StringFormat _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithValidFormatParameter_ReturnsFormattedString(<span class="keywordtype">object</span> input, <span class="keywordtype">string</span> format, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">string</span>), format, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNullParameter_ReturnsValueAsIs(<span class="keywordtype">object</span> input)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">string</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(input);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNonStringParameter_ReturnsValueAsIs(<span class="keywordtype">object</span> input)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">string</span>), 123, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNullValue_FormatsNullAsString()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(null, typeof(<span class="keywordtype">string</span>), <span class="stringliteral">&quot;Value: {0}&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(<span class="stringliteral">&quot;Value: &quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNumericFormatting_ReturnsFormattedNumber(<span class="keywordtype">object</span> input, <span class="keywordtype">string</span> format, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithEmptyFormatString_ReturnsEmptyString()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(<span class="stringliteral">&quot;Hello&quot;</span>, typeof(<span class="keywordtype">string</span>), <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_ThrowsNotImplementedException()</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Act</span></div>
<div class="line">Action act = () =&gt; _sut.ConvertBack(<span class="stringliteral">&quot;Formatted String&quot;</span>, typeof(<span class="keywordtype">object</span>), <span class="stringliteral">&quot;{0}&quot;</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">act.Should().Throw&lt;NotImplementedException&gt;();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithComplexFormatString_HandlesCorrectly(<span class="keywordtype">object</span> input, <span class="keywordtype">string</span> format, <span class="keywordtype">string</span> expected)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md361"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/NullableDoubleToDoubleConverter_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>NullableDoubleToDoubleConverter_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly NullableDoubleToDoubleConverter _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithDoubleValue_ReturnsDoubleValue(<span class="keywordtype">double</span> input, <span class="keywordtype">double</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(input, typeof(<span class="keywordtype">double</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNonDoubleValue_ReturnsZero(<span class="keywordtype">object</span>? input)</div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(0.0);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ConvertBack_WithDoubleValue_ReturnsNullableDouble(<span class="keywordtype">double</span> input)</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.ConvertBack(input, typeof(<span class="keywordtype">double</span>?), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be((<span class="keywordtype">double</span>?)input);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ConvertBack_WithNonDoubleValue_ReturnsNull(<span class="keywordtype">object</span>? input)</div>
<div class="line">⋮----</div>
<div class="line">result.Should().BeNull();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_RoundTrip_PreservesValue(<span class="keywordtype">double</span> originalValue)</div>
<div class="line">⋮----</div>
<div class="line">var doubleResult = _sut.Convert(originalValue, typeof(<span class="keywordtype">double</span>), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">var nullableResult = _sut.ConvertBack(doubleResult, typeof(<span class="keywordtype">double</span>?), <span class="keyword">null</span>, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">nullableResult.Should().Be(originalValue);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNaN_ReturnsNaN()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(<span class="keywordtype">double</span>.NaN, typeof(<span class="keywordtype">double</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(<span class="keywordtype">double</span>.NaN);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithPositiveInfinity_ReturnsPositiveInfinity()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(<span class="keywordtype">double</span>.PositiveInfinity, typeof(<span class="keywordtype">double</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(<span class="keywordtype">double</span>.PositiveInfinity);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNegativeInfinity_ReturnsNegativeInfinity()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.Convert(<span class="keywordtype">double</span>.NegativeInfinity, typeof(<span class="keywordtype">double</span>), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be(<span class="keywordtype">double</span>.NegativeInfinity);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithNaN_ReturnsNullableNaN()</div>
<div class="line">⋮----</div>
<div class="line">var result = _sut.ConvertBack(<span class="keywordtype">double</span>.NaN, typeof(<span class="keywordtype">double</span>?), null, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">result.Should().Be((<span class="keywordtype">double</span>?)<span class="keywordtype">double</span>.NaN);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md362"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Defaults/InforVisualDefaults_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>InforVisualDefaults_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void DefaultSiteId_ShouldNotBeNullOrWhiteSpace()</div>
<div class="line">⋮----</div>
<div class="line">InforVisualDefaults.DefaultSiteId.Should().NotBeNullOrWhiteSpace();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> DefaultUom_ShouldNotBeNullOrWhiteSpace()</div>
<div class="line">⋮----</div>
<div class="line">InforVisualDefaults.DefaultUom.Should().NotBeNullOrWhiteSpace();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> DefaultPartStatus_ShouldNotBeNullOrWhiteSpace()</div>
<div class="line">⋮----</div>
<div class="line">InforVisualDefaults.DefaultPartStatus.Should().NotBeNullOrWhiteSpace();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Model_InforVisualConnection_DefaultsShouldMatch()</div>
<div class="line">⋮----</div>
<div class="line">var model = new Model_InforVisualConnection();</div>
<div class="line">model.Server.Should().Be(InforVisualDefaults.DefaultServer);</div>
<div class="line">model.Database.Should().Be(InforVisualDefaults.DefaultDatabase);</div>
<div class="line">model.SiteId.Should().Be(InforVisualDefaults.DefaultSiteId);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Model_InforVisualPart_DefaultsShouldMatch()</div>
<div class="line">⋮----</div>
<div class="line">var model = new Model_InforVisualPart();</div>
<div class="line">model.PrimaryUom.Should().Be(InforVisualDefaults.DefaultUom);</div>
<div class="line">model.DefaultSite.Should().Be(InforVisualDefaults.DefaultSiteId);</div>
<div class="line">model.PartStatus.Should().Be(InforVisualDefaults.DefaultPartStatus);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Model_InforVisualPO_DefaultsShouldMatch()</div>
<div class="line">⋮----</div>
<div class="line">var model = new Model_InforVisualPO();</div>
<div class="line">model.UnitOfMeasure.Should().Be(InforVisualDefaults.DefaultUom);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md363"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Defaults/WorkstationDefaults_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>WorkstationDefaults_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void SharedTerminalWorkstationType_ShouldNotBeNullOrWhiteSpace()</div>
<div class="line">⋮----</div>
<div class="line">WorkstationDefaults.SharedTerminalWorkstationType.Should().NotBeNullOrWhiteSpace();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> PersonalWorkstationWorkstationType_ShouldNotBeNullOrWhiteSpace()</div>
<div class="line">⋮----</div>
<div class="line">WorkstationDefaults.PersonalWorkstationWorkstationType.Should().NotBeNullOrWhiteSpace();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> SharedTerminalTimeoutMinutes_ShouldBePositive()</div>
<div class="line">⋮----</div>
<div class="line">WorkstationDefaults.SharedTerminalTimeoutMinutes.Should().BeGreaterThan(0);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PersonalWorkstationTimeoutMinutes_ShouldBePositive()</div>
<div class="line">⋮----</div>
<div class="line">WorkstationDefaults.PersonalWorkstationTimeoutMinutes.Should().BeGreaterThan(0);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md364"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Helpers/Database/Helper_Database_StoredProcedure_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Helper_Database_StoredProcedure_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void ValidateParameters_NullParameters_ReturnsTrue()</div>
<div class="line">⋮----</div>
<div class="line">var result = Helper_Database_StoredProcedure.ValidateParameters(<span class="keyword">null</span>);</div>
<div class="line">result.Should().BeTrue(<span class="stringliteral">&quot;null parameters list is considered valid (no parameters to validate)&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> ValidateParameters_ValidInputParameters_ReturnsTrue()</div>
<div class="line">⋮----</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p1&quot;</span>, <span class="stringliteral">&quot;value&quot;</span>),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p2&quot;</span>, 123)</div>
<div class="line">⋮----</div>
<div class="line">var result = Helper_Database_StoredProcedure.ValidateParameters(parameters);</div>
<div class="line">result.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ValidateParameters_NullInputParameterContent_ReturnsFalse()</div>
<div class="line">⋮----</div>
<div class="line">var parameter = new MySqlParameter(<span class="stringliteral">&quot;@p1&quot;</span>, MySqlDbType.VarChar);</div>
<div class="line">⋮----</div>
<div class="line">result.Should().BeFalse(<span class="stringliteral">&quot;input parameters should not be null (use DBNull.Value instead)&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ValidateParameters_DBNullInputParameter_ReturnsTrue()</div>
<div class="line">⋮----</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p1&quot;</span>, System.DBNull.Value)</div>
<div class="line">⋮----</div>
<div class="line">result.Should().BeTrue(<span class="stringliteral">&quot;DBNull.Value is a valid value for parameters&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md365"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Helpers/Database/Helper_Database_Variables_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Helper_Database_Variables_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void GetConnectionString_Production_ReturnsProductionString()</div>
<div class="line">⋮----</div>
<div class="line">var connectionString = Helper_Database_Variables.GetConnectionString(<span class="keyword">true</span>);</div>
<div class="line">connectionString.Should().Contain(<span class="stringliteral">&quot;Database=mtm_receiving_application&quot;</span>);</div>
<div class="line">connectionString.Should().NotContain(<span class="stringliteral">&quot;_test&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> GetConnectionString_Test_ReturnsTestString()</div>
<div class="line">⋮----</div>
<div class="line">var connectionString = Helper_Database_Variables.GetConnectionString(false);</div>
<div class="line">connectionString.Should().Contain(<span class="stringliteral">&quot;Database=mtm_receiving_application_test&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> GetInforVisualConnectionString_ReturnsReadOnlyIntent()</div>
<div class="line">⋮----</div>
<div class="line">var connectionString = Helper_Database_Variables.GetInforVisualConnectionString();</div>
<div class="line">connectionString.Should().Contain(<span class="stringliteral">&quot;ApplicationIntent=ReadOnly&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md366"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Models/Systems/Model_AuthenticationResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_AuthenticationResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void SuccessResult_SetsSuccessTrue()</div>
<div class="line">⋮----</div>
<div class="line">var user = <span class="keyword">new</span> Model_User();</div>
<div class="line">var result = Model_AuthenticationResult.SuccessResult(user);</div>
<div class="line">result.Success.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> SuccessResult_SetsUser()</div>
<div class="line">⋮----</div>
<div class="line">result.User.Should().BeSameAs(user);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> SuccessResult_SetsErrorMessageEmpty()</div>
<div class="line">⋮----</div>
<div class="line">result.ErrorMessage.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> SuccessResult_WithNullUser_Throws()</div>
<div class="line">⋮----</div>
<div class="line">var act = static () =&gt; Model_AuthenticationResult.SuccessResult(null!);</div>
<div class="line">act.Should().Throw&lt;ArgumentNullException&gt;();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ErrorResult_SetsSuccessFalse()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_AuthenticationResult.ErrorResult(<span class="stringliteral">&quot;bad&quot;</span>);</div>
<div class="line">result.Success.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ErrorResult_SetsUserNull()</div>
<div class="line">⋮----</div>
<div class="line">result.User.Should().BeNull();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ErrorResult_SetsErrorMessage()</div>
<div class="line">⋮----</div>
<div class="line">result.ErrorMessage.Should().Be(<span class="stringliteral">&quot;bad&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ErrorResult_WithNullMessage_Throws()</div>
<div class="line">⋮----</div>
<div class="line">var act = static () =&gt; Model_AuthenticationResult.ErrorResult(null!);</div>
<div class="line">act.Should().Throw&lt;ArgumentException&gt;();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ErrorResult_WithWhitespaceMessage_Throws()</div>
<div class="line">⋮----</div>
<div class="line">var act = static () =&gt; Model_AuthenticationResult.ErrorResult(<span class="stringliteral">&quot;   &quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md367"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Models/Systems/Model_User_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_User_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Default_SetsCreatedAndModifiedToNow()</div>
<div class="line">⋮----</div>
<div class="line">var user = <span class="keyword">new</span> Model_User();</div>
<div class="line">⋮----</div>
<div class="line">user.CreatedDate.Should().BeOnOrAfter(before);</div>
<div class="line">user.CreatedDate.Should().BeOnOrBefore(after);</div>
<div class="line">user.ModifiedDate.Should().BeOnOrAfter(before);</div>
<div class="line">user.ModifiedDate.Should().BeOnOrBefore(after);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> HasErpAccess_ReturnsFalseWhenVisualUsernameMissing()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User { VisualUsername = <span class="keyword">null</span> };</div>
<div class="line">user.HasErpAccess.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> HasErpAccess_ReturnsFalseWhenVisualUsernameWhitespace()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User { VisualUsername = <span class="stringliteral">&quot;   &quot;</span> };</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> HasErpAccess_ReturnsTrueWhenVisualUsernameProvided()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User { VisualUsername = <span class="stringliteral">&quot;user&quot;</span> };</div>
<div class="line">user.HasErpAccess.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> DisplayName_FormatsEmployeeNumberAndName()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User</div>
<div class="line">⋮----</div>
<div class="line">user.DisplayName.Should().Be(<span class="stringliteral">&quot;Jane Doe (Emp #123)&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md368"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Models/Systems/Model_ValidationResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ValidationResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Valid_SetsIsValidTrue()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ValidationResult.Valid();</div>
<div class="line">result.IsValid.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Valid_SetsErrorMessageEmpty()</div>
<div class="line">⋮----</div>
<div class="line">result.ErrorMessage.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Invalid_SetsIsValidFalse()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ValidationResult.Invalid(<span class="stringliteral">&quot;bad&quot;</span>);</div>
<div class="line">result.IsValid.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Invalid_SetsErrorMessage()</div>
<div class="line">⋮----</div>
<div class="line">result.ErrorMessage.Should().Be(<span class="stringliteral">&quot;bad&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Invalid_WithNullMessage_NormalizesMessage()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ValidationResult.Invalid(null);</div>
<div class="line">result.ErrorMessage.Should().Be(<span class="stringliteral">&quot;Validation failed.&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Invalid_WithWhitespaceMessage_NormalizesMessage()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ValidationResult.Invalid(<span class="stringliteral">&quot;   &quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md369"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Services/Authentication/Service_Authentication_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Authentication_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Service_Authentication _sut;</div>
<div class="line">⋮----</div>
<div class="line">_sut = <span class="keyword">new</span> Service_Authentication(_mockDaoUser.Object, _mockErrorHandler.Object);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task AuthenticateByWindowsUsernameAsync_EmptyUsername_ReturnsError_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _sut.AuthenticateByWindowsUsernameAsync(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="comment">// Assert</span></div>
<div class="line">result.Success.Should().BeFalse();</div>
<div class="line">result.ErrorMessage.Should().Contain(<span class="stringliteral">&quot;required&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task AuthenticateByWindowsUsernameAsync_UserNotFound_ReturnsError_Async()</div>
<div class="line">⋮----</div>
<div class="line">_mockDaoUser.Setup(x =&gt; x.GetUserByWindowsUsernameAsync(It.IsAny&lt;<span class="keywordtype">string</span>&gt;()))</div>
<div class="line">.ReturnsAsync(Model_Dao_Result_Factory.Failure&lt;Model_User&gt;(<span class="stringliteral">&quot;User not found&quot;</span>));</div>
<div class="line">var result = await _sut.AuthenticateByWindowsUsernameAsync(<span class="stringliteral">&quot;domain\\user&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">result.ErrorMessage.Should().Contain(<span class="stringliteral">&quot;not found&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task AuthenticateByWindowsUsernameAsync_ValidUser_ReturnsSuccess_Async()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User { FullName = <span class="stringliteral">&quot;Test User&quot;</span>, WindowsUsername = <span class="stringliteral">&quot;domain\\user&quot;</span> };</div>
<div class="line">_mockDaoUser.Setup(x =&gt; x.GetUserByWindowsUsernameAsync(<span class="stringliteral">&quot;domain\\user&quot;</span>))</div>
<div class="line">.ReturnsAsync(Model_Dao_Result_Factory.Success(user));</div>
<div class="line">_mockDaoUser.Setup(x =&gt; x.LogUserActivityAsync(It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>&gt;()))</div>
<div class="line">.ReturnsAsync(Model_Dao_Result_Factory.Success(<span class="keyword">true</span>));</div>
<div class="line">⋮----</div>
<div class="line">result.Success.Should().BeTrue();</div>
<div class="line">result.User.Should().BeEquivalentTo(user);</div>
<div class="line">_mockDaoUser.Verify(x =&gt; x.LogUserActivityAsync(<span class="stringliteral">&quot;login_success&quot;</span>, <span class="stringliteral">&quot;domain\\user&quot;</span>, It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>&gt;()), Times.Once);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task AuthenticateByPinAsync_InvalidInput_ReturnsError_Async(<span class="keywordtype">string</span> username, <span class="keywordtype">string</span> pin)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _sut.AuthenticateByPinAsync(username, pin);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task AuthenticateByPinAsync_ValidCredentials_ReturnsSuccess_Async()</div>
<div class="line">⋮----</div>
<div class="line">_mockDaoUser.Setup(x =&gt; x.ValidateUserPinAsync(<span class="stringliteral">&quot;user&quot;</span>, <span class="stringliteral">&quot;1234&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">var result = await _sut.AuthenticateByPinAsync(<span class="stringliteral">&quot;user&quot;</span>, <span class="stringliteral">&quot;1234&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">result.User.Should().Be(user);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task CreateNewUserAsync_InvalidData_ReturnsError_Async()</div>
<div class="line">⋮----</div>
<div class="line">var user = <span class="keyword">new</span> Model_User { WindowsUsername = <span class="stringliteral">&quot;&quot;</span> }; <span class="comment">// Missing fields</span></div>
<div class="line"><span class="comment">// Act</span></div>
<div class="line">var result = await _sut.CreateNewUserAsync(user, <span class="stringliteral">&quot;admin&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task CreateNewUserAsync_ValidData_ReturnsSuccess_Async()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User</div>
<div class="line">⋮----</div>
<div class="line">_mockDaoUser.Setup(x =&gt; x.CreateNewUserAsync(user, <span class="stringliteral">&quot;admin&quot;</span>))</div>
<div class="line">.ReturnsAsync(Model_Dao_Result_Factory.Success&lt;<span class="keywordtype">int</span>&gt;(101));</div>
<div class="line">⋮----</div>
<div class="line">result.EmployeeNumber.Should().Be(101);</div>
<div class="line">⋮----</div>
<div class="line">public async Task ValidatePinAsync_ValidatesCorrectly_Async(<span class="keywordtype">string</span> pin, <span class="keywordtype">bool</span> expectedValid)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _sut.ValidatePinAsync(pin);</div>
<div class="line">⋮----</div>
<div class="line">result.IsValid.Should().Be(expectedValid);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DetectWorkstationTypeAsync_SharedTerminal_ReturnsType_Async()</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Arrange</span></div>
<div class="line">⋮----</div>
<div class="line">_mockDaoUser.Setup(x =&gt; x.GetSharedTerminalNamesAsync())</div>
<div class="line">.ReturnsAsync(Model_Dao_Result_Factory.Success(new List&lt;<span class="keywordtype">string</span>&gt; { <span class="stringliteral">&quot;SHARED-PC&quot;</span> }));</div>
<div class="line">var result = await _sut.DetectWorkstationTypeAsync(computerName);</div>
<div class="line">result.WorkstationType.Should().Be(<span class="stringliteral">&quot;shared_terminal&quot;</span>);</div>
<div class="line">result.ComputerName.Should().Be(computerName);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task DetectWorkstationTypeAsync_PersonalWorkstation_ReturnsType_Async()</div>
<div class="line">⋮----</div>
<div class="line">result.WorkstationType.Should().Be(<span class="stringliteral">&quot;personal_workstation&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md370"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Services/Authentication/Service_UserSessionManager_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_UserSessionManager_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Service_UserSessionManager _sut;</div>
<div class="line">⋮----</div>
<div class="line">_mockDispatcher.Setup(x =&gt; x.CreateTimer()).Returns(_mockTimer.Object);</div>
<div class="line">_sut = <span class="keyword">new</span> Service_UserSessionManager(_mockDaoUser.Object, _mockDispatcher.Object);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> CreateSession_NullUser_ThrowsArgumentNullException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; _sut.CreateSession(null!, new Model_WorkstationConfig(<span class="stringliteral">&quot;PC&quot;</span>), <span class="stringliteral">&quot;Windows&quot;</span>);</div>
<div class="line">act.Should().Throw&lt;ArgumentNullException&gt;().WithParameterName(<span class="stringliteral">&quot;user&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> CreateSession_ValidData_SetsCurrentSession()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User { WindowsUsername = <span class="stringliteral">&quot;test&quot;</span> };</div>
<div class="line">var config = <span class="keyword">new</span> Model_WorkstationConfig(<span class="stringliteral">&quot;PC&quot;</span>) { WorkstationType = <span class="stringliteral">&quot;personal_workstation&quot;</span> };</div>
<div class="line">var session = _sut.CreateSession(user, config, <span class="stringliteral">&quot;Windows&quot;</span>);</div>
<div class="line">session.Should().NotBeNull();</div>
<div class="line">session.User.Should().Be(user);</div>
<div class="line">session.WorkstationName.Should().Be(<span class="stringliteral">&quot;PC&quot;</span>);</div>
<div class="line">session.TimeoutDuration.Should().Be(TimeSpan.FromMinutes(30));</div>
<div class="line">_sut.CurrentSession.Should().Be(session);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> StartTimeoutMonitoring_NoSession_ThrowsInvalidOperationException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; _sut.StartTimeoutMonitoring();</div>
<div class="line">act.Should().Throw&lt;InvalidOperationException&gt;();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> StartTimeoutMonitoring_WithSession_StartsTimer()</div>
<div class="line">⋮----</div>
<div class="line">_sut.CreateSession(new Model_User(), new Model_WorkstationConfig(<span class="stringliteral">&quot;PC&quot;</span>), <span class="stringliteral">&quot;Windows&quot;</span>);</div>
<div class="line">_sut.StartTimeoutMonitoring();</div>
<div class="line">_mockDispatcher.Verify(x =&gt; x.CreateTimer(), Times.Once);</div>
<div class="line">_mockTimer.Verify(x =&gt; x.Start(), Times.Once);</div>
<div class="line">_mockTimer.VerifySet(x =&gt; x.Interval = It.IsAny&lt;TimeSpan&gt;());</div>
<div class="line">_mockTimer.VerifySet(x =&gt; x.IsRepeating = true);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> StopTimeoutMonitoring_StopsTimer()</div>
<div class="line">⋮----</div>
<div class="line">_sut.StopTimeoutMonitoring();</div>
<div class="line">_mockTimer.Verify(x =&gt; x.Stop(), Times.Once);</div>
<div class="line">⋮----</div>
<div class="line">public async Task EndSessionAsync_LogsAndClearsSession_Async()</div>
<div class="line">⋮----</div>
<div class="line">_sut.CreateSession(user, new Model_WorkstationConfig(<span class="stringliteral">&quot;PC&quot;</span>), <span class="stringliteral">&quot;Windows&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_mockDaoUser.Setup(x =&gt; x.LogUserActivityAsync(It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>&gt;()))</div>
<div class="line">.ReturnsAsync(Model_Dao_Result_Factory.Success(true));</div>
<div class="line">await _sut.EndSessionAsync(<span class="stringliteral">&quot;Logout&quot;</span>);</div>
<div class="line">_sut.CurrentSession.Should().BeNull();</div>
<div class="line">⋮----</div>
<div class="line">_mockDaoUser.Verify(x =&gt; x.LogUserActivityAsync(<span class="stringliteral">&quot;Logout&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, <span class="stringliteral">&quot;PC&quot;</span>, It.IsNotNull&lt;<span class="keywordtype">string</span>&gt;()), Times.Once);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> UpdateLastActivity_UpdatesTimestamp()</div>
<div class="line">⋮----</div>
<div class="line">_sut.UpdateLastActivity();</div>
<div class="line">_sut.CurrentSession.LastActivityTimestamp.Should().BeOnOrAfter(initialTime);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md371"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Services/Database/Service_ErrorHandler_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_ErrorHandler_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Service_ErrorHandler _sut;</div>
<div class="line">⋮----</div>
<div class="line">_sut = <span class="keyword">new</span> Service_ErrorHandler(_mockLogger.Object, _mockWindowService.Object);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task LogErrorAsync_InfoSeverity_CallsLogInfo_Async()</div>
<div class="line">⋮----</div>
<div class="line">await _sut.LogErrorAsync(<span class="stringliteral">&quot;Test Info&quot;</span>, Enum_ErrorSeverity.Info);</div>
<div class="line">_mockLogger.Verify(x =&gt; x.LogInfo(<span class="stringliteral">&quot;Test Info&quot;</span>, It.IsAny&lt;<span class="keywordtype">string</span>?&gt;()), Times.Once);</div>
<div class="line">⋮----</div>
<div class="line">public async Task LogErrorAsync_ErrorSeverity_CallsLogError_Async()</div>
<div class="line">⋮----</div>
<div class="line">var ex = new Exception(<span class="stringliteral">&quot;Test Ex&quot;</span>);</div>
<div class="line">await _sut.LogErrorAsync(<span class="stringliteral">&quot;Test Error&quot;</span>, Enum_ErrorSeverity.Error, ex);</div>
<div class="line">_mockLogger.Verify(x =&gt; x.LogError(<span class="stringliteral">&quot;Test Error&quot;</span>, ex, It.IsAny&lt;<span class="keywordtype">string</span>?&gt;()), Times.Once);</div>
<div class="line">⋮----</div>
<div class="line">public async Task HandleErrorAsync_ShowDialogFalse_OnlyLogs_Async()</div>
<div class="line">⋮----</div>
<div class="line">await _sut.HandleErrorAsync(<span class="stringliteral">&quot;Test&quot;</span>, Enum_ErrorSeverity.Warning, null, false);</div>
<div class="line">_mockLogger.Verify(x =&gt; x.LogWarning(<span class="stringliteral">&quot;Test&quot;</span>, It.IsAny&lt;<span class="keywordtype">string</span>?&gt;()), Times.Once);</div>
<div class="line">_mockWindowService.Verify(x =&gt; x.GetXamlRoot(), Times.Never);</div>
<div class="line">⋮----</div>
<div class="line">public async Task HandleErrorAsync_ShowDialogTrue_LogsAndChecksWindow_Async()</div>
<div class="line">⋮----</div>
<div class="line">_mockWindowService.Setup(x =&gt; x.GetXamlRoot()).Returns((XamlRoot?)null);</div>
<div class="line">await _sut.HandleErrorAsync(<span class="stringliteral">&quot;Test&quot;</span>, Enum_ErrorSeverity.Error, null, true);</div>
<div class="line">_mockLogger.Verify(x =&gt; x.LogError(<span class="stringliteral">&quot;Test&quot;</span>, null, It.IsAny&lt;<span class="keywordtype">string</span>?&gt;()), Times.Once);</div>
<div class="line">_mockWindowService.Verify(x =&gt; x.GetXamlRoot(), Times.Once);</div>
<div class="line">_mockLogger.Verify(x =&gt; x.LogWarning(<span class="stringliteral">&quot;Cannot show dialog - XamlRoot is null&quot;</span>, It.IsAny&lt;<span class="keywordtype">string</span>?&gt;()), Times.Once);</div>
<div class="line">⋮----</div>
<div class="line">public async Task HandleDaoErrorAsync_SuccessResult_DoesNothing_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Success();</div>
<div class="line">await _sut.HandleDaoErrorAsync(result, <span class="stringliteral">&quot;TestOp&quot;</span>);</div>
<div class="line">_mockLogger.Verify(x =&gt; x.LogInfo(It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>?&gt;()), Times.Never);</div>
<div class="line">_mockLogger.Verify(x =&gt; x.LogError(It.IsAny&lt;<span class="keywordtype">string</span>&gt;(), It.IsAny&lt;Exception?&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>?&gt;()), Times.Never);</div>
<div class="line">⋮----</div>
<div class="line">public async Task HandleDaoErrorAsync_FailureResult_LogsError_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Failure(<span class="stringliteral">&quot;DB Fail&quot;</span>, new Exception(<span class="stringliteral">&quot;SQL Error&quot;</span>));</div>
<div class="line">⋮----</div>
<div class="line">await _sut.HandleDaoErrorAsync(result, <span class="stringliteral">&quot;TestOp&quot;</span>, true);</div>
<div class="line">_mockLogger.Verify(x =&gt; x.LogError(It.Is&lt;<span class="keywordtype">string</span>&gt;(s =&gt; s.Contains(<span class="stringliteral">&quot;DB Fail&quot;</span>) &amp;&amp; s.Contains(<span class="stringliteral">&quot;TestOp&quot;</span>)), It.IsAny&lt;Exception&gt;(), It.IsAny&lt;<span class="keywordtype">string</span>?&gt;()), Times.Once);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md372"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Services/Help/Service_Help_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Help_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Service_Help _sut;</div>
<div class="line">⋮----</div>
<div class="line">_sut = <span class="keyword">new</span> Service_Help(_mockWindow.Object, _mockLogger.Object, _mockDispatcher.Object);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> GetHelpContent_ExistingKey_ReturnsContent()</div>
<div class="line">⋮----</div>
<div class="line">var content = _sut.GetHelpContent(<span class="stringliteral">&quot;Dunnage.ModeSelection&quot;</span>);</div>
<div class="line">content.Should().NotBeNull();</div>
<div class="line">content?.Title.Should().Be(<span class="stringliteral">&quot;Select Entry Mode&quot;</span>);</div>
<div class="line">content?.Key.Should().Be(<span class="stringliteral">&quot;Dunnage.ModeSelection&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> GetHelpContent_NonExistentKey_ReturnsNull()</div>
<div class="line">⋮----</div>
<div class="line">var content = _sut.GetHelpContent(<span class="stringliteral">&quot;NonExistentKey&quot;</span>);</div>
<div class="line">content.Should().BeNull();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> GetHelpByCategory_ReturnsFilteredList()</div>
<div class="line">⋮----</div>
<div class="line">var list = _sut.GetHelpByCategory(<span class="stringliteral">&quot;Dunnage Workflow&quot;</span>);</div>
<div class="line">list.Should().NotBeEmpty();</div>
<div class="line">list.All(x =&gt; x.Category == <span class="stringliteral">&quot;Dunnage Workflow&quot;</span>).Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> SearchHelp_ReturnsMatchingItems()</div>
<div class="line">⋮----</div>
<div class="line">var results = _sut.SearchHelp(<span class="stringliteral">&quot;dunnage&quot;</span>);</div>
<div class="line">results.Should().NotBeEmpty();</div>
<div class="line">results.Should().Contain(x =&gt; x.Title.ToLower().Contains(<span class="stringliteral">&quot;dunnage&quot;</span>) || x.Content.ToLower().Contains(<span class="stringliteral">&quot;dunnage&quot;</span>));</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> SearchHelp_EmptyTerm_ReturnsEmptyList()</div>
<div class="line">⋮----</div>
<div class="line">var results = _sut.SearchHelp(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="comment">// Assert</span></div>
<div class="line">results.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> TipRetreival_ReturnsContent()</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Act</span></div>
<div class="line">var tip = _sut.GetTip(<span class="stringliteral">&quot;Dunnage.QuantityEntry&quot;</span>);</div>
<div class="line">tip.Should().NotBeNullOrEmpty();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md373"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Services/UI/Service_ViewModelRegistry_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_ViewModelRegistry_Tests</div>
<div class="line">⋮----</div>
<div class="line">private class TestViewModel : IResettableViewModel</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ResetToDefaults() =&gt; ResetCalled = true;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> class AnotherViewModel { }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Register_and_GetViewModels_WorksCorrectly()</div>
<div class="line">⋮----</div>
<div class="line">var sut = new Service_ViewModelRegistry();</div>
<div class="line">var vm1 = new TestViewModel();</div>
<div class="line">var vm2 = new AnotherViewModel();</div>
<div class="line">sut.Register(vm1);</div>
<div class="line">sut.Register(vm2);</div>
<div class="line">var retrieved = sut.GetViewModels&lt;TestViewModel&gt;().ToList();</div>
<div class="line">retrieved.Should().HaveCount(1);</div>
<div class="line">retrieved.First().Should().Be(vm1);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ClearAllInputs_CallsResetOnResettableVMs()</div>
<div class="line">⋮----</div>
<div class="line">sut.ClearAllInputs();</div>
<div class="line">vm1.ResetCalled.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Cleanup_RemovesDeadReferences()</div>
<div class="line">⋮----</div>
<div class="line">var vm = new TestViewModel();</div>
<div class="line">sut.Register(vm);</div>
<div class="line">⋮----</div>
<div class="line">GC.Collect();</div>
<div class="line">GC.WaitForPendingFinalizers();</div>
<div class="line">var list = sut.GetViewModels&lt;TestViewModel&gt;().ToList();</div>
<div class="line">list.Should().BeEmpty();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md374"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_Application_Variables_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_Application_Variables_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_SetsSensibleValues()</div>
<div class="line">⋮----</div>
<div class="line">var config = <span class="keyword">new</span> Model_Application_Variables();</div>
<div class="line">config.ApplicationName.Should().NotBeEmpty();</div>
<div class="line">config.Version.Should().MatchRegex(<span class="stringliteral">@&quot;\d+\.\d+\.\d+&quot;</span>);</div>
<div class="line">config.ConnectionString.Should().BeEmpty();</div>
<div class="line">config.EnvironmentType.Should().Be(<span class="stringliteral">&quot;Development&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> LogDirectory_Default_IsInAppData()</div>
<div class="line">⋮----</div>
<div class="line">var appData = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);</div>
<div class="line">config.LogDirectory.Should().StartWith(appData);</div>
<div class="line">config.LogDirectory.Should().Contain(<span class="stringliteral">&quot;MTM_Receiving_Application&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md375"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_CSVDeleteResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_CSVDeleteResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Properties_SetAndGet_WorksCorrectly()</div>
<div class="line">⋮----</div>
<div class="line">var result = <span class="keyword">new</span> Model_CSVDeleteResult();</div>
<div class="line">⋮----</div>
<div class="line">result.LocalDeleted.Should().BeTrue();</div>
<div class="line">result.NetworkDeleted.Should().BeFalse();</div>
<div class="line">result.LocalError.Should().BeNull();</div>
<div class="line">result.NetworkError.Should().Be(<span class="stringliteral">&quot;Access Denied&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md376"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_CSVExistenceResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_CSVExistenceResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Properties_SetAndGet_Works()</div>
<div class="line">⋮----</div>
<div class="line">var result = <span class="keyword">new</span> Model_CSVExistenceResult();</div>
<div class="line">⋮----</div>
<div class="line">result.LocalExists.Should().BeTrue();</div>
<div class="line">result.NetworkExists.Should().BeTrue();</div>
<div class="line">result.NetworkAccessible.Should().BeTrue();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md377"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_CSVWriteResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_CSVWriteResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var result = <span class="keyword">new</span> Model_CSVWriteResult();</div>
<div class="line">result.LocalSuccess.Should().BeFalse();</div>
<div class="line">result.NetworkSuccess.Should().BeFalse();</div>
<div class="line">result.ErrorMessage.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> IsFullSuccess_ReturnsTrueOnlyIfBothSucceed()</div>
<div class="line">⋮----</div>
<div class="line">var result = new Model_CSVWriteResult</div>
<div class="line">⋮----</div>
<div class="line">result.IsFullSuccess.Should().BeTrue();</div>
<div class="line">result.IsPartialSuccess.Should().BeFalse();</div>
<div class="line">result.IsFailure.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsPartialSuccess_ReturnsTrueOnlyIfLocalSucceedsButNetworkFails()</div>
<div class="line">⋮----</div>
<div class="line">result.IsFullSuccess.Should().BeFalse();</div>
<div class="line">result.IsPartialSuccess.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsFailure_ReturnsTrueIfLocalFails()</div>
<div class="line">⋮----</div>
<div class="line">result.IsFailure.Should().BeTrue();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md378"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_InforVisualPart_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_InforVisualPart_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void DisplayText_FormatsCorrectly()</div>
<div class="line">⋮----</div>
<div class="line">var part = <span class="keyword">new</span> Model_InforVisualPart</div>
<div class="line">⋮----</div>
<div class="line">text.Should().Be(<span class="stringliteral">&quot;PART-01 - A Widget (Line 001)&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var part = new Model_InforVisualPart();</div>
<div class="line">part.UnitOfMeasure.Should().Be(<span class="stringliteral">&quot;EA&quot;</span>);</div>
<div class="line">part.QtyOrdered.Should().Be(0);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md379"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_InforVisualPO_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_InforVisualPO_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var po = <span class="keyword">new</span> Model_InforVisualPO();</div>
<div class="line">po.Parts.Should().NotBeNull().And.BeEmpty();</div>
<div class="line">po.HasParts.Should().BeFalse();</div>
<div class="line">po.PONumber.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> HasParts_ReturnsTrueOnlyWhenPartsExist()</div>
<div class="line">⋮----</div>
<div class="line">po.Parts.Add(new Model_InforVisualPart());</div>
<div class="line">po.HasParts.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> StatusDescription_MapsCodesCorrectly(<span class="keywordtype">string</span> code, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var po = new Model_InforVisualPO { Status = code };</div>
<div class="line">⋮----</div>
<div class="line">desc.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> IsClosed_ReturnsTrueForClosedOrCancelled(<span class="keywordtype">string</span> status, <span class="keywordtype">bool</span> expected)</div>
<div class="line">⋮----</div>
<div class="line">var po = <span class="keyword">new</span> Model_InforVisualPO { Status = status };</div>
<div class="line">⋮----</div>
<div class="line">isClosed.Should().Be(expected);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md380"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_PackageTypePreference_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_PackageTypePreference_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var model = <span class="keyword">new</span> Model_PackageTypePreference();</div>
<div class="line">model.PartID.Should().BeEmpty();</div>
<div class="line">model.PackageTypeName.Should().BeEmpty();</div>
<div class="line">model.LastModified.Should().BeCloseTo(DateTime.UtcNow, TimeSpan.FromSeconds(10));</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md381"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_ReceivingLine_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingLine_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var line = <span class="keyword">new</span> Model_ReceivingLine();</div>
<div class="line">line.Date.Should().BeCloseTo(DateTime.Now, TimeSpan.FromSeconds(1));</div>
<div class="line">line.LabelNumber.Should().Be(1);</div>
<div class="line">line.TotalLabels.Should().Be(1);</div>
<div class="line">line.VendorName.Should().Be(<span class="stringliteral">&quot;Unknown&quot;</span>);</div>
<div class="line">line.PartID.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> LabelText_ReturnsFormattedString()</div>
<div class="line">⋮----</div>
<div class="line">var line = new Model_ReceivingLine</div>
<div class="line">⋮----</div>
<div class="line">text.Should().Be(<span class="stringliteral">&quot;2 / 5&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> LabelText_UpdatesWhenPropertiesChange()</div>
<div class="line">⋮----</div>
<div class="line">line.LabelText.Should().Be(<span class="stringliteral">&quot;3 / 10&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md382"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_ReceivingLoad_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingLoad_Tests</div>
<div class="line">⋮----</div>
<div class="line">private Model_ReceivingLoad _sut;</div>
<div class="line">⋮----</div>
<div class="line">_sut = <span class="keyword">new</span> Model_ReceivingLoad();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_Initialization_SetsDefaults()</div>
<div class="line">⋮----</div>
<div class="line">var model = new Model_ReceivingLoad();</div>
<div class="line">model.LoadID.Should().NotBeEmpty();</div>
<div class="line">model.PartID.Should().BeEmpty();</div>
<div class="line">model.HeatLotNumber.Should().BeEmpty();</div>
<div class="line">model.ReceivedDate.Should().BeCloseTo(DateTime.Now, TimeSpan.FromSeconds(1));</div>
<div class="line">model.PackageType.Should().Be(Enum_PackageType.Skid);</div>
<div class="line">model.PackageTypeName.Should().Be(<span class="stringliteral">&quot;Skid&quot;</span>);</div>
<div class="line">model.PackagesPerLoad.Should().Be(0);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PartID_WhenChanged_SetsPackagesPerLoadToOneIfZero()</div>
<div class="line">⋮----</div>
<div class="line">_sut.PackagesPerLoad.Should().Be(1);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PartID_WhenChangedToMMC_SetsPackageTypeToCoil()</div>
<div class="line">⋮----</div>
<div class="line">_sut.PackageType.Should().Be(Enum_PackageType.Coil);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PartID_WhenChangedToMMF_SetsPackageTypeToSheet()</div>
<div class="line">⋮----</div>
<div class="line">_sut.PackageType.Should().Be(Enum_PackageType.Sheet);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PartID_WhenSetToEmptyOrNull_DoesNotChangePackageType(<span class="keywordtype">string</span> partId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Arrange</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Act</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Assert</span></div>
<div class="line">_sut.PackageType.Should().Be(Enum_PackageType.Skid);</div>
<div class="line">_sut.PackagesPerLoad.Should().Be(0);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// ====================================================================</span></div>
<div class="line"><span class="comment">// Property Logic: PackageType / PackageTypeName</span></div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PackageType_WhenChanged_UpdatesPackageTypeName()</div>
<div class="line">⋮----</div>
<div class="line">_sut.PackageTypeName.Should().Be(<span class="stringliteral">&quot;Box&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PackageTypeName_WhenChangedToValidEnum_UpdatesPackageType()</div>
<div class="line">⋮----</div>
<div class="line">_sut.PackageType.Should().Be(Enum_PackageType.Box);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PackageTypeName_WhenChangedToInvalidEnum_DoesNotUpdatePackageType()</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> CalculateWeightPerPackage_UpdatesUsingWeightAndPackages(decimal weight, <span class="keywordtype">int</span> packages, decimal expected)</div>
<div class="line">⋮----</div>
<div class="line">_sut.WeightPerPackage.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> CalculateWeightPerPackage_WhenPackagesIsZero_SetResultToZero()</div>
<div class="line">⋮----</div>
<div class="line">_sut.WeightPerPackage.Should().Be(0);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> WeightPerPackageDisplay_FormattedCorrectly()</div>
<div class="line">⋮----</div>
<div class="line">display.Should().Be(<span class="stringliteral">&quot;50 lbs per Box&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PONumberDisplay_WhenNullOrEmpty_ReturnsNA()</div>
<div class="line">⋮----</div>
<div class="line">display.Should().Be(<span class="stringliteral">&quot;N/A&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> PONumberDisplay_WhenValid_ReturnsPONumber()</div>
<div class="line">⋮----</div>
<div class="line">display.Should().Be(<span class="stringliteral">&quot;12345&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md383"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_ReceivingSession_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingSession_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var session = <span class="keyword">new</span> Model_ReceivingSession();</div>
<div class="line">session.SessionID.Should().NotBeEmpty();</div>
<div class="line">session.CreatedDate.Should().BeCloseTo(DateTime.Now, TimeSpan.FromSeconds(1));</div>
<div class="line">session.Loads.Should().NotBeNull().And.BeEmpty();</div>
<div class="line">session.TotalLoadsCount.Should().Be(0);</div>
<div class="line">session.TotalWeightQuantity.Should().Be(0);</div>
<div class="line">session.HasLoads.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> TotalWeightQuantity_CalculatesSumCorrectly()</div>
<div class="line">⋮----</div>
<div class="line">session.Loads.Add(new Model_ReceivingLoad { WeightQuantity = 100 });</div>
<div class="line">session.Loads.Add(<span class="keyword">new</span> Model_ReceivingLoad { WeightQuantity = 250 });</div>
<div class="line">⋮----</div>
<div class="line">total.Should().Be(350);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> UniqueParts_ReturnsDistinctList()</div>
<div class="line">⋮----</div>
<div class="line">session.Loads.Add(new Model_ReceivingLoad { PartID = <span class="stringliteral">&quot;PART-A&quot;</span> });</div>
<div class="line">⋮----</div>
<div class="line">session.Loads.Add(<span class="keyword">new</span> Model_ReceivingLoad { PartID = <span class="stringliteral">&quot;PART-B&quot;</span> });</div>
<div class="line">⋮----</div>
<div class="line">parts.Should().HaveCount(2);</div>
<div class="line">parts.Should().Contain(<span class="stringliteral">&quot;PART-A&quot;</span>);</div>
<div class="line">parts.Should().Contain(<span class="stringliteral">&quot;PART-B&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> HasLoads_ReturnsTrueWhenLoadsExist()</div>
<div class="line">⋮----</div>
<div class="line">session.Loads.Add(new Model_ReceivingLoad());</div>
<div class="line">⋮----</div>
<div class="line">hasLoads.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> TransientProperties_HandleNullLoadsForSafety()</div>
<div class="line">⋮----</div>
<div class="line">var session = new Model_ReceivingSession</div>
<div class="line">⋮----</div>
<div class="line">session.UniqueParts.Should().NotBeNull().And.BeEmpty();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md384"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_ReceivingValidationResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingValidationResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreSafe()</div>
<div class="line">⋮----</div>
<div class="line">var result = <span class="keyword">new</span> Model_ReceivingValidationResult();</div>
<div class="line">result.IsValid.Should().BeFalse();</div>
<div class="line">result.Severity.Should().Be(Enum_ValidationSeverity.Error);</div>
<div class="line">result.Message.Should().BeEmpty();</div>
<div class="line">result.Errors.Should().NotBeNull().And.BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Success_Factory_ReturnsValidObject()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ReceivingValidationResult.Success();</div>
<div class="line">result.IsValid.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">result.Errors.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Error_Factory_ReturnsErrorObject()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ReceivingValidationResult.Error(msg);</div>
<div class="line">⋮----</div>
<div class="line">result.Message.Should().Be(msg);</div>
<div class="line">result.Errors.Should().Contain(msg);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Warning_Factory_ReturnsWarningObject()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ReceivingValidationResult.Warning(msg);</div>
<div class="line">result.IsValid.Should().BeTrue(<span class="stringliteral">&quot;Warnings should not block validity&quot;</span>);</div>
<div class="line">result.Severity.Should().Be(Enum_ValidationSeverity.Warning);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md385"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_ReceivingWorkflowStepResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_ReceivingWorkflowStepResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var result = <span class="keyword">new</span> Model_ReceivingWorkflowStepResult();</div>
<div class="line">result.Success.Should().BeFalse();</div>
<div class="line">result.Message.Should().BeEmpty();</div>
<div class="line">result.ValidationErrors.Should().NotBeNull().And.BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> SuccessResult_Factory_CreatesSuccessObject()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ReceivingWorkflowStepResult.SuccessResult(step, message);</div>
<div class="line">result.Success.Should().BeTrue();</div>
<div class="line">result.NewStep.Should().Be(step);</div>
<div class="line">result.Message.Should().Be(message);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ErrorResult_Factory_CreatesErrorObject()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ReceivingWorkflowStepResult.ErrorResult(errors);</div>
<div class="line">⋮----</div>
<div class="line">result.ValidationErrors.Should().BeEquivalentTo(errors);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md386"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_SaveResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_SaveResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var result = <span class="keyword">new</span> Model_SaveResult();</div>
<div class="line">result.Success.Should().BeFalse();</div>
<div class="line">result.LoadsSaved.Should().Be(0);</div>
<div class="line">result.LocalCSVSuccess.Should().BeFalse();</div>
<div class="line">result.NetworkCSVSuccess.Should().BeFalse();</div>
<div class="line">result.DatabaseSuccess.Should().BeFalse();</div>
<div class="line">result.Errors.Should().BeEmpty();</div>
<div class="line">result.Warnings.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> IsFullSuccess_WhenAllTrue_ReturnsTrue()</div>
<div class="line">⋮----</div>
<div class="line">var result = new Model_SaveResult</div>
<div class="line">⋮----</div>
<div class="line">result.IsFullSuccess.Should().BeTrue();</div>
<div class="line">result.IsPartialSuccess.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsFullSuccess_WhenAnyFalse_ReturnsFalse(<span class="keywordtype">bool</span> local, <span class="keywordtype">bool</span> network, <span class="keywordtype">bool</span> db)</div>
<div class="line">⋮----</div>
<div class="line">result.IsFullSuccess.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsPartialSuccess_WhenMixedSuccessMatchesCriteria_ReturnsTrue(<span class="keywordtype">bool</span> local, <span class="keywordtype">bool</span> network, <span class="keywordtype">bool</span> db)</div>
<div class="line">⋮----</div>
<div class="line">result.IsPartialSuccess.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsPartialSuccess_WhenFullSuccess_ReturnsFalse()</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsPartialSuccess_WhenNoSuccess_ReturnsFalse()</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> LegacyProperties_MapToNewProperties()</div>
<div class="line">⋮----</div>
<div class="line">result.LoadsSaved.Should().Be(10);</div>
<div class="line">result.Success.Should().BeTrue();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md387"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_UserPreference_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_UserPreference_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var prefs = <span class="keyword">new</span> Model_UserPreference();</div>
<div class="line">prefs.Username.Should().BeEmpty();</div>
<div class="line">prefs.PreferredPackageType.Should().Be(<span class="stringliteral">&quot;Package&quot;</span>);</div>
<div class="line">prefs.Workstation.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Properties_NotifyChanges()</div>
<div class="line">⋮----</div>
<div class="line">propertyChanged.Should().BeTrue();</div>
<div class="line">prefs.Username.Should().Be(<span class="stringliteral">&quot;NewUser&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md388"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Models/Model_WorkflowStepResult_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_WorkflowStepResult_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Defaults_AreCorrect()</div>
<div class="line">⋮----</div>
<div class="line">var model = <span class="keyword">new</span> Model_WorkflowStepResult();</div>
<div class="line">model.IsSuccess.Should().BeFalse();</div>
<div class="line">model.ErrorMessage.Should().BeEmpty();</div>
<div class="line">model.TargetStep.Should().BeNull();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Properties_SetAndGet_WorksCorrectly()</div>
<div class="line">⋮----</div>
<div class="line">model.IsSuccess.Should().BeTrue();</div>
<div class="line">model.ErrorMessage.Should().Be(<span class="stringliteral">&quot;Operation successful&quot;</span>);</div>
<div class="line">model.TargetStep.Should().Be(step);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md389"></a>
File: Module_Core/Contracts/Services/IService_Authentication.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IService_Authentication</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_AuthenticationResult&gt; AuthenticateByWindowsUsernameAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_AuthenticationResult&gt; AuthenticateByPinAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_CreateUserResult&gt; CreateNewUserAsync(</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_ValidationResult&gt; ValidatePinAsync(string pin, int? excludeEmployeeNumber = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_WorkstationConfig&gt; DetectWorkstationTypeAsync(<span class="keywordtype">string</span>? computerName = <span class="keyword">null</span>);</div>
<div class="line"><span class="keyword">public</span> Task&lt;List&lt;string&gt;&gt; GetActiveDepartmentsAsync();</div>
<div class="line"><span class="keyword">public</span> Task LogUserActivityAsync(<span class="keywordtype">string</span> eventType, <span class="keywordtype">string</span> username, <span class="keywordtype">string</span> workstationName, <span class="keywordtype">string</span> details);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md390"></a>
File: Module_Core/Converters/Converter_EnumToVisibility.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_EnumToVisibility : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">var enumValue = value.ToString();</div>
<div class="line">var targetValue = parameter.ToString();</div>
<div class="line">return string.Equals(enumValue, targetValue, StringComparison.OrdinalIgnoreCase)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md391"></a>
File: Module_Core/Converters/Converter_IntToVisibility.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_IntToVisibility : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">if (paramStr.Equals(&quot;Inverse&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">else if (int.TryParse(paramStr, out int paramInt))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md392"></a>
File: Module_Core/Converters/NullableDoubleToDoubleConverter.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>NullableDoubleToDoubleConverter : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object? ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md393"></a>
File: Module_Core/Helpers/Database/Helper_Database_StoredProcedure.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Helper_Database_StoredProcedure</div>
<div class="line">⋮----</div>
<div class="line">public static async Task&lt;Model_Dao_Result&gt; ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line">var result = <span class="keyword">new</span> Model_Dao_Result();</div>
<div class="line">var stopwatch = Stopwatch.StartNew();</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using </span>var connection = <span class="keyword">new</span> MySqlConnection(connectionString);</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">await <span class="keyword">using </span>var command = <span class="keyword">new</span> MySqlCommand(procedureName, connection)</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddRange(parameters);</div>
<div class="line">⋮----</div>
<div class="line">var affectedRows = await command.ExecuteNonQueryAsync();</div>
<div class="line">⋮----</div>
<div class="line">stopwatch.Stop();</div>
<div class="line">⋮----</div>
<div class="line">await Task.Delay(RetryDelaysMs[attempt - 1]);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Stored procedure &#39;{procedureName}&#39; failed: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Stored procedure &#39;{procedureName}&#39; failed after {MaxRetries} attempts&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> ValidateParameters(MySqlParameter[]? parameters)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> async Task&lt;Model_Dao_Result&gt; ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] ExecuteNonQueryAsync: {procedureName} (Attempt {attempt}/{MaxRetries})&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Executing: {procedureName}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB]   {param.ParameterName} = {valueDisplay} ({param.Value?.GetType().Name ?? &quot;</span>DBNull<span class="stringliteral">&quot;})&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Success: {affectedRows} rows affected in {stopwatch.ElapsedMilliseconds}ms&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> async Task&lt;Model_Dao_Result&lt;T&gt;&gt; ExecuteSingleAsync&lt;T&gt;(</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] ExecuteSingleAsync: {procedureName} (Attempt {attempt}/{MaxRetries})&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using</span> var reader = await command.ExecuteReaderAsync();</div>
<div class="line">if (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Success: 1 record found in {stopwatch.ElapsedMilliseconds}ms&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] No record found&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] ERROR in ExecuteSingleAsync: {procedureName}&quot;</span>);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Error Type: {ex.GetType().Name}&quot;</span>);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Error Message: {ex.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] MySQL Error {sqlEx.Number}: {errorDesc}&quot;</span>);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] SQL State: {sqlEx.SqlState}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> async Task&lt;Model_Dao_Result&lt;List&lt;T&gt;&gt;&gt; ExecuteListAsync&lt;T&gt;(</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] ExecuteListAsync: {procedureName} (Attempt {attempt}/{MaxRetries})&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">while (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">list.Add(mapper(reader));</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Success: {list.Count} records retrieved in {stopwatch.ElapsedMilliseconds}ms&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] ERROR in ExecuteListAsync: {procedureName}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] MySQL Error Code: {sqlEx.Number}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> async Task&lt;Model_Dao_Result&lt;DataTable&gt;&gt; ExecuteDataTableAsync(</div>
<div class="line">⋮----</div>
<div class="line">var dataTable = <span class="keyword">new</span> DataTable();</div>
<div class="line">dataTable.Load(reader);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> async Task&lt;Model_Dao_Result&gt; ExecuteInTransactionAsync(</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using</span> var command = <span class="keyword">new</span> MySqlCommand(procedureName, connection, transaction)</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Executing SP: {procedureName}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB]   Parameter: {param.ParameterName} = {valueDisplay} (Type: {param.MySqlDbType})&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] MySQL ERROR {sqlEx.Number}: {errorDesc}&quot;</span>);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Error Message: {sqlEx.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Procedure: {procedureName}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] ERROR: {ex.GetType().Name}: {ex.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">void</span> AddParameters(MySqlCommand command, Dictionary&lt;string, object&gt;? parameters)</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] Adding {parameters.Count} parameters:&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">string</span> paramName = param.Key.StartsWith(<span class="stringliteral">&quot;p_&quot;</span>) ? <span class="stringliteral">&quot;@&quot;</span> + param.Key : <span class="stringliteral">&quot;@p_&quot;</span> + param.Key;</div>
<div class="line"><span class="keywordtype">string</span> cleanName = param.Key.TrimStart(<span class="charliteral">&#39;@&#39;</span>);</div>
<div class="line"><span class="keywordtype">string</span> finalName = cleanName.StartsWith(<span class="stringliteral">&quot;p_&quot;</span>) ? <span class="stringliteral">&quot;@&quot;</span> + cleanName : <span class="stringliteral">&quot;@p_&quot;</span> + cleanName;</div>
<div class="line">⋮----</div>
<div class="line">param.Value.ToString();</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB]   {param.Key} → {finalName} = {valueDisplay} ({param.Value?.GetType().Name ?? &quot;</span><span class="keyword">null</span><span class="stringliteral">&quot;})&quot;</span>);</div>
<div class="line">command.Parameters.AddWithValue(finalName, param.Value ?? DBNull.Value);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($<span class="stringliteral">&quot;[DB] No parameters provided&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> GetMySqlErrorDescription(<span class="keywordtype">int</span> errorCode)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> IsTransientError(MySqlException ex)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md394"></a>
File: Module_Core/Models/Systems/Model_User.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_User</div>
<div class="line">⋮----</div>
<div class="line">public bool HasErpAccess =&gt; !<span class="keywordtype">string</span>.IsNullOrWhiteSpace(VisualUsername);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md395"></a>
File: Module_Core/Services/Startup/Service_OnStartup_AppLifecycle.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_OnStartup_AppLifecycle : IService_OnStartup_AppLifecycle</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IServiceProvider _serviceProvider;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Authentication _authService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">private</span> readonly IService_CSVWriter _csvWriter;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task StartAsync()</div>
<div class="line">⋮----</div>
<div class="line">_splashScreen.Activate();</div>
<div class="line">⋮----</div>
<div class="line">await Task.Delay(100);</div>
<div class="line">⋮----</div>
<div class="line">await Task.Delay(300);</div>
<div class="line">⋮----</div>
<div class="line">var userCheckResult = await _authService.AuthenticateByWindowsUsernameAsync(windowsUser);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// If user doesn&#39;t exist, create account first (before workstation detection)</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Show New User Setup Dialog as child of splash screen</span></div>
<div class="line">⋮----</div>
<div class="line">newUserViewModel.CreatedBy = windowsUser; <span class="comment">// Self-creation (physical presence is authorization)</span></div>
<div class="line">var newUserDialog = new View_Shared_NewUserSetupDialog(newUserViewModel);</div>
<div class="line"><span class="comment">// Set splash screen as parent</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Show dialog and wait for result</span></div>
<div class="line">var dialogResult = await newUserDialog.ShowAsync();</div>
<div class="line"><span class="comment">// Check result</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Account created successfully - re-authenticate to get full user data</span></div>
<div class="line">⋮----</div>
<div class="line">userCheckResult = await _authService.AuthenticateByWindowsUsernameAsync(windowsUser);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Resilience: if the DB lookup doesn&#39;t immediately return the user (e.g. mismatch or timing),</span></div>
<div class="line"><span class="comment">// continue startup with the known data instead of shutting down.</span></div>
<div class="line">authenticatedUser = new Model_User</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// User cancelled account creation - close app properly</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Close splash screen</span></div>
<div class="line">⋮----</div>
<div class="line">_splashScreen.Close();</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Close main window if it exists</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Exit application properly</span></div>
<div class="line">Application.Current.Exit();</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// User exists - use existing user account</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Ensure first-run never proceeds with missing defaults.</span></div>
<div class="line"><span class="comment">// Database schema may be mid-migration; apply safe app-level defaults.</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// 4. Detect Workstation (50%)</span></div>
<div class="line">⋮----</div>
<div class="line">var workstationConfig = await _authService.DetectWorkstationTypeAsync();</div>
<div class="line"><span class="comment">// Debug logging</span></div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Workstation: {workstationConfig.ComputerName}&quot;);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Type: {workstationConfig.WorkstationType}&quot;);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Is Shared: {workstationConfig.IsSharedTerminal}&quot;);</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Is Personal: {workstationConfig.IsPersonalWorkstation}&quot;);</div>
<div class="line"><span class="comment">// 5. Determine authentication method based on workstation type (55-80%)</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Personal workstation - use Windows auto-login</span></div>
<div class="line">⋮----</div>
<div class="line">var loginDialog = new View_Shared_SharedTerminalLoginDialog(loginViewModel);</div>
<div class="line">⋮----</div>
<div class="line">var dialogResult = await loginDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">Microsoft.Windows.AppLifecycle.AppInstance.GetCurrent().UnregisterKey();</div>
<div class="line">System.Environment.Exit(0);</div>
<div class="line">⋮----</div>
<div class="line">_sessionManager.CreateSession(authenticatedUser, workstationConfig, authMethod);</div>
<div class="line">_sessionManager.StartTimeoutMonitoring();</div>
<div class="line">⋮----</div>
<div class="line">mainWin.DispatcherQueue.TryEnqueue(() =&gt; mainWin.UpdateUserDisplay());</div>
<div class="line">⋮----</div>
<div class="line">await Task.Delay(500);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Startup failed&quot;, Models.Enums.Enum_ErrorSeverity.Critical, ex);</div>
<div class="line">⋮----</div>
<div class="line">System.Environment.Exit(1);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdateSplash(double percentage, string message)</div>
<div class="line">⋮----</div>
<div class="line">_splashScreen?.ViewModel.UpdateProgress(percentage, message);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SetSplashIndeterminate(string message)</div>
<div class="line">⋮----</div>
<div class="line">_splashScreen?.ViewModel.SetIndeterminate(message);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> static void ApplySafeUserDefaults(Model_User? user)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(user.DefaultReceivingMode))</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(user.DefaultDunnageMode))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md396"></a>
File: Module_Dunnage/Data/Dao_DunnageCustomField.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_DunnageCustomField</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertAsync(int typeId, Model_CustomFieldDefinition field, string user)</div>
<div class="line">⋮----</div>
<div class="line">var pNewId = <span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_new_id&quot;</span>, MySqlDbType.Int32)</div>
<div class="line">⋮----</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_type_id&quot;</span>, typeId),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_field_name&quot;</span>, field.FieldName),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_field_type&quot;</span>, field.FieldType),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_display_order&quot;</span>, field.DisplayOrder),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_is_required&quot;</span>, field.IsRequired),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_user&quot;</span>, user),</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success&lt;<span class="keywordtype">int</span>&gt;(Convert.ToInt32(pNewId.Value));</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_CustomFieldDefinition&gt;&gt;&gt; GetByTypeAsync(<span class="keywordtype">int</span> typeId)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> fieldId)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">private Model_CustomFieldDefinition MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_CustomFieldDefinition</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">FieldName = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;field_name&quot;</span>)),</div>
<div class="line">FieldType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;field_type&quot;</span>)),</div>
<div class="line">DisplayOrder = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;display_order&quot;</span>)),</div>
<div class="line">IsRequired = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_required&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md397"></a>
File: Module_Dunnage/Data/Dao_DunnageLoad.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_DunnageLoad</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageLoad&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageLoad&gt;&gt;&gt; GetByDateRangeAsync(DateTime startDate, DateTime endDate)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;Model_DunnageLoad&gt;&gt; GetByIdAsync(Guid loadUuid)</div>
<div class="line">⋮----</div>
<div class="line">{ <span class="stringliteral">&quot;load_uuid&quot;</span>, loadUuid.ToString() }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&gt; InsertAsync(Guid loadUuid, <span class="keywordtype">string</span> partId, decimal quantity, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line">{ <span class="stringliteral">&quot;load_uuid&quot;</span>, loadUuid.ToString() },</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&gt; InsertBatchAsync(List&lt;Model_DunnageLoad&gt; loads, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line">var uniquePartIds = loads.Select(l =&gt; l.PartId).Distinct().ToList();</div>
<div class="line">var daoPart = <span class="keyword">new</span> Dao_DunnagePart(_connectionString);</div>
<div class="line">⋮----</div>
<div class="line">var partResult = await daoPart.GetByIdAsync(partId);</div>
<div class="line">⋮----</div>
<div class="line">invalidParts.Add(partId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_Dao_Result</div>
<div class="line">⋮----</div>
<div class="line">ErrorMessage = $<span class="stringliteral">&quot;Cannot save loads: The following Part ID(s) have not been registered in the system: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, invalidParts)}. &quot;</span> +</div>
<div class="line">⋮----</div>
<div class="line">loadData.Add(<span class="keyword">new</span></div>
<div class="line">⋮----</div>
<div class="line">load_uuid = load.LoadUuid.ToString(),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">string</span> json = JsonSerializer.Serialize(loadData);</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">if (result.ErrorMessage.Contains(<span class="stringliteral">&quot;FK_dunnage_history_part_id&quot;</span>) ||</div>
<div class="line">result.ErrorMessage.Contains(<span class="stringliteral">&quot;foreign key constraint&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&gt; UpdateAsync(Guid loadUuid, decimal quantity, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&gt; DeleteAsync(Guid loadUuid)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_DunnageLoad MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_DunnageLoad</div>
<div class="line">⋮----</div>
<div class="line">LoadUuid = (Guid)reader[reader.GetOrdinal(<span class="stringliteral">&quot;load_uuid&quot;</span>)],</div>
<div class="line">PartId = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;part_id&quot;</span>)),</div>
<div class="line">Quantity = reader.GetDecimal(reader.GetOrdinal(<span class="stringliteral">&quot;quantity&quot;</span>)),</div>
<div class="line">ReceivedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;received_date&quot;</span>)),</div>
<div class="line">CreatedBy = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">ModifiedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>)) ? <span class="keyword">null</span> : reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md398"></a>
File: Module_Dunnage/Data/Dao_DunnageType.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_DunnageType</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_DunnageType&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">Console.WriteLine($<span class="stringliteral">&quot;[Dao_DunnageType] GetAllAsync called&quot;</span>);</div>
<div class="line">Console.WriteLine($<span class="stringliteral">&quot;[Dao_DunnageType] Connection string: {_connectionString}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">Console.WriteLine($<span class="stringliteral">&quot;[Dao_DunnageType] Result - IsSuccess: {result.IsSuccess}, Data Count: {result.Data?.Count ?? 0}, Error: {result.ErrorMessage}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;Model_DunnageType&gt;&gt; GetByIdAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertAsync(<span class="keywordtype">string</span> typeName, <span class="keywordtype">string</span> icon, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line">var pNewId = <span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_new_id&quot;</span>, MySqlDbType.Int32)</div>
<div class="line">⋮----</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_type_name&quot;</span>, typeName),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_icon&quot;</span>, icon),</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_user&quot;</span>, user),</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success&lt;<span class="keywordtype">int</span>&gt;(Convert.ToInt32(pNewId.Value));</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; UpdateAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">string</span> typeName, <span class="keywordtype">string</span> icon, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; CountPartsAsync(<span class="keywordtype">int</span> typeId)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;part_count&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; CountTransactionsAsync(<span class="keywordtype">int</span> typeId)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;transaction_count&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">bool</span>&gt;&gt; CheckDuplicateNameAsync(<span class="keywordtype">string</span> typeName, <span class="keywordtype">int</span>? excludeId = null)</div>
<div class="line">⋮----</div>
<div class="line">var pExists = new MySqlParameter(<span class="stringliteral">&quot;@p_exists&quot;</span>, MySqlDbType.Bit)</div>
<div class="line">⋮----</div>
<div class="line">new MySqlParameter(<span class="stringliteral">&quot;@p_exclude_id&quot;</span>, excludeId.HasValue ? (<span class="keywordtype">object</span>)excludeId.Value : DBNull.Value),</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success&lt;<span class="keywordtype">bool</span>&gt;(Convert.ToBoolean(pExists.Value));</div>
<div class="line">⋮----</div>
<div class="line">private Model_DunnageType MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_DunnageType</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">TypeName = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;type_name&quot;</span>)),</div>
<div class="line">Icon = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;icon&quot;</span>)) ? <span class="stringliteral">&quot;Help&quot;</span> : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;icon&quot;</span>)),</div>
<div class="line">CreatedBy = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">ModifiedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>)) ? null : reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md399"></a>
File: Module_Dunnage/Data/Dao_InventoriedDunnage.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_InventoriedDunnage</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;Model_InventoriedDunnage&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; CheckAsync(string partId)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;requires_inventory&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;Model_InventoriedDunnage&gt;&gt; GetByPartAsync(<span class="keywordtype">string</span> partId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertAsync(<span class="keywordtype">string</span> partId, <span class="keywordtype">string</span> inventoryMethod, <span class="keywordtype">string</span> notes, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line">var pNewId = <span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_new_id&quot;</span>, MySqlDbType.Int32)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_part_id&quot;</span>, partId),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_inventory_method&quot;</span>, inventoryMethod),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_notes&quot;</span>, notes),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_user&quot;</span>, user),</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success&lt;<span class="keywordtype">int</span>&gt;(Convert.ToInt32(pNewId.Value));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&gt; UpdateAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">string</span> inventoryMethod, <span class="keywordtype">string</span> notes, <span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_InventoriedDunnage MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_InventoriedDunnage</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">PartId = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;part_id&quot;</span>)),</div>
<div class="line">InventoryMethod = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;inventory_method&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;inventory_method&quot;</span>)),</div>
<div class="line">Notes = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;notes&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;notes&quot;</span>)),</div>
<div class="line">CreatedBy = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">ModifiedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>)) ? <span class="keyword">null</span> : reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md400"></a>
File: Module_Dunnage/Services/Service_DunnageAdminWorkflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_DunnageAdminWorkflow : IService_DunnageAdminWorkflow</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Enum_DunnageAdminSection _currentSection = Enum_DunnageAdminSection.Hub;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task NavigateToSectionAsync(Enum_DunnageAdminSection section)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task NavigateToHubAsync()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; CanNavigateAwayAsync()</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(true);</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(false);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void MarkDirty()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void MarkClean()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md401"></a>
File: Module_Dunnage/Services/Service_DunnageCSVWriter.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_DunnageCSVWriter : IService_DunnageCSVWriter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> CsvConfiguration GetRfc4180Configuration()</div>
<div class="line">⋮----</div>
<div class="line">return new CsvConfiguration(CultureInfo.InvariantCulture)</div>
<div class="line">⋮----</div>
<div class="line">ShouldQuote = args =&gt; !string.IsNullOrEmpty(args.Field) &amp;&amp;</div>
<div class="line">(args.Field.Contains(&quot;,&quot;) ||</div>
<div class="line">args.Field.Contains(&quot;\&quot;&quot;) ||</div>
<div class="line">args.Field.Contains(&quot;\n&quot;) ||</div>
<div class="line">args.Field.Contains(&quot;\r&quot;)),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_CSVWriteResult&gt; WriteToCSVAsync(List&lt;Model_DunnageLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_CSVWriteResult&gt; WriteToCsvAsync(List&lt;Model_DunnageLoad&gt; loads, string typeName)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync(&quot;WriteToCsvAsync called with no loads to export&quot;);</div>
<div class="line">return new Model_CSVWriteResult { ErrorMessage = <span class="stringliteral">&quot;No loads to export.&quot;</span> };</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Starting CSV export for {loads.Count} loads of type &#39;{typeName}&#39;&quot;</span>);</div>
<div class="line">var specKeys = await _dunnageService.GetAllSpecKeysAsync();</div>
<div class="line">specKeys.Sort();</div>
<div class="line">⋮----</div>
<div class="line">dynamic record = <span class="keyword">new</span> ExpandoObject();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (load.Specs != <span class="keyword">null</span> &amp;&amp; load.Specs.TryGetValue(key, out <span class="keywordtype">object</span>? value))</div>
<div class="line">⋮----</div>
<div class="line">dict[key] = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// FR-043: Empty string if missing</span></div>
<div class="line">⋮----</div>
<div class="line">records.Add(record);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Write to local path</span></div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Successfully wrote {records.Count} records to local CSV: {localPath}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Ensure directory exists for network path</span></div>
<div class="line">var networkDir = Path.GetDirectoryName(networkPath);</div>
<div class="line"><span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(networkDir) &amp;&amp; !Directory.Exists(networkDir))</div>
<div class="line">⋮----</div>
<div class="line">Directory.CreateDirectory(networkDir);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Successfully wrote {records.Count} records to network CSV: {networkPath}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;Failed to write to network path &#39;{networkPath}&#39;: {ex.Message}&quot;</span>);</div>
<div class="line"><span class="comment">// FR-044: Network failure graceful handling</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_CSVWriteResult</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;CSV export failed for type &#39;{typeName}&#39;: {ex.Message}&quot;</span>);</div>
<div class="line">await _errorHandler.HandleErrorAsync($<span class="stringliteral">&quot;Export failed: {ex.Message}&quot;</span>, Enum_ErrorSeverity.Error, ex, <span class="keyword">true</span>);</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_CSVWriteResult { ErrorMessage = $<span class="stringliteral">&quot;Export failed: {ex.Message}&quot;</span> };</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_CSVWriteResult&gt; WriteDynamicCsvAsync(</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync(<span class="stringliteral">&quot;WriteDynamicCsvAsync called with no loads to export&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Starting dynamic CSV export for {loads.Count} loads&quot;</span>);</div>
<div class="line">var specKeys = allSpecKeys ?? await _dunnageService.GetAllSpecKeysAsync();</div>
<div class="line">⋮----</div>
<div class="line">dict[key] = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// Blank cell for specs not applicable to this load&#39;s type</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Generate filename if not provided</span></div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync(<span class="stringliteral">&quot;Network path not available for CSV export&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync($<span class="stringliteral">&quot;Dynamic CSV export failed: {ex.Message}&quot;</span>, Enum_ErrorSeverity.Error, ex, <span class="keyword">true</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_CSVWriteResult&gt; ExportSelectedLoadsAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_CSVWriteResult { ErrorMessage = <span class="stringliteral">&quot;No loads selected for export.&quot;</span> };</div>
<div class="line">⋮----</div>
<div class="line">specKeys = await _dunnageService.GetAllSpecKeysAsync();</div>
<div class="line">⋮----</div>
<div class="line">.Where(l =&gt; l.TypeId.HasValue)</div>
<div class="line">.Select(l =&gt; l.TypeId!.Value)</div>
<div class="line">.Distinct()</div>
<div class="line">.ToList();</div>
<div class="line">⋮----</div>
<div class="line">var specs = await _dunnageService.GetSpecsForTypeAsync(typeId);</div>
<div class="line">⋮----</div>
<div class="line">var keys = specs.Data.Select(s =&gt; s.SpecKey).Distinct();</div>
<div class="line">specKeys.AddRange(keys);</div>
<div class="line">⋮----</div>
<div class="line">specKeys = specKeys.Distinct().ToList();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync($<span class="stringliteral">&quot;Selected loads export failed: {ex.Message}&quot;</span>, Enum_ErrorSeverity.Error, ex, <span class="keyword">true</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;bool&gt; IsNetworkPathAvailableAsync(<span class="keywordtype">int</span> timeout = 3)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Task.Run(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Directory.Exists(networkRoot);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetLocalCsvPath(<span class="keywordtype">string</span> filename)</div>
<div class="line">⋮----</div>
<div class="line">var appData = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);</div>
<div class="line">var folder = Path.Combine(appData, <span class="stringliteral">&quot;MTM_Receiving_Application&quot;</span>);</div>
<div class="line">if (!Directory.Exists(folder))</div>
<div class="line">⋮----</div>
<div class="line">Directory.CreateDirectory(folder);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Path.Combine(folder, filename);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">string</span> GetNetworkCsvPath(<span class="keywordtype">string</span> filename)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task WriteCsvFileAsync(<span class="keywordtype">string</span> path, IEnumerable&lt;dynamic&gt; records)</div>
<div class="line">⋮----</div>
<div class="line">var encoding = <span class="keyword">new</span> UTF8Encoding(<span class="keyword">true</span>);</div>
<div class="line">await <span class="keyword">using</span> (var writer = <span class="keyword">new</span> StreamWriter(path, <span class="keyword">false</span>, encoding))</div>
<div class="line">await <span class="keyword">using</span> (var csv = <span class="keyword">new</span> CsvWriter(writer, GetRfc4180Configuration()))</div>
<div class="line">⋮----</div>
<div class="line">await csv.WriteRecordsAsync(records);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">string</span> FormatDateTime(DateTime value)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> value.ToString(<span class="stringliteral">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, CultureInfo.InvariantCulture);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_CSVDeleteResult&gt; ClearCSVFilesAsync(<span class="keywordtype">string</span>? filenamePattern = <span class="keyword">null</span>)</div>
<div class="line">⋮----</div>
<div class="line">var result = new Model_CSVDeleteResult();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Starting CSV file clearing with pattern: {filenamePattern ?? &quot;</span>all<span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><span class="comment">// Clear local files</span></div>
<div class="line">⋮----</div>
<div class="line">var localFolder = Path.GetDirectoryName(GetLocalCsvPath(<span class="stringliteral">&quot;dummy.csv&quot;</span>));</div>
<div class="line">if (Directory.Exists(localFolder))</div>
<div class="line">⋮----</div>
<div class="line">var filesToClear = Directory.GetFiles(localFolder, filenamePattern ?? <span class="stringliteral">&quot;*.csv&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await using var writer = new StreamWriter(file, false, new UTF8Encoding(true));</div>
<div class="line">await using var csv = new CsvWriter(writer, GetRfc4180Configuration());</div>
<div class="line">⋮----</div>
<div class="line">csv.NextRecord();</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Cleared local CSV file: {file}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(<span class="stringliteral">&quot;Local CSV directory does not exist - no files to clear&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add(result.LocalError);</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;Failed to clear local CSV files: {ex.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">var networkFolder = Path.GetDirectoryName(GetNetworkCsvPath(<span class="stringliteral">&quot;dummy.csv&quot;</span>));</div>
<div class="line">if (Directory.Exists(networkFolder))</div>
<div class="line">⋮----</div>
<div class="line">var filesToClear = Directory.GetFiles(networkFolder, filenamePattern ?? <span class="stringliteral">&quot;*.csv&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Cleared network CSV file: {file}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(<span class="stringliteral">&quot;Network CSV directory does not exist - no files to clear&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add(<span class="stringliteral">&quot;Network path not available&quot;</span>);</div>
<div class="line">await _logger.LogWarningAsync(<span class="stringliteral">&quot;Network path not available for CSV clearing&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add(result.NetworkError);</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;Failed to clear network CSV files: {ex.Message}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;CSV clearing completed. Local: {result.LocalDeleted}, Network: {result.NetworkDeleted}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync($<span class="stringliteral">&quot;CSV clearing failed: {ex.Message}&quot;</span>, Enum_ErrorSeverity.Error, ex, true);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md402"></a>
File: Module_Dunnage/Services/Service_DunnageWorkflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_DunnageWorkflow : IService_DunnageWorkflow</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageCSVWriter _csvWriter;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ViewModelRegistry _viewModelRegistry;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;bool&gt; StartWorkflowAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (currentUser != null &amp;&amp; !string.IsNullOrEmpty(currentUser.DefaultDunnageMode))</div>
<div class="line">⋮----</div>
<div class="line">switch (currentUser.DefaultDunnageMode.ToLower())</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(true);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_WorkflowStepResult&gt; AdvanceToNextStepAsync()</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(new Model_WorkflowStepResult { IsSuccess = false, ErrorMessage = &quot;Please select a dunnage type.&quot; });</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(new Model_WorkflowStepResult { IsSuccess = false, ErrorMessage = &quot;Please select a part.&quot; });</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(new Model_WorkflowStepResult { IsSuccess = false, ErrorMessage = &quot;Quantity must be greater than zero.&quot; });</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(new Model_WorkflowStepResult { IsSuccess = false, ErrorMessage = &quot;Already at Review step. Use Save to finish.&quot; });</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(new Model_WorkflowStepResult { IsSuccess = true, TargetStep = CurrentStep });</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleErrorAsync(&quot;Error advancing step&quot;, Enum_ErrorSeverity.Error, ex, true);</div>
<div class="line">return Task.FromResult(new Model_WorkflowStepResult { IsSuccess = false, ErrorMessage = ex.Message });</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void GoToStep(Enum_DunnageWorkflowStep step)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_SaveResult&gt; SaveToCSVOnlyAsync()</div>
<div class="line">⋮----</div>
<div class="line">loads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line">return new Model_SaveResult { IsSuccess = <span class="keyword">false</span>, ErrorMessage = <span class="stringliteral">&quot;No data to save.&quot;</span> };</div>
<div class="line">⋮----</div>
<div class="line">var csvResult = await _csvWriter.WriteToCSVAsync(loads);</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_SaveResult</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(<span class="stringliteral">&quot;Error saving CSV&quot;</span>, Enum_ErrorSeverity.Error, ex, <span class="keyword">true</span>);</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_SaveResult { IsSuccess = <span class="keyword">false</span>, ErrorMessage = ex.Message };</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_SaveResult&gt; SaveToDatabaseOnlyAsync()</div>
<div class="line">⋮----</div>
<div class="line">var dbResult = await _dunnageService.SaveLoadsAsync(loads);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(<span class="stringliteral">&quot;Error saving to database&quot;</span>, Enum_ErrorSeverity.Error, ex, true);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_SaveResult&gt; SaveSessionAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(<span class="stringliteral">&quot;Error saving session&quot;</span>, Enum_ErrorSeverity.Error, ex, true);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ClearSession()</div>
<div class="line">⋮----</div>
<div class="line">CurrentSession = new Model_DunnageSession();</div>
<div class="line">_viewModelRegistry.ClearAllInputs();</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_CSVDeleteResult&gt; ResetCSVFilesAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await _csvWriter.ClearCSVFilesAsync();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> AddCurrentLoadToSession()</div>
<div class="line">⋮----</div>
<div class="line">var location = <span class="keywordtype">string</span>.IsNullOrWhiteSpace(CurrentSession.Location)</div>
<div class="line">⋮----</div>
<div class="line">var poNumber = <span class="keywordtype">string</span>.IsNullOrWhiteSpace(CurrentSession.PONumber)</div>
<div class="line">⋮----</div>
<div class="line">var load = new Model_DunnageLoad</div>
<div class="line">⋮----</div>
<div class="line">LoadUuid = Guid.NewGuid(),</div>
<div class="line">⋮----</div>
<div class="line">CurrentSession.Loads.Add(load);</div>
<div class="line">_logger.LogInfo($<span class="stringliteral">&quot;Added load to session: Part {load.PartId}, Qty {load.Quantity}&quot;</span>, <span class="stringliteral">&quot;DunnageWorkflow&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleErrorAsync(<span class="stringliteral">&quot;Error adding load to session&quot;</span>, Enum_ErrorSeverity.Medium, ex, false);</div>
<div class="line">⋮----</div>
<div class="line">private Model_DunnageLoad CreateLoadFromCurrentSession()</div>
<div class="line">⋮----</div>
<div class="line">return new Model_DunnageLoad</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md403"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_AddTypeDialogViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_AddTypeDialog : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly DispatcherQueue _dispatcherQueue;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> MaterialIconKind _selectedIcon = MaterialIconKind.PackageVariantClosed;</div>
<div class="line">⋮----</div>
<div class="line">_dispatcherQueue = DispatcherQueue.GetForCurrentThread();</div>
<div class="line">_validationTimer = _dispatcherQueue.CreateTimer();</div>
<div class="line">_validationTimer.Interval = TimeSpan.FromMilliseconds(300);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SaveTypeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var typeResult = await _dunnageService.InsertTypeAsync(TypeName, SelectedIcon.ToString());</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(typeResult.ErrorMessage, &quot;Save Failed&quot;, nameof(SaveTypeAsync));</div>
<div class="line">⋮----</div>
<div class="line">var fieldResult = await _dunnageService.InsertCustomFieldAsync(typeId, field);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync($&quot;Failed to save field &#39;{field.FieldName}&#39;: {fieldResult.ErrorMessage}&quot;,</div>
<div class="line">⋮----</div>
<div class="line">await _dunnageService.UpsertUserPreferenceAsync($&quot;RecentIcon_{SelectedIcon}&quot;, DateTime.Now.ToString(&quot;O&quot;));</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Enum_ErrorSeverity.Medium,</div>
<div class="line">⋮----</div>
<div class="line">private void AddField()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(FieldName) || CustomFields.Count &gt;= 25)</div>
<div class="line">⋮----</div>
<div class="line">var field = new Model_CustomFieldDefinition</div>
<div class="line">⋮----</div>
<div class="line">CustomFields.Add(field);</div>
<div class="line">⋮----</div>
<div class="line">private void EditField(Model_CustomFieldDefinition field)</div>
<div class="line">⋮----</div>
<div class="line">private void DeleteField(Model_CustomFieldDefinition field)</div>
<div class="line">⋮----</div>
<div class="line">CustomFields.Remove(field);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnTypeNameChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnFieldNameChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">private void OnValidationTimerTick(object? sender, object e)</div>
<div class="line">⋮----</div>
<div class="line">private async void ValidateTypeName()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(TypeName))</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.CheckDuplicateTypeNameAsync(TypeName);</div>
<div class="line">⋮----</div>
<div class="line">DuplicateTypeId = result.Data.ToString();</div>
<div class="line">⋮----</div>
<div class="line">private void ValidateFieldName()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(FieldName))</div>
<div class="line">⋮----</div>
<div class="line">if (FieldName.Any(c =&gt; &quot;&lt;&gt;{}[]|\\&quot;.Contains(c)))</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Check for duplicate field name</span></div>
<div class="line">if (CustomFields.Any(f =&gt; f.FieldName.Equals(FieldName, StringComparison.OrdinalIgnoreCase) &amp;&amp; f != EditingField))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdateCanSave()</div>
<div class="line">⋮----</div>
<div class="line">CanSave = !string.IsNullOrWhiteSpace(TypeName) &amp;&amp;</div>
<div class="line">string.IsNullOrEmpty(TypeNameError) &amp;&amp;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadRecentlyUsedIconsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.GetRecentlyUsedIconsAsync(6);</div>
<div class="line">⋮----</div>
<div class="line">RecentlyUsedIcons.Clear();</div>
<div class="line">⋮----</div>
<div class="line">RecentlyUsedIcons.Add(icon);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to load recently used icons: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void OnDragItemsCompleted()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md404"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_AdminMainViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_AdminMain : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageAdminWorkflow _adminWorkflow;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task NavigateToManageTypesAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _adminWorkflow.NavigateToSectionAsync(Enum_DunnageAdminSection.Types);</div>
<div class="line">await _logger.LogInfoAsync(&quot;Navigated to Type Management&quot;, &quot;AdminMain&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">private async Task NavigateToManageSpecsAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _adminWorkflow.NavigateToSectionAsync(Enum_DunnageAdminSection.Specs);</div>
<div class="line">await _logger.LogInfoAsync(&quot;Navigated to Spec Management&quot;, &quot;AdminMain&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task NavigateToManagePartsAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _adminWorkflow.NavigateToSectionAsync(Enum_DunnageAdminSection.Parts);</div>
<div class="line">await _logger.LogInfoAsync(&quot;Navigated to Part Management&quot;, &quot;AdminMain&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task NavigateToInventoriedListAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _adminWorkflow.NavigateToSectionAsync(Enum_DunnageAdminSection.InventoriedList);</div>
<div class="line">await _logger.LogInfoAsync(&quot;Navigated to Inventoried List&quot;, &quot;AdminMain&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ReturnToMainNavigationAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _adminWorkflow.NavigateToHubAsync();</div>
<div class="line">await _logger.LogInfoAsync(&quot;Returned to main navigation hub&quot;, &quot;AdminMain&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void OnSectionChanged(object? sender, Enum_DunnageAdminSection section)</div>
<div class="line">⋮----</div>
<div class="line">private void OnStatusMessageRaised(object? sender, string message)</div>
<div class="line">⋮----</div>
<div class="line">private void UpdateVisibility(Enum_DunnageAdminSection section)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md405"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_AdminTypesViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_AdminTypes : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageAdminWorkflow _adminWorkflow;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadTypesAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.GetAllTypesAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(result, &quot;LoadTypesAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">Types.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Types.Add(type);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Loaded {Types.Count} dunnage types&quot;, &quot;TypeManagement&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowAddTypeAsync()</div>
<div class="line">⋮----</div>
<div class="line">XamlRoot = _windowService.GetXamlRoot()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;New dunnage type added via Add Type Dialog&quot;, &quot;TypeManagement&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowEditTypeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var editedType = new Model_DunnageType</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var stackPanel = new StackPanel { Spacing = 12 };</div>
<div class="line">var typeNameBox = new TextBox</div>
<div class="line">⋮----</div>
<div class="line">var iconSelectorButton = new Button</div>
<div class="line">⋮----</div>
<div class="line">Padding = new Thickness(16, 12, 16, 12)</div>
<div class="line">⋮----</div>
<div class="line">var iconButtonPanel = new StackPanel</div>
<div class="line">⋮----</div>
<div class="line">var iconTextPanel = new StackPanel</div>
<div class="line">⋮----</div>
<div class="line">var iconLabel = new TextBlock</div>
<div class="line">⋮----</div>
<div class="line">var iconName = new TextBlock</div>
<div class="line">⋮----</div>
<div class="line">iconTextPanel.Children.Add(iconLabel);</div>
<div class="line">iconTextPanel.Children.Add(iconName);</div>
<div class="line">iconButtonPanel.Children.Add(iconDisplay);</div>
<div class="line">iconButtonPanel.Children.Add(iconTextPanel);</div>
<div class="line">⋮----</div>
<div class="line">iconSelector.SetInitialSelection(editedType.IconKind);</div>
<div class="line">iconSelector.Activate();</div>
<div class="line">var selectedIcon = await iconSelector.WaitForSelectionAsync();</div>
<div class="line">⋮----</div>
<div class="line">editedType.Icon = selectedIcon.Value.ToString();</div>
<div class="line">⋮----</div>
<div class="line">iconName.Text = selectedIcon.Value.ToString();</div>
<div class="line">⋮----</div>
<div class="line">var iconHeader = new TextBlock</div>
<div class="line">⋮----</div>
<div class="line">Margin = new Thickness(0, 8, 0, 0),</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(typeNameBox);</div>
<div class="line">stackPanel.Children.Add(iconHeader);</div>
<div class="line">stackPanel.Children.Add(iconSelectorButton);</div>
<div class="line">⋮----</div>
<div class="line">editedType.DunnageType = typeNameBox.Text.Trim();</div>
<div class="line">if (string.IsNullOrWhiteSpace(editedType.DunnageType))</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(&quot;Type name is required&quot;, &quot;Validation Error&quot;, &quot;ShowEditTypeAsync&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var updateResult = await _dunnageService.UpdateTypeAsync(editedType);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(updateResult, &quot;UpdateTypeAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Updated type: {editedType.DunnageType}&quot;, &quot;TypeManagement&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowDeleteConfirmationAsync()</div>
<div class="line">⋮----</div>
<div class="line">var partCountResult = await _dunnageService.GetPartCountByTypeAsync(SelectedType.Id);</div>
<div class="line">var transactionCountResult = await _dunnageService.GetTransactionCountByTypeAsync(SelectedType.Id);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">var warningDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">await warningDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var confirmDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(new TextBlock { Text = impactMessage, TextWrapping = Microsoft.UI.Xaml.TextWrapping.Wrap });</div>
<div class="line">var confirmBox = new TextBox</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(confirmBox);</div>
<div class="line">⋮----</div>
<div class="line">var result = await confirmDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">private async Task DeleteTypeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.DeleteTypeAsync(SelectedType.Id);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(result, &quot;DeleteTypeAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Deleted type: {SelectedType.DunnageType}&quot;, &quot;TypeManagement&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ReturnToAdminHubAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Returning to Settings Mode Selection from Admin Types&quot;);</div>
<div class="line">⋮----</div>
<div class="line">settingsWorkflow.GoBack();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedTypeChanged(Model_DunnageType? value)</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md406"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_EditModeViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_EditMode : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Pagination _paginationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageCSVWriter _csvWriter;</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line">FromDate = DateTimeOffset.Now.AddDays(-7);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string LastWeekButtonText =&gt; $&quot;Last Week ({DateTime.Now.Date.AddDays(-7):MMM d} - {DateTime.Now.Date:MMM d})&quot;;</div>
<div class="line">⋮----</div>
<div class="line">var startOfWeek = today.AddDays(-(int)today.DayOfWeek + (int)DayOfWeek.Monday);</div>
<div class="line">⋮----</div>
<div class="line">startOfWeek = startOfWeek.AddDays(-7);</div>
<div class="line">⋮----</div>
<div class="line">var quarterStart = new DateTime(today.Year, startMonth, 1);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadFromCurrentMemoryAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;No unsaved loads found in current session&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_allLoads = _workflowService.CurrentSession.Loads.ToList();</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.SetSource(_allLoads);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded {TotalRecords} loads from current session&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task LoadFromCurrentLabelsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var localPath = System.IO.Path.Combine(</div>
<div class="line">Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),</div>
<div class="line">⋮----</div>
<div class="line">if (!System.IO.File.Exists(localPath))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;CSV file not found at {localPath}&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">csv.Read();</div>
<div class="line">csv.ReadHeader();</div>
<div class="line">while (csv.Read())</div>
<div class="line">⋮----</div>
<div class="line">var load = new Model_DunnageLoad</div>
<div class="line">⋮----</div>
<div class="line">ReceivedDate = DateTime.TryParse(csv.GetField&lt;string&gt;(&quot;Date&quot;), out var date) ? date : DateTime.Now</div>
<div class="line">⋮----</div>
<div class="line">loadsList.Add(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning($&quot;Failed to parse line {lineNumber}: {rowEx.Message}&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded {TotalRecords} loads from CSV file&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task LoadFromHistoryAsync()</div>
<div class="line">⋮----</div>
<div class="line">var startDate = FromDate?.DateTime ?? DateTime.Now.AddDays(-7);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _dunnageService.GetLoadsByDateRangeAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(result, &quot;LoadFromHistoryAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded {TotalRecords} historical loads from {startDate:d} to {endDate:d}&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetFilterLastWeekAsync()</div>
<div class="line">⋮----</div>
<div class="line">FromDate = DateTime.Now.Date.AddDays(-7);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetFilterTodayAsync()</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetFilterThisWeekAsync()</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetFilterThisMonthAsync()</div>
<div class="line">⋮----</div>
<div class="line">FromDate = new DateTime(today.Year, today.Month, 1);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetFilterThisQuarterAsync()</div>
<div class="line">⋮----</div>
<div class="line">FromDate = new DateTime(today.Year, startMonth, 1);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetFilterShowAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">FromDate = DateTime.Now.Date.AddYears(-1);</div>
<div class="line">⋮----</div>
<div class="line">private void SetDateRangeToday()</div>
<div class="line">⋮----</div>
<div class="line">private void SetDateRangeLastWeek()</div>
<div class="line">⋮----</div>
<div class="line">private void SetDateRangeLastMonth()</div>
<div class="line">⋮----</div>
<div class="line">FromDate = DateTime.Now.Date.AddMonths(-1);</div>
<div class="line">⋮----</div>
<div class="line">private void FirstPage()</div>
<div class="line">⋮----</div>
<div class="line">private void PreviousPage()</div>
<div class="line">⋮----</div>
<div class="line">private void NextPage()</div>
<div class="line">⋮----</div>
<div class="line">private void LastPage()</div>
<div class="line">⋮----</div>
<div class="line">private void LoadPage(int pageNumber)</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.GoToPage(pageNumber);</div>
<div class="line">⋮----</div>
<div class="line">FilteredLoads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">FilteredLoads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded page {CurrentPage} of {TotalPages}&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void SelectAll()</div>
<div class="line">⋮----</div>
<div class="line">SelectedLoads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">SelectedLoads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Selected all {FilteredLoads.Count} loads on page&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void RemoveSelectedRows()</div>
<div class="line">⋮----</div>
<div class="line">var loadsToRemove = SelectedLoads.ToList();</div>
<div class="line">⋮----</div>
<div class="line">FilteredLoads.Remove(load);</div>
<div class="line">_allLoads.Remove(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Removed {loadsToRemove.Count} loads&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SaveAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.TypeName) || string.IsNullOrWhiteSpace(load.PartId))</div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _dunnageService.SaveLoadsAsync(_allLoads);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(saveResult, &quot;SaveAllAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">var csvResult = await _csvWriter.WriteToCSVAsync(_allLoads);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Saved {_allLoads.Count} loads&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ReturnToModeSelectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Cannot show dialog: XamlRoot is null&quot;, null, &quot;EditMode&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Unable to display dialog&quot;, Enum_ErrorSeverity.Error, null, true);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync().AsTask();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User confirmed return to mode selection, clearing data&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_allLoads.Clear();</div>
<div class="line">_workflowService.ClearSession();</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.ModeSelection);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to return to mode selection: {ex.Message}&quot;, ex, &quot;EditMode&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Failed to return to mode selection&quot;, Enum_ErrorSeverity.Error, ex, true);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User cancelled return to mode selection&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void OnPageChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Page changed to {CurrentPage} of {TotalPages}&quot;, &quot;EditMode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void UpdateCanSave()</div>
<div class="line">⋮----</div>
<div class="line">CanSave = _allLoads.Any(l =&gt; !string.IsNullOrWhiteSpace(l.TypeName) || !string.IsNullOrWhiteSpace(l.PartId));</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md407"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_QuantityEntryViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_QuantityEntry : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Dispatcher _dispatcher;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnWorkflowStepChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">_dispatcher.TryEnqueue(LoadContextData);</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrEmpty(SelectedTypeIcon) &amp;&amp; Enum.TryParse&lt;MaterialIconKind&gt;(SelectedTypeIcon, true, out var kind))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void LoadContextData()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Initialized workflow session quantity to {Quantity}&quot;, &quot;QuantityEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded context: Type={SelectedTypeName}, Part={SelectedPartName}, Quantity={_workflowService.CurrentSession.Quantity}&quot;, &quot;QuantityEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error loading context data: {ex.Message}&quot;, ex, &quot;QuantityEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnQuantityChanged(int value)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Quantity changed to {value}, updated workflow session&quot;, &quot;QuantityEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">GoNextCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ValidateQuantity()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void GoBack()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Navigating back to Part Selection&quot;, &quot;QuantityEntry&quot;);</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.PartSelection);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task GoNextAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Quantity set to {Quantity}&quot;, &quot;QuantityEntry&quot;);</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.DetailsEntry);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md408"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_TypeSelectionViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_dunnage_typeselection : ViewModel_Shared_Base, IResettableViewModel</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Pagination _paginationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ViewModelRegistry _viewModelRegistry;</div>
<div class="line">⋮----</div>
<div class="line">_viewModelRegistry.Register(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ResetToDefaults()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;TypeSelection: InitializeAsync called&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;TypeSelection: Already busy, returning&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;TypeSelection: Starting to load types&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">).Wait();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadTypesAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;TypeSelection: LoadTypesAsync called&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;TypeSelection: Calling service.GetAllTypesAsync()&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">var result = await _dunnageService.GetAllTypesAsync();</div>
<div class="line">_logger.LogInfo($&quot;TypeSelection: Service returned - IsSuccess: {result.IsSuccess}, Data null: {result.Data == null}, Count: {result.Data?.Count ?? 0}&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.SetSource(result.Data);</div>
<div class="line">_logger.LogInfo($&quot;TypeSelection: Pagination configured with PageSize=9, TotalItems={result.Data.Count}&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;TypeSelection: Successfully loaded {result.Data.Count} dunnage types with {TotalPages} pages, DisplayedTypes.Count={DisplayedTypes.Count}&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">private void NextPage()</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.NextPage();</div>
<div class="line">⋮----</div>
<div class="line">private void PreviousPage()</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.PreviousPage();</div>
<div class="line">⋮----</div>
<div class="line">private void FirstPage()</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.FirstPage();</div>
<div class="line">⋮----</div>
<div class="line">private void LastPage()</div>
<div class="line">⋮----</div>
<div class="line">_paginationService.LastPage();</div>
<div class="line">⋮----</div>
<div class="line">private async Task SelectTypeAsync(Model_DunnageType? type)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;TypeSelection: Selected dunnage type: {type.TypeName} (ID: {type.Id})&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;TypeSelection: Session updated - SelectedTypeId={_workflowService.CurrentSession.SelectedTypeId}&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">_logger.LogInfo(&quot;TypeSelection: Navigating to PartSelection step&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.PartSelection);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;TypeSelection: Error selecting type: {ex.Message}&quot;, ex, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task QuickAddTypeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Quick Add Type requested&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Cannot show dialog: XamlRoot is null&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var iconName = dialog.SelectedIconKind.ToString();</div>
<div class="line">_logger.LogInfo($&quot;Adding new type: {typeName} with icon {iconName}&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">var newType = new Model_DunnageType</div>
<div class="line">⋮----</div>
<div class="line">var insertResult = await _dunnageService.InsertTypeAsync(newType);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully added type: {typeName}&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var specDef = new SpecDefinition</div>
<div class="line">⋮----</div>
<div class="line">var specModel = new Model_DunnageSpec</div>
<div class="line">⋮----</div>
<div class="line">SpecValue = JsonSerializer.Serialize(specDef)</div>
<div class="line">⋮----</div>
<div class="line">await _dunnageService.InsertSpecAsync(specModel);</div>
<div class="line">⋮----</div>
<div class="line">private async Task EditTypeAsync(Model_DunnageType type)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Edit Type requested for {type.TypeName}&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var specsResult = await _dunnageService.GetSpecsForTypeAsync(type.Id);</div>
<div class="line">⋮----</div>
<div class="line">existingSpecsDict[s.SpecKey] = new SpecDefinition();</div>
<div class="line">⋮----</div>
<div class="line">dialog.InitializeForEdit(type.TypeName, type.Icon, existingSpecsDict);</div>
<div class="line">⋮----</div>
<div class="line">var newIcon = dialog.SelectedIconKind.ToString();</div>
<div class="line">⋮----</div>
<div class="line">var updateResult = await _dunnageService.UpdateTypeAsync(type);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(updateResult, nameof(EditTypeAsync), true);</div>
<div class="line">⋮----</div>
<div class="line">var newSpecNames = newSpecs.Select(s =&gt; s.Name).ToList();</div>
<div class="line">var removedSpecKeys = existingSpecsDict.Keys.Except(newSpecNames).ToList();</div>
<div class="line">⋮----</div>
<div class="line">await _dunnageService.DeleteSpecAsync(specToDelete.Id);</div>
<div class="line">⋮----</div>
<div class="line">var json = JsonSerializer.Serialize(specDef);</div>
<div class="line">if (existingSpecsDict.ContainsKey(specItem.Name))</div>
<div class="line">⋮----</div>
<div class="line">await _dunnageService.UpdateSpecAsync(existingModel);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully updated type: {type.TypeName}&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Error updating dunnage type&quot;, Enum_ErrorSeverity.Error, ex, true);</div>
<div class="line">⋮----</div>
<div class="line">private async Task DeleteTypeAsync(Model_DunnageType type)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Delete Type requested for {type.TypeName}&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var deleteResult = await _dunnageService.DeleteTypeAsync(type.Id);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Successfully deleted type: {type.TypeName}&quot;, &quot;TypeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(deleteResult, nameof(DeleteTypeAsync), true);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Error deleting dunnage type&quot;, Enum_ErrorSeverity.Error, ex, true);</div>
<div class="line">⋮----</div>
<div class="line">private void OnPageChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">private void UpdatePaginationProperties()</div>
<div class="line">⋮----</div>
<div class="line">NextPageCommand.NotifyCanExecuteChanged();</div>
<div class="line">PreviousPageCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">private void UpdatePageDisplay()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;TypeSelection: UpdatePageDisplay - Got {currentItems.Count()} items from pagination service&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">DisplayedTypes.Clear();</div>
<div class="line">⋮----</div>
<div class="line">DisplayedTypes.Add(type);</div>
<div class="line">_logger.LogInfo($&quot;TypeSelection: Added type to DisplayedTypes - ID: {type.Id}, Name: {type.TypeName}&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;TypeSelection: DisplayedTypes.Count after update: {DisplayedTypes.Count}&quot;, &quot;ViewModel_dunnage_typeselection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md409"></a>
File: Module_Dunnage/Views/View_Dunnage_WorkflowView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span> <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Dunnage.Views.View_Dunnage_WorkflowView&quot;</span></div>
<div class="line">      <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.ViewModels&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:views</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Dunnage.Views&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">      <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span> /&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span> /&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Content Area --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">              <span class="keyword">Margin</span>=<span class="stringliteral">&quot;16,12,16,16&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Mode Selection View --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:View_Dunnage_ModeSelectionView</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsModeSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Wizard Steps --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:View_dunnage_typeselectionView</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsTypeSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">views:View_Dunnage_PartSelectionView</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsPartSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">views:View_Dunnage_QuantityEntryView</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsQuantityEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">views:View_Dunnage_DetailsEntryView</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsDetailsEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">views:View_Dunnage_ReviewView</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsReviewVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Bulk Operation Views --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:View_Dunnage_ManualEntryView</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManualEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">views:View_Dunnage_EditModeView</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsEditModeVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Navigation Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">              <span class="keyword">Margin</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span> /&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Left-aligned buttons --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                        <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Left&quot;</span></div>
<div class="line">                        <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                <span class="comment">&lt;!-- Mode Selection Button (visible in wizard steps) --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Mode Selection&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToModeSelectionCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Return to mode selection (clears current work)&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsTypeSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Mode Selection&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToModeSelectionCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Return to mode selection (clears current work)&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsPartSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Mode Selection&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToModeSelectionCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Return to mode selection (clears current work)&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsQuantityEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Mode Selection&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToModeSelectionCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Return to mode selection (clears current work)&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsDetailsEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Mode Selection&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToModeSelectionCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Return to mode selection (clears current work)&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManualEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Mode Selection&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReturnToModeSelectionCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Return to mode selection (clears current work)&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsEditModeVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span> /&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Center help button --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12,8&quot;</span></div>
<div class="line">                    <span class="keyword">Click</span>=<span class="stringliteral">&quot;HelpButton_Click&quot;</span></div>
<div class="line">                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Click for help about the current step&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                            <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE946;&quot;</span></div>
<div class="line">                              <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> /&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Help&quot;</span> /&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Right-aligned navigation buttons (wizard flow) --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                        <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span></div>
<div class="line">                        <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                <span class="comment">&lt;!-- Back Button (not visible on first wizard step) --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Back&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsPartSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                        <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnBackClick&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Go back to previous step (Ctrl+Left)&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">KeyboardAccelerator</span> <span class="keyword">Key</span>=<span class="stringliteral">&quot;Left&quot;</span></div>
<div class="line">                                             <span class="keyword">Modifiers</span>=<span class="stringliteral">&quot;Control&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Back&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsQuantityEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                        <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnBackClick&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Go back to previous step (Ctrl+Left)&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">KeyboardAccelerator</span> <span class="keyword">Key</span>=<span class="stringliteral">&quot;Left&quot;</span></div>
<div class="line">                                             <span class="keyword">Modifiers</span>=<span class="stringliteral">&quot;Control&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Back&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsDetailsEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                        <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnBackClick&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Go back to previous step (Ctrl+Left)&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">KeyboardAccelerator</span> <span class="keyword">Key</span>=<span class="stringliteral">&quot;Left&quot;</span></div>
<div class="line">                                             <span class="keyword">Modifiers</span>=<span class="stringliteral">&quot;Control&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Next Button (wizard flow) --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Next&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsTypeSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                        <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnNextClick&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Proceed to next step (Ctrl+Right)&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">KeyboardAccelerator</span> <span class="keyword">Key</span>=<span class="stringliteral">&quot;Right&quot;</span></div>
<div class="line">                                             <span class="keyword">Modifiers</span>=<span class="stringliteral">&quot;Control&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Next&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsPartSelectionVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                        <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnNextClick&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Proceed to next step (Ctrl+Right)&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">KeyboardAccelerator</span> <span class="keyword">Key</span>=<span class="stringliteral">&quot;Right&quot;</span></div>
<div class="line">                                             <span class="keyword">Modifiers</span>=<span class="stringliteral">&quot;Control&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Next&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsQuantityEntryVisible, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span></div>
<div class="line">                        <span class="keyword">Click</span>=<span class="stringliteral">&quot;OnNextClick&quot;</span></div>
<div class="line">                        <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Proceed to next step (Ctrl+Right)&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">KeyboardAccelerator</span> <span class="keyword">Key</span>=<span class="stringliteral">&quot;Right&quot;</span></div>
<div class="line">                                             <span class="keyword">Modifiers</span>=<span class="stringliteral">&quot;Control&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=&quot;<span class="keyword">Save</span> &amp;<span class="keyword">amp</span>; <span class="keyword">Review</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">AccentButtonStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        Visibility=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.IsDetailsEntryVisible</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>, <span class="keyword">Converter</span>={<span class="keyword">StaticResource</span> <span class="keyword">BooleanToVisibilityConverter</span>}}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        Click=&quot;</span><span class="keyword">OnSaveAndReviewClick</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        ToolTipService.ToolTip=&quot;</span><span class="keyword">Save</span> <span class="keyword">entry</span> <span class="keyword">and</span> <span class="keyword">proceed</span> <span class="keyword">to</span> <span class="keyword">review</span> (<span class="keyword">Ctrl</span>+<span class="keyword">Right</span>)<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;Button.KeyboardAccelerators&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;KeyboardAccelerator Key=&quot;</span><span class="keyword">Right</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                             Modifiers=&quot;</span><span class="keyword">Control</span>&quot; /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button.KeyboardAccelerators</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md410"></a>
File: Module_Receiving/Data/Dao_ReceivingLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_ReceivingLine</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertReceivingLineAsync(Model_ReceivingLine line)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Quantity&quot;</span>, line.Quantity),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_PartID&quot;</span>, line.PartID ?? <span class="keywordtype">string</span>.Empty),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_PONumber&quot;</span>, line.PONumber),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_EmployeeNumber&quot;</span>, line.EmployeeNumber),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Heat&quot;</span>, line.Heat ?? <span class="keywordtype">string</span>.Empty),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Date&quot;</span>, line.Date),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_InitialLocation&quot;</span>, line.InitialLocation ?? <span class="keywordtype">string</span>.Empty),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_CoilsOnSkid&quot;</span>, (<span class="keywordtype">object</span>?)line.CoilsOnSkid ?? DBNull.Value),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_VendorName&quot;</span>, line.VendorName ?? <span class="stringliteral">&quot;Unknown&quot;</span>),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_PartDescription&quot;</span>, line.PartDescription ?? <span class="keywordtype">string</span>.Empty),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_Status&quot;</span>, MySqlDbType.Int32) { Direction = System.Data.ParameterDirection.Output },</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_ErrorMsg&quot;</span>, MySqlDbType.VarChar, 500) { Direction = System.Data.ParameterDirection.Output }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (!Helper_Database_StoredProcedure.ValidateParameters(parameters))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_Dao_Result</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteAsync(</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md411"></a>
File: Module_Receiving/Services/Service_ReceivingValidation.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_ReceivingValidation : IService_ReceivingValidation</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_InforVisual _inforVisualService;</div>
<div class="line"><span class="keyword">private</span> static readonly Regex _regex = new Regex(<span class="stringliteral">@&quot;^(PO-)?\d{1,6}$&quot;</span>, RegexOptions.IgnoreCase);</div>
<div class="line">⋮----</div>
<div class="line">_inforVisualService = inforVisualService ?? throw new ArgumentNullException(nameof(inforVisualService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidatePONumber(string poNumber)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(poNumber))</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;PO number is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (!_regex.IsMatch(poNumber))</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;PO number must be numeric (up to 6 digits) or in PO-###### format&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Success();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidatePartID(string partID)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(partID))</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Part ID is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Part ID cannot exceed 50 characters&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidateNumberOfLoads(int numLoads)</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Number of loads must be at least 1&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Number of loads cannot exceed 99&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidateWeightQuantity(decimal weightQuantity)</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Weight/Quantity must be greater than 0&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidatePackageCount(int packagesPerLoad)</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Package count must be greater than 0&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_ReceivingValidationResult ValidateHeatLotNumber(string heatLotNumber)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(heatLotNumber))</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Heat/Lot number is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Heat/Lot number cannot exceed 50 characters&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_ReceivingValidationResult&gt; ValidateAgainstPOQuantityAsync(decimal totalQuantity, decimal orderedQuantity, string partID)</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(Model_ReceivingValidationResult.Warning(</div>
<div class="line">⋮----</div>
<div class="line">return Task.FromResult(Model_ReceivingValidationResult.Success());</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_ReceivingValidationResult&gt; CheckSameDayReceivingAsync(string poNumber, string partID, decimal userEnteredQuantity)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _inforVisualService.GetSameDayReceivingQuantityAsync(poNumber, partID, DateTime.Today);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Warning(</div>
<div class="line">⋮----</div>
<div class="line">public Model_ReceivingValidationResult ValidateReceivingLoad(Model_ReceivingLoad load)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.PartID))</div>
<div class="line">⋮----</div>
<div class="line">errors.Add(&quot;Part ID is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.PartType))</div>
<div class="line">⋮----</div>
<div class="line">errors.Add(&quot;Part Type is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add(&quot;Load number must be at least 1&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Load {load.LoadNumber}: Weight/Quantity must be greater than 0&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.HeatLotNumber))</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Load {load.LoadNumber}: Heat/Lot number is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Load {load.LoadNumber}: Package count must be greater than 0&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.PackageTypeName))</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Load {load.LoadNumber}: Package type is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ReceivingValidationResult.Error(string.Join(&quot;; &quot;, errors));</div>
<div class="line">⋮----</div>
<div class="line">public Model_ReceivingValidationResult ValidateSession(List&lt;Model_ReceivingLoad&gt; loads)</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error(&quot;Session must contain at least one load&quot;);</div>
<div class="line">⋮----</div>
<div class="line">allErrors.AddRange(loadValidation.Errors);</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_ReceivingValidationResult.Error($&quot;{allErrors.Count} validation error(s) found&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_ReceivingValidationResult&gt; ValidatePartExistsInVisualAsync(string partID)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _inforVisualService.GetPartByIDAsync(partID);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error($&quot;Error validating part: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ReceivingValidationResult.Error($&quot;Part ID {partID} not found in Infor Visual database&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md412"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_HeatLot.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_HeatLot : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingValidation _validationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnStepChanged(object? sender, System.EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Task OnNavigatedToAsync()</div>
<div class="line">⋮----</div>
<div class="line">Loads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Loads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void AutoFill()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(currentLoad.HeatLotNumber) &amp;&amp; !string.IsNullOrWhiteSpace(prevLoad.HeatLotNumber))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Task ValidateAndContinueAsync()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void PrepareHeatLotFields()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(load.HeatLotNumber))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.HeatLot&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md413"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_LoadEntry.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_LoadEntry : ViewModel_Shared_Base, IResettableViewModel</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingValidation _validationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ViewModelRegistry _viewModelRegistry;</div>
<div class="line">⋮----</div>
<div class="line">_viewModelRegistry.Register(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ResetToDefaults()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnStepChanged(object? sender, System.EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task CreateLoadsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var validationResult = _validationService.ValidateNumberOfLoads(NumberOfLoads);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(validationResult.Message, Enum_ErrorSeverity.Warning);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnNumberOfLoadsChanged(int value)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void UpdatePartInfo(string partId, string description)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.LoadEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md414"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_ModeSelection.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_ModeSelection : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserPreferences _userPreferencesService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void LoadDefaultMode()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SelectGuidedModeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User selected Guided Mode.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.GoToStep(Enum_ReceivingWorkflowStep.POEntry);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SelectManualModeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User selected Manual Mode.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.GoToStep(Enum_ReceivingWorkflowStep.ManualEntry);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SelectEditModeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User selected Edit Mode.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.GoToStep(Enum_ReceivingWorkflowStep.EditMode);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool HasUnsavedData()</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrEmpty(_workflowService.CurrentSession.PoNumber) ||</div>
<div class="line">⋮----</div>
<div class="line">private async Task&lt;bool&gt; ConfirmModeChangeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;No unsaved data detected, skipping confirmation dialog&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;XamlRoot is null, proceeding without confirmation&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error showing confirmation dialog: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private void ClearWorkflowData()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Workflow data and UI inputs cleared for mode change&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error clearing workflow data: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private void ClearAllUIInputs()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;UI inputs cleared across all Receiving ViewModels&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error clearing UI inputs: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetGuidedAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _userPreferencesService.UpdateDefaultReceivingModeAsync(currentUser.WindowsUsername, newMode ?? &quot;&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Update in-memory user object</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Update UI state</span></div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Default mode set to: {newMode ?? &quot;none&quot;}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowErrorDialogAsync(&quot;Save Error&quot;, result.ErrorMessage, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync($&quot;Failed to set default mode: {ex.Message}&quot;,</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetManualAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetEditAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.ModeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line">public string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md415"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_Review.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_Review : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingValidation _validationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnStepChanged(object? sender, System.EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task OnNavigatedToAsync()</div>
<div class="line">⋮----</div>
<div class="line">Loads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Loads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void PreviousEntry()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NextEntry()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SwitchToTableView()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SwitchToSingleView()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task AddAnotherPartAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User requested to add another part/PO&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User cancelled add another part/PO&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _workflowService.SaveToCSVOnlyAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">$&quot;Failed to save CSV backup: {string.Join(&quot;, &quot;, saveResult.Errors)}&quot;,</div>
<div class="line">⋮----</div>
<div class="line">await _workflowService.AddCurrentPartToSessionAsync();</div>
<div class="line">_workflowService.GoToStep(Enum_ReceivingWorkflowStep.POEntry);</div>
<div class="line">_logger.LogInfo(&quot;Navigated to PO Entry for new part, workflow data cleared&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error in AddAnotherPartAsync: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task&lt;bool&gt; ConfirmAddAnotherAsync()</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;XamlRoot is null, proceeding without confirmation&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error showing confirmation dialog: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private void ClearTransientWorkflowData()</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.ClearUIInputs();</div>
<div class="line">_logger.LogInfo(&quot;Transient workflow data and UI inputs cleared for new entry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error clearing transient workflow data: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SaveAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _workflowService.AdvanceToNextStepAsync();</div>
<div class="line">⋮----</div>
<div class="line">public void HandleCascadingUpdate(Model_ReceivingLoad changedLoad, string propertyName)</div>
<div class="line">⋮----</div>
<div class="line">var index = Loads.IndexOf(changedLoad);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md416"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_WeightQuantity.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_WeightQuantity : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingValidation _validationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_InforVisual _inforVisualService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnStepChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task OnNavigatedToAsync()</div>
<div class="line">⋮----</div>
<div class="line">Loads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Loads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdatePOQuantityInfo()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task CheckSameDayReceivingAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrEmpty(poNumber) || string.IsNullOrEmpty(partId))</div>
<div class="line">⋮----</div>
<div class="line">var result = await _inforVisualService.GetSameDayReceivingQuantityAsync(poNumber, partId, DateTime.Today);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.LogErrorAsync(&quot;Failed to check same-day receiving&quot;, Enum_ErrorSeverity.Warning, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ValidateAndContinueAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = _validationService.ValidateWeightQuantity(load.WeightQuantity);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync($&quot;Load {load.LoadNumber}: {result.Message}&quot;, Enum_ErrorSeverity.Warning);</div>
<div class="line">⋮----</div>
<div class="line">var totalWeight = Loads.Sum(l =&gt; l.WeightQuantity);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.WeightQuantity&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md417"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_Workflow.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_Workflow : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Dispatcher _dispatcherService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnWorkflowStepChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;StepChanged event received in ViewModel. Updating visibility.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Step is Saving. Enqueuing PerformSaveAsync via Dispatcher.&quot;);</div>
<div class="line">_dispatcherService.TryEnqueue(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line">HelpContent = Helper_WorkflowHelpContentGenerator.GenerateHelpContent(_workflowService.CurrentStep);</div>
<div class="line">_logger.LogInfo($&quot;Visibility updated. Current Step: {_workflowService.CurrentStep}, Title: {CurrentStepTitle}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task NextStepAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;NextStepAsync command triggered.&quot;);</div>
<div class="line">var result = await _workflowService.AdvanceToNextStepAsync();</div>
<div class="line">_logger.LogInfo($&quot;AdvanceToNextStepAsync returned. Success: {result.Success}, Step: {_workflowService.CurrentStep}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">string.Join(&quot;\n&quot;, result.ValidationErrors),</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error in NextStepAsync: {ex.Message}&quot;, ex);</div>
<div class="line">await _errorHandler.HandleErrorAsync($&quot;An error occurred: {ex.Message}&quot;, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">private async Task PerformSaveAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;PerformSaveAsync called but already saving. Ignoring.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;PerformSaveAsync started.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Save progress message: {msg}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Save progress percent: {pct}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Calling _workflowService.SaveSessionAsync...&quot;);</div>
<div class="line">LastSaveResult = await _workflowService.SaveSessionAsync(messageProgress, percentProgress);</div>
<div class="line">_logger.LogInfo($&quot;SaveSessionAsync returned. Success: {LastSaveResult.Success}&quot;);</div>
<div class="line">await _workflowService.AdvanceToNextStepAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error in PerformSaveAsync: {ex.Message}&quot;, ex);</div>
<div class="line">await _errorHandler.HandleErrorAsync($&quot;Save failed: {ex.Message}&quot;, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">private async Task StartNewEntryAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _workflowService.ResetWorkflowAsync();</div>
<div class="line">⋮----</div>
<div class="line">private async Task ResetCSVAsync()</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Cannot show dialog: XamlRoot is null&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Unable to display dialog&quot;, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _workflowService.SaveToDatabaseOnlyAsync();</div>
<div class="line">⋮----</div>
<div class="line">var warnDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">Content = $&quot;Failed to save to database: {string.Join(&quot;, &quot;, saveResult.Errors)}\n\nDo you want to proceed with deleting CSV files anyway?&quot;,</div>
<div class="line">⋮----</div>
<div class="line">var warnResult = await warnDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var deleteResult = await _workflowService.ResetCSVFilesAsync();</div>
<div class="line">⋮----</div>
<div class="line">private void PreviousStep()</div>
<div class="line">⋮----</div>
<div class="line">var result = _workflowService.GoToPreviousStep();</div>
<div class="line">⋮----</div>
<div class="line">private async Task ReturnToModeSelectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.GoToStep(Enum_ReceivingWorkflowStep.ModeSelection);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.Workflow&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md418"></a>
File: Module_Receiving/Views/View_Receiving_Workflow.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Receiving_Workflow : Page</div>
<div class="line">⋮----</div>
<div class="line">this.InitializeComponent();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void HelpButton_Click(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowContextualHelpAsync(_workflowService.CurrentStep);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> override void OnNavigatedTo(NavigationEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">base.OnNavigatedTo(e);</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrEmpty(defaultMode))</div>
<div class="line">⋮----</div>
<div class="line">workflowService.GoToStep(Enum_ReceivingWorkflowStep.POEntry);</div>
<div class="line">⋮----</div>
<div class="line">workflowService.GoToStep(Enum_ReceivingWorkflowStep.ManualEntry);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md419"></a>
File: Module_Reporting/Services/Service_Reporting.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Reporting : IService_Reporting</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_Reporting _dao;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_dao = dao ?? throw new ArgumentNullException(nameof(dao));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetReceivingHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Retrieving Receiving history from {startDate:yyyy-MM-dd} to {endDate:yyyy-MM-dd}&quot;);</div>
<div class="line">var result = await _dao.GetReceivingHistoryAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetDunnageHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Retrieving Dunnage history from {startDate:yyyy-MM-dd} to {endDate:yyyy-MM-dd}&quot;);</div>
<div class="line">return await _dao.GetDunnageHistoryAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetRoutingHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Retrieving Routing history from {startDate:yyyy-MM-dd} to {endDate:yyyy-MM-dd}&quot;);</div>
<div class="line">var result = await _dao.GetRoutingHistoryAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetVolvoHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Retrieving Volvo history from {startDate:yyyy-MM-dd} to {endDate:yyyy-MM-dd}&quot;);</div>
<div class="line">return await _dao.GetVolvoHistoryAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Dictionary&lt;string, int&gt;&gt;&gt; CheckAvailabilityAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Checking module availability from {startDate:yyyy-MM-dd} to {endDate:yyyy-MM-dd}&quot;);</div>
<div class="line">return await _dao.CheckAvailabilityAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public string NormalizePONumber(string? poNumber)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(poNumber))</div>
<div class="line">⋮----</div>
<div class="line">poNumber = poNumber.Trim();</div>
<div class="line">if (poNumber.Equals(&quot;Customer Supplied&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">string numericPart = new string(poNumber.TakeWhile(char.IsDigit).ToArray());</div>
<div class="line">string suffix = poNumber.Substring(numericPart.Length);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;string&gt;&gt; ExportToCSVAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Exporting {data.Count} records to CSV for {moduleName} module&quot;);</div>
<div class="line">var csv = new StringBuilder();</div>
<div class="line">switch (moduleName.ToLower())</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine(&quot;PO Number,Part,Description,Qty,Weight,Heat/Lot,Date&quot;);</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine($&quot;\&quot;{row.PONumber ?? &quot;&quot;}\&quot;,\&quot;{row.PartNumber ?? &quot;&quot;}\&quot;,\&quot;{row.PartDescription ?? &quot;&quot;}\&quot;,{row.Quantity ?? 0},{row.WeightLbs ?? 0},\&quot;{row.HeatLotNumber ?? &quot;&quot;}\&quot;,{row.CreatedDate:yyyy-MM-dd}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine(&quot;Type,Part,Specs,Qty,Date&quot;);</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine($&quot;\&quot;{row.DunnageType ?? &quot;&quot;}\&quot;,\&quot;{row.PartNumber ?? &quot;&quot;}\&quot;,\&quot;{row.SpecsCombined ?? &quot;&quot;}\&quot;,{row.Quantity ?? 0},{row.CreatedDate:yyyy-MM-dd}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine(&quot;Deliver To,Department,Package Description,PO Number,Work Order,Date&quot;);</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine($&quot;\&quot;{row.DeliverTo ?? &quot;&quot;}\&quot;,\&quot;{row.Department ?? &quot;&quot;}\&quot;,\&quot;{row.PackageDescription ?? &quot;&quot;}\&quot;,\&quot;{row.PONumber ?? &quot;&quot;}\&quot;,\&quot;{row.WorkOrderNumber ?? &quot;&quot;}\&quot;,{row.CreatedDate:yyyy-MM-dd}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine(&quot;Shipment Number,PO Number,Receiver Number,Status,Date,Part Count&quot;);</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine($&quot;{row.ShipmentNumber ?? 0},\&quot;{row.PONumber ?? &quot;&quot;}\&quot;,\&quot;{row.ReceiverNumber ?? &quot;&quot;}\&quot;,\&quot;{row.Status ?? &quot;&quot;}\&quot;,{row.CreatedDate:yyyy-MM-dd},{row.PartCount ?? 0}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var timestamp = DateTime.Now.ToString(&quot;yyyyMMdd_HHmmss&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var appDataPath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);</div>
<div class="line">var mtmFolder = Path.Combine(appDataPath, &quot;MTM_Receiving_Application&quot;, &quot;Reports&quot;);</div>
<div class="line">Directory.CreateDirectory(mtmFolder);</div>
<div class="line">var filePath = Path.Combine(mtmFolder, fileName);</div>
<div class="line">await File.WriteAllTextAsync(filePath, csv.ToString());</div>
<div class="line">_logger.LogInfo($&quot;CSV exported successfully to {filePath}&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Success(filePath);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error exporting CSV: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;string&gt;&gt; FormatForEmailAsync(</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Formatting {data.Count} records for email&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(&quot;&lt;p&gt;No data to display&lt;/p&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var html = new StringBuilder();</div>
<div class="line">html.AppendLine(&quot;&lt;table style=&#39;border-collapse: collapse; width: 100%;&#39;&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine(&quot;&lt;thead&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;tr style=&#39;background-color: #f0f0f0; font-weight: bold;&#39;&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;PO Number&lt;/th&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Part&lt;/th&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Description&lt;/th&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Qty&lt;/th&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Weight&lt;/th&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Heat/Lot&lt;/th&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Date&lt;/th&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Type&lt;/th&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Specs&lt;/th&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Deliver To&lt;/th&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Department&lt;/th&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Package Description&lt;/th&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine(&quot;&lt;th style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;Data&lt;/th&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine(&quot;&lt;/tr&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;/thead&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;tbody&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine($&quot;&lt;tr style=&#39;background-color: {bgColor};&#39;&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.PONumber ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.PartNumber ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.PartDescription ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.Quantity ?? 0}&lt;/td&gt;&quot;);</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.WeightLbs ?? 0}&lt;/td&gt;&quot;);</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.HeatLotNumber ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.CreatedDate:yyyy-MM-dd}&lt;/td&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.DunnageType ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.SpecsCombined ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.DeliverTo ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.Department ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">html.AppendLine($&quot;&lt;td style=&#39;border: 1px solid #ddd; padding: 8px;&#39;&gt;{row.PackageDescription ?? &quot;&quot;}&lt;/td&gt;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">html.AppendLine(&quot;&lt;/tbody&gt;&quot;);</div>
<div class="line">html.AppendLine(&quot;&lt;/table&gt;&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Success(html.ToString());</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error formatting email: {ex.Message}&quot;, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md420"></a>
File: Module_Reporting/ViewModels/ViewModel_Reporting_Main.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Reporting_Main : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Reporting _reportingService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTimeOffset _startDate = DateTimeOffset.Now.AddDays(-7);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTimeOffset _endDate = DateTimeOffset.Now;</div>
<div class="line">⋮----</div>
<div class="line">_reportingService = reportingService ?? throw new ArgumentNullException(nameof(reportingService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task CheckAvailabilityAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _reportingService.CheckAvailabilityAsync(</div>
<div class="line">⋮----</div>
<div class="line">ReceivingCount = result.Data.GetValueOrDefault(&quot;Receiving&quot;, 0);</div>
<div class="line">DunnageCount = result.Data.GetValueOrDefault(&quot;Dunnage&quot;, 0);</div>
<div class="line">RoutingCount = result.Data.GetValueOrDefault(&quot;Routing&quot;, 0);</div>
<div class="line">VolvoCount = result.Data.GetValueOrDefault(&quot;Volvo&quot;, 0);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error checking availability: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task GenerateReceivingReportAsync()</div>
<div class="line">⋮----</div>
<div class="line">() =&gt; _reportingService.GetReceivingHistoryAsync(StartDate.DateTime, EndDate.DateTime));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool CanGenerateReceiving() =&gt; IsReceivingChecked &amp;&amp; IsReceivingEnabled &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task GenerateDunnageReportAsync()</div>
<div class="line">⋮----</div>
<div class="line">() =&gt; _reportingService.GetDunnageHistoryAsync(StartDate.DateTime, EndDate.DateTime));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool CanGenerateDunnage() =&gt; IsDunnageChecked &amp;&amp; IsDunnageEnabled &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task GenerateRoutingReportAsync()</div>
<div class="line">⋮----</div>
<div class="line">() =&gt; _reportingService.GetRoutingHistoryAsync(StartDate.DateTime, EndDate.DateTime));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool CanGenerateRouting() =&gt; IsRoutingChecked &amp;&amp; IsRoutingEnabled &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task GenerateVolvoReportAsync()</div>
<div class="line">⋮----</div>
<div class="line">() =&gt; _reportingService.GetVolvoHistoryAsync(StartDate.DateTime, EndDate.DateTime));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool CanGenerateVolvo() =&gt; IsVolvoChecked &amp;&amp; IsVolvoEnabled &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ExportToCSVAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _reportingService.ExportToCSVAsync(</div>
<div class="line">ReportData.ToList(),</div>
<div class="line">⋮----</div>
<div class="line">if (result.IsSuccess &amp;&amp; !string.IsNullOrEmpty(result.Data))</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;CSV exported: {result.Data}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error exporting CSV: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private bool CanExport() =&gt; ReportData.Count &gt; 0 &amp;&amp; !string.IsNullOrEmpty(CurrentModuleName) &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task CopyEmailFormatAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _reportingService.FormatForEmailAsync(</div>
<div class="line">⋮----</div>
<div class="line">dataPackage.SetHtmlFormat(result.Data);</div>
<div class="line">dataPackage.SetText(result.Data);</div>
<div class="line">Windows.ApplicationModel.DataTransfer.Clipboard.SetContent(dataPackage);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Email format copied to clipboard&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error copying email format: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private bool CanCopyEmail() =&gt; ReportData.Count &gt; 0 &amp;&amp; !IsBusy;</div>
<div class="line"><span class="keyword">private</span> async Task GenerateReportForModuleAsync(</div>
<div class="line">⋮----</div>
<div class="line">ReportData.Clear();</div>
<div class="line">⋮----</div>
<div class="line">ReportData.Add(row);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Generated {moduleName} report: {ReportData.Count} records&quot;);</div>
<div class="line">ExportToCSVCommand.NotifyCanExecuteChanged();</div>
<div class="line">CopyEmailFormatCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error generating {moduleName} report: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnIsReceivingCheckedChanged(bool value)</div>
<div class="line">⋮----</div>
<div class="line">GenerateReceivingReportCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnIsDunnageCheckedChanged(bool value)</div>
<div class="line">⋮----</div>
<div class="line">GenerateDunnageReportCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnIsRoutingCheckedChanged(bool value)</div>
<div class="line">⋮----</div>
<div class="line">GenerateRoutingReportCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnIsVolvoCheckedChanged(bool value)</div>
<div class="line">⋮----</div>
<div class="line">GenerateVolvoReportCommand.NotifyCanExecuteChanged();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md421"></a>
File: Module_Routing/Converters/IntToFontWeightConverter.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>IntToFontWeightConverter : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">if (value is int currentStep &amp;&amp; parameter is string stepStr &amp;&amp; int.TryParse(stepStr, out int step))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md422"></a>
File: Module_Routing/Converters/IntToProgressBrushConverter.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>IntToProgressBrushConverter : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">if (value is int currentStep &amp;&amp; parameter is string stepStr &amp;&amp; int.TryParse(stepStr, out int step))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md423"></a>
File: Module_Routing/Converters/NullToBooleanConverter.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>NullToBooleanConverter : IValueConverter</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object Convert(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> object ConvertBack(object? value, Type targetType, object? parameter, string language)</div>
<div class="line">⋮----</div>
<div class="line">throw new NotImplementedException();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md424"></a>
File: Module_Routing/Data/Dao_RoutingOtherReason.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_RoutingOtherReason</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingOtherReason&gt;&gt;&gt; GetAllActiveReasonsAsync()</div>
<div class="line">⋮----</div>
<div class="line">private Model_RoutingOtherReason MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_RoutingOtherReason</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">ReasonCode = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;reason_code&quot;</span>)),</div>
<div class="line">Description = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;description&quot;</span>)),</div>
<div class="line">IsActive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_active&quot;</span>)),</div>
<div class="line">DisplayOrder = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;display_order&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md425"></a>
File: Module_Routing/Data/Dao_RoutingUsageTracking.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_RoutingUsageTracking</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; IncrementUsageAsync(<span class="keywordtype">int</span> employeeNumber, <span class="keywordtype">int</span> recipientId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_employee_number&quot;</span>, employeeNumber),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_recipient_id&quot;</span>, recipientId),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_status&quot;</span>, MySqlDbType.Int32) { Direction = System.Data.ParameterDirection.Output },</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_error_msg&quot;</span>, MySqlDbType.VarChar, 500) { Direction = System.Data.ParameterDirection.Output }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Error incrementing usage: {ex.Message}&quot;</span>, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md426"></a>
File: Module_Routing/Data/Dao_RoutingUserPreference.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_RoutingUserPreference</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_RoutingUserPreference&gt;&gt; GetUserPreferenceAsync(<span class="keywordtype">int</span> employeeNumber)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; SaveUserPreferenceAsync(Model_RoutingUserPreference preference)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_employee_number&quot;</span>, preference.EmployeeNumber),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_default_mode&quot;</span>, preference.DefaultMode),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_enable_validation&quot;</span>, preference.EnableValidation),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_status&quot;</span>, MySqlDbType.Int32) { Direction = System.Data.ParameterDirection.Output },</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_error_msg&quot;</span>, MySqlDbType.VarChar, 500) { Direction = System.Data.ParameterDirection.Output }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Error saving user preference: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_RoutingUserPreference MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_RoutingUserPreference</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">EmployeeNumber = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;employee_number&quot;</span>)),</div>
<div class="line">DefaultMode = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;default_mode&quot;</span>)),</div>
<div class="line">EnableValidation = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;enable_validation&quot;</span>)),</div>
<div class="line">UpdatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;updated_date&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md427"></a>
File: Module_Routing/Models/Model_InforVisualPOLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_InforVisualPOLine</div>
<div class="line">⋮----</div>
<div class="line">public string QuantityOrderedDisplay =&gt; QuantityOrdered.ToString(<span class="stringliteral">&quot;G29&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">? Specifications.Substring(0, 50) + <span class="stringliteral">&quot;...&quot;</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(WorkOrder)) <span class="keywordflow">return</span> $<span class="stringliteral">&quot;WO: {WorkOrder}&quot;</span>;</div>
<div class="line"><span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(CustomerOrder)) <span class="keywordflow">return</span> $<span class="stringliteral">&quot;CO: {CustomerOrder}&quot;</span>;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md428"></a>
File: Module_Routing/Models/Model_RoutingLabel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_RoutingLabel</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md429"></a>
File: Module_Routing/Services/IRoutingRecipientService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">interface </span>IRoutingRecipientService</div>
<div class="line">⋮----</div>
<div class="line">public Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetActiveRecipientsSortedByUsageAsync(int employeeNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetAllRecipientsAsync();</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;Model_RoutingRecipient&gt;&gt; GetRecipientByIdAsync(<span class="keywordtype">int</span> recipientId);</div>
<div class="line"><span class="keyword">public</span> List&lt;Model_RoutingRecipient&gt; FilterRecipients(List&lt;Model_RoutingRecipient&gt; recipients, <span class="keywordtype">string</span> searchText);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetQuickAddRecipientsAsync(<span class="keywordtype">int</span> employeeNumber);</div>
<div class="line"><span class="keyword">public</span> Task&lt;Model_Dao_Result&lt;bool&gt;&gt; ValidateRecipientExistsAsync(<span class="keywordtype">int</span> recipientId);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md430"></a>
File: Module_Routing/Services/RoutingRecipientService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>RoutingRecipientService : IRoutingRecipientService</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_RoutingRecipient _daoRecipient;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_daoRecipient = daoRecipient ?? throw new ArgumentNullException(nameof(daoRecipient));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetActiveRecipientsSortedByUsageAsync(int employeeNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting active recipients sorted by usage for employee {employeeNumber}&quot;);</div>
<div class="line">return await _daoRecipient.GetAllActiveRecipientsAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting active recipients: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetAllRecipientsAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Getting all recipients (including inactive)&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting all recipients: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_RoutingRecipient&gt;&gt; GetRecipientByIdAsync(int recipientId)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting recipient by ID: {recipientId}&quot;);</div>
<div class="line">var result = await _daoRecipient.GetAllActiveRecipientsAsync();</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(recipient);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting recipient {recipientId}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> List&lt;Model_RoutingRecipient&gt; FilterRecipients(List&lt;Model_RoutingRecipient&gt; recipients, string searchText)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(searchText))</div>
<div class="line">⋮----</div>
<div class="line">var search = searchText.ToLowerInvariant();</div>
<div class="line">return recipients.Where(r =&gt;</div>
<div class="line">r.Name.ToLowerInvariant().Contains(search) ||</div>
<div class="line">(r.Location?.ToLowerInvariant().Contains(search) ?? false) ||</div>
<div class="line">(r.Department?.ToLowerInvariant().Contains(search) ?? false)</div>
<div class="line">).ToList();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRecipient&gt;&gt;&gt; GetQuickAddRecipientsAsync(int employeeNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting Quick Add recipients for employee {employeeNumber}&quot;);</div>
<div class="line">return await _daoRecipient.GetTopRecipientsByUsageAsync(employeeNumber, 5);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting Quick Add recipients: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; ValidateRecipientExistsAsync(int recipientId)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(recipientResult.IsSuccess);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error validating recipient {recipientId}: {ex.Message}&quot;, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md431"></a>
File: Module_Routing/Services/RoutingUserPreferenceService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>RoutingUserPreferenceService : IRoutingUserPreferenceService</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_RoutingUserPreference _daoUserPreference;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_daoUserPreference = daoUserPreference ?? throw new ArgumentNullException(nameof(daoUserPreference));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_RoutingUserPreference&gt;&gt; GetUserPreferenceAsync(int employeeNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting user preference for employee {employeeNumber}&quot;);</div>
<div class="line">var result = await _daoUserPreference.GetUserPreferenceAsync(employeeNumber);</div>
<div class="line">⋮----</div>
<div class="line">var defaultPreference = new Model_RoutingUserPreference</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(defaultPreference);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting user preference for employee {employeeNumber}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; SaveUserPreferenceAsync(Model_RoutingUserPreference preference)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Saving user preference for employee {preference.EmployeeNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Invalid mode: {preference.DefaultMode}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return await _daoUserPreference.SaveUserPreferenceAsync(preference);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error saving user preference: {ex.Message}&quot;, ex);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error saving preferences: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; ResetToDefaultsAsync(int employeeNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Resetting preferences to defaults for employee {employeeNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return await _daoUserPreference.SaveUserPreferenceAsync(defaultPreference);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error resetting preferences: {ex.Message}&quot;, ex);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error resetting preferences: {ex.Message}&quot;, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md432"></a>
File: Module_Routing/ViewModels/RoutingEditModeViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>RoutingEditModeViewModel : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingService _routingService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingRecipientService _recipientService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var labelsResult = await _routingService.GetAllLabelsAsync(limit: 1000, offset: 0);</div>
<div class="line">⋮----</div>
<div class="line">Labels.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Labels.Add(label);</div>
<div class="line">⋮----</div>
<div class="line">var recipientsResult = await _recipientService.GetActiveRecipientsSortedByUsageAsync(0);</div>
<div class="line">⋮----</div>
<div class="line">AllRecipients.Clear();</div>
<div class="line">⋮----</div>
<div class="line">AllRecipients.Add(recipient);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Module_Core.Models.Enums.Enum_ErrorSeverity.Medium,</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSearchTextChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">private void ApplySearchFilter()</div>
<div class="line">⋮----</div>
<div class="line">FilteredLabels.Clear();</div>
<div class="line">⋮----</div>
<div class="line">var filtered = string.IsNullOrWhiteSpace(searchLower)</div>
<div class="line">? Labels.ToList()</div>
<div class="line">: Labels.Where(l =&gt;</div>
<div class="line">(l.PONumber?.ToLower().Contains(searchLower) ?? false) ||</div>
<div class="line">(l.RecipientName?.ToLower().Contains(searchLower) ?? false) ||</div>
<div class="line">(l.Description?.ToLower().Contains(searchLower) ?? false)</div>
<div class="line">).ToList();</div>
<div class="line">⋮----</div>
<div class="line">FilteredLabels.Add(label);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SaveEditedLabelAsync(Model_RoutingLabel editedLabel)</div>
<div class="line">⋮----</div>
<div class="line">var updateResult = await _routingService.UpdateLabelAsync(editedLabel, currentEmployeeNumber);</div>
<div class="line">⋮----</div>
<div class="line">var index = Labels.IndexOf(SelectedLabel);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(updateResult.ErrorMessage, &quot;Update Failed&quot;, nameof(SaveEditedLabelAsync));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task CompareAndLogChangesAsync(Model_RoutingLabel oldLabel, Model_RoutingLabel newLabel)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ReprintLabelAsync()</div>
<div class="line">⋮----</div>
<div class="line">var exportResult = await _routingService.ExportLabelToCsvAsync(SelectedLabel);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(exportResult.ErrorMessage, &quot;Reprint Failed&quot;, nameof(ReprintLabelAsync));</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Module_Core.Models.Enums.Enum_ErrorSeverity.Low,</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md433"></a>
File: Module_Routing/ViewModels/RoutingManualEntryViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>RoutingManualEntryViewModel : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingService _routingService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingInforVisualService _inforVisualService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingRecipientService _recipientService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingUsageTrackingService _usageTrackingService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var recipientsResult = await _recipientService.GetAllRecipientsAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(recipientsResult.ErrorMessage, &quot;Load Failed&quot;, nameof(InitializeAsync));</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Module_Core.Models.Enums.Enum_ErrorSeverity.Medium,</div>
<div class="line">⋮----</div>
<div class="line">private void AddNewRow()</div>
<div class="line">⋮----</div>
<div class="line">var newLabel = new Model_RoutingLabel</div>
<div class="line">⋮----</div>
<div class="line">Labels.Add(newLabel);</div>
<div class="line">⋮----</div>
<div class="line">private void DeleteSelectedRow()</div>
<div class="line">⋮----</div>
<div class="line">Labels.Remove(SelectedLabel);</div>
<div class="line">⋮----</div>
<div class="line">private bool CanDeleteRow() =&gt; SelectedLabel != null &amp;&amp; !IsBusy;</div>
<div class="line"><span class="keyword">public</span> async Task ValidatePOAsync(Model_RoutingLabel label)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(label.PONumber))</div>
<div class="line">⋮----</div>
<div class="line">var poResult = await _inforVisualService.ValidatePoNumberAsync(label.PONumber);</div>
<div class="line">⋮----</div>
<div class="line">var linesResult = await _inforVisualService.GetPoLinesAsync(label.PONumber);</div>
<div class="line">⋮----</div>
<div class="line">var line = linesResult.Data.First();</div>
<div class="line">⋮----</div>
<div class="line">label.LineNumber = line.LineNumber.ToString();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error validating PO: {ex.Message}&quot;, ex, nameof(ValidatePOAsync));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SaveAllLabelsAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(string.Join(&quot;\n&quot;, validationErrors), &quot;Validation Failed&quot;, nameof(SaveAllLabelsAsync));</div>
<div class="line">⋮----</div>
<div class="line">foreach (var label in Labels.ToList())</div>
<div class="line">⋮----</div>
<div class="line">var createResult = await _routingService.CreateLabelAsync(label);</div>
<div class="line">⋮----</div>
<div class="line">await _usageTrackingService.IncrementUsageCountAsync(</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to create label: {createResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">Labels.Clear();</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Module_Core.Models.Enums.Enum_ErrorSeverity.Error,</div>
<div class="line">⋮----</div>
<div class="line">private bool CanSaveAll() =&gt; !IsBusy &amp;&amp; Labels.Count &gt; 0;</div>
<div class="line"><span class="keyword">private</span> System.Collections.Generic.List&lt;string&gt; ValidateAllRows()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(label.PONumber) &amp;&amp; !label.OtherReasonId.HasValue)</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Row {rowNum}: PO Number or OTHER reason required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Row {rowNum}: Recipient required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Row {rowNum}: Quantity must be greater than 0&quot;);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedLabelChanged(Model_RoutingLabel? value)</div>
<div class="line">⋮----</div>
<div class="line">DeleteSelectedRowCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnLabelsChanged(ObservableCollection&lt;Model_RoutingLabel&gt; value)</div>
<div class="line">⋮----</div>
<div class="line">SaveAllLabelsCommand.NotifyCanExecuteChanged();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md434"></a>
File: Module_Routing/Views/RoutingModeSelectionView.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Routing.Views.RoutingModeSelectionView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;32&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">                </div>
<div class="line">                <span class="comment">&lt;!-- Wizard Mode Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectWizardModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Wizard Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE82D;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Wizard Mode&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Step-by-step guided workflow with Quick Add buttons.&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> </div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                        <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsWizardDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetWizardAsDefaultCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Manual Entry Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectManualEntryModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Manual Entry Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE745;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Manual Entry&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Batch entry using editable grid. Ideal for creating multiple labels quickly.&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                              <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsManualDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetManualAsDefaultCommand}&quot;</span></div>
<div class="line">                              <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Edit Mode Column --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectEditModeCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;280&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;180&quot;</span></div>
<div class="line">                            <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                            <span class="keyword">AutomationProperties.Name</span>=<span class="stringliteral">&quot;Edit Mode&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE70F;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;48&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Edit Mode&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Search and edit existing labels. Supports reprinting and audit trail.&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyTextBlockStyle}&quot;</span></div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                                       <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">CheckBox</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Set as default mode&quot;</span></div>
<div class="line">                              <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsEditDefault, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SetEditAsDefaultCommand}&quot;</span></div>
<div class="line">                              <span class="keyword">CommandParameter</span>=<span class="stringliteral">&quot;{Binding IsChecked, RelativeSource={RelativeSource Self}}&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md435"></a>
File: Module_Routing/Views/RoutingWizardContainerView.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Routing.Views.RoutingWizardContainerView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:vm</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:views</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.Views&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.Converters&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:coreConverters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:IntToFontWeightConverter</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToFontWeightConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:IntToProgressBrushConverter</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToProgressBrushConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">coreConverters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header with Cancel Button --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;Routing Label - Wizard Mode&quot;</span> </div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CancelCommand}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Progress Indicator --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span> </div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Step 1 Indicator --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Border</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;4&quot;</span> </div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource AccentFillColorDefaultBrush}&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;2&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;1. PO Selection&quot;</span> </div>
<div class="line">                               <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                               <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentStep, Mode=OneWay, Converter={StaticResource IntToFontWeightConverter}, ConverterParameter=1}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Step 2 Indicator --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;8,0&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Border</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;4&quot;</span> </div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentStep, Mode=OneWay, Converter={StaticResource IntToProgressBrushConverter}, ConverterParameter=2}&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;2&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;2. Recipient&quot;</span> </div>
<div class="line">                               <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                               <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentStep, Mode=OneWay, Converter={StaticResource IntToFontWeightConverter}, ConverterParameter=2}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Step 3 Indicator --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Border</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;4&quot;</span> </div>
<div class="line">                            <span class="keyword">Background</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentStep, Mode=OneWay, Converter={StaticResource IntToProgressBrushConverter}, ConverterParameter=3}&quot;</span></div>
<div class="line">                            <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;2&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;3. Review&quot;</span> </div>
<div class="line">                               <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                               <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentStep, Mode=OneWay, Converter={StaticResource IntToFontWeightConverter}, ConverterParameter=3}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Step Content (UserControl hosting) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Step 1: PO Selection --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:RoutingWizardStep1View</span> </div>
<div class="line">                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentStep, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=1}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Step 2: Recipient Selection --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:RoutingWizardStep2View</span> </div>
<div class="line">                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentStep, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=2}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Step 3: Review --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">views:RoutingWizardStep3View</span> </div>
<div class="line">                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CurrentStep, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=3}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md436"></a>
File: Module_Routing/Views/RoutingWizardStep2View.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Routing.Views.RoutingWizardStep2View&quot;</span></div>
<div class="line">    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;RootPage&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:vm</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:coreConverters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">coreConverters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">coreConverters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                   <span class="keyword">Text</span>=<span class="stringliteral">&quot;Step 2: Recipient Selection&quot;</span> </div>
<div class="line">                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Search Box --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE721;&quot;</span> </div>
<div class="line">                         <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                         <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Search Recipients&quot;</span> </div>
<div class="line">                          <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBox</span> <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Search by name, location, or department&quot;</span></div>
<div class="line">                     <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Recipients List --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> </div>
<div class="line">                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ListView</span> <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FilteredRecipients, Mode=OneWay}&quot;</span></div>
<div class="line">                      <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedRecipient, Mode=TwoWay}&quot;</span></div>
<div class="line">                      <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                      <span class="keyword">KeyDown</span>=<span class="stringliteral">&quot;ListView_KeyDown&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ListView.HeaderTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Name&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Location&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Department&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ListView.HeaderTemplate</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_RoutingRecipient&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind Name}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind Location}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind Department}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">ListView</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                          <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                       <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Back&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NavigateBackToStep1Command}&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsEditingFromReview, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NavigationButtonText, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ProceedToStep3Command}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md437"></a>
File: Module_Settings/Data/Dao_PackageTypeMappings.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_PackageTypeMappings</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_PackageTypeMapping&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">string</span>&gt;&gt; GetByPrefixAsync(<span class="keywordtype">string</span> partPrefix)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;package_type&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;package_type&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; InsertAsync(Model_PackageTypeMapping mapping, <span class="keywordtype">int</span> createdBy)</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_PackageTypeMapping mapping)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">private static Model_PackageTypeMapping MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_PackageTypeMapping</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">PartPrefix = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;part_prefix&quot;</span>)),</div>
<div class="line">PackageType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;package_type&quot;</span>)),</div>
<div class="line">IsDefault = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_default&quot;</span>)),</div>
<div class="line">DisplayOrder = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;display_order&quot;</span>)),</div>
<div class="line">IsActive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_active&quot;</span>)),</div>
<div class="line">CreatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_at&quot;</span>)),</div>
<div class="line">UpdatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;updated_at&quot;</span>)),</div>
<div class="line">CreatedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)) ? null : reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md438"></a>
File: Module_Settings/Data/Dao_ScheduledReport.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_ScheduledReport</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ScheduledReport&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_ScheduledReport&gt;&gt; GetByIdAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_ScheduledReport&gt;&gt;&gt; GetDueAsync()</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_ScheduledReport&gt;&gt;&gt; GetActiveAsync()</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; InsertAsync(Model_ScheduledReport report, <span class="keywordtype">int</span> createdBy)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_ScheduledReport report)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateLastRunAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, DateTime lastRunDate, DateTime nextRunDate)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; ToggleActiveAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">bool</span> isActive)</div>
<div class="line">⋮----</div>
<div class="line">private static Model_ScheduledReport MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_ScheduledReport</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">ReportType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;report_type&quot;</span>)),</div>
<div class="line">Schedule = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;schedule&quot;</span>)),</div>
<div class="line">EmailRecipients = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;email_recipients&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;email_recipients&quot;</span>)),</div>
<div class="line">IsActive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_active&quot;</span>)),</div>
<div class="line">NextRunDate = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;next_run_date&quot;</span>)) ? null : reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;next_run_date&quot;</span>)),</div>
<div class="line">LastRunDate = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;last_run_date&quot;</span>)) ? null : reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;last_run_date&quot;</span>)),</div>
<div class="line">CreatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_at&quot;</span>)),</div>
<div class="line">UpdatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;updated_at&quot;</span>)),</div>
<div class="line">CreatedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)) ? null : reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md439"></a>
File: Module_Settings/Data/Dao_SystemSettings.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_SystemSettings</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_SystemSetting&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_SystemSetting&gt;&gt;&gt; GetByCategoryAsync(<span class="keywordtype">string</span> category)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_SystemSetting&gt;&gt; GetByKeyAsync(<span class="keywordtype">string</span> category, <span class="keywordtype">string</span> settingKey)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateValueAsync(</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; ResetToDefaultAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; SetLockedAsync(</div>
<div class="line">⋮----</div>
<div class="line">private static Model_SystemSetting MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_SystemSetting</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">Category = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;category&quot;</span>)),</div>
<div class="line">SubCategory = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;sub_category&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;sub_category&quot;</span>)),</div>
<div class="line">SettingKey = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_key&quot;</span>)),</div>
<div class="line">SettingName = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_name&quot;</span>)),</div>
<div class="line">Description = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;description&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;description&quot;</span>)),</div>
<div class="line">SettingValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;setting_value&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_value&quot;</span>)),</div>
<div class="line">DefaultValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;default_value&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;default_value&quot;</span>)),</div>
<div class="line">DataType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;data_type&quot;</span>)),</div>
<div class="line">Scope = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;scope&quot;</span>)),</div>
<div class="line">PermissionLevel = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;permission_level&quot;</span>)),</div>
<div class="line">IsLocked = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_locked&quot;</span>)),</div>
<div class="line">IsSensitive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_sensitive&quot;</span>)),</div>
<div class="line">ValidationRules = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;validation_rules&quot;</span>)) ? null : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;validation_rules&quot;</span>)),</div>
<div class="line">UiControlType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;ui_control_type&quot;</span>)),</div>
<div class="line">UiOrder = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;ui_order&quot;</span>)),</div>
<div class="line">CreatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_at&quot;</span>)),</div>
<div class="line">UpdatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;updated_at&quot;</span>)),</div>
<div class="line">UpdatedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;updated_by&quot;</span>)) ? null : reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;updated_by&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md440"></a>
File: Module_Settings/Data/Dao_UserSettings.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_UserSettings</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_SettingValue&gt;&gt; GetAsync(<span class="keywordtype">int</span> userId, <span class="keywordtype">string</span> category, <span class="keywordtype">string</span> settingKey)</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_UserSetting&gt;&gt;&gt; GetAllForUserAsync(<span class="keywordtype">int</span> userId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; SetAsync(<span class="keywordtype">int</span> userId, <span class="keywordtype">int</span> settingId, <span class="keywordtype">string</span> value)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; ResetAsync(<span class="keywordtype">int</span> userId, <span class="keywordtype">int</span> settingId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; ResetAllAsync(<span class="keywordtype">int</span> userId, <span class="keywordtype">int</span> changedBy)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;reset_count&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Model_SettingValue MapToSettingValue(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_SettingValue</div>
<div class="line">⋮----</div>
<div class="line">RawValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;effective_value&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;effective_value&quot;</span>)),</div>
<div class="line">DataType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;data_type&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Model_UserSetting MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_UserSetting</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;setting_id&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">SettingId = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;setting_id&quot;</span>)),</div>
<div class="line">SettingValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;user_override&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;user_override&quot;</span>)),</div>
<div class="line">SystemSetting = <span class="keyword">new</span> Model_SystemSetting</div>
<div class="line">⋮----</div>
<div class="line">Category = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;category&quot;</span>)),</div>
<div class="line">SettingKey = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_key&quot;</span>)),</div>
<div class="line">SettingName = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_name&quot;</span>)),</div>
<div class="line">SettingValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;system_default&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;system_default&quot;</span>)),</div>
<div class="line">DataType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;data_type&quot;</span>)),</div>
<div class="line">UiControlType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;ui_control_type&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md441"></a>
File: Module_Settings/Models/Model_PackageType.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_PackageType : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdAt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _updatedAt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md442"></a>
File: Module_Settings/Models/Model_PackageTypeMapping.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_PackageTypeMapping : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdAt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _updatedAt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md443"></a>
File: Module_Settings/Models/Model_RoutingRule.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_RoutingRule : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdAt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _updatedAt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md444"></a>
File: Module_Settings/Models/Model_ScheduledReport.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_ScheduledReport : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdAt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _updatedAt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md445"></a>
File: Module_Settings/Models/Model_SettingsAuditLog.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_SettingsAuditLog : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _changedAt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md446"></a>
File: Module_Settings/Models/Model_SystemSetting.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_SystemSetting : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdAt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _updatedAt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md447"></a>
File: Module_Settings/Models/Model_UserSetting.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_UserSetting : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _createdAt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _updatedAt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md448"></a>
File: Module_Settings/Views/View_Settings_DatabaseTest.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Page</span> <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Settings.Views.View_Settings_DatabaseTest&quot;</span></div>
<div class="line">      <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:icons</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Settings.ViewModels&quot;</span></div>
<div class="line">      <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Settings.Models&quot;</span></div>
<div class="line">      <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">      <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;40,20,40,40&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span> /&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Settings Database Test&quot;</span></div>
<div class="line">                                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span> /&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=&quot;<span class="keyword">Development</span> <span class="keyword">Tool</span> - <span class="keyword">Schema</span> &amp;<span class="keyword">amp</span>; <span class="keyword">Stored</span> <span class="keyword">Procedure</span> <span class="keyword">Validation</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                   Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                    &lt;Button Grid.Column=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Content=&quot;</span><span class="keyword">Refresh</span> <span class="keyword">All</span> <span class="keyword">Tests</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Command=&quot;</span>{<span class="keyword">Binding</span> <span class="keyword">RunAllTestsCommand</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">AccentButtonStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Height=&quot;</span>36<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Padding=&quot;</span>20,0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;Button.KeyboardAccelerators&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;KeyboardAccelerator Key=&quot;</span><span class="keyword">F5</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/Button.KeyboardAccelerators&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/Button&gt;</span></div>
<div class="line"><span class="stringliteral">                &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                &lt;!-- Connection Status Card --&gt;</span></div>
<div class="line"><span class="stringliteral">                &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardBackgroundFillColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        CornerRadius=&quot;</span>8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        Padding=&quot;</span>20<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;StackPanel Spacing=&quot;</span>12<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;TextBlock Text=&quot;</span><span class="keyword">Database</span> <span class="keyword">Connection</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                   Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">SubtitleTextBlockStyle</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                        &lt;!-- Success Status (use visible when connected) --&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;StackPanel Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Spacing=&quot;</span>12<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;Border Width=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Height=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    CornerRadius=&quot;</span>10<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Background=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;icons:MaterialIcon Kind=&quot;</span><span class="keyword">Check</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                    Width=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                    Height=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                    Foreground=&quot;</span><span class="keyword">White</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.ConnectionStatus</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                        &lt;TextBlock Text=&quot;</span><span class="keyword">Connection</span> <span class="keyword">details</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                   Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                &lt;!-- Summary Cards Row --&gt;</span></div>
<div class="line"><span class="stringliteral">                &lt;Grid ColumnSpacing=&quot;</span>20<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                    &lt;!-- Tables Card --&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;Border Grid.Column=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardBackgroundFillColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            CornerRadius=&quot;</span>8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Padding=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            MinHeight=&quot;</span>120<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;StackPanel Spacing=&quot;</span>8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">Tables</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">BodyTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;StackPanel Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Spacing=&quot;</span>4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.TablesValidated</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>36<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>/<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>28<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.TotalTables</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>28<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">All</span> <span class="keyword">tables</span> <span class="keyword">validated</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">✓</span> <span class="keyword">Indexes</span> <span class="keyword">OK</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                    &lt;!-- Stored Procedures Card --&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;Border Grid.Column=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardBackgroundFillColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            CornerRadius=&quot;</span>8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Padding=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            MinHeight=&quot;</span>120<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;StackPanel Spacing=&quot;</span>8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">Stored</span> <span class="keyword">Procedures</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">BodyTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;StackPanel Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Spacing=&quot;</span>4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.StoredProceduresTested</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>36<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>/<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>28<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.TotalStoredProcedures</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>28<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">All</span> <span class="keyword">procedures</span> <span class="keyword">tested</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">✓</span> <span class="keyword">No</span> <span class="keyword">errors</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                    &lt;!-- Data Seeding Card --&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;Border Grid.Column=&quot;</span>2<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardBackgroundFillColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            CornerRadius=&quot;</span>8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Padding=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            MinHeight=&quot;</span>120<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;StackPanel Spacing=&quot;</span>8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">Data</span> <span class="keyword">Seeding</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">BodyTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.SettingsSeeded</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       FontSize=&quot;</span>36<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">Settings</span> <span class="keyword">inserted</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">✓</span> <span class="keyword">All</span> <span class="keyword">categories</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                    &lt;!-- DAOs Card --&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;Border Grid.Column=&quot;</span>3<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardBackgroundFillColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            CornerRadius=&quot;</span>8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            Padding=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                            MinHeight=&quot;</span>120<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;StackPanel Spacing=&quot;</span>8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">DAO</span> <span class="keyword">Tests</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">BodyTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;StackPanel Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Spacing=&quot;</span>4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.DaosTested</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>36<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>/<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>28<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.TotalDaos</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontSize=&quot;</span>28<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">All</span> <span class="keyword">DAOs</span> <span class="keyword">operational</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">✓</span> <span class="keyword">CRUD</span> <span class="keyword">verified</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                &lt;!-- Test Results Tabs --&gt;</span></div>
<div class="line"><span class="stringliteral">                &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardBackgroundFillColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        CornerRadius=&quot;</span>8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;Grid.RowDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;RowDefinition Height=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;RowDefinition Height=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/Grid.RowDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                        &lt;!-- Tab Header --&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;Border Grid.Row=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;StackPanel Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Spacing=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Height=&quot;</span>48<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;Button Content=&quot;</span><span class="keyword">Schema</span> <span class="keyword">Tests</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        x:Name=&quot;</span><span class="keyword">SchemaTabButton</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        MinWidth=&quot;</span>150<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Height=&quot;</span>48<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Background=&quot;</span><span class="keyword">Transparent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        BorderThickness=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        CornerRadius=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Click=&quot;</span><span class="keyword">OnSchemaTabClick</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;Button Content=&quot;</span><span class="keyword">SP</span> <span class="keyword">Tests</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        x:Name=&quot;</span><span class="keyword">SpTabButton</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        MinWidth=&quot;</span>150<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Height=&quot;</span>48<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Background=&quot;</span><span class="keyword">Transparent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        BorderThickness=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        CornerRadius=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Click=&quot;</span><span class="keyword">OnStoredProceduresTabClick</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;Button Content=&quot;</span><span class="keyword">DAO</span> <span class="keyword">Tests</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        x:Name=&quot;</span><span class="keyword">DaoTabButton</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        MinWidth=&quot;</span>150<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Height=&quot;</span>48<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Background=&quot;</span><span class="keyword">Transparent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        BorderThickness=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        CornerRadius=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Click=&quot;</span><span class="keyword">OnDaosTabClick</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;Button Content=&quot;</span><span class="keyword">Logs</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        x:Name=&quot;</span><span class="keyword">LogsTabButton</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        MinWidth=&quot;</span>150<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Height=&quot;</span>48<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Background=&quot;</span><span class="keyword">Transparent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        BorderThickness=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        CornerRadius=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Click=&quot;</span><span class="keyword">OnLogsTabClick</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                        &lt;!-- Tab Content --&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;ScrollViewer Grid.Row=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                      MaxHeight=&quot;</span>400<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                      Padding=&quot;</span>20<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;!-- Schema Tab --&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;StackPanel x:Name=&quot;</span><span class="keyword">SchemaTabContent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Spacing=&quot;</span>16<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Table</span> <span class="keyword">Validation</span> <span class="keyword">Results</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">SubtitleTextBlockStyle</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                    &lt;!-- Table Result Items --&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;ItemsControl ItemsSource=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.TableResults</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;DataTemplate x:DataType=&quot;</span><span class="keyword">models:Model_TableTestResult</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Margin=&quot;</span>0,0,0,12<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                        &lt;StackPanel Grid.Column=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                    Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                    Spacing=&quot;</span>12<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                    VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Border Width=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                    Height=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                    CornerRadius=&quot;</span>10<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                    Background=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                                &lt;icons:MaterialIcon Kind=&quot;</span><span class="keyword">Check</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                                    Width=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                                    Height=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                                    Foreground=&quot;</span><span class="keyword">White</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">TableName</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                           FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">Details</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                           Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                           Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                        &lt;Border Grid.Column=&quot;</span>2<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                BorderBrush=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                CornerRadius=&quot;</span>4<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                Padding=&quot;</span>12,4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">StatusText</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                       Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/DataTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;/ItemsControl&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                    &lt;!-- Legacy hardcoded items removed --&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;StackPanel Spacing=&quot;</span>12<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                Visibility=&quot;</span><span class="keyword">Collapsed</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                        &lt;!-- Table 1: settings_universal --&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                Padding=&quot;</span>12,8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;StackPanel Grid.Column=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Spacing=&quot;</span>12<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;Border Width=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Height=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            CornerRadius=&quot;</span>10<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Background=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;icons:MaterialIcon Kind=&quot;</span><span class="keyword">Check</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Width=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Height=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Foreground=&quot;</span><span class="keyword">White</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Text=&quot;</span><span class="keyword">settings_universal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Run Text=&quot;</span>79 <span class="keyword">rows</span> | 18 <span class="keyword">columns</span> | 3 <span class="keyword">indexes</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/TextBlock&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;Border Grid.Column=&quot;</span>2<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        CornerRadius=&quot;</span>4<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Validated</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                        &lt;!-- Table 2: settings_personal --&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                Padding=&quot;</span>12,8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;StackPanel Grid.Column=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Spacing=&quot;</span>12<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;Border Width=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Height=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            CornerRadius=&quot;</span>10<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Background=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;icons:MaterialIcon Kind=&quot;</span><span class="keyword">Check</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Width=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Height=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Foreground=&quot;</span><span class="keyword">White</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Text=&quot;</span><span class="keyword">settings_personal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Run Text=&quot;</span>0 <span class="keyword">rows</span> | 5 <span class="keyword">columns</span> | 1 <span class="keyword">unique</span> <span class="keyword">constraint</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/TextBlock&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;Border Grid.Column=&quot;</span>2<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        CornerRadius=&quot;</span>4<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Validated</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                        &lt;!-- Table 3: dunnage_types --&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                Padding=&quot;</span>12,8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;StackPanel Grid.Column=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Spacing=&quot;</span>12<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;Border Width=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Height=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            CornerRadius=&quot;</span>10<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Background=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;icons:MaterialIcon Kind=&quot;</span><span class="keyword">Check</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Width=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Height=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Foreground=&quot;</span><span class="keyword">White</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Text=&quot;</span><span class="keyword">dunnage_types</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Run Text=&quot;</span>5 <span class="keyword">rows</span> | 5 <span class="keyword">columns</span> | 2 <span class="keyword">unique</span> <span class="keyword">constraints</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/TextBlock&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;Border Grid.Column=&quot;</span>2<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        CornerRadius=&quot;</span>4<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Validated</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                        &lt;!-- Table 4: routing_home_locations --&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                Padding=&quot;</span>12,8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;StackPanel Grid.Column=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Spacing=&quot;</span>12<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;Border Width=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Height=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            CornerRadius=&quot;</span>10<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Background=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;icons:MaterialIcon Kind=&quot;</span><span class="keyword">Check</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Width=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Height=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Foreground=&quot;</span><span class="keyword">White</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Text=&quot;</span><span class="keyword">routing_home_locations</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Run Text=&quot;</span>3 <span class="keyword">rows</span> | 7 <span class="keyword">columns</span> | 1 <span class="keyword">index</span> <span class="keyword">on</span> <span class="keyword">priority</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/TextBlock&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;Border Grid.Column=&quot;</span>2<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        CornerRadius=&quot;</span>4<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Validated</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                        &lt;!-- Table 5: reporting_scheduled_reports --&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                Padding=&quot;</span>12,8<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;StackPanel Grid.Column=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Spacing=&quot;</span>12<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;Border Width=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Height=&quot;</span>20<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            CornerRadius=&quot;</span>10<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                            Background=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;icons:MaterialIcon Kind=&quot;</span><span class="keyword">Check</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Width=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Height=&quot;</span>14<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                            Foreground=&quot;</span><span class="keyword">White</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Text=&quot;</span><span class="keyword">reporting_scheduled_reports</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Run Text=&quot;</span>2 <span class="keyword">rows</span> | 8 <span class="keyword">columns</span> | 2 <span class="keyword">indexes</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/TextBlock&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                &lt;Border Grid.Column=&quot;</span>2<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        CornerRadius=&quot;</span>4<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Validated</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                               Foreground=&quot;</span>#107<span class="keyword">c10</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;!-- End of collapsed hardcoded items --&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                    &lt;!-- Show All Tables Button --&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;Button Content=&quot;</span><span class="keyword">Show</span> <span class="keyword">All</span> <span class="keyword">Tables</span> (7)<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            HorizontalAlignment=&quot;</span><span class="keyword">Left</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Margin=&quot;</span>0,8,0,0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Background=&quot;</span><span class="keyword">Transparent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">ControlStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            BorderThickness=&quot;</span>1<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                &lt;!-- Stored Procedures Tab --&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;StackPanel x:Name=&quot;</span><span class="keyword">StoredProceduresTabContent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Spacing=&quot;</span>16<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Visibility=&quot;</span><span class="keyword">Collapsed</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Stored</span> <span class="keyword">Procedure</span> <span class="keyword">Results</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">SubtitleTextBlockStyle</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                    &lt;ItemsControl ItemsSource=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.StoredProcedureResults</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;DataTemplate x:DataType=&quot;</span><span class="keyword">models:Model_StoredProcedureTestResult</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Margin=&quot;</span>0,0,0,12<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                        &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ProcedureName</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                       FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">TestDetails</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Grid.Column=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ExecutionTimeMs</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/DataTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;/ItemsControl&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                &lt;!-- DAOs Tab --&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;StackPanel x:Name=&quot;</span><span class="keyword">DaosTabContent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Spacing=&quot;</span>16<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Visibility=&quot;</span><span class="keyword">Collapsed</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;TextBlock Text=&quot;</span><span class="keyword">DAO</span> <span class="keyword">Results</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">SubtitleTextBlockStyle</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                    &lt;ItemsControl ItemsSource=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.DaoResults</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;DataTemplate x:DataType=&quot;</span><span class="keyword">models:Model_DaoTestResult</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Margin=&quot;</span>0,0,0,12<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                        &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">DaoName</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                       FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">StatusText</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Grid.Column=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">OperationsTested</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   VerticalAlignment=&quot;</span><span class="keyword">Center</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/DataTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;/ItemsControl&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                &lt;!-- Logs Tab --&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;StackPanel x:Name=&quot;</span><span class="keyword">LogsTabContent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Spacing=&quot;</span>16<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                            Visibility=&quot;</span><span class="keyword">Collapsed</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;StackPanel Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                Spacing=&quot;</span>12<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;TextBlock Text=&quot;</span><span class="keyword">Logs</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                   Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">SubtitleTextBlockStyle</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;Button Content=&quot;</span><span class="keyword">Load</span> <span class="keyword">Audit</span> <span class="keyword">Log</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                Command=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.LoadAuditLogCommand</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Runtime</span> <span class="keyword">Log</span> <span class="keyword">Messages</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">BodyTextBlockStyle</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;ItemsControl ItemsSource=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.LogMessages</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;DataTemplate x:DataType=&quot;</span><span class="keyword">x:String</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                           Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                           TextWrapping=&quot;</span><span class="keyword">WrapWholeWords</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/DataTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;/ItemsControl&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                                    &lt;TextBlock Text=&quot;</span><span class="keyword">Settings</span> <span class="keyword">Audit</span> <span class="keyword">Log</span> (<span class="keyword">Sample</span>)<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                               Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">BodyTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                               Margin=&quot;</span>0,12,0,0<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;ItemsControl ItemsSource=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.AuditLogEntries</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;DataTemplate x:DataType=&quot;</span><span class="keyword">models:Model_SettingsAuditLog</span><span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">SubtleFillColorTransparentBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">DividerStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        BorderThickness=&quot;</span>0,0,0,1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Padding=&quot;</span>12,8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                        Margin=&quot;</span>0,0,0,12<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;StackPanel Spacing=&quot;</span>2<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">SettingName</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   FontWeight=&quot;</span><span class="keyword">SemiBold</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;TextBlock Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                                                   Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Run Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ChangeType</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Run Text=&quot;</span>  <span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                            &lt;Run Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ChangedAt</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                                        &lt;/TextBlock&gt;</span></div>
<div class="line"><span class="stringliteral">                                                    &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                                                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral">                                            &lt;/DataTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                        &lt;/ItemsControl.ItemTemplate&gt;</span></div>
<div class="line"><span class="stringliteral">                                    &lt;/ItemsControl&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/ScrollViewer&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;/Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                &lt;/Border&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                &lt;!-- Footer --&gt;</span></div>
<div class="line"><span class="stringliteral">                &lt;Border Background=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardBackgroundFillColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">CardStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        BorderThickness=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        CornerRadius=&quot;</span>8<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                        Padding=&quot;</span>20<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                    &lt;Grid&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;ColumnDefinition Width=&quot;</span>*<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;ColumnDefinition Width=&quot;</span><span class="keyword">Auto</span><span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/Grid.ColumnDefinitions&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                        &lt;StackPanel Grid.Column=&quot;</span>0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Spacing=&quot;</span>4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;TextBlock Text=&quot;</span><span class="keyword">Last</span> <span class="keyword">run:</span> <span class="keyword">Not</span> <span class="keyword">yet</span> <span class="keyword">executed</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                       Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;StackPanel Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                        Spacing=&quot;</span>4<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span><span class="keyword">Total</span> <span class="keyword">test</span> <span class="keyword">duration:</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.TotalTestDurationMs</span>, <span class="keyword">Mode</span>=<span class="keyword">OneWay</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                                &lt;TextBlock Text=&quot;</span><span class="keyword">ms</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Style=&quot;</span>{<span class="keyword">StaticResource</span> <span class="keyword">CaptionTextBlockStyle</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                           Foreground=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">TextFillColorSecondaryBrush</span>}<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral">                        &lt;/StackPanel&gt;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">                        &lt;StackPanel Grid.Column=&quot;</span>1<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Orientation=&quot;</span><span class="keyword">Horizontal</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Spacing=&quot;</span>12<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;Button Content=&quot;</span><span class="keyword">Export</span> <span class="keyword">Results</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Command=&quot;</span>{<span class="keyword">x:Bind</span> <span class="keyword">ViewModel.ExportResultsCommand</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Height=&quot;</span>32<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Padding=&quot;</span>16,0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Background=&quot;</span><span class="keyword">Transparent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">ControlStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    BorderThickness=&quot;</span>1<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">                            &lt;Button Content=&quot;</span><span class="keyword">Close</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Height=&quot;</span>32<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Padding=&quot;</span>16,0<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    Background=&quot;</span><span class="keyword">Transparent</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    BorderBrush=&quot;</span>{<span class="keyword">ThemeResource</span> <span class="keyword">ControlStrokeColorDefaultBrush</span>}<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                                    BorderThickness=&quot;</span>1&quot; /&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md449"></a>
File: Module_Volvo/Models/Model_VolvoPart.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_VolvoPart</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md450"></a>
File: Module_Volvo/Models/Model_VolvoSetting.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_VolvoSetting : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _modifiedDate = DateTime.Now;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md451"></a>
File: Module_Volvo/Services/Service_VolvoAuthorization.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_VolvoAuthorization : IService_VolvoAuthorization</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; CanManageShipmentsAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Authorization check: CanManageShipments&quot;);</div>
<div class="line">return new Model_Dao_Result</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error checking shipment management authorization: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; CanManageMasterDataAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Authorization check: CanManageMasterData&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error checking master data authorization: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; CanCompleteShipmentsAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Authorization check: CanCompleteShipments&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error checking shipment completion authorization: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; CanGenerateLabelsAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Authorization check: CanGenerateLabels&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error checking label generation authorization: {ex.Message}&quot;, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md452"></a>
File: Module_Volvo/Views/View_Volvo_History.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Volvo.Views.View_Volvo_History&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GoBackCommand}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Back to Shipment Entry&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">SymbolIcon</span> <span class="keyword">Symbol</span>=<span class="stringliteral">&quot;Back&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;Volvo Shipment History&quot;</span></div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Filters --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">CalendarDatePicker</span></div>
<div class="line">                <span class="keyword">Header</span>=<span class="stringliteral">&quot;Start Date&quot;</span></div>
<div class="line">                <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StartDate, Mode=TwoWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;200&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">CalendarDatePicker</span></div>
<div class="line">                <span class="keyword">Header</span>=<span class="stringliteral">&quot;End Date&quot;</span></div>
<div class="line">                <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.EndDate, Mode=TwoWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;200&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">ComboBox</span></div>
<div class="line">                <span class="keyword">Header</span>=<span class="stringliteral">&quot;Status&quot;</span></div>
<div class="line">                <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusOptions}&quot;</span></div>
<div class="line">                <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusFilter, Mode=TwoWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Button</span></div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Filter&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FilterCommand}&quot;</span></div>
<div class="line">                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Bottom&quot;</span>/&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">Button</span></div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Export CSV&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ExportCommand}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Bottom&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- DataGrid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">controls:DataGrid</span></div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">            <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.History, Mode=OneWay}&quot;</span></div>
<div class="line">            <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedShipment, Mode=TwoWay}&quot;</span></div>
<div class="line">            <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">            <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">            <span class="keyword">CanUserReorderColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">            <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;Horizontal&quot;</span>&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Shipment #&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding ShipmentNumber}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Date&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding ShipmentDate}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;PO Number&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PONumber}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Receiver&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding ReceiverNumber}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Status&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Status}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> </div>
<div class="line">                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Notes&quot;</span> </div>
<div class="line">                    <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Notes}&quot;</span></div>
<div class="line">                    <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> </div>
<div class="line">                <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span></div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;View Details&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ViewDetailCommand}&quot;</span></div>
<div class="line">                <span class="keyword">Margin</span>=<span class="stringliteral">&quot;12,0,0,0&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span></div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Edit&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.EditCommand}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md453"></a>
File: Module_Volvo/Views/View_Volvo_Settings.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Volvo.Views.View_Volvo_Settings&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Volvo.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Volvo Dunnage Parts Master Data&quot;</span></div>
<div class="line">            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Toolbar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Add&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Add Part&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddPartCommand, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Edit&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Edit Part&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.EditPartCommand, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Delete&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Deactivate&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.DeactivatePartCommand, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;PreviewLink&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;View Components&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ViewComponentsCommand, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Import&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Import CSV&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ImportCsvCommand, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Save&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Export CSV&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ExportCsvCommand, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Refresh&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Refresh&quot;</span> </div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RefreshCommand, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarToggleButton</span> </div>
<div class="line">                <span class="keyword">Icon</span>=<span class="stringliteral">&quot;View&quot;</span> </div>
<div class="line">                <span class="keyword">Label</span>=<span class="stringliteral">&quot;Show Inactive&quot;</span></div>
<div class="line">                <span class="keyword">IsChecked</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShowInactive, Mode=TwoWay}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Data Grid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid</span></div>
<div class="line">                <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Parts, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPart, Mode=TwoWay}&quot;</span></div>
<div class="line">                <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;All&quot;</span></div>
<div class="line">                <span class="keyword">HeadersVisibility</span>=<span class="stringliteral">&quot;Column&quot;</span></div>
<div class="line">                <span class="keyword">AlternatingRowBackground</span>=<span class="stringliteral">&quot;{ThemeResource SystemListLowColor}&quot;</span></div>
<div class="line">                <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part Number&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartNumber}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Qty/Skid&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding QuantityPerSkid}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Active&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_VolvoPart&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                                    <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind IsActive}&quot;</span> </div>
<div class="line">                                    <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{x:Bind IsActive, Converter={StaticResource BoolToColorConverter}, ConverterParameter=&#39;Green|Gray&#39;}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> </div>
<div class="line">                <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> </div>
<div class="line">                <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md454"></a>
File: Module_Volvo/Views/View_Volvo_ShipmentEntry.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Volvo_ShipmentEntry : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnLoaded(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">await ViewModel.InitializeAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnPartSearchTextChanged(AutoSuggestBox sender, AutoSuggestBoxTextChangedEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.UpdatePartSuggestions(sender.Text);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnPartSuggestionChosen(AutoSuggestBox sender, AutoSuggestBoxSuggestionChosenEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">ViewModel.OnPartSuggestionChosen(selectedPart);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md455"></a>
File: Module_Volvo/Views/VolvoPartAddEditDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>VolvoPartAddEditDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void InitializeForAdd()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void InitializeForEdit(Model_VolvoPart part)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnSaveClicked(ContentDialog sender, ContentDialogButtonClickEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(PartNumberTextBox.Text))</div>
<div class="line">⋮----</div>
<div class="line">Part = new Model_VolvoPart</div>
<div class="line">⋮----</div>
<div class="line">PartNumber = PartNumberTextBox.Text.Trim().ToUpperInvariant(),</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md456"></a>
File: Module_Volvo/Views/VolvoShipmentEditDialog.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>VolvoShipmentEditDialog : ContentDialog</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void LoadShipment(Model_VolvoShipment shipment, ObservableCollection&lt;Model_VolvoShipmentLine&gt; lines, ObservableCollection&lt;Model_VolvoPart&gt; availableParts)</div>
<div class="line">⋮----</div>
<div class="line">ShipmentNumberBox.Text = shipment.ShipmentNumber.ToString();</div>
<div class="line">⋮----</div>
<div class="line">Lines.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Lines.Add(line);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Model_VolvoShipment GetUpdatedShipment()</div>
<div class="line">⋮----</div>
<div class="line">Shipment.PONumber = string.IsNullOrWhiteSpace(PONumberBox.Text) ? null : PONumberBox.Text;</div>
<div class="line">Shipment.ReceiverNumber = string.IsNullOrWhiteSpace(ReceiverNumberBox.Text) ? null : ReceiverNumberBox.Text;</div>
<div class="line">Shipment.Notes = string.IsNullOrWhiteSpace(NotesBox.Text) ? null : NotesBox.Text;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> ObservableCollection&lt;Model_VolvoShipmentLine&gt; GetUpdatedLines()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void AddNewLine()</div>
<div class="line">⋮----</div>
<div class="line">Lines.Add(new Model_VolvoShipmentLine</div>
<div class="line">⋮----</div>
<div class="line">private void RemoveSelectedLine()</div>
<div class="line">⋮----</div>
<div class="line">Lines.Remove(selectedLine);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md457"></a>
File: MTM_Receiving_Application.Tests/GlobalUsings.cs</h2>
<div class="fragment"></div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md458"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Converters/Converter_DecimalToInt_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Converter_DecimalToInt_Tests</div>
<div class="line">⋮----</div>
<div class="line">private readonly Converter_DecimalToInt _sut;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithDecimalValue_ReturnsFormattedIntegerString(decimal input, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">object</span> result = _sut.Convert(input, typeof(<span class="keywordtype">string</span>), <span class="keywordflow">default</span>(<span class="keywordtype">object</span>)!, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">_ = result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithDoubleValue_ReturnsFormattedIntegerString(<span class="keywordtype">double</span> input, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithFloatValue_ReturnsFormattedIntegerString(<span class="keywordtype">float</span> input, <span class="keywordtype">string</span> expected)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Convert_WithNullValue_ReturnsEmptyString()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">object</span> result = _sut.Convert(null!, typeof(<span class="keywordtype">string</span>), default(<span class="keywordtype">object</span>)!, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">_ = result.Should().Be(<span class="keywordtype">string</span>.Empty);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Convert_WithNonNumericValue_ReturnsValueToString(<span class="keywordtype">object</span> input)</div>
<div class="line">⋮----</div>
<div class="line">_ = result.Should().Be(input.ToString());</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithValidString_ReturnsDecimal(<span class="keywordtype">string</span> input, decimal expected)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">object</span> result = _sut.ConvertBack(input, typeof(decimal), default(<span class="keywordtype">object</span>)!, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithInvalidString_ReturnsZero(<span class="keywordtype">string</span>? input)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">object</span> result = _sut.ConvertBack(input!, typeof(decimal), default(<span class="keywordtype">object</span>)!, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
<div class="line">_ = result.Should().Be(0m);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> ConvertBack_WithNonStringValue_ReturnsZero()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">object</span> result = _sut.ConvertBack(42, typeof(decimal), default(<span class="keywordtype">object</span>)!, <span class="stringliteral">&quot;en-US&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md459"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Models/Core/Model_Dao_Result_Factory_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_Dao_Result_Factory_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Failure_CreatesFailedResult()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Failure(<span class="stringliteral">&quot;Error!&quot;</span>);</div>
<div class="line">result.Success.Should().BeFalse();</div>
<div class="line">result.ErrorMessage.Should().Be(<span class="stringliteral">&quot;Error!&quot;</span>);</div>
<div class="line">result.Severity.Should().Be(Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Failure_WithNullMessage_UsesDefaultMessage()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Failure(<span class="keyword">null</span>);</div>
<div class="line">⋮----</div>
<div class="line">result.ErrorMessage.Should().Be(<span class="stringliteral">&quot;Operation failed.&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Failure_WithWhitespaceMessage_UsesDefaultMessage()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Failure(<span class="stringliteral">&quot;   &quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Failure_WithException_CapturesException()</div>
<div class="line">⋮----</div>
<div class="line">var ex = <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;Test ex&quot;</span>);</div>
<div class="line">var result = Model_Dao_Result_Factory.Failure(<span class="stringliteral">&quot;Error!&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line">result.Exception.Should().Be(ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Success_CreatesSuccessResult()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Success(5);</div>
<div class="line">result.Success.Should().BeTrue();</div>
<div class="line">result.AffectedRows.Should().Be(5);</div>
<div class="line">result.ErrorMessage.Should().BeEmpty();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Success_WithNegativeAffectedRows_ClampsToZero()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Success(-1);</div>
<div class="line">⋮----</div>
<div class="line">result.AffectedRows.Should().Be(0);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> FailureGeneric_CreatesFailedResult()</div>
<div class="line">⋮----</div>
<div class="line">result.ErrorMessage.Should().Be(<span class="stringliteral">&quot;Generic Error!&quot;</span>);</div>
<div class="line">result.Data.Should().BeNull();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> FailureGeneric_WithNullMessage_UsesDefaultMessage()</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> SuccessGeneric_CreatesSuccessResultWithData()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Success(<span class="stringliteral">&quot;Test Data&quot;</span>, 1);</div>
<div class="line">⋮----</div>
<div class="line">result.Data.Should().Be(<span class="stringliteral">&quot;Test Data&quot;</span>);</div>
<div class="line">result.AffectedRows.Should().Be(1);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> SuccessGeneric_WithNegativeAffectedRows_ClampsToZero()</div>
<div class="line">⋮----</div>
<div class="line">var result = Model_Dao_Result_Factory.Success(<span class="stringliteral">&quot;Test Data&quot;</span>, -1);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md460"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Models/Systems/Model_UserSession_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_UserSession_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void DefaultConstructor_SetsTimestamps()</div>
<div class="line">⋮----</div>
<div class="line">var session = <span class="keyword">new</span> Model_UserSession();</div>
<div class="line">⋮----</div>
<div class="line">session.LoginTimestamp.Should().BeOnOrAfter(before);</div>
<div class="line">session.LoginTimestamp.Should().BeOnOrBefore(after);</div>
<div class="line">session.LastActivityTimestamp.Should().BeOnOrAfter(before);</div>
<div class="line">session.LastActivityTimestamp.Should().BeOnOrBefore(after);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> UpdateLastActivity_UpdatesTimestamp()</div>
<div class="line">⋮----</div>
<div class="line">session.LastActivityTimestamp = DateTime.Now.AddMinutes(-1);</div>
<div class="line">session.UpdateLastActivity();</div>
<div class="line">session.LastActivityTimestamp.Should().BeAfter(DateTime.Now.AddSeconds(-5));</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> TimeSinceLastActivity_ReturnsCorrectDifference()</div>
<div class="line">⋮----</div>
<div class="line">session.LastActivityTimestamp = DateTime.Now.AddMinutes(-5);</div>
<div class="line">⋮----</div>
<div class="line">elapsed.Should().BeCloseTo(TimeSpan.FromMinutes(5), TimeSpan.FromSeconds(2));</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsTimedOut_ReturnsTrueWhenExpired()</div>
<div class="line">⋮----</div>
<div class="line">var session = new Model_UserSession</div>
<div class="line">⋮----</div>
<div class="line">TimeoutDuration = TimeSpan.FromMinutes(10),</div>
<div class="line">LastActivityTimestamp = DateTime.Now.AddMinutes(-11)</div>
<div class="line">⋮----</div>
<div class="line">isTimedOut.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsTimedOut_ReturnsFalseWhenActive()</div>
<div class="line">⋮----</div>
<div class="line">LastActivityTimestamp = DateTime.Now.AddMinutes(-5)</div>
<div class="line">⋮----</div>
<div class="line">isTimedOut.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> HasErpAccess_ReturnsFalseIfUserIsNull()</div>
<div class="line">⋮----</div>
<div class="line">var session = new Model_UserSession { User = <span class="keyword">null</span> };</div>
<div class="line">⋮----</div>
<div class="line">hasAccess.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> HasErpAccess_ReturnsFalseIfUserHasNoVisualUsername()</div>
<div class="line">⋮----</div>
<div class="line">User = new Model_User { VisualUsername = <span class="keyword">null</span> }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> HasErpAccess_ReturnsTrueIfUserHasVisualUsername()</div>
<div class="line">⋮----</div>
<div class="line">User = new Model_User { VisualUsername = <span class="stringliteral">&quot;user&quot;</span> }</div>
<div class="line">⋮----</div>
<div class="line">hasAccess.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_WithUser_SetsUser()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User();</div>
<div class="line">var session = new Model_UserSession(user);</div>
<div class="line">session.User.Should().BeSameAs(user);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Constructor_WithNullUser_Throws()</div>
<div class="line">⋮----</div>
<div class="line">var act = static () =&gt; new Model_UserSession(null!);</div>
<div class="line">act.Should().Throw&lt;ArgumentNullException&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md461"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Models/Systems/Model_WorkstationConfig_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_WorkstationConfig_Tests</div>
<div class="line">⋮----</div>
<div class="line">public void Constructor_Default_UsesMachineName()</div>
<div class="line">⋮----</div>
<div class="line">var config = <span class="keyword">new</span> Model_WorkstationConfig();</div>
<div class="line">config.ComputerName.Should().Be(Environment.MachineName);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_WithParameter_SetsComputerName()</div>
<div class="line">⋮----</div>
<div class="line">var config = new Model_WorkstationConfig(<span class="stringliteral">&quot;TEST-PC&quot;</span>);</div>
<div class="line">config.ComputerName.Should().Be(<span class="stringliteral">&quot;TEST-PC&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsSharedTerminal_ReturnsTrueForSharedType()</div>
<div class="line">⋮----</div>
<div class="line">var config = new Model_WorkstationConfig { WorkstationType = WorkstationDefaults.SharedTerminalWorkstationType };</div>
<div class="line">config.IsSharedTerminal.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> IsSharedTerminal_ReturnsFalseForSharedType()</div>
<div class="line">⋮----</div>
<div class="line">config.IsPersonalWorkstation.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> IsPersonalWorkstation_ReturnsTrueForPersonalType()</div>
<div class="line">⋮----</div>
<div class="line">var config = new Model_WorkstationConfig { WorkstationType = WorkstationDefaults.PersonalWorkstationWorkstationType };</div>
<div class="line">config.IsPersonalWorkstation.Should().BeTrue();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> IsPersonalWorkstation_ReturnsFalseForPersonalType()</div>
<div class="line">⋮----</div>
<div class="line">config.IsSharedTerminal.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> TimeoutDuration_SharedTerminal_ReturnsSharedTimeoutMinutes()</div>
<div class="line">⋮----</div>
<div class="line">config.TimeoutDuration.Should().Be(TimeSpan.FromMinutes(WorkstationDefaults.SharedTerminalTimeoutMinutes));</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> TimeoutDuration_PersonalWorkstation_ReturnsPersonalTimeoutMinutes()</div>
<div class="line">⋮----</div>
<div class="line">config.TimeoutDuration.Should().Be(TimeSpan.FromMinutes(WorkstationDefaults.PersonalWorkstationTimeoutMinutes));</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> TimeoutDuration_UnknownType_ReturnsPersonalTimeoutMinutesDefault()</div>
<div class="line">⋮----</div>
<div class="line">var config = new Model_WorkstationConfig { WorkstationType = <span class="stringliteral">&quot;unknown&quot;</span> };</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md462"></a>
File: Module_Core/Models/Systems/Model_WorkstationConfig.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Model_WorkstationConfig</div>
<div class="line">⋮----</div>
<div class="line">? TimeSpan.FromMinutes(WorkstationDefaults.SharedTerminalTimeoutMinutes)</div>
<div class="line">: TimeSpan.FromMinutes(WorkstationDefaults.PersonalWorkstationTimeoutMinutes);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md463"></a>
File: Module_Core/Services/Authentication/Service_Authentication.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Authentication : IService_Authentication</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_User _daoUser;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">private</span> static readonly Regex _regex = new Regex(<span class="stringliteral">@&quot;^\d{4}$&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_daoUser = daoUser ?? throw new ArgumentNullException(nameof(daoUser));</div>
<div class="line">_errorHandler = errorHandler ?? throw new ArgumentNullException(nameof(errorHandler));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_AuthenticationResult&gt; AuthenticateByWindowsUsernameAsync(</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(windowsUsername))</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.ErrorResult(&quot;Windows username is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoUser.GetUserByWindowsUsernameAsync(windowsUsername);</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.ErrorResult(result.ErrorMessage);</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.ErrorResult(&quot;User data is invalid&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.SuccessResult(result.Data);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Authentication by Windows username failed&quot;, Enum_ErrorSeverity.Error, ex, false);</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.ErrorResult($&quot;Authentication error: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_AuthenticationResult&gt; AuthenticateByPinAsync(</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(username))</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.ErrorResult(&quot;Username is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(pin))</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.ErrorResult(&quot;PIN is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (pin.Length != 4 || !pin.All(char.IsDigit))</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.ErrorResult(&quot;PIN must be exactly 4 numeric digits&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoUser.ValidateUserPinAsync(username, pin);</div>
<div class="line">⋮----</div>
<div class="line">return Model_AuthenticationResult.ErrorResult(&quot;Invalid username or PIN&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Authentication by PIN failed&quot;, Enum_ErrorSeverity.Error, ex, false);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_CreateUserResult&gt; CreateNewUserAsync(</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(user.WindowsUsername))</div>
<div class="line">⋮----</div>
<div class="line">return Model_CreateUserResult.ErrorResult(&quot;Windows username is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(user.FullName))</div>
<div class="line">⋮----</div>
<div class="line">return Model_CreateUserResult.ErrorResult(&quot;Full name is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(user.Department))</div>
<div class="line">⋮----</div>
<div class="line">return Model_CreateUserResult.ErrorResult(&quot;Department is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(user.Shift))</div>
<div class="line">⋮----</div>
<div class="line">return Model_CreateUserResult.ErrorResult(&quot;Shift is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_CreateUserResult.ErrorResult(pinValidation.ErrorMessage);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoUser.CreateNewUserAsync(user, createdBy);</div>
<div class="line">⋮----</div>
<div class="line">return Model_CreateUserResult.ErrorResult(result.ErrorMessage);</div>
<div class="line">⋮----</div>
<div class="line">return Model_CreateUserResult.SuccessResult(result.Data);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Create new user failed&quot;, Enum_ErrorSeverity.Error, ex, false);</div>
<div class="line">⋮----</div>
<div class="line">return Model_CreateUserResult.ErrorResult($&quot;User creation error: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_ValidationResult&gt; ValidatePinAsync(string pin, int? excludeEmployeeNumber = null)</div>
<div class="line">⋮----</div>
<div class="line">return Model_ValidationResult.Invalid(&quot;PIN is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ValidationResult.Invalid(&quot;PIN must be exactly 4 digits&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (!_regex.IsMatch(pin))</div>
<div class="line">⋮----</div>
<div class="line">return Model_ValidationResult.Invalid(&quot;PIN must contain only numeric digits&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ValidationResult.Valid();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;PIN validation failed&quot;, Enum_ErrorSeverity.Error, ex, false);</div>
<div class="line">⋮----</div>
<div class="line">return Model_ValidationResult.Invalid($&quot;Validation error: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_WorkstationConfig&gt; DetectWorkstationTypeAsync(string? computerName = null)</div>
<div class="line">⋮----</div>
<div class="line">computerName = computerName.Trim();</div>
<div class="line">var sharedTerminalsResult = await _daoUser.GetSharedTerminalNamesAsync();</div>
<div class="line">var config = new Model_WorkstationConfig(computerName);</div>
<div class="line">⋮----</div>
<div class="line">var isShared = sharedTerminalsResult.Data.Any(name =&gt;</div>
<div class="line">string.Equals(name?.Trim(), computerName, StringComparison.OrdinalIgnoreCase));</div>
<div class="line">⋮----</div>
<div class="line">await _daoUser.UpsertWorkstationConfigAsync(</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Workstation type detection failed&quot;, Enum_ErrorSeverity.Warning, ex, false);</div>
<div class="line">⋮----</div>
<div class="line">return new Model_WorkstationConfig(computerName ?? Environment.MachineName)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;List&lt;string&gt;&gt; GetActiveDepartmentsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoUser.GetActiveDepartmentsAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Get active departments failed&quot;, Enum_ErrorSeverity.Warning, ex, false);</div>
<div class="line">⋮----</div>
<div class="line">public async Task LogUserActivityAsync(string eventType, string username, string workstationName, string details)</div>
<div class="line">⋮----</div>
<div class="line">await _daoUser.LogUserActivityAsync(eventType, username, workstationName, details);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Activity logging failed&quot;, Enum_ErrorSeverity.Info, ex, false);</div>
<div class="line">⋮----</div>
<div class="line">System.Diagnostics.Debug.WriteLine($&quot;Failed to log activity: {ex.Message}&quot;);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md464"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_AdminInventoryViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_AdminInventory : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_InventoriedDunnage _daoInventory;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_DunnagePart _daoPart;</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageAdminWorkflow _adminWorkflow;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line">_daoInventory = daoInventory ?? throw new ArgumentNullException(nameof(daoInventory));</div>
<div class="line">_daoPart = daoPart ?? throw new ArgumentNullException(nameof(daoPart));</div>
<div class="line">_adminWorkflow = adminWorkflow ?? throw new ArgumentNullException(nameof(adminWorkflow));</div>
<div class="line">_windowService = windowService ?? throw new ArgumentNullException(nameof(windowService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadInventoriedPartsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoInventory.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">InventoriedParts.Clear();</div>
<div class="line">⋮----</div>
<div class="line">InventoriedParts.Add(part);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowAddToListAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowEditEntryAsync()</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">XamlRoot = _windowService.GetXamlRoot()</div>
<div class="line">⋮----</div>
<div class="line">var stackPanel = new StackPanel { Spacing = 12 };</div>
<div class="line">stackPanel.Children.Add(new TextBlock { Text = &quot;Part ID (read-only)&quot;, FontWeight = Microsoft.UI.Text.FontWeights.SemiBold });</div>
<div class="line">var partIdBox = new TextBox</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(partIdBox);</div>
<div class="line">stackPanel.Children.Add(new TextBlock { Text = &quot;Inventory Method&quot;, FontWeight = Microsoft.UI.Text.FontWeights.SemiBold });</div>
<div class="line">var methodCombo = new ComboBox</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(methodCombo);</div>
<div class="line">stackPanel.Children.Add(new TextBlock { Text = &quot;Notes (optional)&quot;, FontWeight = Microsoft.UI.Text.FontWeights.SemiBold });</div>
<div class="line">var notesBox = new TextBox</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(notesBox);</div>
<div class="line">⋮----</div>
<div class="line">var dialogResult = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var updateResult = await _daoInventory.UpdateAsync(</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowRemoveConfirmationAsync()</div>
<div class="line">⋮----</div>
<div class="line">private async Task RemoveFromListAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoInventory.DeleteAsync(SelectedInventoriedPart.Id);</div>
<div class="line">⋮----</div>
<div class="line">private async Task BackToHubAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Returning to Settings Mode Selection from Admin Inventory&quot;);</div>
<div class="line">⋮----</div>
<div class="line">settingsWorkflow.GoBack();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedInventoriedPartChanged(Model_InventoriedDunnage? value)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md465"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_ModeSelectionViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_ModeSelection : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserPreferences _userPreferencesService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void LoadDefaultMode()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SelectGuidedModeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User selected Guided Wizard mode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.TypeSelection);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SelectManualModeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User selected Manual Entry mode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.ManualEntry);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SelectEditModeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User selected Edit Mode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.EditMode);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool HasUnsavedData()</div>
<div class="line">⋮----</div>
<div class="line">!string.IsNullOrEmpty(_workflowService.CurrentSession.PONumber) ||</div>
<div class="line">!string.IsNullOrEmpty(_workflowService.CurrentSession.Location))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task&lt;bool&gt; ConfirmModeChangeAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;No unsaved data detected, skipping confirmation dialog&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;XamlRoot is null, proceeding without confirmation&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error showing confirmation dialog: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ClearWorkflowData()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Dunnage workflow data and UI inputs cleared for mode change&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error clearing dunnage workflow data: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ClearAllUIInputs()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;UI inputs cleared across all Dunnage ViewModels&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error clearing UI inputs: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetGuidedAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line">var result = await _userPreferencesService.UpdateDefaultDunnageModeAsync(currentUser.WindowsUsername, newMode ?? &quot;&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Update in-memory user object</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Update UI state</span></div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Dunnage default mode set to: {newMode ?? &quot;none&quot;}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowErrorDialogAsync(&quot;Save Error&quot;, result.ErrorMessage, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync($&quot;Failed to set default dunnage mode: {ex.Message}&quot;,</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetManualAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Dunnage.ModeSelection&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SetEditAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md466"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_ReviewViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_Review : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_MySQL_Dunnage _dunnageService; <span class="keyword">private</span> readonly IService_Help _helpService; <span class="keyword">private</span> readonly IService_DunnageCSVWriter _csvWriter;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnWorkflowStepChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void LoadSessionLoads()</div>
<div class="line">⋮----</div>
<div class="line">SessionLoads.Clear();</div>
<div class="line">⋮----</div>
<div class="line">SessionLoads.Add(load);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded {LoadCount} loads for review&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error loading session loads: {ex.Message}&quot;, ex, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void UpdateNavigationButtons()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SwitchToSingleView()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Switched to Single View&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SwitchToTableView()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Switched to Table View&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void PreviousEntry()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NextEntry()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task AddAnotherAsync()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User requested to add another load&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;User cancelled add another load&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _workflowService.SaveToCSVOnlyAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.TypeSelection);</div>
<div class="line">_logger.LogInfo(&quot;Navigated to Type Selection for new load, workflow data cleared&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error in AddAnotherAsync: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task&lt;bool&gt; ConfirmAddAnotherAsync()</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;XamlRoot is null, proceeding without confirmation&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error showing confirmation dialog: {ex.Message}&quot;, ex, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void ClearTransientWorkflowData()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Transient workflow data and UI inputs cleared for new entry&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error clearing transient workflow data: {ex.Message}&quot;, ex, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void ClearUIInputsForNewEntry()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;UI inputs cleared for new entry (loads preserved)&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error clearing UI inputs: {ex.Message}&quot;, ex, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task SaveAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Starting SaveAllAsync: {LoadCount} loads to save&quot;);</div>
<div class="line">var saveResult = await _dunnageService.SaveLoadsAsync(SessionLoads.ToList());</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to save {LoadCount} loads: {saveResult.ErrorMessage}&quot;);</div>
<div class="line">await _errorHandler.HandleDaoErrorAsync(saveResult, &quot;SaveAllAsync&quot;, true);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully saved {LoadCount} loads to database&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var csvResult = await _csvWriter.WriteToCSVAsync(SessionLoads.ToList());</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;CSV export failed for {LoadCount} loads: {csvResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully exported {LoadCount} loads to CSV&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Completed SaveAllAsync: {LoadCount} loads processed successfully&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Exception in SaveAllAsync: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void StartNewEntry()</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.ClearSession();</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.ModeSelection);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Dunnage.Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private void Cancel()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Cancelling review, clearing session&quot;, &quot;Review&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line"><span class="keyword">public</span> string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md467"></a>
File: Module_Dunnage/ViewModels/ViewModel_Dunnage_WorkFlowViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Dunnage_WorkFlowViewModel : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_DunnageWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line">⋮----</div>
<div class="line">_currentLine = new Model_DunnageLine();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task InitializeWorkflowAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _workflowService.StartWorkflowAsync();</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private Model_DunnageLine _currentLine;</div>
<div class="line">⋮----</div>
<div class="line">private void OnWorkflowStepChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">private async Task ResetCSVAsync()</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Cannot show dialog: XamlRoot is null&quot;);</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Unable to display dialog&quot;, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _workflowService.SaveToDatabaseOnlyAsync();</div>
<div class="line">⋮----</div>
<div class="line">var warnResult = await warnDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var deleteResult = await _workflowService.ResetCSVFilesAsync();</div>
<div class="line">⋮----</div>
<div class="line">private void ReturnToModeSelection()</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.ClearSession();</div>
<div class="line">_workflowService.GoToStep(Enum_DunnageWorkflowStep.ModeSelection);</div>
<div class="line">⋮----</div>
<div class="line">private async Task AddLineAsync()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md468"></a>
File: Module_Receiving/ViewModels/ViewModel_Receiving_POEntry.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Receiving_POEntry : ViewModel_Shared_Base, IResettableViewModel</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_InforVisual _inforVisualService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ReceivingWorkflow _workflowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Help _helpService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ViewModelRegistry _viewModelRegistry;</div>
<div class="line">⋮----</div>
<div class="line">_viewModelRegistry.Register(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void ResetToDefaults()</div>
<div class="line">⋮----</div>
<div class="line">Parts.Clear();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void PoTextBoxLostFocus()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(PoNumber))</div>
<div class="line">⋮----</div>
<div class="line">string value = PoNumber.Trim().ToUpper();</div>
<div class="line">if (value.StartsWith(&quot;PO-&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">string numberPart = value.Substring(3);</div>
<div class="line">if (numberPart.All(char.IsDigit) &amp;&amp; numberPart.Length &lt;= 6)</div>
<div class="line">⋮----</div>
<div class="line">PoNumber = $&quot;PO-{numberPart.PadLeft(6, &#39;0&#39;)}&quot;;</div>
<div class="line">⋮----</div>
<div class="line">else if (value.All(char.IsDigit) &amp;&amp; value.Length &lt;= 6)</div>
<div class="line">⋮----</div>
<div class="line">PoNumber = $&quot;PO-{value.PadLeft(6, &#39;0&#39;)}&quot;;</div>
<div class="line">⋮----</div>
<div class="line">private async Task LoadPOAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Please enter a PO number.&quot;, Enum_ErrorSeverity.Warning);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _inforVisualService.GetPOWithPartsAsync(PoNumber);</div>
<div class="line">⋮----</div>
<div class="line">var remainingQtyResult = await _inforVisualService.GetRemainingQuantityAsync(PoNumber, part.PartID);</div>
<div class="line">⋮----</div>
<div class="line">Parts.Add(part);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.RaiseStatusMessage($&quot;Purchase Order {PoNumber} loaded with {Parts.Count} parts.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var errorMessage = !string.IsNullOrWhiteSpace(result.ErrorMessage)</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(errorMessage, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">private void ToggleNonPO()</div>
<div class="line">⋮----</div>
<div class="line">private async Task LookupPartAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(PartID))</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(&quot;Please enter a Part ID.&quot;, Enum_ErrorSeverity.Warning);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _inforVisualService.GetPartByIDAsync(PartID);</div>
<div class="line">⋮----</div>
<div class="line">Parts.Add(result.Data);</div>
<div class="line">_workflowService.RaiseStatusMessage($&quot;Part {PartID} found.&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(result.ErrorMessage ?? &quot;Part not found.&quot;, Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnPoNumberChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(value))</div>
<div class="line">⋮----</div>
<div class="line">string validatedPO = value.Trim();</div>
<div class="line">⋮----</div>
<div class="line">if (validatedPO.StartsWith(&quot;po-&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">string numberPart = validatedPO.Substring(3);</div>
<div class="line">if (numberPart.All(char.IsDigit))</div>
<div class="line">⋮----</div>
<div class="line">validatedPO = $&quot;PO-{numberPart.PadLeft(6, &#39;0&#39;)}&quot;;</div>
<div class="line">⋮----</div>
<div class="line">else if (validatedPO.All(char.IsDigit))</div>
<div class="line">⋮----</div>
<div class="line">validatedPO = $&quot;PO-{validatedPO.PadLeft(6, &#39;0&#39;)}&quot;;</div>
<div class="line">⋮----</div>
<div class="line">partial void OnPartIDChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">var upperPart = value.Trim().ToUpper();</div>
<div class="line">if (upperPart.StartsWith(&quot;MMC&quot;))</div>
<div class="line">⋮----</div>
<div class="line">else if (upperPart.StartsWith(&quot;MMF&quot;))</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedPartChanged(Model_InforVisualPart? value)</div>
<div class="line">⋮----</div>
<div class="line">if (value != null &amp;&amp; !string.IsNullOrWhiteSpace(value.PartID))</div>
<div class="line">⋮----</div>
<div class="line">var upperPart = value.PartID.Trim().ToUpper();</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowHelpAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowHelpAsync(&quot;Receiving.POEntry&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public string GetTooltip(string key) =&gt; _helpService.GetTooltip(key);</div>
<div class="line">public string GetPlaceholder(string key) =&gt; _helpService.GetPlaceholder(key);</div>
<div class="line"><span class="keyword">public</span> string GetTip(string key) =&gt; _helpService.GetTip(key);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;[MOCK DATA MODE] Auto-filling PO number: {defaultPO}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_workflowService.RaiseStatusMessage($&quot;[MOCK DATA] Auto-filled PO: {defaultPO}&quot;);</div>
<div class="line">await Task.Delay(500);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error during initialization: {ex.Message}&quot;, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md469"></a>
File: Module_Reporting/Data/Dao_Reporting.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_Reporting</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetReceivingHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using</span> var connection = <span class="keyword">new</span> MySqlConnection(_connectionString);</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">await <span class="keyword">using </span>var command = <span class="keyword">new</span> MySqlCommand(query, connection);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@StartDate&quot;</span>, startDate.Date);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@EndDate&quot;</span>, endDate.Date);</div>
<div class="line">await <span class="keyword">using </span>var reader = await command.ExecuteReaderAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">while</span> (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">rows.Add(<span class="keyword">new</span> Model_ReportRow</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetGuid(<span class="stringliteral">&quot;id&quot;</span>).ToString(),</div>
<div class="line">PONumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;po_number&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;po_number&quot;</span>),</div>
<div class="line">PartNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;part_number&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;part_number&quot;</span>),</div>
<div class="line">PartDescription = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;part_description&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;part_description&quot;</span>),</div>
<div class="line">Quantity = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;quantity&quot;</span>)) ? <span class="keyword">null</span> : reader.GetDecimal(<span class="stringliteral">&quot;quantity&quot;</span>),</div>
<div class="line">WeightLbs = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;weight_lbs&quot;</span>)) ? <span class="keyword">null</span> : reader.GetDecimal(<span class="stringliteral">&quot;weight_lbs&quot;</span>),</div>
<div class="line">HeatLotNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;heat_lot_number&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;heat_lot_number&quot;</span>),</div>
<div class="line">CreatedDate = reader.GetDateTime(<span class="stringliteral">&quot;created_date&quot;</span>),</div>
<div class="line">EmployeeNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;employee_number&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;employee_number&quot;</span>),</div>
<div class="line">SourceModule = reader.GetString(<span class="stringliteral">&quot;source_module&quot;</span>)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(rows);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetDunnageHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">DunnageType = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;dunnage_type&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;dunnage_type&quot;</span>),</div>
<div class="line">⋮----</div>
<div class="line">SpecsCombined = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;specs_combined&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;specs_combined&quot;</span>),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetRoutingHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(<span class="stringliteral">&quot;id&quot;</span>).ToString(),</div>
<div class="line">⋮----</div>
<div class="line">LineNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;line_number&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;line_number&quot;</span>),</div>
<div class="line">PackageDescription = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;package_description&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;package_description&quot;</span>),</div>
<div class="line">DeliverTo = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;deliver_to&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;deliver_to&quot;</span>),</div>
<div class="line">Department = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;department&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;department&quot;</span>),</div>
<div class="line">Location = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;location&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;location&quot;</span>),</div>
<div class="line">⋮----</div>
<div class="line">EmployeeNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;employee_number&quot;</span>)) ? <span class="keyword">null</span> : reader.GetInt32(<span class="stringliteral">&quot;employee_number&quot;</span>).ToString(),</div>
<div class="line">⋮----</div>
<div class="line">OtherReason = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;other_reason&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;other_reason&quot;</span>),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_ReportRow&gt;&gt;&gt; GetVolvoHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">ShipmentNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;shipment_number&quot;</span>)) ? <span class="keyword">null</span> : reader.GetInt32(<span class="stringliteral">&quot;shipment_number&quot;</span>),</div>
<div class="line">⋮----</div>
<div class="line">ReceiverNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;receiver_number&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;receiver_number&quot;</span>),</div>
<div class="line">Status = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;status&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(<span class="stringliteral">&quot;status&quot;</span>),</div>
<div class="line">⋮----</div>
<div class="line">PartCount = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;part_count&quot;</span>)) ? <span class="keyword">null</span> : reader.GetInt32(<span class="stringliteral">&quot;part_count&quot;</span>),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Dictionary&lt;string, int&gt;&gt;&gt; CheckAvailabilityAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(availability);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task&lt;int&gt; GetCountAsync(</div>
<div class="line">⋮----</div>
<div class="line">var result = await command.ExecuteScalarAsync();</div>
<div class="line"><span class="keywordflow">return</span> Convert.ToInt32(result);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md470"></a>
File: Module_Routing/Services/RoutingUsageTrackingService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>RoutingUsageTrackingService : IRoutingUsageTrackingService</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_RoutingUsageTracking _daoUsageTracking;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_daoUsageTracking = daoUsageTracking ?? throw new ArgumentNullException(nameof(daoUsageTracking));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; IncrementUsageCountAsync(int employeeNumber, int recipientId)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Incrementing usage count for employee {employeeNumber}, recipient {recipientId}&quot;);</div>
<div class="line">return await _daoUsageTracking.IncrementUsageAsync(employeeNumber, recipientId);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error incrementing usage count: {ex.Message}&quot;, ex);</div>
<div class="line">return new Model_Dao_Result { Success = <span class="keyword">false</span>, ErrorMessage = $<span class="stringliteral">&quot;Error updating usage tracking: {ex.Message}&quot;</span>, Exception = ex };</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetUsageCountAsync(<span class="keywordtype">int</span> employeeNumber, <span class="keywordtype">int</span> recipientId)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Getting usage count for employee {employeeNumber}, recipient {recipientId}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;Error getting usage count: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; GetEmployeeLabelCountAsync(<span class="keywordtype">int</span> employeeNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Getting label count for employee {employeeNumber}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;Error getting employee label count: {ex.Message}&quot;</span>, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md471"></a>
File: Module_Routing/ViewModels/RoutingModeSelectionViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>RoutingModeSelectionViewModel : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingUserPreferenceService _userPreferenceService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Navigation _navigationService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void SetNavigationFrame(Frame frame)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var prefsResult = await _userPreferenceService.GetUserPreferenceAsync(employeeNumber);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Module_Core.Models.Enums.Enum_ErrorSeverity.Low,</div>
<div class="line">⋮----</div>
<div class="line">private async Task SelectWizardModeAsync() =&gt; await NavigateToModeAsync(Enum_RoutingMode.WIZARD);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SelectManualEntryModeAsync() =&gt; await NavigateToModeAsync(Enum_RoutingMode.MANUAL);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SelectEditModeAsync() =&gt; await NavigateToModeAsync(Enum_RoutingMode.EDIT);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetWizardAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetManualAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SetEditAsDefaultAsync(bool isChecked)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task SavePreferenceAsync(Enum_RoutingMode mode)</div>
<div class="line">⋮----</div>
<div class="line">var preference = new Model_RoutingUserPreference</div>
<div class="line">⋮----</div>
<div class="line">DefaultMode = mode.ToString(),</div>
<div class="line">⋮----</div>
<div class="line">var result = await _userPreferenceService.SaveUserPreferenceAsync(preference);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Default mode set to {mode} for employee {employeeNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task NavigateToModeAsync(Enum_RoutingMode mode)</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(new InvalidOperationException(&quot;Navigation Frame not set&quot;),</div>
<div class="line">⋮----</div>
<div class="line">_ =&gt; throw new ArgumentException($&quot;Unknown mode: {mode}&quot;)</div>
<div class="line">⋮----</div>
<div class="line">_navigationService.NavigateTo(_frame, viewName);</div>
<div class="line">await _logger.LogInfoAsync($&quot;Navigated to {viewName}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Module_Core.Models.Enums.Enum_ErrorSeverity.Medium,</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md472"></a>
File: Module_Routing/ViewModels/RoutingWizardStep2ViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>RoutingWizardStep2ViewModel : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingRecipientService _recipientService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly RoutingWizardContainerViewModel _containerViewModel;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task LoadRecipientsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var quickAddResult = await _recipientService.GetQuickAddRecipientsAsync(</div>
<div class="line">⋮----</div>
<div class="line">QuickAddRecipients.Clear();</div>
<div class="line">⋮----</div>
<div class="line">QuickAddRecipients.Add(recipient);</div>
<div class="line">⋮----</div>
<div class="line">var allRecipientsResult = await _recipientService.GetActiveRecipientsSortedByUsageAsync(0);</div>
<div class="line">⋮----</div>
<div class="line">_allRecipients.Clear();</div>
<div class="line">⋮----</div>
<div class="line">_allRecipients.Add(recipient);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private void QuickAddRecipient(Model_RoutingRecipient recipient)</div>
<div class="line">⋮----</div>
<div class="line">private void ApplyFilter()</div>
<div class="line">⋮----</div>
<div class="line">FilteredRecipients.Clear();</div>
<div class="line">if (string.IsNullOrWhiteSpace(SearchText))</div>
<div class="line">⋮----</div>
<div class="line">FilteredRecipients.Add(recipient);</div>
<div class="line">⋮----</div>
<div class="line">var searchLower = SearchText.ToLower();</div>
<div class="line">var filtered = _allRecipients.Where(r =&gt;</div>
<div class="line">r.Name.ToLower().Contains(searchLower) ||</div>
<div class="line">(r.Location?.ToLower().Contains(searchLower) ?? false) ||</div>
<div class="line">(r.Department?.ToLower().Contains(searchLower) ?? false)).ToList();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSearchTextChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line">private void ProceedToStep3()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;ProceedToStep3 called with recipient: {SelectedRecipient?.Name ?? &quot;null&quot;}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;ProceedToStep3: No recipient selected&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Updated container with recipient: {SelectedRecipient.Name}&quot;);</div>
<div class="line">_containerViewModel.NavigateToStep3Command.Execute(null);</div>
<div class="line">_logger.LogInfo(&quot;Navigation to Step 3 triggered&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error in ProceedToStep3: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private bool CanProceedToStep3()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;CanProceedToStep3: {canProceed} (SelectedRecipient: {SelectedRecipient?.Name ?? &quot;null&quot;})&quot;);</div>
<div class="line">⋮----</div>
<div class="line">⋮----</div>
<div class="line">private void NavigateBackToStep1()</div>
<div class="line">⋮----</div>
<div class="line">_containerViewModel.NavigateToStep1Command.Execute(null);</div>
<div class="line">⋮----</div>
<div class="line">⋮----</div>
<div class="line">private int GetCurrentEmployeeNumber()</div>
<div class="line">⋮----</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedRecipientChanged(Model_RoutingRecipient? value)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Selected recipient changed to: {value?.Name ?? &quot;null&quot;}&quot;);</div>
<div class="line">ProceedToStep3Command.NotifyCanExecuteChanged();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md473"></a>
File: Module_Routing/ViewModels/RoutingWizardStep3ViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>RoutingWizardStep3ViewModel : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingService _routingService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly RoutingWizardContainerViewModel _containerViewModel;</div>
<div class="line">⋮----</div>
<div class="line">_containerViewModel.RegisterStep3ViewModel(this);</div>
<div class="line">_logger.LogInfo(&quot;Step3ViewModel initialized and registered&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void LoadReviewData()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;LoadReviewData called&quot;);</div>
<div class="line">_logger.LogInfo($&quot;Container state - SelectedPOLine: {_containerViewModel.SelectedPOLine?.PartID ?? &quot;null&quot;}, SelectedRecipient: {_containerViewModel.SelectedRecipient?.Name ?? &quot;null&quot;}, FinalQuantity: {_containerViewModel.FinalQuantity}&quot;);</div>
<div class="line"><span class="comment">// Load from container state</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// PO workflow</span></div>
<div class="line">⋮----</div>
<div class="line">PoLine = int.TryParse(_containerViewModel.SelectedPOLine.LineNumber, out var lineNum) ? lineNum : 0;</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded PO data - PO: {PoNumber}, Line: {PoLine}, Part: {PartID}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// OTHER workflow</span></div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded OTHER data - Reason: {OtherReason}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;LoadReviewData: No PO line or OTHER reason in container!&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Loaded recipient - Name: {RecipientName}, Location: {RecipientLocation}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;LoadReviewData: No recipient in container!&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Final quantity: {Quantity}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void EditPOSelection()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;EditPOSelection - Navigating to Step 1 in edit mode&quot;);</div>
<div class="line">_containerViewModel.NavigateToStep1ForEditCommand.Execute(null);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void EditRecipientSelection()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;EditRecipientSelection - Navigating to Step 2 in edit mode&quot;);</div>
<div class="line">_containerViewModel.NavigateToStep2ForEditCommand.Execute(null);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NavigateBack()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;NavigateBack - Navigating back to Step 2&quot;);</div>
<div class="line">_containerViewModel.NavigateBackToStep2Command.Execute(null);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task CreateLabelAsync()</div>
<div class="line">⋮----</div>
<div class="line">var duplicateCheckResult = await _routingService.CheckDuplicateLabelAsync(</div>
<div class="line">⋮----</div>
<div class="line">PoLine.ToString(),</div>
<div class="line">⋮----</div>
<div class="line">await _containerViewModel.CreateLabelCommand.ExecuteAsync(null);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private async Task&lt;bool&gt; ShowDuplicateConfirmationAsync()</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md474"></a>
File: Module_Routing/Views/RoutingEditModeView.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Routing.Views.RoutingEditModeView&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:viewmodels</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.Converters&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:NullToBooleanConverter</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;NullToBooleanConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">            <span class="keyword">Text</span>=<span class="stringliteral">&quot;Edit Mode - Label History&quot;</span></div>
<div class="line">            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Search Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">                <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Search by PO, Recipient, or Part ID...&quot;</span></div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">Button</span></div>
<div class="line">                <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Edit Selected&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind EditSelectedLabelCommand}&quot;</span></div>
<div class="line">                <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedLabel, Mode=OneWay, Converter={StaticResource NullToBooleanConverter}}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">Button</span></div>
<div class="line">                <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                <span class="keyword">Content</span>=<span class="stringliteral">&quot;Reprint&quot;</span></div>
<div class="line">                <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReprintLabelCommand}&quot;</span></div>
<div class="line">                <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedLabel, Mode=OneWay, Converter={StaticResource NullToBooleanConverter}}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Labels DataGrid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">controls:DataGrid</span></div>
<div class="line">            <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">            <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.FilteredLabels, Mode=OneWay}&quot;</span></div>
<div class="line">            <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedLabel, Mode=TwoWay}&quot;</span></div>
<div class="line">            <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">            <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">            <span class="keyword">AlternatingRowBackground</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span></div>
<div class="line">            <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">            <span class="keyword">DoubleTapped</span>=<span class="stringliteral">&quot;OnDataGridDoubleTapped&quot;</span>&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;ID&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Id}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;60&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;PO #&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PONumber}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Line&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding POLine}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;60&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part ID&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartID}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Recipient&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding RecipientName}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Quantity&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding Quantity}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Date&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CreatedDate}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Creator&quot;</span> <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding EmployeeNumber}&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> </div>
<div class="line">                <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> </div>
<div class="line">                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md475"></a>
File: Module_Settings/Data/Dao_PackageType.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_PackageType</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_PackageType&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_PackageType&gt;&gt; GetByIdAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; InsertAsync(Model_PackageType packageType, <span class="keywordtype">int</span> createdBy)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_PackageType packageType)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; GetUsageCountAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;usage_count&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">private static Model_PackageType MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_PackageType</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">Name = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;name&quot;</span>)),</div>
<div class="line">Code = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;code&quot;</span>)),</div>
<div class="line">IsActive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_active&quot;</span>)),</div>
<div class="line">CreatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_at&quot;</span>)),</div>
<div class="line">UpdatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;updated_at&quot;</span>)),</div>
<div class="line">CreatedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)) ? null : reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md476"></a>
File: Module_Settings/Data/Dao_RoutingRule.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_RoutingRule</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingRule&gt;&gt;&gt; GetAllAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_RoutingRule&gt;&gt; GetByIdAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">int</span>&gt;&gt; InsertAsync(Model_RoutingRule rule, <span class="keywordtype">int</span> createdBy)</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_RoutingRule rule)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_RoutingRule&gt;&gt; FindMatchAsync(<span class="keywordtype">string</span> matchType, <span class="keywordtype">string</span> value)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_RoutingRule&gt;&gt; GetByPartNumberAsync(<span class="keywordtype">string</span> partNumber)</div>
<div class="line">⋮----</div>
<div class="line">private static Model_RoutingRule MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_RoutingRule</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">MatchType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;match_type&quot;</span>)),</div>
<div class="line">Pattern = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;pattern&quot;</span>)),</div>
<div class="line">DestinationLocation = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;destination_location&quot;</span>)),</div>
<div class="line">Priority = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;priority&quot;</span>)),</div>
<div class="line">IsActive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_active&quot;</span>)),</div>
<div class="line">CreatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_at&quot;</span>)),</div>
<div class="line">UpdatedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;updated_at&quot;</span>)),</div>
<div class="line">CreatedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)) ? null : reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md477"></a>
File: Module_Settings/Data/Dao_SettingsAuditLog.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_SettingsAuditLog</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_SettingsAuditLog&gt;&gt;&gt; GetAsync(<span class="keywordtype">int</span> settingId, <span class="keywordtype">int</span> limit)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_SettingsAuditLog&gt;&gt;&gt; GetBySettingAsync(<span class="keywordtype">int</span> settingId, <span class="keywordtype">int</span> limit)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_SettingsAuditLog&gt;&gt;&gt; GetByUserAsync(<span class="keywordtype">int</span> changedBy, <span class="keywordtype">int</span> limit)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Model_SettingsAuditLog MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_SettingsAuditLog</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">SettingId = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;setting_id&quot;</span>)),</div>
<div class="line">Category = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;category&quot;</span>)),</div>
<div class="line">SettingKey = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_key&quot;</span>)),</div>
<div class="line">SettingName = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_name&quot;</span>)),</div>
<div class="line">UserSettingId = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;user_setting_id&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;user_setting_id&quot;</span>)),</div>
<div class="line">OldValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;old_value&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;old_value&quot;</span>)),</div>
<div class="line">NewValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;new_value&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;new_value&quot;</span>)),</div>
<div class="line">ChangeType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;change_type&quot;</span>)),</div>
<div class="line">ChangedBy = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;changed_by&quot;</span>)),</div>
<div class="line">ChangedAt = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;changed_at&quot;</span>)),</div>
<div class="line">IpAddress = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;ip_address&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;ip_address&quot;</span>)),</div>
<div class="line">WorkstationName = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;workstation_name&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;workstation_name&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md478"></a>
File: Module_Volvo/Data/Dao_VolvoPartComponent.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_VolvoPartComponent</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPartComponent&gt;&gt;&gt; GetByParentPartAsync(<span class="keywordtype">string</span> parentPartNumber)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertAsync(Model_VolvoPartComponent component)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeleteByParentPartAsync(<span class="keywordtype">string</span> parentPartNumber)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Dictionary&lt;<span class="keywordtype">string</span>, List&lt;Model_VolvoPartComponent&gt;&gt;&gt;&gt; GetComponentsByParentPartsAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Model_VolvoPartComponent MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_VolvoPartComponent</div>
<div class="line">⋮----</div>
<div class="line">ComponentPartNumber = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;component_part_number&quot;</span>)),</div>
<div class="line">Quantity = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;quantity&quot;</span>)),</div>
<div class="line">ComponentQuantityPerSkid = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;component_quantity_per_skid&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md479"></a>
File: Module_Volvo/ViewModels/ViewModel_Volvo_Settings.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Volvo_Settings : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_VolvoMasterData _masterDataService;</div>
<div class="line">⋮----</div>
<div class="line">_masterDataService = masterDataService ?? throw new ArgumentNullException(nameof(masterDataService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task RefreshAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _masterDataService.GetAllPartsAsync(ShowInactive);</div>
<div class="line">⋮----</div>
<div class="line">Parts.Clear();</div>
<div class="line">foreach (var part in result.Data.OrderBy(p =&gt; p.PartNumber))</div>
<div class="line">⋮----</div>
<div class="line">Parts.Add(part);</div>
<div class="line">⋮----</div>
<div class="line">ActivePartsCount = Parts.Count(p =&gt; p.IsActive);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private async Task AddPartAsync()</div>
<div class="line">⋮----</div>
<div class="line">dialog.InitializeForAdd();</div>
<div class="line">⋮----</div>
<div class="line">dialog.XamlRoot = windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _masterDataService.AddPartAsync(dialog.Part, new System.Collections.Generic.List&lt;Model_VolvoPartComponent&gt;());</div>
<div class="line">⋮----</div>
<div class="line">private async Task EditPartAsync()</div>
<div class="line">⋮----</div>
<div class="line">dialog.InitializeForEdit(SelectedPart);</div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _masterDataService.UpdatePartAsync(dialog.Part, new System.Collections.Generic.List&lt;Model_VolvoPartComponent&gt;());</div>
<div class="line">⋮----</div>
<div class="line">private bool CanEditPart() =&gt; SelectedPart != null &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line">private async Task DeactivatePartAsync()</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var deactivateResult = await _masterDataService.DeactivatePartAsync(SelectedPart.PartNumber);</div>
<div class="line">⋮----</div>
<div class="line">private bool CanDeactivatePart() =&gt; SelectedPart?.IsActive == true &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ViewComponentsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _masterDataService.GetComponentsAsync(SelectedPart.PartNumber);</div>
<div class="line">⋮----</div>
<div class="line">? string.Join(&quot;\n&quot;, result.Data.Select(c =&gt; $&quot;• {c.ComponentPartNumber} (Qty: {c.Quantity})&quot;))</div>
<div class="line">⋮----</div>
<div class="line">await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool CanViewComponents() =&gt; SelectedPart != null &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ImportCsvAsync()</div>
<div class="line">⋮----</div>
<div class="line">var picker = new FileOpenPicker();</div>
<div class="line">picker.FileTypeFilter.Add(&quot;.csv&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var hwnd = WinRT.Interop.WindowNative.GetWindowHandle(App.MainWindow);</div>
<div class="line">WinRT.Interop.InitializeWithWindow.Initialize(picker, hwnd);</div>
<div class="line">var file = await picker.PickSingleFileAsync();</div>
<div class="line">⋮----</div>
<div class="line">var csvContent = await FileIO.ReadTextAsync(file);</div>
<div class="line">var result = await _masterDataService.ImportCsvAsync(csvContent);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ExportCsvAsync()</div>
<div class="line">⋮----</div>
<div class="line">var picker = new FileSavePicker();</div>
<div class="line">picker.FileTypeChoices.Add(&quot;CSV File&quot;, new[] { &quot;.csv&quot; });</div>
<div class="line">⋮----</div>
<div class="line">var file = await picker.PickSaveFileAsync();</div>
<div class="line">⋮----</div>
<div class="line">var result = await _masterDataService.ExportCsvAsync(file.Path, ShowInactive);</div>
<div class="line">⋮----</div>
<div class="line">await FileIO.WriteTextAsync(file, result.Data);</div>
<div class="line">⋮----</div>
<div class="line">partial void OnShowInactiveChanged(bool value)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedPartChanged(Model_VolvoPart? value)</div>
<div class="line">⋮----</div>
<div class="line">EditPartCommand.NotifyCanExecuteChanged();</div>
<div class="line">DeactivatePartCommand.NotifyCanExecuteChanged();</div>
<div class="line">ViewComponentsCommand.NotifyCanExecuteChanged();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md480"></a>
File: MTM_Receiving_Application.Tests/Module_Core/Data/Authentication/Dao_User_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_User_Tests</div>
<div class="line">⋮----</div>
<div class="line">Helper_Database_Variables.GetConnectionString(useProduction: false);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Constructor_ValidConnectionString_CreatesInstance()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_User(TestConnectionString);</div>
<div class="line">dao.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Constructor_NullConnectionString_ThrowsArgumentNullException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; new Dao_User(null!);</div>
<div class="line">act.Should().Throw&lt;ArgumentNullException&gt;().WithMessage(&quot;*connectionString*&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void Constructor_EmptyConnectionString_DoesNotThrow()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; new Dao_User(string.Empty);</div>
<div class="line">act.Should().NotThrow();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task GetUserByWindowsUsernameAsync_ValidUsername_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetUserByWindowsUsernameAsync(username);</div>
<div class="line">result.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task GetUserByWindowsUsernameAsync_VariousUsernames_AcceptsInput_Async(</div>
<div class="line">⋮----</div>
<div class="line">public async Task ValidateUserPinAsync_ValidCredentials_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.ValidateUserPinAsync(username, pin);</div>
<div class="line">⋮----</div>
<div class="line">public async Task ValidateUserPinAsync_VariousInputs_AcceptsAllCombinations_Async(</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Arrange</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Act</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Assert</span></div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// ====================================================================</span></div>
<div class="line"><span class="comment">// CreateNewUserAsync Tests</span></div>
<div class="line">⋮----</div>
<div class="line">public async Task CreateNewUserAsync_ValidUser_ReturnsEmployeeNumber_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.CreateNewUserAsync(user, createdBy);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CreateNewUserAsync_NullVisualCredentials_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task CreateNewUserAsync_WithVisualCredentials_PassesParameters_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task IsWindowsUsernameUniqueAsync_WithoutExclusion_ChecksAllUsers_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.IsWindowsUsernameUniqueAsync(username);</div>
<div class="line">⋮----</div>
<div class="line">public async Task IsWindowsUsernameUniqueAsync_WithExclusion_ExcludesSpecificEmployee_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.IsWindowsUsernameUniqueAsync(username, excludeEmployeeNumber);</div>
<div class="line">⋮----</div>
<div class="line">public async Task IsWindowsUsernameUniqueAsync_VariousScenarios_HandlesAllCases_Async(</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.IsWindowsUsernameUniqueAsync(username, excludeId);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// LogUserActivityAsync Tests</span></div>
<div class="line">⋮----</div>
<div class="line">public async Task LogUserActivityAsync_ValidData_LogsActivity_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.LogUserActivityAsync(eventType, username, workstation, details);</div>
<div class="line">⋮----</div>
<div class="line">public async Task LogUserActivityAsync_DifferentEventTypes_LogsCorrectly_Async(</div>
<div class="line">⋮----</div>
<div class="line">public async Task LogUserActivityAsync_NullParameters_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.LogUserActivityAsync(&quot;event&quot;, null!, null!, null!);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetSharedTerminalNamesAsync_NoParameters_ReturnsTerminalList_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetSharedTerminalNamesAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpsertWorkstationConfigAsync_ValidData_InsertsOrUpdates_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpsertWorkstationConfigAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpsertWorkstationConfigAsync_NullDescription_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpsertWorkstationConfigAsync(&quot;WS-01&quot;, &quot;dedicated&quot;, true, null);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpsertWorkstationConfigAsync_VariousConfigurations_HandlesAll_Async(</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpsertWorkstationConfigAsync(name, type, active, description);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetActiveDepartmentsAsync_NoParameters_ReturnsDepartmentList_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetActiveDepartmentsAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateDefaultModeAsync_ValidData_UpdatesMode_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateDefaultModeAsync(userId, defaultMode);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateDefaultModeAsync_NullMode_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateDefaultModeAsync(userId, null);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateDefaultModeAsync_VariousInputs_HandlesAll_Async(int userId, string? mode)</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateDefaultModeAsync(userId, mode);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateDefaultReceivingModeAsync_ValidData_UpdatesMode_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateDefaultReceivingModeAsync(userId, defaultMode);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateDefaultReceivingModeAsync_DifferentModes_HandlesAll_Async(</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateDefaultReceivingModeAsync(userId, mode);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateDefaultDunnageModeAsync_ValidData_UpdatesMode_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateDefaultDunnageModeAsync(userId, defaultMode);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateDefaultDunnageModeAsync_VariousModes_HandlesAll_Async(</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateDefaultDunnageModeAsync(userId, mode);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetUserByWindowsUsernameAsync_EmptyString_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetUserByWindowsUsernameAsync(string.Empty);</div>
<div class="line">await act.Should().NotThrowAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task ValidateUserPinAsync_SpecialCharactersInUsername_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.ValidateUserPinAsync(username, pin);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CreateNewUserAsync_AllFieldsPopulated_PassesAllParameters_Async()</div>
<div class="line">⋮----</div>
<div class="line">var user = new Model_User</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.CreateNewUserAsync(user, createdBy);</div>
<div class="line">⋮----</div>
<div class="line">public async Task IsWindowsUsernameUniqueAsync_VeryLongUsername_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.IsWindowsUsernameUniqueAsync(longUsername);</div>
<div class="line">⋮----</div>
<div class="line">public async Task LogUserActivityAsync_LongDetails_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">await dao.LogUserActivityAsync(&quot;test_event&quot;, &quot;user&quot;, &quot;workstation&quot;, longDetails);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpsertWorkstationConfigAsync_VeryLongDescription_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">await dao.UpsertWorkstationConfigAsync(&quot;WS-01&quot;, &quot;shared&quot;, true, longDescription);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateDefaultModeAsync_BoundaryUserIds_HandlesAll_Async(int userId)</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.UpdateDefaultModeAsync(userId, &quot;mode&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task IsWindowsUsernameUniqueAsync_BoundaryExclusionValues_HandlesAll_Async(</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.IsWindowsUsernameUniqueAsync(&quot;user&quot;, excludeId);</div>
<div class="line">⋮----</div>
<div class="line">private static Model_User CreateValidTestUser()</div>
<div class="line">⋮----</div>
<div class="line">return new Model_User</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md481"></a>
File: MTM_Receiving_Application.Tests/Module_Dunnage/Data/Dao_DunnageLoad_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_DunnageLoad_Tests</div>
<div class="line">⋮----</div>
<div class="line">private static string TestConnectionString =&gt; Helper_Database_Variables.GetConnectionString(useProduction: <span class="keyword">false</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_ValidConnectionString_CreatesInstance()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_DunnageLoad(TestConnectionString);</div>
<div class="line">dao.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Constructor_NullConnectionString_DoesNotThrow()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; new Dao_DunnageLoad(null!);</div>
<div class="line">act.Should().NotThrow();</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllAsync_NoParameters_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetAllAsync();</div>
<div class="line">result.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByDateRangeAsync_ValidDateRange_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var startDate = DateTime.Now.AddDays(-30);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetByDateRangeAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByDateRangeAsync_StartDateAfterEndDate_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var endDate = DateTime.Now.AddDays(-30);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByDateRangeAsync_SameDates_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetByDateRangeAsync(date, date);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByDateRangeAsync_VeryOldDates_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var startDate = new DateTime(1900, 1, 1);</div>
<div class="line">var endDate = new DateTime(1900, 12, 31);</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetByDateRangeAsync(startDate, endDate);</div>
<div class="line">await act.Should().NotThrowAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByDateRangeAsync_FutureDates_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var startDate = DateTime.Now.AddYears(1);</div>
<div class="line">var endDate = DateTime.Now.AddYears(2);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByDateRangeAsync_VeryLargeRange_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByIdAsync_ValidGuid_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var loadUuid = Guid.NewGuid();</div>
<div class="line">var result = await dao.GetByIdAsync(loadUuid);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByIdAsync_EmptyGuid_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetByIdAsync(loadUuid);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByIdAsync_DifferentGuids_HandlesAll_Async()</div>
<div class="line">⋮----</div>
<div class="line">var guid = Guid.NewGuid();</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetByIdAsync(guid);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_ValidParameters_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.InsertAsync(loadUuid, partId, quantity, user);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_DifferentParts_HandlesAll_Async(<span class="keywordtype">string</span> partId, decimal quantity)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_DifferentQuantities_HandlesAll_Async(decimal quantity)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_DifferentUsers_HandlesAll_Async(<span class="keywordtype">string</span> user)</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Arrange</span></div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertBatchAsync_ValidSingleLoad_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.InsertBatchAsync(loads, user);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertBatchAsync_MultipleLoads_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertBatchAsync_VariousBatchSizes_HandlesAll_Async(<span class="keywordtype">int</span> batchSize)</div>
<div class="line">⋮----</div>
<div class="line">loads.Add(CreateValidDunnageLoad());</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_ValidParameters_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateAsync(loadUuid, quantity, user);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_DifferentQuantities_HandlesAll_Async(decimal quantity)</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_EmptyGuid_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.UpdateAsync(loadUuid, quantity, user);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteAsync_ValidGuid_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.DeleteAsync(loadUuid);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteAsync_EmptyGuid_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.DeleteAsync(loadUuid);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteAsync_MultipleDeletes_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.DeleteAsync(guid);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_VeryLongPartId_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.InsertAsync(loadUuid, partId, quantity, user);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_VeryLongUsername_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_SpecialCharactersInPartId_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_NegativeQuantity_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertBatchAsync_EmptyList_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.InsertBatchAsync(loads, user);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertBatchAsync_DuplicatePartIds_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_VeryLargeQuantity_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_VerySmallQuantity_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">private static Model_DunnageLoad CreateValidDunnageLoad()</div>
<div class="line">⋮----</div>
<div class="line">return new Model_DunnageLoad</div>
<div class="line">⋮----</div>
<div class="line">LoadUuid = Guid.NewGuid(),</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md482"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Data/Dao_ReceivingLine_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_ReceivingLine_Tests</div>
<div class="line">⋮----</div>
<div class="line">private static string TestConnectionString =&gt; Helper_Database_Variables.GetConnectionString(useProduction: <span class="keyword">false</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_ValidConnectionString_CreatesInstance()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_ReceivingLine(TestConnectionString);</div>
<div class="line">dao.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Constructor_NullConnectionString_ThrowsArgumentNullException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; new Dao_ReceivingLine(null!);</div>
<div class="line">act.Should().Throw&lt;ArgumentNullException&gt;()</div>
<div class="line">.WithParameterName(<span class="stringliteral">&quot;connectionString&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Constructor_EmptyConnectionString_DoesNotThrow()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; new Dao_ReceivingLine(<span class="keywordtype">string</span>.Empty);</div>
<div class="line">act.Should().NotThrow();</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_InvalidConnectionString_ReturnsFailureResult_Async()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_ReceivingLine(<span class="stringliteral">&quot;Server=invalid;Database=nonexistent;&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.InsertReceivingLineAsync(line);</div>
<div class="line">result.Should().NotBeNull();</div>
<div class="line">result.Success.Should().BeFalse(<span class="stringliteral">&quot;DAO must return failure result instead of throwing exception&quot;</span>);</div>
<div class="line">result.ErrorMessage.Should().NotBeNullOrEmpty();</div>
<div class="line">result.Severity.Should().Be(Enum_ErrorSeverity.Error);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_NullPartID_ReturnsResult_Async()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_ReceivingLine(<span class="stringliteral">&quot;Server=invalid;&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_NullHeat_ReturnsResult_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_NullInitialLocation_ReturnsResult_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_NullCoilsOnSkid_ReturnsResult_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_NullVendorName_ReturnsResult_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_NullPartDescription_ReturnsResult_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_DifferentQuantities_HandlesAllValues_Async(<span class="keywordtype">int</span> quantity)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_DifferentPONumbers_HandlesAllValues_Async(<span class="keywordtype">int</span> poNumber)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_AllFieldsPopulated_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">var line = new Model_ReceivingLine</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.InsertReceivingLineAsync(line);</div>
<div class="line">await act.Should().NotThrowAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_MinimalFields_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_VeryLongPartID_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_VeryLongHeat_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_VeryLongPartDescription_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_FutureDate_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">line.Date = DateTime.Now.AddYears(1);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_PastDate_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">line.Date = DateTime.Now.AddYears(-10);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_BoundaryCoilsOnSkid_DoesNotThrow_Async(<span class="keywordtype">int</span>? coilsOnSkid)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_BoundaryEmployeeNumbers_DoesNotThrow_Async(<span class="keywordtype">int</span> employeeNumber)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_SpecialCharactersInFields_DoesNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertReceivingLineAsync_DatabaseException_ReturnsFailureNotThrow_Async()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_ReceivingLine(<span class="keywordtype">string</span>.Empty);</div>
<div class="line">⋮----</div>
<div class="line">await act.Should().NotThrowAsync(<span class="stringliteral">&quot;DAO must return failure result instead of throwing exception&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">result.Success.Should().BeFalse();</div>
<div class="line">⋮----</div>
<div class="line">private static Model_ReceivingLine CreateValidReceivingLine()</div>
<div class="line">⋮----</div>
<div class="line">return new Model_ReceivingLine</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md483"></a>
File: MTM_Receiving_Application.Tests/Module_Receiving/Data/Dao_ReceivingLoad_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_ReceivingLoad_Tests</div>
<div class="line">⋮----</div>
<div class="line">private static string TestConnectionString =&gt; Helper_Database_Variables.GetConnectionString(useProduction: <span class="keyword">false</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_ValidConnectionString_CreatesInstance()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_ReceivingLoad(TestConnectionString);</div>
<div class="line">dao.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Constructor_NullConnectionString_ThrowsArgumentNullException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; new Dao_ReceivingLoad(null!);</div>
<div class="line">act.Should().Throw&lt;ArgumentNullException&gt;()</div>
<div class="line">.WithMessage(<span class="stringliteral">&quot;*connectionString*&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_NullList_ReturnsFailure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.SaveLoadsAsync(null!);</div>
<div class="line">result.Should().NotBeNull();</div>
<div class="line">result.Success.Should().BeFalse();</div>
<div class="line">result.ErrorMessage.Should().Contain(<span class="stringliteral">&quot;null or empty&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_EmptyList_ReturnsFailure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.SaveLoadsAsync(loads);</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_ValidSingleLoad_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_MultipleValidLoads_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_NullPONumber_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_CleansPONumberPrefix_HandlesAll_Async(<span class="keywordtype">string</span> poNumber)</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_NonPOItem_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateLoadsAsync_NullList_ReturnsFailure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateLoadsAsync(null!);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateLoadsAsync_EmptyList_ReturnsFailure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateLoadsAsync(loads);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateLoadsAsync_ValidSingleLoad_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateLoadsAsync_MultipleLoads_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteLoadsAsync_NullList_ReturnsSuccess_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.DeleteLoadsAsync(null!);</div>
<div class="line">⋮----</div>
<div class="line">result.Success.Should().BeTrue();</div>
<div class="line">result.Data.Should().Be(0);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteLoadsAsync_EmptyList_ReturnsSuccess_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.DeleteLoadsAsync(loads);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteLoadsAsync_ValidSingleLoad_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteLoadsAsync_MultipleLoads_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetHistoryAsync_ValidParameters_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var startDate = DateTime.Now.AddDays(-30);</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetHistoryAsync(partID, startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetHistoryAsync_DifferentPartIDs_HandlesAll_Async(<span class="keywordtype">string</span> partID)</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetHistoryAsync_StartDateAfterEndDate_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var endDate = DateTime.Now.AddDays(-30);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetHistoryAsync_SameDateRange_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetHistoryAsync(partID, date, date);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllAsync_ValidDateRange_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetAllAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllAsync_WideRange_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var startDate = DateTime.Now.AddYears(-10);</div>
<div class="line">var endDate = DateTime.Now.AddYears(1);</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_DifferentWeights_HandlesAll_Async(decimal weight)</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_DifferentPackageCounts_HandlesAll_Async(<span class="keywordtype">int</span> packageCount)</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_VeryLongPartID_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.SaveLoadsAsync(loads);</div>
<div class="line">await act.Should().NotThrowAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_VeryLongHeatNumber_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_SpecialCharactersInFields_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task SaveLoadsAsync_VariousBatchSizes_HandlesAll_Async(<span class="keywordtype">int</span> batchSize)</div>
<div class="line">⋮----</div>
<div class="line">loads.Add(CreateValidLoad());</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetHistoryAsync_VeryOldDates_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var startDate = new DateTime(1900, 1, 1);</div>
<div class="line">var endDate = new DateTime(1900, 12, 31);</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetHistoryAsync(<span class="stringliteral">&quot;PART-001&quot;</span>, startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllAsync_FutureDates_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var startDate = DateTime.Now.AddYears(1);</div>
<div class="line">var endDate = DateTime.Now.AddYears(2);</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetAllAsync(startDate, endDate);</div>
<div class="line">⋮----</div>
<div class="line">private static Model_ReceivingLoad CreateValidLoad()</div>
<div class="line">⋮----</div>
<div class="line">return new Model_ReceivingLoad</div>
<div class="line">⋮----</div>
<div class="line">LoadID = Guid.NewGuid(),</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md484"></a>
File: MTM_Receiving_Application.Tests/Module_Routing/Data/Dao_RoutingLabel_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_RoutingLabel_Tests</div>
<div class="line">⋮----</div>
<div class="line">private static string TestConnectionString =&gt; Helper_Database_Variables.GetConnectionString(useProduction: <span class="keyword">false</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_ValidConnectionString_CreatesInstance()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_RoutingLabel(TestConnectionString);</div>
<div class="line">dao.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Constructor_NullConnectionString_ThrowsArgumentNullException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; new Dao_RoutingLabel(null!);</div>
<div class="line">act.Should().Throw&lt;ArgumentNullException&gt;()</div>
<div class="line">.WithMessage(<span class="stringliteral">&quot;*connectionString*&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_ValidLabel_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.InsertLabelAsync(label);</div>
<div class="line">result.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_NullOtherReasonId_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_WithOtherReasonId_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_DifferentQuantities_HandlesAll_Async(<span class="keywordtype">int</span> quantity)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_DifferentPONumbers_HandlesAll_Async(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> lineNumber)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_DifferentCreatedBy_HandlesAll_Async(<span class="keywordtype">int</span> createdBy)</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateLabelAsync_ValidLabel_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateLabelAsync(label);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateLabelAsync_UpdatedQuantity_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateLabelAsync_NullOtherReasonId_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateLabelAsync_DifferentIds_HandlesAll_Async(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetLabelByIdAsync_ValidId_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetLabelByIdAsync(labelId);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetLabelByIdAsync_DifferentIds_HandlesAll_Async(<span class="keywordtype">int</span> labelId)</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetLabelByIdAsync_NegativeId_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetLabelByIdAsync(labelId);</div>
<div class="line">await act.Should().NotThrowAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllLabelsAsync_DefaultParameters_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetAllLabelsAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllLabelsAsync_DifferentPagination_HandlesAll_Async(<span class="keywordtype">int</span> limit, <span class="keywordtype">int</span> offset)</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetAllLabelsAsync(limit, offset);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllLabelsAsync_ZeroLimit_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetAllLabelsAsync(0, 0);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllLabelsAsync_NegativeOffset_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetAllLabelsAsync(100, -10);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteLabelAsync_ValidId_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.DeleteLabelAsync(labelId);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteLabelAsync_DifferentIds_HandlesAll_Async(<span class="keywordtype">int</span> labelId)</div>
<div class="line">⋮----</div>
<div class="line">public async Task MarkLabelExportedAsync_ValidId_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.MarkLabelExportedAsync(labelId);</div>
<div class="line">⋮----</div>
<div class="line">public async Task MarkLabelExportedAsync_DifferentIds_HandlesAll_Async(<span class="keywordtype">int</span> labelId)</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateLabelAsync_ValidParameters_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.CheckDuplicateLabelAsync(poNumber, lineNumber, recipientId, hoursWindow);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateLabelAsync_DifferentTimeWindows_HandlesAll_Async(<span class="keywordtype">int</span> hoursWindow)</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateLabelAsync_ZeroHoursWindow_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.CheckDuplicateLabelAsync(poNumber, lineNumber, recipientId, 0);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateLabelAsync_DifferentPONumbers_HandlesAll_Async(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> lineNumber)</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.CheckDuplicateLabelAsync(poNumber, lineNumber, recipientId, 24);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateAsync_ValidParameters_CallsCheckDuplicate_Async()</div>
<div class="line">⋮----</div>
<div class="line">var createdWithinDate = DateTime.Now.AddHours(-12);</div>
<div class="line">var result = await dao.CheckDuplicateAsync(poNumber, lineNumber, recipientId, createdWithinDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateAsync_DefaultDateTime_UsesDefault24Hours_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.CheckDuplicateAsync(poNumber, lineNumber, recipientId, default);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateAsync_FutureDate_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var futureDate = DateTime.Now.AddDays(1);</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.CheckDuplicateAsync(poNumber, lineNumber, recipientId, futureDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateAsync_OldDate_CapsAtOneWeek_Async()</div>
<div class="line">⋮----</div>
<div class="line">var oldDate = DateTime.Now.AddDays(-30);</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.CheckDuplicateAsync(poNumber, lineNumber, recipientId, oldDate);</div>
<div class="line">⋮----</div>
<div class="line">public async Task MarkExportedAsync_EmptyList_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.MarkExportedAsync(labelIds);</div>
<div class="line">⋮----</div>
<div class="line">public async Task MarkExportedAsync_SingleId_CallsMarkExported_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task MarkExportedAsync_MultipleIds_CallsMarkExportedForEach_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_VeryLongDescription_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.InsertLabelAsync(label);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_SpecialCharactersInFields_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_ZeroQuantity_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_NegativeQuantity_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertLabelAsync_BoundaryRecipientIds_HandlesAll_Async(<span class="keywordtype">int</span> recipientId)</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllLabelsAsync_VeryLargeLimit_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetAllLabelsAsync(<span class="keywordtype">int</span>.MaxValue, 0);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateLabelAsync_VeryLargeTimeWindow_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.CheckDuplicateLabelAsync(<span class="stringliteral">&quot;PO-123&quot;</span>, <span class="stringliteral">&quot;001&quot;</span>, 10, 99999);</div>
<div class="line">⋮----</div>
<div class="line">public async Task CheckDuplicateLabelAsync_NegativeTimeWindow_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.CheckDuplicateLabelAsync(<span class="stringliteral">&quot;PO-123&quot;</span>, <span class="stringliteral">&quot;001&quot;</span>, 10, -24);</div>
<div class="line">⋮----</div>
<div class="line">private static Model_RoutingLabel CreateValidRoutingLabel()</div>
<div class="line">⋮----</div>
<div class="line">return new Model_RoutingLabel</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md485"></a>
File: MTM_Receiving_Application.Tests/Module_Settings/Data/Dao_PackageType_Tests.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_PackageType_Tests</div>
<div class="line">⋮----</div>
<div class="line">private static string TestConnectionString =&gt; Helper_Database_Variables.GetConnectionString(useProduction: <span class="keyword">false</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Constructor_ValidConnectionString_CreatesInstance()</div>
<div class="line">⋮----</div>
<div class="line">var dao = new Dao_PackageType(TestConnectionString);</div>
<div class="line">dao.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line">public <span class="keywordtype">void</span> Constructor_NullConnectionString_ThrowsArgumentNullException()</div>
<div class="line">⋮----</div>
<div class="line">Action act = () =&gt; new Dao_PackageType(null!);</div>
<div class="line">act.Should().Throw&lt;ArgumentNullException&gt;()</div>
<div class="line">.WithMessage(<span class="stringliteral">&quot;*connectionString*&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetAllAsync_NoParameters_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetAllAsync();</div>
<div class="line">result.Should().NotBeNull();</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByIdAsync_ValidId_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetByIdAsync(<span class="keywordtype">id</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByIdAsync_DifferentIds_HandlesAll_Async(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetByIdAsync_NegativeId_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetByIdAsync(<span class="keywordtype">id</span>);</div>
<div class="line">await act.Should().NotThrowAsync();</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_ValidPackageType_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.InsertAsync(packageType, createdBy);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_MinimalData_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var packageType = new Model_PackageType</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_DifferentTypes_HandlesAll_Async(<span class="keywordtype">string</span> name, <span class="keywordtype">string</span> code)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_DifferentCreatedBy_HandlesAll_Async(<span class="keywordtype">int</span> createdBy)</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_ValidPackageType_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.UpdateAsync(packageType);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_AllFieldsChanged_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_DifferentIds_HandlesAll_Async(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteAsync_ValidId_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.DeleteAsync(<span class="keywordtype">id</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteAsync_DifferentIds_HandlesAll_Async(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public async Task DeleteAsync_NegativeId_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.DeleteAsync(<span class="keywordtype">id</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetUsageCountAsync_ValidId_CallsStoredProcedure_Async()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dao.GetUsageCountAsync(<span class="keywordtype">id</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetUsageCountAsync_DifferentIds_HandlesAll_Async(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_VeryLongName_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.InsertAsync(packageType, createdBy);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_VeryLongCode_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_SpecialCharactersInName_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_EmptyStrings_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_VeryLongName_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.UpdateAsync(packageType);</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_SpecialCharactersInCode_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task GetUsageCountAsync_BoundaryValues_HandlesAll_Async(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div>
<div class="line">⋮----</div>
<div class="line">Func&lt;Task&gt; act = async () =&gt; await dao.GetUsageCountAsync(<span class="keywordtype">id</span>);</div>
<div class="line">⋮----</div>
<div class="line">public async Task InsertAsync_NegativeCreatedBy_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">public async Task UpdateAsync_WithIdZero_HandlesGracefully_Async()</div>
<div class="line">⋮----</div>
<div class="line">private static Model_PackageType CreateValidPackageType()</div>
<div class="line">⋮----</div>
<div class="line">return new Model_PackageType</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md486"></a>
File: MTM_Receiving_Application.Tests/UnitTest1.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>UnitTest1</div>
<div class="line">⋮----</div>
<div class="line">public void Test_BasicMath_ShouldPass()</div>
<div class="line">⋮----</div>
<div class="line">result.Should().Be(expected);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> Test_StringOperation_ShouldPass()</div>
<div class="line">⋮----</div>
<div class="line">var result = testString.ToUpper();</div>
<div class="line">result.Should().Be(<span class="stringliteral">&quot;HELLO, WORLD!&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md487"></a>
File: Module_Core/Helpers/Database/Helper_Database_Variables.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span>Helper_Database_Variables</div>
<div class="line">⋮----</div>
<div class="line">public static string GetConnectionString(bool useProduction = <span class="keyword">true</span>)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">string</span> GetInforVisualConnectionString()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md488"></a>
File: Module_Dunnage/Views/View_Dunnage_WorkflowView.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial class </span>View_Dunnage_WorkflowView : Page</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Focus _focusService;</div>
<div class="line">⋮----</div>
<div class="line">_focusService.AttachFocusOnVisibility(this);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnWorkflowStepChanged(object? sender, EventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void HelpButton_Click(object sender, RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async System.Threading.Tasks.Task ShowHelpForCurrentStepAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _helpService.ShowContextualHelpAsync(_workflowService.CurrentStep);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnNextClick(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var result = await workflowService.AdvanceToNextStepAsync();</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var dialogResult = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void OnSaveAndReviewClick(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">var confirmDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var confirmResult = await confirmDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var errorDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">await errorDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void OnBackClick(object sender, Microsoft.UI.Xaml.RoutedEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">workflowService.GoToStep(Enum_DunnageWorkflowStep.TypeSelection);</div>
<div class="line">⋮----</div>
<div class="line">workflowService.GoToStep(Enum_DunnageWorkflowStep.PartSelection);</div>
<div class="line">⋮----</div>
<div class="line">workflowService.GoToStep(Enum_DunnageWorkflowStep.QuantityEntry);</div>
<div class="line">⋮----</div>
<div class="line">workflowService.GoToStep(Enum_DunnageWorkflowStep.DetailsEntry);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md489"></a>
File: Module_Routing/Data/Dao_RoutingLabel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_RoutingLabel</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; InsertLabelAsync(Model_RoutingLabel label)</div>
<div class="line">⋮----</div>
<div class="line">Console.WriteLine($<span class="stringliteral">&quot;[DAO] Inserting label: PO={label.PONumber}, Recipient={label.RecipientId}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_po_number&quot;</span>, label.PONumber),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_line_number&quot;</span>, label.LineNumber),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_description&quot;</span>, label.Description),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_recipient_id&quot;</span>, label.RecipientId),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_quantity&quot;</span>, label.Quantity),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_created_by&quot;</span>, label.CreatedBy),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_other_reason_id&quot;</span>, (<span class="keywordtype">object</span>?)label.OtherReasonId ?? DBNull.Value),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_new_label_id&quot;</span>, MySqlDbType.Int32) { Direction = ParameterDirection.Output },</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_error_message&quot;</span>, MySqlDbType.VarChar, 500) { Direction = ParameterDirection.Output }</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line">var newIdParam = Array.Find(parameters, p =&gt; p.ParameterName == <span class="stringliteral">&quot;@p_new_label_id&quot;</span>);</div>
<div class="line"><span class="keywordtype">int</span> newId = newIdParam?.Value != DBNull.Value ? Convert.ToInt32(newIdParam?.Value) : 0;</div>
<div class="line">var errorMsgParam = Array.Find(parameters, p =&gt; p.ParameterName == <span class="stringliteral">&quot;@p_error_message&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">if (!<span class="keywordtype">string</span>.IsNullOrEmpty(spErrorMsg))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpdateLabelAsync(Model_RoutingLabel label)</div>
<div class="line">⋮----</div>
<div class="line">Console.WriteLine($<span class="stringliteral">&quot;[DAO] Updating label {label.Id}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_label_id&quot;</span>, label.Id),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_status&quot;</span>, MySqlDbType.Int32) { Direction = ParameterDirection.Output },</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_error_msg&quot;</span>, MySqlDbType.VarChar, 500) { Direction = ParameterDirection.Output }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Error updating routing label: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_RoutingLabel&gt;&gt; GetLabelByIdAsync(<span class="keywordtype">int</span> labelId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingLabel&gt;&gt;&gt; GetAllLabelsAsync(<span class="keywordtype">int</span> limit = 100, <span class="keywordtype">int</span> offset = 0)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeleteLabelAsync(<span class="keywordtype">int</span> labelId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_label_id&quot;</span>, labelId),</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Error deleting routing label: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; MarkLabelExportedAsync(<span class="keywordtype">int</span> labelId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Error marking label as exported: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_RoutingLabel&gt;&gt; CheckDuplicateLabelAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> Model_RoutingLabel MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_RoutingLabel</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">PONumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;po_number&quot;</span>)) ? <span class="keywordtype">string</span>.Empty : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;po_number&quot;</span>)),</div>
<div class="line">LineNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;line_number&quot;</span>)) ? <span class="keywordtype">string</span>.Empty : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;line_number&quot;</span>)),</div>
<div class="line">Description = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;description&quot;</span>)) ? <span class="keywordtype">string</span>.Empty : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;description&quot;</span>)),</div>
<div class="line">RecipientId = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;recipient_id&quot;</span>)),</div>
<div class="line">RecipientName = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;recipient_name&quot;</span>)) ? <span class="keywordtype">string</span>.Empty : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;recipient_name&quot;</span>)),</div>
<div class="line">RecipientLocation = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;recipient_location&quot;</span>)) ? <span class="keywordtype">string</span>.Empty : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;recipient_location&quot;</span>)),</div>
<div class="line">Quantity = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;quantity&quot;</span>)),</div>
<div class="line">CreatedBy = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">OtherReasonId = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;other_reason_id&quot;</span>)) ? <span class="keyword">null</span> : reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;other_reason_id&quot;</span>)),</div>
<div class="line">OtherReasonDescription = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;other_reason_description&quot;</span>)) ? <span class="keyword">null</span> : reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;other_reason_description&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">CsvExported = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;csv_exported&quot;</span>)),</div>
<div class="line">CsvExportDate = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;csv_export_date&quot;</span>)) ? <span class="keyword">null</span> : reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;csv_export_date&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;(<span class="keywordtype">bool</span> Exists, <span class="keywordtype">int</span>? ExistingLabelId)&gt;&gt; CheckDuplicateAsync(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> lineNumber, <span class="keywordtype">int</span> recipientId, DateTime createdWithinDate)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success((Exists: <span class="keyword">true</span>, ExistingLabelId: (<span class="keywordtype">int</span>?)result.Data.Id));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success((Exists: <span class="keyword">false</span>, ExistingLabelId: (<span class="keywordtype">int</span>?)<span class="keyword">null</span>));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; MarkExportedAsync(List&lt;int&gt; labelIds)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md490"></a>
File: Module_Routing/Data/Dao_RoutingLabelHistory.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_RoutingLabelHistory</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertHistoryAsync(Model_RoutingLabelHistory history)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_label_id&quot;</span>, history.LabelId),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_field_changed&quot;</span>, history.FieldChanged),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_old_value&quot;</span>, (<span class="keywordtype">object</span>?)history.OldValue ?? DBNull.Value),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_new_value&quot;</span>, (<span class="keywordtype">object</span>?)history.NewValue ?? DBNull.Value),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_edited_by&quot;</span>, history.EditedBy),</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_status&quot;</span>, MySqlDbType.Int32) { Direction = System.Data.ParameterDirection.Output },</div>
<div class="line"><span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_error_msg&quot;</span>, MySqlDbType.VarChar, 500) { Direction = System.Data.ParameterDirection.Output }</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Error inserting history: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertHistoryBatchAsync(List&lt;Model_RoutingLabelHistory&gt; historyEntries)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(<span class="stringliteral">&quot;No history entries to insert&quot;</span>, 0);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Batch insert failed at entry {successCount + 1}: {result.ErrorMessage}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success($<span class="stringliteral">&quot;Inserted {successCount} history entries&quot;</span>, successCount);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Failure($<span class="stringliteral">&quot;Error in batch insert: {ex.Message}&quot;</span>, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md491"></a>
File: Module_Routing/Services/RoutingInforVisualService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>RoutingInforVisualService : IRoutingInforVisualService</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_InforVisualPO _daoInforVisualPO;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line">_daoInforVisualPO = daoInforVisualPO ?? throw new ArgumentNullException(nameof(daoInforVisualPO));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; ValidatePoNumberAsync(string poNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Validating PO number: {poNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;[MOCK DATA MODE] Validating PO {poNumber}&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Success(true);</div>
<div class="line">⋮----</div>
<div class="line">var connectionResult = await _daoInforVisualPO.CheckConnectionAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Infor Visual unavailable: {connectionResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return await _daoInforVisualPO.ValidatePOAsync(poNumber);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error validating PO {poNumber}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_InforVisualPOLine&gt;&gt;&gt; GetPoLinesAsync(string poNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting PO lines for: {poNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;[MOCK DATA MODE] Returning mock lines for PO {poNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">new Model_InforVisualPOLine</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(mockLines);</div>
<div class="line">⋮----</div>
<div class="line">return await _daoInforVisualPO.GetLinesAsync(poNumber);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting PO lines for {poNumber}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_InforVisualPOLine&gt;&gt; GetPoLineAsync(string poNumber, string lineNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting PO line {poNumber}-{lineNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;[MOCK DATA MODE] Returning mock data for line {lineNumber}&quot;);</div>
<div class="line">var mockLine = new Model_InforVisualPOLine</div>
<div class="line">⋮----</div>
<div class="line">PartID = $&quot;MOCK-PART-{lineNumber.PadLeft(3, <span class="charliteral">&#39;0&#39;</span>)}<span class="stringliteral">&quot;,</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Success(mockLine);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (!int.TryParse(lineNumber, out int lineNum))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return await _daoInforVisualPO.GetLineAsync(poNumber, lineNum);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Error getting PO line {poNumber}-{lineNumber}: {ex.Message}<span class="stringliteral">&quot;, ex);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; CheckConnectionAsync()</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return await _daoInforVisualPO.CheckConnectionAsync();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Error checking Infor Visual connection: {ex.Message}<span class="stringliteral">&quot;, ex);</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Success(false);</span></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md492"></a>
File: Module_Routing/Views/RoutingWizardStep3View.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Routing.Views.RoutingWizardStep3View&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:vm</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:coreConverters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnPageLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">coreConverters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                   <span class="keyword">Text</span>=<span class="stringliteral">&quot;Step 3: Review and Confirm&quot;</span> </div>
<div class="line">                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Review Cards --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Source Card (PO &amp; Part) --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                        <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B9;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Source&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Button</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span></div>
<div class="line">                                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.EditPOSelectionCommand}&quot;</span></div>
<div class="line">                                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtleButtonStyle}&quot;</span> </div>
<div class="line">                                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Edit Source&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE70F;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                        </div>
<div class="line">                        &lt;<span class="keywordtype">MenuFlyoutSeparator</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- PO Info --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;PO:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoNumber, Mode=OneWay}&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Line:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                                       <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsOtherWorkflow, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoLine, Mode=OneWay}&quot;</span></div>
<div class="line">                                       <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsOtherWorkflow, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>/&gt;</div>
<div class="line">                                       </div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Reason:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                                       <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsOtherWorkflow, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.OtherReason, Mode=OneWay}&quot;</span></div>
<div class="line">                                       <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsOtherWorkflow, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Part Info --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                             &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PartID, Mode=OneWay}&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PartDescription, Mode=OneWay}&quot;</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Qty:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Quantity, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                             &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Destination Card (Recipient) --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                        <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                        <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                        <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span>&gt;</div>
<div class="line">                     &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE77B;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Destination&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Button</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span></div>
<div class="line">                                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.EditRecipientSelectionCommand}&quot;</span></div>
<div class="line">                                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtleButtonStyle}&quot;</span></div>
<div class="line">                                    <span class="keyword">ToolTipService.ToolTip</span>=<span class="stringliteral">&quot;Edit Destination&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE70F;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;14&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">MenuFlyoutSeparator</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Recipient&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RecipientName, Mode=OneWay}&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                            </div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Location / Department&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;12&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RecipientLocation, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Placeholder for Label Preview --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Border</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;60&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Bottom&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,16,0,0&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE743;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorTertiaryBrush}&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Ready to Print&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorTertiaryBrush}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                          <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                       <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Back&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NavigateBackCommand}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Create Label&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CreateLabelCommand}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md493"></a>
File: Module_Volvo/Data/Dao_VolvoPart.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_VolvoPart</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPart&gt;&gt;&gt; GetAllAsync(<span class="keywordtype">bool</span> includeInactive = <span class="keyword">false</span>)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_VolvoPart&gt;&gt; GetByIdAsync(<span class="keywordtype">string</span> partNumber)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; InsertAsync(Model_VolvoPart part)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_VolvoPart part)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; DeactivateAsync(<span class="keywordtype">string</span> partNumber)</div>
<div class="line">⋮----</div>
<div class="line">var checkResult = await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Dictionary&lt;<span class="keywordtype">string</span>, Model_VolvoPart&gt;&gt;&gt; GetPartsByNumbersAsync(List&lt;<span class="keywordtype">string</span>&gt; partNumbers)</div>
<div class="line">⋮----</div>
<div class="line">private static Model_VolvoPart MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_VolvoPart</div>
<div class="line">⋮----</div>
<div class="line">PartNumber = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;part_number&quot;</span>)),</div>
<div class="line">QuantityPerSkid = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;quantity_per_skid&quot;</span>)),</div>
<div class="line">IsActive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_active&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md494"></a>
File: Module_Volvo/Data/Dao_VolvoSettings.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_VolvoSettings</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_VolvoSetting&gt;&gt; GetSettingAsync(string settingKey)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoSetting&gt;&gt;&gt; GetAllSettingsAsync(string? category = <span class="keyword">null</span>)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpsertSettingAsync(<span class="keywordtype">string</span> settingKey, <span class="keywordtype">string</span> settingValue, <span class="keywordtype">string</span> modifiedBy)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; ResetSettingAsync(<span class="keywordtype">string</span> settingKey, <span class="keywordtype">string</span> modifiedBy)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Model_VolvoSetting MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_VolvoSetting</div>
<div class="line">⋮----</div>
<div class="line">SettingKey = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_key&quot;</span>)),</div>
<div class="line">SettingValue = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_value&quot;</span>)),</div>
<div class="line">SettingType = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;setting_type&quot;</span>)),</div>
<div class="line">Category = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;category&quot;</span>)),</div>
<div class="line">Description = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;description&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;description&quot;</span>)),</div>
<div class="line">DefaultValue = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;default_value&quot;</span>)),</div>
<div class="line">MinValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;min_value&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;min_value&quot;</span>)),</div>
<div class="line">MaxValue = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;max_value&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;max_value&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>)),</div>
<div class="line">ModifiedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;modified_by&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md495"></a>
File: Module_Volvo/Data/Dao_VolvoShipmentLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_VolvoShipmentLine</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; InsertAsync(Model_VolvoShipmentLine line)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoShipmentLine&gt;&gt;&gt; GetByShipmentIdAsync(<span class="keywordtype">int</span> shipmentId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_VolvoShipmentLine line)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> lineId)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Model_VolvoShipmentLine MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Model_VolvoShipmentLine</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">ShipmentId = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;shipment_id&quot;</span>)),</div>
<div class="line">PartNumber = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;part_number&quot;</span>)),</div>
<div class="line">QuantityPerSkid = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;quantity_per_skid&quot;</span>)),</div>
<div class="line">ReceivedSkidCount = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;received_skid_count&quot;</span>)),</div>
<div class="line">CalculatedPieceCount = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;calculated_piece_count&quot;</span>)),</div>
<div class="line">HasDiscrepancy = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;has_discrepancy&quot;</span>)),</div>
<div class="line">ExpectedSkidCount = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;expected_skid_count&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;expected_skid_count&quot;</span>)),</div>
<div class="line">DiscrepancyNote = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;discrepancy_note&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;discrepancy_note&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md496"></a>
File: Module_Volvo/Services/Service_VolvoMasterData.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_VolvoMasterData : IService_VolvoMasterData</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_VolvoPart _daoPart;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_VolvoPartComponent _daoComponent;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line">⋮----</div>
<div class="line">_daoPart = daoPart ?? throw new ArgumentNullException(nameof(daoPart));</div>
<div class="line">_daoComponent = daoComponent ?? throw new ArgumentNullException(nameof(daoComponent));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">_errorHandler = errorHandler ?? throw new ArgumentNullException(nameof(errorHandler));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPart&gt;&gt;&gt; GetAllPartsAsync(bool includeInactive)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting all Volvo parts (includeInactive={includeInactive})&quot;);</div>
<div class="line">var result = await _daoPart.GetAllAsync(includeInactive);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to get parts: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting all parts: {ex.Message}&quot;, ex);</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_VolvoPart?&gt;&gt; GetPartByNumberAsync(string partNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting part by number: {partNumber}&quot;);</div>
<div class="line">var result = await _daoPart.GetByIdAsync(partNumber);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to get part {partNumber}: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting part {partNumber}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; AddPartAsync(Model_VolvoPart part, List&lt;Model_VolvoPartComponent&gt;? components = null)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Adding new part: {part.PartNumber}&quot;);</div>
<div class="line">if (string.IsNullOrWhiteSpace(part.PartNumber))</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Part number is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Quantity per skid must be non-negative&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var insertResult = await _daoPart.InsertAsync(part);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to insert part {part.PartNumber}: {insertResult.ErrorMessage}&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Failure(insertResult.ErrorMessage);</div>
<div class="line">⋮----</div>
<div class="line">var componentResult = await _daoComponent.InsertAsync(component);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to insert component {component.ComponentPartNumber}: {componentResult.ErrorMessage}&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Failed to save component {component.ComponentPartNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully added part {part.PartNumber} with {components?.Count ?? 0} components&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Success(&quot;Part added successfully&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error adding part {part.PartNumber}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error adding part: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdatePartAsync(Model_VolvoPart part, List&lt;Model_VolvoPartComponent&gt;? components = null)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Updating part: {part.PartNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var updateResult = await _daoPart.UpdateAsync(part);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to update part {part.PartNumber}: {updateResult.ErrorMessage}&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Failure(updateResult.ErrorMessage);</div>
<div class="line">⋮----</div>
<div class="line">var deleteResult = await _daoComponent.DeleteByParentPartAsync(part.PartNumber);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to delete components for {part.PartNumber}: {deleteResult.ErrorMessage}&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Failed to update components: {deleteResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var insertResult = await _daoComponent.InsertAsync(component);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to insert component {component.ComponentPartNumber}: {insertResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _daoComponent.DeleteByParentPartAsync(part.PartNumber);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully updated part {part.PartNumber} with {components?.Count ?? 0} components&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Success(&quot;Part updated successfully&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error updating part {part.PartNumber}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error updating part: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; DeactivatePartAsync(string partNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Deactivating part: {partNumber}&quot;);</div>
<div class="line">var result = await _daoPart.DeactivateAsync(partNumber);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to deactivate part {partNumber}: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully deactivated part {partNumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error deactivating part {partNumber}: {ex.Message}&quot;, ex);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error deactivating part: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPartComponent&gt;&gt;&gt; GetComponentsAsync(string partNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Getting components for part: {partNumber}&quot;);</div>
<div class="line">var result = await _daoComponent.GetByParentPartAsync(partNumber);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Failed to get components for {partNumber}: {result.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting components for {partNumber}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;(int New, int Updated, int Unchanged)&gt;&gt; ImportCsvAsync(string csvFilePath)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Starting CSV import&quot;);</div>
<div class="line">if (string.IsNullOrWhiteSpace(csvFilePath))</div>
<div class="line">⋮----</div>
<div class="line">var lines = csvFilePath.Split(&#39;\n&#39;).Select(l =&gt; l.Trim()).Where(l =&gt; !string.IsNullOrEmpty(l)).ToList();</div>
<div class="line">⋮----</div>
<div class="line">if (!header.Contains(&quot;PartNumber&quot;) || !header.Contains(&quot;QuantityPerSkid&quot;))</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Line {i + 1}: Invalid format - expected at least 3 fields&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var partNumber = fields[0].Trim();</div>
<div class="line">var quantityStr = fields[1].Trim();</div>
<div class="line">var componentsStr = fields.Length &gt; 2 ? fields[2].Trim() : &quot;&quot;;</div>
<div class="line">if (!int.TryParse(quantityStr, out int quantity))</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Line {i + 1}: Invalid quantity &#39;{quantityStr}&#39;&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var part = new Model_VolvoPart</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Parse components (format: &quot;PART1:QTY1;PART2:QTY2&quot;)</span></div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrWhiteSpace(componentsStr))</div>
<div class="line">⋮----</div>
<div class="line">var componentPairs = componentsStr.Split(&#39;;&#39;);</div>
<div class="line">⋮----</div>
<div class="line">var parts = pair.Split(&#39;:&#39;);</div>
<div class="line">⋮----</div>
<div class="line">if (int.TryParse(parts[1], out int compQty))</div>
<div class="line">⋮----</div>
<div class="line">components.Add(new Model_VolvoPartComponent</div>
<div class="line">⋮----</div>
<div class="line">ComponentPartNumber = parts[0].Trim(),</div>
<div class="line">⋮----</div>
<div class="line">var existing = await _daoPart.GetByIdAsync(partNumber);</div>
<div class="line">⋮----</div>
<div class="line">Model_Dao_Result saveResult;</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Line {i + 1}: {saveResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errors.Add($&quot;Line {i + 1}: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(summary);</div>
<div class="line">⋮----</div>
<div class="line">summary += &quot;\nErrors:\n&quot; + string.Join(&quot;\n&quot;, errors);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success((newCount, updatedCount, errorCount));</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error importing CSV: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;string&gt;&gt; ExportCsvAsync(string csvFilePath, bool includeInactive = false)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Exporting parts to CSV (includeInactive={includeInactive})&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var csv = new StringBuilder();</div>
<div class="line">csv.AppendLine(&quot;PartNumber,QuantityPerSkid,Components&quot;);</div>
<div class="line">⋮----</div>
<div class="line">componentsStr = string.Join(&quot;;&quot;, componentsResult.Data.Select(c =&gt; $&quot;{c.ComponentPartNumber}:{c.Quantity}&quot;));</div>
<div class="line">⋮----</div>
<div class="line">csv.AppendLine($&quot;{EscapeCsvField(part.PartNumber ?? string.Empty)},{part.QuantityPerSkid},{EscapeCsvField(componentsStr)}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Export complete: {partsResult.Data?.Count ?? 0} parts&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Success(csv.ToString());</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error exporting CSV: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> string[] ParseCsvLine(string line)</div>
<div class="line">⋮----</div>
<div class="line">var currentField = new StringBuilder();</div>
<div class="line">⋮----</div>
<div class="line">fields.Add(currentField.ToString());</div>
<div class="line">currentField.Clear();</div>
<div class="line">⋮----</div>
<div class="line">currentField.Append(c);</div>
<div class="line">⋮----</div>
<div class="line">return fields.ToArray();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> string EscapeCsvField(string field)</div>
<div class="line">⋮----</div>
<div class="line">if (field.Contains(&quot;,&quot;) || field.Contains(&quot;\&quot;&quot;) || field.Contains(&quot;\n&quot;))</div>
<div class="line">⋮----</div>
<div class="line">return &quot;\&quot;&quot; + field.Replace(&quot;\&quot;&quot;, &quot;\&quot;\&quot;&quot;) + &quot;\&quot;&quot;;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md497"></a>
File: Module_Volvo/ViewModels/ViewModel_Volvo_History.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Volvo_History : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Volvo _volvoService;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTimeOffset? _startDate = DateTimeOffset.Now.AddDays(-30);</div>
<div class="line">⋮----</div>
<div class="line">_volvoService = volvoService ?? throw new ArgumentNullException(nameof(volvoService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void GoBack()</div>
<div class="line">⋮----</div>
<div class="line">var contentFrame = mainWindow.GetContentFrame();</div>
<div class="line">⋮----</div>
<div class="line">contentFrame.GoBack();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task FilterAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _volvoService.GetHistoryAsync(</div>
<div class="line">StartDate?.DateTime ?? DateTime.Now.AddDays(-30),</div>
<div class="line">⋮----</div>
<div class="line">History.Clear();</div>
<div class="line">⋮----</div>
<div class="line">History.Add(shipment);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private async Task ViewDetailAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Loading details for shipment ID: {SelectedShipment.Id}&quot;);</div>
<div class="line">var result = await _volvoService.GetShipmentLinesAsync(SelectedShipment.Id);</div>
<div class="line">⋮----</div>
<div class="line">details.AppendLine($&quot;Shipment #{SelectedShipment.ShipmentNumber}&quot;);</div>
<div class="line">details.AppendLine($&quot;Date: {SelectedShipment.ShipmentDate:d}&quot;);</div>
<div class="line">details.AppendLine($&quot;PO Number: {SelectedShipment.PONumber ?? &quot;N/A&quot;}&quot;);</div>
<div class="line">details.AppendLine($&quot;Receiver: {SelectedShipment.ReceiverNumber ?? &quot;N/A&quot;}&quot;);</div>
<div class="line">details.AppendLine($&quot;Status: {SelectedShipment.Status}&quot;);</div>
<div class="line">details.AppendLine();</div>
<div class="line">details.AppendLine($&quot;Parts ({result.Data.Count}):&quot;);</div>
<div class="line">⋮----</div>
<div class="line">details.AppendLine($&quot;  • {line.PartNumber}: {line.ReceivedSkidCount} skids ({line.CalculatedPieceCount} pieces)&quot;);</div>
<div class="line">⋮----</div>
<div class="line">details.AppendLine($&quot;    ⚠ Discrepancy: Expected {line.ExpectedSkidCount} skids&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (!string.IsNullOrWhiteSpace(SelectedShipment.Notes))</div>
<div class="line">⋮----</div>
<div class="line">details.AppendLine($&quot;Notes: {SelectedShipment.Notes}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">Content = new ScrollViewer</div>
<div class="line">⋮----</div>
<div class="line">Content = new TextBlock</div>
<div class="line">⋮----</div>
<div class="line">Text = details.ToString(),</div>
<div class="line">⋮----</div>
<div class="line">await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Successfully loaded {result.Data.Count} lines&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private bool CanViewDetail() =&gt; SelectedShipment != null &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line">private async Task EditAsync()</div>
<div class="line">⋮----</div>
<div class="line">var linesResult = await _volvoService.GetShipmentLinesAsync(SelectedShipment.Id);</div>
<div class="line">⋮----</div>
<div class="line">dialog.LoadShipment(SelectedShipment, linesCollection, availableParts);</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var updatedShipment = dialog.GetUpdatedShipment();</div>
<div class="line">var updatedLines = dialog.GetUpdatedLines();</div>
<div class="line">var updateResult = await _volvoService.UpdateShipmentAsync(</div>
<div class="line">⋮----</div>
<div class="line">private bool CanEdit() =&gt; SelectedShipment != null &amp;&amp; !IsBusy;</div>
<div class="line">⋮----</div>
<div class="line">private async Task ExportAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await _volvoService.ExportHistoryToCsvAsync(</div>
<div class="line">⋮----</div>
<div class="line">if (result.IsSuccess &amp;&amp; !string.IsNullOrEmpty(result.Data))</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedShipmentChanged(Model_VolvoShipment? value)</div>
<div class="line">⋮----</div>
<div class="line">ViewDetailCommand.NotifyCanExecuteChanged();</div>
<div class="line">EditCommand.NotifyCanExecuteChanged();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md498"></a>
File: Module_Volvo/Views/VolvoShipmentEditDialog.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">ContentDialog</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Volvo.Views.VolvoShipmentEditDialog&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Volvo.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;Edit Shipment&quot;</span></div>
<div class="line">    <span class="keyword">PrimaryButtonText</span>=<span class="stringliteral">&quot;Save Changes&quot;</span></div>
<div class="line">    <span class="keyword">CloseButtonText</span>=<span class="stringliteral">&quot;Cancel&quot;</span></div>
<div class="line">    <span class="keyword">DefaultButton</span>=<span class="stringliteral">&quot;Primary&quot;</span>&gt;</div>
<div class="line">    </div>
<div class="line">    &lt;<span class="keywordtype">ContentDialog.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">x:Double</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;ContentDialogMaxWidth&quot;</span>&gt;1200&lt;/<span class="keywordtype">x:Double</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">x:Double</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;ContentDialogMinWidth&quot;</span>&gt;1200&lt;/<span class="keywordtype">x:Double</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:NullableDoubleToDoubleConverter</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;NullableDoubleToDoubleConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">ContentDialog.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">MaxHeight</span>=<span class="stringliteral">&quot;600&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span>&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- Shipment Header --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Shipment Details&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Shipment Date --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">CalendarDatePicker</span></div>
<div class="line">                        <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                        <span class="keyword">Header</span>=<span class="stringliteral">&quot;Shipment Date&quot;</span></div>
<div class="line">                        <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ShipmentDatePicker&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Shipment Number (Read-only) --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">                        <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">Header</span>=<span class="stringliteral">&quot;Shipment Number&quot;</span></div>
<div class="line">                        <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ShipmentNumberBox&quot;</span></div>
<div class="line">                        <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- PO Number --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">                        <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                        <span class="keyword">Header</span>=<span class="stringliteral">&quot;PO Number&quot;</span></div>
<div class="line">                        <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Optional&quot;</span></div>
<div class="line">                        <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PONumberBox&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Receiver Number --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">                        <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                        <span class="keyword">Header</span>=<span class="stringliteral">&quot;Receiver Number&quot;</span></div>
<div class="line">                        <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Optional&quot;</span></div>
<div class="line">                        <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ReceiverNumberBox&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Notes --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">                        <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Grid.ColumnSpan</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                        <span class="keyword">Header</span>=<span class="stringliteral">&quot;Notes&quot;</span></div>
<div class="line">                        <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Optional notes&quot;</span></div>
<div class="line">                        <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NotesBox&quot;</span></div>
<div class="line">                        <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span></div>
<div class="line">                        <span class="keyword">AcceptsReturn</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                        <span class="keyword">Height</span>=<span class="stringliteral">&quot;80&quot;</span></div>
<div class="line">                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- Parts DataGrid --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Parts&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;AddPartButton&quot;</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Add Part&quot;</span> <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;32&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;RemovePartButton&quot;</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Remove Part&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;32&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                </div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGrid</span></div>
<div class="line">                    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PartsDataGrid&quot;</span></div>
<div class="line">                    <span class="keyword">Height</span>=<span class="stringliteral">&quot;300&quot;</span></div>
<div class="line">                    <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">CanUserReorderColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                    <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                    <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;All&quot;</span></div>
<div class="line">                    <span class="keyword">HorizontalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                        <span class="comment">&lt;!-- Part Number --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span></div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part Number&quot;</span></div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartNumber}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Received Skids --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Received Skids&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_VolvoShipmentLine&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">NumberBox</span></div>
<div class="line">                                        <span class="keyword">Value</span>=<span class="stringliteral">&quot;{x:Bind ReceivedSkidCount, Mode=TwoWay}&quot;</span></div>
<div class="line">                                        <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                        <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Compact&quot;</span></div>
<div class="line">                                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Calculated Pieces (Read-only) --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span></div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Calculated Pieces&quot;</span></div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CalculatedPieceCount}&quot;</span></div>
<div class="line">                            <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Has Discrepancy --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridCheckBoxColumn</span></div>
<div class="line">                            <span class="keyword">Header</span>=<span class="stringliteral">&quot;Discrepancy?&quot;</span></div>
<div class="line">                            <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding HasDiscrepancy, Mode=TwoWay}&quot;</span></div>
<div class="line">                            <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Expected Skids --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Expected Skids&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_VolvoShipmentLine&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">NumberBox</span></div>
<div class="line">                                        <span class="keyword">Value</span>=<span class="stringliteral">&quot;{Binding ExpectedSkidCount, Mode=TwoWay, Converter={StaticResource NullableDoubleToDoubleConverter}}&quot;</span></div>
<div class="line">                                        <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                        <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Compact&quot;</span></div>
<div class="line">                                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                                        <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind HasDiscrepancy, Mode=OneWay}&quot;</span> /&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Expected Pieces Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Expected Pieces&quot;</span></div>
<div class="line">                                                      <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span></div>
<div class="line">                                                      <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding ExpectedPieceCount, Mode=OneWay}&quot;</span></div>
<div class="line">                                                      <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Difference Column --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Difference&quot;</span></div>
<div class="line">                                                      <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span></div>
<div class="line">                                                      <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PieceDifference, Mode=OneWay}&quot;</span></div>
<div class="line">                                                      <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">&lt;!-- Discrepancy Note --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Discrepancy Note&quot;</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span> <span class="keyword">MinWidth</span>=<span class="stringliteral">&quot;200&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_VolvoShipmentLine&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBox</span></div>
<div class="line">                                        <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind DiscrepancyNote, Mode=TwoWay}&quot;</span></div>
<div class="line">                                        <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind HasDiscrepancy, Mode=OneWay}&quot;</span></div>
<div class="line">                                        <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter note&quot;</span></div>
<div class="line">                                        <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span> /&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            </div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">ContentDialog</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md499"></a>
File: Module_Routing/Data/Dao_InforVisualPO.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_InforVisualPO</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; ValidatePOAsync(<span class="keywordtype">string</span> poNumber)</div>
<div class="line">⋮----</div>
<div class="line">Console.WriteLine($<span class="stringliteral">&quot;[DAO] Validating PO: {poNumber}&quot;</span>);</div>
<div class="line">await <span class="keyword">using</span> (var connection = <span class="keyword">new</span> SqlConnection(_connectionString))</div>
<div class="line">⋮----</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using</span> (var command = <span class="keyword">new</span> SqlCommand(query, connection))</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@PoNumber&quot;</span>, poNumber);</div>
<div class="line">var count = (int)(await command.ExecuteScalarAsync() ?? 0);</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(count &gt; 0);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;List&lt;Model_InforVisualPOLine&gt;&gt;&gt; GetLinesAsync(<span class="keywordtype">string</span> poNumber)</div>
<div class="line">⋮----</div>
<div class="line">Console.WriteLine($<span class="stringliteral">&quot;[DAO] Fetching lines for PO: {poNumber}&quot;</span>);</div>
<div class="line">await <span class="keyword">using </span>var connection = <span class="keyword">new</span> SqlConnection(_connectionString);</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using </span>var command = <span class="keyword">new</span> SqlCommand(query, connection);</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using </span>var reader = await command.ExecuteReaderAsync();</div>
<div class="line"><span class="keywordflow">while</span> (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">lines.Add(MapFromReader(reader));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(lines);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Model_InforVisualPOLine&gt;&gt; GetLineAsync(<span class="keywordtype">string</span> poNumber, <span class="keywordtype">int</span> lineNumber)</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@LineNumber&quot;</span>, lineNumber);</div>
<div class="line">await <span class="keyword">using</span> (var reader = await command.ExecuteReaderAsync())</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> Model_Dao_Result_Factory.Success(line);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;bool&gt;&gt; CheckConnectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(true);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(false);</div>
<div class="line">⋮----</div>
<div class="line">private Model_InforVisualPOLine MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_InforVisualPOLine</div>
<div class="line">⋮----</div>
<div class="line">PONumber = reader[<span class="stringliteral">&quot;PO_ID&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">LineNumber = reader[<span class="stringliteral">&quot;PO_LINE&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">PartID = reader[<span class="stringliteral">&quot;PART_ID&quot;</span>].ToString() ?? <span class="keywordtype">string</span>.Empty,</div>
<div class="line">Description = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;PART_NAME&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;PART_NAME&quot;</span>)),</div>
<div class="line">Specifications = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;SPECS&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;SPECS&quot;</span>)),</div>
<div class="line">QuantityOrdered = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;QTY_ORDERED&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetDecimal(reader.GetOrdinal(<span class="stringliteral">&quot;QTY_ORDERED&quot;</span>)),</div>
<div class="line">QuantityReceived = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;QTY_RECEIVED&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetDecimal(reader.GetOrdinal(<span class="stringliteral">&quot;QTY_RECEIVED&quot;</span>)),</div>
<div class="line">WorkOrder = HasColumn(reader, <span class="stringliteral">&quot;WORK_ORDER_ID&quot;</span>) &amp;&amp; !reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;WORK_ORDER_ID&quot;</span>))</div>
<div class="line">? reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;WORK_ORDER_ID&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">CustomerOrder = HasColumn(reader, <span class="stringliteral">&quot;CUST_ORDER_ID&quot;</span>) &amp;&amp; !reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;CUST_ORDER_ID&quot;</span>))</div>
<div class="line">? reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;CUST_ORDER_ID&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">private <span class="keywordtype">bool</span> HasColumn(IDataReader reader, <span class="keywordtype">string</span> columnName)</div>
<div class="line">⋮----</div>
<div class="line">if (reader.GetName(i).Equals(columnName, StringComparison.InvariantCultureIgnoreCase))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md500"></a>
File: Module_Routing/Services/RoutingService.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>RoutingService : IRoutingService</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_RoutingLabel _daoLabel;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_RoutingLabelHistory _daoHistory;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingInforVisualService _inforVisualService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingUsageTrackingService _usageTrackingService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingRecipientService _recipientService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IConfiguration _configuration;</div>
<div class="line"><span class="keyword">private</span> static readonly SemaphoreSlim _csvFileLock = new SemaphoreSlim(1, 1);</div>
<div class="line">⋮----</div>
<div class="line">_daoLabel = daoLabel ?? throw new ArgumentNullException(nameof(daoLabel));</div>
<div class="line">_daoHistory = daoHistory ?? throw new ArgumentNullException(nameof(daoHistory));</div>
<div class="line">_inforVisualService = inforVisualService ?? throw new ArgumentNullException(nameof(inforVisualService));</div>
<div class="line">_usageTrackingService = usageTrackingService ?? throw new ArgumentNullException(nameof(usageTrackingService));</div>
<div class="line">_recipientService = recipientService ?? throw new ArgumentNullException(nameof(recipientService));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">_configuration = configuration ?? throw new ArgumentNullException(nameof(configuration));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; CreateLabelAsync(Model_RoutingLabel label)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Creating routing label for PO {label.PONumber}, Recipient {label.RecipientId}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var insertResult = await _daoLabel.InsertLabelAsync(label);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error creating label: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task&lt;Model_Dao_Result&gt; ValidateAndCheckDuplicatesAsync(Model_RoutingLabel label)</div>
<div class="line">⋮----</div>
<div class="line">var recipientValidation = await _recipientService.ValidateRecipientExistsAsync(label.RecipientId);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Invalid recipient ID: {label.RecipientId}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success();</div>
<div class="line">⋮----</div>
<div class="line">private void ExecuteBackgroundTasks(Model_RoutingLabel label, int labelId)</div>
<div class="line">⋮----</div>
<div class="line">_ = Task.Run(async () =&gt;</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;CSV export failed for label {labelId}: {csvResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var usageResult = await _usageTrackingService.IncrementUsageCountAsync(</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Usage tracking failed for label {labelId}: {usageResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Background task error for label {labelId}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateLabelAsync(Model_RoutingLabel label, int editedByEmployeeNumber)</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Updating label {label.Id} by employee {editedByEmployeeNumber}&quot;);</div>
<div class="line">var originalResult = await _daoLabel.GetLabelByIdAsync(label.Id);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Original label not found: {originalResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var updateResult = await _daoLabel.UpdateLabelAsync(label);</div>
<div class="line">⋮----</div>
<div class="line">historyEntries.Add(new Model_RoutingLabelHistory</div>
<div class="line">⋮----</div>
<div class="line">var historyResult = await _daoHistory.InsertHistoryBatchAsync(historyEntries);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Failed to log history: {historyResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(&quot;Label updated successfully&quot;, 1);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error updating label: {ex.Message}&quot;, ex);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error updating label: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_RoutingLabel&gt;&gt; GetLabelByIdAsync(int labelId)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoLabel.GetLabelByIdAsync(labelId);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error getting label {labelId}: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_RoutingLabel&gt;&gt;&gt; GetAllLabelsAsync(int limit = 100, int offset = 0)</div>
<div class="line">⋮----</div>
<div class="line">return await _daoLabel.GetAllLabelsAsync(limit, offset);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error retrieving labels: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;(bool Exists, int? ExistingLabelId)&gt;&gt; CheckDuplicateLabelAsync(</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoLabel.CheckDuplicateAsync(poNumber, lineNumber, recipientId, createdDate);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error checking duplicate: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; ExportLabelToCsvAsync(Model_RoutingLabel label)</div>
<div class="line">⋮----</div>
<div class="line">var validatedNetworkPath = string.IsNullOrEmpty(networkPath) ? string.Empty : ValidateCsvPath(networkPath);</div>
<div class="line">var validatedLocalPath = string.IsNullOrEmpty(localPath) ? string.Empty : ValidateCsvPath(localPath);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Network CSV export failed, using local path: {validatedLocalPath}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _daoLabel.MarkExportedAsync(new List&lt;int&gt; { label.Id });</div>
<div class="line">return Model_Dao_Result_Factory.Success(</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;CSV export failed (both network and local paths)&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error exporting to CSV: {ex.Message}&quot;, ex);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;CSV export error: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; RegenerateLabelCsvAsync(int labelId)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Label not found: {labelResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error regenerating CSV: {ex.Message}&quot;, ex);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error regenerating CSV: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; ResetCsvFileAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (File.Exists(networkPath))</div>
<div class="line">⋮----</div>
<div class="line">File.Delete(networkPath);</div>
<div class="line">⋮----</div>
<div class="line">if (File.Exists(localPath))</div>
<div class="line">⋮----</div>
<div class="line">File.Delete(localPath);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;CSV files reset (network: {networkDeleted}, local: {localDeleted})&quot;);</div>
<div class="line">return Model_Dao_Result_Factory.Success(&quot;CSV files reset successfully&quot;, 1);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error resetting CSV: {ex.Message}&quot;, ex);</div>
<div class="line">return Model_Dao_Result_Factory.Failure($&quot;Error resetting CSV: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public Model_Dao_Result ValidateLabel(Model_RoutingLabel label)</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Label cannot be null&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(label.PONumber))</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;PO Number is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;PO Number cannot exceed 50 characters&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(label.LineNumber))</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Line Number is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Line Number cannot exceed 20 characters&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Description cannot exceed 255 characters&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Quantity must be greater than zero&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Recipient must be selected&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;Employee Number is required&quot;);</div>
<div class="line">⋮----</div>
<div class="line">if (label.PONumber.Equals(&quot;OTHER&quot;, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;OTHER reason must be selected when PO is OTHER&quot;);</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Success(&quot;Validation passed&quot;, 1);</div>
<div class="line">⋮----</div>
<div class="line">private string ValidateCsvPath(string path)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(path))</div>
<div class="line">⋮----</div>
<div class="line">throw new ArgumentException(&quot;CSV path cannot be empty&quot;, nameof(path));</div>
<div class="line">⋮----</div>
<div class="line">var fullPath = Path.GetFullPath(path);</div>
<div class="line">if (path.Contains(&quot;..&quot;) || path.Contains(&quot;~&quot;))</div>
<div class="line">⋮----</div>
<div class="line">private string FormatCsvLine(Model_RoutingLabel label)</div>
<div class="line">⋮----</div>
<div class="line">private async Task&lt;bool&gt; TryWriteCsvAsync(string filePath, string csvLine, int retryCount, int retryDelayMs)</div>
<div class="line">⋮----</div>
<div class="line">await _csvFileLock.WaitAsync();</div>
<div class="line">⋮----</div>
<div class="line">var directory = Path.GetDirectoryName(filePath);</div>
<div class="line">if (!string.IsNullOrEmpty(directory) &amp;&amp; !Directory.Exists(directory))</div>
<div class="line">⋮----</div>
<div class="line">Directory.CreateDirectory(directory);</div>
<div class="line">⋮----</div>
<div class="line">await File.AppendAllTextAsync(filePath, csvLine + Environment.NewLine);</div>
<div class="line">⋮----</div>
<div class="line">_csvFileLock.Release();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;CSV write attempt {attempt}/{retryCount} failed: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await Task.Delay(retryDelayMs);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Unexpected CSV write error: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private List&lt;(string FieldName, string OldValue, string NewValue)&gt; GetLabelChanges(</div>
<div class="line">⋮----</div>
<div class="line">changes.Add((&quot;PONumber&quot;, original.PONumber, updated.PONumber));</div>
<div class="line">⋮----</div>
<div class="line">changes.Add((&quot;LineNumber&quot;, original.LineNumber, updated.LineNumber));</div>
<div class="line">⋮----</div>
<div class="line">changes.Add((&quot;Description&quot;, original.Description ?? &quot;&quot;, updated.Description ?? &quot;&quot;));</div>
<div class="line">⋮----</div>
<div class="line">changes.Add((&quot;Quantity&quot;, original.Quantity.ToString(), updated.Quantity.ToString()));</div>
<div class="line">⋮----</div>
<div class="line">changes.Add((&quot;RecipientId&quot;, original.RecipientId.ToString(), updated.RecipientId.ToString()));</div>
<div class="line">⋮----</div>
<div class="line">changes.Add((&quot;OtherReasonId&quot;,</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md501"></a>
File: Module_Routing/ViewModels/RoutingWizardContainerViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>RoutingWizardContainerViewModel : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingService _routingService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingInforVisualService _inforVisualService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingUsageTrackingService _usageTrackingService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NavigateToStep2()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;NavigateToStep2 called - CurrentStep: {CurrentStep}, SelectedPOLine: {SelectedPOLine?.PartID ?? &quot;null&quot;}, SelectedOtherReason: {SelectedOtherReason?.Description ?? &quot;null&quot;}&quot;);</div>
<div class="line"><span class="comment">// Validation: Must have either PO line or OTHER reason</span></div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;NavigateToStep2: No PO line or OTHER reason selected&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Set FinalQuantity from PO line: {FinalQuantity}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Set FinalQuantity from OTHER: {FinalQuantity}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Changing CurrentStep from {CurrentStep} to 2&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;CurrentStep is now: {CurrentStep}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NavigateToStep3()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;NavigateToStep3 called - SelectedRecipient: {SelectedRecipient?.Name ?? &quot;null&quot;}&quot;);</div>
<div class="line"><span class="comment">// Validation: Must have recipient</span></div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;NavigateToStep3: No recipient selected&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Navigating to Step 3 - Recipient: {SelectedRecipient.Name}, CurrentStep changing from {CurrentStep} to 3&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Calling Step3ViewModel.LoadReviewData()&quot;);</div>
<div class="line">_step3ViewModel.LoadReviewData();</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;Step3ViewModel not yet initialized&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void RegisterStep3ViewModel(RoutingWizardStep3ViewModel step3ViewModel)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Step3ViewModel registered with Container&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NavigateToStep1()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NavigateToStep1ForEdit()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;NavigateToStep1ForEdit called - Setting edit mode&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NavigateBackToStep2()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NavigateToStep2ForEdit()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;NavigateToStep2ForEdit called - Setting edit mode&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task CreateLabelAsync()</div>
<div class="line">⋮----</div>
<div class="line">var label = new Model_RoutingLabel</div>
<div class="line">⋮----</div>
<div class="line">LineNumber = SelectedPOLine?.LineNumber.ToString() ?? &quot;0&quot;,</div>
<div class="line">⋮----</div>
<div class="line">var result = await _routingService.CreateLabelAsync(label);</div>
<div class="line">⋮----</div>
<div class="line">await _usageTrackingService.IncrementUsageCountAsync(</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private async Task CancelAsync()</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">private void ResetWizard()</div>
<div class="line">⋮----</div>
<div class="line">private int GetCurrentEmployeeNumber()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md502"></a>
File: Module_Routing/Views/RoutingWizardStep1View.xaml</h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Routing.Views.RoutingWizardStep1View&quot;</span></div>
<div class="line">    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;RootPage&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:vm</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.ViewModels&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Routing.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:coreConverters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">coreConverters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">coreConverters:Converter_IntToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;IntToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                   <span class="keyword">Text</span>=<span class="stringliteral">&quot;Step 1: PO and Line Selection&quot;</span> </div>
<div class="line">                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span></div>
<div class="line">                   <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- PO Input Section (visible when NOT in OTHER mode) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsOtherMode, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Label --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8A5;&quot;</span> </div>
<div class="line">                                <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;PO Number:&quot;</span> </div>
<div class="line">                                <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span></div>
<div class="line">                                <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                </div>
<div class="line">                <span class="comment">&lt;!-- Input --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                            <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoNumber, Mode=TwoWay}&quot;</span></div>
<div class="line">                            <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter PO number&quot;</span></div>
<div class="line">                            <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Actions --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ValidatePOCommand}&quot;</span></div>
<div class="line">                            <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE896;&quot;</span> <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Validate&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Button</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Other (Non-PO)&quot;</span></div>
<div class="line">                            <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SwitchToOtherModeCommand}&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- OTHER Mode Section (visible when in OTHER mode) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                <span class="keyword">Padding</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsOtherMode, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;OTHER Package (Non-PO)&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B4;&quot;</span> </div>
<div class="line">                                 <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                 <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Reason&quot;</span> </div>
<div class="line">                                  <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">ComboBox</span> <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Select reason&quot;</span></div>
<div class="line">                              <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.OtherReasons, Mode=OneWay}&quot;</span></div>
<div class="line">                              <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedOtherReason, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">DisplayMemberPath</span>=<span class="stringliteral">&quot;Description&quot;</span></div>
<div class="line">                              <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                              <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;400&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE9F9;&quot;</span> </div>
<div class="line">                                 <span class="keyword">FontSize</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                                 <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource AccentTextFillColorPrimaryBrush}&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Quantity&quot;</span> </div>
<div class="line">                                  <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                               <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                               <span class="keyword">Value</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.OtherQuantity, Mode=TwoWay}&quot;</span></div>
<div class="line">                               <span class="keyword">MaxWidth</span>=<span class="stringliteral">&quot;200&quot;</span></div>
<div class="line">                               <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Left&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- PO Lines DataGrid + Specs (visible when NOT in OTHER mode) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">              <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsOtherMode, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;3*&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Lines List --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Select a line from the PO&quot;</span></div>
<div class="line">                               <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                               <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                               <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span></div>
<div class="line">                               <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoLines.Count, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=Inverse}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">ListView</span> <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoLines, Mode=OneWay}&quot;</span></div>
<div class="line">                              <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPOLine, Mode=TwoWay}&quot;</span></div>
<div class="line">                              <span class="keyword">SelectionMode</span>=<span class="stringliteral">&quot;Single&quot;</span></div>
<div class="line">                              <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PoLines.Count, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ListView.HeaderTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;0&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;50&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;{Binding ViewModel.ReferenceColumnWidth, ElementName=RootPage}&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;{Binding ViewModel.SpecsColumnWidth, ElementName=RootPage}&quot;</span>/&gt;</div>
<div class="line">                                        &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Line&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Description&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Ref (CO/WO)&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Specs (Preview)&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;5&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Qty&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">ListView.HeaderTemplate</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_InforVisualPOLine&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;0&quot;</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                         &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;50&quot;</span>/&gt;</div>
<div class="line">                                         &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span>/&gt;</div>
<div class="line">                                         &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>/&gt;</div>
<div class="line">                                         &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;{Binding ViewModel.ReferenceColumnWidth, ElementName=RootPage}&quot;</span>/&gt;</div>
<div class="line">                                         &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;{Binding ViewModel.SpecsColumnWidth, ElementName=RootPage}&quot;</span>/&gt;</div>
<div class="line">                                         &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;80&quot;</span>/&gt;</div>
<div class="line">                                    &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind LineNumber}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind PartID}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind Description}&quot;</span> <span class="keyword">TextTrimming</span>=<span class="stringliteral">&quot;CharacterEllipsis&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ReferenceInfo}&quot;</span> <span class="keyword">TextTrimming</span>=<span class="stringliteral">&quot;CharacterEllipsis&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind SpecificationsPreview}&quot;</span> <span class="keyword">TextTrimming</span>=<span class="stringliteral">&quot;CharacterEllipsis&quot;</span> <span class="keyword">Foreground</span>=<span class="stringliteral">&quot;{ThemeResource TextFillColorSecondaryBrush}&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,12,0&quot;</span>/&gt;</div>
<div class="line">                                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;5&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind QuantityOrderedDisplay}&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span>/&gt;</div>
<div class="line">                                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">ListView.ItemTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">ListView</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Specs Detail Panel --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                    <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource CardBackgroundFillColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderBrush</span>=<span class="stringliteral">&quot;{ThemeResource CardStrokeColorDefaultBrush}&quot;</span></div>
<div class="line">                    <span class="keyword">BorderThickness</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                    <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;8&quot;</span></div>
<div class="line">                    <span class="keyword">Padding</span>=<span class="stringliteral">&quot;16&quot;</span></div>
<div class="line">                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsLineSelected, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">&lt;!-- Title --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                               <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPOLineTitle, Mode=OneWay}&quot;</span> </div>
<div class="line">                               <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                               <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                               <span class="keyword">TextAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">&lt;!-- Fields --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                        <span class="comment">&lt;!-- Part ID --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Part ID:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,8,0&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPOLine.PartID, Mode=OneWay}&quot;</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Description --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Desc:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,8,0&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPOLine.Description, Mode=OneWay}&quot;</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- Quantity --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Qty:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,8,0&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPOLine.QuantityOrderedDisplay, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">&lt;!-- WO/CO (Hide if empty) --&gt;</span></div>
<div class="line">                        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HasReferenceInfo, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>&gt;</div>
<div class="line">                             &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;Ref:&quot;</span> <span class="keyword">FontWeight</span>=<span class="stringliteral">&quot;SemiBold&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,8,0&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPOLine.ReferenceInfo, Mode=OneWay}&quot;</span> <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">&lt;!-- Specs --&gt;</span></div>
<div class="line">                    &lt;<span class="keywordtype">Border</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">Background</span>=<span class="stringliteral">&quot;{ThemeResource LayerFillColorDefaultBrush}&quot;</span> <span class="keyword">CornerRadius</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                         &lt;<span class="keywordtype">ScrollViewer</span> <span class="keyword">VerticalScrollBarVisibility</span>=<span class="stringliteral">&quot;Auto&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPOLine.Specifications, Mode=OneWay}&quot;</span> </div>
<div class="line">                                       <span class="keyword">TextWrapping</span>=<span class="stringliteral">&quot;Wrap&quot;</span> </div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{ThemeResource BodyTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">ScrollViewer</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Border</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">ProgressRing</span> <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span></div>
<div class="line">                          <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                       <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Right&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Button</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NavigationButtonText, Mode=OneWay}&quot;</span></div>
<div class="line">                    <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ProceedToStep2Command}&quot;</span></div>
<div class="line">                    <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md503"></a>
File: Module_Volvo/Data/Dao_VolvoShipment.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_VolvoShipment</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;(<span class="keywordtype">int</span> ShipmentId, <span class="keywordtype">int</span> ShipmentNumber)&gt;&gt; InsertAsync(Model_VolvoShipment shipment)</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using </span>var connection = <span class="keyword">new</span> MySqlConnection(_connectionString);</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">await <span class="keyword">using </span>var command = <span class="keyword">new</span> MySqlCommand(<span class="stringliteral">&quot;sp_volvo_shipment_insert&quot;</span>, connection)</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_shipment_date&quot;</span>, shipment.ShipmentDate);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_employee_number&quot;</span>, shipment.EmployeeNumber);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_notes&quot;</span>, shipment.Notes ?? (<span class="keywordtype">object</span>)DBNull.Value);</div>
<div class="line">var newIdParam = <span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_new_id&quot;</span>, MySqlDbType.Int32)</div>
<div class="line">⋮----</div>
<div class="line">var shipmentNumberParam = new MySqlParameter(<span class="stringliteral">&quot;@p_shipment_number&quot;</span>, MySqlDbType.Int32)</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.Add(newIdParam);</div>
<div class="line">command.Parameters.Add(shipmentNumberParam);</div>
<div class="line">await command.ExecuteNonQueryAsync();</div>
<div class="line">var shipmentId = Convert.ToInt32(newIdParam.Value);</div>
<div class="line">var shipmentNumber = Convert.ToInt32(shipmentNumberParam.Value);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; UpdateAsync(Model_VolvoShipment shipment)</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">return new Model_Dao_Result</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; CompleteAsync(<span class="keywordtype">int</span> shipmentId, <span class="keywordtype">string</span> poNumber, <span class="keywordtype">string</span> receiverNumber)</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; DeleteAsync(<span class="keywordtype">int</span> shipmentId)</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_VolvoShipment&gt;&gt; GetPendingAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;Model_VolvoShipment?&gt;&gt; GetByIdAsync(<span class="keywordtype">int</span> shipmentId)</div>
<div class="line">⋮----</div>
<div class="line">await using var command = new MySqlCommand</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_id&quot;</span>, shipmentId);</div>
<div class="line">await using var reader = await command.ExecuteReaderAsync();</div>
<div class="line">if (await reader.ReadAsync())</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoShipment&gt;&gt;&gt; GetHistoryAsync(</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line">private static Model_VolvoShipment MapFromReader(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_VolvoShipment</div>
<div class="line">⋮----</div>
<div class="line">Id = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;id&quot;</span>)),</div>
<div class="line">ShipmentDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;shipment_date&quot;</span>)),</div>
<div class="line">ShipmentNumber = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;shipment_number&quot;</span>)),</div>
<div class="line">PONumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;po_number&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;po_number&quot;</span>)),</div>
<div class="line">ReceiverNumber = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;receiver_number&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;receiver_number&quot;</span>)),</div>
<div class="line">EmployeeNumber = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;employee_number&quot;</span>)),</div>
<div class="line">Notes = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;notes&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;notes&quot;</span>)),</div>
<div class="line">Status = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;status&quot;</span>)),</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>)),</div>
<div class="line">IsArchived = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_archived&quot;</span>))</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md504"></a>
File: Module_Volvo/Models/Model_VolvoShipmentLine.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>Model_VolvoShipmentLine : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line">partial void OnReceivedSkidCountChanged(int value)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnQuantityPerSkidChanged(int value)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnExpectedSkidCountChanged(double? value)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnHasDiscrepancyChanged(bool value)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md505"></a>
File: MainWindow.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Window</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.MainWindow&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:local</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;MainWindowRoot&quot;</span></div>
<div class="line">    <span class="keyword">Title</span>=<span class="stringliteral">&quot;MTM_Receiving_Application&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Window.SystemBackdrop</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">MicaBackdrop</span> /&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Window.SystemBackdrop</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        <span class="comment">&lt;!-- Custom Title Bar Area (when ExtendsContentIntoTitleBar = true) --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;AppTitleBar&quot;</span> </div>
<div class="line">              <span class="keyword">Height</span>=<span class="stringliteral">&quot;48&quot;</span> </div>
<div class="line">              <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Top&quot;</span> </div>
<div class="line">              <span class="keyword">Canvas.ZIndex</span>=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">&lt;!-- App Icon and Title --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;16,0,0,0&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Image</span> <span class="keyword">Source</span>=<span class="stringliteral">&quot;/Assets/app-icon.ico&quot;</span> </div>
<div class="line">                       <span class="keyword">Width</span>=<span class="stringliteral">&quot;16&quot;</span> </div>
<div class="line">                       <span class="keyword">Height</span>=<span class="stringliteral">&quot;16&quot;</span> </div>
<div class="line">                       <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;MTM Receiving Application&quot;</span> </div>
<div class="line">                           <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource CaptionTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        &lt;<span class="keywordtype">NavigationView</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;NavView&quot;</span></div>
<div class="line">                        <span class="keyword">PaneDisplayMode</span>=<span class="stringliteral">&quot;Left&quot;</span></div>
<div class="line">                        <span class="keyword">IsSettingsVisible</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                        <span class="keyword">SelectionChanged</span>=<span class="stringliteral">&quot;NavView_SelectionChanged&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">NavigationView.PaneHeader</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;MTM Receiving&quot;</span> </div>
<div class="line">                           <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span></div>
<div class="line">                           <span class="keyword">Margin</span>=<span class="stringliteral">&quot;12,0,0,0&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">NavigationView.PaneHeader</span>&gt;</div>
<div class="line">            </div>
<div class="line">            &lt;<span class="keywordtype">NavigationView.Header</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                        </div>
<div class="line">                        &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;PageTitleTextBlock&quot;</span></div>
<div class="line">                                   <span class="keyword">Text</span>=<span class="stringliteral">&quot;Dashboard&quot;</span> </div>
<div class="line">                                   <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource TitleTextBlockStyle}&quot;</span></div>
<div class="line">                                   <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                   <span class="keyword">Margin</span>=<span class="stringliteral">&quot;16,0&quot;</span>/&gt;</div>
<div class="line">                                   </div>
<div class="line">                        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span> </div>
<div class="line">                                    <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> </div>
<div class="line">                                    <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;12&quot;</span> </div>
<div class="line">                                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,24,0&quot;</span></div>
<div class="line">                                    <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">PersonPicture</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;UserPicture&quot;</span></div>
<div class="line">                                           <span class="keyword">Height</span>=<span class="stringliteral">&quot;32&quot;</span></div>
<div class="line">                                           <span class="keyword">Width</span>=<span class="stringliteral">&quot;32&quot;</span>/&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;UserDisplayTextBlock&quot;</span></div>
<div class="line">                                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;Not Logged In&quot;</span></div>
<div class="line">                                       <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource BodyStrongTextBlockStyle}&quot;</span>/&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NotificationService.IsStatusOpen, Mode=TwoWay}&quot;</span></div>
<div class="line">                             <span class="keyword">Severity</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.WinUIStatusSeverity, Mode=OneWay}&quot;</span></div>
<div class="line">                             <span class="keyword">Message</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.NotificationService.StatusMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                             <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;True&quot;</span></div>
<div class="line">                             <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                             <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span></div>
<div class="line">                             <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,20,0,20&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">NavigationView.Header</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">NavigationView.MenuItems</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">NavigationViewItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Receiving Labels&quot;</span> <span class="keyword">Tag</span>=<span class="stringliteral">&quot;ReceivingWorkflowView&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE74C;&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">NavigationViewItem</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">NavigationViewItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Dunnage Labels&quot;</span> <span class="keyword">Tag</span>=<span class="stringliteral">&quot;DunnageLabelPage&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7B8;&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">NavigationViewItem</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">NavigationViewItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;UPS / FedEx Labels&quot;</span> <span class="keyword">Tag</span>=<span class="stringliteral">&quot;RoutingLabelPage&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE724;&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">NavigationViewItem</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">NavigationViewItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;Volvo Dunnage Requisition&quot;</span> <span class="keyword">Tag</span>=<span class="stringliteral">&quot;VolvoShipmentEntry&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE7C1;&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">NavigationViewItem</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">NavigationViewItem</span> <span class="keyword">Content</span>=<span class="stringliteral">&quot;End of Day Reports&quot;</span> <span class="keyword">Tag</span>=<span class="stringliteral">&quot;ReportingMainPage&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE9F9;&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">NavigationViewItem</span>&gt;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">&lt;!-- Development Tools (visible in debug builds only) --&gt;</span></div>
<div class="line">                &lt;<span class="keywordtype">NavigationViewItem</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;DatabaseTestMenuItem&quot;</span> </div>
<div class="line">                                    <span class="keyword">Content</span>=<span class="stringliteral">&quot;Settings DB Test&quot;</span> </div>
<div class="line">                                    <span class="keyword">Tag</span>=<span class="stringliteral">&quot;DatabaseTestView&quot;</span> </div>
<div class="line">                                    <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span></div>
<div class="line">                                    <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8AB;&quot;</span> /&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">NavigationViewItem.Icon</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">NavigationViewItem</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;/<span class="keywordtype">NavigationView.MenuItems</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">Frame</span> <span class="keyword">x:Name</span>=<span class="stringliteral">&quot;ContentFrame&quot;</span> /&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">NavigationView</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Window</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md506"></a>
File: Module_Routing/ViewModels/RoutingWizardStep1ViewModel.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>RoutingWizardStep1ViewModel : ObservableObject</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingInforVisualService _inforVisualService;</div>
<div class="line"><span class="keyword">private</span> readonly IRoutingService _routingService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_ErrorHandler _errorHandler;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly RoutingWizardContainerViewModel _containerViewModel;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> bool HasReferenceInfo =&gt; SelectedPOLine != null &amp;&amp; !string.IsNullOrEmpty(SelectedPOLine.ReferenceInfo);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ValidatePOAsync()</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(PoNumber))</div>
<div class="line">⋮----</div>
<div class="line">var validationResult = await _inforVisualService.ValidatePoNumberAsync(PoNumber);</div>
<div class="line">⋮----</div>
<div class="line">var linesResult = await _inforVisualService.GetPoLinesAsync(PoNumber);</div>
<div class="line">⋮----</div>
<div class="line">PoLines.Clear();</div>
<div class="line">⋮----</div>
<div class="line">PoLines.Add(line);</div>
<div class="line">if (!string.IsNullOrEmpty(line.ReferenceInfo)) hasRefs = true;</div>
<div class="line">if (!string.IsNullOrEmpty(line.SpecificationsPreview)) hasSpecs = true;</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.ShowUserErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private async Task SwitchToOtherModeAsync()</div>
<div class="line">⋮----</div>
<div class="line">private void ProceedToStep2()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;ProceedToStep2 called - IsOtherMode: {IsOtherMode}, SelectedPOLine: {SelectedPOLine?.PartID ?? &quot;null&quot;}, SelectedOtherReason: {SelectedOtherReason?.Description ?? &quot;null&quot;}&quot;);</div>
<div class="line"><span class="comment">// Update container with selected data</span></div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Updated container with OTHER reason: {SelectedOtherReason.Description}, Quantity: {OtherQuantity}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;Updated container with PO Line: {SelectedPOLine.PartID}, PO: {SelectedPOLine.PONumber}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogWarning(&quot;ProceedToStep2: Neither PO line nor OTHER reason selected&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Returning to Step 3 (Review) after edit&quot;);</div>
<div class="line">_containerViewModel.NavigateToStep3Command.Execute(null);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Executing NavigateToStep2Command&quot;);</div>
<div class="line">_containerViewModel.NavigateToStep2Command.Execute(null);</div>
<div class="line">_logger.LogInfo(&quot;NavigateToStep2Command executed&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Error in ProceedToStep2: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private bool CanProceedToStep2()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;CanProceedToStep2: {canProceed} - IsOtherMode: {IsOtherMode}, SelectedPOLine: {SelectedPOLine?.PartID ?? &quot;null&quot;}, SelectedOtherReason: {SelectedOtherReason?.Description ?? &quot;null&quot;}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowPONotFoundDialogAsync()</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedPOLineChanged(Model_InforVisualPOLine? value)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;SelectedPOLine changed to: {value?.PartID ?? &quot;null&quot;} (PO: {value?.PONumber ?? &quot;null&quot;})&quot;);</div>
<div class="line">ProceedToStep2Command.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">partial void OnSelectedOtherReasonChanged(Model_RoutingOtherReason? value)</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;SelectedOtherReason changed to: {value?.Description ?? &quot;null&quot;}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">private async void InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;[MOCK DATA MODE] Auto-filling PO number: {defaultPO}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await Task.Delay(500);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error during initialization: {ex.Message}&quot;, ex);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md507"></a>
File: Module_Settings/ViewModels/ViewModel_Settings_DatabaseTest.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Settings_DatabaseTest : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_SystemSettings _daoSystemSettings;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_UserSettings _daoUserSettings;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_PackageType _daoPackageType;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_PackageTypeMappings _daoPackageTypeMappings;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_RoutingRule _daoRoutingRule;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_ScheduledReport _daoScheduledReport;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_SettingsAuditLog _daoSettingsAuditLog;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> DateTime _lastRunTime = DateTime.Now;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task RunAllTestsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var stopwatch = Stopwatch.StartNew();</div>
<div class="line">LogMessages.Clear();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Database test suite started&quot;, &quot;ViewModel_Settings_DatabaseTest&quot;);</div>
<div class="line">⋮----</div>
<div class="line">stopwatch.Stop();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Database tests completed successfully in {TotalTestDurationMs}ms&quot;, &quot;ViewModel_Settings_DatabaseTest&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Database test execution failed: {ex.Message}&quot;, ex, &quot;ViewModel_Settings_DatabaseTest&quot;);</div>
<div class="line">_errorHandler.HandleException(</div>
<div class="line">⋮----</div>
<div class="line">private async Task ExportResultsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var exportRoot = Path.Combine(</div>
<div class="line">Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData),</div>
<div class="line">⋮----</div>
<div class="line">Directory.CreateDirectory(exportRoot);</div>
<div class="line">var timestamp = DateTime.Now.ToString(&quot;yyyyMMdd_HHmmss&quot;);</div>
<div class="line">var jsonPath = Path.Combine(exportRoot, $&quot;SettingsDbTest_{timestamp}.json&quot;);</div>
<div class="line">var logPath = Path.Combine(exportRoot, $&quot;SettingsDbTest_{timestamp}.log.txt&quot;);</div>
<div class="line">var tablesCsvPath = Path.Combine(exportRoot, $&quot;SettingsDbTest_{timestamp}_tables.csv&quot;);</div>
<div class="line">var procsCsvPath = Path.Combine(exportRoot, $&quot;SettingsDbTest_{timestamp}_stored_procedures.csv&quot;);</div>
<div class="line">var daosCsvPath = Path.Combine(exportRoot, $&quot;SettingsDbTest_{timestamp}_daos.csv&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var needsQuotes = s.Contains(&#39;,&#39;) || s.Contains(&#39;&quot;&#39;) || s.Contains(&#39;\n&#39;) || s.Contains(&#39;\r&#39;);</div>
<div class="line">⋮----</div>
<div class="line">return &quot;\&quot;&quot; + s.Replace(&quot;\&quot;&quot;, &quot;\&quot;\&quot;&quot;) + &quot;\&quot;&quot;;</div>
<div class="line">⋮----</div>
<div class="line">.Select(t =&gt; new { t.TableName, t.IsValid, t.StatusText, t.Details })</div>
<div class="line">.ToList(),</div>
<div class="line">⋮----</div>
<div class="line">.Select(p =&gt; new { p.ProcedureName, p.IsValid, p.ExecutionTimeMs, p.TestDetails })</div>
<div class="line">⋮----</div>
<div class="line">.Select(d =&gt; new { d.DaoName, d.IsValid, d.StatusText, d.OperationsTested })</div>
<div class="line">⋮----</div>
<div class="line">.Select(a =&gt; <span class="keyword">new</span></div>
<div class="line">⋮----</div>
<div class="line">Logs = (LogMessages ?? <span class="keyword">new</span> ObservableCollection&lt;string&gt;()).ToList()</div>
<div class="line">⋮----</div>
<div class="line">var json = JsonSerializer.Serialize(report, <span class="keyword">new</span> JsonSerializerOptions</div>
<div class="line">⋮----</div>
<div class="line">await File.WriteAllTextAsync(jsonPath, json, Encoding.UTF8);</div>
<div class="line">await File.WriteAllTextAsync(logPath, <span class="keywordtype">string</span>.Join(Environment.NewLine, report.Logs), Encoding.UTF8);</div>
<div class="line">var tablesCsv = <span class="keyword">new</span> StringBuilder();</div>
<div class="line">tablesCsv.AppendLine(<span class="stringliteral">&quot;TableName,IsValid,StatusText,Details&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">tablesCsv.AppendLine($<span class="stringliteral">&quot;{EscapeCsv(t.TableName)},{t.IsValid},{EscapeCsv(t.StatusText)},{EscapeCsv(t.Details)}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await File.WriteAllTextAsync(tablesCsvPath, tablesCsv.ToString(), Encoding.UTF8);</div>
<div class="line">var procsCsv = <span class="keyword">new</span> StringBuilder();</div>
<div class="line">procsCsv.AppendLine(<span class="stringliteral">&quot;ProcedureName,IsValid,ExecutionTimeMs,TestDetails&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">procsCsv.AppendLine($<span class="stringliteral">&quot;{EscapeCsv(p.ProcedureName)},{p.IsValid},{p.ExecutionTimeMs},{EscapeCsv(p.TestDetails)}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await File.WriteAllTextAsync(procsCsvPath, procsCsv.ToString(), Encoding.UTF8);</div>
<div class="line">var daosCsv = <span class="keyword">new</span> StringBuilder();</div>
<div class="line">daosCsv.AppendLine(<span class="stringliteral">&quot;DaoName,IsValid,StatusText,OperationsTested&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">daosCsv.AppendLine($<span class="stringliteral">&quot;{EscapeCsv(d.DaoName)},{d.IsValid},{EscapeCsv(d.StatusText)},{EscapeCsv(d.OperationsTested)}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await File.WriteAllTextAsync(daosCsvPath, daosCsv.ToString(), Encoding.UTF8);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Settings DB Test export completed: {jsonPath}&quot;</span>, <span class="stringliteral">&quot;ViewModel_Settings_DatabaseTest&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Enum_ErrorSeverity.Low, nameof(ExportResultsAsync), nameof(ViewModel_Settings_DatabaseTest));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task LoadAuditLogAsync()</div>
<div class="line">⋮----</div>
<div class="line">AuditLogEntries.Clear();</div>
<div class="line">var settingsResult = await _daoSystemSettings.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">var auditResult = await _daoSettingsAuditLog.GetAsync(settingId, 50);</div>
<div class="line">⋮----</div>
<div class="line">AuditLogEntries.Add(entry);</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleException(ex, Enum_ErrorSeverity.Low, nameof(LoadAuditLogAsync), nameof(ViewModel_Settings_DatabaseTest));</div>
<div class="line">⋮----</div>
<div class="line">private async Task TestConnectionAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(<span class="stringliteral">&quot;Testing database connection&quot;</span>, <span class="stringliteral">&quot;ViewModel_Settings_DatabaseTest&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await using var connection = new MySqlConnection(Helper_Database_Variables.GetConnectionString());</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;Database connection successful in {ConnectionTimeMs}ms - MySQL {ServerVersion}&quot;</span>, <span class="stringliteral">&quot;ViewModel_Settings_DatabaseTest&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;Database connection failed: {ex.Message}&quot;</span>, ex, <span class="stringliteral">&quot;ViewModel_Settings_DatabaseTest&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">private async Task TestTablesAsync()</div>
<div class="line">⋮----</div>
<div class="line">TableResults.Clear();</div>
<div class="line">⋮----</div>
<div class="line">await using var command = new MySqlCommand(query, connection);</div>
<div class="line">var exists = Convert.ToInt32(await command.ExecuteScalarAsync()) &gt; 0;</div>
<div class="line">⋮----</div>
<div class="line">TableResults.Add(new Model_TableTestResult</div>
<div class="line">⋮----</div>
<div class="line">private async Task TestStoredProceduresAsync()</div>
<div class="line">⋮----</div>
<div class="line">StoredProcedureResults.Clear();</div>
<div class="line">⋮----</div>
<div class="line">var sw = Stopwatch.StartNew();</div>
<div class="line">⋮----</div>
<div class="line">sw.Stop();</div>
<div class="line">StoredProcedureResults.Add(new Model_StoredProcedureTestResult</div>
<div class="line">⋮----</div>
<div class="line">private async Task TestDaosAsync()</div>
<div class="line">⋮----</div>
<div class="line">DaoResults.Clear();</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoSystemSettings.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoUserSettings.GetAllForUserAsync(1);</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoPackageType.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoRoutingRule.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoScheduledReport.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">var result = await _daoPackageTypeMappings.GetAllAsync();</div>
<div class="line">⋮----</div>
<div class="line">var auditResult = await _daoSettingsAuditLog.GetAsync(settingsResult.Data[0].Id, 10);</div>
<div class="line">⋮----</div>
<div class="line">private async Task&lt;<span class="keywordtype">bool</span>&gt; TestDaoAsync(<span class="keywordtype">string</span> daoName, Func&lt;Task&lt;<span class="keywordtype">bool</span>&gt;&gt; testFunc)</div>
<div class="line">⋮----</div>
<div class="line">DaoResults.Add(new Model_DaoTestResult</div>
<div class="line">⋮----</div>
<div class="line">private <span class="keywordtype">void</span> AddLog(<span class="keywordtype">string</span> message)</div>
<div class="line">⋮----</div>
<div class="line">var timestamp = DateTime.Now.ToString(<span class="stringliteral">&quot;HH:mm:ss.fff&quot;</span>);</div>
<div class="line">LogMessages.Add($<span class="stringliteral">&quot;[{timestamp}] {message}&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md508"></a>
File: Module_Volvo/Views/View_Volvo_ShipmentEntry.xaml</h2>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">Page</span></div>
<div class="line">    <span class="keyword">x:Class</span>=<span class="stringliteral">&quot;MTM_Receiving_Application.Module_Volvo.Views.View_Volvo_ShipmentEntry&quot;</span></div>
<div class="line">    <span class="keyword">xmlns</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:x</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mi</span>=<span class="stringliteral">&quot;using:Material.Icons.WinUI3&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:d</span>=<span class="stringliteral">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:mc</span>=<span class="stringliteral">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:controls</span>=<span class="stringliteral">&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:views</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Volvo.Views&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:models</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Volvo.Models&quot;</span></div>
<div class="line">    <span class="keyword">xmlns:converters</span>=<span class="stringliteral">&quot;using:MTM_Receiving_Application.Module_Core.Converters&quot;</span></div>
<div class="line">    <span class="keyword">mc:Ignorable</span>=<span class="stringliteral">&quot;d&quot;</span></div>
<div class="line">    <span class="keyword">Loaded</span>=<span class="stringliteral">&quot;OnLoaded&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:Converter_BooleanToVisibility</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;BooleanToVisibilityConverter&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">converters:NullableDoubleToDoubleConverter</span> <span class="keyword">x:Key</span>=<span class="stringliteral">&quot;NullableDoubleToDoubleConverter&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Page.Resources</span>&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">Grid</span> <span class="keyword">Padding</span>=<span class="stringliteral">&quot;24&quot;</span> <span class="keyword">RowSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Success Message --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">InfoBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                 <span class="keyword">IsOpen</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsSuccessMessageVisible, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">Severity</span>=<span class="stringliteral">&quot;Success&quot;</span></div>
<div class="line">                 <span class="keyword">Message</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SuccessMessage, Mode=OneWay}&quot;</span></div>
<div class="line">                 <span class="keyword">IsClosable</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Header Section --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">            <span class="comment">&lt;!-- Shipment Info Row --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">CalendarDatePicker</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                    <span class="keyword">Header</span>=<span class="stringliteral">&quot;Shipment Date&quot;</span></div>
<div class="line">                                    <span class="keyword">Date</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShipmentDate, Mode=TwoWay}&quot;</span></div>
<div class="line">                                    <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                           <span class="keyword">Header</span>=<span class="stringliteral">&quot;Shipment Number&quot;</span></div>
<div class="line">                           <span class="keyword">Value</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ShipmentNumber, Mode=TwoWay}&quot;</span></div>
<div class="line">                           <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                           <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                         <span class="keyword">Header</span>=<span class="stringliteral">&quot;Notes (optional)&quot;</span></div>
<div class="line">                         <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Notes, Mode=TwoWay}&quot;</span></div>
<div class="line">                         <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Enter any additional notes&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">&lt;!-- Part Entry Row --&gt;</span></div>
<div class="line">            &lt;<span class="keywordtype">Grid</span> <span class="keyword">ColumnSpacing</span>=<span class="stringliteral">&quot;16&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;2*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">ColumnDefinition</span> <span class="keyword">Width</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">Grid.ColumnDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">AutoSuggestBox</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part Number&quot;</span></div>
<div class="line">                                <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SuggestedParts, Mode=OneWay}&quot;</span></div>
<div class="line">                                <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PartSearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span></div>
<div class="line">                                <span class="keyword">DisplayMemberPath</span>=<span class="stringliteral">&quot;PartNumber&quot;</span></div>
<div class="line">                                <span class="keyword">TextMemberPath</span>=<span class="stringliteral">&quot;PartNumber&quot;</span></div>
<div class="line">                                <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Type to search for a part number&quot;</span></div>
<div class="line">                                <span class="keyword">TextChanged</span>=<span class="stringliteral">&quot;OnPartSearchTextChanged&quot;</span></div>
<div class="line">                                <span class="keyword">SuggestionChosen</span>=<span class="stringliteral">&quot;OnPartSuggestionChosen&quot;</span></div>
<div class="line">                                <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                           <span class="keyword">Header</span>=<span class="stringliteral">&quot;Received Skids&quot;</span></div>
<div class="line">                           <span class="keyword">Value</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ReceivedSkidsToAdd, Mode=TwoWay}&quot;</span></div>
<div class="line">                           <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                           <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;99&quot;</span></div>
<div class="line">                           <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                &lt;<span class="keywordtype">Button</span> <span class="keyword">Grid.Column</span>=<span class="stringliteral">&quot;2&quot;</span></div>
<div class="line">                        <span class="keyword">Content</span>=<span class="stringliteral">&quot;Add Part&quot;</span></div>
<div class="line">                        <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.AddPartCommand}&quot;</span></div>
<div class="line">                        <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Bottom&quot;</span></div>
<div class="line">                        <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource AccentButtonStyle}&quot;</span></div>
<div class="line">                        <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,4&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Parts Entry DataGrid --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;2&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;Auto&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">RowDefinition</span> <span class="keyword">Height</span>=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">Grid.RowDefinitions</span>&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;0&quot;</span> </div>
<div class="line">                       <span class="keyword">Text</span>=<span class="stringliteral">&quot;Parts Received&quot;</span> </div>
<div class="line">                       <span class="keyword">Style</span>=<span class="stringliteral">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span></div>
<div class="line">                       <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,0,0,8&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">            &lt;<span class="keywordtype">controls:DataGrid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                               <span class="keyword">ItemsSource</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.Parts, Mode=OneWay}&quot;</span></div>
<div class="line">                               <span class="keyword">SelectedItem</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SelectedPart, Mode=TwoWay}&quot;</span></div>
<div class="line">                               <span class="keyword">AutoGenerateColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                               <span class="keyword">CanUserSortColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                               <span class="keyword">CanUserReorderColumns</span>=<span class="stringliteral">&quot;False&quot;</span></div>
<div class="line">                               <span class="keyword">GridLinesVisibility</span>=<span class="stringliteral">&quot;All&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Part Number&quot;</span></div>
<div class="line">                                                  <span class="keyword">Width</span>=<span class="stringliteral">&quot;200&quot;</span></div>
<div class="line">                                                  <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PartNumber, Mode=OneWay}&quot;</span></div>
<div class="line">                                                  <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Received Skids&quot;</span></div>
<div class="line">                                                      <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_VolvoShipmentLine&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;{x:Bind ReceivedSkidCount, Mode=TwoWay}&quot;</span></div>
<div class="line">                                           <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                                           <span class="keyword">Maximum</span>=<span class="stringliteral">&quot;99&quot;</span></div>
<div class="line">                                           <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Calculated Pieces&quot;</span></div>
<div class="line">                                                  <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span></div>
<div class="line">                                                  <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding CalculatedPieceCount, Mode=OneWay}&quot;</span></div>
<div class="line">                                                  <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridCheckBoxColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Discrepancy&quot;</span></div>
<div class="line">                                                      <span class="keyword">Width</span>=<span class="stringliteral">&quot;120&quot;</span></div>
<div class="line">                                                      <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding HasDiscrepancy, Mode=TwoWay}&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Expected Skids&quot;</span></div>
<div class="line">                                                      <span class="keyword">Width</span>=<span class="stringliteral">&quot;150&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_VolvoShipmentLine&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">NumberBox</span> <span class="keyword">Value</span>=<span class="stringliteral">&quot;{Binding ExpectedSkidCount, Mode=TwoWay, Converter={StaticResource NullableDoubleToDoubleConverter}}&quot;</span></div>
<div class="line">                                           <span class="keyword">Minimum</span>=<span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">                                           <span class="keyword">SpinButtonPlacementMode</span>=<span class="stringliteral">&quot;Inline&quot;</span></div>
<div class="line">                                           <span class="keyword">HorizontalAlignment</span>=<span class="stringliteral">&quot;Stretch&quot;</span></div>
<div class="line">                                           <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind HasDiscrepancy, Mode=OneWay}&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Expected Pieces&quot;</span></div>
<div class="line">                                                  <span class="keyword">Width</span>=<span class="stringliteral">&quot;130&quot;</span></div>
<div class="line">                                                  <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding ExpectedPieceCount, Mode=OneWay}&quot;</span></div>
<div class="line">                                                  <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTextColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Difference&quot;</span></div>
<div class="line">                                                  <span class="keyword">Width</span>=<span class="stringliteral">&quot;100&quot;</span></div>
<div class="line">                                                  <span class="keyword">Binding</span>=<span class="stringliteral">&quot;{Binding PieceDifference, Mode=OneWay}&quot;</span></div>
<div class="line">                                                  <span class="keyword">IsReadOnly</span>=<span class="stringliteral">&quot;True&quot;</span>/&gt;</div>
<div class="line"> </div>
<div class="line">                    &lt;<span class="keywordtype">controls:DataGridTemplateColumn</span> <span class="keyword">Header</span>=<span class="stringliteral">&quot;Discrepancy Note&quot;</span></div>
<div class="line">                                                      <span class="keyword">Width</span>=<span class="stringliteral">&quot;*&quot;</span>&gt;</div>
<div class="line">                        &lt;<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                            &lt;<span class="keywordtype">DataTemplate</span> <span class="keyword">x:DataType</span>=<span class="stringliteral">&quot;models:Model_VolvoShipmentLine&quot;</span>&gt;</div>
<div class="line">                                &lt;<span class="keywordtype">TextBox</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind DiscrepancyNote, Mode=TwoWay}&quot;</span></div>
<div class="line">                                         <span class="keyword">IsEnabled</span>=<span class="stringliteral">&quot;{x:Bind HasDiscrepancy, Mode=OneWay}&quot;</span></div>
<div class="line">                                         <span class="keyword">PlaceholderText</span>=<span class="stringliteral">&quot;Explain discrepancy&quot;</span>/&gt;</div>
<div class="line">                            &lt;/<span class="keywordtype">DataTemplate</span>&gt;</div>
<div class="line">                        &lt;/<span class="keywordtype">controls:DataGridTemplateColumn.CellTemplate</span>&gt;</div>
<div class="line">                    &lt;/<span class="keywordtype">controls:DataGridTemplateColumn</span>&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">controls:DataGrid.Columns</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">controls:DataGrid</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Action Buttons --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">CommandBar</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">DefaultLabelPosition</span>=<span class="stringliteral">&quot;Right&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Delete&quot;</span> <span class="keyword">Label</span>=<span class="stringliteral">&quot;Remove Part&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.RemovePartCommand}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Label</span>=<span class="stringliteral">&quot;Generate Labels&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.GenerateLabelsCommand}&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">AppBarButton.Icon</span>&gt;</div>
<div class="line">                    &lt;<span class="keywordtype">FontIcon</span> <span class="keyword">Glyph</span>=<span class="stringliteral">&quot;&amp;#xE8B7;&quot;</span>/&gt;</div>
<div class="line">                &lt;/<span class="keywordtype">AppBarButton.Icon</span>&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">AppBarButton</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Mail&quot;</span> <span class="keyword">Label</span>=<span class="stringliteral">&quot;Preview Email&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.PreviewEmailCommand}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Save&quot;</span> <span class="keyword">Label</span>=<span class="stringliteral">&quot;Save as Pending&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.SaveAsPendingCommand}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Accept&quot;</span> </div>
<div class="line">                          <span class="keyword">Label</span>=<span class="stringliteral">&quot;Complete Shipment&quot;</span> </div>
<div class="line">                          <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.CompleteShipmentCommand}&quot;</span></div>
<div class="line">                          <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.HasPendingShipment, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarSeparator</span>/&gt;</div>
<div class="line">            &lt;<span class="keywordtype">AppBarButton</span> <span class="keyword">Icon</span>=<span class="stringliteral">&quot;Calendar&quot;</span> <span class="keyword">Label</span>=<span class="stringliteral">&quot;View History&quot;</span> <span class="keyword">Command</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.ViewHistoryCommand}&quot;</span>/&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">CommandBar</span>&gt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">&lt;!-- Status Bar --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">Grid</span> <span class="keyword">Grid.Row</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">Margin</span>=<span class="stringliteral">&quot;0,8,0,0&quot;</span> <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;Collapsed&quot;</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">StackPanel</span> <span class="keyword">Orientation</span>=<span class="stringliteral">&quot;Horizontal&quot;</span> <span class="keyword">Spacing</span>=<span class="stringliteral">&quot;8&quot;</span>&gt;</div>
<div class="line">                &lt;<span class="keywordtype">ProgressRing</span> <span class="keyword">IsActive</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay}&quot;</span> </div>
<div class="line">                              <span class="keyword">Width</span>=<span class="stringliteral">&quot;20&quot;</span> </div>
<div class="line">                              <span class="keyword">Height</span>=<span class="stringliteral">&quot;20&quot;</span></div>
<div class="line">                              <span class="keyword">Visibility</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.IsBusy, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}&quot;</span>/&gt;</div>
<div class="line">                &lt;<span class="keywordtype">TextBlock</span> <span class="keyword">Text</span>=<span class="stringliteral">&quot;{x:Bind ViewModel.StatusMessage, Mode=OneWay}&quot;</span> </div>
<div class="line">                           <span class="keyword">VerticalAlignment</span>=<span class="stringliteral">&quot;Center&quot;</span>/&gt;</div>
<div class="line">            &lt;/<span class="keywordtype">StackPanel</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">Grid</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Page</span>&gt;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md509"></a>
File: Module_Core/Data/Authentication/Dao_User.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Dao_User</div>
<div class="line">⋮----</div>
<div class="line">_connectionString = connectionString ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(connectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;Model_User&gt;&gt; GetUserByWindowsUsernameAsync(<span class="keywordtype">string</span> windowsUsername)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> await Helper_Database_StoredProcedure.ExecuteSingleAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;Model_User&gt;&gt; ValidateUserPinAsync(<span class="keywordtype">string</span> username, <span class="keywordtype">string</span> pin)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;Model_Dao_Result&lt;int&gt;&gt; CreateNewUserAsync(Model_User user, <span class="keywordtype">string</span> createdBy)</div>
<div class="line">⋮----</div>
<div class="line">await <span class="keyword">using</span> var connection = <span class="keyword">new</span> MySqlConnection(_connectionString);</div>
<div class="line">await connection.OpenAsync();</div>
<div class="line">await <span class="keyword">using </span>var command = <span class="keyword">new</span> MySqlCommand(<span class="stringliteral">&quot;sp_Auth_User_Create&quot;</span>, connection)</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_employee_number&quot;</span>, user.EmployeeNumber);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_windows_username&quot;</span>, user.WindowsUsername);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_full_name&quot;</span>, user.FullName);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_pin&quot;</span>, user.Pin);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_department&quot;</span>, user.Department);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_shift&quot;</span>, user.Shift);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_created_by&quot;</span>, createdBy);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_visual_username&quot;</span>, user.VisualUsername ?? (<span class="keywordtype">object</span>)DBNull.Value);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@p_visual_password&quot;</span>, user.VisualPassword ?? (<span class="keywordtype">object</span>)DBNull.Value);</div>
<div class="line">var errorMessageParam = <span class="keyword">new</span> MySqlParameter(<span class="stringliteral">&quot;@p_error_message&quot;</span>, MySqlDbType.VarChar, 500)</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.Add(errorMessageParam);</div>
<div class="line">await command.ExecuteNonQueryAsync();</div>
<div class="line">⋮----</div>
<div class="line">if (!<span class="keywordtype">string</span>.IsNullOrEmpty(errorMessage))</div>
<div class="line">⋮----</div>
<div class="line">await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">bool</span>&gt;&gt; IsWindowsUsernameUniqueAsync(<span class="keywordtype">string</span> username, <span class="keywordtype">int</span>? excludeEmployeeNumber = null)</div>
<div class="line">⋮----</div>
<div class="line">await using var command = new MySqlCommand(query, connection);</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@username&quot;</span>, username);</div>
<div class="line">⋮----</div>
<div class="line">command.Parameters.AddWithValue(<span class="stringliteral">&quot;@excludeId&quot;</span>, excludeEmployeeNumber.Value);</div>
<div class="line">⋮----</div>
<div class="line">var count = Convert.ToInt32(await command.ExecuteScalarAsync());</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;<span class="keywordtype">bool</span>&gt;&gt; LogUserActivityAsync(</div>
<div class="line">⋮----</div>
<div class="line">var result = await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;<span class="keywordtype">string</span>&gt;&gt;&gt; GetSharedTerminalNamesAsync()</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteListAsync(</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;workstation_name&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; UpsertWorkstationConfigAsync(</div>
<div class="line">⋮----</div>
<div class="line">return await Helper_Database_StoredProcedure.ExecuteNonQueryAsync(</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&lt;List&lt;<span class="keywordtype">string</span>&gt;&gt;&gt; GetActiveDepartmentsAsync()</div>
<div class="line">⋮----</div>
<div class="line">reader =&gt; reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;department_name&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">private Model_User MapReaderToUser(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">return new Model_User</div>
<div class="line">⋮----</div>
<div class="line">EmployeeNumber = reader.GetInt32(reader.GetOrdinal(<span class="stringliteral">&quot;employee_number&quot;</span>)),</div>
<div class="line">WindowsUsername = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;windows_username&quot;</span>)),</div>
<div class="line">FullName = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;full_name&quot;</span>)),</div>
<div class="line">Pin = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;pin&quot;</span>)),</div>
<div class="line">Department = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;department&quot;</span>)),</div>
<div class="line">Shift = reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;shift&quot;</span>)),</div>
<div class="line">IsActive = reader.GetBoolean(reader.GetOrdinal(<span class="stringliteral">&quot;is_active&quot;</span>)),</div>
<div class="line">VisualUsername = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;visual_username&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;visual_username&quot;</span>)),</div>
<div class="line">VisualPassword = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;visual_password&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;visual_password&quot;</span>)),</div>
<div class="line">⋮----</div>
<div class="line">CreatedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;created_date&quot;</span>)),</div>
<div class="line">CreatedBy = reader.IsDBNull(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">: reader.GetString(reader.GetOrdinal(<span class="stringliteral">&quot;created_by&quot;</span>)),</div>
<div class="line">ModifiedDate = reader.GetDateTime(reader.GetOrdinal(<span class="stringliteral">&quot;modified_date&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; UpdateDefaultModeAsync(<span class="keywordtype">int</span> userId, <span class="keywordtype">string</span>? defaultMode)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; UpdateDefaultReceivingModeAsync(<span class="keywordtype">int</span> userId, <span class="keywordtype">string</span>? defaultMode)</div>
<div class="line">⋮----</div>
<div class="line">public virtual async Task&lt;Model_Dao_Result&gt; UpdateDefaultDunnageModeAsync(<span class="keywordtype">int</span> userId, <span class="keywordtype">string</span>? defaultMode)</div>
<div class="line">⋮----</div>
<div class="line">private static <span class="keywordtype">string</span>? TryGetDefaultReceivingMode(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">var ordinal = reader.GetOrdinal(<span class="stringliteral">&quot;default_receiving_mode&quot;</span>);</div>
<div class="line">return reader.IsDBNull(ordinal) ? null : reader.GetString(ordinal);</div>
<div class="line">⋮----</div>
<div class="line">private static <span class="keywordtype">string</span>? TryGetDefaultDunnageMode(IDataReader reader)</div>
<div class="line">⋮----</div>
<div class="line">var ordinal = reader.GetOrdinal(<span class="stringliteral">&quot;default_dunnage_mode&quot;</span>);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md510"></a>
File: Module_Volvo/Services/Service_Volvo.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Service_Volvo : IService_Volvo</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly Dao_VolvoShipment _shipmentDao;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_VolvoShipmentLine _lineDao;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_VolvoPart _partDao;</div>
<div class="line"><span class="keyword">private</span> readonly Dao_VolvoPartComponent _componentDao;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line"><span class="keyword">private</span> readonly IService_VolvoAuthorization _authService;</div>
<div class="line">⋮----</div>
<div class="line">_shipmentDao = shipmentDao ?? throw new ArgumentNullException(nameof(shipmentDao));</div>
<div class="line">_lineDao = lineDao ?? throw new ArgumentNullException(nameof(lineDao));</div>
<div class="line">_partDao = partDao ?? throw new ArgumentNullException(nameof(partDao));</div>
<div class="line">_componentDao = componentDao ?? throw new ArgumentNullException(nameof(componentDao));</div>
<div class="line">_logger = logger ?? throw new ArgumentNullException(nameof(logger));</div>
<div class="line">_authService = authService ?? throw new ArgumentNullException(nameof(authService));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task&lt;Model_Dao_Result&lt;Dictionary&lt;string, int&gt;&gt;&gt; CalculateComponentExplosionAsync(</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(&quot;Calculating component explosion for shipment lines&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var partResult = await _partDao.GetByIdAsync(line.PartNumber);</div>
<div class="line">⋮----</div>
<div class="line">if (aggregatedPieces.ContainsKey(line.PartNumber))</div>
<div class="line">⋮----</div>
<div class="line">var componentsResult = await _componentDao.GetByParentPartAsync(line.PartNumber);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync(</div>
<div class="line">⋮----</div>
<div class="line">if (aggregatedPieces.ContainsKey(component.ComponentPartNumber))</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Component explosion complete: {aggregatedPieces.Count} unique parts&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error calculating component explosion: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;Model_Dao_Result&lt;string&gt;&gt; GenerateLabelCsvAsync(int shipmentId)</div>
<div class="line">⋮----</div>
<div class="line">var authResult = await _authService.CanGenerateLabelsAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Generating label CSV for shipment {shipmentId}&quot;);</div>
<div class="line">var shipmentResult = await _shipmentDao.GetByIdAsync(shipmentId);</div>
<div class="line">⋮----</div>
<div class="line">var linesResult = await _lineDao.GetByShipmentIdAsync(shipmentId);</div>
<div class="line">⋮----</div>
<div class="line">string appDataPath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);</div>
<div class="line">string csvDirectory = Path.Combine(appDataPath, &quot;MTM_Receiving_Application&quot;, &quot;Volvo&quot;, &quot;Labels&quot;);</div>
<div class="line">Directory.CreateDirectory(csvDirectory);</div>
<div class="line">⋮----</div>
<div class="line">string filePath = Path.Combine(csvDirectory, fileName);</div>
<div class="line">var csvContent = new StringBuilder();</div>
<div class="line">csvContent.AppendLine(&quot;Material,Quantity,Employee,Date,Time,Receiver,Notes&quot;);</div>
<div class="line">string dateFormatted = shipment.ShipmentDate.ToString(&quot;MM/dd/yyyy&quot;);</div>
<div class="line">string timeFormatted = DateTime.Now.ToString(&quot;HH:mm:ss&quot;);</div>
<div class="line">foreach (var kvp in aggregatedPieces.OrderBy(x =&gt; x.Key))</div>
<div class="line">⋮----</div>
<div class="line">csvContent.AppendLine($&quot;{kvp.Key},{kvp.Value},{shipment.EmployeeNumber},{dateFormatted},{timeFormatted},,&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await File.WriteAllTextAsync(filePath, csvContent.ToString());</div>
<div class="line">await _logger.LogInfoAsync($&quot;Label CSV generated: {filePath}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error generating label CSV: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">public async Task&lt;string&gt; FormatEmailTextAsync(</div>
<div class="line">⋮----</div>
<div class="line">var emailText = new StringBuilder();</div>
<div class="line">emailText.AppendLine($&quot;Subject: PO Requisition - Volvo Dunnage - {shipment.ShipmentDate:MM/dd/yyyy} Shipment #{shipment.ShipmentNumber}&quot;);</div>
<div class="line">emailText.AppendLine();</div>
<div class="line">emailText.AppendLine(&quot;Good morning,&quot;);</div>
<div class="line">⋮----</div>
<div class="line">emailText.AppendLine($&quot;Please create a PO for the following Volvo dunnage received on {shipment.ShipmentDate:MM/dd/yyyy}:&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var discrepancies = lines.Where(l =&gt; l.HasDiscrepancy).ToList();</div>
<div class="line">⋮----</div>
<div class="line">emailText.AppendLine(&quot;**DISCREPANCIES NOTED**&quot;);</div>
<div class="line">⋮----</div>
<div class="line">emailText.AppendLine(&quot;Part Number\tPacklist Qty (pcs)\tReceived Qty (pcs)\tDifference (pcs)\tNote&quot;);</div>
<div class="line">emailText.AppendLine(new string(&#39;-&#39;, 80));</div>
<div class="line">⋮----</div>
<div class="line">string diffStr = difference &gt; 0 ? $&quot;+{difference}<span class="stringliteral">&quot; : difference.ToString();</span></div>
<div class="line"><span class="stringliteral">emailText.AppendLine($&quot;</span>{line.PartNumber}\t{expectedPieces}\t{receivedPieces}\t{diffStr}\t{line.DiscrepancyNote ?? <span class="stringliteral">&quot;&quot;</span>}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">emailText.AppendLine(&quot;</span>Requested Lines:<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">emailText.AppendLine(&quot;</span>Part Number\tQuantity (pcs)<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">emailText.AppendLine(new string(&#39;-&#39;, 40));</span></div>
<div class="line"><span class="stringliteral">foreach (var kvp in requestedLines.OrderBy(x =&gt; x.Key))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">emailText.AppendLine($&quot;</span>{kvp.Key}\t{kvp.Value}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (!string.IsNullOrWhiteSpace(shipment.Notes))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">emailText.AppendLine(&quot;</span>Additional Notes:<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">emailText.AppendLine(shipment.Notes);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync(&quot;</span>Email text formatted<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">return emailText.ToString();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_VolvoEmailData&gt; FormatEmailDataAsync(</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var emailData = new Model_VolvoEmailData</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">AdditionalNotes = string.IsNullOrWhiteSpace(shipment.Notes) ? null : shipment.Notes,</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">emailData.Discrepancies.Add(new Model_VolvoEmailData.DiscrepancyLineItem</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync(&quot;</span>Email data formatted<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public string FormatEmailAsHtml(Model_VolvoEmailData emailData)</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var html = new StringBuilder();</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;html&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;body style=<span class="stringliteral">&#39;font-family: Calibri, Arial, sans-serif; font-size: 11pt;&#39;</span>&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;p&gt;{emailData.Greeting}&lt;/p&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;p&gt;{emailData.Message}&lt;/p&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;p&gt;&lt;strong&gt;**DISCREPANCIES NOTED**&lt;/strong&gt;&lt;/p&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;table border=<span class="charliteral">&#39;1&#39;</span> cellpadding=<span class="charliteral">&#39;5&#39;</span> cellspacing=<span class="charliteral">&#39;0&#39;</span> style=<span class="stringliteral">&#39;border-collapse: collapse; font-size: 10pt;&#39;</span>&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;thead&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;tr style=<span class="stringliteral">&#39;background-color: #D9D9D9; font-weight: bold;&#39;</span>&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;th&gt;Part Number&lt;/th&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;th&gt;Packlist Qty&lt;/th&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;th&gt;Received Qty&lt;/th&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;th&gt;Difference&lt;/th&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;th&gt;Note&lt;/th&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;/tr&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;/thead&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;tbody&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">string diffStr = disc.Difference &gt; 0 ? $&quot;</span>+{disc.Difference}<span class="stringliteral">&quot; : disc.Difference.ToString();</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;tr&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;td&gt;{disc.PartNumber}&lt;/td&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;td&gt;{disc.PacklistQty}&lt;/td&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;td&gt;{disc.ReceivedQty}&lt;/td&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;td&gt;{diffStr}&lt;/td&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;td&gt;{disc.Note}&lt;/td&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;/tbody&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;/table&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;br/&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;p&gt;&lt;strong&gt;Requested Lines:&lt;/strong&gt;&lt;/p&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;th&gt;Quantity (pcs)&lt;/th&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">foreach (var kvp in emailData.RequestedLines.OrderBy(x =&gt; x.Key))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;td&gt;{kvp.Key}&lt;/td&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;td&gt;{kvp.Value}&lt;/td&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (!string.IsNullOrWhiteSpace(emailData.AdditionalNotes))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;p&gt;&lt;strong&gt;Additional Notes:&lt;/strong&gt;&lt;/p&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;p&gt;{emailData.AdditionalNotes}&lt;/p&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">html.AppendLine($&quot;</span>&lt;p&gt;{emailData.Signature.Replace(<span class="stringliteral">&quot;\\n&quot;</span>, <span class="stringliteral">&quot;&lt;br/&gt;&quot;</span>)}&lt;/p&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;/body&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">html.AppendLine(&quot;</span>&lt;/html&gt;<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">return html.ToString();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line">public async Task&lt;Model_Dao_Result&gt; ValidateShipmentAsync(</div>
<div class="line">⋮----</div>
<div class="line">return Model_Dao_Result_Factory.Failure(&quot;At least one part line is required<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (string.IsNullOrWhiteSpace(line.PartNumber))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Failure(&quot;</span>All parts must have a part number<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Failure(</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (shipment.ShipmentDate &gt; DateTime.Now.AddDays(1))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Failure(&quot;</span>Shipment date cannot be in the future<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync(&quot;</span>Shipment validation passed<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Success();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&lt;(int ShipmentId, int ShipmentNumber)&gt;&gt; SaveShipmentAsync(</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var authResult = await _authService.CanManageShipmentsAsync();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync(&quot;</span>Saving Volvo shipment as pending PO<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">var existingPendingResult = await _shipmentDao.GetPendingAsync();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync($&quot;</span>Deleting existing pending shipment #{existingPendingResult.Data.ShipmentNumber}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">var deleteResult = await _shipmentDao.DeleteAsync(existingPendingResult.Data.Id);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var insertResult = await _shipmentDao.InsertAsync(shipment);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync($&quot;</span>Starting line insertion transaction <span class="keywordflow">for</span> shipment {shipmentId}, {lines.Count} lines to insert<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">await using var connection = new MySqlConnection(Helper_Database_Variables.GetConnectionString());</span></div>
<div class="line"><span class="stringliteral">await connection.OpenAsync();</span></div>
<div class="line"><span class="stringliteral">await using var transaction = await connection.BeginTransactionAsync();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync($&quot;</span>Inserting line {lineIndex}/{lines.Count}: <span class="stringliteral">&quot; +</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">$&quot;</span>Note={(!<span class="keywordtype">string</span>.IsNullOrEmpty(line.DiscrepancyNote) ? <span class="stringliteral">&quot;PROVIDED&quot;</span> : <span class="stringliteral">&quot;NULL&quot;</span>)}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync($&quot;</span>Parameters: {<span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot;, &quot;</span>, parameters.Select(p =&gt; $<span class="stringliteral">&quot;{p.Key}={p.Value}&quot;</span>))}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">var lineResult = await Helper_Database_StoredProcedure.ExecuteInTransactionAsync(</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await transaction.RollbackAsync();</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Failed to insert line {lineIndex} <span class="keywordflow">for</span> part {line.PartNumber}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Error: {lineResult.ErrorMessage}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Exception Type: {lineResult.Exception.GetType().Name}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Exception Message: {lineResult.Exception.Message}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Inner Exception: {lineResult.Exception.InnerException.Message}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync($&quot;</span>Line {lineIndex} inserted successfully<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await transaction.CommitAsync();</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync($&quot;</span>Transaction committed: Shipment {shipmentId} saved with {lines.Count} lines<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Transaction failed, rolled back: {ex.Message}<span class="stringliteral">&quot;, ex);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Error saving shipment: {ex.Message}<span class="stringliteral">&quot;, ex);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&lt;Model_VolvoShipment?&gt;&gt; GetPendingShipmentAsync()</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var result = await _shipmentDao.GetPendingAsync();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&lt;(Model_VolvoShipment? Shipment, List&lt;Model_VolvoShipmentLine&gt; Lines)&gt;&gt; GetPendingShipmentWithLinesAsync()</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var shipmentResult = await _shipmentDao.GetPendingAsync();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var linesResult = await _lineDao.GetByShipmentIdAsync(shipmentResult.Data.Id);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Error getting pending shipment with lines: {ex.Message}<span class="stringliteral">&quot;, ex);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&gt; CompleteShipmentAsync(int shipmentId, string poNumber, string receiverNumber)</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var authResult = await _authService.CanCompleteShipmentsAsync();</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return new Model_Dao_Result</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync($&quot;</span>Completing shipment {shipmentId} with PO={poNumber}, Receiver={receiverNumber}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">if (string.IsNullOrWhiteSpace(poNumber))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (string.IsNullOrWhiteSpace(receiverNumber))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var result = await _shipmentDao.CompleteAsync(shipmentId, poNumber, receiverNumber);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogInfoAsync($&quot;</span>Shipment {shipmentId} completed successfully<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync($&quot;</span>Error completing shipment: {ex.Message}<span class="stringliteral">&quot;, ex);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoPart&gt;&gt;&gt; GetActivePartsAsync()</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return await _partDao.GetAllAsync(includeInactive: false);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoShipment&gt;&gt;&gt; GetHistoryAsync(</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return await _shipmentDao.GetHistoryAsync(startDate, endDate, status);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&lt;List&lt;Model_VolvoShipmentLine&gt;&gt;&gt; GetShipmentLinesAsync(int shipmentId)</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return await _lineDao.GetByShipmentIdAsync(shipmentId);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&gt; UpdateShipmentAsync(</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var shipmentResult = await _shipmentDao.UpdateAsync(shipment);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var existingLines = await _lineDao.GetByShipmentIdAsync(shipment.Id);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _lineDao.DeleteAsync(line.Id);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var lineResult = await _lineDao.InsertAsync(line);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">await _logger.LogErrorAsync(</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (shipment.Status == &quot;</span>completed<span class="stringliteral">&quot; &amp;&amp; !string.IsNullOrEmpty(shipment.PONumber))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Success(&quot;</span>Shipment updated successfully<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Failure($&quot;</span>Error updating shipment: {ex.Message}<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">public async Task&lt;Model_Dao_Result&lt;string&gt;&gt; ExportHistoryToCsvAsync(</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">var csv = new StringBuilder();</span></div>
<div class="line"><span class="stringliteral">csv.AppendLine(&quot;</span>ShipmentNumber,Date,PONumber,ReceiverNumber,Status,EmployeeNumber,Notes<span class="stringliteral">&quot;);</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">csv.AppendLine($&quot;</span>{shipment.ShipmentNumber},<span class="stringliteral">&quot; +</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return Model_Dao_Result_Factory.Success(csv.ToString());</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">private string EscapeCsv(string? value)</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (string.IsNullOrEmpty(value))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">if (value.Contains(&#39;,&#39;) || value.Contains(&#39;&quot;</span><span class="stringliteral">&#39;) || value.Contains(&#39;</span>\n<span class="stringliteral">&#39;))</span></div>
<div class="line"><span class="stringliteral">⋮----</span></div>
<div class="line"><span class="stringliteral">return $&quot;\&quot;{value.Replace(&quot;\&quot;&quot;, &quot;\&quot;\&quot;&quot;)}\&quot;&quot;;</span></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md511"></a>
File: Module_Volvo/ViewModels/ViewModel_Volvo_ShipmentEntry.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>ViewModel_Volvo_ShipmentEntry : ViewModel_Shared_Base</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_Volvo _volvoService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_Window _windowService;</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> async Task InitializeAsync()</div>
<div class="line">⋮----</div>
<div class="line">var partsResult = await _volvoService.GetActivePartsAsync();</div>
<div class="line">⋮----</div>
<div class="line">AvailableParts.Clear();</div>
<div class="line">⋮----</div>
<div class="line">AvailableParts.Add(part);</div>
<div class="line">⋮----</div>
<div class="line">await _errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line">var pendingResult = await _volvoService.GetPendingShipmentAsync();</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error initializing Volvo shipment entry: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task LoadPendingShipmentAsync()</div>
<div class="line">⋮----</div>
<div class="line">ShipmentDate = new DateTimeOffset(shipment.ShipmentDate);</div>
<div class="line">⋮----</div>
<div class="line">var linesResult = await _volvoService.GetShipmentLinesAsync(shipment.Id);</div>
<div class="line">⋮----</div>
<div class="line">Parts.Clear();</div>
<div class="line">⋮----</div>
<div class="line">Parts.Add(line);</div>
<div class="line">⋮----</div>
<div class="line">public void UpdatePartSuggestions(string queryText)</div>
<div class="line">⋮----</div>
<div class="line">if (string.IsNullOrWhiteSpace(queryText))</div>
<div class="line">⋮----</div>
<div class="line">SuggestedParts.Clear();</div>
<div class="line">⋮----</div>
<div class="line">.Where(p =&gt; p.PartNumber.Contains(queryText, StringComparison.OrdinalIgnoreCase))</div>
<div class="line">.Take(20)</div>
<div class="line">.ToList();</div>
<div class="line">⋮----</div>
<div class="line">SuggestedParts.Add(part);</div>
<div class="line">⋮----</div>
<div class="line">var exactMatch = _allParts.FirstOrDefault(p =&gt;</div>
<div class="line">p.PartNumber.Equals(queryText, StringComparison.OrdinalIgnoreCase));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void OnPartSuggestionChosen(Model_VolvoPart? chosenPart)</div>
<div class="line">⋮----</div>
<div class="line">partial void OnPartSearchTextChanged(string value)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void AddPart()</div>
<div class="line">⋮----</div>
<div class="line">if (Parts.Any(p =&gt; p.PartNumber.Equals(SelectedPartToAdd.PartNumber, StringComparison.OrdinalIgnoreCase)))</div>
<div class="line">⋮----</div>
<div class="line">var newLine = new Model_VolvoShipmentLine</div>
<div class="line">⋮----</div>
<div class="line">Parts.Add(newLine);</div>
<div class="line">await _logger.LogInfoAsync($&quot;User added part {SelectedPartToAdd.PartNumber}, {ReceivedSkidsToAdd} skids ({calculatedPieces} pcs)&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> bool CanAddPart()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async void RemovePart()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;User removed part {SelectedPart.PartNumber} from shipment&quot;);</div>
<div class="line">Parts.Remove(SelectedPart);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task GenerateLabelsAsync()</div>
<div class="line">⋮----</div>
<div class="line">var csvResult = await _volvoService.GenerateLabelCsvAsync(pendingResult.Data.Id);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error generating labels: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task PreviewEmailAsync()</div>
<div class="line">⋮----</div>
<div class="line">var pendingResult = await _volvoService.GetPendingShipmentWithLinesAsync();</div>
<div class="line">⋮----</div>
<div class="line">var explosionResult = await _volvoService.CalculateComponentExplosionAsync(lines);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Component explosion successful: {requestedLines.Count} parts&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogWarningAsync($&quot;Component explosion failed for email preview: {explosionResult.ErrorMessage}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($&quot;Email preview - RequestedLines count: {requestedLines.Count}&quot;);</div>
<div class="line">var emailData = await _volvoService.FormatEmailDataAsync(shipment, lines, requestedLines);</div>
<div class="line">await _logger.LogInfoAsync($&quot;Email data formatted - RequestedLines count: {emailData.RequestedLines.Count}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($&quot;Error previewing email: {ex.Message}&quot;, ex);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async Task ShowEmailPreviewDialogAsync(Model_VolvoEmailData emailData)</div>
<div class="line">⋮----</div>
<div class="line">var xamlRoot = _windowService.GetXamlRoot();</div>
<div class="line">⋮----</div>
<div class="line">var settingsDao = new Data.Dao_VolvoSettings(Module_Core.Helpers.Database.Helper_Database_Variables.GetConnectionString());</div>
<div class="line">var toResult = await settingsDao.GetSettingAsync(&quot;email_to_recipients&quot;);</div>
<div class="line">var ccResult = await settingsDao.GetSettingAsync(&quot;email_cc_recipients&quot;);</div>
<div class="line">⋮----</div>
<div class="line">var dialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">var mainStack = new StackPanel { Spacing = 12, Margin = <span class="keyword">new</span> Microsoft.UI.Xaml.Thickness(0) };</div>
<div class="line">var toPanel = <span class="keyword">new</span> Grid { ColumnSpacing = 8 };</div>
<div class="line">toPanel.ColumnDefinitions.Add(<span class="keyword">new</span> Microsoft.UI.Xaml.Controls.ColumnDefinition { Width = <span class="keyword">new</span> Microsoft.UI.Xaml.GridLength(1, Microsoft.UI.Xaml.GridUnitType.Star) });</div>
<div class="line">toPanel.ColumnDefinitions.Add(<span class="keyword">new</span> Microsoft.UI.Xaml.Controls.ColumnDefinition { Width = Microsoft.UI.Xaml.GridLength.Auto });</div>
<div class="line">var toBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">toBox.SetValue(Grid.ColumnProperty, 0);</div>
<div class="line">var toCopyButton = <span class="keyword">new</span> Button</div>
<div class="line">⋮----</div>
<div class="line">toCopyButton.SetValue(Grid.ColumnProperty, 1);</div>
<div class="line">Microsoft.UI.Xaml.Controls.ToolTipService.SetToolTip(toCopyButton, <span class="stringliteral">&quot;Copy To Recipients&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">var dataPackage = <span class="keyword">new</span> DataPackage();</div>
<div class="line">dataPackage.SetText(toBox.Text);</div>
<div class="line">Clipboard.SetContent(dataPackage);</div>
<div class="line">⋮----</div>
<div class="line">toPanel.Children.Add(toBox);</div>
<div class="line">toPanel.Children.Add(toCopyButton);</div>
<div class="line">mainStack.Children.Add(toPanel);</div>
<div class="line">var ccPanel = <span class="keyword">new</span> Grid { ColumnSpacing = 8 };</div>
<div class="line">ccPanel.ColumnDefinitions.Add(<span class="keyword">new</span> Microsoft.UI.Xaml.Controls.ColumnDefinition { Width = new Microsoft.UI.Xaml.GridLength(1, Microsoft.UI.Xaml.GridUnitType.Star) });</div>
<div class="line">ccPanel.ColumnDefinitions.Add(<span class="keyword">new</span> Microsoft.UI.Xaml.Controls.ColumnDefinition { Width = Microsoft.UI.Xaml.GridLength.Auto });</div>
<div class="line">var ccBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">ccBox.SetValue(Grid.ColumnProperty, 0);</div>
<div class="line">var ccCopyButton = <span class="keyword">new</span> Button</div>
<div class="line">⋮----</div>
<div class="line">ccCopyButton.SetValue(Grid.ColumnProperty, 1);</div>
<div class="line">Microsoft.UI.Xaml.Controls.ToolTipService.SetToolTip(ccCopyButton, <span class="stringliteral">&quot;Copy CC Recipients&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">dataPackage.SetText(ccBox.Text);</div>
<div class="line">⋮----</div>
<div class="line">ccPanel.Children.Add(ccBox);</div>
<div class="line">ccPanel.Children.Add(ccCopyButton);</div>
<div class="line">mainStack.Children.Add(ccPanel);</div>
<div class="line">var subjectPanel = <span class="keyword">new</span> Grid { ColumnSpacing = 8 };</div>
<div class="line">subjectPanel.ColumnDefinitions.Add(<span class="keyword">new</span> Microsoft.UI.Xaml.Controls.ColumnDefinition { Width = new Microsoft.UI.Xaml.GridLength(1, Microsoft.UI.Xaml.GridUnitType.Star) });</div>
<div class="line">subjectPanel.ColumnDefinitions.Add(<span class="keyword">new</span> Microsoft.UI.Xaml.Controls.ColumnDefinition { Width = Microsoft.UI.Xaml.GridLength.Auto });</div>
<div class="line">var subjectBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">subjectBox.SetValue(Grid.ColumnProperty, 0);</div>
<div class="line">var subjectCopyButton = <span class="keyword">new</span> Button</div>
<div class="line">⋮----</div>
<div class="line">subjectCopyButton.SetValue(Grid.ColumnProperty, 1);</div>
<div class="line">Microsoft.UI.Xaml.Controls.ToolTipService.SetToolTip(subjectCopyButton, <span class="stringliteral">&quot;Copy Subject&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">dataPackage.SetText(subjectBox.Text);</div>
<div class="line">⋮----</div>
<div class="line">subjectPanel.Children.Add(subjectBox);</div>
<div class="line">subjectPanel.Children.Add(subjectCopyButton);</div>
<div class="line">mainStack.Children.Add(subjectPanel);</div>
<div class="line">⋮----</div>
<div class="line">var discHeader = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">mainStack.Children.Add(discHeader);</div>
<div class="line">var discBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">var discText = <span class="keyword">new</span> StringBuilder();</div>
<div class="line">discText.AppendLine(<span class="stringliteral">&quot;Part Number\tPacklist Qty (pcs)\tReceived Qty (pcs)\tDifference (pcs)\tNote&quot;</span>);</div>
<div class="line">discText.AppendLine(<span class="keyword">new</span> <span class="keywordtype">string</span>(<span class="charliteral">&#39;-&#39;</span>, 80));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordtype">string</span> diffStr = disc.Difference &gt; 0 ? $<span class="stringliteral">&quot;+{disc.Difference}&quot;</span> : disc.Difference.ToString();</div>
<div class="line">discText.AppendLine($<span class="stringliteral">&quot;{disc.PartNumber}\t{disc.PacklistQty}\t{disc.ReceivedQty}\t{diffStr}\t{disc.Note}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">discBox.Text = discText.ToString();</div>
<div class="line">mainStack.Children.Add(discBox);</div>
<div class="line">⋮----</div>
<div class="line">var reqHeader = <span class="keyword">new</span> TextBlock</div>
<div class="line">⋮----</div>
<div class="line">mainStack.Children.Add(reqHeader);</div>
<div class="line">var reqBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">var reqText = <span class="keyword">new</span> StringBuilder();</div>
<div class="line">reqText.AppendLine(<span class="stringliteral">&quot;Part Number\tQuantity (pcs)&quot;</span>);</div>
<div class="line">reqText.AppendLine(<span class="keyword">new</span> <span class="keywordtype">string</span>(<span class="charliteral">&#39;-&#39;</span>, 40));</div>
<div class="line"><span class="keywordflow">foreach</span> (var kvp <span class="keywordflow">in</span> emailData.RequestedLines.OrderBy(x =&gt; x.Key))</div>
<div class="line">⋮----</div>
<div class="line">reqText.AppendLine($<span class="stringliteral">&quot;{kvp.Key}\t{kvp.Value}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">reqBox.Text = reqText.ToString();</div>
<div class="line">mainStack.Children.Add(reqBox);</div>
<div class="line"><span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(emailData.AdditionalNotes))</div>
<div class="line">⋮----</div>
<div class="line">var notesBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">mainStack.Children.Add(notesBox);</div>
<div class="line">⋮----</div>
<div class="line">var scrollViewer = <span class="keyword">new</span> ScrollViewer</div>
<div class="line">⋮----</div>
<div class="line">var result = await dialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line">var htmlContent = _volvoService.FormatEmailAsHtml(emailData);</div>
<div class="line">⋮----</div>
<div class="line">dataPackage.SetHtmlFormat(htmlContent);</div>
<div class="line">⋮----</div>
<div class="line">dataPackage.SetText(plainText);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">string</span> BuildPlainTextEmail(Model_VolvoEmailData emailData)</div>
<div class="line">⋮----</div>
<div class="line">var text = <span class="keyword">new</span> StringBuilder();</div>
<div class="line">text.AppendLine($<span class="stringliteral">&quot;Subject: {emailData.Subject}&quot;</span>);</div>
<div class="line">text.AppendLine();</div>
<div class="line">text.AppendLine(emailData.Greeting);</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine(emailData.Message);</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine(<span class="stringliteral">&quot;**DISCREPANCIES NOTED**&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine(<span class="stringliteral">&quot;Part Number\tPacklist Qty\tReceived Qty\tDifference\tNote&quot;</span>);</div>
<div class="line">text.AppendLine(<span class="keyword">new</span> <span class="keywordtype">string</span>(<span class="charliteral">&#39;-&#39;</span>, 80));</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine($<span class="stringliteral">&quot;{disc.PartNumber}\t{disc.PacklistQty}\t{disc.ReceivedQty}\t{diffStr}\t{disc.Note}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine(<span class="stringliteral">&quot;Requested Lines:&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine(<span class="stringliteral">&quot;Part Number\tQuantity (pcs)&quot;</span>);</div>
<div class="line">text.AppendLine(<span class="keyword">new</span> <span class="keywordtype">string</span>(<span class="charliteral">&#39;-&#39;</span>, 40));</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine($<span class="stringliteral">&quot;{kvp.Key}\t{kvp.Value}&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine(<span class="stringliteral">&quot;Additional Notes:&quot;</span>);</div>
<div class="line">text.AppendLine(emailData.AdditionalNotes);</div>
<div class="line">⋮----</div>
<div class="line">text.AppendLine(emailData.Signature);</div>
<div class="line"><span class="keywordflow">return</span> text.ToString();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> ViewHistory()</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(<span class="stringliteral">&quot;Navigating to Volvo Shipment History&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">var contentFrame = mainWindow.GetContentFrame();</div>
<div class="line">⋮----</div>
<div class="line">private async Task SaveAsPendingAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;Error saving shipment: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task&lt;Model_Dao_Result&lt;(<span class="keywordtype">int</span> ShipmentId, <span class="keywordtype">int</span> ShipmentNumber)&gt;&gt; SaveShipmentInternalAsync()</div>
<div class="line">⋮----</div>
<div class="line">var shipment = new Model_VolvoShipment</div>
<div class="line">⋮----</div>
<div class="line">EmployeeNumber = _sessionManager.CurrentSession?.User?.EmployeeNumber.ToString() ?? <span class="stringliteral">&quot;0&quot;</span></div>
<div class="line">⋮----</div>
<div class="line">var saveResult = await _volvoService.SaveShipmentAsync(shipment, Parts.ToList());</div>
<div class="line">if (!saveResult.IsSuccess &amp;&amp; saveResult.ErrorMessage.StartsWith(<span class="stringliteral">&quot;PENDING_EXISTS&quot;</span>))</div>
<div class="line">⋮----</div>
<div class="line">var parts = saveResult.ErrorMessage.Split(<span class="charliteral">&#39;|&#39;</span>);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync($<span class="stringliteral">&quot;User confirmed overwrite of pending shipment #{existingShipmentNumber}&quot;</span>);</div>
<div class="line">return await _volvoService.SaveShipmentAsync(shipment, Parts.ToList(), overwriteExisting: true);</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogInfoAsync(<span class="stringliteral">&quot;User canceled shipment overwrite&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line">private async Task CompleteShipmentAsync()</div>
<div class="line">⋮----</div>
<div class="line">await _logger.LogErrorAsync($<span class="stringliteral">&quot;Error completing shipment: {ex.Message}&quot;</span>, ex);</div>
<div class="line">⋮----</div>
<div class="line">private async Task ShowCompletionDialogAsync(Model_VolvoShipment shipment)</div>
<div class="line">⋮----</div>
<div class="line">var stackPanel = new StackPanel { Spacing = 12 };</div>
<div class="line">var poTextBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">var receiverTextBox = <span class="keyword">new</span> TextBox</div>
<div class="line">⋮----</div>
<div class="line">stackPanel.Children.Add(poTextBox);</div>
<div class="line">stackPanel.Children.Add(receiverTextBox);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(poTextBox.Text) || <span class="keywordtype">string</span>.IsNullOrWhiteSpace(receiverTextBox.Text))</div>
<div class="line">⋮----</div>
<div class="line">var completeResult = await _volvoService.CompleteShipmentAsync(</div>
<div class="line">⋮----</div>
<div class="line">poTextBox.Text.Trim(),</div>
<div class="line">receiverTextBox.Text.Trim());</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> StartNewEntry()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">bool</span> ValidateShipment()</div>
<div class="line">⋮----</div>
<div class="line">_errorHandler.HandleErrorAsync(</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">true</span>).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line">⋮----</div>
<div class="line">if (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(part.PartNumber))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">string</span> FormatRecipientsFromJson(<span class="keywordtype">string</span>? jsonValue, <span class="keywordtype">string</span> fallbackValue)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(jsonValue))</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot;; &quot;</span>, recipients.Select(r =&gt; r.ToOutlookFormat()));</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogErrorAsync($<span class="stringliteral">&quot;Error parsing email recipients JSON: {ex.Message}&quot;</span>, ex).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> ValidateSaveEligibility()</div>
<div class="line">⋮----</div>
<div class="line">CanSave = Parts.Count &gt; 0 &amp;&amp; Parts.All(p =&gt; !<span class="keywordtype">string</span>.IsNullOrWhiteSpace(p.PartNumber) &amp;&amp; p.ReceivedSkidCount &gt; 0);</div>
<div class="line">⋮----</div>
<div class="line">partial <span class="keywordtype">void</span> OnPartsChanged(ObservableCollection&lt;Model_VolvoShipmentLine&gt; value)</div>
<div class="line">⋮----</div>
<div class="line">partial <span class="keywordtype">void</span> OnSelectedPartToAddChanged(Model_VolvoPart? value)</div>
<div class="line">⋮----</div>
<div class="line">AddPartCommand.NotifyCanExecuteChanged();</div>
<div class="line">⋮----</div>
<div class="line">partial <span class="keywordtype">void</span> OnReceivedSkidsToAddChanged(<span class="keywordtype">int</span> value)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> ClearShipmentForm()</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md512"></a>
File: MainWindow.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_m_t_m___receiving___application.html">MTM_Receiving_Application</a></div>
<div class="line">⋮----</div>
<div class="line">public sealed partial class MainWindow : Window</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IService_UserSessionManager _sessionManager;</div>
<div class="line"><span class="keyword">private</span> readonly IService_LoggingUtility _logger;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> Frame GetContentFrame() =&gt; ContentFrame;</div>
<div class="line">⋮----</div>
<div class="line">AppWindow.Resize(new Windows.Graphics.SizeInt32(1450, 900));</div>
<div class="line">⋮----</div>
<div class="line">rootElement.PointerMoved += (s, e) =&gt; _sessionManager.UpdateLastActivity();</div>
<div class="line">rootElement.KeyDown += (s, e) =&gt; _sessionManager.UpdateLastActivity();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void MainWindow_Closed(object sender, WindowEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">Application.Current.Exit();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void MainWindow_Activated(object sender, WindowActivatedEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">_sessionManager.UpdateLastActivity();</div>
<div class="line">⋮----</div>
<div class="line">ContentFrame.Navigate(typeof(Module_Receiving.Views.View_Receiving_Workflow));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void NavView_SelectionChanged(NavigationView sender, NavigationViewSelectionChangedEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">ContentFrame.Navigate(typeof(Module_Dunnage.Views.View_Dunnage_WorkflowView));</div>
<div class="line">⋮----</div>
<div class="line">ContentFrame.Navigate(typeof(Module_Routing.Views.RoutingModeSelectionView));</div>
<div class="line">⋮----</div>
<div class="line">ContentFrame.Navigate(typeof(Module_Volvo.Views.View_Volvo_ShipmentEntry));</div>
<div class="line">⋮----</div>
<div class="line">ContentFrame.Navigate(typeof(Module_Volvo.Views.View_Volvo_History));</div>
<div class="line">⋮----</div>
<div class="line">ContentFrame.Navigate(typeof(Module_Reporting.Views.View_Reporting_Main));</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Navigating to Settings Database Test view&quot;, &quot;MainWindow&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;ContentFrame is null - cannot navigate&quot;, null, &quot;MainWindow&quot;);</div>
<div class="line">throw new InvalidOperationException(&quot;ContentFrame is null&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;ContentFrame state: IsLoaded={ContentFrame.IsLoaded}, BackStackDepth={ContentFrame.BackStackDepth}&quot;, &quot;MainWindow&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo($&quot;View type: {viewType.FullName}&quot;, &quot;MainWindow&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Calling ContentFrame.Navigate()&quot;, &quot;MainWindow&quot;);</div>
<div class="line">var navigated = ContentFrame.Navigate(viewType);</div>
<div class="line">_logger.LogInfo($&quot;Navigation result: {navigated}&quot;, &quot;MainWindow&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError(&quot;Navigation returned false&quot;, null, &quot;MainWindow&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogInfo(&quot;Successfully navigated to Settings Database Test view&quot;, &quot;MainWindow&quot;);</div>
<div class="line">⋮----</div>
<div class="line">_logger.LogError($&quot;Failed to navigate to Settings Database Test view: {ex.Message}&quot;, ex, &quot;MainWindow&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errorDetails.AppendLine(&quot;Failed to load Settings Database Test view:&quot;);</div>
<div class="line">errorDetails.AppendLine();</div>
<div class="line">errorDetails.AppendLine($&quot;Error Type: {ex.GetType().FullName}&quot;);</div>
<div class="line">errorDetails.AppendLine($&quot;Message: {ex.Message}&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errorDetails.AppendLine(&quot;Stack Trace:&quot;);</div>
<div class="line">errorDetails.AppendLine(ex.StackTrace ?? &quot;No stack trace available&quot;);</div>
<div class="line">⋮----</div>
<div class="line">errorDetails.AppendLine(&quot;Inner Exception:&quot;);</div>
<div class="line">errorDetails.AppendLine($&quot;Type: {ex.InnerException.GetType().FullName}&quot;);</div>
<div class="line">errorDetails.AppendLine($&quot;Message: {ex.InnerException.Message}&quot;);</div>
<div class="line">errorDetails.AppendLine($&quot;Stack: {ex.InnerException.StackTrace ?? &quot;No stack trace&quot;}&quot;);</div>
<div class="line">⋮----</div>
<div class="line"><span class="comment">// Show detailed error to user in scrollable view</span></div>
<div class="line">var scrollViewer = new ScrollViewer</div>
<div class="line">⋮----</div>
<div class="line">Content = new TextBlock</div>
<div class="line">⋮----</div>
<div class="line">Text = errorDetails.ToString(),</div>
<div class="line">⋮----</div>
<div class="line">var errorDialog = new ContentDialog</div>
<div class="line">⋮----</div>
<div class="line">_ = errorDialog.ShowAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ContentFrame_Navigated(object sender, Microsoft.UI.Xaml.Navigation.NavigationEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line">DispatcherQueue.TryEnqueue(() =&gt;</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> void UpdateUserDisplay()</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void CenterWindow()</div>
<div class="line">⋮----</div>
<div class="line">AppWindow.Move(new Windows.Graphics.PointInt32(centerX, centerY));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void ConfigureTitleBar()</div>
<div class="line">⋮----</div>
<div class="line">var transparentColor = Windows.UI.Color.FromArgb(0, 0, 0, 0);</div>
<div class="line">⋮----</div>
<div class="line">var foregroundColor = Windows.UI.Color.FromArgb(255, 255, 255, 255);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> void SetTitleBarDragRegion()</div>
<div class="line">⋮----</div>
<div class="line">AppWindow.TitleBar.SetDragRectangles(new[] { dragRect });</div>
<div class="ttc" id="anamespace_m_t_m___receiving___application_html"><div class="ttname"><a href="namespace_m_t_m___receiving___application.html">MTM_Receiving_Application</a></div><div class="ttdef"><b>Definition</b> <a href="_app_8xaml_8cs_source.html#l00048">App.xaml.cs:48</a></div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md513"></a>
File: App.xaml.cs</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">partial class </span>App : Application</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> readonly IHost _host;</div>
<div class="line">⋮----</div>
<div class="line">Log.Logger = new LoggerConfiguration()</div>
<div class="line">.MinimumLevel.Information()</div>
<div class="line">.Enrich.WithMachineName()</div>
<div class="line">.Enrich.WithThreadId()</div>
<div class="line">.Enrich.WithProperty(&quot;Application&quot;, &quot;MTM_Receiving_Application&quot;)</div>
<div class="line">.Enrich.WithProperty(&quot;Environment&quot;, &quot;Production&quot;)</div>
<div class="line">.WriteTo.File(</div>
<div class="line">⋮----</div>
<div class="line">.CreateLogger();</div>
<div class="line">_host = Host.CreateDefaultBuilder()</div>
<div class="line">.ConfigureServices((context, services) =&gt;</div>
<div class="line">⋮----</div>
<div class="line">services.AddMediatR(cfg =&gt;</div>
<div class="line">⋮----</div>
<div class="line">cfg.RegisterServicesFromAssembly(Assembly.GetExecutingAssembly());</div>
<div class="line">cfg.AddBehavior(typeof(IPipelineBehavior&lt;,&gt;), typeof(LoggingBehavior&lt;,&gt;));</div>
<div class="line">cfg.AddBehavior(typeof(IPipelineBehavior&lt;,&gt;), typeof(ValidationBehavior&lt;,&gt;));</div>
<div class="line">cfg.AddBehavior(typeof(IPipelineBehavior&lt;,&gt;), typeof(AuditBehavior&lt;,&gt;));</div>
<div class="line">⋮----</div>
<div class="line">services.AddValidatorsFromAssembly(Assembly.GetExecutingAssembly());</div>
<div class="line">⋮----</div>
<div class="line">var mySqlConnectionString = Helper_Database_Variables.GetConnectionString();</div>
<div class="line">var inforVisualConnectionString = Helper_Database_Variables.GetInforVisualConnectionString();</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_User(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_ReceivingLoad(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_ReceivingLine(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_PackageTypePreference(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_DunnageLoad(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_DunnageType(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_DunnagePart(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_DunnageSpec(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_InventoriedDunnage(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_DunnageCustomField(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_DunnageUserPreference(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_RoutingLabel(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_RoutingRecipient(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_RoutingOtherReason(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_RoutingUsageTracking(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_RoutingUserPreference(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_RoutingLabelHistory(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new <a class="code hl_namespace" href="namespace_m_t_m___receiving___application.html">MTM_Receiving_Application</a>.Module_Routing.Data.Dao_InforVisualPO(inforVisualConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_VolvoShipment(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_VolvoShipmentLine(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_VolvoPart(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Dao_VolvoPartComponent(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Module_Settings.Data.Dao_SystemSettings(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Module_Settings.Data.Dao_UserSettings(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Module_Settings.Data.Dao_PackageType(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Module_Settings.Data.Dao_PackageTypeMappings(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Module_Settings.Data.Dao_RoutingRule(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Module_Settings.Data.Dao_ScheduledReport(mySqlConnectionString));</div>
<div class="line">services.AddSingleton(sp =&gt; new Module_Settings.Data.Dao_SettingsAuditLog(mySqlConnectionString));</div>
<div class="line">⋮----</div>
<div class="line">return new RoutingService(daoLabel, daoHistory, inforVisualService, usageTrackingService, recipientService, logger, configuration);</div>
<div class="line">⋮----</div>
<div class="line">return new RoutingInforVisualService(daoInforVisual, logger, useMockData);</div>
<div class="line">⋮----</div>
<div class="line">return new RoutingRecipientService(daoRecipient, logger);</div>
<div class="line">⋮----</div>
<div class="line">return new RoutingUsageTrackingService(daoUsageTracking, logger);</div>
<div class="line">⋮----</div>
<div class="line">return new RoutingUserPreferenceService(daoUserPreference, logger);</div>
<div class="line">⋮----</div>
<div class="line">services.AddSingleton(sp =&gt;</div>
<div class="line">⋮----</div>
<div class="line">return new Dao_InforVisualPart(inforVisualConnectionString, logger);</div>
<div class="line">⋮----</div>
<div class="line">var dispatcherQueue = Microsoft.UI.Dispatching.DispatcherQueue.GetForCurrentThread();</div>
<div class="line">return new Service_Dispatcher(dispatcherQueue);</div>
<div class="line">⋮----</div>
<div class="line">return new Service_Authentication(daoUser, errorHandler);</div>
<div class="line">⋮----</div>
<div class="line">return new Service_UserSessionManager(daoUser, dispatcherService);</div>
<div class="line">⋮----</div>
<div class="line">return new Dao_InforVisualConnection(</div>
<div class="line">Helper_Database_Variables.GetInforVisualConnectionString(), logger);</div>
<div class="line">⋮----</div>
<div class="line">return new Service_InforVisualConnect(dao, useMockData, logger);</div>
<div class="line">⋮----</div>
<div class="line">services.AddSingleton&lt;IService_MySQL_Receiving&gt;(sp =&gt; { var logger = sp.GetRequiredService&lt;IService_LoggingUtility&gt;(); <span class="keywordflow">return</span> <span class="keyword">new</span> Service_MySQL_Receiving(Helper_Database_Variables.GetConnectionString(), logger); });</div>
<div class="line">⋮----</div>
<div class="line">services.AddSingleton&lt;IService_MySQL_PackagePreferences&gt;(sp =&gt; <span class="keyword">new</span> Service_MySQL_PackagePreferences(Helper_Database_Variables.GetConnectionString()));</div>
<div class="line">services.AddSingleton&lt;IService_SessionManager&gt;(sp =&gt; { var logger = sp.GetRequiredService&lt;IService_LoggingUtility&gt;(); <span class="keywordflow">return</span> <span class="keyword">new</span> Service_SessionManager(logger); });</div>
<div class="line">services.AddSingleton&lt;IService_CSVWriter&gt;(sp =&gt; { var sessionManager = sp.GetRequiredService&lt;IService_UserSessionManager&gt;(); var logger = sp.GetRequiredService&lt;IService_LoggingUtility&gt;(); <span class="keywordflow">return</span> <span class="keyword">new</span> Service_CSVWriter(sessionManager, logger); });</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Service_VolvoAuthorization(logger);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Service_Volvo(shipmentDao, lineDao, partDao, componentDao, logger, authService);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Service_VolvoMasterData(partDao, componentDao, logger, errorHandler);</div>
<div class="line">⋮----</div>
<div class="line">services.AddSingleton(sp =&gt; <span class="keyword">new</span> Dao_Reporting(mySqlConnectionString));</div>
<div class="line">⋮----</div>
<div class="line"><span class="keywordflow">return</span> <span class="keyword">new</span> Service_Reporting(dao, logger);</div>
<div class="line">⋮----</div>
<div class="line">.Build();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">protected</span> <span class="keyword">override</span> async <span class="keywordtype">void</span> OnLaunched(LaunchActivatedEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">await startupService.StartAsync();</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> OnSessionTimedOut(<span class="keywordtype">object</span>? sender, Model_SessionTimedOutEventArgs e)</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">private</span> async <span class="keywordtype">void</span> OnMainWindowClosed(<span class="keywordtype">object</span> sender, WindowEventArgs args)</div>
<div class="line">⋮----</div>
<div class="line">await sessionManager.EndSessionAsync(<span class="stringliteral">&quot;manual_close&quot;</span>);</div>
<div class="line">⋮----</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">static</span> T GetService&lt;T&gt;() where T : class</div>
<div class="line">⋮----</div>
<div class="line">?? throw new InvalidOperationException($<span class="stringliteral">&quot;Service {typeof(T)} not found&quot;</span>);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
