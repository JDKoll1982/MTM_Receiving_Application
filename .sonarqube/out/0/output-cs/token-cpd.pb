«%
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Shared\Shared_SplashScreenWindow.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Shared* 0
{ 
public 

sealed 
partial 
class %
Shared_SplashScreenWindow  9
:: ;
Window< B
{ 
private 
const 
int 
WindowWidth %
=& '
$num( +
;+ ,
private 
const 
int 
WindowHeight &
=' (
$num) ,
;, -
public (
Shared_SplashScreenViewModel +
	ViewModel, 5
{6 7
get8 ;
;; <
}= >
public 
bool 
IsProgrammaticClose '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
=6 7
false8 =
;= >
public %
Shared_SplashScreenWindow (
(( )(
Shared_SplashScreenViewModel) E
	viewModelF O
)O P
{ 	
	ViewModel 
= 
	viewModel !
;! "
InitializeComponent 
(  
)  !
;! "
	ViewModel 
. 
PropertyChanged %
+=& (%
ViewModel_PropertyChanged) B
;B C
ConfigureWindow"" 
("" 
)"" 
;"" 
this%% 
.%% 
Closed%% 
+=%% %
SplashScreenWindow_Closed%% 4
;%%4 5
}&& 	
private(( 
void(( %
SplashScreenWindow_Closed(( .
(((. /
object((/ 5
sender((6 <
,((< =
WindowEventArgs((> M
args((N R
)((R S
{)) 	
if,, 
(,, 
!,, 
IsProgrammaticClose,, $
),,$ %
{-- 
Application.. 
... 
Current.. #
...# $
Exit..$ (
(..( )
)..) *
;..* +
}// 
}00 	
private55 
void55 
ConfigureWindow55 $
(55$ %
)55% &
{66 	
this88 
.88 
UseCustomTitleBar88 "
(88" #
)88# $
;88$ %
this99 
.99 
HideTitleBarIcon99 !
(99! "
)99" #
;99# $
this:: 
.:: #
MakeTitleBarTransparent:: (
(::( )
)::) *
;::* +
this== 
.== 
SetWindowSize== 
(== 
WindowWidth== *
,==* +
WindowHeight==, 8
)==8 9
;==9 :
this>> 
.>> 
SetFixedSize>> 
(>> 
disableMaximize>> -
:>>- .
true>>/ 3
,>>3 4
disableMinimize>>5 D
:>>D E
true>>F J
)>>J K
;>>K L
thisAA 
.AA 
CenterOnScreenAA 
(AA  
)AA  !
;AA! "
}BB 	
privateGG 
voidGG %
ViewModel_PropertyChangedGG .
(GG. /
objectGG/ 5
?GG5 6
senderGG7 =
,GG= >
SystemGG? E
.GGE F
ComponentModelGGF T
.GGT U$
PropertyChangedEventArgsGGU m
eGGn o
)GGo p
{HH 	
DispatcherQueueII 
.II 

TryEnqueueII &
(II& '
	MicrosoftII' 0
.II0 1
UIII1 3
.II3 4
DispatchingII4 ?
.II? @#
DispatcherQueuePriorityII@ W
.IIW X
NormalIIX ^
,II^ _
(II` a
)IIa b
=>IIc e
{JJ "
StatusMessageTextBlockKK &
.KK& '
TextKK' +
=KK, -
	ViewModelKK. 7
.KK7 8
StatusMessageKK8 E
;KKE F
MainProgressBarLL 
.LL  
ValueLL  %
=LL& '
	ViewModelLL( 1
.LL1 2
ProgressPercentageLL2 D
;LLD E
MainProgressBarMM 
.MM  
IsIndeterminateMM  /
=MM0 1
	ViewModelMM2 ;
.MM; <
IsIndeterminateMM< K
;MMK L'
ProgressPercentageTextBlockNN +
.NN+ ,
TextNN, 0
=NN1 2
	ViewModelNN3 <
.NN< =
IsIndeterminateNN= L
?NNM N
$strNNO Q
:NNR S
$"NNT V
{NNV W
	ViewModelNNW `
.NN` a
ProgressPercentageNNa s
}NNs t
$strNNt u
"NNu v
;NNv w
}OO 
)OO 
;OO 
}PP 	
}QQ 
}RR ©N
kC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Shared\Shared_SharedTerminalLoginDialog.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Shared* 0
{ 
public 

sealed 
partial 
class ,
 Shared_SharedTerminalLoginDialog  @
:A B
ContentDialogC P
{ 
public /
#Shared_SharedTerminalLoginViewModel 2
	ViewModel3 <
{= >
get? B
;B C
}D E
private 
int 
_attemptCount !
=" #
$num$ %
;% &
private 
const 
int 
MaxAttempts %
=& '
$num( )
;) *
public ,
 Shared_SharedTerminalLoginDialog /
(/ 0/
#Shared_SharedTerminalLoginViewModel0 S
	viewModelT ]
)] ^
{ 	
InitializeComponent 
(  
)  !
;! "
	ViewModel 
= 
	viewModel !
??" $
throw% *
new+ .!
ArgumentNullException/ D
(D E
nameofE K
(K L
	viewModelL U
)U V
)V W
;W X
PrimaryButtonClick 
+= ! 
OnPrimaryButtonClick" 6
;6 7
CloseButtonClick 
+= 
OnCloseButtonClick  2
;2 3
Loaded 
+= 
( 
s 
, 
e 
) 
=> 
UsernameTextBox  /
./ 0
Focus0 5
(5 6

FocusState6 @
.@ A
ProgrammaticA M
)M N
;N O
} 	
private## 
async## 
void##  
OnPrimaryButtonClick## /
(##/ 0
ContentDialog##0 =
sender##> D
,##D E-
!ContentDialogButtonClickEventArgs##F g
args##h l
)##l m
{$$ 	
args%% 
.%% 
Cancel%% 
=%% 
true%% 
;%% 
ErrorInfoBar(( 
.(( 
IsOpen(( 
=((  !
false((" '
;((' (
string++ 
username++ 
=++ 
UsernameTextBox++ -
.++- .
Text++. 2
?++2 3
.++3 4
Trim++4 8
(++8 9
)++9 :
??++; =
string++> D
.++D E
Empty++E J
;++J K
string,, 
pin,, 
=,, 
PinPasswordBox,, '
.,,' (
Password,,( 0
?,,0 1
.,,1 2
Trim,,2 6
(,,6 7
),,7 8
??,,9 ;
string,,< B
.,,B C
Empty,,C H
;,,H I
if.. 
(.. 
string.. 
... 
IsNullOrWhiteSpace.. )
(..) *
username..* 2
)..2 3
)..3 4
{// 
ErrorInfoBar00 
.00 
Title00 "
=00# $
$str00% 7
;007 8
ErrorInfoBar11 
.11 
Message11 $
=11% &
$str11' >
;11> ?
ErrorInfoBar22 
.22 
IsOpen22 #
=22$ %
true22& *
;22* +
UsernameTextBox33 
.33  
Focus33  %
(33% &

FocusState33& 0
.330 1
Programmatic331 =
)33= >
;33> ?
return44 
;44 
}55 
if77 
(77 
string77 
.77 
IsNullOrWhiteSpace77 )
(77) *
pin77* -
)77- .
)77. /
{88 
ErrorInfoBar99 
.99 
Title99 "
=99# $
$str99% 7
;997 8
ErrorInfoBar:: 
.:: 
Message:: $
=::% &
$str::' 9
;::9 :
ErrorInfoBar;; 
.;; 
IsOpen;; #
=;;$ %
true;;& *
;;;* +
PinPasswordBox<< 
.<< 
Focus<< $
(<<$ %

FocusState<<% /
.<</ 0
Programmatic<<0 <
)<<< =
;<<= >
return== 
;== 
}>> 
if@@ 
(@@ 
pin@@ 
.@@ 
Length@@ 
!=@@ 
$num@@ 
||@@  "
!@@# $
int@@$ '
.@@' (
TryParse@@( 0
(@@0 1
pin@@1 4
,@@4 5
out@@6 9
_@@: ;
)@@; <
)@@< =
{AA 
ErrorInfoBarBB 
.BB 
TitleBB "
=BB# $
$strBB% 7
;BB7 8
ErrorInfoBarCC 
.CC 
MessageCC $
=CC% &
$strCC' N
;CCN O
ErrorInfoBarDD 
.DD 
IsOpenDD #
=DD$ %
trueDD& *
;DD* +
PinPasswordBoxEE 
.EE 
PasswordEE '
=EE( )
stringEE* 0
.EE0 1
EmptyEE1 6
;EE6 7
PinPasswordBoxFF 
.FF 
FocusFF $
(FF$ %

FocusStateFF% /
.FF/ 0
ProgrammaticFF0 <
)FF< =
;FF= >
returnGG 
;GG 
}HH 
	ViewModelKK 
.KK 
UsernameKK 
=KK  
usernameKK! )
;KK) *
	ViewModelLL 
.LL 
PinLL 
=LL 
pinLL 
;LL  
boolNN 
successNN 
=NN 
awaitNN  
	ViewModelNN! *
.NN* +

LoginAsyncNN+ 5
(NN5 6
)NN6 7
;NN7 8
ifPP 
(PP 
successPP 
)PP 
{QQ 
HideSS 
(SS 
)SS 
;SS 
}TT 
elseUU 
{VV 
_attemptCountXX 
++XX 
;XX  
	ViewModelYY 
.YY 
AttemptCountYY &
=YY' (
_attemptCountYY) 6
;YY6 7
PinPasswordBox\\ 
.\\ 
Password\\ '
=\\( )
string\\* 0
.\\0 1
Empty\\1 6
;\\6 7
PinPasswordBox]] 
.]] 
Focus]] $
(]]$ %

FocusState]]% /
.]]/ 0
Programmatic]]0 <
)]]< =
;]]= >
ErrorInfoBar`` 
.`` 
Title`` "
=``# $
$str``% 3
;``3 4
ErrorInfoBaraa 
.aa 
Messageaa $
=aa% &
	ViewModelaa' 0
.aa0 1
ErrorMessageaa1 =
??aa> @
$straaA m
;aam n
ErrorInfoBarbb 
.bb 
IsOpenbb #
=bb$ %
truebb& *
;bb* +
ifee 
(ee 
_attemptCountee !
<ee" #
MaxAttemptsee$ /
)ee/ 0
{ff #
AttemptCounterTextBlockgg +
.gg+ ,
Textgg, 0
=gg1 2
$"gg3 5
$strgg5 =
{gg= >
_attemptCountgg> K
}ggK L
$strggL P
{ggP Q
MaxAttemptsggQ \
}gg\ ]
"gg] ^
;gg^ _#
AttemptCounterTextBlockhh +
.hh+ ,

Visibilityhh, 6
=hh7 8

Visibilityhh9 C
.hhC D
VisiblehhD K
;hhK L
}ii 
elsejj 
{kk #
AttemptCounterTextBlockmm +
.mm+ ,

Foregroundmm, 6
=mm7 8
newmm9 <
	Microsoftmm= F
.mmF G
UImmG I
.mmI J
XamlmmJ N
.mmN O
MediammO T
.mmT U
SolidColorBrushmmU d
(mmd e
	Microsoftnn !
.nn! "
UInn" $
.nn$ %
Colorsnn% +
.nn+ ,
Rednn, /
)nn/ 0
;nn0 1#
AttemptCounterTextBlockoo +
.oo+ ,
Textoo, 0
=oo1 2
$stroo3 w
;oow x#
AttemptCounterTextBlockpp +
.pp+ ,

Visibilitypp, 6
=pp7 8

Visibilitypp9 C
.ppC D
VisibleppD K
;ppK L
ErrorInfoBarrr  
.rr  !
Titlerr! &
=rr' (
$strrr) 9
;rr9 :
ErrorInfoBarss  
.ss  !
Messagess! (
=ss) *
$strss+ h
;ssh i
ErrorInfoBartt  
.tt  !
Severitytt! )
=tt* +
InfoBarSeveritytt, ;
.tt; <
Errortt< A
;ttA B
ErrorInfoBaruu  
.uu  !
IsOpenuu! '
=uu( )
trueuu* .
;uu. /
UsernameTextBoxxx #
.xx# $
	IsEnabledxx$ -
=xx. /
falsexx0 5
;xx5 6
PinPasswordBoxyy "
.yy" #
	IsEnabledyy# ,
=yy- .
falseyy/ 4
;yy4 5"
IsPrimaryButtonEnabledzz *
=zz+ ,
falsezz- 2
;zz2 3$
IsSecondaryButtonEnabled{{ ,
={{- .
false{{/ 4
;{{4 5
await~~ 
System~~  
.~~  !
	Threading~~! *
.~~* +
Tasks~~+ 0
.~~0 1
Task~~1 5
.~~5 6
Delay~~6 ;
(~~; <
$num~~< @
)~~@ A
;~~A B
	ViewModel
ÅÅ 
.
ÅÅ 
IsLockedOut
ÅÅ )
=
ÅÅ* +
true
ÅÅ, 0
;
ÅÅ0 1
Hide
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 
}
ÑÑ 
}
ÖÖ 	
private
ää 
void
ää  
OnCloseButtonClick
ää '
(
ää' (
ContentDialog
ää( 5
sender
ää6 <
,
ää< =/
!ContentDialogButtonClickEventArgs
ää> _
args
ää` d
)
ääd e
{
ãã 	
	ViewModel
çç 
.
çç 
IsCancelled
çç !
=
çç" #
true
çç$ (
;
çç( )
}
éé 	
}
èè 
}êê Èº
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Shared\Shared_NewUserSetupDialog.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Shared* 0
{ 
public 

sealed 
partial 
class %
Shared_NewUserSetupDialog  9
:: ;
ContentDialog< I
{ 
public (
Shared_NewUserSetupViewModel +
	ViewModel, 5
{6 7
get8 ;
;; <
}= >
public %
Shared_NewUserSetupDialog (
(( )(
Shared_NewUserSetupViewModel) E
	viewModelF O
)O P
{ 	
InitializeComponent 
(  
)  !
;! "
	ViewModel 
= 
	viewModel !
??" $
throw% *
new+ .!
ArgumentNullException/ D
(D E
nameofE K
(K L
	viewModelL U
)U V
)V W
;W X
PrimaryButtonClick 
+= !&
OnCreateAccountButtonClick" <
;< =
CloseButtonClick 
+= 
OnCancelButtonClick  3
;3 4
Closing 
+= 
OnDialogClosing &
;& '
Loaded 
+= 
OnDialogLoaded $
;$ %
} 	
private## 
void## 
OnDialogClosing## $
(##$ %
ContentDialog##% 2
sender##3 9
,##9 :)
ContentDialogClosingEventArgs##; X
args##Y ]
)##] ^
{$$ 	
if&& 
(&& 
args&& 
.&& 
Result&& 
!=&& 
ContentDialogResult&& 2
.&&2 3
Primary&&3 :
)&&: ;
{'' 
	ViewModel(( 
.(( 
IsCancelled(( %
=((& '
true((( ,
;((, -
})) 
}** 	
private// 
async// 
void// 
OnDialogLoaded// )
(//) *
object//* 0
sender//1 7
,//7 8
RoutedEventArgs//9 H
e//I J
)//J K
{00 	"
WindowsUsernameTextBox22 "
.22" #
Text22# '
=22( )
	ViewModel22* 3
.223 4
WindowsUsername224 C
;22C D
await55  
LoadDepartmentsAsync55 &
(55& '
)55' (
;55( )
FullNameTextBox88 
.88 
Focus88 !
(88! "

FocusState88" ,
.88, -
Programmatic88- 9
)889 :
;88: ;
}99 	
private>> 
async>> 
System>> 
.>> 
	Threading>> &
.>>& '
Tasks>>' ,
.>>, -
Task>>- 1 
LoadDepartmentsAsync>>2 F
(>>F G
)>>G H
{?? 	
try@@ 
{AA 
awaitBB 
	ViewModelBB 
.BB   
LoadDepartmentsAsyncBB  4
(BB4 5
)BB5 6
;BB6 7
DepartmentComboBoxEE "
.EE" #
ItemsEE# (
.EE( )
ClearEE) .
(EE. /
)EE/ 0
;EE0 1
foreachGG 
(GG 
varGG 
deptGG !
inGG" $
	ViewModelGG% .
.GG. /
DepartmentsGG/ :
)GG: ;
{HH 
DepartmentComboBoxII &
.II& '
ItemsII' ,
.II, -
AddII- 0
(II0 1
deptII1 5
)II5 6
;II6 7
}JJ 
DepartmentComboBoxMM "
.MM" #
ItemsMM# (
.MM( )
AddMM) ,
(MM, -
$strMM- 4
)MM4 5
;MM5 6
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
{PP 
StatusInfoBarQQ 
.QQ 
TitleQQ #
=QQ$ %
$strQQ& A
;QQA B
StatusInfoBarRR 
.RR 
MessageRR %
=RR& '
$"RR( *
$strRR* F
{RRF G
exRRG I
.RRI J
MessageRRJ Q
}RRQ R
"RRR S
;RRS T
StatusInfoBarSS 
.SS 
SeveritySS &
=SS' (
InfoBarSeveritySS) 8
.SS8 9
WarningSS9 @
;SS@ A
StatusInfoBarTT 
.TT 
IsOpenTT $
=TT% &
trueTT' +
;TT+ ,
}UU 
}VV 	
private[[ 
void[[ /
#DepartmentComboBox_SelectionChanged[[ 8
([[8 9
object[[9 ?
sender[[@ F
,[[F G%
SelectionChangedEventArgs[[H a
e[[b c
)[[c d
{\\ 	
if]] 
(]] 
DepartmentComboBox]] "
.]]" #
SelectedItem]]# /
!=]]0 2
null]]3 7
)]]7 8
{^^ 
string__ 
selectedDept__ #
=__$ %
DepartmentComboBox__& 8
.__8 9
SelectedItem__9 E
.__E F
ToString__F N
(__N O
)__O P
??__Q S
string__T Z
.__Z [
Empty__[ `
;__` a
ifbb 
(bb 
selectedDeptbb  
==bb! #
$strbb$ +
)bb+ ,
{cc !
CustomDepartmentPaneldd )
.dd) *

Visibilitydd* 4
=dd5 6

Visibilitydd7 A
.ddA B
VisibleddB I
;ddI J
	ViewModelee 
.ee  
ShowCustomDepartmentee 2
=ee3 4
trueee5 9
;ee9 :#
CustomDepartmentTextBoxff +
.ff+ ,
Focusff, 1
(ff1 2

FocusStateff2 <
.ff< =
Programmaticff= I
)ffI J
;ffJ K
}gg 
elsehh 
{ii !
CustomDepartmentPaneljj )
.jj) *

Visibilityjj* 4
=jj5 6

Visibilityjj7 A
.jjA B
	CollapsedjjB K
;jjK L
	ViewModelkk 
.kk  
ShowCustomDepartmentkk 2
=kk3 4
falsekk5 :
;kk: ;
	ViewModelll 
.ll 

Departmentll (
=ll) *
selectedDeptll+ 7
;ll7 8
}mm 
}nn 
}oo 	
privatett 
voidtt (
ConfigureErpCheckBox_Checkedtt 1
(tt1 2
objecttt2 8
sendertt9 ?
,tt? @
RoutedEventArgsttA P
ettQ R
)ttR S
{uu 	
ErpCredentialsPanelvv 
.vv  

Visibilityvv  *
=vv+ ,

Visibilityvv- 7
.vv7 8
Visiblevv8 ?
;vv? @
	ViewModelww 
.ww 
ConfigureErpAccessww (
=ww) *
trueww+ /
;ww/ 0
ifzz 
(zz 
!zz 
ErpExpanderzz 
.zz 

IsExpandedzz '
)zz' (
{{{ 
ErpExpander|| 
.|| 

IsExpanded|| &
=||' (
true||) -
;||- .
}}} 
_
ÄÄ 
=
ÄÄ 
DispatcherQueue
ÄÄ 
.
ÄÄ  

TryEnqueue
ÄÄ  *
(
ÄÄ* +
	Microsoft
ÄÄ+ 4
.
ÄÄ4 5
UI
ÄÄ5 7
.
ÄÄ7 8
Dispatching
ÄÄ8 C
.
ÄÄC D%
DispatcherQueuePriority
ÄÄD [
.
ÄÄ[ \
Normal
ÄÄ\ b
,
ÄÄb c
(
ÄÄd e
)
ÄÄe f
=>
ÄÄg i
{
ÅÅ #
VisualUsernameTextBox
ÇÇ %
.
ÇÇ% &
Focus
ÇÇ& +
(
ÇÇ+ ,

FocusState
ÇÇ, 6
.
ÇÇ6 7
Programmatic
ÇÇ7 C
)
ÇÇC D
;
ÇÇD E
}
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
private
ââ 
void
ââ ,
ConfigureErpCheckBox_Unchecked
ââ 3
(
ââ3 4
object
ââ4 :
sender
ââ; A
,
ââA B
RoutedEventArgs
ââC R
e
ââS T
)
ââT U
{
ää 	!
ErpCredentialsPanel
ãã 
.
ãã  

Visibility
ãã  *
=
ãã+ ,

Visibility
ãã- 7
.
ãã7 8
	Collapsed
ãã8 A
;
ããA B
	ViewModel
åå 
.
åå  
ConfigureErpAccess
åå (
=
åå) *
false
åå+ 0
;
åå0 1#
VisualUsernameTextBox
èè !
.
èè! "
Text
èè" &
=
èè' (
string
èè) /
.
èè/ 0
Empty
èè0 5
;
èè5 6
VisualPasswordBox
êê 
.
êê 
Password
êê &
=
êê' (
string
êê) /
.
êê/ 0
Empty
êê0 5
;
êê5 6
}
ëë 	
private
ññ 
async
ññ 
void
ññ (
OnCreateAccountButtonClick
ññ 5
(
ññ5 6
ContentDialog
ññ6 C
sender
ññD J
,
ññJ K/
!ContentDialogButtonClickEventArgs
ññL m
args
ññn r
)
ññr s
{
óó 	
args
òò 
.
òò 
Cancel
òò 
=
òò 
true
òò 
;
òò 
StatusInfoBar
õõ 
.
õõ 
IsOpen
õõ  
=
õõ! "
false
õõ# (
;
õõ( )
string
ûû 
employeeNumber
ûû !
=
ûû" ##
EmployeeNumberTextBox
ûû$ 9
.
ûû9 :
Text
ûû: >
?
ûû> ?
.
ûû? @
Trim
ûû@ D
(
ûûD E
)
ûûE F
??
ûûG I
string
ûûJ P
.
ûûP Q
Empty
ûûQ V
;
ûûV W
string
üü 
fullName
üü 
=
üü 
FullNameTextBox
üü -
.
üü- .
Text
üü. 2
?
üü2 3
.
üü3 4
Trim
üü4 8
(
üü8 9
)
üü9 :
??
üü; =
string
üü> D
.
üüD E
Empty
üüE J
;
üüJ K
string
†† 

department
†† 
=
††  
DepartmentComboBox
††  2
.
††2 3
SelectedItem
††3 ?
?
††? @
.
††@ A
ToString
††A I
(
††I J
)
††J K
??
††L N
string
††O U
.
††U V
Empty
††V [
;
††[ \
string
°° 
customDepartment
°° #
=
°°$ %%
CustomDepartmentTextBox
°°& =
.
°°= >
Text
°°> B
?
°°B C
.
°°C D
Trim
°°D H
(
°°H I
)
°°I J
??
°°K M
string
°°N T
.
°°T U
Empty
°°U Z
;
°°Z [
string
¢¢ 
shift
¢¢ 
=
¢¢ 
(
¢¢ 
ShiftComboBox
¢¢ )
.
¢¢) *
SelectedItem
¢¢* 6
as
¢¢7 9
ComboBoxItem
¢¢: F
)
¢¢F G
?
¢¢G H
.
¢¢H I
Content
¢¢I P
?
¢¢P Q
.
¢¢Q R
ToString
¢¢R Z
(
¢¢Z [
)
¢¢[ \
??
¢¢] _
string
¢¢` f
.
¢¢f g
Empty
¢¢g l
;
¢¢l m
string
££ 
pin
££ 
=
££ 
PinPasswordBox
££ '
.
££' (
Password
££( 0
?
££0 1
.
££1 2
Trim
££2 6
(
££6 7
)
££7 8
??
££9 ;
string
££< B
.
££B C
Empty
££C H
;
££H I
string
§§ 

confirmPin
§§ 
=
§§ #
ConfirmPinPasswordBox
§§  5
.
§§5 6
Password
§§6 >
?
§§> ?
.
§§? @
Trim
§§@ D
(
§§D E
)
§§E F
??
§§G I
string
§§J P
.
§§P Q
Empty
§§Q V
;
§§V W
if
ßß 
(
ßß 

department
ßß 
==
ßß 
$str
ßß %
)
ßß% &
{
®® 

department
©© 
=
©© 
customDepartment
©© -
;
©©- .
}
™™ 
if
≠≠ 
(
≠≠ 
string
≠≠ 
.
≠≠  
IsNullOrWhiteSpace
≠≠ )
(
≠≠) *
employeeNumber
≠≠* 8
)
≠≠8 9
)
≠≠9 :
{
ÆÆ !
ShowValidationError
ØØ #
(
ØØ# $
$str
ØØ$ B
)
ØØB C
;
ØØC D#
EmployeeNumberTextBox
∞∞ %
.
∞∞% &
Focus
∞∞& +
(
∞∞+ ,

FocusState
∞∞, 6
.
∞∞6 7
Programmatic
∞∞7 C
)
∞∞C D
;
∞∞D E
return
±± 
;
±± 
}
≤≤ 
if
¥¥ 
(
¥¥ 
!
¥¥ 
int
¥¥ 
.
¥¥ 
TryParse
¥¥ 
(
¥¥ 
employeeNumber
¥¥ ,
,
¥¥, -
out
¥¥. 1
int
¥¥2 5
empNum
¥¥6 <
)
¥¥< =
||
¥¥> @
empNum
¥¥A G
<=
¥¥H J
$num
¥¥K L
)
¥¥L M
{
µµ !
ShowValidationError
∂∂ #
(
∂∂# $
$str
∂∂$ P
)
∂∂P Q
;
∂∂Q R#
EmployeeNumberTextBox
∑∑ %
.
∑∑% &
Focus
∑∑& +
(
∑∑+ ,

FocusState
∑∑, 6
.
∑∑6 7
Programmatic
∑∑7 C
)
∑∑C D
;
∑∑D E
return
∏∏ 
;
∏∏ 
}
ππ 
if
ªª 
(
ªª 
string
ªª 
.
ªª  
IsNullOrWhiteSpace
ªª )
(
ªª) *
fullName
ªª* 2
)
ªª2 3
)
ªª3 4
{
ºº !
ShowValidationError
ΩΩ #
(
ΩΩ# $
$str
ΩΩ$ <
)
ΩΩ< =
;
ΩΩ= >
FullNameTextBox
ææ 
.
ææ  
Focus
ææ  %
(
ææ% &

FocusState
ææ& 0
.
ææ0 1
Programmatic
ææ1 =
)
ææ= >
;
ææ> ?
return
øø 
;
øø 
}
¿¿ 
if
¬¬ 
(
¬¬ 
fullName
¬¬ 
.
¬¬ 
Length
¬¬ 
<
¬¬  !
$num
¬¬" #
)
¬¬# $
{
√√ !
ShowValidationError
ƒƒ #
(
ƒƒ# $
$str
ƒƒ$ N
)
ƒƒN O
;
ƒƒO P
FullNameTextBox
≈≈ 
.
≈≈  
Focus
≈≈  %
(
≈≈% &

FocusState
≈≈& 0
.
≈≈0 1
Programmatic
≈≈1 =
)
≈≈= >
;
≈≈> ?
return
∆∆ 
;
∆∆ 
}
«« 
if
…… 
(
…… 
string
…… 
.
……  
IsNullOrWhiteSpace
…… )
(
……) *

department
……* 4
)
……4 5
)
……5 6
{
   !
ShowValidationError
ÀÀ #
(
ÀÀ# $
$str
ÀÀ$ =
)
ÀÀ= >
;
ÀÀ> ? 
DepartmentComboBox
ÃÃ "
.
ÃÃ" #
Focus
ÃÃ# (
(
ÃÃ( )

FocusState
ÃÃ) 3
.
ÃÃ3 4
Programmatic
ÃÃ4 @
)
ÃÃ@ A
;
ÃÃA B
return
ÕÕ 
;
ÕÕ 
}
ŒŒ 
if
–– 
(
–– 
string
–– 
.
––  
IsNullOrWhiteSpace
–– )
(
––) *
shift
––* /
)
––/ 0
)
––0 1
{
—— !
ShowValidationError
““ #
(
““# $
$str
““$ 8
)
““8 9
;
““9 :
ShiftComboBox
”” 
.
”” 
Focus
”” #
(
””# $

FocusState
””$ .
.
””. /
Programmatic
””/ ;
)
””; <
;
””< =
return
‘‘ 
;
‘‘ 
}
’’ 
if
◊◊ 
(
◊◊ 
string
◊◊ 
.
◊◊  
IsNullOrWhiteSpace
◊◊ )
(
◊◊) *
pin
◊◊* -
)
◊◊- .
)
◊◊. /
{
ÿÿ !
ShowValidationError
ŸŸ #
(
ŸŸ# $
$str
ŸŸ$ 6
)
ŸŸ6 7
;
ŸŸ7 8
PinPasswordBox
⁄⁄ 
.
⁄⁄ 
Focus
⁄⁄ $
(
⁄⁄$ %

FocusState
⁄⁄% /
.
⁄⁄/ 0
Programmatic
⁄⁄0 <
)
⁄⁄< =
;
⁄⁄= >
return
€€ 
;
€€ 
}
‹‹ 
if
ﬁﬁ 
(
ﬁﬁ 
pin
ﬁﬁ 
.
ﬁﬁ 
Length
ﬁﬁ 
!=
ﬁﬁ 
$num
ﬁﬁ 
||
ﬁﬁ  "
!
ﬁﬁ# $
pin
ﬁﬁ$ '
.
ﬁﬁ' (
All
ﬁﬁ( +
(
ﬁﬁ+ ,
char
ﬁﬁ, 0
.
ﬁﬁ0 1
IsDigit
ﬁﬁ1 8
)
ﬁﬁ8 9
)
ﬁﬁ9 :
{
ﬂﬂ !
ShowValidationError
‡‡ #
(
‡‡# $
$str
‡‡$ K
)
‡‡K L
;
‡‡L M
PinPasswordBox
·· 
.
·· 
Password
·· '
=
··( )
string
··* 0
.
··0 1
Empty
··1 6
;
··6 7#
ConfirmPinPasswordBox
‚‚ %
.
‚‚% &
Password
‚‚& .
=
‚‚/ 0
string
‚‚1 7
.
‚‚7 8
Empty
‚‚8 =
;
‚‚= >
PinPasswordBox
„„ 
.
„„ 
Focus
„„ $
(
„„$ %

FocusState
„„% /
.
„„/ 0
Programmatic
„„0 <
)
„„< =
;
„„= >
return
‰‰ 
;
‰‰ 
}
ÂÂ 
if
ÁÁ 
(
ÁÁ 
pin
ÁÁ 
!=
ÁÁ 

confirmPin
ÁÁ !
)
ÁÁ! "
{
ËË !
ShowValidationError
ÈÈ #
(
ÈÈ# $
$str
ÈÈ$ J
)
ÈÈJ K
;
ÈÈK L#
ConfirmPinPasswordBox
ÍÍ %
.
ÍÍ% &
Password
ÍÍ& .
=
ÍÍ/ 0
string
ÍÍ1 7
.
ÍÍ7 8
Empty
ÍÍ8 =
;
ÍÍ= >#
ConfirmPinPasswordBox
ÎÎ %
.
ÎÎ% &
Focus
ÎÎ& +
(
ÎÎ+ ,

FocusState
ÎÎ, 6
.
ÎÎ6 7
Programmatic
ÎÎ7 C
)
ÎÎC D
;
ÎÎD E
return
ÏÏ 
;
ÏÏ 
}
ÌÌ 
SetLoadingState
 
(
 
true
  
)
  !
;
! "
	ViewModel
ÛÛ 
.
ÛÛ 
EmployeeNumber
ÛÛ $
=
ÛÛ% &
employeeNumber
ÛÛ' 5
;
ÛÛ5 6
	ViewModel
ÙÙ 
.
ÙÙ 
FullName
ÙÙ 
=
ÙÙ  
fullName
ÙÙ! )
;
ÙÙ) *
	ViewModel
ıı 
.
ıı 

Department
ıı  
=
ıı! "

department
ıı# -
;
ıı- .
	ViewModel
ˆˆ 
.
ˆˆ 
Shift
ˆˆ 
=
ˆˆ 
shift
ˆˆ #
;
ˆˆ# $
	ViewModel
˜˜ 
.
˜˜ 
Pin
˜˜ 
=
˜˜ 
pin
˜˜ 
;
˜˜  
if
˙˙ 
(
˙˙ 
	ViewModel
˙˙ 
.
˙˙  
ConfigureErpAccess
˙˙ ,
)
˙˙, -
{
˚˚ 
	ViewModel
¸¸ 
.
¸¸ 
VisualUsername
¸¸ (
=
¸¸) *#
VisualUsernameTextBox
¸¸+ @
.
¸¸@ A
Text
¸¸A E
?
¸¸E F
.
¸¸F G
Trim
¸¸G K
(
¸¸K L
)
¸¸L M
;
¸¸M N
	ViewModel
˝˝ 
.
˝˝ 
VisualPassword
˝˝ (
=
˝˝) *
VisualPasswordBox
˝˝+ <
.
˝˝< =
Password
˝˝= E
?
˝˝E F
.
˝˝F G
Trim
˝˝G K
(
˝˝K L
)
˝˝L M
;
˝˝M N
}
˛˛ 
bool
ÅÅ 
success
ÅÅ 
=
ÅÅ 
await
ÅÅ  
	ViewModel
ÅÅ! *
.
ÅÅ* + 
CreateAccountAsync
ÅÅ+ =
(
ÅÅ= >
)
ÅÅ> ?
;
ÅÅ? @
SetLoadingState
ÑÑ 
(
ÑÑ 
false
ÑÑ !
)
ÑÑ! "
;
ÑÑ" #
if
ÜÜ 
(
ÜÜ 
success
ÜÜ 
)
ÜÜ 
{
áá 
StatusInfoBar
ââ 
.
ââ 
Title
ââ #
=
ââ$ %
$str
ââ& E
;
ââE F
StatusInfoBar
ää 
.
ää 
Message
ää %
=
ää& '
$"
ää( *
$str
ää* C
{
ääC D
	ViewModel
ääD M
.
ääM N
NewEmployeeNumber
ääN _
}
ää_ `
$str
ää` v
"
ääv w
;
ääw x
StatusInfoBar
ãã 
.
ãã 
Severity
ãã &
=
ãã' (
InfoBarSeverity
ãã) 8
.
ãã8 9
Success
ãã9 @
;
ãã@ A
StatusInfoBar
åå 
.
åå 
IsOpen
åå $
=
åå% &
true
åå' +
;
åå+ ,
await
èè 
System
èè 
.
èè 
	Threading
èè &
.
èè& '
Tasks
èè' ,
.
èè, -
Task
èè- 1
.
èè1 2
Delay
èè2 7
(
èè7 8
$num
èè8 <
)
èè< =
;
èè= >
Hide
íí 
(
íí 
)
íí 
;
íí 
}
ìì 
else
îî 
{
ïï !
ShowValidationError
óó #
(
óó# $
	ViewModel
óó$ -
.
óó- .
ErrorMessage
óó. :
??
óó; =
$str
óó> k
)
óók l
;
óól m
}
òò 
}
ôô 	
private
ûû 
void
ûû !
OnCancelButtonClick
ûû (
(
ûû( )
ContentDialog
ûû) 6
sender
ûû7 =
,
ûû= >/
!ContentDialogButtonClickEventArgs
ûû? `
args
ûûa e
)
ûûe f
{
üü 	
	ViewModel
°° 
.
°° 
IsCancelled
°° !
=
°°" #
true
°°$ (
;
°°( )
}
¢¢ 	
private
ßß 
void
ßß !
ShowValidationError
ßß (
(
ßß( )
string
ßß) /
message
ßß0 7
)
ßß7 8
{
®® 	
StatusInfoBar
©© 
.
©© 
Title
©© 
=
©©  !
$str
©©" 4
;
©©4 5
StatusInfoBar
™™ 
.
™™ 
Message
™™ !
=
™™" #
message
™™$ +
;
™™+ ,
StatusInfoBar
´´ 
.
´´ 
Severity
´´ "
=
´´# $
InfoBarSeverity
´´% 4
.
´´4 5
Error
´´5 :
;
´´: ;
StatusInfoBar
¨¨ 
.
¨¨ 
IsOpen
¨¨  
=
¨¨! "
true
¨¨# '
;
¨¨' (
}
≠≠ 	
private
≤≤ 
void
≤≤ 
SetLoadingState
≤≤ $
(
≤≤$ %
bool
≤≤% )
	isLoading
≤≤* 3
)
≤≤3 4
{
≥≥ 	
FullNameTextBox
µµ 
.
µµ 
	IsEnabled
µµ %
=
µµ& '
!
µµ( )
	isLoading
µµ) 2
;
µµ2 3 
DepartmentComboBox
∂∂ 
.
∂∂ 
	IsEnabled
∂∂ (
=
∂∂) *
!
∂∂+ ,
	isLoading
∂∂, 5
;
∂∂5 6%
CustomDepartmentTextBox
∑∑ #
.
∑∑# $
	IsEnabled
∑∑$ -
=
∑∑. /
!
∑∑0 1
	isLoading
∑∑1 :
;
∑∑: ;
ShiftComboBox
∏∏ 
.
∏∏ 
	IsEnabled
∏∏ #
=
∏∏$ %
!
∏∏& '
	isLoading
∏∏' 0
;
∏∏0 1
PinPasswordBox
ππ 
.
ππ 
	IsEnabled
ππ $
=
ππ% &
!
ππ' (
	isLoading
ππ( 1
;
ππ1 2#
ConfirmPinPasswordBox
∫∫ !
.
∫∫! "
	IsEnabled
∫∫" +
=
∫∫, -
!
∫∫. /
	isLoading
∫∫/ 8
;
∫∫8 9$
IsPrimaryButtonEnabled
ΩΩ "
=
ΩΩ# $
!
ΩΩ% &
	isLoading
ΩΩ& /
;
ΩΩ/ 0&
IsSecondaryButtonEnabled
ææ $
=
ææ% &
!
ææ' (
	isLoading
ææ( 1
;
ææ1 2 
LoadingProgressBar
¡¡ 
.
¡¡ 

Visibility
¡¡ )
=
¡¡* +
	isLoading
¡¡, 5
?
¡¡6 7

Visibility
¡¡8 B
.
¡¡B C
Visible
¡¡C J
:
¡¡K L

Visibility
¡¡M W
.
¡¡W X
	Collapsed
¡¡X a
;
¡¡a b
if
√√ 
(
√√ 
	isLoading
√√ 
)
√√ 
{
ƒƒ 
StatusInfoBar
≈≈ 
.
≈≈ 
Title
≈≈ #
=
≈≈$ %
$str
≈≈& 8
;
≈≈8 9
StatusInfoBar
∆∆ 
.
∆∆ 
Message
∆∆ %
=
∆∆& '
$str
∆∆( U
;
∆∆U V
StatusInfoBar
«« 
.
«« 
Severity
«« &
=
««' (
InfoBarSeverity
««) 8
.
««8 9
Informational
««9 F
;
««F G
StatusInfoBar
»» 
.
»» 
IsOpen
»» $
=
»»% &
true
»»' +
;
»»+ ,
}
…… 
}
   	
}
ÀÀ 
}ÃÃ œª
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Shared\Shared_IconSelectorWindow.xaml.cs
	namespace

 	%
MTM_Receiving_Application


 #
.

# $
Views

$ )
.

) *
Shared

* 0
;

0 1
public 
sealed 
partial 
class %
Shared_IconSelectorWindow 5
:6 7
Window8 >
{ 
private 
List 
< 
IconInfo 
> 
_allIconsFromFile ,
=- .
new/ 2
(2 3
)3 4
;4 5
private 
List 
< 
IconInfo 
> 
	_allIcons $
=% &
new' *
(* +
)+ ,
;, -
private 
List 
< 
IconInfo 
> 
_filteredIcons )
=* +
new, /
(/ 0
)0 1
;1 2
private 
int 
_currentPage 
= 
$num  
;  !
private 
int 
_totalPages 
= 
$num 
;  
private 
const 
int 
ICONS_PER_PAGE $
=% &
$num' )
;) *
public 

string 
? 
SelectedIconGlyph $
{% &
get' *
;* +
private, 3
set4 7
;7 8
}9 :
public 

string 
? 
SelectedIconName #
{$ %
get& )
;) *
private+ 2
set3 6
;6 7
}8 9
public 

bool 
IconWasSelected 
{  !
get" %
;% &
private' .
set/ 2
;2 3
}4 5
public 
%
Shared_IconSelectorWindow $
($ %
)% &
{ 
InitializeComponent 
( 
) 
; &
ExtendsContentIntoTitleBar "
=# $
true% )
;) *
SetTitleBar 
( 
AppTitleBar 
)  
;  !
_!! 	
=!!
 
LoadAllIconsAsync!! 
(!! 
)!! 
;!!  
var## 
hwnd## 
=## 
WinRT## 
.## 
Interop##  
.##  !
WindowNative##! -
.##- .
GetWindowHandle##. =
(##= >
this##> B
)##B C
;##C D
var$$ 
windowId$$ 
=$$ 
	Microsoft$$  
.$$  !
UI$$! #
.$$# $
Win32Interop$$$ 0
.$$0 1!
GetWindowIdFromWindow$$1 F
($$F G
hwnd$$G K
)$$K L
;$$L M
var%% 
	appWindow%% 
=%% 
	Microsoft%% !
.%%! "
UI%%" $
.%%$ %
	Windowing%%% .
.%%. /
	AppWindow%%/ 8
.%%8 9
GetFromWindowId%%9 H
(%%H I
windowId%%I Q
)%%Q R
;%%R S
var'' 

windowSize'' 
='' 
new'' 
Windows'' $
.''$ %
Graphics''% -
.''- .
	SizeInt32''. 7
{''8 9
Width'': ?
=''@ A
$num''B F
,''F G
Height''H N
=''O P
$num''Q T
}''U V
;''V W
	appWindow(( 
.(( 
Resize(( 
((( 

windowSize(( #
)((# $
;(($ %
var** 
displayArea** 
=** 
	Microsoft** #
.**# $
UI**$ &
.**& '
	Windowing**' 0
.**0 1
DisplayArea**1 <
.**< =
GetFromWindowId**= L
(**L M
windowId**M U
,**U V
	Microsoft**W `
.**` a
UI**a c
.**c d
	Windowing**d m
.**m n 
DisplayAreaFallback	**n Å
.
**Å Ç
Primary
**Ç â
)
**â ä
;
**ä ã
if++ 

(++ 
displayArea++ 
!=++ 
null++ 
)++  
{,, 	
var-- 
centerX-- 
=-- 
(-- 
displayArea-- &
.--& '
WorkArea--' /
.--/ 0
Width--0 5
---6 7

windowSize--8 B
.--B C
Width--C H
)--H I
/--J K
$num--L M
;--M N
var.. 
centerY.. 
=.. 
(.. 
displayArea.. &
...& '
WorkArea..' /
.../ 0
Height..0 6
-..7 8

windowSize..9 C
...C D
Height..D J
)..J K
/..L M
$num..N O
;..O P
	appWindow// 
.// 
Move// 
(// 
new// 
Windows// &
.//& '
Graphics//' /
./// 0

PointInt32//0 :
{//; <
X//= >
=//? @
centerX//A H
,//H I
Y//J K
=//L M
centerY//N U
}//V W
)//W X
;//X Y
}00 	
}11 
private33 
async33 
Task33 
LoadAllIconsAsync33 (
(33( )
)33) *
{44 
if55 

(55 
_allIconsFromFile55 
.55 
Count55 #
>55$ %
$num55& '
)55' (
return55) /
;55/ 0
try77 
{88 	
var99 
jsonPath99 
=99 
Path99 
.99  
Combine99  '
(99' (

AppContext99( 2
.992 3
BaseDirectory993 @
,99@ A
$str99B J
,99J K
$str99L ^
)99^ _
;99_ `
if;; 
(;; 
File;; 
.;; 
Exists;; 
(;; 
jsonPath;; $
);;$ %
);;% &
{<< 
var== 
jsonText== 
=== 
await== $
File==% )
.==) *
ReadAllTextAsync==* :
(==: ;
jsonPath==; C
)==C D
;==D E
var>> 
iconData>> 
=>> 
JsonSerializer>> -
.>>- .
Deserialize>>. 9
<>>9 :
List>>: >
<>>> ?
JsonIconData>>? K
>>>K L
>>>L M
(>>M N
jsonText>>N V
)>>V W
;>>W X
if@@ 
(@@ 
iconData@@ 
!=@@ 
null@@  $
&&@@% '
iconData@@( 0
.@@0 1
Count@@1 6
>@@7 8
$num@@9 :
)@@: ;
{AA 
_allIconsFromFileBB %
=BB& '
iconDataBB( 0
.CC 
SelectCC 
(CC  
iconCC  $
=>CC% '
newCC( +
IconInfoCC, 4
(CC4 5
CleanIconNameDD )
(DD) *
iconDD* .
.DD. /
nameDD/ 3
)DD3 4
,DD4 5
iconEE  
.EE  !
	codepointEE! *
>EE+ ,
$numEE- .
?EE/ 0
charEE1 5
.EE5 6
ConvertFromUtf32EE6 F
(EEF G
iconEEG K
.EEK L
	codepointEEL U
)EEU V
:EEW X
iconEEY ]
.EE] ^
glyphEE^ c
)EEc d
)EEd e
.FF 
OrderByFF  
(FF  !
iconFF! %
=>FF& (
iconFF) -
.FF- .
NameFF. 2
)FF2 3
.GG 
ToListGG 
(GG  
)GG  !
;GG! "
ApplyIconFilterII #
(II# $
)II$ %
;II% &
_filteredIconsJJ "
=JJ# $
[JJ% &
..JJ& (
	_allIconsJJ) 2
]JJ2 3
;JJ3 4
UpdateDisplayKK !
(KK! "
)KK" #
;KK# $
returnLL 
;LL 
}MM 
}NN 
LoadFallbackIconsPP 
(PP 
)PP 
;PP  
	_allIconsQQ 
=QQ 
[QQ 
..QQ 
_allIconsFromFileQQ -
]QQ- .
;QQ. /
_filteredIconsRR 
=RR 
[RR 
..RR  
	_allIconsRR! *
]RR* +
;RR+ ,
UpdateDisplaySS 
(SS 
)SS 
;SS 
}TT 	
catchUU 
(UU 
	ExceptionUU 
)UU 
{VV 	
LoadFallbackIconsWW 
(WW 
)WW 
;WW  
	_allIconsXX 
=XX 
[XX 
..XX 
_allIconsFromFileXX -
]XX- .
;XX. /
_filteredIconsYY 
=YY 
[YY 
..YY  
	_allIconsYY! *
]YY* +
;YY+ ,
UpdateDisplayZZ 
(ZZ 
)ZZ 
;ZZ 
}[[ 	
}\\ 
private^^ 
void^^ 
ApplyIconFilter^^  
(^^  !
)^^! "
{__ 
if`` 

(``  
ShowAllIconsCheckBox``  
?``  !
.``! "
	IsChecked``" +
==``, .
true``/ 3
)``3 4
{aa 	
	_allIconsbb 
=bb 
[bb 
..bb 
_allIconsFromFilebb -
]bb- .
;bb. /
}cc 	
elsedd 
{ee 	
varff 
relevantKeywordsff  
=ff! "
newff# &
[ff& '
]ff' (
{gg 
$strhh 
,hh 
$strhh  
,hh  !
$strhh" +
,hh+ ,
$strhh- 3
,hh3 4
$strhh5 <
,hh< =
$strhh> F
,hhF G
$strhhH S
,hhS T
$strii 
,ii 
$strii '
,ii' (
$strii) 8
,ii8 9
$strii: @
,ii@ A
$striiB J
,iiJ K
$striiL T
,iiT U
$strjj 
,jj 
$strjj &
,jj& '
$strjj( 1
,jj1 2
$strjj3 :
,jj: ;
$strjj< D
,jjD E
$strkk 
,kk 
$strkk #
,kk# $
$strkk% 0
,kk0 1
$strkk2 ;
,kk; <
$strkk= G
,kkG H
$strll 
,ll 
$strll '
,ll' (
$strll) /
,ll/ 0
$strll1 7
,ll7 8
$strll9 ?
,ll? @
$strmm 
,mm 
$strmm 
,mm  
$strmm! )
,mm) *
$strmm+ 5
,mm5 6
$strmm7 @
,mm@ A
$strnn 
,nn 
$strnn 
,nn 
$strnn  )
,nn) *
$strnn+ /
,nn/ 0
$strnn1 7
,nn7 8
$stroo 
,oo 
$stroo 
,oo  
$stroo! *
,oo* +
$stroo, 6
,oo6 7
$stroo8 ?
,oo? @
$strpp 
,pp 
$strpp #
,pp# $
$strpp% -
,pp- .
$strpp/ 5
}qq 
;qq 
	_allIconsss 
=ss 
_allIconsFromFiless )
.tt 
Wherett 
(tt 
icontt 
=>tt 
relevantKeywordstt /
.tt/ 0
Anytt0 3
(tt3 4
keywordtt4 ;
=>tt< >
iconuu 
.uu 
Nameuu 
.uu 
ToLoweruu %
(uu% &
)uu& '
.uu' (
Containsuu( 0
(uu0 1
keyworduu1 8
)uu8 9
)uu9 :
)uu: ;
.vv 
ToListvv 
(vv 
)vv 
;vv 
}ww 	
}xx 
privatezz 
stringzz 
CleanIconNamezz  
(zz  !
stringzz! '
rawNamezz( /
)zz/ 0
{{{ 
var}} 

withSpaces}} 
=}} 
System}} 
.}}  
Text}}  $
.}}$ %
RegularExpressions}}% 7
.}}7 8
Regex}}8 =
.}}= >
Replace}}> E
(}}E F
rawName}}F M
,}}M N
$str}}O [
,}}[ \
$str}}] b
)}}b c
;}}c d

withSpaces 
= 
System 
. 
Text  
.  !
RegularExpressions! 3
.3 4
Regex4 9
.9 :
Replace: A
(A B

withSpacesB L
,L M
$strN a
,a b
$strc j
)j k
;k l

withSpaces
ÅÅ 
=
ÅÅ 
System
ÅÅ 
.
ÅÅ 
Text
ÅÅ  
.
ÅÅ  ! 
RegularExpressions
ÅÅ! 3
.
ÅÅ3 4
Regex
ÅÅ4 9
.
ÅÅ9 :
Replace
ÅÅ: A
(
ÅÅA B

withSpaces
ÅÅB L
,
ÅÅL M
$str
ÅÅN a
,
ÅÅa b
$str
ÅÅc j
)
ÅÅj k
;
ÅÅk l
return
ÇÇ 

withSpaces
ÇÇ 
;
ÇÇ 
}
ÉÉ 
private
ÖÖ 
void
ÖÖ 
LoadFallbackIcons
ÖÖ "
(
ÖÖ" #
)
ÖÖ# $
{
ÜÜ 
_allIconsFromFile
áá 
=
áá 
new
áá 
List
áá  $
<
áá$ %
IconInfo
áá% -
>
áá- .
{
àà 	
new
ââ 
IconInfo
ââ 
(
ââ 
$str
ââ 
,
ââ 
$str
ââ  (
)
ââ( )
,
ââ) *
new
ää 
IconInfo
ää 
(
ää 
$str
ää "
,
ää" #
$str
ää$ ,
)
ää, -
,
ää- .
new
ãã 
IconInfo
ãã 
(
ãã 
$str
ãã "
,
ãã" #
$str
ãã$ ,
)
ãã, -
,
ãã- .
new
åå 
IconInfo
åå 
(
åå 
$str
åå  
,
åå  !
$str
åå" *
)
åå* +
}
çç 	
;
çç	 

}
éé 
private
êê 
void
êê #
OnShowAllIconsChanged
êê &
(
êê& '
object
êê' -
sender
êê. 4
,
êê4 5
RoutedEventArgs
êê6 E
e
êêF G
)
êêG H
{
ëë 
ApplyIconFilter
íí 
(
íí 
)
íí 
;
íí 
_filteredIcons
ìì 
=
ìì 
[
ìì 
..
ìì 
	_allIcons
ìì &
]
ìì& '
;
ìì' (
_currentPage
îî 
=
îî 
$num
îî 
;
îî 
	SearchBox
ïï 
.
ïï 
Text
ïï 
=
ïï 
string
ïï 
.
ïï  
Empty
ïï  %
;
ïï% &
UpdateDisplay
ññ 
(
ññ 
)
ññ 
;
ññ 
}
óó 
private
ôô 
void
ôô !
OnSearchTextChanged
ôô $
(
ôô$ %
object
ôô% +
sender
ôô, 2
,
ôô2 3"
TextChangedEventArgs
ôô4 H
e
ôôI J
)
ôôJ K
{
öö 
var
õõ 

searchText
õõ 
=
õõ 
	SearchBox
õõ "
.
õõ" #
Text
õõ# '
.
õõ' (
Trim
õõ( ,
(
õõ, -
)
õõ- .
.
õõ. /
ToLower
õõ/ 6
(
õõ6 7
)
õõ7 8
;
õõ8 9
if
ùù 

(
ùù 
string
ùù 
.
ùù 
IsNullOrEmpty
ùù  
(
ùù  !

searchText
ùù! +
)
ùù+ ,
)
ùù, -
{
ûû 	
_filteredIcons
üü 
=
üü 
[
üü 
..
üü  
	_allIcons
üü! *
]
üü* +
;
üü+ ,
}
†† 	
else
°° 
{
¢¢ 	
_filteredIcons
££ 
=
££ 
	_allIcons
££ &
.
§§ 
Where
§§ 
(
§§ 
icon
§§ 
=>
§§ 
icon
§§ #
.
§§# $
Name
§§$ (
.
§§( )
ToLower
§§) 0
(
§§0 1
)
§§1 2
.
§§2 3
Contains
§§3 ;
(
§§; <

searchText
§§< F
)
§§F G
)
§§G H
.
•• 
ToList
•• 
(
•• 
)
•• 
;
•• 
}
¶¶ 	
_currentPage
®® 
=
®® 
$num
®® 
;
®® 
UpdateDisplay
©© 
(
©© 
)
©© 
;
©© 
}
™™ 
private
¨¨ 
void
¨¨ 
UpdateDisplay
¨¨ 
(
¨¨ 
)
¨¨  
{
≠≠ 
_totalPages
ÆÆ 
=
ÆÆ 
(
ÆÆ 
int
ÆÆ 
)
ÆÆ 
Math
ÆÆ 
.
ÆÆ  
Ceiling
ÆÆ  '
(
ÆÆ' (
_filteredIcons
ÆÆ( 6
.
ÆÆ6 7
Count
ÆÆ7 <
/
ÆÆ= >
(
ÆÆ? @
double
ÆÆ@ F
)
ÆÆF G
ICONS_PER_PAGE
ÆÆG U
)
ÆÆU V
;
ÆÆV W
if
ØØ 

(
ØØ 
_totalPages
ØØ 
==
ØØ 
$num
ØØ 
)
ØØ 
_totalPages
ØØ )
=
ØØ* +
$num
ØØ, -
;
ØØ- .
if
∞∞ 

(
∞∞ 
_currentPage
∞∞ 
>
∞∞ 
_totalPages
∞∞ &
)
∞∞& '
_currentPage
∞∞( 4
=
∞∞5 6
_totalPages
∞∞7 B
;
∞∞B C
var
≤≤ 
currentPageIcons
≤≤ 
=
≤≤ 
_filteredIcons
≤≤ -
.
≥≥ 
Skip
≥≥ 
(
≥≥ 
(
≥≥ 
_currentPage
≥≥ 
-
≥≥  !
$num
≥≥" #
)
≥≥# $
*
≥≥% &
ICONS_PER_PAGE
≥≥' 5
)
≥≥5 6
.
¥¥ 
Take
¥¥ 
(
¥¥ 
ICONS_PER_PAGE
¥¥  
)
¥¥  !
.
µµ 
ToList
µµ 
(
µµ 
)
µµ 
;
µµ 
IconGridView
∑∑ 
.
∑∑ 
ItemsSource
∑∑  
=
∑∑! "
currentPageIcons
∑∑# 3
;
∑∑3 4
if
ππ 

(
ππ 
PageInfoTextBlock
ππ 
!=
ππ  
null
ππ! %
)
ππ% &
{
∫∫ 	
PageInfoTextBlock
ªª 
.
ªª 
Text
ªª "
=
ªª# $
$"
ªª% '
$str
ªª' ,
{
ªª, -
_currentPage
ªª- 9
}
ªª9 :
$str
ªª: >
{
ªª> ?
_totalPages
ªª? J
}
ªªJ K
"
ªªK L
;
ªªL M
FirstPageButton
ºº 
.
ºº 
	IsEnabled
ºº %
=
ºº& '
_currentPage
ºº( 4
>
ºº5 6
$num
ºº7 8
;
ºº8 9 
PreviousPageButton
ΩΩ 
.
ΩΩ 
	IsEnabled
ΩΩ (
=
ΩΩ) *
_currentPage
ΩΩ+ 7
>
ΩΩ8 9
$num
ΩΩ: ;
;
ΩΩ; <
NextPageButton
ææ 
.
ææ 
	IsEnabled
ææ $
=
ææ% &
_currentPage
ææ' 3
<
ææ4 5
_totalPages
ææ6 A
;
ææA B
LastPageButton
øø 
.
øø 
	IsEnabled
øø $
=
øø% &
_currentPage
øø' 3
<
øø4 5
_totalPages
øø6 A
;
øøA B
}
¿¿ 	
}
¡¡ 
private
√√ 
void
√√ 
OnFirstPageClick
√√ !
(
√√! "
object
√√" (
sender
√√) /
,
√√/ 0
RoutedEventArgs
√√1 @
e
√√A B
)
√√B C
{
ƒƒ 
_currentPage
≈≈ 
=
≈≈ 
$num
≈≈ 
;
≈≈ 
UpdateDisplay
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
}
«« 
private
…… 
void
…… !
OnPreviousPageClick
…… $
(
……$ %
object
……% +
sender
……, 2
,
……2 3
RoutedEventArgs
……4 C
e
……D E
)
……E F
{
   
if
ÀÀ 

(
ÀÀ 
_currentPage
ÀÀ 
>
ÀÀ 
$num
ÀÀ 
)
ÀÀ 
{
ÃÃ 	
_currentPage
ÕÕ 
--
ÕÕ 
;
ÕÕ 
UpdateDisplay
ŒŒ 
(
ŒŒ 
)
ŒŒ 
;
ŒŒ 
}
œœ 	
}
–– 
private
““ 
void
““ 
OnNextPageClick
““  
(
““  !
object
““! '
sender
““( .
,
““. /
RoutedEventArgs
““0 ?
e
““@ A
)
““A B
{
”” 
if
‘‘ 

(
‘‘ 
_currentPage
‘‘ 
<
‘‘ 
_totalPages
‘‘ &
)
‘‘& '
{
’’ 	
_currentPage
÷÷ 
++
÷÷ 
;
÷÷ 
UpdateDisplay
◊◊ 
(
◊◊ 
)
◊◊ 
;
◊◊ 
}
ÿÿ 	
}
ŸŸ 
private
€€ 
void
€€ 
OnLastPageClick
€€  
(
€€  !
object
€€! '
sender
€€( .
,
€€. /
RoutedEventArgs
€€0 ?
e
€€@ A
)
€€A B
{
‹‹ 
_currentPage
›› 
=
›› 
_totalPages
›› "
;
››" #
UpdateDisplay
ﬁﬁ 
(
ﬁﬁ 
)
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 
private
·· 
void
·· 
OnIconItemClick
··  
(
··  !
object
··! '
sender
··( .
,
··. / 
ItemClickEventArgs
··0 B
e
··C D
)
··D E
{
‚‚ 
if
„„ 

(
„„ 
e
„„ 
.
„„ 
ClickedItem
„„ 
is
„„ 
IconInfo
„„ %
icon
„„& *
)
„„* +
{
‰‰ 	
SelectedIconGlyph
ÂÂ 
=
ÂÂ 
icon
ÂÂ  $
.
ÂÂ$ %
Glyph
ÂÂ% *
;
ÂÂ* +
SelectedIconName
ÊÊ 
=
ÊÊ 
icon
ÊÊ #
.
ÊÊ# $
Name
ÊÊ$ (
;
ÊÊ( )
IconWasSelected
ÁÁ 
=
ÁÁ 
true
ÁÁ "
;
ÁÁ" #
Close
ËË 
(
ËË 
)
ËË 
;
ËË 
}
ÈÈ 	
}
ÍÍ 
private
ÏÏ 
void
ÏÏ 
OnCancelClick
ÏÏ 
(
ÏÏ 
object
ÏÏ %
sender
ÏÏ& ,
,
ÏÏ, -
RoutedEventArgs
ÏÏ. =
e
ÏÏ> ?
)
ÏÏ? @
{
ÌÌ 
IconWasSelected
ÓÓ 
=
ÓÓ 
false
ÓÓ 
;
ÓÓ  
Close
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
}
 
public
ÚÚ 

class
ÚÚ 
IconInfo
ÚÚ 
{
ÛÛ 
public
ÙÙ 
string
ÙÙ 
Name
ÙÙ 
{
ÙÙ 
get
ÙÙ  
;
ÙÙ  !
set
ÙÙ" %
;
ÙÙ% &
}
ÙÙ' (
public
ıı 
string
ıı 
Glyph
ıı 
{
ıı 
get
ıı !
;
ıı! "
set
ıı# &
;
ıı& '
}
ıı( )
public
˜˜ 
IconInfo
˜˜ 
(
˜˜ 
string
˜˜ 
name
˜˜ #
,
˜˜# $
string
˜˜% +
glyph
˜˜, 1
)
˜˜1 2
{
¯¯ 	
Name
˘˘ 
=
˘˘ 
name
˘˘ 
;
˘˘ 
Glyph
˙˙ 
=
˙˙ 
glyph
˙˙ 
;
˙˙ 
}
˚˚ 	
}
¸¸ 
private
˛˛ 
class
˛˛ 
JsonIconData
˛˛ 
{
ˇˇ 
public
ÄÄ 
string
ÄÄ 
name
ÄÄ 
{
ÄÄ 
get
ÄÄ  
;
ÄÄ  !
set
ÄÄ" %
;
ÄÄ% &
}
ÄÄ' (
=
ÄÄ) *
string
ÄÄ+ 1
.
ÄÄ1 2
Empty
ÄÄ2 7
;
ÄÄ7 8
public
ÅÅ 
string
ÅÅ 
glyph
ÅÅ 
{
ÅÅ 
get
ÅÅ !
;
ÅÅ! "
set
ÅÅ# &
;
ÅÅ& '
}
ÅÅ( )
=
ÅÅ* +
string
ÅÅ, 2
.
ÅÅ2 3
Empty
ÅÅ3 8
;
ÅÅ8 9
public
ÇÇ 
int
ÇÇ 
	codepoint
ÇÇ 
{
ÇÇ 
get
ÇÇ "
;
ÇÇ" #
set
ÇÇ$ '
;
ÇÇ' (
}
ÇÇ) *
}
ÉÉ 
}ÑÑ €
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_WorkflowView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class "
Receiving_WorkflowView  6
:7 8
Page9 =
{		 
public

 0
$Receiving_ReceivingWorkflowViewModel

 3
	ViewModel

4 =
{

> ?
get

@ C
;

C D
}

E F
public "
Receiving_WorkflowView %
(% &
)& '
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '0
$Receiving_ReceivingWorkflowViewModel' K
>K L
(L M
)M N
;N O
this 
. 
InitializeComponent $
($ %
)% &
;& '
} 	
	protected 
override 
void 
OnNavigatedTo  -
(- .
NavigationEventArgs. A
eB C
)C D
{ 	
base 
. 
OnNavigatedTo 
( 
e  
)  !
;! "
var 
sessionManager 
=  
App! $
.$ %

GetService% /
</ 0'
IService_UserSessionManager0 K
>K L
(L M
)M N
;N O
var 
workflowService 
=  !
App" %
.% &

GetService& 0
<0 1&
IService_ReceivingWorkflow1 K
>K L
(L M
)M N
;N O
if 
( 
workflowService 
.  
CurrentStep  +
==, .
WorkflowStep/ ;
.; <
ModeSelection< I
&&J L
sessionManager 
. 
CurrentSession -
?- .
.. /
User/ 3
!=4 6
null7 ;
); <
{ 
var   
defaultMode   
=    !
sessionManager  " 0
.  0 1
CurrentSession  1 ?
.  ? @
User  @ D
.  D E 
DefaultReceivingMode  E Y
;  Y Z
if"" 
("" 
!"" 
string"" 
."" 
IsNullOrEmpty"" )
("") *
defaultMode""* 5
)""5 6
)""6 7
{## 
if%% 
(%% 
defaultMode%% #
==%%$ &
$str%%' /
)%%/ 0
{&& 
workflowService'' '
.''' (
GoToStep''( 0
(''0 1
WorkflowStep''1 =
.''= >
POEntry''> E
)''E F
;''F G
}(( 
else)) 
if)) 
()) 
defaultMode)) (
==))) +
$str)), 4
)))4 5
{** 
workflowService++ '
.++' (
GoToStep++( 0
(++0 1
WorkflowStep++1 =
.++= >
ManualEntry++> I
)++I J
;++J K
},, 
}-- 
}.. 
}00 	
}11 
}22 §
jC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_WeightQuantityView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class (
Receiving_WeightQuantityView  <
:= >
UserControl? J
{ 
public		 -
!Receiving_WeightQuantityViewModel		 0
	ViewModel		1 :
{		; <
get		= @
;		@ A
}		B C
public (
Receiving_WeightQuantityView +
(+ ,
), -
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '-
!Receiving_WeightQuantityViewModel' H
>H I
(I J
)J K
;K L
this 
. 
InitializeComponent $
($ %
)% &
;& '
this 
. 
Loaded 
+= %
WeightQuantityView_Loaded 4
;4 5
} 	
private 
async 
void %
WeightQuantityView_Loaded 4
(4 5
object5 ;
sender< B
,B C
RoutedEventArgsD S
eT U
)U V
{ 	
await 
	ViewModel 
. 
OnNavigatedToAsync .
(. /
)/ 0
;0 1
} 	
} 
} é
fC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_ReviewGridView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class $
Receiving_ReviewGridView  8
:9 :
UserControl; F
{ 
public		 )
Receiving_ReviewGridViewModel		 ,
	ViewModel		- 6
{		7 8
get		9 <
;		< =
}		> ?
public $
Receiving_ReviewGridView '
(' (
)( )
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& ')
Receiving_ReviewGridViewModel' D
>D E
(E F
)F G
;G H
this 
. 
InitializeComponent $
($ %
)% &
;& '
} 	
private 
async 
void 
UserControl_Loaded -
(- .
object. 4
sender5 ;
,; <
RoutedEventArgs= L
eM N
)N O
{ 	
await 
	ViewModel 
. 
OnNavigatedToAsync .
(. /
)/ 0
;0 1
} 	
} 
} ∂
cC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_POEntryView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class !
Receiving_POEntryView  5
:6 7
UserControl8 C
{ 
public		 &
Receiving_POEntryViewModel		 )
	ViewModel		* 3
{		4 5
get		6 9
;		9 :
}		; <
public !
Receiving_POEntryView $
($ %
)% &
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '&
Receiving_POEntryViewModel' A
>A B
(B C
)C D
;D E
this 
. 
InitializeComponent $
($ %
)% &
;& '
} 	
private 
void 
UserControl_Loaded '
(' (
object( .
sender/ 5
,5 6
RoutedEventArgs7 F
eG H
)H I
{ 	
FirstTextBox 
? 
. 
Focus 
(  

FocusState  *
.* +
Programmatic+ 7
)7 8
;8 9
} 	
private 
void 
POTextBox_LostFocus (
(( )
object) /
sender0 6
,6 7
RoutedEventArgs8 G
eH I
)I J
{ 	
	ViewModel 
. %
PoTextBoxLostFocusCommand /
./ 0
Execute0 7
(7 8
null8 <
)< =
;= >
} 	
} 
} è
gC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_PackageTypeView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class %
Receiving_PackageTypeView  9
:: ;
UserControl< G
{ 
public		 *
Receiving_PackageTypeViewModel		 -
	ViewModel		. 7
{		8 9
get		: =
;		= >
}		? @
public %
Receiving_PackageTypeView (
(( )
)) *
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '*
Receiving_PackageTypeViewModel' E
>E F
(F G
)G H
;H I
this 
. 
InitializeComponent $
($ %
)% &
;& '
this 
. 
Loaded 
+= "
PackageTypeView_Loaded 1
;1 2
} 	
private 
async 
void "
PackageTypeView_Loaded 1
(1 2
object2 8
sender9 ?
,? @
RoutedEventArgsA P
eQ R
)R S
{ 	
await 
	ViewModel 
. 
OnNavigatedToAsync .
(. /
)/ 0
;0 1
} 	
} 
} ∞
iC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_ModeSelectionView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class '
Receiving_ModeSelectionView  ;
:< =
UserControl> I
{ 
public 5
)Receiving_ReceivingModeSelectionViewModel 8
	ViewModel9 B
{C D
getE H
;H I
}J K
public

 '
Receiving_ModeSelectionView

 *
(

* +
)

+ ,
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '5
)Receiving_ReceivingModeSelectionViewModel' P
>P Q
(Q R
)R S
;S T
this 
. 
InitializeComponent $
($ %
)% &
;& '
} 	
} 
} üp
gC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_ManualEntryView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class %
Receiving_ManualEntryView  9
:: ;
UserControl< G
{ 
public *
Receiving_ManualEntryViewModel -
	ViewModel. 7
{8 9
get: =
;= >
}? @
public %
Receiving_ManualEntryView (
(( )
)) *
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '*
Receiving_ManualEntryViewModel' E
>E F
(F G
)G H
;H I
this 
. 
DataContext 
= 
	ViewModel (
;( )
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
. 
Loads 
. 
CollectionChanged -
+=. 0#
Loads_CollectionChanged1 H
;H I
} 	
private   
void   #
Loads_CollectionChanged   ,
(  , -
object  - 3
?  3 4
sender  5 ;
,  ; <
System  = C
.  C D
Collections  D O
.  O P
Specialized  P [
.  [ \,
 NotifyCollectionChangedEventArgs  \ |
e  } ~
)  ~ 
{!! 	
if"" 
("" 
e"" 
."" 
Action"" 
=="" 
System"" "
.""" #
Collections""# .
."". /
Specialized""/ :
."": ;)
NotifyCollectionChangedAction""; X
.""X Y
Add""Y \
)""\ ]
{## 
Debug$$ 
.$$ 
	WriteLine$$ 
($$  
$str$$  Z
)$$Z [
;$$[ \
ManualEntryDataGrid&& #
.&&# $
DispatcherQueue&&$ 3
.&&3 4

TryEnqueue&&4 >
(&&> ?
(&&? @
)&&@ A
=>&&B D
{'' 
if(( 
((( 
	ViewModel(( !
.((! "
Loads((" '
.((' (
Count((( -
>((. /
$num((0 1
)((1 2
{)) 
var++ 
newItem++ #
=++$ %
e++& '
.++' (
NewItems++( 0
?++0 1
[++1 2
$num++2 3
]++3 4
as++5 7
Model_ReceivingLoad++8 K
;++K L
if,, 
(,, 
newItem,, #
!=,,$ &
null,,' +
),,+ ,
{-- 
Debug.. !
...! "
	WriteLine.." +
(..+ ,
$".., .
$str... w
{..w x
newItem..x 
.	.. Ä

LoadNumber
..Ä ä
}
..ä ã
"
..ã å
)
..å ç
;
..ç é
ManualEntryDataGrid// /
./// 0
SelectedItem//0 <
=//= >
newItem//? F
;//F G
ManualEntryDataGrid00 /
.00/ 0
ScrollIntoView000 >
(00> ?
newItem00? F
,00F G
ManualEntryDataGrid00H [
.00[ \
Columns00\ c
.00c d
FirstOrDefault00d r
(00r s
)00s t
)00t u
;00u v
_33 
=33 
Task33  $
.33$ %
Run33% (
(33( )
async33) .
(33/ 0
)330 1
=>332 4
{44 
await55  %
Task55& *
.55* +
Delay55+ 0
(550 1
$num551 4
)554 5
;555 6
ManualEntryDataGrid66  3
.663 4
DispatcherQueue664 C
.66C D

TryEnqueue66D N
(66N O
(66O P
)66P Q
=>66R T
{77  !#
SelectFirstEditableCell88$ ;
(88; <
ManualEntryDataGrid88< O
)88O P
;88P Q
}99  !
)99! "
;99" #
}:: 
):: 
;:: 
};; 
}<< 
}== 
)== 
;== 
}>> 
}?? 	
privateAA 
voidAA 2
&ManualEntryDataGrid_CurrentCellChangedAA ;
(AA; <
objectAA< B
?AAB C
senderAAD J
,AAJ K
	EventArgsAAL U
eAAV W
)AAW X
{BB 	
varCC 
gridCC 
=CC 
senderCC 
asCC  
DataGridCC! )
;CC) *
ifDD 
(DD 
gridDD 
!=DD 
nullDD 
)DD 
{EE 
gridGG 
.GG 
DispatcherQueueGG $
.GG$ %

TryEnqueueGG% /
(GG/ 0
(GG0 1
)GG1 2
=>GG3 5
{HH 
ifII 
(II 
gridII 
.II 
CurrentColumnII *
!=II+ -
nullII. 2
&&II3 5
!II6 7
gridII7 ;
.II; <
CurrentColumnII< I
.III J

IsReadOnlyIIJ T
)IIT U
{JJ 
DebugKK 
.KK 
	WriteLineKK '
(KK' (
$"KK( *
$strKK* b
{KKb c
gridKKc g
.KKg h
SelectedIndexKKh u
}KKu v
$strKKv |
{KK| }
grid	KK} Å
.
KKÅ Ç
CurrentColumn
KKÇ è
.
KKè ê
Header
KKê ñ
}
KKñ ó
"
KKó ò
)
KKò ô
;
KKô ö
gridLL 
.LL 
	BeginEditLL &
(LL& '
)LL' (
;LL( )
}MM 
}NN 
)NN 
;NN 
}OO 
}PP 	
privateRR 
voidRR '
ManualEntryDataGrid_KeyDownRR 0
(RR0 1
objectRR1 7
senderRR8 >
,RR> ?
KeyRoutedEventArgsRR@ R
eRRS T
)RRT U
{SS 	
varTT 
gridTT 
=TT 
senderTT 
asTT  
DataGridTT! )
;TT) *
ifUU 
(UU 
gridUU 
==UU 
nullUU 
)UU 
returnUU $
;UU$ %
varWW 

shiftStateWW 
=WW 
InputKeyboardSourceWW 0
.WW0 1'
GetKeyStateForCurrentThreadWW1 L
(WWL M

VirtualKeyWWM W
.WWW X
ShiftWWX ]
)WW] ^
;WW^ _
boolXX 
isShiftDownXX 
=XX 
(XX  

shiftStateXX  *
&XX+ , 
CoreVirtualKeyStatesXX- A
.XXA B
DownXXB F
)XXF G
==XXH J 
CoreVirtualKeyStatesXXK _
.XX_ `
DownXX` d
;XXd e
DebugZZ 
.ZZ 
	WriteLineZZ 
(ZZ 
$"ZZ 
$strZZ =
{ZZ= >
eZZ> ?
.ZZ? @
KeyZZ@ C
}ZZC D
$strZZD L
{ZZL M
isShiftDownZZM X
}ZZX Y
$strZZY j
{ZZj k
eZZk l
.ZZl m
OriginalSourceZZm {
}ZZ{ |
$str	ZZ| å
{
ZZå ç
grid
ZZç ë
.
ZZë í
CurrentColumn
ZZí ü
?
ZZü †
.
ZZ† °
Header
ZZ° ß
}
ZZß ®
"
ZZ® ©
)
ZZ© ™
;
ZZ™ ´
}[[ 	
private]] 
void]] &
ManualEntryDataGrid_Tapped]] /
(]]/ 0
object]]0 6
sender]]7 =
,]]= >!
TappedRoutedEventArgs]]? T
e]]U V
)]]V W
{^^ 	
var__ 
grid__ 
=__ 
sender__ 
as__  
DataGrid__! )
;__) *
if`` 
(`` 
grid`` 
==`` 
null`` 
)`` 
return`` $
;``$ %
Debugbb 
.bb 
	WriteLinebb 
(bb 
$"bb 
$strbb G
{bbG H
ebbH I
.bbI J
OriginalSourcebbJ X
}bbX Y
"bbY Z
)bbZ [
;bb[ \
ifee 
(ee 
gridee 
.ee 
ItemsSourceee  
isee! #
IListee$ )
itemsee* /
&&ee0 2
itemsee3 8
.ee8 9
Countee9 >
==ee? A
$numeeB C
)eeC D
{ff 
Debuggg 
.gg 
	WriteLinegg 
(gg  
$strgg  b
)ggb c
;ggc d
ifhh 
(hh 
	ViewModelhh 
.hh 
AddRowCommandhh +
.hh+ ,

CanExecutehh, 6
(hh6 7
nullhh7 ;
)hh; <
)hh< =
{ii 
	ViewModeljj 
.jj 
AddRowCommandjj +
.jj+ ,
Executejj, 3
(jj3 4
nulljj4 8
)jj8 9
;jj9 :
}kk 
}mm 
elsenn 
ifnn 
(nn 
gridnn 
.nn 
SelectedItemnn &
==nn' )
nullnn* .
)nn. /
{oo 
Debugpp 
.pp 
	WriteLinepp 
(pp  
$str	pp  à
)
ppà â
;
ppâ ä
ifrr 
(rr 
gridrr 
.rr 
ItemsSourcerr $
isrr% '
IListrr( -
listrr. 2
&&rr3 5
listrr6 :
.rr: ;
Countrr; @
>rrA B
$numrrC D
)rrD E
{ss 
gridtt 
.tt 
SelectedIndextt &
=tt' (
$numtt) *
;tt* +#
SelectFirstEditableCelluu +
(uu+ ,
griduu, 0
)uu0 1
;uu1 2
}vv 
}ww 
elsexx 
{yy 
Debug}} 
.}} 
	WriteLine}} 
(}}  
$str}}  ^
)}}^ _
;}}_ `
grid~~ 
.~~ 
DispatcherQueue~~ $
.~~$ %

TryEnqueue~~% /
(~~/ 0
(~~0 1
)~~1 2
=>~~3 5
{ 
if
ÄÄ 
(
ÄÄ 
grid
ÄÄ 
.
ÄÄ 
CurrentColumn
ÄÄ *
!=
ÄÄ+ -
null
ÄÄ. 2
&&
ÄÄ3 5
!
ÄÄ6 7
grid
ÄÄ7 ;
.
ÄÄ; <
CurrentColumn
ÄÄ< I
.
ÄÄI J

IsReadOnly
ÄÄJ T
)
ÄÄT U
{
ÅÅ 
Debug
ÇÇ 
.
ÇÇ 
	WriteLine
ÇÇ '
(
ÇÇ' (
$"
ÇÇ( *
$str
ÇÇ* V
{
ÇÇV W
grid
ÇÇW [
.
ÇÇ[ \
SelectedIndex
ÇÇ\ i
}
ÇÇi j
$str
ÇÇj p
{
ÇÇp q
grid
ÇÇq u
.
ÇÇu v
CurrentColumnÇÇv É
.ÇÇÉ Ñ
HeaderÇÇÑ ä
}ÇÇä ã
"ÇÇã å
)ÇÇå ç
;ÇÇç é
grid
ÉÉ 
.
ÉÉ 
	BeginEdit
ÉÉ &
(
ÉÉ& '
)
ÉÉ' (
;
ÉÉ( )
}
ÑÑ 
}
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 
}
áá 	
private
ââ 
void
ââ %
SelectFirstEditableCell
ââ ,
(
ââ, -
DataGrid
ââ- 5
grid
ââ6 :
)
ââ: ;
{
ää 	
Debug
ãã 
.
ãã 
	WriteLine
ãã 
(
ãã 
$str
ãã Q
)
ããQ R
;
ããR S
if
åå 
(
åå 
grid
åå 
.
åå 
ItemsSource
åå  
is
åå! #
IList
åå$ )
items
åå* /
&&
åå0 2
items
åå3 8
.
åå8 9
Count
åå9 >
>
åå? @
$num
ååA B
)
ååB C
{
çç 
var
èè 
firstEditable
èè !
=
èè" #
grid
èè$ (
.
èè( )
Columns
èè) 0
.
èè0 1
OrderBy
èè1 8
(
èè8 9
c
èè9 :
=>
èè; =
c
èè> ?
.
èè? @
DisplayIndex
èè@ L
)
èèL M
.
èèM N
FirstOrDefault
èèN \
(
èè\ ]
c
èè] ^
=>
èè_ a
!
èèb c
c
èèc d
.
èèd e

IsReadOnly
èèe o
)
èèo p
;
èèp q
if
êê 
(
êê 
firstEditable
êê !
!=
êê" $
null
êê% )
)
êê) *
{
ëë 
Debug
íí 
.
íí 
	WriteLine
íí #
(
íí# $
$"
íí$ &
$str
íí& g
{
ííg h
firstEditable
ííh u
.
ííu v
Header
íív |
}
íí| }
$stríí} ´
"íí´ ¨
)íí¨ ≠
;íí≠ Æ
grid
ìì 
.
ìì 
CurrentColumn
ìì &
=
ìì' (
firstEditable
ìì) 6
;
ìì6 7
grid
îî 
.
îî 
Focus
îî 
(
îî 
	Microsoft
îî (
.
îî( )
UI
îî) +
.
îî+ ,
Xaml
îî, 0
.
îî0 1

FocusState
îî1 ;
.
îî; <
Programmatic
îî< H
)
îîH I
;
îîI J
grid
ïï 
.
ïï 
	BeginEdit
ïï "
(
ïï" #
)
ïï# $
;
ïï$ %
Debug
ññ 
.
ññ 
	WriteLine
ññ #
(
ññ# $
$"
ññ$ &
$str
ññ& m
{
ññm n
firstEditable
ññn {
.
ññ{ |
Headerññ| Ç
}ññÇ É
"ññÉ Ñ
)ññÑ Ö
;ññÖ Ü
}
óó 
else
òò 
{
ôô 
Debug
öö 
.
öö 
	WriteLine
öö #
(
öö# $
$str
öö$ j
)
ööj k
;
öök l
}
õõ 
}
úú 
else
ùù 
{
ûû 
var
üü 
	itemCount
üü 
=
üü 
(
üü  !
grid
üü! %
.
üü% &
ItemsSource
üü& 1
as
üü2 4
IList
üü5 :
)
üü: ;
?
üü; <
.
üü< =
Count
üü= B
??
üüC E
$num
üüF G
;
üüG H
Debug
†† 
.
†† 
	WriteLine
†† 
(
††  
$"
††  "
$str
††" f
{
††f g
	itemCount
††g p
}
††p q
$str
††q r
"
††r s
)
††s t
;
††t u
}
°° 
}
¢¢ 	
}
££ 
}§§ ä
eC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_LoadEntryView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class #
Receiving_LoadEntryView  7
:8 9
UserControl: E
{ 
public (
Receiving_LoadEntryViewModel +
	ViewModel, 5
{6 7
get8 ;
;; <
}= >
public

 #
Receiving_LoadEntryView

 &
(

& '
)

' (
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '(
Receiving_LoadEntryViewModel' C
>C D
(D E
)E F
;F G
this 
. 
InitializeComponent $
($ %
)% &
;& '
} 	
} 
} Û
cC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_HeatLotView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class !
Receiving_HeatLotView  5
:6 7
UserControl8 C
{ 
public		 &
Receiving_HeatLotViewModel		 )
	ViewModel		* 3
{		4 5
get		6 9
;		9 :
}		; <
public !
Receiving_HeatLotView $
($ %
)% &
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '&
Receiving_HeatLotViewModel' A
>A B
(B C
)C D
;D E
this 
. 
InitializeComponent $
($ %
)% &
;& '
this 
. 
Loaded 
+= 
HeatLotView_Loaded -
;- .
} 	
private 
async 
void 
HeatLotView_Loaded -
(- .
object. 4
sender5 ;
,; <
RoutedEventArgs= L
eM N
)N O
{ 	
await 
	ViewModel 
. 
OnNavigatedToAsync .
(. /
)/ 0
;0 1
} 	
} 
} ßM
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Receiving\Receiving_EditModeView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
	Receiving* 3
{ 
public 

sealed 
partial 
class "
Receiving_EditModeView  6
:7 8
UserControl9 D
{ 
public '
Receiving_EditModeViewModel *
	ViewModel+ 4
{5 6
get7 :
;: ;
}< =
public "
Receiving_EditModeView %
(% &
)& '
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& ''
Receiving_EditModeViewModel' B
>B C
(C D
)D E
;E F
this 
. 
DataContext 
= 
	ViewModel (
;( )
this 
. 
InitializeComponent $
($ %
)% &
;& '
} 	
private 
void /
#EditModeDataGrid_CurrentCellChanged 8
(8 9
object9 ?
?? @
senderA G
,G H
	EventArgsI R
eS T
)T U
{ 	
var 
grid 
= 
sender 
as  
DataGrid! )
;) *
if 
( 
grid 
!= 
null 
) 
{ 
grid   
.   
DispatcherQueue   $
.  $ %

TryEnqueue  % /
(  / 0
(  0 1
)  1 2
=>  3 5
{!! 
if"" 
("" 
grid"" 
."" 
CurrentColumn"" *
!=""+ -
null"". 2
&&""3 5
!""6 7
grid""7 ;
.""; <
CurrentColumn""< I
.""I J

IsReadOnly""J T
)""T U
{## 
Debug$$ 
.$$ 
	WriteLine$$ '
($$' (
$"$$( *
$str$$* _
{$$_ `
grid$$` d
.$$d e
SelectedIndex$$e r
}$$r s
$str$$s y
{$$y z
grid$$z ~
.$$~ 
CurrentColumn	$$ å
.
$$å ç
Header
$$ç ì
}
$$ì î
"
$$î ï
)
$$ï ñ
;
$$ñ ó
grid%% 
.%% 
	BeginEdit%% &
(%%& '
)%%' (
;%%( )
}&& 
}'' 
)'' 
;'' 
}(( 
})) 	
private++ 
void++ $
EditModeDataGrid_KeyDown++ -
(++- .
object++. 4
sender++5 ;
,++; <
KeyRoutedEventArgs++= O
e++P Q
)++Q R
{,, 	
var-- 
grid-- 
=-- 
sender-- 
as--  
DataGrid--! )
;--) *
if.. 
(.. 
grid.. 
==.. 
null.. 
).. 
return.. $
;..$ %
var00 

shiftState00 
=00 
InputKeyboardSource00 0
.000 1'
GetKeyStateForCurrentThread001 L
(00L M

VirtualKey00M W
.00W X
Shift00X ]
)00] ^
;00^ _
bool11 
isShiftDown11 
=11 
(11  

shiftState11  *
&11+ , 
CoreVirtualKeyStates11- A
.11A B
Down11B F
)11F G
==11H J 
CoreVirtualKeyStates11K _
.11_ `
Down11` d
;11d e
Debug33 
.33 
	WriteLine33 
(33 
$"33 
$str33 :
{33: ;
e33; <
.33< =
Key33= @
}33@ A
$str33A I
{33I J
isShiftDown33J U
}33U V
$str33V g
{33g h
e33h i
.33i j
OriginalSource33j x
}33x y
$str	33y â
{
33â ä
grid
33ä é
.
33é è
CurrentColumn
33è ú
?
33ú ù
.
33ù û
Header
33û §
}
33§ •
"
33• ¶
)
33¶ ß
;
33ß ®
}44 	
private66 
void66 #
EditModeDataGrid_Tapped66 ,
(66, -
object66- 3
sender664 :
,66: ;!
TappedRoutedEventArgs66< Q
e66R S
)66S T
{77 	
var88 
grid88 
=88 
sender88 
as88  
DataGrid88! )
;88) *
if99 
(99 
grid99 
==99 
null99 
)99 
return99 $
;99$ %
Debug;; 
.;; 
	WriteLine;; 
(;; 
$";; 
$str;; D
{;;D E
e;;E F
.;;F G
OriginalSource;;G U
};;U V
";;V W
);;W X
;;;X Y
if>> 
(>> 
grid>> 
.>> 
SelectedItem>> !
==>>" $
null>>% )
)>>) *
{?? 
Debug@@ 
.@@ 
	WriteLine@@ 
(@@  
$str	@@  Ö
)
@@Ö Ü
;
@@Ü á
ifBB 
(BB 
gridBB 
.BB 
ItemsSourceBB $
isBB% '
IListBB( -
listBB. 2
&&BB3 5
listBB6 :
.BB: ;
CountBB; @
>BBA B
$numBBC D
)BBD E
{CC 
gridDD 
.DD 
SelectedIndexDD &
=DD' (
$numDD) *
;DD* +#
SelectFirstEditableCellEE +
(EE+ ,
gridEE, 0
)EE0 1
;EE1 2
}FF 
}GG 
elseHH 
{II 
DebugMM 
.MM 
	WriteLineMM 
(MM  
$strMM  [
)MM[ \
;MM\ ]
gridNN 
.NN 
DispatcherQueueNN $
.NN$ %

TryEnqueueNN% /
(NN/ 0
(NN0 1
)NN1 2
=>NN3 5
{OO 
ifPP 
(PP 
gridPP 
.PP 
CurrentColumnPP *
!=PP+ -
nullPP. 2
&&PP3 5
!PP6 7
gridPP7 ;
.PP; <
CurrentColumnPP< I
.PPI J

IsReadOnlyPPJ T
)PPT U
{QQ 
DebugRR 
.RR 
	WriteLineRR '
(RR' (
$"RR( *
$strRR* S
{RRS T
gridRRT X
.RRX Y
SelectedIndexRRY f
}RRf g
$strRRg m
{RRm n
gridRRn r
.RRr s
CurrentColumn	RRs Ä
.
RRÄ Å
Header
RRÅ á
}
RRá à
"
RRà â
)
RRâ ä
;
RRä ã
gridSS 
.SS 
	BeginEditSS &
(SS& '
)SS' (
;SS( )
}TT 
}UU 
)UU 
;UU 
}VV 
}WW 	
privateYY 
voidYY #
SelectFirstEditableCellYY ,
(YY, -
DataGridYY- 5
gridYY6 :
)YY: ;
{ZZ 	
Debug[[ 
.[[ 
	WriteLine[[ 
([[ 
$str[[ N
)[[N O
;[[O P
if\\ 
(\\ 
grid\\ 
.\\ 
ItemsSource\\  
is\\! #
IList\\$ )
items\\* /
&&\\0 2
items\\3 8
.\\8 9
Count\\9 >
>\\? @
$num\\A B
)\\B C
{]] 
var__ 
firstEditable__ !
=__" #
grid__$ (
.__( )
Columns__) 0
.__0 1
OrderBy__1 8
(__8 9
c__9 :
=>__; =
c__> ?
.__? @
DisplayIndex__@ L
)__L M
.__M N
FirstOrDefault__N \
(__\ ]
c__] ^
=>___ a
!__b c
c__c d
.__d e

IsReadOnly__e o
)__o p
;__p q
if`` 
(`` 
firstEditable`` !
!=``" $
null``% )
)``) *
{aa 
Debugbb 
.bb 
	WriteLinebb #
(bb# $
$"bb$ &
$strbb& d
{bbd e
firstEditablebbe r
.bbr s
Headerbbs y
}bby z
$str	bbz ®
"
bb® ©
)
bb© ™
;
bb™ ´
gridcc 
.cc 
CurrentColumncc &
=cc' (
firstEditablecc) 6
;cc6 7
griddd 
.dd 
Focusdd 
(dd 
	Microsoftdd (
.dd( )
UIdd) +
.dd+ ,
Xamldd, 0
.dd0 1

FocusStatedd1 ;
.dd; <
Programmaticdd< H
)ddH I
;ddI J
gridee 
.ee 
	BeginEditee "
(ee" #
)ee# $
;ee$ %
Debugff 
.ff 
	WriteLineff #
(ff# $
$"ff$ &
$strff& j
{ffj k
firstEditableffk x
.ffx y
Headerffy 
}	ff Ä
"
ffÄ Å
)
ffÅ Ç
;
ffÇ É
}gg 
elsehh 
{ii 
Debugjj 
.jj 
	WriteLinejj #
(jj# $
$strjj$ g
)jjg h
;jjh i
}kk 
}ll 
elsemm 
{nn 
varoo 
	itemCountoo 
=oo 
(oo  !
gridoo! %
.oo% &
ItemsSourceoo& 1
asoo2 4
IListoo5 :
)oo: ;
?oo; <
.oo< =
Countoo= B
??ooC E
$numooF G
;ooG H
Debugpp 
.pp 
	WriteLinepp 
(pp  
$"pp  "
$strpp" c
{ppc d
	itemCountppd m
}ppm n
$strppn o
"ppo p
)ppp q
;ppq r
}qq 
}rr 	
}ss 
}tt ï
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Main\Main_ReceivingLabelPage.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Main* .
;. /
public		 
sealed		 
partial		 
class		 #
Main_ReceivingLabelPage		 3
:		4 5
Page		6 :
{

 
public 
(
Main_ReceivingLabelViewModel '
	ViewModel( 1
{2 3
get4 7
;7 8
}9 :
public 
#
Main_ReceivingLabelPage "
(" #
)# $
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 

GetService "
<" #(
Main_ReceivingLabelViewModel# ?
>? @
(@ A
)A B
;B C
DataContext 
= 
	ViewModel 
;  
} 
} ã
^C:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Main\Main_DunnageLabelPage.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Main* .
;. /
public		 
sealed		 
partial		 
class		 !
Main_DunnageLabelPage		 1
:		2 3
Page		4 8
{

 
public 
&
Main_DunnageLabelViewModel %
	ViewModel& /
{0 1
get2 5
;5 6
}7 8
public 
!
Main_DunnageLabelPage  
(  !
)! "
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 

GetService "
<" #&
Main_DunnageLabelViewModel# =
>= >
(> ?
)? @
;@ A
DataContext 
= 
	ViewModel 
;  
} 
} ≥
fC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Main\Main_CarrierDeliveryLabelPage.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Main* .
;. /
public		 
sealed		 
partial		 
class		 )
Main_CarrierDeliveryLabelPage		 9
:		: ;
Page		< @
{

 
public 
.
"Main_CarrierDeliveryLabelViewModel -
	ViewModel. 7
{8 9
get: =
;= >
}? @
public 
)
Main_CarrierDeliveryLabelPage (
(( )
)) *
{ 
InitializeComponent 
( 
) 
; 
	ViewModel 
= 
App 
. 

GetService "
<" #.
"Main_CarrierDeliveryLabelViewModel# E
>E F
(F G
)G H
;H I
DataContext 
= 
	ViewModel 
;  
} 
} ‚
hC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Helpers\SpecInputTemplateSelector.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
.1 2
Helpers2 9
;9 :
public 
class %
SpecInputTemplateSelector &
:' ( 
DataTemplateSelector) =
{ 
public 

DataTemplate 
? 
TextTemplate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

DataTemplate 
? 
NumberTemplate '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 

DataTemplate 
? 
BooleanTemplate (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
	protected 
override 
DataTemplate #
?# $
SelectTemplateCore% 7
(7 8
object8 >
item? C
)C D
{ 
if 

( 
item 
is 
SpecInputViewModel &
spec' +
)+ ,
{ 	
return 
spec 
. 
DataType  
.  !
ToLower! (
(( )
)) *
switch+ 1
{ 
$str 
=> 
TextTemplate &
,& '
$str 
=> 
NumberTemplate *
,* +
$str 
=> 
BooleanTemplate ,
,, -
_ 
=> 
TextTemplate !
} 
; 
} 	
return 
base 
. 
SelectTemplateCore &
(& '
item' +
)+ ,
;, -
} 
	protected!! 
override!! 
DataTemplate!! #
?!!# $
SelectTemplateCore!!% 7
(!!7 8
object!!8 >
item!!? C
,!!C D
DependencyObject!!E U
	container!!V _
)!!_ `
{"" 
return## 
SelectTemplateCore## !
(##! "
item##" &
)##& '
;##' (
}$$ 
}%% ¿
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_WorkflowView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public 
sealed 
partial 
class  
Dunnage_WorkflowView 0
:1 2
Page3 7
{ 
public 
&
Main_DunnageLabelViewModel %
	ViewModel& /
{0 1
get2 5
;5 6
}7 8
public

 
 
Dunnage_WorkflowView

 
(

  
)

  !
{ 
	ViewModel 
= 
App 
. 

GetService "
<" #&
Main_DunnageLabelViewModel# =
>= >
(> ?
)? @
;@ A
InitializeComponent 
( 
) 
; 
} 
} –
eC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_TypeSelectionView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public 
sealed 
partial 
class %
Dunnage_TypeSelectionView 5
:6 7
UserControl8 C
{ 
public 
*
Dunnage_TypeSelectionViewModel )
	ViewModel* 3
{4 5
get6 9
;9 :
}; <
public 
%
Dunnage_TypeSelectionView $
($ %
)% &
{ 
	ViewModel 
= 
App 
. 

GetService "
<" #*
Dunnage_TypeSelectionViewModel# A
>A B
(B C
)C D
;D E
InitializeComponent 
( 
) 
; 
} 
private 
async 
void 
OnLoaded 
(  
object  &
sender' -
,- .
RoutedEventArgs/ >
e? @
)@ A
{ 
await 
	ViewModel 
. 
InitializeAsync '
(' (
)( )
;) *
} 
private 
async 
void 
TypeCard_ItemClick )
() *
object* 0
sender1 7
,7 8
ItemClickEventArgs9 K
eL M
)M N
{ 
if 

( 
e 
. 
ClickedItem 
is 
Model_DunnageType .
type/ 3
)3 4
{ 	
await 
	ViewModel 
. 
SelectTypeCommand -
.- .
ExecuteAsync. :
(: ;
type; ?
)? @
;@ A
} 	
}   
}!! à

^C:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_ReviewView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public 
sealed 
partial 
class 
Dunnage_ReviewView .
:/ 0
UserControl1 <
{ 
public		 
#
Dunnage_ReviewViewModel		 "
	ViewModel		# ,
{		- .
get		/ 2
;		2 3
}		4 5
public 

Dunnage_ReviewView 
( 
) 
{ 
	ViewModel 
= 
App 
. 

GetService "
<" ##
Dunnage_ReviewViewModel# :
>: ;
(; <
)< =
;= >
InitializeComponent 
( 
) 
; 
} 
private 
void 
OnLoaded 
( 
object  
sender! '
,' (
RoutedEventArgs) 8
e9 :
): ;
{ 
	ViewModel 
. 
LoadSessionLoads "
(" #
)# $
;$ %
} 
} ûF
fC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_QuickAddTypeDialog.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public		 
sealed		 
partial		 
class		 &
Dunnage_QuickAddTypeDialog		 6
:		7 8
ContentDialog		9 F
,		F G"
INotifyPropertyChanged		H ^
{

 
private 
bool 
_isIconSelected  
;  !
private 
string 
_selectedIcon  
=! "
$str# +
;+ ,
private 
string 
_selectedIconName $
=% &
$str' ,
;, -
public 

string 
TypeName 
{ 
get  
;  !
private" )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 

string 
SelectedIconGlyph #
{$ %
get& )
;) *
private+ 2
set3 6
;6 7
}8 9
=: ;
$str< D
;D E
public 

bool 
IsIconSelected 
{ 
get 
=> 
_isIconSelected 
; 
set 
{ 	
_isIconSelected 
= 
value #
;# $
OnPropertyChanged 
( 
) 
;  
} 	
} 
public 

event '
PropertyChangedEventHandler ,
?, -
PropertyChanged. =
;= >
public 
&
Dunnage_QuickAddTypeDialog %
(% &
)& '
{ 
InitializeComponent   
(   
)   
;   
IsIconSelected!! 
=!! 
true!! 
;!! 
}"" 
private$$ 
async$$ 
void$$ 
OnSelectIconClick$$ (
($$( )
object$$) /
sender$$0 6
,$$6 7
RoutedEventArgs$$8 G
e$$H I
)$$I J
{%% 
var&& 

iconWindow&& 
=&& 
new&& 
Shared&& #
.&&# $%
Shared_IconSelectorWindow&&$ =
(&&= >
)&&> ?
;&&? @
var)) 
hwnd)) 
=)) 
WinRT)) 
.)) 
Interop))  
.))  !
WindowNative))! -
.))- .
GetWindowHandle)). =
())= >

iconWindow))> H
)))H I
;))I J
var** 
windowId** 
=** 
	Microsoft**  
.**  !
UI**! #
.**# $
Win32Interop**$ 0
.**0 1!
GetWindowIdFromWindow**1 F
(**F G
hwnd**G K
)**K L
;**L M
var++ 
	appWindow++ 
=++ 
	Microsoft++ !
.++! "
UI++" $
.++$ %
	Windowing++% .
.++. /
	AppWindow++/ 8
.++8 9
GetFromWindowId++9 H
(++H I
windowId++I Q
)++Q R
;++R S

iconWindow-- 
.-- 
Activate-- 
(-- 
)-- 
;-- 
var00 
tcs00 
=00 
new00 
System00 
.00 
	Threading00 &
.00& '
Tasks00' ,
.00, - 
TaskCompletionSource00- A
<00A B
bool00B F
>00F G
(00G H
)00H I
;00I J

iconWindow11 
.11 
Closed11 
+=11 
(11 
s11 
,11  
args11! %
)11% &
=>11' )
tcs11* -
.11- .
	SetResult11. 7
(117 8
true118 <
)11< =
;11= >
await22 
tcs22 
.22 
Task22 
;22 
if55 

(55 

iconWindow55 
.55 
IconWasSelected55 &
&&55' )

iconWindow55* 4
.554 5
SelectedIconGlyph555 F
!=55G I
null55J N
)55N O
{66 	
_selectedIcon77 
=77 

iconWindow77 &
.77& '
SelectedIconGlyph77' 8
;778 9
_selectedIconName88 
=88 

iconWindow88  *
.88* +
SelectedIconName88+ ;
??88< >
$str88? E
;88E F
SelectedIconDisplay:: 
.::  
Glyph::  %
=::& '
_selectedIcon::( 5
;::5 6 
SelectedIconNameText;;  
.;;  !
Text;;! %
=;;& '
_selectedIconName;;( 9
;;;9 :
IsIconSelected<< 
=<< 
true<< !
;<<! "
}== 	
}>> 
private@@ 
void@@ 
OnTypeNameChanged@@ "
(@@" #
object@@# )
sender@@* 0
,@@0 1 
TextChangedEventArgs@@2 F
e@@G H
)@@H I
{AA 
varBB 
textBoxBB 
=BB 
(BB 
TextBoxBB 
)BB 
senderBB %
;BB% &
ValidationTextBlockCC 
.CC 

VisibilityCC &
=CC' (

VisibilityCC) 3
.CC3 4
	CollapsedCC4 =
;CC= >
}DD 
privateFF 
voidFF  
OnPrimaryButtonClickFF %
(FF% &
ContentDialogFF& 3
senderFF4 :
,FF: ;-
!ContentDialogButtonClickEventArgsFF< ]
argsFF^ b
)FFb c
{GG 
varHH 
inputHH 
=HH 
TypeNameTextBoxHH #
.HH# $
TextHH$ (
.HH( )
TrimHH) -
(HH- .
)HH. /
;HH/ 0
ifKK 

(KK 
stringKK 
.KK 
IsNullOrWhiteSpaceKK %
(KK% &
inputKK& +
)KK+ ,
)KK, -
{LL 	
	ShowErrorMM 
(MM 
$strMM -
)MM- .
;MM. /
argsNN 
.NN 
CancelNN 
=NN 
trueNN 
;NN 
returnOO 
;OO 
}PP 	
ifSS 

(SS 
!SS 
charSS 
.SS 
IsUpperSS 
(SS 
inputSS 
[SS  
$numSS  !
]SS! "
)SS" #
)SS# $
{TT 	
	ShowErrorUU 
(UU 
$strUU =
)UU= >
;UU> ?
argsVV 
.VV 
CancelVV 
=VV 
trueVV 
;VV 
returnWW 
;WW 
}XX 	
if[[ 

([[ 
input[[ 
.[[ 
Contains[[ 
([[ 
$str[[ 
)[[ 
)[[  
{\\ 	
	ShowError]] 
(]] 
$str]] 2
)]]2 3
;]]3 4
args^^ 
.^^ 
Cancel^^ 
=^^ 
true^^ 
;^^ 
return__ 
;__ 
}`` 	
ifcc 

(cc 
!cc 
Systemcc 
.cc 
Textcc 
.cc 
RegularExpressionscc +
.cc+ ,
Regexcc, 1
.cc1 2
IsMatchcc2 9
(cc9 :
inputcc: ?
,cc? @
$strccA Q
)ccQ R
)ccR S
{dd 	
	ShowErroree 
(ee 
$stree >
)ee> ?
;ee? @
argsff 
.ff 
Cancelff 
=ff 
trueff 
;ff 
returngg 
;gg 
}hh 	
TypeNamekk 
=kk 
inputkk 
;kk 
SelectedIconGlyphll 
=ll 
_selectedIconll )
;ll) *
}mm 
privateoo 
voidoo 
	ShowErroroo 
(oo 
stringoo !
messageoo" )
)oo) *
{pp 
ValidationTextBlockqq 
.qq 
Textqq  
=qq! "
messageqq# *
;qq* +
ValidationTextBlockrr 
.rr 

Visibilityrr &
=rr' (

Visibilityrr) 3
.rr3 4
Visiblerr4 ;
;rr; <
}ss 
privateuu 
voiduu 
OnPropertyChangeduu "
(uu" #
[uu# $
CallerMemberNameuu$ 4
]uu4 5
stringuu6 <
?uu< =
propertyNameuu> J
=uuK L
nulluuM Q
)uuQ R
{vv 
PropertyChangedww 
?ww 
.ww 
Invokeww 
(ww  
thisww  $
,ww$ %
newww& )$
PropertyChangedEventArgsww* B
(wwB C
propertyNamewwC O
)wwO P
)wwP Q
;wwQ R
}xx 
}yy Ñ2
fC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_QuickAddPartDialog.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public 
sealed 
partial 
class &
Dunnage_QuickAddPartDialog 6
:7 8
ContentDialog9 F
{		 
public

 

string

 
PartId

 
{

 
get

 
;

 
private

  '
set

( +
;

+ ,
}

- .
=

/ 0
string

1 7
.

7 8
Empty

8 =
;

= >
public 

int 
TypeId 
{ 
get 
; 
private $
set% (
;( )
}* +
public 

string 
TypeName 
{ 
get  
;  !
private" )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 

string 
SpecValuesJson  
{! "
get# &
;& '
private( /
set0 3
;3 4
}5 6
=7 8
string9 ?
.? @
Empty@ E
;E F
public 
&
Dunnage_QuickAddPartDialog %
(% &
int& )
typeId* 0
,0 1
string2 8
typeName9 A
)A B
{ 
InitializeComponent 
( 
) 
; 
TypeId 
= 
typeId 
; 
TypeName 
= 
typeName 
; 
TypeNameTextBlock 
. 
Text 
=  
typeName! )
;) *
} 
private 
void 
OnPartIdChanged  
(  !
object! '
sender( .
,. / 
TextChangedEventArgs0 D
eE F
)F G
{ 
var 
textBox 
= 
( 
TextBox 
) 
sender %
;% &%
PartIdValidationTextBlock !
.! "

Visibility" ,
=- .
string/ 5
.5 6
IsNullOrWhiteSpace6 H
(H I
textBoxI P
.P Q
TextQ U
)U V
? 

Visibility 
. 
Visible  
: 

Visibility 
. 
	Collapsed "
;" #
} 
private   
void    
OnPrimaryButtonClick   %
(  % &
ContentDialog  & 3
sender  4 :
,  : ;-
!ContentDialogButtonClickEventArgs  < ]
args  ^ b
)  b c
{!! 
if## 

(## 
string## 
.## 
IsNullOrWhiteSpace## %
(##% &
PartIdTextBox##& 3
.##3 4
Text##4 8
)##8 9
)##9 :
{$$ 	%
PartIdValidationTextBlock%% %
.%%% &

Visibility%%& 0
=%%1 2

Visibility%%3 =
.%%= >
Visible%%> E
;%%E F
args&& 
.&& 
Cancel&& 
=&& 
true&& 
;&& 
return'' 
;'' 
}(( 	
PartId++ 
=++ 
PartIdTextBox++ 
.++ 
Text++ #
.++# $
Trim++$ (
(++( )
)++) *
;++* +
var.. 

specValues.. 
=.. 
new.. 

Dictionary.. '
<..' (
string..( .
,... /
object..0 6
>..6 7
(..7 8
)..8 9
;..9 :
if11 

(11 
!11 
double11 
.11 
IsNaN11 
(11 
WidthNumberBox11 (
.11( )
Value11) .
)11. /
&&110 2
WidthNumberBox113 A
.11A B
Value11B G
>11H I
$num11J K
)11K L
{22 	

specValues33 
[33 
$str33 
]33 
=33  !
WidthNumberBox33" 0
.330 1
Value331 6
;336 7
}44 	
if66 

(66 
!66 
double66 
.66 
IsNaN66 
(66 
HeightNumberBox66 )
.66) *
Value66* /
)66/ 0
&&661 3
HeightNumberBox664 C
.66C D
Value66D I
>66J K
$num66L M
)66M N
{77 	

specValues88 
[88 
$str88 
]88  
=88! "
HeightNumberBox88# 2
.882 3
Value883 8
;888 9
}99 	
if;; 

(;; 
!;; 
double;; 
.;; 
IsNaN;; 
(;; 
DepthNumberBox;; (
.;;( )
Value;;) .
);;. /
&&;;0 2
DepthNumberBox;;3 A
.;;A B
Value;;B G
>;;H I
$num;;J K
);;K L
{<< 	

specValues== 
[== 
$str== 
]== 
===  !
DepthNumberBox==" 0
.==0 1
Value==1 6
;==6 7
}>> 	
ifAA 

(AA 
!AA 
stringAA 
.AA 
IsNullOrWhiteSpaceAA &
(AA& '
NotesTextBoxAA' 3
.AA3 4
TextAA4 8
)AA8 9
)AA9 :
{BB 	

specValuesCC 
[CC 
$strCC 
]CC 
=CC  !
NotesTextBoxCC" .
.CC. /
TextCC/ 3
.CC3 4
TrimCC4 8
(CC8 9
)CC9 :
;CC: ;
}DD 	
ifGG 

(GG 

specValuesGG 
.GG 
CountGG 
>GG 
$numGG  
)GG  !
{HH 	
SpecValuesJsonII 
=II 
JsonSerializerII +
.II+ ,
	SerializeII, 5
(II5 6

specValuesII6 @
)II@ A
;IIA B
}JJ 	
elseKK 
{LL 	
SpecValuesJsonMM 
=MM 
$strMM !
;MM! "
}NN 	
}OO 
}PP ™

eC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_QuantityEntryView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public 
sealed 
partial 
class %
Dunnage_QuantityEntryView 5
:6 7
UserControl8 C
{ 
public		 
*
Dunnage_QuantityEntryViewModel		 )
	ViewModel		* 3
{		4 5
get		6 9
;		9 :
}		; <
public 
%
Dunnage_QuantityEntryView $
($ %
)% &
{ 
	ViewModel 
= 
App 
. 

GetService "
<" #*
Dunnage_QuantityEntryViewModel# A
>A B
(B C
)C D
;D E
InitializeComponent 
( 
) 
; 
} 
private 
void 
OnLoaded 
( 
object  
sender! '
,' (
RoutedEventArgs) 8
e9 :
): ;
{ 
	ViewModel 
. 
LoadContextData !
(! "
)" #
;# $
} 
} –

eC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_PartSelectionView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public 
sealed 
partial 
class %
Dunnage_PartSelectionView 5
:6 7
UserControl8 C
{ 
public		 
*
Dunnage_PartSelectionViewModel		 )
	ViewModel		* 3
{		4 5
get		6 9
;		9 :
}		; <
public 
%
Dunnage_PartSelectionView $
($ %
)% &
{ 
	ViewModel 
= 
App 
. 

GetService "
<" #*
Dunnage_PartSelectionViewModel# A
>A B
(B C
)C D
;D E
InitializeComponent 
( 
) 
; 
} 
private 
async 
void 
OnLoaded 
(  
object  &
sender' -
,- .
RoutedEventArgs/ >
e? @
)@ A
{ 
await 
	ViewModel 
. 
InitializeAsync '
(' (
)( )
;) *
} 
} ﬁ
eC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_ModeSelectionView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public		 
sealed		 
partial		 
class		 %
Dunnage_ModeSelectionView		 5
:		6 7
UserControl		8 C
{

 
public 
*
Dunnage_ModeSelectionViewModel )
	ViewModel* 3
{4 5
get6 9
;9 :
}; <
public 
%
Dunnage_ModeSelectionView $
($ %
)% &
{ 
	ViewModel 
= 
App 
. 

GetService "
<" #*
Dunnage_ModeSelectionViewModel# A
>A B
(B C
)C D
;D E
InitializeComponent 
( 
) 
; 
} 
} Öp
cC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_ManualEntryView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
{ 
public 

sealed 
partial 
class #
Dunnage_ManualEntryView  7
:8 9
UserControl: E
{ 
public (
Dunnage_ManualEntryViewModel +
	ViewModel, 5
{6 7
get8 ;
;; <
}= >
public #
Dunnage_ManualEntryView &
(& '
)' (
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '(
Dunnage_ManualEntryViewModel' C
>C D
(D E
)E F
;F G
this 
. 
DataContext 
= 
	ViewModel (
;( )
this 
. 
InitializeComponent $
($ %
)% &
;& '
	ViewModel 
. 
Loads 
. 
CollectionChanged -
+=. 0#
Loads_CollectionChanged1 H
;H I
} 	
private 
void #
Loads_CollectionChanged ,
(, -
object- 3
?3 4
sender5 ;
,; <
System= C
.C D
CollectionsD O
.O P
SpecializedP [
.[ \,
 NotifyCollectionChangedEventArgs\ |
e} ~
)~ 
{   	
if!! 
(!! 
e!! 
.!! 
Action!! 
==!! 
System!! "
.!!" #
Collections!!# .
.!!. /
Specialized!!/ :
.!!: ;)
NotifyCollectionChangedAction!!; X
.!!X Y
Add!!Y \
)!!\ ]
{"" 
Debug## 
.## 
	WriteLine## 
(##  
$str##  b
)##b c
;##c d
ManualEntryDataGrid%% #
.%%# $
DispatcherQueue%%$ 3
.%%3 4

TryEnqueue%%4 >
(%%> ?
(%%? @
)%%@ A
=>%%B D
{&& 
if'' 
('' 
	ViewModel'' !
.''! "
Loads''" '
.''' (
Count''( -
>''. /
$num''0 1
)''1 2
{(( 
var** 
newItem** #
=**$ %
e**& '
.**' (
NewItems**( 0
?**0 1
[**1 2
$num**2 3
]**3 4
as**5 7
Model_DunnageLoad**8 I
;**I J
if++ 
(++ 
newItem++ #
!=++$ &
null++' +
)+++ ,
{,, 
Debug-- !
.--! "
	WriteLine--" +
(--+ ,
$"--, .
$str--. 
{	-- Ä
newItem
--Ä á
.
--á à

LoadNumber
--à í
}
--í ì
"
--ì î
)
--î ï
;
--ï ñ
ManualEntryDataGrid.. /
.../ 0
SelectedItem..0 <
=..= >
newItem..? F
;..F G
ManualEntryDataGrid// /
./// 0
ScrollIntoView//0 >
(//> ?
newItem//? F
,//F G
ManualEntryDataGrid//H [
.//[ \
Columns//\ c
.//c d
FirstOrDefault//d r
(//r s
)//s t
)//t u
;//u v
_22 
=22 
Task22  $
.22$ %
Run22% (
(22( )
async22) .
(22/ 0
)220 1
=>222 4
{33 
await44  %
Task44& *
.44* +
Delay44+ 0
(440 1
$num441 4
)444 5
;445 6
ManualEntryDataGrid55  3
.553 4
DispatcherQueue554 C
.55C D

TryEnqueue55D N
(55N O
(55O P
)55P Q
=>55R T
{66  !#
SelectFirstEditableCell77$ ;
(77; <
ManualEntryDataGrid77< O
)77O P
;77P Q
}88  !
)88! "
;88" #
}99 
)99 
;99 
}:: 
};; 
}<< 
)<< 
;<< 
}== 
}>> 	
private@@ 
void@@ 2
&ManualEntryDataGrid_CurrentCellChanged@@ ;
(@@; <
object@@< B
?@@B C
sender@@D J
,@@J K
	EventArgs@@L U
e@@V W
)@@W X
{AA 	
varBB 
gridBB 
=BB 
senderBB 
asBB  
DataGridBB! )
;BB) *
ifCC 
(CC 
gridCC 
!=CC 
nullCC 
)CC 
{DD 
gridFF 
.FF 
DispatcherQueueFF $
.FF$ %

TryEnqueueFF% /
(FF/ 0
(FF0 1
)FF1 2
=>FF3 5
{GG 
ifHH 
(HH 
gridHH 
.HH 
CurrentColumnHH *
!=HH+ -
nullHH. 2
&&HH3 5
!HH6 7
gridHH7 ;
.HH; <
CurrentColumnHH< I
.HHI J

IsReadOnlyHHJ T
)HHT U
{II 
DebugJJ 
.JJ 
	WriteLineJJ '
(JJ' (
$"JJ( *
$strJJ* j
{JJj k
gridJJk o
.JJo p
SelectedIndexJJp }
}JJ} ~
$str	JJ~ Ñ
{
JJÑ Ö
grid
JJÖ â
.
JJâ ä
CurrentColumn
JJä ó
.
JJó ò
Header
JJò û
}
JJû ü
"
JJü †
)
JJ† °
;
JJ° ¢
gridKK 
.KK 
	BeginEditKK &
(KK& '
)KK' (
;KK( )
}LL 
}MM 
)MM 
;MM 
}NN 
}OO 	
privateQQ 
voidQQ '
ManualEntryDataGrid_KeyDownQQ 0
(QQ0 1
objectQQ1 7
senderQQ8 >
,QQ> ?
KeyRoutedEventArgsQQ@ R
eQQS T
)QQT U
{RR 	
varSS 
gridSS 
=SS 
senderSS 
asSS  
DataGridSS! )
;SS) *
ifTT 
(TT 
gridTT 
==TT 
nullTT 
)TT 
returnTT $
;TT$ %
varVV 

shiftStateVV 
=VV 
InputKeyboardSourceVV 0
.VV0 1'
GetKeyStateForCurrentThreadVV1 L
(VVL M

VirtualKeyVVM W
.VVW X
ShiftVVX ]
)VV] ^
;VV^ _
boolWW 
isShiftDownWW 
=WW 
(WW  

shiftStateWW  *
&WW+ , 
CoreVirtualKeyStatesWW- A
.WWA B
DownWWB F
)WWF G
==WWH J 
CoreVirtualKeyStatesWWK _
.WW_ `
DownWW` d
;WWd e
DebugYY 
.YY 
	WriteLineYY 
(YY 
$"YY 
$strYY E
{YYE F
eYYF G
.YYG H
KeyYYH K
}YYK L
$strYYL T
{YYT U
isShiftDownYYU `
}YY` a
$strYYa r
{YYr s
eYYs t
.YYt u
OriginalSource	YYu É
}
YYÉ Ñ
$str
YYÑ î
{
YYî ï
grid
YYï ô
.
YYô ö
CurrentColumn
YYö ß
?
YYß ®
.
YY® ©
Header
YY© Ø
}
YYØ ∞
"
YY∞ ±
)
YY± ≤
;
YY≤ ≥
}ZZ 	
private\\ 
void\\ &
ManualEntryDataGrid_Tapped\\ /
(\\/ 0
object\\0 6
sender\\7 =
,\\= >!
TappedRoutedEventArgs\\? T
e\\U V
)\\V W
{]] 	
var^^ 
grid^^ 
=^^ 
sender^^ 
as^^  
DataGrid^^! )
;^^) *
if__ 
(__ 
grid__ 
==__ 
null__ 
)__ 
return__ $
;__$ %
Debugaa 
.aa 
	WriteLineaa 
(aa 
$"aa 
$straa O
{aaO P
eaaP Q
.aaQ R
OriginalSourceaaR `
}aa` a
"aaa b
)aab c
;aac d
ifdd 
(dd 
griddd 
.dd 
ItemsSourcedd  
isdd! #
IListdd$ )
itemsdd* /
&&dd0 2
itemsdd3 8
.dd8 9
Countdd9 >
==dd? A
$numddB C
)ddC D
{ee 
Debugff 
.ff 
	WriteLineff 
(ff  
$strff  j
)ffj k
;ffk l
ifgg 
(gg 
	ViewModelgg 
.gg 
AddRowCommandgg +
.gg+ ,

CanExecutegg, 6
(gg6 7
nullgg7 ;
)gg; <
)gg< =
{hh 
	ViewModelii 
.ii 
AddRowCommandii +
.ii+ ,
Executeii, 3
(ii3 4
nullii4 8
)ii8 9
;ii9 :
}jj 
}ll 
elsemm 
ifmm 
(mm 
gridmm 
.mm 
SelectedItemmm &
==mm' )
nullmm* .
)mm. /
{nn 
Debugoo 
.oo 
	WriteLineoo 
(oo  
$str	oo  ê
)
ooê ë
;
ooë í
ifqq 
(qq 
gridqq 
.qq 
ItemsSourceqq $
isqq% '
IListqq( -
listqq. 2
&&qq3 5
listqq6 :
.qq: ;
Countqq; @
>qqA B
$numqqC D
)qqD E
{rr 
gridss 
.ss 
SelectedIndexss &
=ss' (
$numss) *
;ss* +#
SelectFirstEditableCelltt +
(tt+ ,
gridtt, 0
)tt0 1
;tt1 2
}uu 
}vv 
elseww 
{xx 
Debug|| 
.|| 
	WriteLine|| 
(||  
$str||  f
)||f g
;||g h
grid}} 
.}} 
DispatcherQueue}} $
.}}$ %

TryEnqueue}}% /
(}}/ 0
(}}0 1
)}}1 2
=>}}3 5
{~~ 
if 
( 
grid 
. 
CurrentColumn *
!=+ -
null. 2
&&3 5
!6 7
grid7 ;
.; <
CurrentColumn< I
.I J

IsReadOnlyJ T
)T U
{
ÄÄ 
Debug
ÅÅ 
.
ÅÅ 
	WriteLine
ÅÅ '
(
ÅÅ' (
$"
ÅÅ( *
$str
ÅÅ* ^
{
ÅÅ^ _
grid
ÅÅ_ c
.
ÅÅc d
SelectedIndex
ÅÅd q
}
ÅÅq r
$str
ÅÅr x
{
ÅÅx y
grid
ÅÅy }
.
ÅÅ} ~
CurrentColumnÅÅ~ ã
.ÅÅã å
HeaderÅÅå í
}ÅÅí ì
"ÅÅì î
)ÅÅî ï
;ÅÅï ñ
grid
ÇÇ 
.
ÇÇ 
	BeginEdit
ÇÇ &
(
ÇÇ& '
)
ÇÇ' (
;
ÇÇ( )
}
ÉÉ 
}
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
}
ÜÜ 	
private
àà 
void
àà %
SelectFirstEditableCell
àà ,
(
àà, -
DataGrid
àà- 5
grid
àà6 :
)
àà: ;
{
ââ 	
Debug
ää 
.
ää 
	WriteLine
ää 
(
ää 
$str
ää Y
)
ääY Z
;
ääZ [
if
ãã 
(
ãã 
grid
ãã 
.
ãã 
ItemsSource
ãã  
is
ãã! #
IList
ãã$ )
items
ãã* /
&&
ãã0 2
items
ãã3 8
.
ãã8 9
Count
ãã9 >
>
ãã? @
$num
ããA B
)
ããB C
{
åå 
var
éé 
firstEditable
éé !
=
éé" #
grid
éé$ (
.
éé( )
Columns
éé) 0
.
éé0 1
OrderBy
éé1 8
(
éé8 9
c
éé9 :
=>
éé; =
c
éé> ?
.
éé? @
DisplayIndex
éé@ L
)
ééL M
.
ééM N
FirstOrDefault
ééN \
(
éé\ ]
c
éé] ^
=>
éé_ a
!
ééb c
c
ééc d
.
ééd e

IsReadOnly
éée o
)
ééo p
;
éép q
if
èè 
(
èè 
firstEditable
èè !
!=
èè" $
null
èè% )
)
èè) *
{
êê 
Debug
ëë 
.
ëë 
	WriteLine
ëë #
(
ëë# $
$"
ëë$ &
$str
ëë& o
{
ëëo p
firstEditable
ëëp }
.
ëë} ~
Headerëë~ Ñ
}ëëÑ Ö
$strëëÖ ≥
"ëë≥ ¥
)ëë¥ µ
;ëëµ ∂
grid
íí 
.
íí 
CurrentColumn
íí &
=
íí' (
firstEditable
íí) 6
;
íí6 7
grid
ìì 
.
ìì 
Focus
ìì 
(
ìì 
	Microsoft
ìì (
.
ìì( )
UI
ìì) +
.
ìì+ ,
Xaml
ìì, 0
.
ìì0 1

FocusState
ìì1 ;
.
ìì; <
Programmatic
ìì< H
)
ììH I
;
ììI J
grid
îî 
.
îî 
	BeginEdit
îî "
(
îî" #
)
îî# $
;
îî$ %
Debug
ïï 
.
ïï 
	WriteLine
ïï #
(
ïï# $
$"
ïï$ &
$str
ïï& u
{
ïïu v
firstEditableïïv É
.ïïÉ Ñ
HeaderïïÑ ä
}ïïä ã
"ïïã å
)ïïå ç
;ïïç é
}
ññ 
else
óó 
{
òò 
Debug
ôô 
.
ôô 
	WriteLine
ôô #
(
ôô# $
$str
ôô$ r
)
ôôr s
;
ôôs t
}
öö 
}
õõ 
else
úú 
{
ùù 
var
ûû 
	itemCount
ûû 
=
ûû 
(
ûû  !
grid
ûû! %
.
ûû% &
ItemsSource
ûû& 1
as
ûû2 4
IList
ûû5 :
)
ûû: ;
?
ûû; <
.
ûû< =
Count
ûû= B
??
ûûC E
$num
ûûF G
;
ûûG H
Debug
üü 
.
üü 
	WriteLine
üü 
(
üü  
$"
üü  "
$str
üü" n
{
üün o
	itemCount
üüo x
}
üüx y
$str
üüy z
"
üüz {
)
üü{ |
;
üü| }
}
†† 
}
°° 	
}
¢¢ 
}££ ˇP
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_EditModeView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
{ 
public 

sealed 
partial 
class  
Dunnage_EditModeView  4
:5 6
UserControl7 B
{ 
public %
Dunnage_EditModeViewModel (
	ViewModel) 2
{3 4
get5 8
;8 9
}: ;
public  
Dunnage_EditModeView #
(# $
)$ %
{ 	
	ViewModel 
= 
App 
. 

GetService &
<& '%
Dunnage_EditModeViewModel' @
>@ A
(A B
)B C
;C D
this 
. 
DataContext 
= 
	ViewModel (
;( )
this 
. 
InitializeComponent $
($ %
)% &
;& '
} 	
private 
void /
#EditModeDataGrid_CurrentCellChanged 8
(8 9
object9 ?
?? @
senderA G
,G H
	EventArgsI R
eS T
)T U
{ 	
var 
grid 
= 
sender 
as  
DataGrid! )
;) *
if 
( 
grid 
!= 
null 
) 
{   
grid"" 
."" 
DispatcherQueue"" $
.""$ %

TryEnqueue""% /
(""/ 0
(""0 1
)""1 2
=>""3 5
{## 
if$$ 
($$ 
grid$$ 
.$$ 
CurrentColumn$$ *
!=$$+ -
null$$. 2
&&$$3 5
!$$6 7
grid$$7 ;
.$$; <
CurrentColumn$$< I
.$$I J

IsReadOnly$$J T
)$$T U
{%% 
Debug&& 
.&& 
	WriteLine&& '
(&&' (
$"&&( *
$str&&* g
{&&g h
grid&&h l
.&&l m
SelectedIndex&&m z
}&&z {
$str	&&{ Å
{
&&Å Ç
grid
&&Ç Ü
.
&&Ü á
CurrentColumn
&&á î
.
&&î ï
Header
&&ï õ
}
&&õ ú
"
&&ú ù
)
&&ù û
;
&&û ü
grid'' 
.'' 
	BeginEdit'' &
(''& '
)''' (
;''( )
}(( 
})) 
))) 
;)) 
}** 
}++ 	
private-- 
void-- $
EditModeDataGrid_KeyDown-- -
(--- .
object--. 4
sender--5 ;
,--; <
KeyRoutedEventArgs--= O
e--P Q
)--Q R
{.. 	
var// 
grid// 
=// 
sender// 
as//  
DataGrid//! )
;//) *
if00 
(00 
grid00 
==00 
null00 
)00 
return00 $
;00$ %
var22 

shiftState22 
=22 
InputKeyboardSource22 0
.220 1'
GetKeyStateForCurrentThread221 L
(22L M

VirtualKey22M W
.22W X
Shift22X ]
)22] ^
;22^ _
bool33 
isShiftDown33 
=33 
(33  

shiftState33  *
&33+ , 
CoreVirtualKeyStates33- A
.33A B
Down33B F
)33F G
==33H J 
CoreVirtualKeyStates33K _
.33_ `
Down33` d
;33d e
Debug55 
.55 
	WriteLine55 
(55 
$"55 
$str55 B
{55B C
e55C D
.55D E
Key55E H
}55H I
$str55I Q
{55Q R
isShiftDown55R ]
}55] ^
$str55^ o
{55o p
e55p q
.55q r
OriginalSource	55r Ä
}
55Ä Å
$str
55Å ë
{
55ë í
grid
55í ñ
.
55ñ ó
CurrentColumn
55ó §
?
55§ •
.
55• ¶
Header
55¶ ¨
}
55¨ ≠
"
55≠ Æ
)
55Æ Ø
;
55Ø ∞
}66 	
private88 
void88 #
EditModeDataGrid_Tapped88 ,
(88, -
object88- 3
sender884 :
,88: ;!
TappedRoutedEventArgs88< Q
e88R S
)88S T
{99 	
var:: 
grid:: 
=:: 
sender:: 
as::  
DataGrid::! )
;::) *
if;; 
(;; 
grid;; 
==;; 
null;; 
);; 
return;; $
;;;$ %
Debug== 
.== 
	WriteLine== 
(== 
$"== 
$str== L
{==L M
e==M N
.==N O
OriginalSource==O ]
}==] ^
"==^ _
)==_ `
;==` a
if@@ 
(@@ 
grid@@ 
.@@ 
ItemsSource@@  
is@@! #
IList@@$ )
items@@* /
&&@@0 2
items@@3 8
.@@8 9
Count@@9 >
==@@? A
$num@@B C
)@@C D
{AA 
DebugBB 
.BB 
	WriteLineBB 
(BB  
$strBB  K
)BBK L
;BBL M
returnCC 
;CC 
}DD 
elseEE 
ifEE 
(EE 
gridEE 
.EE 
SelectedItemEE &
==EE' )
nullEE* .
)EE. /
{FF 
DebugGG 
.GG 
	WriteLineGG 
(GG  
$str	GG  ç
)
GGç é
;
GGé è
ifII 
(II 
gridII 
.II 
ItemsSourceII $
isII% '
IListII( -
listII. 2
&&II3 5
listII6 :
.II: ;
CountII; @
>IIA B
$numIIC D
)IID E
{JJ 
gridKK 
.KK 
SelectedIndexKK &
=KK' (
$numKK) *
;KK* +#
SelectFirstEditableCellLL +
(LL+ ,
gridLL, 0
)LL0 1
;LL1 2
}MM 
}NN 
elseOO 
{PP 
DebugTT 
.TT 
	WriteLineTT 
(TT  
$strTT  c
)TTc d
;TTd e
gridUU 
.UU 
DispatcherQueueUU $
.UU$ %

TryEnqueueUU% /
(UU/ 0
(UU0 1
)UU1 2
=>UU3 5
{VV 
ifWW 
(WW 
gridWW 
.WW 
CurrentColumnWW *
!=WW+ -
nullWW. 2
&&WW3 5
!WW6 7
gridWW7 ;
.WW; <
CurrentColumnWW< I
.WWI J

IsReadOnlyWWJ T
)WWT U
{XX 
DebugYY 
.YY 
	WriteLineYY '
(YY' (
$"YY( *
$strYY* [
{YY[ \
gridYY\ `
.YY` a
SelectedIndexYYa n
}YYn o
$strYYo u
{YYu v
gridYYv z
.YYz {
CurrentColumn	YY{ à
.
YYà â
Header
YYâ è
}
YYè ê
"
YYê ë
)
YYë í
;
YYí ì
gridZZ 
.ZZ 
	BeginEditZZ &
(ZZ& '
)ZZ' (
;ZZ( )
}[[ 
}\\ 
)\\ 
;\\ 
}]] 
}^^ 	
private`` 
void`` #
SelectFirstEditableCell`` ,
(``, -
DataGrid``- 5
grid``6 :
)``: ;
{aa 	
Debugbb 
.bb 
	WriteLinebb 
(bb 
$strbb V
)bbV W
;bbW X
ifcc 
(cc 
gridcc 
.cc 
ItemsSourcecc  
iscc! #
IListcc$ )
itemscc* /
&&cc0 2
itemscc3 8
.cc8 9
Countcc9 >
>cc? @
$numccA B
)ccB C
{dd 
varff 
firstEditableff !
=ff" #
gridff$ (
.ff( )
Columnsff) 0
.ff0 1
OrderByff1 8
(ff8 9
cff9 :
=>ff; =
cff> ?
.ff? @
DisplayIndexff@ L
)ffL M
.ffM N
FirstOrDefaultffN \
(ff\ ]
cff] ^
=>ff_ a
!ffb c
cffc d
.ffd e

IsReadOnlyffe o
)ffo p
;ffp q
ifgg 
(gg 
firstEditablegg !
!=gg" $
nullgg% )
)gg) *
{hh 
Debugii 
.ii 
	WriteLineii #
(ii# $
$"ii$ &
$strii& l
{iil m
firstEditableiim z
.iiz {
Header	ii{ Å
}
iiÅ Ç
$str
iiÇ ∞
"
ii∞ ±
)
ii± ≤
;
ii≤ ≥
gridjj 
.jj 
CurrentColumnjj &
=jj' (
firstEditablejj) 6
;jj6 7
gridkk 
.kk 
Focuskk 
(kk 
	Microsoftkk (
.kk( )
UIkk) +
.kk+ ,
Xamlkk, 0
.kk0 1

FocusStatekk1 ;
.kk; <
Programmatickk< H
)kkH I
;kkI J
gridll 
.ll 
	BeginEditll "
(ll" #
)ll# $
;ll$ %
Debugmm 
.mm 
	WriteLinemm #
(mm# $
$"mm$ &
$strmm& r
{mmr s
firstEditable	mms Ä
.
mmÄ Å
Header
mmÅ á
}
mmá à
"
mmà â
)
mmâ ä
;
mmä ã
}nn 
elseoo 
{pp 
Debugqq 
.qq 
	WriteLineqq #
(qq# $
$strqq$ o
)qqo p
;qqp q
}rr 
}ss 
elsett 
{uu 
varvv 
	itemCountvv 
=vv 
(vv  !
gridvv! %
.vv% &
ItemsSourcevv& 1
asvv2 4
IListvv5 :
)vv: ;
?vv; <
.vv< =
Countvv= B
??vvC E
$numvvF G
;vvG H
Debugww 
.ww 
	WriteLineww 
(ww  
$"ww  "
$strww" k
{wwk l
	itemCountwwl u
}wwu v
$strwwv w
"www x
)wwx y
;wwy z
}xx 
}yy 	
}zz 
}{{ Ÿ

dC:\Users\johnk\source\repos\MTM_Receiving_Application\Views\Dunnage\Dunnage_DetailsEntryView.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Views$ )
.) *
Dunnage* 1
;1 2
public 
sealed 
partial 
class $
Dunnage_DetailsEntryView 4
:5 6
UserControl7 B
{ 
public		 
)
Dunnage_DetailsEntryViewModel		 (
	ViewModel		) 2
{		3 4
get		5 8
;		8 9
}		: ;
public 
$
Dunnage_DetailsEntryView #
(# $
)$ %
{ 
	ViewModel 
= 
App 
. 

GetService "
<" #)
Dunnage_DetailsEntryViewModel# @
>@ A
(A B
)B C
;C D
InitializeComponent 
( 
) 
; 
} 
private 
async 
void 
OnLoaded 
(  
object  &
sender' -
,- .
RoutedEventArgs/ >
e? @
)@ A
{ 
await 
	ViewModel 
. )
LoadSpecsForSelectedPartAsync 5
(5 6
)6 7
;7 8
} 
} ¥
gC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Shared\Shared_SplashScreenViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Shared/ 5
;5 6
public

 
partial

 
class

 (
Shared_SplashScreenViewModel

 1
:

2 3 
Shared_BaseViewModel

4 H
{ 
[ 
ObservableProperty 
] 
private 
double 
_progressPercentage &
;& '
[ 
ObservableProperty 
] 
private 
bool 
_isIndeterminate !
=" #
false$ )
;) *
public 
(
Shared_SplashScreenViewModel '
(' (!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
: 	
base
 
( 
errorHandler 
, 
logger #
)# $
{ 
StatusMessage 
= 
$str )
;) *
} 
public 

void 
UpdateProgress 
( 
double %

percentage& 0
,0 1
string2 8
message9 @
)@ A
{   
ProgressPercentage!! 
=!! 

percentage!! '
;!!' (
StatusMessage"" 
="" 
message"" 
;""  
IsIndeterminate## 
=## 
false## 
;##  
}$$ 
public++ 

void++ 
SetIndeterminate++  
(++  !
string++! '
message++( /
)++/ 0
{,, 
StatusMessage-- 
=-- 
message-- 
;--  
IsIndeterminate.. 
=.. 
true.. 
;.. 
}// 
public44 

void44 
Reset44 
(44 
)44 
{55 
ProgressPercentage66 
=66 
$num66 
;66 
StatusMessage77 
=77 
$str77 )
;77) *
IsIndeterminate88 
=88 
false88 
;88  
}99 
}:: ¯5
nC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Shared\Shared_SharedTerminalLoginViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Shared/ 5
{		 
public 

partial 
class /
#Shared_SharedTerminalLoginViewModel <
:= > 
Shared_BaseViewModel? S
{ 
private 
readonly #
IService_Authentication 0
_authService1 =
;= >
[ 	
ObservableProperty	 
] 
private 
string 
	_username  
=! "
string# )
.) *
Empty* /
;/ 0
[ 	
ObservableProperty	 
] 
private 
string 
_pin 
= 
string $
.$ %
Empty% *
;* +
[ 	
ObservableProperty	 
] 
private 
int 
_attemptCount !
=" #
$num$ %
;% &
[ 	
ObservableProperty	 
] 
private   
string   
_errorMessage   $
=  % &
string  ' -
.  - .
Empty  . 3
;  3 4
public%% 
bool%% 
IsLockedOut%% 
{%%  !
get%%" %
;%%% &
set%%' *
;%%* +
}%%, -
=%%. /
false%%0 5
;%%5 6
public** 
bool** 
IsCancelled** 
{**  !
get**" %
;**% &
set**' *
;*** +
}**, -
=**. /
false**0 5
;**5 6
public// 

Model_User// 
?// 
AuthenticatedUser// ,
{//- .
get/// 2
;//2 3
private//4 ;
set//< ?
;//? @
}//A B
public88 /
#Shared_SharedTerminalLoginViewModel88 2
(882 3#
IService_Authentication99 #
authService99$ /
,99/ 0!
IService_ErrorHandler:: !
errorHandler::" .
,::. /#
IService_LoggingUtility;; #
logger;;$ *
);;* +
:<< 
base<< 
(<< 
errorHandler<< 
,<<  
logger<<! '
)<<' (
{== 	
_authService>> 
=>> 
authService>> &
??>>' )
throw>>* /
new>>0 3!
ArgumentNullException>>4 I
(>>I J
nameof>>J P
(>>P Q
authService>>Q \
)>>\ ]
)>>] ^
;>>^ _
}?? 	
publicII 
asyncII 
TaskII 
<II 
boolII 
>II 

LoginAsyncII  *
(II* +
)II+ ,
{JJ 	
ifKK 
(KK 
IsBusyKK 
)KK 
returnKK 
falseKK $
;KK$ %
tryMM 
{NN 
IsBusyOO 
=OO 
trueOO 
;OO 
StatusMessagePP 
=PP 
$strPP  3
;PP3 4
ErrorMessageQQ 
=QQ 
stringQQ %
.QQ% &
EmptyQQ& +
;QQ+ ,
ifTT 
(TT 
stringTT 
.TT 
IsNullOrWhiteSpaceTT -
(TT- .
UsernameTT. 6
)TT6 7
)TT7 8
{UU 
ErrorMessageVV  
=VV! "
$strVV# :
;VV: ;
returnWW 
falseWW  
;WW  !
}XX 
ifZZ 
(ZZ 
stringZZ 
.ZZ 
IsNullOrWhiteSpaceZZ -
(ZZ- .
PinZZ. 1
)ZZ1 2
)ZZ2 3
{[[ 
ErrorMessage\\  
=\\! "
$str\\# 5
;\\5 6
return]] 
false]]  
;]]  !
}^^ 
varaa 
progressaa 
=aa 
newaa "
Progressaa# +
<aa+ ,
stringaa, 2
>aa2 3
(aa3 4
msgaa4 7
=>aa8 :
StatusMessageaa; H
=aaI J
msgaaK N
)aaN O
;aaO P
varbb 
resultbb 
=bb 
awaitbb "
_authServicebb# /
.bb/ 0"
AuthenticateByPinAsyncbb0 F
(bbF G
UsernamebbG O
,bbO P
PinbbQ T
,bbT U
progressbbV ^
)bb^ _
;bb_ `
ifdd 
(dd 
resultdd 
.dd 
Successdd "
&&dd# %
resultdd& ,
.dd, -
Userdd- 1
!=dd2 4
nulldd5 9
)dd9 :
{ee 
AuthenticatedUsergg %
=gg& '
resultgg( .
.gg. /
Usergg/ 3
;gg3 4
StatusMessagehh !
=hh" #
$"hh$ &
$strhh& /
{hh/ 0
resulthh0 6
.hh6 7
Userhh7 ;
.hh; <
FullNamehh< D
}hhD E
"hhE F
;hhF G
_loggerjj 
.jj 
LogInfojj #
(jj# $
$"jj$ &
$strjj& N
{jjN O
UsernamejjO W
}jjW X
"jjX Y
)jjY Z
;jjZ [
returnll 
truell 
;ll  
}mm 
elsenn 
{oo 
ErrorMessageqq  
=qq! "
resultqq# )
.qq) *
ErrorMessageqq* 6
??qq7 9
$strqq: T
;qqT U
StatusMessagerr !
=rr" #
$strrr$ ;
;rr; <
_loggertt 
.tt 

LogWarningtt &
(tt& '
$"tt' )
$strtt) M
{ttM N
UsernamettN V
}ttV W
$strttW a
{tta b
AttemptCountttb n
}ttn o
"tto p
)ttp q
;ttq r
returnvv 
falsevv  
;vv  !
}ww 
}xx 
catchyy 
(yy 
	Exceptionyy 
exyy 
)yy  
{zz 
ErrorMessage{{ 
={{ 
$str{{ T
;{{T U
StatusMessage|| 
=|| 
$str||  '
;||' (
await~~ 
_errorHandler~~ #
.~~# $
HandleErrorAsync~~$ 4
(~~4 5
$" 
$str +
{+ ,
Username, 4
}4 5
"5 6
,6 7 
Enum_ErrorSeverity
ÄÄ &
.
ÄÄ& '
Error
ÄÄ' ,
,
ÄÄ, -
ex
ÅÅ 
,
ÅÅ 

showDialog
ÇÇ 
:
ÇÇ 
false
ÇÇ  %
)
ÇÇ% &
;
ÇÇ& '
return
ÑÑ 
false
ÑÑ 
;
ÑÑ 
}
ÖÖ 
finally
ÜÜ 
{
áá 
IsBusy
àà 
=
àà 
false
àà 
;
àà 
}
ââ 
}
ää 	
}
ãã 
}åå äv
gC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Shared\Shared_NewUserSetupViewModel.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $

ViewModels		$ .
.		. /
Shared		/ 5
{

 
public 

partial 
class (
Shared_NewUserSetupViewModel 5
:6 7 
Shared_BaseViewModel8 L
{ 
private 
readonly #
IService_Authentication 0
_authService1 =
;= >
[ 	
ObservableProperty	 
] 
private 
string 
_windowsUsername '
=( )
string* 0
.0 1
Empty1 6
;6 7
[ 	
ObservableProperty	 
] 
private 
string 
_employeeNumber &
=' (
string) /
./ 0
Empty0 5
;5 6
[ 	
ObservableProperty	 
] 
private 
string 
	_fullName  
=! "
string# )
.) *
Empty* /
;/ 0
[   	
ObservableProperty  	 
]   
private!! 
string!! 
_department!! "
=!!# $
string!!% +
.!!+ ,
Empty!!, 1
;!!1 2
[## 	
ObservableProperty##	 
]## 
private$$ 
string$$ 
_shift$$ 
=$$ 
string$$  &
.$$& '
Empty$$' ,
;$$, -
[&& 	
ObservableProperty&&	 
]&& 
private'' 
string'' 
_pin'' 
='' 
string'' $
.''$ %
Empty''% *
;''* +
[)) 	
ObservableProperty))	 
])) 
private** 
string** 
_errorMessage** $
=**% &
string**' -
.**- .
Empty**. 3
;**3 4
[,, 	
ObservableProperty,,	 
],, 
private-- 
bool-- !
_showCustomDepartment-- *
=--+ ,
false--- 2
;--2 3
[// 	
ObservableProperty//	 
]// 
private00 
bool00 
_configureErpAccess00 (
=00) *
false00+ 0
;000 1
[22 	
ObservableProperty22	 
]22 
private33 
string33 
?33 
_visualUsername33 '
;33' (
[55 	
ObservableProperty55	 
]55 
private66 
string66 
?66 
_visualPassword66 '
;66' (
public;;  
ObservableCollection;; #
<;;# $
string;;$ *
>;;* +
Departments;;, 7
{;;8 9
get;;: =
;;;= >
};;? @
=;;A B
new;;C F 
ObservableCollection;;G [
<;;[ \
string;;\ b
>;;b c
(;;c d
);;d e
;;;e f
public@@ 
int@@ 
NewEmployeeNumber@@ $
{@@% &
get@@' *
;@@* +
private@@, 3
set@@4 7
;@@7 8
}@@9 :
publicEE 
boolEE 
IsCancelledEE 
{EE  !
getEE" %
;EE% &
setEE' *
;EE* +
}EE, -
=EE. /
falseEE0 5
;EE5 6
publicJJ 
stringJJ 
	CreatedByJJ 
{JJ  !
getJJ" %
;JJ% &
setJJ' *
;JJ* +
}JJ, -
=JJ. /
EnvironmentJJ0 ;
.JJ; <
UserNameJJ< D
;JJD E
publicSS (
Shared_NewUserSetupViewModelSS +
(SS+ ,#
IService_AuthenticationTT #
authServiceTT$ /
,TT/ 0!
IService_ErrorHandlerUU !
errorHandlerUU" .
,UU. /#
IService_LoggingUtilityVV #
loggerVV$ *
)VV* +
:WW 
baseWW 
(WW 
errorHandlerWW 
,WW  
loggerWW! '
)WW' (
{XX 	
_authServiceYY 
=YY 
authServiceYY &
??YY' )
throwYY* /
newYY0 3!
ArgumentNullExceptionYY4 I
(YYI J
nameofYYJ P
(YYP Q
authServiceYYQ \
)YY\ ]
)YY] ^
;YY^ _
}ZZ 	
publiccc 
asynccc 
Taskcc  
LoadDepartmentsAsynccc .
(cc. /
)cc/ 0
{dd 	
tryee 
{ff 
IsBusygg 
=gg 
truegg 
;gg 
StatusMessagehh 
=hh 
$strhh  8
;hh8 9
varjj 
departmentListjj "
=jj# $
awaitjj% *
_authServicejj+ 7
.jj7 8%
GetActiveDepartmentsAsyncjj8 Q
(jjQ R
)jjR S
;jjS T
Departmentsll 
.ll 
Clearll !
(ll! "
)ll" #
;ll# $
foreachmm 
(mm 
varmm 
deptmm !
inmm" $
departmentListmm% 3
)mm3 4
{nn 
Departmentsoo 
.oo  
Addoo  #
(oo# $
deptoo$ (
)oo( )
;oo) *
}pp 
StatusMessagerr 
=rr 
$"rr  "
$strrr" )
{rr) *
Departmentsrr* 5
.rr5 6
Countrr6 ;
}rr; <
$strrr< H
"rrH I
;rrI J
_loggerss 
.ss 
LogInfoss 
(ss  
$"ss  "
$strss" )
{ss) *
Departmentsss* 5
.ss5 6
Countss6 ;
}ss; <
$strss< [
"ss[ \
)ss\ ]
;ss] ^
}tt 
catchuu 
(uu 
	Exceptionuu 
exuu 
)uu  
{vv 
ErrorMessageww 
=ww 
$strww ;
;ww; <
awaitxx 
_errorHandlerxx #
.xx# $
HandleErrorAsyncxx$ 4
(xx4 5
$stryy 0
,yy0 1
Enum_ErrorSeverityzz &
.zz& '
Warningzz' .
,zz. /
ex{{ 
,{{ 

showDialog|| 
:|| 
false||  %
)||% &
;||& '
}}} 
finally~~ 
{ 
IsBusy
ÄÄ 
=
ÄÄ 
false
ÄÄ 
;
ÄÄ 
}
ÅÅ 
}
ÇÇ 	
public
áá 
async
áá 
Task
áá 
<
áá 
bool
áá 
>
áá  
CreateAccountAsync
áá  2
(
áá2 3
)
áá3 4
{
àà 	
if
ââ 
(
ââ 
IsBusy
ââ 
)
ââ 
return
ââ 
false
ââ $
;
ââ$ %
try
ãã 
{
åå 
IsBusy
çç 
=
çç 
true
çç 
;
çç 
StatusMessage
éé 
=
éé 
$str
éé  5
;
éé5 6
ErrorMessage
èè 
=
èè 
string
èè %
.
èè% &
Empty
èè& +
;
èè+ ,
if
íí 
(
íí 
!
íí 
int
íí 
.
íí 
TryParse
íí !
(
íí! "
EmployeeNumber
íí" 0
,
íí0 1
out
íí2 5
int
íí6 9
empNum
íí: @
)
íí@ A
||
ííB D
empNum
ííE K
<=
ííL N
$num
ííO P
)
ííP Q
{
ìì 
ErrorMessage
îî  
=
îî! "
$str
îî# N
;
îîN O
StatusMessage
ïï !
=
ïï" #
$str
ïï$ 7
;
ïï7 8
return
ññ 
false
ññ  
;
ññ  !
}
óó 
var
öö 
pinValidation
öö !
=
öö" #
await
öö$ )
_authService
öö* 6
.
öö6 7
ValidatePinAsync
öö7 G
(
ööG H
Pin
ööH K
,
ööK L
empNum
ööM S
)
ööS T
;
ööT U
if
õõ 
(
õõ 
!
õõ 
pinValidation
õõ "
.
õõ" #
IsValid
õõ# *
)
õõ* +
{
úú 
ErrorMessage
ùù  
=
ùù! "
pinValidation
ùù# 0
.
ùù0 1
ErrorMessage
ùù1 =
;
ùù= >
StatusMessage
ûû !
=
ûû" #
$str
ûû$ ;
;
ûû; <
return
üü 
false
üü  
;
üü  !
}
†† 
var
££ 
newUser
££ 
=
££ 
new
££ !

Model_User
££" ,
{
§§ 
EmployeeNumber
•• "
=
••# $
empNum
••% +
,
••+ ,
WindowsUsername
¶¶ #
=
¶¶$ %
WindowsUsername
¶¶& 5
,
¶¶5 6
FullName
ßß 
=
ßß 
FullName
ßß '
,
ßß' (

Department
®® 
=
®®  

Department
®®! +
,
®®+ ,
Shift
©© 
=
©© 
Shift
©© !
,
©©! "
Pin
™™ 
=
™™ 
Pin
™™ 
,
™™ 
IsActive
´´ 
=
´´ 
true
´´ #
,
´´# $
VisualUsername
¨¨ "
=
¨¨# $ 
ConfigureErpAccess
¨¨% 7
?
¨¨8 9
VisualUsername
¨¨: H
:
¨¨I J
null
¨¨K O
,
¨¨O P
VisualPassword
≠≠ "
=
≠≠# $ 
ConfigureErpAccess
≠≠% 7
?
≠≠8 9
VisualPassword
≠≠: H
:
≠≠I J
null
≠≠K O
}
ÆÆ 
;
ÆÆ 
var
±± 
progress
±± 
=
±± 
new
±± "
Progress
±±# +
<
±±+ ,
string
±±, 2
>
±±2 3
(
±±3 4
msg
±±4 7
=>
±±8 :
StatusMessage
±±; H
=
±±I J
msg
±±K N
)
±±N O
;
±±O P
var
≤≤ 
result
≤≤ 
=
≤≤ 
await
≤≤ "
_authService
≤≤# /
.
≤≤/ 0 
CreateNewUserAsync
≤≤0 B
(
≤≤B C
newUser
≤≤C J
,
≤≤J K
	CreatedBy
≤≤L U
,
≤≤U V
progress
≤≤W _
)
≤≤_ `
;
≤≤` a
if
¥¥ 
(
¥¥ 
result
¥¥ 
.
¥¥ 
Success
¥¥ "
&&
¥¥# %
result
¥¥& ,
.
¥¥, -
EmployeeNumber
¥¥- ;
>
¥¥< =
$num
¥¥> ?
)
¥¥? @
{
µµ 
NewEmployeeNumber
∑∑ %
=
∑∑& '
result
∑∑( .
.
∑∑. /
EmployeeNumber
∑∑/ =
;
∑∑= >
StatusMessage
∏∏ !
=
∏∏" #
$"
∏∏$ &
$str
∏∏& C
{
∏∏C D
NewEmployeeNumber
∏∏D U
}
∏∏U V
"
∏∏V W
;
∏∏W X
_logger
∫∫ 
.
∫∫ 
LogInfo
∫∫ #
(
∫∫# $
$"
∫∫$ &
$str
∫∫& @
{
∫∫@ A
FullName
∫∫A I
}
∫∫I J
$str
∫∫J Q
{
∫∫Q R
NewEmployeeNumber
∫∫R c
}
∫∫c d
$str
∫∫d i
{
∫∫i j
	CreatedBy
∫∫j s
}
∫∫s t
"
∫∫t u
)
∫∫u v
;
∫∫v w
return
ºº 
true
ºº 
;
ºº  
}
ΩΩ 
else
ææ 
{
øø 
ErrorMessage
¡¡  
=
¡¡! "
result
¡¡# )
.
¡¡) *
ErrorMessage
¡¡* 6
??
¡¡7 9
$str
¡¡: U
;
¡¡U V
StatusMessage
¬¬ !
=
¬¬" #
$str
¬¬$ =
;
¬¬= >
_logger
ƒƒ 
.
ƒƒ 

LogWarning
ƒƒ &
(
ƒƒ& '
$"
ƒƒ' )
$str
ƒƒ) F
{
ƒƒF G
WindowsUsername
ƒƒG V
}
ƒƒV W
$str
ƒƒW Y
{
ƒƒY Z
ErrorMessage
ƒƒZ f
}
ƒƒf g
"
ƒƒg h
)
ƒƒh i
;
ƒƒi j
return
∆∆ 
false
∆∆  
;
∆∆  !
}
«« 
}
»» 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
   
ErrorMessage
ÀÀ 
=
ÀÀ 
$str
ÀÀ Y
;
ÀÀY Z
StatusMessage
ÃÃ 
=
ÃÃ 
$str
ÃÃ  '
;
ÃÃ' (
await
ŒŒ 
_errorHandler
ŒŒ #
.
ŒŒ# $
HandleErrorAsync
ŒŒ$ 4
(
ŒŒ4 5
$"
œœ 
$str
œœ 1
{
œœ1 2
WindowsUsername
œœ2 A
}
œœA B
"
œœB C
,
œœC D 
Enum_ErrorSeverity
–– &
.
––& '
Error
––' ,
,
––, -
ex
—— 
,
—— 

showDialog
““ 
:
““ 
false
““  %
)
““% &
;
““& '
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 
finally
÷÷ 
{
◊◊ 
IsBusy
ÿÿ 
=
ÿÿ 
false
ÿÿ 
;
ÿÿ 
}
ŸŸ 
}
⁄⁄ 	
public
ﬂﬂ 
bool
ﬂﬂ 
ValidatePinFormat
ﬂﬂ %
(
ﬂﬂ% &
string
ﬂﬂ& ,
pin
ﬂﬂ- 0
)
ﬂﬂ0 1
{
‡‡ 	
if
·· 
(
·· 
string
·· 
.
··  
IsNullOrWhiteSpace
·· )
(
··) *
pin
··* -
)
··- .
)
··. /
return
‚‚ 
false
‚‚ 
;
‚‚ 
if
‰‰ 
(
‰‰ 
pin
‰‰ 
.
‰‰ 
Length
‰‰ 
!=
‰‰ 
$num
‰‰ 
)
‰‰  
return
ÂÂ 
false
ÂÂ 
;
ÂÂ 
foreach
ÁÁ 
(
ÁÁ 
char
ÁÁ 
c
ÁÁ 
in
ÁÁ 
pin
ÁÁ "
)
ÁÁ" #
{
ËË 
if
ÈÈ 
(
ÈÈ 
!
ÈÈ 
char
ÈÈ 
.
ÈÈ 
IsDigit
ÈÈ !
(
ÈÈ! "
c
ÈÈ" #
)
ÈÈ# $
)
ÈÈ$ %
return
ÍÍ 
false
ÍÍ  
;
ÍÍ  !
}
ÎÎ 
return
ÌÌ 
true
ÌÌ 
;
ÌÌ 
}
ÓÓ 	
public
ÛÛ 
bool
ÛÛ 
ValidatePinMatch
ÛÛ $
(
ÛÛ$ %
string
ÛÛ% +
pin
ÛÛ, /
,
ÛÛ/ 0
string
ÛÛ1 7

confirmPin
ÛÛ8 B
)
ÛÛB C
{
ÙÙ 	
return
ıı 
!
ıı 
string
ıı 
.
ıı  
IsNullOrWhiteSpace
ıı -
(
ıı- .
pin
ıı. 1
)
ıı1 2
&&
ıı3 5
pin
ıı6 9
==
ıı: <

confirmPin
ıı= G
;
ııG H
}
ˆˆ 	
public
˚˚ 
bool
˚˚ 
ValidateFullName
˚˚ $
(
˚˚$ %
string
˚˚% +
fullName
˚˚, 4
)
˚˚4 5
{
¸¸ 	
return
˝˝ 
!
˝˝ 
string
˝˝ 
.
˝˝  
IsNullOrWhiteSpace
˝˝ -
(
˝˝- .
fullName
˝˝. 6
)
˝˝6 7
&&
˝˝8 :
fullName
˝˝; C
.
˝˝C D
Trim
˝˝D H
(
˝˝H I
)
˝˝I J
.
˝˝J K
Length
˝˝K Q
>=
˝˝R T
$num
˝˝U V
;
˝˝V W
}
˛˛ 	
}
ˇˇ 
}ÄÄ é
eC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Shared\Shared_MainWindowViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Shared/ 5
;5 6
public 
partial 
class &
Shared_MainWindowViewModel /
:0 1 
Shared_BaseViewModel2 F
{ 
private		 
readonly		 '
IService_UserSessionManager		 0
_sessionManager		1 @
;		@ A
[ 
ObservableProperty 
] 
private 
string 
_userDisplayText #
=$ %
$str& 5
;5 6
public 
&
Shared_MainWindowViewModel %
(% &'
IService_UserSessionManager #
sessionManager$ 2
,2 3!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
: 	
base
 
( 
errorHandler 
, 
logger #
)# $
{ 
_sessionManager 
= 
sessionManager (
;( )
if 

( 
_sessionManager 
. 
CurrentSession *
!=+ -
null. 2
)2 3
{ 	
UpdateUserDisplay 
( 
_sessionManager -
.- .
CurrentSession. <
.< =
User= A
)A B
;B C
} 	
} 
private 
void 
UpdateUserDisplay "
(" #

Model_User# -
user. 2
)2 3
{ 
UserDisplayText 
= 
user 
. 
DisplayName *
;* +
} 
}   ±
_C:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Shared\Shared_BaseViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Shared/ 5
;5 6
public		 
abstract		 
class		  
Shared_BaseViewModel		 *
:		+ ,
ObservableObject		- =
{

 
	protected 
readonly !
IService_ErrorHandler ,
_errorHandler- :
;: ;
	protected 
readonly #
IService_LoggingUtility .
_logger/ 6
;6 7
	protected  
Shared_BaseViewModel "
(" #!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
{ 
_errorHandler 
= 
errorHandler $
;$ %
_logger 
= 
logger 
; 
} 
private 
bool 
_isBusy 
; 
public 

bool 
IsBusy 
{ 
get 
=> 
_isBusy 
; 
set 
=> 
SetProperty 
( 
ref 
_isBusy &
,& '
value( -
)- .
;. /
} 
private   
string   
_statusMessage   !
=  " #
string  $ *
.  * +
Empty  + 0
;  0 1
public$$ 

string$$ 
StatusMessage$$ 
{%% 
get&& 
=>&& 
_statusMessage&& 
;&& 
set'' 
=>'' 
SetProperty'' 
('' 
ref'' 
_statusMessage'' -
,''- .
value''/ 4
)''4 5
;''5 6
}(( 
})) ÀÀ
iC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_WorkflowViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
	Receiving/ 8
{ 
public 

partial 
class 0
$Receiving_ReceivingWorkflowViewModel =
:> ? 
Shared_BaseViewModel@ T
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
[ 	
ObservableProperty	 
] 
private 
string 
_currentStepTitle (
=) *
$str+ ?
;? @
[ 	
ObservableProperty	 
] 
private 
bool #
_isModeSelectionVisible ,
;, -
[ 	
ObservableProperty	 
] 
private 
bool !
_isManualEntryVisible *
;* +
[ 	
ObservableProperty	 
] 
private 
bool 
_isEditModeVisible '
;' (
[ 	
ObservableProperty	 
] 
private 
bool 
_isPOEntryVisible &
;& '
[   	
ObservableProperty  	 
]   
private!! 
bool!! #
_isPartSelectionVisible!! ,
;!!, -
[## 	
ObservableProperty##	 
]## 
private$$ 
bool$$ 
_isLoadEntryVisible$$ (
;$$( )
[&& 	
ObservableProperty&&	 
]&& 
private'' 
bool'' )
_isWeightQuantityEntryVisible'' 2
;''2 3
[)) 	
ObservableProperty))	 
])) 
private** 
bool** "
_isHeatLotEntryVisible** +
;**+ ,
[,, 	
ObservableProperty,,	 
],, 
private-- 
bool-- &
_isPackageTypeEntryVisible-- /
;--/ 0
[// 	
ObservableProperty//	 
]// 
private00 
bool00 
_isReviewVisible00 %
;00% &
[22 	
ObservableProperty22	 
]22 
private33 
bool33 
_isSavingVisible33 %
;33% &
[55 	
ObservableProperty55	 
]55 
private66 
bool66 
_isCompleteVisible66 '
;66' (
[88 	
ObservableProperty88	 
]88 
private99 

SaveResult99 
?99 
_lastSaveResult99 +
;99+ ,
[;; 	
ObservableProperty;;	 
];; 
private<< 
string<<  
_saveProgressMessage<< +
=<<, -
$str<<. ?
;<<? @
[>> 	
ObservableProperty>>	 
]>> 
private?? 
double?? 
_saveProgressValue?? )
=??* +
$num??, -
;??- .
[AA 	
ObservablePropertyAA	 
]AA 
privateBB 
stringBB 
_statusMessageBB %
=BB& '
stringBB( .
.BB. /
EmptyBB/ 4
;BB4 5
[DD 	
ObservablePropertyDD	 
]DD 
privateEE 
boolEE 
_isStatusOpenEE "
;EE" #
[GG 	
ObservablePropertyGG	 
]GG 
privateHH 
InfoBarSeverityHH 
_statusSeverityHH  /
=HH0 1
InfoBarSeverityHH2 A
.HHA B
InformationalHHB O
;HHO P
[JJ 	
ObservablePropertyJJ	 
]JJ 
privateKK 
	MicrosoftKK 
.KK 
UIKK 
.KK 
XamlKK !
.KK! "
	UIElementKK" +
?KK+ ,
_helpContentKK- 9
;KK9 :
privateMM 
boolMM 
	_isSavingMM 
=MM  
falseMM! &
;MM& '
privateNN 
readonlyNN 
IService_DispatcherNN ,
_dispatcherServiceNN- ?
;NN? @
privateOO 
readonlyOO 
IService_WindowOO (
_windowServiceOO) 7
;OO7 8
publicQQ 0
$Receiving_ReceivingWorkflowViewModelQQ 3
(QQ3 4&
IService_ReceivingWorkflowRR &
workflowServiceRR' 6
,RR6 7!
IService_ErrorHandlerSS !
errorHandlerSS" .
,SS. /#
IService_LoggingUtilityTT #
loggerTT$ *
,TT* +
IService_DispatcherUU 
dispatcherServiceUU  1
,UU1 2
IService_WindowVV 
windowServiceVV )
)VV) *
:WW 
baseWW 
(WW 
errorHandlerWW 
,WW  
loggerWW! '
)WW' (
{XX 	
_dispatcherServiceYY 
=YY  
dispatcherServiceYY! 2
;YY2 3
_windowServiceZZ 
=ZZ 
windowServiceZZ *
;ZZ* +
_workflowService[[ 
=[[ 
workflowService[[ .
;[[. /
_workflowService\\ 
.\\ 
StepChanged\\ (
+=\\) +
(\\, -
s\\- .
,\\. /
e\\0 1
)\\1 2
=>\\3 5
{]] 
_logger^^ 
.^^ 
LogInfo^^ 
(^^  
$str^^  _
)^^_ `
;^^` a
if`` 
(`` 
_workflowService`` $
.``$ %
CurrentStep``% 0
==``1 3
WorkflowStep``4 @
.``@ A
Saving``A G
)``G H
{aa 
_loggerbb 
.bb 
LogInfobb #
(bb# $
$strbb$ `
)bb` a
;bba b
_dispatcherServicecc &
.cc& '

TryEnqueuecc' 1
(cc1 2
asynccc2 7
(cc8 9
)cc9 :
=>cc; =
{dd 
awaitee 
PerformSaveAsyncee .
(ee. /
)ee/ 0
;ee0 1
}ff 
)ff 
;ff 
}gg  
UpdateStepVisibilityhh $
(hh$ %
)hh% &
;hh& '
_loggerii 
.ii 
LogInfoii 
(ii  
$strii  5
)ii5 6
;ii6 7
}jj 
;jj 
_workflowServicekk 
.kk 
StatusMessageRaisedkk 0
+=kk1 3
(kk4 5
skk5 6
,kk6 7
messagekk8 ?
)kk? @
=>kkA C

ShowStatuskkD N
(kkN O
messagekkO V
)kkV W
;kkW X 
UpdateStepVisibilitynn  
(nn  !
)nn! "
;nn" #
}oo 	
publicpp 
voidpp 

ShowStatuspp 
(pp 
stringpp %
messagepp& -
,pp- .
InfoBarSeveritypp/ >
severitypp? G
=ppH I
InfoBarSeverityppJ Y
.ppY Z
InformationalppZ g
)ppg h
{qq 	
StatusMessagerr 
=rr 
messagerr #
;rr# $
StatusSeverityss 
=ss 
severityss %
;ss% &
IsStatusOpentt 
=tt 
truett 
;tt  
ifww 
(ww 
severityww 
==ww 
InfoBarSeverityww +
.ww+ ,
Informationalww, 9
||ww: <
severityww= E
==wwF H
InfoBarSeveritywwI X
.wwX Y
SuccesswwY `
)ww` a
{xx 
Taskyy 
.yy 
Delayyy 
(yy 
$numyy 
)yy  
.yy  !
ContinueWithyy! -
(yy- .
_yy. /
=>yy0 2
{zz 
_dispatcherService{{ &
.{{& '

TryEnqueue{{' 1
({{1 2
({{2 3
){{3 4
=>{{5 7
{|| 
IsStatusOpen}} $
=}}% &
false}}' ,
;}}, -
}~~ 
)~~ 
;~~ 
} 
) 
; 
}
ÄÄ 
}
ÅÅ 	
[
ÉÉ 	
RelayCommand
ÉÉ	 
]
ÉÉ 
private
ÑÑ 
async
ÑÑ 
Task
ÑÑ 
NextStepAsync
ÑÑ (
(
ÑÑ( )
)
ÑÑ) *
{
ÖÖ 	
try
ÜÜ 
{
áá 
_logger
àà 
.
àà 
LogInfo
àà 
(
àà  
$str
àà  B
)
ààB C
;
ààC D
var
çç 
result
çç 
=
çç 
await
çç "
_workflowService
çç# 3
.
çç3 4$
AdvanceToNextStepAsync
çç4 J
(
ççJ K
)
ççK L
;
ççL M
_logger
éé 
.
éé 
LogInfo
éé 
(
éé  
$"
éé  "
$str
éé" L
{
ééL M
result
ééM S
.
ééS T
Success
ééT [
}
éé[ \
$str
éé\ d
{
ééd e
_workflowService
éée u
.
ééu v
CurrentStepéév Å
}ééÅ Ç
"ééÇ É
)ééÉ Ñ
;ééÑ Ö
if
êê 
(
êê 
result
êê 
.
êê 
Success
êê "
)
êê" #
{
ëë "
UpdateStepVisibility
íí (
(
íí( )
)
íí) *
;
íí* +
}
îî 
else
ïï 
{
ññ 
if
óó 
(
óó 
result
óó 
.
óó 
ValidationErrors
óó /
.
óó/ 0
Count
óó0 5
>
óó6 7
$num
óó8 9
)
óó9 :
{
òò 
await
ôô 
_errorHandler
ôô +
.
ôô+ ,
HandleErrorAsync
ôô, <
(
ôô< =
string
öö "
.
öö" #
Join
öö# '
(
öö' (
$str
öö( ,
,
öö, -
result
öö. 4
.
öö4 5
ValidationErrors
öö5 E
)
ööE F
,
ööF G 
Enum_ErrorSeverity
õõ .
.
õõ. /
Error
õõ/ 4
)
õõ4 5
;
õõ5 6
}
úú 
}
ùù 
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
†† 
_logger
°° 
.
°° 
LogError
°°  
(
°°  !
$"
°°! #
$str
°°# ;
{
°°; <
ex
°°< >
.
°°> ?
Message
°°? F
}
°°F G
"
°°G H
,
°°H I
ex
°°J L
)
°°L M
;
°°M N
await
¢¢ 
_errorHandler
¢¢ #
.
¢¢# $
HandleErrorAsync
¢¢$ 4
(
¢¢4 5
$"
¢¢5 7
$str
¢¢7 J
{
¢¢J K
ex
¢¢K M
.
¢¢M N
Message
¢¢N U
}
¢¢U V
"
¢¢V W
,
¢¢W X 
Enum_ErrorSeverity
¢¢Y k
.
¢¢k l
Error
¢¢l q
)
¢¢q r
;
¢¢r s
}
££ 
}
§§ 	
private
¶¶ 
async
¶¶ 
Task
¶¶ 
PerformSaveAsync
¶¶ +
(
¶¶+ ,
)
¶¶, -
{
ßß 	
if
®® 
(
®® 
	_isSaving
®® 
)
®® 
{
©© 
_logger
™™ 
.
™™ 
LogInfo
™™ 
(
™™  
$str
™™  W
)
™™W X
;
™™X Y
return
´´ 
;
´´ 
}
¨¨ 
	_isSaving
≠≠ 
=
≠≠ 
true
≠≠ 
;
≠≠ 
try
ØØ 
{
∞∞ 
_logger
±± 
.
±± 
LogInfo
±± 
(
±±  
$str
±±  ;
)
±±; <
;
±±< =!
SaveProgressMessage
¥¥ #
=
¥¥$ %
$str
¥¥& J
;
¥¥J K
SaveProgressValue
µµ !
=
µµ" #
$num
µµ$ &
;
µµ& '
var
∏∏ 
messageProgress
∏∏ #
=
∏∏$ %
new
∏∏& )
Progress
∏∏* 2
<
∏∏2 3
string
∏∏3 9
>
∏∏9 :
(
∏∏: ;
msg
∏∏; >
=>
∏∏? A
{
ππ 
_logger
∫∫ 
.
∫∫ 
LogInfo
∫∫ #
(
∫∫# $
$"
∫∫$ &
$str
∫∫& =
{
∫∫= >
msg
∫∫> A
}
∫∫A B
"
∫∫B C
)
∫∫C D
;
∫∫D E!
SaveProgressMessage
ªª '
=
ªª( )
msg
ªª* -
;
ªª- .
}
ºº 
)
ºº 
;
ºº 
var
ΩΩ 
percentProgress
ΩΩ #
=
ΩΩ$ %
new
ΩΩ& )
Progress
ΩΩ* 2
<
ΩΩ2 3
int
ΩΩ3 6
>
ΩΩ6 7
(
ΩΩ7 8
pct
ΩΩ8 ;
=>
ΩΩ< >
{
ææ 
_logger
øø 
.
øø 
LogInfo
øø #
(
øø# $
$"
øø$ &
$str
øø& =
{
øø= >
pct
øø> A
}
øøA B
"
øøB C
)
øøC D
;
øøD E
SaveProgressValue
¿¿ %
=
¿¿& '
pct
¿¿( +
;
¿¿+ ,
}
¡¡ 
)
¡¡ 
;
¡¡ 
_logger
√√ 
.
√√ 
LogInfo
√√ 
(
√√  
$str
√√  N
)
√√N O
;
√√O P
LastSaveResult
ƒƒ 
=
ƒƒ  
await
ƒƒ! &
_workflowService
ƒƒ' 7
.
ƒƒ7 8
SaveSessionAsync
ƒƒ8 H
(
ƒƒH I
messageProgress
ƒƒI X
,
ƒƒX Y
percentProgress
ƒƒZ i
)
ƒƒi j
;
ƒƒj k
_logger
≈≈ 
.
≈≈ 
LogInfo
≈≈ 
(
≈≈  
$"
≈≈  "
$str
≈≈" F
{
≈≈F G
LastSaveResult
≈≈G U
.
≈≈U V
Success
≈≈V ]
}
≈≈] ^
"
≈≈^ _
)
≈≈_ `
;
≈≈` a
await
»» 
_workflowService
»» &
.
»»& '$
AdvanceToNextStepAsync
»»' =
(
»»= >
)
»»> ?
;
»»? @"
UpdateStepVisibility
…… $
(
……$ %
)
……% &
;
……& '
}
   
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÃÃ 
_logger
ÕÕ 
.
ÕÕ 
LogError
ÕÕ  
(
ÕÕ  !
$"
ÕÕ! #
$str
ÕÕ# >
{
ÕÕ> ?
ex
ÕÕ? A
.
ÕÕA B
Message
ÕÕB I
}
ÕÕI J
"
ÕÕJ K
,
ÕÕK L
ex
ÕÕM O
)
ÕÕO P
;
ÕÕP Q
await
ŒŒ 
_errorHandler
ŒŒ #
.
ŒŒ# $
HandleErrorAsync
ŒŒ$ 4
(
ŒŒ4 5
$"
ŒŒ5 7
$str
ŒŒ7 D
{
ŒŒD E
ex
ŒŒE G
.
ŒŒG H
Message
ŒŒH O
}
ŒŒO P
"
ŒŒP Q
,
ŒŒQ R 
Enum_ErrorSeverity
ŒŒS e
.
ŒŒe f
Error
ŒŒf k
)
ŒŒk l
;
ŒŒl m
}
œœ 
finally
–– 
{
—— 
	_isSaving
““ 
=
““ 
false
““ !
;
““! "
}
”” 
}
‘‘ 	
[
÷÷ 	
RelayCommand
÷÷	 
]
÷÷ 
private
◊◊ 
async
◊◊ 
Task
◊◊  
StartNewEntryAsync
◊◊ -
(
◊◊- .
)
◊◊. /
{
ÿÿ 	
await
ŸŸ 
_workflowService
ŸŸ "
.
ŸŸ" # 
ResetWorkflowAsync
ŸŸ# 5
(
ŸŸ5 6
)
ŸŸ6 7
;
ŸŸ7 8"
UpdateStepVisibility
⁄⁄  
(
⁄⁄  !
)
⁄⁄! "
;
⁄⁄" #
}
€€ 	
[
›› 	
RelayCommand
››	 
]
›› 
private
ﬁﬁ 
async
ﬁﬁ 
Task
ﬁﬁ 
ResetCSVAsync
ﬁﬁ (
(
ﬁﬁ( )
)
ﬁﬁ) *
{
ﬂﬂ 	
var
‡‡ 
xamlRoot
‡‡ 
=
‡‡ 
_windowService
‡‡ )
.
‡‡) *
GetXamlRoot
‡‡* 5
(
‡‡5 6
)
‡‡6 7
;
‡‡7 8
if
·· 
(
·· 
xamlRoot
·· 
==
·· 
null
··  
)
··  !
{
‚‚ 
_logger
„„ 
.
„„ 
LogError
„„  
(
„„  !
$str
„„! G
)
„„G H
;
„„H I
await
‰‰ 
_errorHandler
‰‰ #
.
‰‰# $
HandleErrorAsync
‰‰$ 4
(
‰‰4 5
$str
‰‰5 O
,
‰‰O P 
Enum_ErrorSeverity
‰‰Q c
.
‰‰c d
Error
‰‰d i
)
‰‰i j
;
‰‰j k
return
ÂÂ 
;
ÂÂ 
}
ÊÊ 
var
ËË 
dialog
ËË 
=
ËË 
new
ËË 
ContentDialog
ËË *
{
ÈÈ 
Title
ÍÍ 
=
ÍÍ 
$str
ÍÍ )
,
ÍÍ) *
Content
ÎÎ 
=
ÎÎ 
$str
ÎÎ z
,
ÎÎz {
PrimaryButtonText
ÏÏ !
=
ÏÏ" #
$str
ÏÏ$ ,
,
ÏÏ, -
CloseButtonText
ÌÌ 
=
ÌÌ  !
$str
ÌÌ" *
,
ÌÌ* +
DefaultButton
ÓÓ 
=
ÓÓ !
ContentDialogButton
ÓÓ  3
.
ÓÓ3 4
Close
ÓÓ4 9
,
ÓÓ9 :
XamlRoot
ÔÔ 
=
ÔÔ 
xamlRoot
ÔÔ #
}
 
;
 
var
ÚÚ 
result
ÚÚ 
=
ÚÚ 
await
ÚÚ 
dialog
ÚÚ %
.
ÚÚ% &
	ShowAsync
ÚÚ& /
(
ÚÚ/ 0
)
ÚÚ0 1
;
ÚÚ1 2
if
ÛÛ 
(
ÛÛ 
result
ÛÛ 
==
ÛÛ !
ContentDialogResult
ÛÛ -
.
ÛÛ- .
Primary
ÛÛ. 5
)
ÛÛ5 6
{
ÙÙ 
var
ıı 
deleteResult
ıı  
=
ıı! "
await
ıı# (
_workflowService
ıı) 9
.
ıı9 : 
ResetCSVFilesAsync
ıı: L
(
ııL M
)
ııM N
;
ııN O
if
ˆˆ 
(
ˆˆ 
deleteResult
ˆˆ  
.
ˆˆ  !
LocalDeleted
ˆˆ! -
||
ˆˆ. 0
deleteResult
ˆˆ1 =
.
ˆˆ= >
NetworkDeleted
ˆˆ> L
)
ˆˆL M
{
˜˜ 

ShowStatus
¯¯ 
(
¯¯ 
$str
¯¯ @
,
¯¯@ A
InfoBarSeverity
¯¯B Q
.
¯¯Q R
Success
¯¯R Y
)
¯¯Y Z
;
¯¯Z [
}
˘˘ 
else
˙˙ 
{
˚˚ 

ShowStatus
¸¸ 
(
¸¸ 
$str
¸¸ O
,
¸¸O P
InfoBarSeverity
¸¸Q `
.
¸¸` a
Warning
¸¸a h
)
¸¸h i
;
¸¸i j
}
˝˝ 
}
˛˛ 
}
ˇˇ 	
[
ÅÅ 	
RelayCommand
ÅÅ	 
]
ÅÅ 
private
ÇÇ 
void
ÇÇ 
PreviousStep
ÇÇ !
(
ÇÇ! "
)
ÇÇ" #
{
ÉÉ 	
var
ÑÑ 
result
ÑÑ 
=
ÑÑ 
_workflowService
ÑÑ )
.
ÑÑ) *
GoToPreviousStep
ÑÑ* :
(
ÑÑ: ;
)
ÑÑ; <
;
ÑÑ< =
if
ÖÖ 
(
ÖÖ 
result
ÖÖ 
.
ÖÖ 
Success
ÖÖ 
)
ÖÖ 
{
ÜÜ "
UpdateStepVisibility
áá $
(
áá$ %
)
áá% &
;
áá& '
}
àà 
}
ââ 	
[
ãã 	
RelayCommand
ãã	 
]
ãã 
private
åå 
async
åå 
Task
åå (
ReturnToModeSelectionAsync
åå 5
(
åå5 6
)
åå6 7
{
çç 	
var
éé 
xamlRoot
éé 
=
éé 
_windowService
éé )
.
éé) *
GetXamlRoot
éé* 5
(
éé5 6
)
éé6 7
;
éé7 8
if
èè 
(
èè 
xamlRoot
èè 
==
èè 
null
èè  
)
èè  !
{
êê 
_logger
ëë 
.
ëë 
LogError
ëë  
(
ëë  !
$str
ëë! G
)
ëëG H
;
ëëH I
await
íí 
_errorHandler
íí #
.
íí# $
HandleErrorAsync
íí$ 4
(
íí4 5
$str
íí5 O
,
ííO P 
Enum_ErrorSeverity
ííQ c
.
ííc d
Error
ííd i
)
ííi j
;
ííj k
return
ìì 
;
ìì 
}
îî 
var
ññ 
dialog
ññ 
=
ññ 
new
ññ 
ContentDialog
ññ *
{
óó 
Title
òò 
=
òò 
$str
òò &
,
òò& '
Content
ôô 
=
ôô 
$strôô Ö
,ôôÖ Ü
PrimaryButtonText
öö !
=
öö" #
$str
öö$ 6
,
öö6 7
CloseButtonText
õõ 
=
õõ  !
$str
õõ" *
,
õõ* +
DefaultButton
úú 
=
úú !
ContentDialogButton
úú  3
.
úú3 4
Close
úú4 9
,
úú9 :
XamlRoot
ùù 
=
ùù 
xamlRoot
ùù #
}
ûû 
;
ûû 
var
†† 
result
†† 
=
†† 
await
†† 
dialog
†† %
.
††% &
	ShowAsync
††& /
(
††/ 0
)
††0 1
;
††1 2
if
°° 
(
°° 
result
°° 
==
°° !
ContentDialogResult
°° -
.
°°- .
Primary
°°. 5
)
°°5 6
{
¢¢ 
await
§§ 
_workflowService
§§ &
.
§§& ' 
ResetWorkflowAsync
§§' 9
(
§§9 :
)
§§: ;
;
§§; <
_workflowService
••  
.
••  !
GoToStep
••! )
(
••) *
WorkflowStep
••* 6
.
••6 7
ModeSelection
••7 D
)
••D E
;
••E F"
UpdateStepVisibility
¶¶ $
(
¶¶$ %
)
¶¶% &
;
¶¶& '

ShowStatus
ßß 
(
ßß 
$str
ßß D
,
ßßD E
InfoBarSeverity
ßßF U
.
ßßU V
Informational
ßßV c
)
ßßc d
;
ßßd e
}
®® 
}
©© 	
private
´´ 
void
´´ "
UpdateStepVisibility
´´ )
(
´´) *
)
´´* +
{
¨¨ 	
var
≠≠ 
step
≠≠ 
=
≠≠ 
_workflowService
≠≠ '
.
≠≠' (
CurrentStep
≠≠( 3
;
≠≠3 4$
IsModeSelectionVisible
ØØ "
=
ØØ# $
step
ØØ% )
==
ØØ* ,
WorkflowStep
ØØ- 9
.
ØØ9 :
ModeSelection
ØØ: G
;
ØØG H"
IsManualEntryVisible
∞∞  
=
∞∞! "
step
∞∞# '
==
∞∞( *
WorkflowStep
∞∞+ 7
.
∞∞7 8
ManualEntry
∞∞8 C
;
∞∞C D
IsEditModeVisible
±± 
=
±± 
step
±±  $
==
±±% '
WorkflowStep
±±( 4
.
±±4 5
EditMode
±±5 =
;
±±= >
IsPOEntryVisible
≤≤ 
=
≤≤ 
step
≤≤ #
==
≤≤$ &
WorkflowStep
≤≤' 3
.
≤≤3 4
POEntry
≤≤4 ;
;
≤≤; <$
IsPartSelectionVisible
≥≥ "
=
≥≥# $
step
≥≥% )
==
≥≥* ,
WorkflowStep
≥≥- 9
.
≥≥9 :
PartSelection
≥≥: G
;
≥≥G H 
IsLoadEntryVisible
¥¥ 
=
¥¥  
step
¥¥! %
==
¥¥& (
WorkflowStep
¥¥) 5
.
¥¥5 6
	LoadEntry
¥¥6 ?
;
¥¥? @*
IsWeightQuantityEntryVisible
µµ (
=
µµ) *
step
µµ+ /
==
µµ0 2
WorkflowStep
µµ3 ?
.
µµ? @!
WeightQuantityEntry
µµ@ S
;
µµS T#
IsHeatLotEntryVisible
∂∂ !
=
∂∂" #
step
∂∂$ (
==
∂∂) +
WorkflowStep
∂∂, 8
.
∂∂8 9
HeatLotEntry
∂∂9 E
;
∂∂E F'
IsPackageTypeEntryVisible
∑∑ %
=
∑∑& '
step
∑∑( ,
==
∑∑- /
WorkflowStep
∑∑0 <
.
∑∑< =
PackageTypeEntry
∑∑= M
;
∑∑M N
IsReviewVisible
∏∏ 
=
∏∏ 
step
∏∏ "
==
∏∏# %
WorkflowStep
∏∏& 2
.
∏∏2 3
Review
∏∏3 9
;
∏∏9 :
IsSavingVisible
ππ 
=
ππ 
step
ππ "
==
ππ# %
WorkflowStep
ππ& 2
.
ππ2 3
Saving
ππ3 9
;
ππ9 :
IsCompleteVisible
∫∫ 
=
∫∫ 
step
∫∫  $
==
∫∫% '
WorkflowStep
∫∫( 4
.
∫∫4 5
Complete
∫∫5 =
;
∫∫= >
CurrentStepTitle
ΩΩ 
=
ΩΩ 
step
ΩΩ #
switch
ΩΩ$ *
{
ææ 
WorkflowStep
øø 
.
øø 
ModeSelection
øø *
=>
øø+ -
$str
øø. ;
,
øø; <
WorkflowStep
¿¿ 
.
¿¿ 
ManualEntry
¿¿ (
=>
¿¿) +
$str
¿¿, :
,
¿¿: ;
WorkflowStep
¡¡ 
.
¡¡ 
EditMode
¡¡ %
=>
¡¡& (
$str
¡¡) 4
,
¡¡4 5
WorkflowStep
¬¬ 
.
¬¬ 
POEntry
¬¬ $
=>
¬¬% '
$str
¬¬( 9
,
¬¬9 :
WorkflowStep
√√ 
.
√√ 
PartSelection
√√ *
=>
√√+ -
$str
√√. ;
,
√√; <
WorkflowStep
ƒƒ 
.
ƒƒ 
	LoadEntry
ƒƒ &
=>
ƒƒ' )
$str
ƒƒ* A
,
ƒƒA B
WorkflowStep
≈≈ 
.
≈≈ !
WeightQuantityEntry
≈≈ 0
=>
≈≈1 3
$str
≈≈4 K
,
≈≈K L
WorkflowStep
∆∆ 
.
∆∆ 
HeatLotEntry
∆∆ )
=>
∆∆* ,
$str
∆∆- E
,
∆∆E F
WorkflowStep
«« 
.
«« 
PackageTypeEntry
«« -
=>
««. 0
$str
««1 F
,
««F G
WorkflowStep
»» 
.
»» 
Review
»» #
=>
»»$ &
$str
»»' 6
,
»»6 7
WorkflowStep
…… 
.
…… 
Saving
…… #
=>
……$ &
$str
……' 2
,
……2 3
WorkflowStep
   
.
   
Complete
   %
=>
  & (
$str
  ) 3
,
  3 4
_
ÀÀ 
=>
ÀÀ 
$str
ÀÀ )
}
ÃÃ 
;
ÃÃ 
HelpContent
œœ 
=
œœ 1
#Helper_WorkflowHelpContentGenerator
œœ =
.
œœ= >!
GenerateHelpContent
œœ> Q
(
œœQ R
step
œœR V
)
œœV W
;
œœW X
}
–– 	
}
—— 
}““ êO
oC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_WeightQuantityViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
	Receiving/ 8
{ 
public 

partial 
class -
!Receiving_WeightQuantityViewModel :
:; < 
Shared_BaseViewModel= Q
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
private 
readonly (
IService_ReceivingValidation 5
_validationService6 H
;H I
private 
readonly  
IService_InforVisual -
_inforVisualService. A
;A B
[ 	
ObservableProperty	 
] 
private  
ObservableCollection $
<$ %
Model_ReceivingLoad% 8
>8 9
_loads: @
=A B
newC F
(F G
)G H
;H I
[ 	
ObservableProperty	 
] 
private 
string 
_warningMessage &
=' (
string) /
./ 0
Empty0 5
;5 6
[ 	
ObservableProperty	 
] 
private 
bool 
_hasWarning  
;  !
[ 	
ObservableProperty	 
] 
private 
string 
_poQuantityInfo &
=' (
string) /
./ 0
Empty0 5
;5 6
public!! -
!Receiving_WeightQuantityViewModel!! 0
(!!0 1&
IService_ReceivingWorkflow"" &
workflowService""' 6
,""6 7(
IService_ReceivingValidation## (
validationService##) :
,##: ; 
IService_InforVisual$$  
inforVisualService$$! 3
,$$3 4!
IService_ErrorHandler%% !
errorHandler%%" .
,%%. /#
IService_LoggingUtility&& #
logger&&$ *
)&&* +
:'' 
base'' 
('' 
errorHandler'' 
,''  
logger''! '
)''' (
{(( 	
_workflowService)) 
=)) 
workflowService)) .
;)). /
_validationService** 
=**  
validationService**! 2
;**2 3
_inforVisualService++ 
=++  !
inforVisualService++" 4
;++4 5
_workflowService-- 
.-- 
StepChanged-- (
+=--) +
OnStepChanged--, 9
;--9 :
}.. 	
private00 
void00 
OnStepChanged00 "
(00" #
object00# )
?00) *
sender00+ 1
,001 2
	EventArgs003 <
e00= >
)00> ?
{11 	
if22 
(22 
_workflowService22  
.22  !
CurrentStep22! ,
==22- /
WorkflowStep220 <
.22< =
WeightQuantityEntry22= P
)22P Q
{33 
_44 
=44 
OnNavigatedToAsync44 &
(44& '
)44' (
;44( )
}55 
}66 	
public88 
async88 
Task88 
OnNavigatedToAsync88 ,
(88, -
)88- .
{99 	
Loads;; 
.;; 
Clear;; 
(;; 
);; 
;;; 
if<< 
(<< 
_workflowService<<  
.<<  !
CurrentSession<<! /
?<</ 0
.<<0 1
Loads<<1 6
!=<<7 9
null<<: >
)<<> ?
{== 
foreach>> 
(>> 
var>> 
load>> !
in>>" $
_workflowService>>% 5
.>>5 6
CurrentSession>>6 D
.>>D E
Loads>>E J
)>>J K
{?? 
Loads@@ 
.@@ 
Add@@ 
(@@ 
load@@ "
)@@" #
;@@# $
}AA 
}BB  
UpdatePOQuantityInfoDD  
(DD  !
)DD! "
;DD" #
awaitEE &
CheckSameDayReceivingAsyncEE ,
(EE, -
)EE- .
;EE. /
}FF 	
privateHH 
voidHH  
UpdatePOQuantityInfoHH )
(HH) *
)HH* +
{II 	
ifJJ 
(JJ 
_workflowServiceJJ  
.JJ  !
CurrentSessionJJ! /
.JJ/ 0
IsNonPOJJ0 7
)JJ7 8
{KK 
PoQuantityInfoLL 
=LL  
$strLL! .
;LL. /
}MM 
elseNN 
ifNN 
(NN 
_workflowServiceNN %
.NN% &
CurrentPartNN& 1
!=NN2 4
nullNN5 9
)NN9 :
{OO 
PoQuantityInfoPP 
=PP  
$"PP! #
$strPP# ,
{PP, -
_workflowServicePP- =
.PP= >
CurrentPartPP> I
.PPI J

QtyOrderedPPJ T
:PPT U
$strPPU W
}PPW X
"PPX Y
;PPY Z
}QQ 
elseRR 
{SS 
PoQuantityInfoTT 
=TT  
stringTT! '
.TT' (
EmptyTT( -
;TT- .
}UU 
}VV 	
privateXX 
asyncXX 
TaskXX &
CheckSameDayReceivingAsyncXX 5
(XX5 6
)XX6 7
{YY 	

HasWarningZZ 
=ZZ 
falseZZ 
;ZZ 
WarningMessage[[ 
=[[ 
string[[ #
.[[# $
Empty[[$ )
;[[) *
if]] 
(]] 
_workflowService]]  
.]]  !
CurrentSession]]! /
.]]/ 0
IsNonPO]]0 7
)]]7 8
{^^ 
return__ 
;__ 
}`` 
varbb 
poNumberbb 
=bb 
_workflowServicebb +
.bb+ ,
CurrentPONumberbb, ;
;bb; <
varcc 
partIdcc 
=cc 
_workflowServicecc )
.cc) *
CurrentPartcc* 5
?cc5 6
.cc6 7
PartIDcc7 =
;cc= >
ifee 
(ee 
stringee 
.ee 
IsNullOrEmptyee $
(ee$ %
poNumberee% -
)ee- .
||ee/ 1
stringee2 8
.ee8 9
IsNullOrEmptyee9 F
(eeF G
partIdeeG M
)eeM N
)eeN O
{ff 
returngg 
;gg 
}hh 
tryjj 
{kk 
varll 
resultll 
=ll 
awaitll "
_inforVisualServicell# 6
.ll6 7,
 GetSameDayReceivingQuantityAsyncll7 W
(llW X
poNumberllX `
,ll` a
partIdllb h
,llh i
DateTimellj r
.llr s
Todaylls x
)llx y
;lly z
ifmm 
(mm 
resultmm 
.mm 
	IsSuccessmm $
&&mm% '
resultmm( .
.mm. /
Datamm/ 3
>mm4 5
$nummm6 7
)mm7 8
{nn 

HasWarningoo 
=oo  
trueoo! %
;oo% &
WarningMessagepp "
=pp# $
$"pp% '
$strpp' 0
{pp0 1
resultpp1 7
.pp7 8
Datapp8 <
:pp< =
$strpp= ?
}pp? @
$strpp@ y
"ppy z
;ppz {
}qq 
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
awaituu 
_errorHandleruu #
.uu# $
LogErrorAsyncuu$ 1
(uu1 2
$struu2 V
,uuV W
Enum_ErrorSeverityuuX j
.uuj k
Warninguuk r
,uur s
exuut v
)uuv w
;uuw x
}vv 
}ww 	
[yy 	
RelayCommandyy	 
]yy 
privatezz 
asynczz 
Taskzz $
ValidateAndContinueAsynczz 3
(zz3 4
)zz4 5
{{{ 	
foreach}} 
(}} 
var}} 
load}} 
in}}  
Loads}}! &
)}}& '
{~~ 
var 
result 
= 
_validationService /
./ 0"
ValidateWeightQuantity0 F
(F G
loadG K
.K L
WeightQuantityL Z
)Z [
;[ \
if
ÄÄ 
(
ÄÄ 
!
ÄÄ 
result
ÄÄ 
.
ÄÄ 
IsValid
ÄÄ #
)
ÄÄ# $
{
ÅÅ 
await
ÇÇ 
_errorHandler
ÇÇ '
.
ÇÇ' (
HandleErrorAsync
ÇÇ( 8
(
ÇÇ8 9
$"
ÇÇ9 ;
$str
ÇÇ; @
{
ÇÇ@ A
load
ÇÇA E
.
ÇÇE F

LoadNumber
ÇÇF P
}
ÇÇP Q
$str
ÇÇQ S
{
ÇÇS T
result
ÇÇT Z
.
ÇÇZ [
Message
ÇÇ[ b
}
ÇÇb c
"
ÇÇc d
,
ÇÇd e 
Enum_ErrorSeverity
ÇÇf x
.
ÇÇx y
WarningÇÇy Ä
)ÇÇÄ Å
;ÇÇÅ Ç
return
ÉÉ 
;
ÉÉ 
}
ÑÑ 
}
ÖÖ 
if
àà 
(
àà 
!
àà 
_workflowService
àà !
.
àà! "
CurrentSession
àà" 0
.
àà0 1
IsNonPO
àà1 8
&&
àà9 ;
_workflowService
àà< L
.
ààL M
CurrentPart
ààM X
!=
ààY [
null
àà\ `
)
àà` a
{
ââ 
var
ää 
totalWeight
ää 
=
ää  !
Loads
ää" '
.
ää' (
Sum
ää( +
(
ää+ ,
l
ää, -
=>
ää. 0
l
ää1 2
.
ää2 3
WeightQuantity
ää3 A
)
ääA B
;
ääB C
if
ãã 
(
ãã 
totalWeight
ãã 
>
ãã  !
_workflowService
ãã" 2
.
ãã2 3
CurrentPart
ãã3 >
.
ãã> ?

QtyOrdered
ãã? I
)
ããI J
{
åå 
}
òò 
}
ôô 
}
≥≥ 	
}
¥¥ 
}µµ ﬂZ
kC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_ReviewGridViewModel.cs
	namespace

 	%
MTM_Receiving_Application


 #
.

# $

ViewModels

$ .
.

. /
	Receiving

/ 8
{ 
public 

partial 
class )
Receiving_ReviewGridViewModel 6
:7 8 
Shared_BaseViewModel9 M
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
private 
readonly (
IService_ReceivingValidation 5
_validationService6 H
;H I
[ 	
ObservableProperty	 
] 
private  
ObservableCollection $
<$ %
Model_ReceivingLoad% 8
>8 9
_loads: @
=A B
newC F
(F G
)G H
;H I
[ 	
ObservableProperty	 
] 
private 
bool 
_isSingleView "
=# $
true% )
;) *
[ 	
ObservableProperty	 
] 
private 
int 
_currentEntryIndex &
=' (
$num) *
;* +
[ 	
ObservableProperty	 
] 
private 
Model_ReceivingLoad #
?# $
_currentEntry% 2
;2 3
public   
int   
DisplayIndex   
=>    "
CurrentEntryIndex  # 4
+  5 6
$num  7 8
;  8 9
public%% 
bool%% 
	CanGoBack%% 
=>%%  
CurrentEntryIndex%%! 2
>%%3 4
$num%%5 6
;%%6 7
public** 
bool** 
	CanGoNext** 
=>**  
Loads**! &
.**& '
Count**' ,
>**- .
$num**/ 0
&&**1 3
CurrentEntryIndex**4 E
<**F G
Loads**H M
.**M N
Count**N S
-**T U
$num**V W
;**W X
public// 
bool// 
IsTableView// 
=>//  "
!//# $
IsSingleView//$ 0
;//0 1
public11 )
Receiving_ReviewGridViewModel11 ,
(11, -&
IService_ReceivingWorkflow22 &
workflowService22' 6
,226 7(
IService_ReceivingValidation33 (
validationService33) :
,33: ;!
IService_ErrorHandler44 !
errorHandler44" .
,44. /#
IService_LoggingUtility55 #
logger55$ *
)55* +
:66 
base66 
(66 
errorHandler66 
,66  
logger66! '
)66' (
{77 	
_workflowService88 
=88 
workflowService88 .
;88. /
_validationService99 
=99  
validationService99! 2
;992 3
_workflowService;; 
.;; 
StepChanged;; (
+=;;) +
OnStepChanged;;, 9
;;;9 :
}<< 	
private>> 
void>> 
OnStepChanged>> "
(>>" #
object>># )
?>>) *
sender>>+ 1
,>>1 2
System>>3 9
.>>9 :
	EventArgs>>: C
e>>D E
)>>E F
{?? 	
if@@ 
(@@ 
_workflowService@@  
.@@  !
CurrentStep@@! ,
==@@- /
WorkflowStep@@0 <
.@@< =
Review@@= C
)@@C D
{AA 
_BB 
=BB 
OnNavigatedToAsyncBB &
(BB& '
)BB' (
;BB( )
}CC 
}DD 	
publicFF 
asyncFF 
TaskFF 
OnNavigatedToAsyncFF ,
(FF, -
)FF- .
{GG 	
LoadsHH 
.HH 
ClearHH 
(HH 
)HH 
;HH 
ifII 
(II 
_workflowServiceII  
.II  !
CurrentSessionII! /
?II/ 0
.II0 1
LoadsII1 6
!=II7 9
nullII: >
)II> ?
{JJ 
foreachKK 
(KK 
varKK 
loadKK !
inKK" $
_workflowServiceKK% 5
.KK5 6
CurrentSessionKK6 D
.KKD E
LoadsKKE J
)KKJ K
{LL 
LoadsMM 
.MM 
AddMM 
(MM 
loadMM "
)MM" #
;MM# $
}NN 
ifQQ 
(QQ 
LoadsQQ 
.QQ 
CountQQ 
>QQ  !
$numQQ" #
)QQ# $
{RR 
CurrentEntryIndexSS %
=SS& '
$numSS( )
;SS) *
CurrentEntryTT  
=TT! "
LoadsTT# (
[TT( )
$numTT) *
]TT* +
;TT+ ,
}UU 
}VV 
OnPropertyChangedXX 
(XX 
nameofXX $
(XX$ %
	CanGoBackXX% .
)XX. /
)XX/ 0
;XX0 1
OnPropertyChangedYY 
(YY 
nameofYY $
(YY$ %
	CanGoNextYY% .
)YY. /
)YY/ 0
;YY0 1
OnPropertyChangedZZ 
(ZZ 
nameofZZ $
(ZZ$ %
DisplayIndexZZ% 1
)ZZ1 2
)ZZ2 3
;ZZ3 4
await[[ 
Task[[ 
.[[ 
CompletedTask[[ $
;[[$ %
}\\ 	
[^^ 	
RelayCommand^^	 
]^^ 
private__ 
void__ 
PreviousEntry__ "
(__" #
)__# $
{`` 	
ifaa 
(aa 
CurrentEntryIndexaa !
>aa" #
$numaa$ %
)aa% &
{bb 
CurrentEntryIndexcc !
--cc! #
;cc# $
CurrentEntrydd 
=dd 
Loadsdd $
[dd$ %
CurrentEntryIndexdd% 6
]dd6 7
;dd7 8
OnPropertyChangedee !
(ee! "
nameofee" (
(ee( )
	CanGoBackee) 2
)ee2 3
)ee3 4
;ee4 5
OnPropertyChangedff !
(ff! "
nameofff" (
(ff( )
	CanGoNextff) 2
)ff2 3
)ff3 4
;ff4 5
OnPropertyChangedgg !
(gg! "
nameofgg" (
(gg( )
DisplayIndexgg) 5
)gg5 6
)gg6 7
;gg7 8
}hh 
}ii 	
[kk 	
RelayCommandkk	 
]kk 
privatell 
voidll 
	NextEntryll 
(ll 
)ll  
{mm 	
ifnn 
(nn 
CurrentEntryIndexnn !
<nn" #
Loadsnn$ )
.nn) *
Countnn* /
-nn0 1
$numnn2 3
)nn3 4
{oo 
CurrentEntryIndexpp !
++pp! #
;pp# $
CurrentEntryqq 
=qq 
Loadsqq $
[qq$ %
CurrentEntryIndexqq% 6
]qq6 7
;qq7 8
OnPropertyChangedrr !
(rr! "
nameofrr" (
(rr( )
	CanGoBackrr) 2
)rr2 3
)rr3 4
;rr4 5
OnPropertyChangedss !
(ss! "
nameofss" (
(ss( )
	CanGoNextss) 2
)ss2 3
)ss3 4
;ss4 5
OnPropertyChangedtt !
(tt! "
nameoftt" (
(tt( )
DisplayIndextt) 5
)tt5 6
)tt6 7
;tt7 8
}uu 
}vv 	
[xx 	
RelayCommandxx	 
]xx 
privateyy 
voidyy 
SwitchToTableViewyy &
(yy& '
)yy' (
{zz 	
IsSingleView{{ 
={{ 
false{{  
;{{  !
OnPropertyChanged|| 
(|| 
nameof|| $
(||$ %
IsTableView||% 0
)||0 1
)||1 2
;||2 3
}}} 	
[ 	
RelayCommand	 
] 
private
ÄÄ 
void
ÄÄ  
SwitchToSingleView
ÄÄ '
(
ÄÄ' (
)
ÄÄ( )
{
ÅÅ 	
IsSingleView
ÇÇ 
=
ÇÇ 
true
ÇÇ 
;
ÇÇ  
OnPropertyChanged
ÉÉ 
(
ÉÉ 
nameof
ÉÉ $
(
ÉÉ$ %
IsTableView
ÉÉ% 0
)
ÉÉ0 1
)
ÉÉ1 2
;
ÉÉ2 3
}
ÑÑ 	
[
ÜÜ 	
RelayCommand
ÜÜ	 
]
ÜÜ 
private
áá 
async
áá 
Task
áá !
AddAnotherPartAsync
áá .
(
áá. /
)
áá/ 0
{
àà 	
await
éé 
_workflowService
éé "
.
éé" #*
AddCurrentPartToSessionAsync
éé# ?
(
éé? @
)
éé@ A
;
ééA B
_workflowService
ìì 
.
ìì 
GoToStep
ìì %
(
ìì% &
WorkflowStep
ìì& 2
.
ìì2 3
POEntry
ìì3 :
)
ìì: ;
;
ìì; <
}
îî 	
[
ññ 	
RelayCommand
ññ	 
]
ññ 
private
óó 
async
óó 
Task
óó 
	SaveAsync
óó $
(
óó$ %
)
óó% &
{
òò 	
await
õõ 
_workflowService
õõ "
.
õõ" #$
AdvanceToNextStepAsync
õõ# 9
(
õõ9 :
)
õõ: ;
;
õõ; <
}
úú 	
public
ûû 
void
ûû #
HandleCascadingUpdate
ûû )
(
ûû) *!
Model_ReceivingLoad
ûû* =
changedLoad
ûû> I
,
ûûI J
string
ûûK Q
propertyName
ûûR ^
)
ûû^ _
{
üü 	
if
†† 
(
†† 
changedLoad
†† 
==
†† 
null
†† #
)
††# $
return
††% +
;
††+ ,
var
™™ 
index
™™ 
=
™™ 
Loads
™™ 
.
™™ 
IndexOf
™™ %
(
™™% &
changedLoad
™™& 1
)
™™1 2
;
™™2 3
if
´´ 
(
´´ 
index
´´ 
<
´´ 
$num
´´ 
)
´´ 
return
´´ !
;
´´! "
if
≠≠ 
(
≠≠ 
propertyName
≠≠ 
==
≠≠ 
nameof
≠≠  &
(
≠≠& '!
Model_ReceivingLoad
≠≠' :
.
≠≠: ;
PoNumber
≠≠; C
)
≠≠C D
)
≠≠D E
{
ÆÆ 
foreach
≤≤ 
(
≤≤ 
var
≤≤ 
load
≤≤ !
in
≤≤" $
Loads
≤≤% *
)
≤≤* +
{
≥≥ 
if
¥¥ 
(
¥¥ 
load
¥¥ 
!=
¥¥ 
changedLoad
¥¥  +
)
¥¥+ ,
{
µµ 
load
∂∂ 
.
∂∂ 
PoNumber
∂∂ %
=
∂∂& '
changedLoad
∂∂( 3
.
∂∂3 4
PoNumber
∂∂4 <
;
∂∂< =
}
∑∑ 
}
∏∏ 
}
ππ 
else
∫∫ 
if
∫∫ 
(
∫∫ 
propertyName
∫∫ !
==
∫∫" $
nameof
∫∫% +
(
∫∫+ ,!
Model_ReceivingLoad
∫∫, ?
.
∫∫? @
PartID
∫∫@ F
)
∫∫F G
)
∫∫G H
{
ªª 
foreach
ææ 
(
ææ 
var
ææ 
load
ææ !
in
ææ" $
Loads
ææ% *
)
ææ* +
{
øø 
if
¿¿ 
(
¿¿ 
load
¿¿ 
!=
¿¿ 
changedLoad
¿¿  +
)
¿¿+ ,
{
¡¡ 
load
¬¬ 
.
¬¬ 
PartID
¬¬ #
=
¬¬$ %
changedLoad
¬¬& 1
.
¬¬1 2
PartID
¬¬2 8
;
¬¬8 9
}
√√ 
}
ƒƒ 
}
≈≈ 
}
«« 	
}
»» 
}…… ë®
hC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_POEntryViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
	Receiving/ 8
{ 
public 

partial 
class &
Receiving_POEntryViewModel 3
:4 5 
Shared_BaseViewModel6 J
{ 
private 
readonly  
IService_InforVisual -
_inforVisualService. A
;A B
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
[ 	
ObservableProperty	 
] 
private 
string 
	_poNumber  
=! "
string# )
.) *
Empty* /
;/ 0
[ 	
ObservableProperty	 
] 
private 
string 
_partID 
=  
string! '
.' (
Empty( -
;- .
[ 	
ObservableProperty	 
] 
private 
bool 

_isLoading 
;  
[ 	
ObservableProperty	 
] 
private 
bool 
_isNonPOItem !
;! "
[   	
ObservableProperty  	 
]   
private!! 
bool!! 
_isLoadPOEnabled!! %
=!!& '
false!!( -
;!!- .
[## 	
ObservableProperty##	 
]## 
private$$ 
string$$  
_poValidationMessage$$ +
=$$, -
string$$. 4
.$$4 5
Empty$$5 :
;$$: ;
[&& 	
ObservableProperty&&	 
]&& 
private''  
ObservableCollection'' $
<''$ %!
Model_InforVisualPart''% :
>'': ;
_parts''< B
=''C D
new''E H
(''H I
)''I J
;''J K
[)) 	
ObservableProperty))	 
])) 
private** !
Model_InforVisualPart** %
?**% &
_selectedPart**' 4
;**4 5
[,, 	
ObservableProperty,,	 
],, 
private-- 
string-- 
_packageType-- #
=--$ %
$str--& -
;--- .
[// 	
ObservableProperty//	 
]// 
private00 
string00 
	_poStatus00  
=00! "
string00# )
.00) *
Empty00* /
;00/ 0
[22 	
ObservableProperty22	 
]22 
private33 
string33  
_poStatusDescription33 +
=33, -
string33. 4
.334 5
Empty335 :
;33: ;
[55 	
ObservableProperty55	 
]55 
private66 
bool66 
_isPOClosed66  
=66! "
false66# (
;66( )
public88 &
Receiving_POEntryViewModel88 )
(88) * 
IService_InforVisual99  
inforVisualService99! 3
,993 4&
IService_ReceivingWorkflow:: &
workflowService::' 6
,::6 7!
IService_ErrorHandler;; !
errorHandler;;" .
,;;. /#
IService_LoggingUtility<< #
logger<<$ *
)<<* +
:== 
base== 
(== 
errorHandler== 
,==  
logger==! '
)==' (
{>> 	
_inforVisualService?? 
=??  !
inforVisualService??" 4
;??4 5
_workflowService@@ 
=@@ 
workflowService@@ .
;@@. /
}AA 	
[CC 	
RelayCommandCC	 
]CC 
privateDD 
voidDD 
PoTextBoxLostFocusDD '
(DD' (
)DD( )
{EE 	
ifGG 
(GG 
stringGG 
.GG 
IsNullOrWhiteSpaceGG )
(GG) *
PoNumberGG* 2
)GG2 3
)GG3 4
returnHH 
;HH 
stringKK 
valueKK 
=KK 
PoNumberKK #
.KK# $
TrimKK$ (
(KK( )
)KK) *
.KK* +
ToUpperKK+ 2
(KK2 3
)KK3 4
;KK4 5
ifNN 
(NN 
valueNN 
.NN 

StartsWithNN  
(NN  !
$strNN! &
,NN& '
StringComparisonNN( 8
.NN8 9
OrdinalIgnoreCaseNN9 J
)NNJ K
)NNK L
{OO 
stringQQ 

numberPartQQ !
=QQ" #
valueQQ$ )
.QQ) *
	SubstringQQ* 3
(QQ3 4
$numQQ4 5
)QQ5 6
;QQ6 7
ifRR 
(RR 

numberPartRR 
.RR 
AllRR "
(RR" #
charRR# '
.RR' (
IsDigitRR( /
)RR/ 0
&&RR1 3

numberPartRR4 >
.RR> ?
LengthRR? E
<=RRF H
$numRRI J
)RRJ K
{SS 
PoNumberTT 
=TT 
$"TT !
$strTT! $
{TT$ %

numberPartTT% /
.TT/ 0
PadLeftTT0 7
(TT7 8
$numTT8 9
,TT9 :
$charTT; >
)TT> ?
}TT? @
"TT@ A
;TTA B
}UU 
}VV 
elseWW 
ifWW 
(WW 
valueWW 
.WW 
AllWW 
(WW 
charWW #
.WW# $
IsDigitWW$ +
)WW+ ,
&&WW- /
valueWW0 5
.WW5 6
LengthWW6 <
<=WW= ?
$numWW@ A
)WWA B
{XX 
PoNumberZZ 
=ZZ 
$"ZZ 
$strZZ  
{ZZ  !
valueZZ! &
.ZZ& '
PadLeftZZ' .
(ZZ. /
$numZZ/ 0
,ZZ0 1
$charZZ2 5
)ZZ5 6
}ZZ6 7
"ZZ7 8
;ZZ8 9
}[[ 
}]] 	
[__ 	
RelayCommand__	 
]__ 
private`` 
async`` 
Task`` 
LoadPOAsync`` &
(``& '
)``' (
{aa 	
ifbb 
(bb 
stringbb 
.bb 
IsNullOrWhiteSpacebb )
(bb) *
PoNumberbb* 2
)bb2 3
)bb3 4
{cc 
awaitdd 
_errorHandlerdd #
.dd# $
HandleErrorAsyncdd$ 4
(dd4 5
$strdd5 P
,ddP Q
Enum_ErrorSeverityddR d
.ddd e
Warningdde l
)ddl m
;ddm n
returnee 
;ee 
}ff 
	IsLoadinghh 
=hh 
truehh 
;hh 
tryii 
{jj 
varkk 
resultkk 
=kk 
awaitkk "
_inforVisualServicekk# 6
.kk6 7
GetPOWithPartsAsynckk7 J
(kkJ K
PoNumberkkK S
)kkS T
;kkT U
ifll 
(ll 
resultll 
.ll 
	IsSuccessll $
&&ll% '
resultll( .
.ll. /
Datall/ 3
!=ll4 6
nullll7 ;
)ll; <
{mm 
Partsnn 
.nn 
Clearnn 
(nn  
)nn  !
;nn! "
PoStatusqq 
=qq 
resultqq %
.qq% &
Dataqq& *
.qq* +
Statusqq+ 1
;qq1 2
PoStatusDescriptionrr '
=rr( )
resultrr* 0
.rr0 1
Datarr1 5
.rr5 6
StatusDescriptionrr6 G
;rrG H

IsPOClosedss 
=ss  
resultss! '
.ss' (
Datass( ,
.ss, -
IsClosedss- 5
;ss5 6
foreachvv 
(vv 
varvv  
partvv! %
invv& (
resultvv) /
.vv/ 0
Datavv0 4
.vv4 5
Partsvv5 :
)vv: ;
{ww 
varyy 
remainingQtyResultyy .
=yy/ 0
awaityy1 6
_inforVisualServiceyy7 J
.yyJ K%
GetRemainingQuantityAsyncyyK d
(yyd e
PoNumberyye m
,yym n
partyyo s
.yys t
PartIDyyt z
)yyz {
;yy{ |
ifzz 
(zz 
remainingQtyResultzz .
.zz. /
	IsSuccesszz/ 8
)zz8 9
{{{ 
part||  
.||  !
RemainingQuantity||! 2
=||3 4
remainingQtyResult||5 G
.||G H
Data||H L
;||L M
}}} 
Parts 
. 
Add !
(! "
part" &
)& '
;' (
}
ÄÄ 
_workflowService
ÇÇ $
.
ÇÇ$ % 
RaiseStatusMessage
ÇÇ% 7
(
ÇÇ7 8
$"
ÇÇ8 :
$str
ÇÇ: I
{
ÇÇI J
PoNumber
ÇÇJ R
}
ÇÇR S
$str
ÇÇS `
{
ÇÇ` a
Parts
ÇÇa f
.
ÇÇf g
Count
ÇÇg l
}
ÇÇl m
$str
ÇÇm t
"
ÇÇt u
)
ÇÇu v
;
ÇÇv w
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
var
ÜÜ 
errorMessage
ÜÜ $
=
ÜÜ% &
!
ÜÜ' (
string
ÜÜ( .
.
ÜÜ. / 
IsNullOrWhiteSpace
ÜÜ/ A
(
ÜÜA B
result
ÜÜB H
.
ÜÜH I
ErrorMessage
ÜÜI U
)
ÜÜU V
?
áá 
result
áá  
.
áá  !
ErrorMessage
áá! -
:
àà 
$str
àà >
;
àà> ?
await
ââ 
_errorHandler
ââ '
.
ââ' (
HandleErrorAsync
ââ( 8
(
ââ8 9
errorMessage
ââ9 E
,
ââE F 
Enum_ErrorSeverity
ââG Y
.
ââY Z
Error
ââZ _
)
ââ_ `
;
ââ` a
Parts
ää 
.
ää 
Clear
ää 
(
ää  
)
ää  !
;
ää! "
}
ãã 
}
åå 
finally
çç 
{
éé 
	IsLoading
èè 
=
èè 
false
èè !
;
èè! "
}
êê 
}
ëë 	
[
ìì 	
RelayCommand
ìì	 
]
ìì 
private
îî 
void
îî 
ToggleNonPO
îî  
(
îî  !
)
îî! "
{
ïï 	
IsNonPOItem
ññ 
=
ññ 
!
ññ 
IsNonPOItem
ññ &
;
ññ& '
Parts
óó 
.
óó 
Clear
óó 
(
óó 
)
óó 
;
óó 
SelectedPart
òò 
=
òò 
null
òò 
;
òò  
PoNumber
ôô 
=
ôô 
string
ôô 
.
ôô 
Empty
ôô #
;
ôô# $
PartID
öö 
=
öö 
string
öö 
.
öö 
Empty
öö !
;
öö! "
_workflowService
õõ 
.
õõ 
IsNonPOItem
õõ (
=
õõ) *
IsNonPOItem
õõ+ 6
;
õõ6 7
}
úú 	
[
ûû 	
RelayCommand
ûû	 
]
ûû 
private
üü 
async
üü 
Task
üü 
LookupPartAsync
üü *
(
üü* +
)
üü+ ,
{
†† 	
if
°° 
(
°° 
string
°° 
.
°°  
IsNullOrWhiteSpace
°° )
(
°°) *
PartID
°°* 0
)
°°0 1
)
°°1 2
{
¢¢ 
await
££ 
_errorHandler
££ #
.
££# $
HandleErrorAsync
££$ 4
(
££4 5
$str
££5 N
,
££N O 
Enum_ErrorSeverity
££P b
.
££b c
Warning
££c j
)
££j k
;
££k l
return
§§ 
;
§§ 
}
•• 
	IsLoading
ßß 
=
ßß 
true
ßß 
;
ßß 
try
®® 
{
©© 
var
™™ 
result
™™ 
=
™™ 
await
™™ "!
_inforVisualService
™™# 6
.
™™6 7
GetPartByIDAsync
™™7 G
(
™™G H
PartID
™™H N
)
™™N O
;
™™O P
if
´´ 
(
´´ 
result
´´ 
.
´´ 
	IsSuccess
´´ $
&&
´´% '
result
´´( .
.
´´. /
Data
´´/ 3
!=
´´4 6
null
´´7 ;
)
´´; <
{
¨¨ 
SelectedPart
≠≠  
=
≠≠! "
result
≠≠# )
.
≠≠) *
Data
≠≠* .
;
≠≠. /
Parts
∞∞ 
.
∞∞ 
Clear
∞∞ 
(
∞∞  
)
∞∞  !
;
∞∞! "
Parts
±± 
.
±± 
Add
±± 
(
±± 
result
±± $
.
±±$ %
Data
±±% )
)
±±) *
;
±±* +
_workflowService
≤≤ $
.
≤≤$ % 
RaiseStatusMessage
≤≤% 7
(
≤≤7 8
$"
≤≤8 :
$str
≤≤: ?
{
≤≤? @
PartID
≤≤@ F
}
≤≤F G
$str
≤≤G N
"
≤≤N O
)
≤≤O P
;
≤≤P Q
}
≥≥ 
else
¥¥ 
{
µµ 
await
∂∂ 
_errorHandler
∂∂ '
.
∂∂' (
HandleErrorAsync
∂∂( 8
(
∂∂8 9
result
∂∂9 ?
.
∂∂? @
ErrorMessage
∂∂@ L
??
∂∂M O
$str
∂∂P a
,
∂∂a b 
Enum_ErrorSeverity
∂∂c u
.
∂∂u v
Error
∂∂v {
)
∂∂{ |
;
∂∂| }
SelectedPart
∑∑  
=
∑∑! "
null
∑∑# '
;
∑∑' (
Parts
∏∏ 
.
∏∏ 
Clear
∏∏ 
(
∏∏  
)
∏∏  !
;
∏∏! "
}
ππ 
}
∫∫ 
finally
ªª 
{
ºº 
	IsLoading
ΩΩ 
=
ΩΩ 
false
ΩΩ !
;
ΩΩ! "
}
ææ 
}
øø 	
partial
¡¡ 
void
¡¡ 
OnPoNumberChanged
¡¡ &
(
¡¡& '
string
¡¡' -
value
¡¡. 3
)
¡¡3 4
{
¬¬ 	
if
∆∆ 
(
∆∆ 
string
∆∆ 
.
∆∆  
IsNullOrWhiteSpace
∆∆ )
(
∆∆) *
value
∆∆* /
)
∆∆/ 0
)
∆∆0 1
{
«« 
_workflowService
»»  
.
»»  !
CurrentPONumber
»»! 0
=
»»1 2
string
»»3 9
.
»»9 :
Empty
»»: ?
;
»»? @
IsLoadPOEnabled
…… 
=
……  !
false
……" '
;
……' (!
PoValidationMessage
   #
=
  $ %
string
  & ,
.
  , -
Empty
  - 2
;
  2 3
return
ÀÀ 
;
ÀÀ 
}
ÃÃ 
string
ŒŒ 
validatedPO
ŒŒ 
=
ŒŒ  
value
ŒŒ! &
.
ŒŒ& '
Trim
ŒŒ' +
(
ŒŒ+ ,
)
ŒŒ, -
;
ŒŒ- .
bool
œœ 
isValid
œœ 
=
œœ 
false
œœ  
;
œœ  !
if
““ 
(
““ 
validatedPO
““ 
.
““ 

StartsWith
““ &
(
““& '
$str
““' ,
,
““, -
StringComparison
““. >
.
““> ?
OrdinalIgnoreCase
““? P
)
““P Q
)
““Q R
{
”” 
string
’’ 

numberPart
’’ !
=
’’" #
validatedPO
’’$ /
.
’’/ 0
	Substring
’’0 9
(
’’9 :
$num
’’: ;
)
’’; <
;
’’< =
if
ÿÿ 
(
ÿÿ 

numberPart
ÿÿ 
.
ÿÿ 
All
ÿÿ "
(
ÿÿ" #
char
ÿÿ# '
.
ÿÿ' (
IsDigit
ÿÿ( /
)
ÿÿ/ 0
)
ÿÿ0 1
{
ŸŸ 
if
⁄⁄ 
(
⁄⁄ 

numberPart
⁄⁄ "
.
⁄⁄" #
Length
⁄⁄# )
<=
⁄⁄* ,
$num
⁄⁄- .
)
⁄⁄. /
{
€€ 
validatedPO
‹‹ #
=
‹‹$ %
$"
‹‹& (
$str
‹‹( +
{
‹‹+ ,

numberPart
‹‹, 6
.
‹‹6 7
PadLeft
‹‹7 >
(
‹‹> ?
$num
‹‹? @
,
‹‹@ A
$char
‹‹B E
)
‹‹E F
}
‹‹F G
"
‹‹G H
;
‹‹H I
isValid
›› 
=
››  !
true
››" &
;
››& '
}
ﬁﬁ 
else
ﬂﬂ 
{
‡‡ !
PoValidationMessage
·· +
=
··, -
$str
··. R
;
··R S
IsLoadPOEnabled
‚‚ '
=
‚‚( )
false
‚‚* /
;
‚‚/ 0
return
„„ 
;
„„ 
}
‰‰ 
}
ÂÂ 
else
ÊÊ 
{
ÁÁ !
PoValidationMessage
ËË '
=
ËË( )
$str
ËË* X
;
ËËX Y
IsLoadPOEnabled
ÈÈ #
=
ÈÈ$ %
false
ÈÈ& +
;
ÈÈ+ ,
return
ÍÍ 
;
ÍÍ 
}
ÎÎ 
}
ÏÏ 
else
ÌÌ 
if
ÌÌ 
(
ÌÌ 
validatedPO
ÌÌ  
.
ÌÌ  !
All
ÌÌ! $
(
ÌÌ$ %
char
ÌÌ% )
.
ÌÌ) *
IsDigit
ÌÌ* 1
)
ÌÌ1 2
)
ÌÌ2 3
{
ÓÓ 
if
 
(
 
validatedPO
 
.
  
Length
  &
<=
' )
$num
* +
)
+ ,
{
ÒÒ 
validatedPO
ÚÚ 
=
ÚÚ  !
$"
ÚÚ" $
$str
ÚÚ$ '
{
ÚÚ' (
validatedPO
ÚÚ( 3
.
ÚÚ3 4
PadLeft
ÚÚ4 ;
(
ÚÚ; <
$num
ÚÚ< =
,
ÚÚ= >
$char
ÚÚ? B
)
ÚÚB C
}
ÚÚC D
"
ÚÚD E
;
ÚÚE F
isValid
ÛÛ 
=
ÛÛ 
true
ÛÛ "
;
ÛÛ" #
}
ÙÙ 
else
ıı 
{
ˆˆ !
PoValidationMessage
˜˜ '
=
˜˜( )
$str
˜˜* N
;
˜˜N O
IsLoadPOEnabled
¯¯ #
=
¯¯$ %
false
¯¯& +
;
¯¯+ ,
return
˘˘ 
;
˘˘ 
}
˙˙ 
}
˚˚ 
else
¸¸ 
{
˝˝ !
PoValidationMessage
˛˛ #
=
˛˛$ %
$str
˛˛& T
;
˛˛T U
IsLoadPOEnabled
ˇˇ 
=
ˇˇ  !
false
ˇˇ" '
;
ˇˇ' (
return
ÄÄ 
;
ÄÄ 
}
ÅÅ 
_workflowService
ÉÉ 
.
ÉÉ 
CurrentPONumber
ÉÉ ,
=
ÉÉ- .
validatedPO
ÉÉ/ :
;
ÉÉ: ;
IsLoadPOEnabled
ÑÑ 
=
ÑÑ 
isValid
ÑÑ %
;
ÑÑ% &!
PoValidationMessage
ÖÖ 
=
ÖÖ  !
isValid
ÖÖ" )
?
ÖÖ* +
string
ÖÖ, 2
.
ÖÖ2 3
Empty
ÖÖ3 8
:
ÖÖ9 :
$str
ÖÖ; U
;
ÖÖU V
}
ÜÜ 	
partial
àà 
void
àà 
OnPartIDChanged
àà $
(
àà$ %
string
àà% +
value
àà, 1
)
àà1 2
{
ââ 	
if
ãã 
(
ãã 
string
ãã 
.
ãã  
IsNullOrWhiteSpace
ãã )
(
ãã) *
value
ãã* /
)
ãã/ 0
)
ãã0 1
{
åå 
PackageType
çç 
=
çç 
$str
çç %
;
çç% &
return
éé 
;
éé 
}
èè 
var
ëë 
	upperPart
ëë 
=
ëë 
value
ëë !
.
ëë! "
Trim
ëë" &
(
ëë& '
)
ëë' (
.
ëë( )
ToUpper
ëë) 0
(
ëë0 1
)
ëë1 2
;
ëë2 3
if
ìì 
(
ìì 
	upperPart
ìì 
.
ìì 

StartsWith
ìì $
(
ìì$ %
$str
ìì% *
)
ìì* +
)
ìì+ ,
PackageType
îî 
=
îî 
$str
îî %
;
îî% &
else
ïï 
if
ïï 
(
ïï 
	upperPart
ïï 
.
ïï 

StartsWith
ïï )
(
ïï) *
$str
ïï* /
)
ïï/ 0
)
ïï0 1
PackageType
ññ 
=
ññ 
$str
ññ &
;
ññ& '
else
óó 
PackageType
òò 
=
òò 
$str
òò %
;
òò% &
}
ôô 	
partial
õõ 
void
õõ #
OnSelectedPartChanged
õõ *
(
õõ* +#
Model_InforVisualPart
õõ+ @
?
õõ@ A
value
õõB G
)
õõG H
{
úú 	
_workflowService
ùù 
.
ùù 
CurrentPart
ùù (
=
ùù) *
value
ùù+ 0
;
ùù0 1
if
†† 
(
†† 
value
†† 
!=
†† 
null
†† 
&&
††  
!
††! "
string
††" (
.
††( ) 
IsNullOrWhiteSpace
††) ;
(
††; <
value
††< A
.
††A B
PartID
††B H
)
††H I
)
††I J
{
°° 
var
¢¢ 
	upperPart
¢¢ 
=
¢¢ 
value
¢¢  %
.
¢¢% &
PartID
¢¢& ,
.
¢¢, -
Trim
¢¢- 1
(
¢¢1 2
)
¢¢2 3
.
¢¢3 4
ToUpper
¢¢4 ;
(
¢¢; <
)
¢¢< =
;
¢¢= >
if
§§ 
(
§§ 
	upperPart
§§ 
.
§§ 

StartsWith
§§ (
(
§§( )
$str
§§) .
)
§§. /
)
§§/ 0
PackageType
•• 
=
••  !
$str
••" )
;
••) *
else
¶¶ 
if
¶¶ 
(
¶¶ 
	upperPart
¶¶ "
.
¶¶" #

StartsWith
¶¶# -
(
¶¶- .
$str
¶¶. 3
)
¶¶3 4
)
¶¶4 5
PackageType
ßß 
=
ßß  !
$str
ßß" *
;
ßß* +
else
®® 
PackageType
©© 
=
©©  !
$str
©©" )
;
©©) *
}
™™ 
}
´´ 	
}
¨¨ 
}≠≠ ˘r
lC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_PackageTypeViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
	Receiving/ 8
{ 
public 

partial 
class *
Receiving_PackageTypeViewModel 7
:8 9 
Shared_BaseViewModel: N
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
private 
readonly -
!IService_MySQL_PackagePreferences :
_preferencesService; N
;N O
private 
readonly (
IService_ReceivingValidation 5
_validationService6 H
;H I
[ 	
ObservableProperty	 
] 
private  
ObservableCollection $
<$ %
Model_ReceivingLoad% 8
>8 9
_loads: @
=A B
newC F
(F G
)G H
;H I
[ 	
ObservableProperty	 
] 
private  
ObservableCollection $
<$ %
string% +
>+ ,
_packageTypes- :
=; <
new= @
(@ A
)A B
{C D
$strE L
,L M
$strN V
,V W
$strX _
,_ `
$stra i
}j k
;k l
[ 	
ObservableProperty	 
] 
private 
string  
_selectedPackageType +
=, -
string. 4
.4 5
Empty5 :
;: ;
[ 	
ObservableProperty	 
] 
private 
string "
_customPackageTypeName -
=. /
string0 6
.6 7
Empty7 <
;< =
[   	
ObservableProperty  	 
]   
private!! 
bool!!  
_isCustomTypeVisible!! )
;!!) *
[## 	
ObservableProperty##	 
]## 
private$$ 
bool$$ 
_isSaveAsDefault$$ %
;$$% &
public&& *
Receiving_PackageTypeViewModel&& -
(&&- .&
IService_ReceivingWorkflow'' &
workflowService''' 6
,''6 7-
!IService_MySQL_PackagePreferences(( -
preferencesService((. @
,((@ A(
IService_ReceivingValidation)) (
validationService))) :
,)): ;!
IService_ErrorHandler** !
errorHandler**" .
,**. /#
IService_LoggingUtility++ #
logger++$ *
)++* +
:,, 
base,, 
(,, 
errorHandler,, 
,,,  
logger,,! '
),,' (
{-- 	
_workflowService.. 
=.. 
workflowService.. .
;... /
_preferencesService// 
=//  !
preferencesService//" 4
;//4 5
_validationService00 
=00  
validationService00! 2
;002 3
_workflowService22 
.22 
StepChanged22 (
+=22) +
OnStepChanged22, 9
;229 :
}33 	
private55 
void55 
OnStepChanged55 "
(55" #
object55# )
?55) *
sender55+ 1
,551 2
System553 9
.559 :
	EventArgs55: C
e55D E
)55E F
{66 	
if77 
(77 
_workflowService77  
.77  !
CurrentStep77! ,
==77- /
WorkflowStep770 <
.77< =
PackageTypeEntry77= M
)77M N
{88 
_99 
=99 
OnNavigatedToAsync99 &
(99& '
)99' (
;99( )
}:: 
};; 	
public== 
async== 
Task== 
OnNavigatedToAsync== ,
(==, -
)==- .
{>> 	
Loads?? 
.?? 
Clear?? 
(?? 
)?? 
;?? 
if@@ 
(@@ 
_workflowService@@  
.@@  !
CurrentSession@@! /
?@@/ 0
.@@0 1
Loads@@1 6
!=@@7 9
null@@: >
)@@> ?
{AA 
foreachBB 
(BB 
varBB 
loadBB !
inBB" $
_workflowServiceBB% 5
.BB5 6
CurrentSessionBB6 D
.BBD E
LoadsBBE J
)BBJ K
{CC 
LoadsDD 
.DD 
AddDD 
(DD 
loadDD "
)DD" #
;DD# $
}EE 
}FF 
awaitHH  
LoadPreferencesAsyncHH &
(HH& '
)HH' (
;HH( )
}II 	
privateKK 
asyncKK 
TaskKK  
LoadPreferencesAsyncKK /
(KK/ 0
)KK0 1
{LL 	
varMM 
partIdMM 
=MM 
_workflowServiceMM )
.MM) *
CurrentPartMM* 5
?MM5 6
.MM6 7
PartIDMM7 =
;MM= >
ifNN 
(NN 
stringNN 
.NN 
IsNullOrEmptyNN $
(NN$ %
partIdNN% +
)NN+ ,
)NN, -
returnNN. 4
;NN4 5
varQQ 

preferenceQQ 
=QQ 
awaitQQ "
_preferencesServiceQQ# 6
.QQ6 7
GetPreferenceAsyncQQ7 I
(QQI J
partIdQQJ P
)QQP Q
;QQQ R
ifRR 
(RR 

preferenceRR 
!=RR 
nullRR "
)RR" #
{SS 
ifUU 
(UU 
PackageTypesUU  
.UU  !
ContainsUU! )
(UU) *

preferenceUU* 4
.UU4 5
PackageTypeNameUU5 D
)UUD E
)UUE F
{VV 
SelectedPackageTypeWW '
=WW( )

preferenceWW* 4
.WW4 5
PackageTypeNameWW5 D
;WWD E
}XX 
elseYY 
{ZZ 
SelectedPackageType[[ '
=[[( )
$str[[* 2
;[[2 3!
CustomPackageTypeName\\ )
=\\* +

preference\\, 6
.\\6 7
PackageTypeName\\7 F
;\\F G
}]] 
}^^ 
else__ 
{`` 
varbb 
partIDbb 
=bb 
_workflowServicebb -
.bb- .
CurrentPartbb. 9
?bb9 :
.bb: ;
PartIDbb; A
??bbB D
stringbbE K
.bbK L
EmptybbL Q
;bbQ R
ifcc 
(cc 
partIDcc 
.cc 

StartsWithcc %
(cc% &
$strcc& +
,cc+ ,
StringComparisoncc- =
.cc= >
OrdinalIgnoreCasecc> O
)ccO P
)ccP Q
{dd 
SelectedPackageTypeee '
=ee( )
$stree* 1
;ee1 2
_loggerff 
?ff 
.ff 
LogInfoff $
(ff$ %
$"ff% '
$strff' O
{ffO P
partIDffP V
}ffV W
"ffW X
)ffX Y
;ffY Z
}gg 
elsehh 
ifhh 
(hh 
partIDhh 
.hh  

StartsWithhh  *
(hh* +
$strhh+ 0
,hh0 1
StringComparisonhh2 B
.hhB C
OrdinalIgnoreCasehhC T
)hhT U
)hhU V
{ii 
SelectedPackageTypejj '
=jj( )
$strjj* 2
;jj2 3
_loggerkk 
?kk 
.kk 
LogInfokk $
(kk$ %
$"kk% '
$strkk' P
{kkP Q
partIDkkQ W
}kkW X
"kkX Y
)kkY Z
;kkZ [
}ll 
elsemm 
{nn 
SelectedPackageTypeoo '
=oo( )
$stroo* 1
;oo1 2
_loggerpp 
?pp 
.pp 
LogInfopp $
(pp$ %
$"pp% '
$strpp' Y
{ppY Z
partIDppZ `
}pp` a
"ppa b
)ppb c
;ppc d
}qq 
}rr 
}ss 	
partialuu 
voiduu (
OnSelectedPackageTypeChangeduu 1
(uu1 2
stringuu2 8
valueuu9 >
)uu> ?
{vv 	
IsCustomTypeVisibleww 
=ww  !
valueww" '
==ww( *
$strww+ 3
;ww3 4"
UpdateLoadsPackageTypexx "
(xx" #
)xx# $
;xx$ %
ifyy 
(yy 
IsSaveAsDefaultyy 
)yy  
SavePreferenceAsyncyy! 4
(yy4 5
)yy5 6
.yy6 7
ConfigureAwaityy7 E
(yyE F
falseyyF K
)yyK L
;yyL M
}zz 	
partial|| 
void|| *
OnCustomPackageTypeNameChanged|| 3
(||3 4
string||4 :
value||; @
)||@ A
{}} 	
if~~ 
(~~ 
SelectedPackageType~~ #
==~~$ &
$str~~' /
)~~/ 0
{ $
UpdateLoadsPackageType
ÄÄ &
(
ÄÄ& '
)
ÄÄ' (
;
ÄÄ( )
if
ÅÅ 
(
ÅÅ 
IsSaveAsDefault
ÅÅ #
)
ÅÅ# $!
SavePreferenceAsync
ÅÅ% 8
(
ÅÅ8 9
)
ÅÅ9 :
.
ÅÅ: ;
ConfigureAwait
ÅÅ; I
(
ÅÅI J
false
ÅÅJ O
)
ÅÅO P
;
ÅÅP Q
}
ÇÇ 
}
ÉÉ 	
partial
ÖÖ 
void
ÖÖ &
OnIsSaveAsDefaultChanged
ÖÖ -
(
ÖÖ- .
bool
ÖÖ. 2
value
ÖÖ3 8
)
ÖÖ8 9
{
ÜÜ 	
if
áá 
(
áá 
value
áá 
)
áá 
{
àà !
SavePreferenceAsync
ââ #
(
ââ# $
)
ââ$ %
.
ââ% &
ConfigureAwait
ââ& 4
(
ââ4 5
false
ââ5 :
)
ââ: ;
;
ââ; <
}
ää 
else
ãã 
{
åå #
DeletePreferenceAsync
ëë %
(
ëë% &
)
ëë& '
.
ëë' (
ConfigureAwait
ëë( 6
(
ëë6 7
false
ëë7 <
)
ëë< =
;
ëë= >
}
íí 
}
ìì 	
private
ïï 
void
ïï $
UpdateLoadsPackageType
ïï +
(
ïï+ ,
)
ïï, -
{
ññ 	
var
óó 
typeName
óó 
=
óó !
SelectedPackageType
óó .
==
óó/ 1
$str
óó2 :
?
óó; <#
CustomPackageTypeName
óó= R
:
óóS T!
SelectedPackageType
óóU h
;
óóh i
foreach
ôô 
(
ôô 
var
ôô 
load
ôô 
in
ôô  
Loads
ôô! &
)
ôô& '
{
öö 
load
õõ 
.
õõ 
PackageTypeName
õõ $
=
õõ% &
typeName
õõ' /
;
õõ/ 0
}
úú 
}
ùù 	
[
üü 	
RelayCommand
üü	 
]
üü 
private
†† 
async
†† 
Task
†† !
SavePreferenceAsync
†† .
(
††. /
)
††/ 0
{
°° 	
var
¢¢ 
partId
¢¢ 
=
¢¢ 
_workflowService
¢¢ )
.
¢¢) *
CurrentPart
¢¢* 5
?
¢¢5 6
.
¢¢6 7
PartID
¢¢7 =
;
¢¢= >
if
££ 
(
££ 
string
££ 
.
££ 
IsNullOrEmpty
££ $
(
££$ %
partId
££% +
)
££+ ,
)
££, -
return
££. 4
;
££4 5
var
•• 
typeName
•• 
=
•• !
SelectedPackageType
•• .
==
••/ 1
$str
••2 :
?
••; <#
CustomPackageTypeName
••= R
:
••S T!
SelectedPackageType
••U h
;
••h i
if
¶¶ 
(
¶¶ 
string
¶¶ 
.
¶¶  
IsNullOrWhiteSpace
¶¶ )
(
¶¶) *
typeName
¶¶* 2
)
¶¶2 3
)
¶¶3 4
return
¶¶5 ;
;
¶¶; <
var
®® 

preference
®® 
=
®® 
new
®®  )
Model_PackageTypePreference
®®! <
{
©© 
PartID
™™ 
=
™™ 
partId
™™ 
,
™™  
PackageTypeName
´´ 
=
´´  !
typeName
´´" *
}
¨¨ 
;
¨¨ 
try
ÆÆ 
{
ØØ 
await
∞∞ !
_preferencesService
∞∞ )
.
∞∞) *!
SavePreferenceAsync
∞∞* =
(
∞∞= >

preference
∞∞> H
)
∞∞H I
;
∞∞I J
_workflowService
±±  
.
±±  ! 
RaiseStatusMessage
±±! 3
(
±±3 4
$str
±±4 G
)
±±G H
;
±±H I
}
≤≤ 
catch
≥≥ 
(
≥≥ 
System
≥≥ 
.
≥≥ 
	Exception
≥≥ #
ex
≥≥$ &
)
≥≥& '
{
¥¥ 
await
µµ 
_errorHandler
µµ #
.
µµ# $
HandleErrorAsync
µµ$ 4
(
µµ4 5
$str
µµ5 P
,
µµP Q 
Enum_ErrorSeverity
µµR d
.
µµd e
Warning
µµe l
,
µµl m
ex
µµn p
)
µµp q
;
µµq r
}
∂∂ 
}
∑∑ 	
private
ππ 
async
ππ 
Task
ππ #
DeletePreferenceAsync
ππ 0
(
ππ0 1
)
ππ1 2
{
∫∫ 	
var
ªª 
partId
ªª 
=
ªª 
_workflowService
ªª )
.
ªª) *
CurrentPart
ªª* 5
?
ªª5 6
.
ªª6 7
PartID
ªª7 =
;
ªª= >
if
ºº 
(
ºº 
string
ºº 
.
ºº 
IsNullOrEmpty
ºº $
(
ºº$ %
partId
ºº% +
)
ºº+ ,
)
ºº, -
return
ºº. 4
;
ºº4 5
try
ææ 
{
øø 
await
¿¿ !
_preferencesService
¿¿ )
.
¿¿) *#
DeletePreferenceAsync
¿¿* ?
(
¿¿? @
partId
¿¿@ F
)
¿¿F G
;
¿¿G H
_workflowService
¡¡  
.
¡¡  ! 
RaiseStatusMessage
¡¡! 3
(
¡¡3 4
$str
¡¡4 I
)
¡¡I J
;
¡¡J K
}
¬¬ 
catch
√√ 
(
√√ 
System
√√ 
.
√√ 
	Exception
√√ #
ex
√√$ &
)
√√& '
{
ƒƒ 
await
≈≈ 
_errorHandler
≈≈ #
.
≈≈# $
HandleErrorAsync
≈≈$ 4
(
≈≈4 5
$str
≈≈5 R
,
≈≈R S 
Enum_ErrorSeverity
≈≈T f
.
≈≈f g
Warning
≈≈g n
,
≈≈n o
ex
≈≈p r
)
≈≈r s
;
≈≈s t
}
∆∆ 
}
«« 	
}
»» 
}…… Ãv
nC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_ModeSelectionViewModel.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $

ViewModels		$ .
.		. /
	Receiving		/ 8
{

 
public 

partial 
class 5
)Receiving_ReceivingModeSelectionViewModel B
:C D 
Shared_BaseViewModelE Y
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
private 
readonly '
IService_UserSessionManager 4
_sessionManager5 D
;D E
private 
readonly $
IService_UserPreferences 1#
_userPreferencesService2 I
;I J
[ 	
ObservableProperty	 
] 
private 
bool  
_isGuidedModeDefault )
;) *
[ 	
ObservableProperty	 
] 
private 
bool  
_isManualModeDefault )
;) *
[ 	
ObservableProperty	 
] 
private 
bool 
_isEditModeDefault '
;' (
public 5
)Receiving_ReceivingModeSelectionViewModel 8
(8 9&
IService_ReceivingWorkflow &
workflowService' 6
,6 7'
IService_UserSessionManager '
sessionManager( 6
,6 7$
IService_UserPreferences $"
userPreferencesService% ;
,; <!
IService_ErrorHandler !
errorHandler" .
,. /#
IService_LoggingUtility #
logger$ *
)* +
:   
base   
(   
errorHandler   
,    
logger  ! '
)  ' (
{!! 	
_workflowService"" 
="" 
workflowService"" .
;"". /
_sessionManager## 
=## 
sessionManager## ,
;##, -#
_userPreferencesService$$ #
=$$$ %"
userPreferencesService$$& <
;$$< =
LoadDefaultMode'' 
('' 
)'' 
;'' 
}(( 	
private** 
void** 
LoadDefaultMode** $
(**$ %
)**% &
{++ 	
var,, 
currentUser,, 
=,, 
_sessionManager,, -
.,,- .
CurrentSession,,. <
?,,< =
.,,= >
User,,> B
;,,B C
if-- 
(-- 
currentUser-- 
!=-- 
null-- #
)--# $
{.. 
IsGuidedModeDefault// #
=//$ %
currentUser//& 1
.//1 2 
DefaultReceivingMode//2 F
==//G I
$str//J R
;//R S
IsManualModeDefault00 #
=00$ %
currentUser00& 1
.001 2 
DefaultReceivingMode002 F
==00G I
$str00J R
;00R S
IsEditModeDefault11 !
=11" #
currentUser11$ /
.11/ 0 
DefaultReceivingMode110 D
==11E G
$str11H N
;11N O
}22 
}33 	
[55 	
RelayCommand55	 
]55 
private66 
void66 
SelectGuidedMode66 %
(66% &
)66& '
{77 	
_logger88 
.88 
LogInfo88 
(88 
$str88 8
)888 9
;889 :
_workflowService99 
.99 
GoToStep99 %
(99% &
WorkflowStep99& 2
.992 3
POEntry993 :
)99: ;
;99; <
}:: 	
[<< 	
RelayCommand<<	 
]<< 
private== 
void== 
SelectManualMode== %
(==% &
)==& '
{>> 	
_logger?? 
.?? 
LogInfo?? 
(?? 
$str?? 8
)??8 9
;??9 :
_workflowService@@ 
.@@ 
GoToStep@@ %
(@@% &
WorkflowStep@@& 2
.@@2 3
ManualEntry@@3 >
)@@> ?
;@@? @
}AA 	
[CC 	
RelayCommandCC	 
]CC 
privateDD 
voidDD 
SelectEditModeDD #
(DD# $
)DD$ %
{EE 	
_loggerFF 
.FF 
LogInfoFF 
(FF 
$strFF 6
)FF6 7
;FF7 8
_workflowServiceGG 
.GG 
GoToStepGG %
(GG% &
WorkflowStepGG& 2
.GG2 3
EditModeGG3 ;
)GG; <
;GG< =
}HH 	
[JJ 	
RelayCommandJJ	 
]JJ 
privateKK 
asyncKK 
TaskKK #
SetGuidedAsDefaultAsyncKK 2
(KK2 3
boolKK3 7
	isCheckedKK8 A
)KKA B
{LL 	
tryMM 
{NN 
varOO 
currentUserOO 
=OO  !
_sessionManagerOO" 1
.OO1 2
CurrentSessionOO2 @
?OO@ A
.OOA B
UserOOB F
;OOF G
ifPP 
(PP 
currentUserPP 
==PP  "
nullPP# '
)PP' (
returnPP) /
;PP/ 0
stringRR 
?RR 
newModeRR 
=RR  !
	isCheckedRR" +
?RR, -
$strRR. 6
:RR7 8
nullRR9 =
;RR= >
varii 
resultii 
=ii 
awaitii "#
_userPreferencesServiceii# :
.ii: ;"
UpdateDefaultModeAsyncii; Q
(iiQ R
currentUseriiR ]
.ii] ^
WindowsUsernameii^ m
,iim n
newModeiio v
??iiw y
$striiz |
)ii| }
;ii} ~
ifkk 
(kk 
resultkk 
.kk 
	IsSuccesskk $
)kk$ %
{ll 
currentUsernn 
.nn   
DefaultReceivingModenn  4
=nn5 6
newModenn7 >
;nn> ?
IsGuidedModeDefaultqq '
=qq( )
	isCheckedqq* 3
;qq3 4
ifrr 
(rr 
	isCheckedrr !
)rr! "
{ss 
IsManualModeDefaulttt +
=tt, -
falsett. 3
;tt3 4
IsEditModeDefaultuu )
=uu* +
falseuu, 1
;uu1 2
}vv 
_loggerxx 
.xx 
LogInfoxx #
(xx# $
$"xx$ &
$strxx& ;
{xx; <
newModexx< C
??xxD F
$strxxG M
}xxM N
"xxN O
)xxO P
;xxP Q
StatusMessageyy !
=yy" #
	isCheckedyy$ -
?yy. /
$stryy0 L
:yyM N
$stryyO e
;yye f
}zz 
else{{ 
{|| 
await}} 
_errorHandler}} '
.}}' ( 
ShowErrorDialogAsync}}( <
(}}< =
$str}}= I
,}}I J
result}}K Q
.}}Q R
ErrorMessage}}R ^
,}}^ _
Enum_ErrorSeverity}}` r
.}}r s
Error}}s x
)}}x y
;}}y z
IsGuidedModeDefault '
=( )
!* +
	isChecked+ 4
;4 5
}
ÄÄ 
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÉÉ 
await
ÑÑ 
_errorHandler
ÑÑ #
.
ÑÑ# $
HandleErrorAsync
ÑÑ$ 4
(
ÑÑ4 5
$"
ÑÑ5 7
$str
ÑÑ7 S
{
ÑÑS T
ex
ÑÑT V
.
ÑÑV W
Message
ÑÑW ^
}
ÑÑ^ _
"
ÑÑ_ `
,
ÑÑ` a 
Enum_ErrorSeverity
ÖÖ &
.
ÖÖ& '
Error
ÖÖ' ,
,
ÖÖ, -
ex
ÖÖ. 0
,
ÖÖ0 1
true
ÖÖ2 6
)
ÖÖ6 7
;
ÖÖ7 8!
IsGuidedModeDefault
áá #
=
áá$ %
!
áá& '
	isChecked
áá' 0
;
áá0 1
}
àà 
}
ââ 	
[
ãã 	
RelayCommand
ãã	 
]
ãã 
private
åå 
async
åå 
Task
åå %
SetManualAsDefaultAsync
åå 2
(
åå2 3
bool
åå3 7
	isChecked
åå8 A
)
ååA B
{
çç 	
try
éé 
{
èè 
var
êê 
currentUser
êê 
=
êê  !
_sessionManager
êê" 1
.
êê1 2
CurrentSession
êê2 @
?
êê@ A
.
êêA B
User
êêB F
;
êêF G
if
ëë 
(
ëë 
currentUser
ëë 
==
ëë  "
null
ëë# '
)
ëë' (
return
ëë) /
;
ëë/ 0
string
ìì 
?
ìì 
newMode
ìì 
=
ìì  !
	isChecked
ìì" +
?
ìì, -
$str
ìì. 6
:
ìì7 8
null
ìì9 =
;
ìì= >
var
ïï 
result
ïï 
=
ïï 
await
ïï "%
_userPreferencesService
ïï# :
.
ïï: ;$
UpdateDefaultModeAsync
ïï; Q
(
ïïQ R
currentUser
ïïR ]
.
ïï] ^
WindowsUsername
ïï^ m
,
ïïm n
newMode
ïïo v
??
ïïw y
$str
ïïz |
)
ïï| }
;
ïï} ~
if
óó 
(
óó 
result
óó 
.
óó 
	IsSuccess
óó $
)
óó$ %
{
òò 
currentUser
öö 
.
öö  "
DefaultReceivingMode
öö  4
=
öö5 6
newMode
öö7 >
;
öö> ?!
IsManualModeDefault
ùù '
=
ùù( )
	isChecked
ùù* 3
;
ùù3 4
if
ûû 
(
ûû 
	isChecked
ûû !
)
ûû! "
{
üü !
IsGuidedModeDefault
†† +
=
††, -
false
††. 3
;
††3 4
IsEditModeDefault
°° )
=
°°* +
false
°°, 1
;
°°1 2
}
¢¢ 
_logger
§§ 
.
§§ 
LogInfo
§§ #
(
§§# $
$"
§§$ &
$str
§§& ;
{
§§; <
newMode
§§< C
??
§§D F
$str
§§G M
}
§§M N
"
§§N O
)
§§O P
;
§§P Q
StatusMessage
•• !
=
••" #
	isChecked
••$ -
?
••. /
$str
••0 L
:
••M N
$str
••O e
;
••e f
}
¶¶ 
else
ßß 
{
®® 
await
©© 
_errorHandler
©© '
.
©©' ("
ShowErrorDialogAsync
©©( <
(
©©< =
$str
©©= I
,
©©I J
result
©©K Q
.
©©Q R
ErrorMessage
©©R ^
,
©©^ _ 
Enum_ErrorSeverity
©©` r
.
©©r s
Error
©©s x
)
©©x y
;
©©y z!
IsManualModeDefault
´´ '
=
´´( )
!
´´* +
	isChecked
´´+ 4
;
´´4 5
}
¨¨ 
}
≠≠ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
ex
ÆÆ 
)
ÆÆ  
{
ØØ 
await
∞∞ 
_errorHandler
∞∞ #
.
∞∞# $
HandleErrorAsync
∞∞$ 4
(
∞∞4 5
$"
∞∞5 7
$str
∞∞7 S
{
∞∞S T
ex
∞∞T V
.
∞∞V W
Message
∞∞W ^
}
∞∞^ _
"
∞∞_ `
,
∞∞` a 
Enum_ErrorSeverity
±± &
.
±±& '
Error
±±' ,
,
±±, -
ex
±±. 0
,
±±0 1
true
±±2 6
)
±±6 7
;
±±7 8!
IsManualModeDefault
≥≥ #
=
≥≥$ %
!
≥≥& '
	isChecked
≥≥' 0
;
≥≥0 1
}
¥¥ 
}
µµ 	
[
∑∑ 	
RelayCommand
∑∑	 
]
∑∑ 
private
∏∏ 
async
∏∏ 
Task
∏∏ #
SetEditAsDefaultAsync
∏∏ 0
(
∏∏0 1
bool
∏∏1 5
	isChecked
∏∏6 ?
)
∏∏? @
{
ππ 	
try
∫∫ 
{
ªª 
var
ºº 
currentUser
ºº 
=
ºº  !
_sessionManager
ºº" 1
.
ºº1 2
CurrentSession
ºº2 @
?
ºº@ A
.
ººA B
User
ººB F
;
ººF G
if
ΩΩ 
(
ΩΩ 
currentUser
ΩΩ 
==
ΩΩ  "
null
ΩΩ# '
)
ΩΩ' (
return
ΩΩ) /
;
ΩΩ/ 0
string
øø 
?
øø 
newMode
øø 
=
øø  !
	isChecked
øø" +
?
øø, -
$str
øø. 4
:
øø5 6
null
øø7 ;
;
øø; <
var
¡¡ 
result
¡¡ 
=
¡¡ 
await
¡¡ "%
_userPreferencesService
¡¡# :
.
¡¡: ;$
UpdateDefaultModeAsync
¡¡; Q
(
¡¡Q R
currentUser
¡¡R ]
.
¡¡] ^
WindowsUsername
¡¡^ m
,
¡¡m n
newMode
¡¡o v
??
¡¡w y
$str
¡¡z |
)
¡¡| }
;
¡¡} ~
if
√√ 
(
√√ 
result
√√ 
.
√√ 
	IsSuccess
√√ $
)
√√$ %
{
ƒƒ 
currentUser
∆∆ 
.
∆∆  "
DefaultReceivingMode
∆∆  4
=
∆∆5 6
newMode
∆∆7 >
;
∆∆> ?
IsEditModeDefault
…… %
=
……& '
	isChecked
……( 1
;
……1 2
if
   
(
   
	isChecked
   !
)
  ! "
{
ÀÀ !
IsGuidedModeDefault
ÃÃ +
=
ÃÃ, -
false
ÃÃ. 3
;
ÃÃ3 4!
IsManualModeDefault
ÕÕ +
=
ÕÕ, -
false
ÕÕ. 3
;
ÕÕ3 4
}
ŒŒ 
_logger
–– 
.
–– 
LogInfo
–– #
(
––# $
$"
––$ &
$str
––& ;
{
––; <
newMode
––< C
??
––D F
$str
––G M
}
––M N
"
––N O
)
––O P
;
––P Q
StatusMessage
—— !
=
——" #
	isChecked
——$ -
?
——. /
$str
——0 J
:
——K L
$str
——M c
;
——c d
}
““ 
else
”” 
{
‘‘ 
await
’’ 
_errorHandler
’’ '
.
’’' ("
ShowErrorDialogAsync
’’( <
(
’’< =
$str
’’= I
,
’’I J
result
’’K Q
.
’’Q R
ErrorMessage
’’R ^
,
’’^ _ 
Enum_ErrorSeverity
’’` r
.
’’r s
Error
’’s x
)
’’x y
;
’’y z
IsEditModeDefault
◊◊ %
=
◊◊& '
!
◊◊( )
	isChecked
◊◊) 2
;
◊◊2 3
}
ÿÿ 
}
ŸŸ 
catch
⁄⁄ 
(
⁄⁄ 
	Exception
⁄⁄ 
ex
⁄⁄ 
)
⁄⁄  
{
€€ 
await
‹‹ 
_errorHandler
‹‹ #
.
‹‹# $
HandleErrorAsync
‹‹$ 4
(
‹‹4 5
$"
‹‹5 7
$str
‹‹7 S
{
‹‹S T
ex
‹‹T V
.
‹‹V W
Message
‹‹W ^
}
‹‹^ _
"
‹‹_ `
,
‹‹` a 
Enum_ErrorSeverity
›› &
.
››& '
Error
››' ,
,
››, -
ex
››. 0
,
››0 1
true
››2 6
)
››6 7
;
››7 8
IsEditModeDefault
ﬂﬂ !
=
ﬂﬂ" #
!
ﬂﬂ$ %
	isChecked
ﬂﬂ% .
;
ﬂﬂ. /
}
‡‡ 
}
·· 	
}
‚‚ 
}„„ ÷–
lC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_ManualEntryViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
	Receiving/ 8
{ 
public 

partial 
class *
Receiving_ManualEntryViewModel 7
:8 9 
Shared_BaseViewModel: N
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
private 
readonly $
IService_MySQL_Receiving 1
_mysqlService2 ?
;? @
private 
readonly 
IService_Window (
_windowService) 7
;7 8
[ 	
ObservableProperty	 
] 
private  
ObservableCollection $
<$ %
Model_ReceivingLoad% 8
>8 9
_loads: @
;@ A
[ 	
ObservableProperty	 
] 
private 
Model_ReceivingLoad #
?# $
_selectedLoad% 2
;2 3
public  
ObservableCollection #
<# $
Enum_PackageType$ 4
>4 5
PackageTypes6 B
{C D
getE H
;H I
}J K
=L M
newN Q
(Q R
EnumR V
.V W
	GetValuesW `
<` a
Enum_PackageTypea q
>q r
(r s
)s t
)t u
;u v
public *
Receiving_ManualEntryViewModel -
(- .&
IService_ReceivingWorkflow &
workflowService' 6
,6 7$
IService_MySQL_Receiving $
mysqlService% 1
,1 2!
IService_ErrorHandler   !
errorHandler  " .
,  . /#
IService_LoggingUtility!! #
logger!!$ *
,!!* +
IService_Window"" 
windowService"" )
)"") *
:## 
base## 
(## 
errorHandler## 
,##  
logger##! '
)##' (
{$$ 	
_windowService%% 
=%% 
windowService%% *
;%%* +
_workflowService&& 
=&& 
workflowService&& .
;&&. /
_mysqlService'' 
='' 
mysqlService'' (
;''( )
_loads(( 
=(( 
new((  
ObservableCollection(( -
<((- .
Model_ReceivingLoad((. A
>((A B
(((B C
_workflowService((C S
.((S T
CurrentSession((T b
.((b c
Loads((c h
)((h i
;((i j
})) 	
[++ 	
RelayCommand++	 
]++ 
private,, 
async,, 
Task,, 
AutoFillAsync,, (
(,,( )
),,) *
{-- 	
try.. 
{// 
IsBusy00 
=00 
true00 
;00 
StatusMessage11 
=11 
$str11  9
;119 :
_logger22 
.22 
LogInfo22 
(22  
$str22  K
)22K L
;22L M
int44 
filledCount44 
=44  !
$num44" #
;44# $
for77 
(77 
int77 
i77 
=77 
$num77 
;77 
i77  !
<77" #
Loads77$ )
.77) *
Count77* /
;77/ 0
i771 2
++772 4
)774 5
{88 
var99 
currentLoad99 #
=99$ %
Loads99& +
[99+ ,
i99, -
]99- .
;99. /
if== 
(== 
string== 
.== 
IsNullOrWhiteSpace== 1
(==1 2
currentLoad==2 =
.=== >
PartID==> D
)==D E
)==E F
{>> 
if?? 
(?? 
i?? 
>?? 
$num??  !
)??! "
{@@ 
varAA 
prevAA  $
=AA% &
LoadsAA' ,
[AA, -
iAA- .
-AA/ 0
$numAA1 2
]AA2 3
;AA3 4
ifBB 
(BB  
!BB  !
stringBB! '
.BB' (
IsNullOrWhiteSpaceBB( :
(BB: ;
prevBB; ?
.BB? @
PartIDBB@ F
)BBF G
)BBG H
{CC 
currentLoadDD  +
.DD+ ,
PartIDDD, 2
=DD3 4
prevDD5 9
.DD9 :
PartIDDD: @
;DD@ A
filledCountEE  +
++EE+ -
;EE- .
}FF 
}GG 
}HH 
ifKK 
(KK 
!KK 
stringKK 
.KK  
IsNullOrWhiteSpaceKK  2
(KK2 3
currentLoadKK3 >
.KK> ?
PartIDKK? E
)KKE F
)KKF G
{LL 
Model_ReceivingLoadNN +
?NN+ ,

sourceLoadNN- 7
=NN8 9
nullNN: >
;NN> ?
forOO 
(OO 
intOO  
jOO! "
=OO# $
iOO% &
-OO' (
$numOO) *
;OO* +
jOO, -
>=OO. 0
$numOO1 2
;OO2 3
jOO4 5
--OO5 7
)OO7 8
{PP 
ifQQ 
(QQ  
LoadsQQ  %
[QQ% &
jQQ& '
]QQ' (
.QQ( )
PartIDQQ) /
==QQ0 2
currentLoadQQ3 >
.QQ> ?
PartIDQQ? E
)QQE F
{RR 

sourceLoadSS  *
=SS+ ,
LoadsSS- 2
[SS2 3
jSS3 4
]SS4 5
;SS5 6
breakTT  %
;TT% &
}UU 
}VV 
ifXX 
(XX 

sourceLoadXX &
!=XX' )
nullXX* .
)XX. /
{YY 
if[[ 
([[  
string[[  &
.[[& '
IsNullOrWhiteSpace[[' 9
([[9 :
currentLoad[[: E
.[[E F
PoNumber[[F N
)[[N O
&&[[P R
![[S T
string[[T Z
.[[Z [
IsNullOrWhiteSpace[[[ m
([[m n

sourceLoad[[n x
.[[x y
PoNumber	[[y Å
)
[[Å Ç
)
[[Ç É
{\\ 
currentLoad]]  +
.]]+ ,
PoNumber]], 4
=]]5 6

sourceLoad]]7 A
.]]A B
PoNumber]]B J
;]]J K
filledCount^^  +
++^^+ -
;^^- .
}__ 
ifbb 
(bb  
currentLoadbb  +
.bb+ ,
WeightQuantitybb, :
<=bb; =
$numbb> ?
&&bb@ B

sourceLoadbbC M
.bbM N
WeightQuantitybbN \
>bb] ^
$numbb_ `
)bb` a
{cc 
currentLoaddd  +
.dd+ ,
WeightQuantitydd, :
=dd; <

sourceLoaddd= G
.ddG H
WeightQuantityddH V
;ddV W
filledCountee  +
++ee+ -
;ee- .
}ff 
ifii 
(ii  
stringii  &
.ii& '
IsNullOrWhiteSpaceii' 9
(ii9 :
currentLoadii: E
.iiE F
HeatLotNumberiiF S
)iiS T
&&iiU W
!iiX Y
stringiiY _
.ii_ `
IsNullOrWhiteSpaceii` r
(iir s

sourceLoadiis }
.ii} ~
HeatLotNumber	ii~ ã
)
iiã å
)
iiå ç
{jj 
currentLoadkk  +
.kk+ ,
HeatLotNumberkk, 9
=kk: ;

sourceLoadkk< F
.kkF G
HeatLotNumberkkG T
;kkT U
filledCountll  +
++ll+ -
;ll- .
}mm 
ifpp 
(pp  
currentLoadpp  +
.pp+ ,
PackagesPerLoadpp, ;
<=pp< >
$numpp? @
&&ppA C

sourceLoadppD N
.ppN O
PackagesPerLoadppO ^
>pp_ `
$numppa b
)ppb c
{qq 
currentLoadrr  +
.rr+ ,
PackagesPerLoadrr, ;
=rr< =

sourceLoadrr> H
.rrH I
PackagesPerLoadrrI X
;rrX Y
}ss 
ifuu 
(uu  
stringuu  &
.uu& '
IsNullOrWhiteSpaceuu' 9
(uu9 :
currentLoaduu: E
.uuE F
PackageTypeNameuuF U
)uuU V
&&uuW Y
!uuZ [
stringuu[ a
.uua b
IsNullOrWhiteSpaceuub t
(uut u

sourceLoaduuu 
.	uu Ä
PackageTypeName
uuÄ è
)
uuè ê
)
uuê ë
{vv 
currentLoadww  +
.ww+ ,
PackageTypeNameww, ;
=ww< =

sourceLoadww> H
.wwH I
PackageTypeNamewwI X
;wwX Y
}xx 
}yy 
}zz 
if~~ 
(~~ 
currentLoad~~ #
.~~# $
ReceivedDate~~$ 0
==~~1 3
default~~4 ;
||~~< >
currentLoad~~? J
.~~J K
ReceivedDate~~K W
==~~X Z
DateTime~~[ c
.~~c d
MinValue~~d l
)~~l m
{ 
currentLoad
ÄÄ #
.
ÄÄ# $
ReceivedDate
ÄÄ$ 0
=
ÄÄ1 2
DateTime
ÄÄ3 ;
.
ÄÄ; <
Now
ÄÄ< ?
;
ÄÄ? @
}
ÅÅ 
if
ÜÜ 
(
ÜÜ 
string
ÜÜ 
.
ÜÜ  
IsNullOrWhiteSpace
ÜÜ 1
(
ÜÜ1 2
currentLoad
ÜÜ2 =
.
ÜÜ= >
UserId
ÜÜ> D
)
ÜÜD E
)
ÜÜE F
{
áá 
if
ââ 
(
ââ 
i
ââ 
>
ââ 
$num
ââ  !
&&
ââ" $
!
ââ% &
string
ââ& ,
.
ââ, - 
IsNullOrWhiteSpace
ââ- ?
(
ââ? @
Loads
ââ@ E
[
ââE F
i
ââF G
-
ââH I
$num
ââJ K
]
ââK L
.
ââL M
UserId
ââM S
)
ââS T
)
ââT U
{
ää 
currentLoad
ãã '
.
ãã' (
UserId
ãã( .
=
ãã/ 0
Loads
ãã1 6
[
ãã6 7
i
ãã7 8
-
ãã9 :
$num
ãã; <
]
ãã< =
.
ãã= >
UserId
ãã> D
;
ããD E
}
åå 
else
çç 
if
çç 
(
çç  !
Loads
çç! &
.
çç& '
Count
çç' ,
>
çç- .
$num
çç/ 0
&&
çç1 3
!
çç4 5
string
çç5 ;
.
çç; < 
IsNullOrWhiteSpace
çç< N
(
ççN O
Loads
ççO T
[
ççT U
$num
ççU V
]
ççV W
.
ççW X
UserId
ççX ^
)
çç^ _
)
çç_ `
{
éé 
currentLoad
èè '
.
èè' (
UserId
èè( .
=
èè/ 0
Loads
èè1 6
[
èè6 7
$num
èè7 8
]
èè8 9
.
èè9 :
UserId
èè: @
;
èè@ A
}
êê 
else
íí 
if
íí 
(
íí  !
_workflowService
íí! 1
.
íí1 2
CurrentSession
íí2 @
.
íí@ A
User
ííA E
!=
ííF H
null
ííI M
)
ííM N
{
ìì 
currentLoad
îî '
.
îî' (
UserId
îî( .
=
îî/ 0
_workflowService
îî1 A
.
îîA B
CurrentSession
îîB P
.
îîP Q
User
îîQ U
.
îîU V
WindowsUsername
îîV e
;
îîe f
}
ïï 
}
ññ 
}
óó 
StatusMessage
ôô 
=
ôô 
$"
ôô  "
$str
ôô" >
{
ôô> ?
filledCount
ôô? J
}
ôôJ K
$str
ôôK S
"
ôôS T
;
ôôT U
_logger
öö 
.
öö 
LogInfo
öö 
(
öö  
$"
öö  "
$str
öö" L
{
ööL M
filledCount
ööM X
}
ööX Y
$str
ööY h
{
ööh i
Loads
ööi n
.
öön o
Count
ööo t
}
ööt u
$str
ööu {
"
öö{ |
)
öö| }
;
öö} ~
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
†† 
_logger
°° 
.
°° 
LogError
°°  
(
°°  !
$"
°°! #
$str
°°# 5
{
°°5 6
ex
°°6 8
.
°°8 9
Message
°°9 @
}
°°@ A
"
°°A B
)
°°B C
;
°°C D
await
¢¢ 
_errorHandler
¢¢ #
.
¢¢# $
HandleErrorAsync
¢¢$ 4
(
¢¢4 5
$str
¢¢5 G
,
¢¢G H 
Enum_ErrorSeverity
¢¢I [
.
¢¢[ \
Error
¢¢\ a
,
¢¢a b
ex
¢¢c e
)
¢¢e f
;
¢¢f g
}
££ 
finally
§§ 
{
•• 
IsBusy
¶¶ 
=
¶¶ 
false
¶¶ 
;
¶¶ 
}
ßß 
}
®® 	
[
™™ 	
RelayCommand
™™	 
]
™™ 
private
´´ 
void
´´ 
AddRow
´´ 
(
´´ 
)
´´ 
{
¨¨ 	

AddNewLoad
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
}
ÆÆ 	
[
∞∞ 	
RelayCommand
∞∞	 
]
∞∞ 
private
±± 
async
±± 
Task
±± "
AddMultipleRowsAsync
±± /
(
±±/ 0
)
±±0 1
{
≤≤ 	
var
¥¥ 
xamlRoot
¥¥ 
=
¥¥ 
_windowService
¥¥ )
.
¥¥) *
GetXamlRoot
¥¥* 5
(
¥¥5 6
)
¥¥6 7
;
¥¥7 8
if
µµ 
(
µµ 
xamlRoot
µµ 
==
µµ 
null
µµ  
)
µµ  !
return
µµ" (
;
µµ( )
var
∑∑ 
inputTextBox
∑∑ 
=
∑∑ 
new
∑∑ "
	Microsoft
∑∑# ,
.
∑∑, -
UI
∑∑- /
.
∑∑/ 0
Xaml
∑∑0 4
.
∑∑4 5
Controls
∑∑5 =
.
∑∑= >
TextBox
∑∑> E
{
∏∏ 
PlaceholderText
ππ 
=
ππ  !
$str
ππ" ?
,
ππ? @

InputScope
∫∫ 
=
∫∫ 
new
∫∫  
	Microsoft
∫∫! *
.
∫∫* +
UI
∫∫+ -
.
∫∫- .
Xaml
∫∫. 2
.
∫∫2 3
Input
∫∫3 8
.
∫∫8 9

InputScope
∫∫9 C
{
ªª 
Names
ºº 
=
ºº 
{
ºº 
new
ºº !
	Microsoft
ºº" +
.
ºº+ ,
UI
ºº, .
.
ºº. /
Xaml
ºº/ 3
.
ºº3 4
Input
ºº4 9
.
ºº9 :
InputScopeName
ºº: H
(
ººH I
	Microsoft
ººI R
.
ººR S
UI
ººS U
.
ººU V
Xaml
ººV Z
.
ººZ [
Input
ºº[ `
.
ºº` a!
InputScopeNameValue
ººa t
.
ººt u
Number
ººu {
)
ºº{ |
}
ºº} ~
}
ΩΩ 
}
ææ 
;
ææ 
var
¿¿ 
dialog
¿¿ 
=
¿¿ 
new
¿¿ 
	Microsoft
¿¿ &
.
¿¿& '
UI
¿¿' )
.
¿¿) *
Xaml
¿¿* .
.
¿¿. /
Controls
¿¿/ 7
.
¿¿7 8
ContentDialog
¿¿8 E
{
¡¡ 
Title
¬¬ 
=
¬¬ 
$str
¬¬ +
,
¬¬+ ,
Content
√√ 
=
√√ 
inputTextBox
√√ &
,
√√& '
PrimaryButtonText
ƒƒ !
=
ƒƒ" #
$str
ƒƒ$ )
,
ƒƒ) *
CloseButtonText
≈≈ 
=
≈≈  !
$str
≈≈" *
,
≈≈* +
DefaultButton
∆∆ 
=
∆∆ 
	Microsoft
∆∆  )
.
∆∆) *
UI
∆∆* ,
.
∆∆, -
Xaml
∆∆- 1
.
∆∆1 2
Controls
∆∆2 :
.
∆∆: ;!
ContentDialogButton
∆∆; N
.
∆∆N O
Primary
∆∆O V
,
∆∆V W
XamlRoot
«« 
=
«« 
xamlRoot
«« #
}
»» 
;
»» 
var
   
result
   
=
   
await
   
dialog
   %
.
  % &
	ShowAsync
  & /
(
  / 0
)
  0 1
;
  1 2
if
ÀÀ 
(
ÀÀ 
result
ÀÀ 
==
ÀÀ 
	Microsoft
ÀÀ #
.
ÀÀ# $
UI
ÀÀ$ &
.
ÀÀ& '
Xaml
ÀÀ' +
.
ÀÀ+ ,
Controls
ÀÀ, 4
.
ÀÀ4 5!
ContentDialogResult
ÀÀ5 H
.
ÀÀH I
Primary
ÀÀI P
)
ÀÀP Q
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
int
ÕÕ 
.
ÕÕ 
TryParse
ÕÕ  
(
ÕÕ  !
inputTextBox
ÕÕ! -
.
ÕÕ- .
Text
ÕÕ. 2
,
ÕÕ2 3
out
ÕÕ4 7
int
ÕÕ8 ;
count
ÕÕ< A
)
ÕÕA B
&&
ÕÕC E
count
ÕÕF K
>
ÕÕL M
$num
ÕÕN O
&&
ÕÕP R
count
ÕÕS X
<=
ÕÕY [
$num
ÕÕ\ ^
)
ÕÕ^ _
{
ŒŒ 
_logger
œœ 
.
œœ 
LogInfo
œœ #
(
œœ# $
$"
œœ$ &
$str
œœ& -
{
œœ- .
count
œœ. 3
}
œœ3 4
$str
œœ4 R
"
œœR S
)
œœS T
;
œœT U
for
–– 
(
–– 
int
–– 
i
–– 
=
––  
$num
––! "
;
––" #
i
––$ %
<
––& '
count
––( -
;
––- .
i
––/ 0
++
––0 2
)
––2 3
{
—— 

AddNewLoad
““ "
(
““" #
)
““# $
;
““$ %
}
”” 
}
‘‘ 
else
’’ 
{
÷÷ 
_logger
◊◊ 
.
◊◊ 

LogWarning
◊◊ &
(
◊◊& '
$"
◊◊' )
$str
◊◊) D
{
◊◊D E
inputTextBox
◊◊E Q
.
◊◊Q R
Text
◊◊R V
}
◊◊V W
"
◊◊W X
)
◊◊X Y
;
◊◊Y Z
await
ÿÿ 
_errorHandler
ÿÿ '
.
ÿÿ' (
HandleErrorAsync
ÿÿ( 8
(
ÿÿ8 9
$str
ÿÿ9 h
,
ÿÿh i 
Enum_ErrorSeverity
ÿÿj |
.
ÿÿ| }
Warningÿÿ} Ñ
)ÿÿÑ Ö
;ÿÿÖ Ü
}
ŸŸ 
}
⁄⁄ 
}
€€ 	
public
›› 
void
›› 

AddNewLoad
›› 
(
›› 
)
››  
{
ﬁﬁ 	
var
ﬂﬂ 
newLoad
ﬂﬂ 
=
ﬂﬂ 
new
ﬂﬂ !
Model_ReceivingLoad
ﬂﬂ 1
{
‡‡ 
LoadID
·· 
=
·· 
System
·· 
.
··  
Guid
··  $
.
··$ %
NewGuid
··% ,
(
··, -
)
··- .
,
··. /
ReceivedDate
‚‚ 
=
‚‚ 
System
‚‚ %
.
‚‚% &
DateTime
‚‚& .
.
‚‚. /
Now
‚‚/ 2
,
‚‚2 3

LoadNumber
„„ 
=
„„ 
Loads
„„ "
.
„„" #
Count
„„# (
+
„„) *
$num
„„+ ,
}
‰‰ 
;
‰‰ 
Loads
ÂÂ 
.
ÂÂ 
Add
ÂÂ 
(
ÂÂ 
newLoad
ÂÂ 
)
ÂÂ 
;
ÂÂ 
_workflowService
ÊÊ 
.
ÊÊ 
CurrentSession
ÊÊ +
.
ÊÊ+ ,
Loads
ÊÊ, 1
.
ÊÊ1 2
Add
ÊÊ2 5
(
ÊÊ5 6
newLoad
ÊÊ6 =
)
ÊÊ= >
;
ÊÊ> ?
SelectedLoad
ÈÈ 
=
ÈÈ 
newLoad
ÈÈ "
;
ÈÈ" #
}
ÍÍ 	
[
ÏÏ 	
RelayCommand
ÏÏ	 
]
ÏÏ 
private
ÌÌ 
void
ÌÌ 
	RemoveRow
ÌÌ 
(
ÌÌ 
)
ÌÌ  
{
ÓÓ 	
if
ÔÔ 
(
ÔÔ 
SelectedLoad
ÔÔ 
!=
ÔÔ 
null
ÔÔ  $
)
ÔÔ$ %
{
 
_logger
ÒÒ 
.
ÒÒ 
LogInfo
ÒÒ 
(
ÒÒ  
$"
ÒÒ  "
$str
ÒÒ" 0
{
ÒÒ0 1
SelectedLoad
ÒÒ1 =
.
ÒÒ= >

LoadNumber
ÒÒ> H
}
ÒÒH I
$str
ÒÒI T
{
ÒÒT U
SelectedLoad
ÒÒU a
.
ÒÒa b
PartID
ÒÒb h
}
ÒÒh i
$str
ÒÒi j
"
ÒÒj k
)
ÒÒk l
;
ÒÒl m
_workflowService
ÚÚ  
.
ÚÚ  !
CurrentSession
ÚÚ! /
.
ÚÚ/ 0
Loads
ÚÚ0 5
.
ÚÚ5 6
Remove
ÚÚ6 <
(
ÚÚ< =
SelectedLoad
ÚÚ= I
)
ÚÚI J
;
ÚÚJ K
Loads
ÛÛ 
.
ÛÛ 
Remove
ÛÛ 
(
ÛÛ 
SelectedLoad
ÛÛ )
)
ÛÛ) *
;
ÛÛ* +
}
ÙÙ 
else
ıı 
{
ˆˆ 
_logger
˜˜ 
.
˜˜ 

LogWarning
˜˜ "
(
˜˜" #
$str
˜˜# K
)
˜˜K L
;
˜˜L M
}
¯¯ 
}
˘˘ 	
[
˚˚ 	
RelayCommand
˚˚	 
]
˚˚ 
private
¸¸ 
async
¸¸ 
Task
¸¸ 
	SaveAsync
¸¸ $
(
¸¸$ %
)
¸¸% &
{
˝˝ 	
try
˛˛ 
{
ˇˇ 
_logger
ÄÄ 
.
ÄÄ 
LogInfo
ÄÄ 
(
ÄÄ  
$"
ÄÄ  "
$str
ÄÄ" )
{
ÄÄ) *
Loads
ÄÄ* /
.
ÄÄ/ 0
Count
ÄÄ0 5
}
ÄÄ5 6
$str
ÄÄ6 N
"
ÄÄN O
)
ÄÄO P
;
ÄÄP Q
foreach
ÉÉ 
(
ÉÉ 
var
ÉÉ 
load
ÉÉ !
in
ÉÉ" $
Loads
ÉÉ% *
)
ÉÉ* +
{
ÑÑ 
if
ÖÖ 
(
ÖÖ 
string
ÖÖ 
.
ÖÖ  
IsNullOrWhiteSpace
ÖÖ 1
(
ÖÖ1 2
load
ÖÖ2 6
.
ÖÖ6 7
HeatLotNumber
ÖÖ7 D
)
ÖÖD E
)
ÖÖE F
{
ÜÜ 
load
áá 
.
áá 
HeatLotNumber
áá *
=
áá+ ,
$str
áá- >
;
áá> ?
}
àà 
}
ââ 
await
çç 
_workflowService
çç &
.
çç& '$
AdvanceToNextStepAsync
çç' =
(
çç= >
)
çç> ?
;
çç? @
}
éé 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
êê 
_logger
ëë 
.
ëë 
LogError
ëë  
(
ëë  !
$"
ëë! #
$str
ëë# E
{
ëëE F
ex
ëëF H
.
ëëH I
Message
ëëI P
}
ëëP Q
"
ëëQ R
)
ëëR S
;
ëëS T
await
íí 
_errorHandler
íí #
.
íí# $
HandleErrorAsync
íí$ 4
(
íí4 5
$str
íí5 T
,
ííT U 
Enum_ErrorSeverity
ííV h
.
ííh i
Critical
ííi q
,
ííq r
ex
íís u
)
ííu v
;
íív w
}
ìì 
}
îî 	
[
ññ 	
RelayCommand
ññ	 
]
ññ 
private
óó 
async
óó 
Task
óó (
ReturnToModeSelectionAsync
óó 5
(
óó5 6
)
óó6 7
{
òò 	
var
ôô 
xamlRoot
ôô 
=
ôô 
_windowService
ôô )
.
ôô) *
GetXamlRoot
ôô* 5
(
ôô5 6
)
ôô6 7
;
ôô7 8
if
öö 
(
öö 
xamlRoot
öö 
==
öö 
null
öö  
)
öö  !
{
õõ 
_logger
úú 
.
úú 
LogError
úú  
(
úú  !
$str
úú! G
)
úúG H
;
úúH I
await
ùù 
_errorHandler
ùù #
.
ùù# $
HandleErrorAsync
ùù$ 4
(
ùù4 5
$str
ùù5 O
,
ùùO P 
Enum_ErrorSeverity
ùùQ c
.
ùùc d
Error
ùùd i
)
ùùi j
;
ùùj k
return
ûû 
;
ûû 
}
üü 
var
°° 
dialog
°° 
=
°° 
new
°° 
	Microsoft
°° &
.
°°& '
UI
°°' )
.
°°) *
Xaml
°°* .
.
°°. /
Controls
°°/ 7
.
°°7 8
ContentDialog
°°8 E
{
¢¢ 
Title
££ 
=
££ 
$str
££ &
,
££& '
Content
§§ 
=
§§ 
$str§§ Ö
,§§Ö Ü
PrimaryButtonText
•• !
=
••" #
$str
••$ 6
,
••6 7
CloseButtonText
¶¶ 
=
¶¶  !
$str
¶¶" *
,
¶¶* +
DefaultButton
ßß 
=
ßß 
	Microsoft
ßß  )
.
ßß) *
UI
ßß* ,
.
ßß, -
Xaml
ßß- 1
.
ßß1 2
Controls
ßß2 :
.
ßß: ;!
ContentDialogButton
ßß; N
.
ßßN O
Close
ßßO T
,
ßßT U
XamlRoot
®® 
=
®® 
xamlRoot
®® #
}
©© 
;
©© 
var
´´ 
result
´´ 
=
´´ 
await
´´ 
dialog
´´ %
.
´´% &
	ShowAsync
´´& /
(
´´/ 0
)
´´0 1
.
´´1 2
AsTask
´´2 8
(
´´8 9
)
´´9 :
;
´´: ;
if
¨¨ 
(
¨¨ 
result
¨¨ 
==
¨¨ 
	Microsoft
¨¨ #
.
¨¨# $
UI
¨¨$ &
.
¨¨& '
Xaml
¨¨' +
.
¨¨+ ,
Controls
¨¨, 4
.
¨¨4 5!
ContentDialogResult
¨¨5 H
.
¨¨H I
Primary
¨¨I P
)
¨¨P Q
{
≠≠ 
try
ÆÆ 
{
ØØ 
_logger
∞∞ 
.
∞∞ 
LogInfo
∞∞ #
(
∞∞# $
$str
∞∞$ a
)
∞∞a b
;
∞∞b c
await
≤≤ 
_workflowService
≤≤ *
.
≤≤* + 
ResetWorkflowAsync
≤≤+ =
(
≤≤= >
)
≤≤> ?
;
≤≤? @
_workflowService
≥≥ $
.
≥≥$ %
GoToStep
≥≥% -
(
≥≥- .
WorkflowStep
≥≥. :
.
≥≥: ;
ModeSelection
≥≥; H
)
≥≥H I
;
≥≥I J
}
µµ 
catch
∂∂ 
(
∂∂ 
	Exception
∂∂  
ex
∂∂! #
)
∂∂# $
{
∑∑ 
_logger
∏∏ 
.
∏∏ 
LogError
∏∏ $
(
∏∏$ %
$"
∏∏% '
$str
∏∏' A
{
∏∏A B
ex
∏∏B D
.
∏∏D E
Message
∏∏E L
}
∏∏L M
"
∏∏M N
)
∏∏N O
;
∏∏O P
await
ππ 
_errorHandler
ππ '
.
ππ' (
HandleErrorAsync
ππ( 8
(
ππ8 9
$str
ππ9 ]
,
ππ] ^ 
Enum_ErrorSeverity
ππ_ q
.
ππq r
Error
ππr w
,
ππw x
ex
ππy {
)
ππ{ |
;
ππ| }
}
∫∫ 
}
ªª 
else
ºº 
{
ΩΩ 
_logger
ææ 
.
ææ 
LogInfo
ææ 
(
ææ  
$str
ææ  I
)
ææI J
;
ææJ K
}
øø 
}
¿¿ 	
}
¡¡ 
}¬¬ ˝!
jC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_LoadEntryViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
	Receiving/ 8
{		 
public

 

partial

 
class

 (
Receiving_LoadEntryViewModel

 5
:

6 7 
Shared_BaseViewModel

8 L
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
private 
readonly (
IService_ReceivingValidation 5
_validationService6 H
;H I
[ 	
ObservableProperty	 
] 
private 
int 
_numberOfLoads "
=# $
$num% &
;& '
[ 	
ObservableProperty	 
] 
private 
string 
_selectedPartInfo (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public (
Receiving_LoadEntryViewModel +
(+ ,&
IService_ReceivingWorkflow &
workflowService' 6
,6 7(
IService_ReceivingValidation (
validationService) :
,: ;!
IService_ErrorHandler !
errorHandler" .
,. /#
IService_LoggingUtility #
logger$ *
)* +
: 
base 
( 
errorHandler 
,  
logger! '
)' (
{ 	
_workflowService 
= 
workflowService .
;. /
_validationService 
=  
validationService! 2
;2 3
_workflowService 
. 
StepChanged (
+=) +
OnStepChanged, 9
;9 :
}   	
private"" 
void"" 
OnStepChanged"" "
(""" #
object""# )
?"") *
sender""+ 1
,""1 2
System""3 9
.""9 :
	EventArgs"": C
e""D E
)""E F
{## 	
if$$ 
($$ 
_workflowService$$  
.$$  !
CurrentStep$$! ,
==$$- /
WorkflowStep$$0 <
.$$< =
	LoadEntry$$= F
)$$F G
{%% 
NumberOfLoads&& 
=&& 
_workflowService&&  0
.&&0 1
NumberOfLoads&&1 >
;&&> ?
}'' 
}(( 	
[** 	
RelayCommand**	 
]** 
private++ 
async++ 
Task++ 
CreateLoadsAsync++ +
(+++ ,
)++, -
{,, 	
var-- 
validationResult--  
=--! "
_validationService--# 5
.--5 6!
ValidateNumberOfLoads--6 K
(--K L
NumberOfLoads--L Y
)--Y Z
;--Z [
if.. 
(.. 
!.. 
validationResult.. !
...! "
IsValid.." )
)..) *
{// 
await00 
_errorHandler00 #
.00# $
HandleErrorAsync00$ 4
(004 5
validationResult005 E
.00E F
Message00F M
,00M N
Enum_ErrorSeverity00O a
.00a b
Warning00b i
)00i j
;00j k
return11 
;11 
}22 
_workflowService55 
.55 
NumberOfLoads55 *
=55+ ,
NumberOfLoads55- :
;55: ;
}66 	
partial88 
void88 "
OnNumberOfLoadsChanged88 +
(88+ ,
int88, /
value880 5
)885 6
{99 	
_workflowService:: 
.:: 
NumberOfLoads:: *
=::+ ,
value::- 2
;::2 3
};; 	
public== 
void== 
UpdatePartInfo== "
(==" #
string==# )
partId==* 0
,==0 1
string==2 8
description==9 D
)==D E
{>> 	
SelectedPartInfo?? 
=?? 
$"?? !
{??! "
partId??" (
}??( )
$str??) ,
{??, -
description??- 8
}??8 9
"??9 :
;??: ;
}@@ 	
}AA 
}BB ﬁT
hC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_HeatLotViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
	Receiving/ 8
{ 
public 

partial 
class &
Receiving_HeatLotViewModel 3
:4 5 
Shared_BaseViewModel6 J
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
private 
readonly (
IService_ReceivingValidation 5
_validationService6 H
;H I
[ 	
ObservableProperty	 
] 
private  
ObservableCollection $
<$ %
Model_ReceivingLoad% 8
>8 9
_loads: @
=A B
newC F
(F G
)G H
;H I
[ 	
ObservableProperty	 
] 
private  
ObservableCollection $
<$ %"
Model_HeatCheckboxItem% ;
>; <
_uniqueHeatNumbers= O
=P Q
newR U
(U V
)V W
;W X
public &
Receiving_HeatLotViewModel )
() *&
IService_ReceivingWorkflow &
workflowService' 6
,6 7(
IService_ReceivingValidation (
validationService) :
,: ;!
IService_ErrorHandler !
errorHandler" .
,. /#
IService_LoggingUtility #
logger$ *
)* +
: 
base 
( 
errorHandler 
,  
logger! '
)' (
{ 	
_workflowService   
=   
workflowService   .
;  . /
_validationService!! 
=!!  
validationService!!! 2
;!!2 3
_workflowService## 
.## 
StepChanged## (
+=##) +
OnStepChanged##, 9
;##9 :
}$$ 	
private&& 
void&& 
OnStepChanged&& "
(&&" #
object&&# )
?&&) *
sender&&+ 1
,&&1 2
System&&3 9
.&&9 :
	EventArgs&&: C
e&&D E
)&&E F
{'' 	
if(( 
((( 
_workflowService((  
.((  !
CurrentStep((! ,
==((- /
WorkflowStep((0 <
.((< =
HeatLotEntry((= I
)((I J
{)) 
_** 
=** 
OnNavigatedToAsync** &
(**& '
)**' (
;**( )
}++ 
},, 	
public.. 
Task.. 
OnNavigatedToAsync.. &
(..& '
)..' (
{// 	
Loads00 
.00 
Clear00 
(00 
)00 
;00 
UniqueHeatNumbers11 
.11 
Clear11 #
(11# $
)11$ %
;11% &
if33 
(33 
_workflowService33  
.33  !
CurrentSession33! /
?33/ 0
.330 1
Loads331 6
!=337 9
null33: >
)33> ?
{44 
foreach55 
(55 
var55 
load55 !
in55" $
_workflowService55% 5
.555 6
CurrentSession556 D
.55D E
Loads55E J
)55J K
{66 
Loads77 
.77 
Add77 
(77 
load77 "
)77" #
;77# $
load88 
.88 
PropertyChanged88 (
-=88) + 
Load_PropertyChanged88, @
;88@ A
load99 
.99 
PropertyChanged99 (
+=99) + 
Load_PropertyChanged99, @
;99@ A
}:: 
};; #
UpdateUniqueHeatNumbers== #
(==# $
)==$ %
;==% &
return>> 
Task>> 
.>> 
CompletedTask>> %
;>>% &
}?? 	
privateAA 
voidAA  
Load_PropertyChangedAA )
(AA) *
objectAA* 0
?AA0 1
senderAA2 8
,AA8 9$
PropertyChangedEventArgsAA: R
eAAS T
)AAT U
{BB 	
ifCC 
(CC 
eCC 
.CC 
PropertyNameCC 
==CC !
nameofCC" (
(CC( )
Model_ReceivingLoadCC) <
.CC< =
HeatLotNumberCC= J
)CCJ K
)CCK L
{DD #
UpdateUniqueHeatNumbersEE '
(EE' (
)EE( )
;EE) *
}FF 
}GG 	
privateII 
voidII #
UpdateUniqueHeatNumbersII ,
(II, -
)II- .
{JJ 	
varKK 
currentHeatsKK 
=KK 
LoadsKK $
.LL 
WhereLL 
(LL 
lLL 
=>LL 
!LL 
stringLL #
.LL# $
IsNullOrWhiteSpaceLL$ 6
(LL6 7
lLL7 8
.LL8 9
HeatLotNumberLL9 F
)LLF G
)LLG H
.MM 
GroupByMM 
(MM 
lMM 
=>MM 
lMM 
.MM  
HeatLotNumberMM  -
)MM- .
.NN 
SelectNN 
(NN 
gNN 
=>NN 
newNN  
{NN! "
HeatNN# '
=NN( )
gNN* +
.NN+ ,
KeyNN, /
,NN/ 0
	FirstLoadNN1 :
=NN; <
gNN= >
.NN> ?
MinNN? B
(NNB C
lNNC D
=>NNE G
lNNH I
.NNI J

LoadNumberNNJ T
)NNT U
}NNV W
)NNW X
.OO 
ToListOO 
(OO 
)OO 
;OO 
forRR 
(RR 
intRR 
iRR 
=RR 
UniqueHeatNumbersRR *
.RR* +
CountRR+ 0
-RR1 2
$numRR3 4
;RR4 5
iRR6 7
>=RR8 :
$numRR; <
;RR< =
iRR> ?
--RR? A
)RRA B
{SS 
varTT 
itemTT 
=TT 
UniqueHeatNumbersTT ,
[TT, -
iTT- .
]TT. /
;TT/ 0
ifUU 
(UU 
!UU 
currentHeatsUU !
.UU! "
AnyUU" %
(UU% &
hUU& '
=>UU( *
hUU+ ,
.UU, -
HeatUU- 1
==UU2 4
itemUU5 9
.UU9 :
HeatLotNumberUU: G
)UUG H
)UUH I
{VV 
itemWW 
.WW 
PropertyChangedWW (
-=WW) +,
 HeatCheckboxItem_PropertyChangedWW, L
;WWL M
UniqueHeatNumbersXX %
.XX% &
RemoveAtXX& .
(XX. /
iXX/ 0
)XX0 1
;XX1 2
}YY 
}ZZ 
foreach]] 
(]] 
var]] 
heat]] 
in]]  
currentHeats]]! -
)]]- .
{^^ 
if__ 
(__ 
!__ 
UniqueHeatNumbers__ &
.__& '
Any__' *
(__* +
i__+ ,
=>__- /
i__0 1
.__1 2
HeatLotNumber__2 ?
==__@ B
heat__C G
.__G H
Heat__H L
)__L M
)__M N
{`` 
varaa 
newItemaa 
=aa  !
newaa" %"
Model_HeatCheckboxItemaa& <
{bb 
HeatLotNumbercc %
=cc& '
heatcc( ,
.cc, -
Heatcc- 1
,cc1 2
FirstLoadNumberdd '
=dd( )
heatdd* .
.dd. /
	FirstLoaddd/ 8
,dd8 9
	IsCheckedee !
=ee" #
falseee$ )
}ff 
;ff 
newItemgg 
.gg 
PropertyChangedgg +
+=gg, .,
 HeatCheckboxItem_PropertyChangedgg/ O
;ggO P
UniqueHeatNumbershh %
.hh% &
Addhh& )
(hh) *
newItemhh* 1
)hh1 2
;hh2 3
}ii 
}jj 
}kk 	
privatemm 
voidmm ,
 HeatCheckboxItem_PropertyChangedmm 5
(mm5 6
objectmm6 <
?mm< =
sendermm> D
,mmD E$
PropertyChangedEventArgsmmF ^
emm_ `
)mm` a
{nn 	
ifoo 
(oo 
eoo 
.oo 
PropertyNameoo 
==oo !
nameofoo" (
(oo( )"
Model_HeatCheckboxItemoo) ?
.oo? @
	IsCheckedoo@ I
)ooI J
)ooJ K
{pp 
ifqq 
(qq 
senderqq 
isqq "
Model_HeatCheckboxItemqq 4
itemqq5 9
&&qq: <
itemqq= A
.qqA B
	IsCheckedqqB K
)qqK L
{rr !
ApplyHeatToEmptyLoadsss )
(ss) *
itemss* .
.ss. /
HeatLotNumberss/ <
)ss< =
;ss= >
}ww 
}xx 
}yy 	
private{{ 
void{{ !
ApplyHeatToEmptyLoads{{ *
({{* +
string{{+ 1

heatNumber{{2 <
){{< =
{|| 	
foreach}} 
(}} 
var}} 
load}} 
in}}  
Loads}}! &
)}}& '
{~~ 
if 
( 
string 
. 
IsNullOrWhiteSpace -
(- .
load. 2
.2 3
HeatLotNumber3 @
)@ A
)A B
{
ÄÄ 
load
ÅÅ 
.
ÅÅ 
HeatLotNumber
ÅÅ &
=
ÅÅ' (

heatNumber
ÅÅ) 3
;
ÅÅ3 4
}
ÇÇ 
}
ÉÉ 
}
ÑÑ 	
[
ÜÜ 	
RelayCommand
ÜÜ	 
]
ÜÜ 
private
áá 
Task
áá &
ValidateAndContinueAsync
áá -
(
áá- .
)
áá. /
{
àà 	"
PrepareHeatLotFields
ää  
(
ää  !
)
ää! "
;
ää" #
return
çç 
Task
çç 
.
çç 
CompletedTask
çç %
;
çç% &
}
éé 	
private
ìì 
void
ìì "
PrepareHeatLotFields
ìì )
(
ìì) *
)
ìì* +
{
îî 	
foreach
ïï 
(
ïï 
var
ïï 
load
ïï 
in
ïï  
Loads
ïï! &
)
ïï& '
{
ññ 
if
óó 
(
óó 
string
óó 
.
óó  
IsNullOrWhiteSpace
óó -
(
óó- .
load
óó. 2
.
óó2 3
HeatLotNumber
óó3 @
)
óó@ A
)
óóA B
{
òò 
load
ôô 
.
ôô 
HeatLotNumber
ôô &
=
ôô' (
$str
ôô) 6
;
ôô6 7
}
öö 
}
õõ 
}
úú 	
}
ùù 
}ûû …Ö
iC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Receiving\Receiving_EditModeViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
	Receiving/ 8
{ 
public 

partial 
class '
Receiving_EditModeViewModel 4
:5 6 
Shared_BaseViewModel7 K
{ 
private 
readonly &
IService_ReceivingWorkflow 3
_workflowService4 D
;D E
private 
readonly $
IService_MySQL_Receiving 1
_mysqlService2 ?
;? @
private 
readonly 
IService_CSVWriter +

_csvWriter, 6
;6 7
private 
readonly 
IService_Pagination ,
_paginationService- ?
;? @
private 
List 
< 
Model_ReceivingLoad (
>( )
	_allLoads* 3
=4 5
new6 9
(9 :
): ;
;; <
private 
List 
< 
Model_ReceivingLoad (
>( )
_filteredLoads* 8
=9 :
new; >
(> ?
)? @
;@ A
[ 	
ObservableProperty	 
] 
private  
ObservableCollection $
<$ %
Model_ReceivingLoad% 8
>8 9
_loads: @
;@ A
[!! 	
ObservableProperty!!	 
]!! 
private"" 
Model_ReceivingLoad"" #
?""# $
_selectedLoad""% 2
;""2 3
[$$ 	
ObservableProperty$$	 
]$$ 
private%% 
Enum_DataSourceType%% #
_currentDataSource%%$ 6
=%%7 8
Enum_DataSourceType%%9 L
.%%L M
Memory%%M S
;%%S T
['' 	
ObservableProperty''	 
]'' 
private(( 
string((  
_selectAllButtonText(( +
=((, -
$str((. :
;((: ;
[** 	
ObservableProperty**	 
]** 
private++ 
DateTimeOffset++ 
_filterStartDate++ /
=++0 1
DateTimeOffset++2 @
.++@ A
Now++A D
.++D E
AddDays++E L
(++L M
-++M N
$num++N O
)++O P
;++P Q
[-- 	
ObservableProperty--	 
]-- 
private.. 
DateTimeOffset.. 
_filterEndDate.. -
=... /
DateTimeOffset..0 >
...> ?
Now..? B
;..B C
[00 	
ObservableProperty00	 
]00 
private11 
string11  
_thisMonthButtonText11 +
=11, -
DateTime11. 6
.116 7
Now117 :
.11: ;
ToString11; C
(11C D
$str11D J
)11J K
;11K L
[33 	
ObservableProperty33	 
]33 
private44 
string44 "
_thisQuarterButtonText44 -
=44. /
GetQuarterText440 >
(44> ?
DateTime44? G
.44G H
Now44H K
)44K L
;44L M
[66 	
ObservableProperty66	 
]66 
private77 
int77 
_currentPage77  
=77! "
$num77# $
;77$ %
[99 	
ObservableProperty99	 
]99 
private:: 
int:: 
_totalPages:: 
=::  !
$num::" #
;::# $
[<< 	
ObservableProperty<<	 
]<< 
private== 
int== 
_gotoPageNumber== #
===$ %
$num==& '
;==' (
private?? 
string?? 
??? 
_currentCsvPath?? '
;??' (
private@@ 
readonly@@ 
List@@ 
<@@ 
Model_ReceivingLoad@@ 1
>@@1 2
_deletedLoads@@3 @
=@@A B
new@@C F
(@@F G
)@@G H
;@@H I
privateAA 
readonlyAA 
IService_WindowAA (
_windowServiceAA) 7
;AA7 8
publicCC  
ObservableCollectionCC #
<CC# $
Enum_PackageTypeCC$ 4
>CC4 5
PackageTypesCC6 B
{CCC D
getCCE H
;CCH I
}CCJ K
=CCL M
newCCN Q
(CCQ R
EnumCCR V
.CCV W
	GetValuesCCW `
<CC` a
Enum_PackageTypeCCa q
>CCq r
(CCr s
)CCs t
)CCt u
;CCu v
publicHH '
Receiving_EditModeViewModelHH *
(HH* +&
IService_ReceivingWorkflowII &
workflowServiceII' 6
,II6 7$
IService_MySQL_ReceivingJJ $
mysqlServiceJJ% 1
,JJ1 2
IService_CSVWriterKK 
	csvWriterKK (
,KK( )
IService_PaginationLL 
paginationServiceLL  1
,LL1 2!
IService_ErrorHandlerMM !
errorHandlerMM" .
,MM. /#
IService_LoggingUtilityNN #
loggerNN$ *
,NN* +
IService_WindowOO 
windowServiceOO )
)OO) *
:PP 
basePP 
(PP 
errorHandlerPP 
,PP  
loggerPP! '
)PP' (
{QQ 	
_windowServiceRR 
=RR 
windowServiceRR *
;RR* +
_workflowServiceSS 
=SS 
workflowServiceSS .
;SS. /
_mysqlServiceTT 
=TT 
mysqlServiceTT (
;TT( )

_csvWriterUU 
=UU 
	csvWriterUU "
;UU" #
_paginationServiceVV 
=VV  
paginationServiceVV! 2
;VV2 3
_loadsXX 
=XX 
newXX  
ObservableCollectionXX -
<XX- .
Model_ReceivingLoadXX. A
>XXA B
(XXB C
)XXC D
;XXD E
_loadsYY 
.YY 
CollectionChangedYY $
+=YY% '#
Loads_CollectionChangedYY( ?
;YY? @
_paginationService[[ 
.[[ 
PageChanged[[ *
+=[[+ -
OnPageChanged[[. ;
;[[; <
_paginationService\\ 
.\\ 
PageSize\\ '
=\\( )
$num\\* ,
;\\, -
_logger^^ 
.^^ 
LogInfo^^ 
(^^ 
$str^^ 3
)^^3 4
;^^4 5
}__ 	
privatedd 
staticdd 
stringdd 
GetQuarterTextdd ,
(dd, -
DateTimedd- 5
datedd6 :
)dd: ;
{ee 	
intff 
quarterff 
=ff 
(ff 
dateff 
.ff  
Monthff  %
-ff& '
$numff( )
)ff) *
/ff+ ,
$numff- .
+ff/ 0
$numff1 2
;ff2 3
returngg 
quartergg 
switchgg !
{hh 
$numii 
=>ii 
$strii 
,ii 
$numjj 
=>jj 
$strjj 
,jj 
$numkk 
=>kk 
$strkk 
,kk 
$numll 
=>ll 
$strll 
,ll 
_mm 
=>mm 
$strmm 
}nn 
;nn 
}oo 	
privatett 
voidtt 
OnPageChangedtt "
(tt" #
objecttt# )
?tt) *
sendertt+ 1
,tt1 2
	EventArgstt3 <
ett= >
)tt> ?
{uu 	
UpdatePagedDisplayvv 
(vv 
)vv  
;vv  !
}ww 	
private|| 
void|| 
UpdatePagedDisplay|| '
(||' (
)||( )
{}} 	
var~~ 
	pageItems~~ 
=~~ 
_paginationService~~ .
.~~. /
GetCurrentPageItems~~/ B
<~~B C
Model_ReceivingLoad~~C V
>~~V W
(~~W X
)~~X Y
;~~Y Z
Loads
ÄÄ 
.
ÄÄ 
Clear
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
foreach
ÅÅ 
(
ÅÅ 
var
ÅÅ 
item
ÅÅ 
in
ÅÅ  
	pageItems
ÅÅ! *
)
ÅÅ* +
{
ÇÇ 
Loads
ÉÉ 
.
ÉÉ 
Add
ÉÉ 
(
ÉÉ 
item
ÉÉ 
)
ÉÉ 
;
ÉÉ  
}
ÑÑ 
CurrentPage
ÜÜ 
=
ÜÜ  
_paginationService
ÜÜ ,
.
ÜÜ, -
CurrentPage
ÜÜ- 8
;
ÜÜ8 9

TotalPages
áá 
=
áá  
_paginationService
áá +
.
áá+ ,

TotalPages
áá, 6
;
áá6 7
GotoPageNumber
àà 
=
àà 
CurrentPage
àà (
;
àà( )&
NotifyPaginationCommands
ää $
(
ää$ %
)
ää% &
;
ää& '
NotifyCommands
ãã 
(
ãã 
)
ãã 
;
ãã 
}
åå 	
private
ëë 
void
ëë &
NotifyPaginationCommands
ëë -
(
ëë- .
)
ëë. /
{
íí 	
NextPageCommand
ìì 
.
ìì %
NotifyCanExecuteChanged
ìì 3
(
ìì3 4
)
ìì4 5
;
ìì5 6!
PreviousPageCommand
îî 
.
îî  %
NotifyCanExecuteChanged
îî  7
(
îî7 8
)
îî8 9
;
îî9 :
FirstPageCommand
ïï 
.
ïï %
NotifyCanExecuteChanged
ïï 4
(
ïï4 5
)
ïï5 6
;
ïï6 7
LastPageCommand
ññ 
.
ññ %
NotifyCanExecuteChanged
ññ 3
(
ññ3 4
)
ññ4 5
;
ññ5 6
GoToPageCommand
óó 
.
óó %
NotifyCanExecuteChanged
óó 3
(
óó3 4
)
óó4 5
;
óó5 6
}
òò 	
private
ùù 
void
ùù %
Loads_CollectionChanged
ùù ,
(
ùù, -
object
ùù- 3
?
ùù3 4
sender
ùù5 ;
,
ùù; <
System
ùù= C
.
ùùC D
Collections
ùùD O
.
ùùO P
Specialized
ùùP [
.
ùù[ \.
 NotifyCollectionChangedEventArgs
ùù\ |
e
ùù} ~
)
ùù~ 
{
ûû 	
if
üü 
(
üü 
e
üü 
.
üü 
NewItems
üü 
!=
üü 
null
üü "
)
üü" #
{
†† 
foreach
°° 
(
°° !
Model_ReceivingLoad
°° ,
item
°°- 1
in
°°2 4
e
°°5 6
.
°°6 7
NewItems
°°7 ?
)
°°? @
{
¢¢ 
item
££ 
.
££ 
PropertyChanged
££ (
+=
££) +"
Load_PropertyChanged
££, @
;
££@ A
}
§§ 
}
•• 
if
¶¶ 
(
¶¶ 
e
¶¶ 
.
¶¶ 
OldItems
¶¶ 
!=
¶¶ 
null
¶¶ "
)
¶¶" #
{
ßß 
foreach
®® 
(
®® !
Model_ReceivingLoad
®® ,
item
®®- 1
in
®®2 4
e
®®5 6
.
®®6 7
OldItems
®®7 ?
)
®®? @
{
©© 
item
™™ 
.
™™ 
PropertyChanged
™™ (
-=
™™) +"
Load_PropertyChanged
™™, @
;
™™@ A
}
´´ 
}
¨¨ 
NotifyCommands
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
ØØ 	
private
¥¥ 
void
¥¥ "
Load_PropertyChanged
¥¥ )
(
¥¥) *
object
¥¥* 0
?
¥¥0 1
sender
¥¥2 8
,
¥¥8 9
System
¥¥: @
.
¥¥@ A
ComponentModel
¥¥A O
.
¥¥O P&
PropertyChangedEventArgs
¥¥P h
e
¥¥i j
)
¥¥j k
{
µµ 	
if
∂∂ 
(
∂∂ 
e
∂∂ 
.
∂∂ 
PropertyName
∂∂ 
==
∂∂ !
nameof
∂∂" (
(
∂∂( )!
Model_ReceivingLoad
∂∂) <
.
∂∂< =

IsSelected
∂∂= G
)
∂∂G H
)
∂∂H I
{
∑∑ 
RemoveRowCommand
∏∏  
.
∏∏  !%
NotifyCanExecuteChanged
∏∏! 8
(
∏∏8 9
)
∏∏9 :
;
∏∏: ;
}
ππ 
}
∫∫ 	
private
øø 
void
øø 
NotifyCommands
øø #
(
øø# $
)
øø$ %
{
¿¿ 	
SaveCommand
¡¡ 
.
¡¡ %
NotifyCanExecuteChanged
¡¡ /
(
¡¡/ 0
)
¡¡0 1
;
¡¡1 2
RemoveRowCommand
¬¬ 
.
¬¬ %
NotifyCanExecuteChanged
¬¬ 4
(
¬¬4 5
)
¬¬5 6
;
¬¬6 7
SelectAllCommand
√√ 
.
√√ %
NotifyCanExecuteChanged
√√ 4
(
√√4 5
)
√√5 6
;
√√6 7
}
ƒƒ 	
partial
…… 
void
…… &
OnFilterStartDateChanged
…… -
(
……- .
DateTimeOffset
……. <
value
……= B
)
……B C
=>
……D F
ApplyDateFilter
……G V
(
……V W
)
……W X
;
……X Y
partial
ŒŒ 
void
ŒŒ $
OnFilterEndDateChanged
ŒŒ +
(
ŒŒ+ ,
DateTimeOffset
ŒŒ, :
value
ŒŒ; @
)
ŒŒ@ A
=>
ŒŒB D
ApplyDateFilter
ŒŒE T
(
ŒŒT U
)
ŒŒU V
;
ŒŒV W
private
”” 
void
”” 
ApplyDateFilter
”” $
(
””$ %
)
””% &
{
‘‘ 	
if
’’ 
(
’’ 
	_allLoads
’’ 
.
’’ 
Count
’’ 
==
’’  "
$num
’’# $
)
’’$ %
return
’’& ,
;
’’, -
FilterAndPaginate
◊◊ 
(
◊◊ 
)
◊◊ 
;
◊◊  
}
ÿÿ 	
private
›› 
void
›› 
FilterAndPaginate
›› &
(
››& '
)
››' (
{
ﬁﬁ 	
var
ﬂﬂ 
start
ﬂﬂ 
=
ﬂﬂ 
FilterStartDate
ﬂﬂ '
.
ﬂﬂ' (
Date
ﬂﬂ( ,
;
ﬂﬂ, -
var
‡‡ 
end
‡‡ 
=
‡‡ 
FilterEndDate
‡‡ #
.
‡‡# $
Date
‡‡$ (
.
‡‡( )
AddDays
‡‡) 0
(
‡‡0 1
$num
‡‡1 2
)
‡‡2 3
.
‡‡3 4
AddTicks
‡‡4 <
(
‡‡< =
-
‡‡= >
$num
‡‡> ?
)
‡‡? @
;
‡‡@ A
if
‚‚ 
(
‚‚ 
CurrentDataSource
‚‚ !
==
‚‚" $!
Enum_DataSourceType
‚‚% 8
.
‚‚8 9
History
‚‚9 @
)
‚‚@ A
{
„„ 
_filteredLoads
‰‰ 
=
‰‰  
	_allLoads
‰‰! *
.
‰‰* +
Where
‰‰+ 0
(
‰‰0 1
l
‰‰1 2
=>
‰‰3 5
l
‰‰6 7
.
‰‰7 8
ReceivedDate
‰‰8 D
>=
‰‰E G
start
‰‰H M
&&
‰‰N P
l
‰‰Q R
.
‰‰R S
ReceivedDate
‰‰S _
<=
‰‰` b
end
‰‰c f
)
‰‰f g
.
‰‰g h
ToList
‰‰h n
(
‰‰n o
)
‰‰o p
;
‰‰p q
}
ÂÂ 
else
ÊÊ 
{
ÁÁ 
_filteredLoads
ËË 
=
ËË  
	_allLoads
ËË! *
.
ËË* +
Where
ËË+ 0
(
ËË0 1
l
ËË1 2
=>
ËË3 5
l
ËË6 7
.
ËË7 8
ReceivedDate
ËË8 D
>=
ËËE G
start
ËËH M
&&
ËËN P
l
ËËQ R
.
ËËR S
ReceivedDate
ËËS _
<=
ËË` b
end
ËËc f
)
ËËf g
.
ËËg h
ToList
ËËh n
(
ËËn o
)
ËËo p
;
ËËp q
}
ÈÈ  
_paginationService
ÎÎ 
.
ÎÎ 
	SetSource
ÎÎ (
(
ÎÎ( )
_filteredLoads
ÎÎ) 7
)
ÎÎ7 8
;
ÎÎ8 9
}
ÏÏ 	
[
ÒÒ 	
RelayCommand
ÒÒ	 
]
ÒÒ 
private
ÚÚ 
async
ÚÚ 
Task
ÚÚ 
SetFilterLastWeek
ÚÚ ,
(
ÚÚ, -
)
ÚÚ- .
{
ÛÛ 	
FilterStartDate
ÙÙ 
=
ÙÙ 
DateTime
ÙÙ &
.
ÙÙ& '
Today
ÙÙ' ,
.
ÙÙ, -
AddDays
ÙÙ- 4
(
ÙÙ4 5
-
ÙÙ5 6
$num
ÙÙ6 7
)
ÙÙ7 8
;
ÙÙ8 9
FilterEndDate
ıı 
=
ıı 
DateTime
ıı $
.
ıı$ %
Today
ıı% *
;
ıı* +
if
ˆˆ 
(
ˆˆ 
CurrentDataSource
ˆˆ !
==
ˆˆ" $!
Enum_DataSourceType
ˆˆ% 8
.
ˆˆ8 9
History
ˆˆ9 @
)
ˆˆ@ A
await
ˆˆB G"
LoadFromHistoryAsync
ˆˆH \
(
ˆˆ\ ]
)
ˆˆ] ^
;
ˆˆ^ _
else
˜˜ 
FilterAndPaginate
˜˜ "
(
˜˜" #
)
˜˜# $
;
˜˜$ %
}
¯¯ 	
[
˝˝ 	
RelayCommand
˝˝	 
]
˝˝ 
private
˛˛ 
async
˛˛ 
Task
˛˛ 
SetFilterToday
˛˛ )
(
˛˛) *
)
˛˛* +
{
ˇˇ 	
FilterStartDate
ÄÄ 
=
ÄÄ 
DateTime
ÄÄ &
.
ÄÄ& '
Today
ÄÄ' ,
;
ÄÄ, -
FilterEndDate
ÅÅ 
=
ÅÅ 
DateTime
ÅÅ $
.
ÅÅ$ %
Today
ÅÅ% *
;
ÅÅ* +
if
ÇÇ 
(
ÇÇ 
CurrentDataSource
ÇÇ !
==
ÇÇ" $!
Enum_DataSourceType
ÇÇ% 8
.
ÇÇ8 9
History
ÇÇ9 @
)
ÇÇ@ A
await
ÇÇB G"
LoadFromHistoryAsync
ÇÇH \
(
ÇÇ\ ]
)
ÇÇ] ^
;
ÇÇ^ _
else
ÉÉ 
FilterAndPaginate
ÉÉ "
(
ÉÉ" #
)
ÉÉ# $
;
ÉÉ$ %
}
ÑÑ 	
[
ââ 	
RelayCommand
ââ	 
]
ââ 
private
ää 
async
ää 
Task
ää 
SetFilterThisWeek
ää ,
(
ää, -
)
ää- .
{
ãã 	
var
åå 
today
åå 
=
åå 
DateTime
åå  
.
åå  !
Today
åå! &
;
åå& '
var
çç 
start
çç 
=
çç 
today
çç 
.
çç 
AddDays
çç %
(
çç% &
-
çç& '
(
çç' (
int
çç( +
)
çç+ ,
today
çç, 1
.
çç1 2
	DayOfWeek
çç2 ;
)
çç; <
;
çç< =
var
éé 
end
éé 
=
éé 
start
éé 
.
éé 
AddDays
éé #
(
éé# $
$num
éé$ %
)
éé% &
;
éé& '
FilterStartDate
èè 
=
èè 
start
èè #
;
èè# $
FilterEndDate
êê 
=
êê 
end
êê 
;
êê  
if
ëë 
(
ëë 
CurrentDataSource
ëë !
==
ëë" $!
Enum_DataSourceType
ëë% 8
.
ëë8 9
History
ëë9 @
)
ëë@ A
await
ëëB G"
LoadFromHistoryAsync
ëëH \
(
ëë\ ]
)
ëë] ^
;
ëë^ _
else
íí 
FilterAndPaginate
íí "
(
íí" #
)
íí# $
;
íí$ %
}
ìì 	
[
òò 	
RelayCommand
òò	 
]
òò 
private
ôô 
async
ôô 
Task
ôô  
SetFilterThisMonth
ôô -
(
ôô- .
)
ôô. /
{
öö 	
var
õõ 
today
õõ 
=
õõ 
DateTime
õõ  
.
õõ  !
Today
õõ! &
;
õõ& '
FilterStartDate
úú 
=
úú 
new
úú !
DateTime
úú" *
(
úú* +
today
úú+ 0
.
úú0 1
Year
úú1 5
,
úú5 6
today
úú7 <
.
úú< =
Month
úú= B
,
úúB C
$num
úúD E
)
úúE F
;
úúF G
FilterEndDate
ùù 
=
ùù 
FilterStartDate
ùù +
.
ùù+ ,
	AddMonths
ùù, 5
(
ùù5 6
$num
ùù6 7
)
ùù7 8
.
ùù8 9
AddDays
ùù9 @
(
ùù@ A
-
ùùA B
$num
ùùB C
)
ùùC D
;
ùùD E
if
ûû 
(
ûû 
CurrentDataSource
ûû !
==
ûû" $!
Enum_DataSourceType
ûû% 8
.
ûû8 9
History
ûû9 @
)
ûû@ A
await
ûûB G"
LoadFromHistoryAsync
ûûH \
(
ûû\ ]
)
ûû] ^
;
ûû^ _
else
üü 
FilterAndPaginate
üü "
(
üü" #
)
üü# $
;
üü$ %
}
†† 	
[
•• 	
RelayCommand
••	 
]
•• 
private
¶¶ 
async
¶¶ 
Task
¶¶ "
SetFilterThisQuarter
¶¶ /
(
¶¶/ 0
)
¶¶0 1
{
ßß 	
var
®® 
today
®® 
=
®® 
DateTime
®®  
.
®®  !
Today
®®! &
;
®®& '
int
©© 
quarter
©© 
=
©© 
(
©© 
today
©©  
.
©©  !
Month
©©! &
-
©©' (
$num
©©) *
)
©©* +
/
©©, -
$num
©©. /
+
©©0 1
$num
©©2 3
;
©©3 4
FilterStartDate
™™ 
=
™™ 
new
™™ !
DateTime
™™" *
(
™™* +
today
™™+ 0
.
™™0 1
Year
™™1 5
,
™™5 6
$num
™™7 8
*
™™9 :
quarter
™™; B
-
™™C D
$num
™™E F
,
™™F G
$num
™™H I
)
™™I J
;
™™J K
FilterEndDate
´´ 
=
´´ 
FilterStartDate
´´ +
.
´´+ ,
	AddMonths
´´, 5
(
´´5 6
$num
´´6 7
)
´´7 8
.
´´8 9
AddDays
´´9 @
(
´´@ A
-
´´A B
$num
´´B C
)
´´C D
;
´´D E
if
¨¨ 
(
¨¨ 
CurrentDataSource
¨¨ !
==
¨¨" $!
Enum_DataSourceType
¨¨% 8
.
¨¨8 9
History
¨¨9 @
)
¨¨@ A
await
¨¨B G"
LoadFromHistoryAsync
¨¨H \
(
¨¨\ ]
)
¨¨] ^
;
¨¨^ _
else
≠≠ 
FilterAndPaginate
≠≠ "
(
≠≠" #
)
≠≠# $
;
≠≠$ %
}
ÆÆ 	
[
≥≥ 	
RelayCommand
≥≥	 
]
≥≥ 
private
¥¥ 
async
¥¥ 
Task
¥¥ 
SetFilterShowAll
¥¥ +
(
¥¥+ ,
)
¥¥, -
{
µµ 	
FilterStartDate
∂∂ 
=
∂∂ 
DateTime
∂∂ &
.
∂∂& '
Today
∂∂' ,
.
∂∂, -
AddYears
∂∂- 5
(
∂∂5 6
-
∂∂6 7
$num
∂∂7 8
)
∂∂8 9
;
∂∂9 :
FilterEndDate
∑∑ 
=
∑∑ 
DateTime
∑∑ $
.
∑∑$ %
Today
∑∑% *
;
∑∑* +
if
∏∏ 
(
∏∏ 
CurrentDataSource
∏∏ !
==
∏∏" $!
Enum_DataSourceType
∏∏% 8
.
∏∏8 9
History
∏∏9 @
)
∏∏@ A
await
∏∏B G"
LoadFromHistoryAsync
∏∏H \
(
∏∏\ ]
)
∏∏] ^
;
∏∏^ _
else
ππ 
FilterAndPaginate
ππ "
(
ππ" #
)
ππ# $
;
ππ$ %
}
∫∫ 	
[
øø 	
RelayCommand
øø	 
(
øø 

CanExecute
øø  
=
øø! "
nameof
øø# )
(
øø) *
CanGoPrevious
øø* 7
)
øø7 8
)
øø8 9
]
øø9 :
private
¿¿ 
void
¿¿ 
PreviousPage
¿¿ !
(
¿¿! "
)
¿¿" #
=>
¿¿$ & 
_paginationService
¿¿' 9
.
¿¿9 :
PreviousPage
¿¿: F
(
¿¿F G
)
¿¿G H
;
¿¿H I
[
≈≈ 	
RelayCommand
≈≈	 
(
≈≈ 

CanExecute
≈≈  
=
≈≈! "
nameof
≈≈# )
(
≈≈) *
	CanGoNext
≈≈* 3
)
≈≈3 4
)
≈≈4 5
]
≈≈5 6
private
∆∆ 
void
∆∆ 
NextPage
∆∆ 
(
∆∆ 
)
∆∆ 
=>
∆∆  " 
_paginationService
∆∆# 5
.
∆∆5 6
NextPage
∆∆6 >
(
∆∆> ?
)
∆∆? @
;
∆∆@ A
[
ÀÀ 	
RelayCommand
ÀÀ	 
(
ÀÀ 

CanExecute
ÀÀ  
=
ÀÀ! "
nameof
ÀÀ# )
(
ÀÀ) *
CanGoPrevious
ÀÀ* 7
)
ÀÀ7 8
)
ÀÀ8 9
]
ÀÀ9 :
private
ÃÃ 
void
ÃÃ 
	FirstPage
ÃÃ 
(
ÃÃ 
)
ÃÃ  
=>
ÃÃ! # 
_paginationService
ÃÃ$ 6
.
ÃÃ6 7
	FirstPage
ÃÃ7 @
(
ÃÃ@ A
)
ÃÃA B
;
ÃÃB C
[
—— 	
RelayCommand
——	 
(
—— 

CanExecute
——  
=
——! "
nameof
——# )
(
——) *
	CanGoNext
——* 3
)
——3 4
)
——4 5
]
——5 6
private
““ 
void
““ 
LastPage
““ 
(
““ 
)
““ 
=>
““  " 
_paginationService
““# 5
.
““5 6
LastPage
““6 >
(
““> ?
)
““? @
;
““@ A
[
◊◊ 	
RelayCommand
◊◊	 
]
◊◊ 
private
ÿÿ 
void
ÿÿ 
GoToPage
ÿÿ 
(
ÿÿ 
)
ÿÿ 
=>
ÿÿ  " 
_paginationService
ÿÿ# 5
.
ÿÿ5 6
GoToPage
ÿÿ6 >
(
ÿÿ> ?
GotoPageNumber
ÿÿ? M
)
ÿÿM N
;
ÿÿN O
private
›› 
bool
›› 
	CanGoNext
›› 
(
›› 
)
››  
=>
››! # 
_paginationService
››$ 6
.
››6 7
HasNextPage
››7 B
;
››B C
private
‚‚ 
bool
‚‚ 
CanGoPrevious
‚‚ "
(
‚‚" #
)
‚‚# $
=>
‚‚% ' 
_paginationService
‚‚( :
.
‚‚: ;
HasPreviousPage
‚‚; J
;
‚‚J K
[
ÁÁ 	
RelayCommand
ÁÁ	 
]
ÁÁ 
private
ËË 
async
ËË 
Task
ËË (
LoadFromCurrentMemoryAsync
ËË 5
(
ËË5 6
)
ËË6 7
{
ÈÈ 	
try
ÍÍ 
{
ÎÎ 
_logger
ÏÏ 
.
ÏÏ 
LogInfo
ÏÏ 
(
ÏÏ  
$str
ÏÏ  B
)
ÏÏB C
;
ÏÏC D
IsBusy
ÌÌ 
=
ÌÌ 
true
ÌÌ 
;
ÌÌ 
StatusMessage
ÓÓ 
=
ÓÓ 
$str
ÓÓ  A
;
ÓÓA B
_deletedLoads
ÔÔ 
.
ÔÔ 
Clear
ÔÔ #
(
ÔÔ# $
)
ÔÔ$ %
;
ÔÔ% &
var
ÒÒ 
currentLoads
ÒÒ  
=
ÒÒ! "
_workflowService
ÒÒ# 3
.
ÒÒ3 4
CurrentSession
ÒÒ4 B
.
ÒÒB C
Loads
ÒÒC H
;
ÒÒH I
if
ÚÚ 
(
ÚÚ 
currentLoads
ÚÚ  
.
ÚÚ  !
Count
ÚÚ! &
==
ÚÚ' )
$num
ÚÚ* +
)
ÚÚ+ ,
{
ÛÛ 
await
ÙÙ 
_errorHandler
ÙÙ '
.
ÙÙ' (
HandleErrorAsync
ÙÙ( 8
(
ÙÙ8 9
$str
ıı g
,
ııg h 
Enum_ErrorSeverity
ˆˆ *
.
ˆˆ* +
Warning
ˆˆ+ 2
)
ˆˆ2 3
;
ˆˆ3 4
return
˜˜ 
;
˜˜ 
}
¯¯ 
	_allLoads
˙˙ 
.
˙˙ 
Clear
˙˙ 
(
˙˙  
)
˙˙  !
;
˙˙! "
foreach
˚˚ 
(
˚˚ 
var
˚˚ 
load
˚˚ !
in
˚˚" $
currentLoads
˚˚% 1
)
˚˚1 2
{
¸¸ 
	_allLoads
˝˝ 
.
˝˝ 
Add
˝˝ !
(
˝˝! "
load
˝˝" &
)
˝˝& '
;
˝˝' (
}
˛˛ 
StatusMessage
ÄÄ 
=
ÄÄ 
$"
ÄÄ  "
$str
ÄÄ" )
{
ÄÄ) *
	_allLoads
ÄÄ* 3
.
ÄÄ3 4
Count
ÄÄ4 9
}
ÄÄ9 :
$str
ÄÄ: U
"
ÄÄU V
;
ÄÄV W
_logger
ÅÅ 
.
ÅÅ 
LogInfo
ÅÅ 
(
ÅÅ  
$"
ÅÅ  "
$str
ÅÅ" 6
{
ÅÅ6 7
	_allLoads
ÅÅ7 @
.
ÅÅ@ A
Count
ÅÅA F
}
ÅÅF G
$str
ÅÅG a
"
ÅÅa b
)
ÅÅb c
;
ÅÅc d
CurrentDataSource
ÇÇ !
=
ÇÇ" #!
Enum_DataSourceType
ÇÇ$ 7
.
ÇÇ7 8
Memory
ÇÇ8 >
;
ÇÇ> ?!
SelectAllButtonText
ÉÉ #
=
ÉÉ$ %
$str
ÉÉ& 2
;
ÉÉ2 3
FilterStartDate
ÖÖ 
=
ÖÖ  !
DateTimeOffset
ÖÖ" 0
.
ÖÖ0 1
Now
ÖÖ1 4
.
ÖÖ4 5
AddYears
ÖÖ5 =
(
ÖÖ= >
-
ÖÖ> ?
$num
ÖÖ? @
)
ÖÖ@ A
;
ÖÖA B
FilterEndDate
ÜÜ 
=
ÜÜ 
DateTimeOffset
ÜÜ  .
.
ÜÜ. /
Now
ÜÜ/ 2
;
ÜÜ2 3
FilterAndPaginate
àà !
(
àà! "
)
àà" #
;
àà# $
}
ââ 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
ãã 
_logger
åå 
.
åå 
LogError
åå  
(
åå  !
$"
åå! #
$str
åå# G
{
ååG H
ex
ååH J
.
ååJ K
Message
ååK R
}
ååR S
"
ååS T
)
ååT U
;
ååU V
await
çç 
_errorHandler
çç #
.
çç# $
HandleErrorAsync
çç$ 4
(
çç4 5
$str
çç5 _
,
çç_ ` 
Enum_ErrorSeverity
çça s
.
ççs t
Error
ççt y
,
ççy z
ex
çç{ }
)
çç} ~
;
çç~ 
}
éé 
finally
èè 
{
êê 
IsBusy
ëë 
=
ëë 
false
ëë 
;
ëë 
}
íí 
}
ìì 	
[
òò 	
RelayCommand
òò	 
]
òò 
private
ôô 
async
ôô 
Task
ôô (
LoadFromCurrentLabelsAsync
ôô 5
(
ôô5 6
)
ôô6 7
{
öö 	
try
õõ 
{
úú 
_logger
ùù 
.
ùù 
LogInfo
ùù 
(
ùù  
$str
ùù  J
)
ùùJ K
;
ùùK L
IsBusy
ûû 
=
ûû 
true
ûû 
;
ûû 
StatusMessage
üü 
=
üü 
$str
üü  F
;
üüF G
if
°° 
(
°° 
await
°° (
TryLoadFromDefaultCsvAsync
°° 4
(
°°4 5
)
°°5 6
)
°°6 7
{
¢¢ 
return
££ 
;
££ 
}
§§ 
await
¶¶ 
_errorHandler
¶¶ #
.
¶¶# $"
ShowErrorDialogAsync
¶¶$ 8
(
¶¶8 9
$str
ßß %
,
ßß% &
$str
®® V
,
®®V W 
Enum_ErrorSeverity
©© &
.
©©& '
Warning
©©' .
)
©©. /
;
©©/ 0
}
™™ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
¨¨ 
_logger
≠≠ 
.
≠≠ 
LogError
≠≠  
(
≠≠  !
$"
≠≠! #
$str
≠≠# ?
{
≠≠? @
ex
≠≠@ B
.
≠≠B C
Message
≠≠C J
}
≠≠J K
"
≠≠K L
)
≠≠L M
;
≠≠M N
await
ÆÆ 
_errorHandler
ÆÆ #
.
ÆÆ# $
HandleErrorAsync
ÆÆ$ 4
(
ÆÆ4 5
$str
ÆÆ5 Z
,
ÆÆZ [ 
Enum_ErrorSeverity
ÆÆ\ n
.
ÆÆn o
Error
ÆÆo t
,
ÆÆt u
ex
ÆÆv x
)
ÆÆx y
;
ÆÆy z
}
ØØ 
finally
∞∞ 
{
±± 
IsBusy
≤≤ 
=
≤≤ 
false
≤≤ 
;
≤≤ 
}
≥≥ 
}
¥¥ 	
private
ππ 
async
ππ 
Task
ππ 
<
ππ 
bool
ππ 
>
ππ  (
TryLoadFromDefaultCsvAsync
ππ! ;
(
ππ; <
)
ππ< =
{
∫∫ 	
string
ªª 
	localPath
ªª 
=
ªª 

_csvWriter
ªª )
.
ªª) *
GetLocalCSVPath
ªª* 9
(
ªª9 :
)
ªª: ;
;
ªª; <
if
ºº 
(
ºº 
File
ºº 
.
ºº 
Exists
ºº 
(
ºº 
	localPath
ºº %
)
ºº% &
)
ºº& '
{
ΩΩ 
try
ææ 
{
øø 
_logger
¿¿ 
.
¿¿ 
LogInfo
¿¿ #
(
¿¿# $
$"
¿¿$ &
$str
¿¿& I
{
¿¿I J
	localPath
¿¿J S
}
¿¿S T
"
¿¿T U
)
¿¿U V
;
¿¿V W
var
¡¡ 

loadedData
¡¡ "
=
¡¡# $
await
¡¡% *

_csvWriter
¡¡+ 5
.
¡¡5 6
ReadFromCSVAsync
¡¡6 F
(
¡¡F G
	localPath
¡¡G P
)
¡¡P Q
;
¡¡Q R
if
√√ 
(
√√ 

loadedData
√√ "
.
√√" #
Count
√√# (
>
√√) *
$num
√√+ ,
)
√√, -
{
ƒƒ 
_deletedLoads
≈≈ %
.
≈≈% &
Clear
≈≈& +
(
≈≈+ ,
)
≈≈, -
;
≈≈- .
	_allLoads
∆∆ !
.
∆∆! "
Clear
∆∆" '
(
∆∆' (
)
∆∆( )
;
∆∆) *
foreach
«« 
(
««  !
var
««! $
load
««% )
in
««* ,

loadedData
««- 7
)
««7 8
{
»» 
	_allLoads
…… %
.
……% &
Add
……& )
(
……) *
load
……* .
)
……. /
;
……/ 0
_workflowService
   ,
.
  , -
CurrentSession
  - ;
.
  ; <
Loads
  < A
.
  A B
Add
  B E
(
  E F
load
  F J
)
  J K
;
  K L
}
ÀÀ 
StatusMessage
ÃÃ %
=
ÃÃ& '
$"
ÃÃ( *
$str
ÃÃ* 1
{
ÃÃ1 2
	_allLoads
ÃÃ2 ;
.
ÃÃ; <
Count
ÃÃ< A
}
ÃÃA B
$str
ÃÃB Z
"
ÃÃZ [
;
ÃÃ[ \
_logger
ÕÕ 
.
ÕÕ  
LogInfo
ÕÕ  '
(
ÕÕ' (
$"
ÕÕ( *
$str
ÕÕ* >
{
ÕÕ> ?
	_allLoads
ÕÕ? H
.
ÕÕH I
Count
ÕÕI N
}
ÕÕN O
$str
ÕÕO g
"
ÕÕg h
)
ÕÕh i
;
ÕÕi j
CurrentDataSource
ŒŒ )
=
ŒŒ* +!
Enum_DataSourceType
ŒŒ, ?
.
ŒŒ? @
CurrentLabels
ŒŒ@ M
;
ŒŒM N
_currentCsvPath
œœ '
=
œœ( )
	localPath
œœ* 3
;
œœ3 4!
SelectAllButtonText
–– +
=
––, -
$str
––. :
;
––: ;
FilterStartDate
““ '
=
““( )
DateTimeOffset
““* 8
.
““8 9
Now
““9 <
.
““< =
AddYears
““= E
(
““E F
-
““F G
$num
““G H
)
““H I
;
““I J
FilterEndDate
”” %
=
””& '
DateTimeOffset
””( 6
.
””6 7
Now
””7 :
;
””: ;
FilterAndPaginate
’’ )
(
’’) *
)
’’* +
;
’’+ ,
return
÷÷ 
true
÷÷ #
;
÷÷# $
}
◊◊ 
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ  
ex
ŸŸ! #
)
ŸŸ# $
{
⁄⁄ 
_logger
€€ 
.
€€ 

LogWarning
€€ &
(
€€& '
$"
€€' )
$str
€€) K
{
€€K L
ex
€€L N
.
€€N O
Message
€€O V
}
€€V W
"
€€W X
)
€€X Y
;
€€Y Z
}
‹‹ 
}
›› 
try
ﬂﬂ 
{
‡‡ 
string
·· 
networkPath
·· "
=
··# $

_csvWriter
··% /
.
··/ 0
GetNetworkCSVPath
··0 A
(
··A B
)
··B C
;
··C D
if
‚‚ 
(
‚‚ 
File
‚‚ 
.
‚‚ 
Exists
‚‚ 
(
‚‚  
networkPath
‚‚  +
)
‚‚+ ,
)
‚‚, -
{
„„ 
_logger
‰‰ 
.
‰‰ 
LogInfo
‰‰ #
(
‰‰# $
$"
‰‰$ &
$str
‰‰& N
{
‰‰N O
networkPath
‰‰O Z
}
‰‰Z [
"
‰‰[ \
)
‰‰\ ]
;
‰‰] ^
var
ÂÂ 

loadedData
ÂÂ "
=
ÂÂ# $
await
ÂÂ% *

_csvWriter
ÂÂ+ 5
.
ÂÂ5 6
ReadFromCSVAsync
ÂÂ6 F
(
ÂÂF G
networkPath
ÂÂG R
)
ÂÂR S
;
ÂÂS T
if
ÁÁ 
(
ÁÁ 

loadedData
ÁÁ "
.
ÁÁ" #
Count
ÁÁ# (
>
ÁÁ) *
$num
ÁÁ+ ,
)
ÁÁ, -
{
ËË 
_deletedLoads
ÈÈ %
.
ÈÈ% &
Clear
ÈÈ& +
(
ÈÈ+ ,
)
ÈÈ, -
;
ÈÈ- .
	_allLoads
ÍÍ !
.
ÍÍ! "
Clear
ÍÍ" '
(
ÍÍ' (
)
ÍÍ( )
;
ÍÍ) *
foreach
ÎÎ 
(
ÎÎ  !
var
ÎÎ! $
load
ÎÎ% )
in
ÎÎ* ,

loadedData
ÎÎ- 7
)
ÎÎ7 8
{
ÏÏ 
	_allLoads
ÌÌ %
.
ÌÌ% &
Add
ÌÌ& )
(
ÌÌ) *
load
ÌÌ* .
)
ÌÌ. /
;
ÌÌ/ 0
_workflowService
ÓÓ ,
.
ÓÓ, -
CurrentSession
ÓÓ- ;
.
ÓÓ; <
Loads
ÓÓ< A
.
ÓÓA B
Add
ÓÓB E
(
ÓÓE F
load
ÓÓF J
)
ÓÓJ K
;
ÓÓK L
}
ÔÔ 
StatusMessage
 %
=
& '
$"
( *
$str
* 1
{
1 2
	_allLoads
2 ;
.
; <
Count
< A
}
A B
$str
B \
"
\ ]
;
] ^
_logger
ÒÒ 
.
ÒÒ  
LogInfo
ÒÒ  '
(
ÒÒ' (
$"
ÒÒ( *
$str
ÒÒ* >
{
ÒÒ> ?
	_allLoads
ÒÒ? H
.
ÒÒH I
Count
ÒÒI N
}
ÒÒN O
$str
ÒÒO i
"
ÒÒi j
)
ÒÒj k
;
ÒÒk l
CurrentDataSource
ÚÚ )
=
ÚÚ* +!
Enum_DataSourceType
ÚÚ, ?
.
ÚÚ? @
CurrentLabels
ÚÚ@ M
;
ÚÚM N
_currentCsvPath
ÛÛ '
=
ÛÛ( )
networkPath
ÛÛ* 5
;
ÛÛ5 6!
SelectAllButtonText
ÙÙ +
=
ÙÙ, -
$str
ÙÙ. :
;
ÙÙ: ;
FilterStartDate
ˆˆ '
=
ˆˆ( )
DateTimeOffset
ˆˆ* 8
.
ˆˆ8 9
Now
ˆˆ9 <
.
ˆˆ< =
AddYears
ˆˆ= E
(
ˆˆE F
-
ˆˆF G
$num
ˆˆG H
)
ˆˆH I
;
ˆˆI J
FilterEndDate
˜˜ %
=
˜˜& '
DateTimeOffset
˜˜( 6
.
˜˜6 7
Now
˜˜7 :
;
˜˜: ;
FilterAndPaginate
˘˘ )
(
˘˘) *
)
˘˘* +
;
˘˘+ ,
return
˙˙ 
true
˙˙ #
;
˙˙# $
}
˚˚ 
}
¸¸ 
}
˝˝ 
catch
˛˛ 
(
˛˛ 
	Exception
˛˛ 
ex
˛˛ 
)
˛˛  
{
ˇˇ 
_logger
ÄÄ 
.
ÄÄ 

LogWarning
ÄÄ "
(
ÄÄ" #
$"
ÄÄ# %
$str
ÄÄ% I
{
ÄÄI J
ex
ÄÄJ L
.
ÄÄL M
Message
ÄÄM T
}
ÄÄT U
"
ÄÄU V
)
ÄÄV W
;
ÄÄW X
}
ÅÅ 
return
ÉÉ 
false
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
[
ââ 	
RelayCommand
ââ	 
]
ââ 
private
ää 
async
ää 
Task
ää "
LoadFromHistoryAsync
ää /
(
ää/ 0
)
ää0 1
{
ãã 	
try
åå 
{
çç 
_logger
éé 
.
éé 
LogInfo
éé 
(
éé  
$str
éé  =
)
éé= >
;
éé> ?
IsBusy
èè 
=
èè 
true
èè 
;
èè 
StatusMessage
êê 
=
êê 
$str
êê  9
;
êê9 :
var
íí 
	startDate
íí 
=
íí 
FilterStartDate
íí  /
.
íí/ 0
Date
íí0 4
;
íí4 5
var
ìì 
endDate
ìì 
=
ìì 
FilterEndDate
ìì +
.
ìì+ ,
Date
ìì, 0
;
ìì0 1
_logger
ïï 
.
ïï 
LogInfo
ïï 
(
ïï  
$"
ïï  "
$str
ïï" A
{
ïïA B
	startDate
ïïB K
:
ïïK L
$str
ïïL V
}
ïïV W
$str
ïïW [
{
ïï[ \
endDate
ïï\ c
:
ïïc d
$str
ïïd n
}
ïïn o
"
ïïo p
)
ïïp q
;
ïïq r
var
ññ 
result
ññ 
=
ññ 
await
ññ "
_mysqlService
ññ# 0
.
ññ0 1'
GetAllReceivingLoadsAsync
ññ1 J
(
ññJ K
	startDate
ññK T
,
ññT U
endDate
ññV ]
)
ññ] ^
;
ññ^ _
if
òò 
(
òò 
!
òò 
result
òò 
.
òò 
	IsSuccess
òò %
)
òò% &
{
ôô 
await
öö 
_errorHandler
öö '
.
öö' (
HandleErrorAsync
öö( 8
(
öö8 9
$"
õõ 
$str
õõ 7
{
õõ7 8
result
õõ8 >
.
õõ> ?
ErrorMessage
õõ? K
}
õõK L
"
õõL M
,
õõM N 
Enum_ErrorSeverity
úú *
.
úú* +
Error
úú+ 0
)
úú0 1
;
úú1 2
return
ùù 
;
ùù 
}
ûû 
if
†† 
(
†† 
result
†† 
.
†† 
Data
†† 
==
††  "
null
††# '
||
††( *
result
††+ 1
.
††1 2
Data
††2 6
.
††6 7
Count
††7 <
==
††= ?
$num
††@ A
)
††A B
{
°° 
await
¢¢ 
_errorHandler
¢¢ '
.
¢¢' (
HandleErrorAsync
¢¢( 8
(
¢¢8 9
$str
££ Q
,
££Q R 
Enum_ErrorSeverity
§§ *
.
§§* +
Warning
§§+ 2
)
§§2 3
;
§§3 4
return
•• 
;
•• 
}
¶¶ 
_deletedLoads
®® 
.
®® 
Clear
®® #
(
®®# $
)
®®$ %
;
®®% &
	_allLoads
©© 
.
©© 
Clear
©© 
(
©©  
)
©©  !
;
©©! "
foreach
™™ 
(
™™ 
var
™™ 
load
™™ !
in
™™" $
result
™™% +
.
™™+ ,
Data
™™, 0
)
™™0 1
{
´´ 
	_allLoads
¨¨ 
.
¨¨ 
Add
¨¨ !
(
¨¨! "
load
¨¨" &
)
¨¨& '
;
¨¨' (
_workflowService
≠≠ $
.
≠≠$ %
CurrentSession
≠≠% 3
.
≠≠3 4
Loads
≠≠4 9
.
≠≠9 :
Add
≠≠: =
(
≠≠= >
load
≠≠> B
)
≠≠B C
;
≠≠C D
}
ÆÆ 
StatusMessage
∞∞ 
=
∞∞ 
$"
∞∞  "
$str
∞∞" )
{
∞∞) *
	_allLoads
∞∞* 3
.
∞∞3 4
Count
∞∞4 9
}
∞∞9 :
$str
∞∞: M
"
∞∞M N
;
∞∞N O
_logger
±± 
.
±± 
LogInfo
±± 
(
±±  
$"
±±  "
$str
±±" 6
{
±±6 7
	_allLoads
±±7 @
.
±±@ A
Count
±±A F
}
±±F G
$str
±±G Z
"
±±Z [
)
±±[ \
;
±±\ ]
CurrentDataSource
≤≤ !
=
≤≤" #!
Enum_DataSourceType
≤≤$ 7
.
≤≤7 8
History
≤≤8 ?
;
≤≤? @!
SelectAllButtonText
≥≥ #
=
≥≥$ %
$str
≥≥& 2
;
≥≥2 3
FilterAndPaginate
µµ !
(
µµ! "
)
µµ" #
;
µµ# $
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
ex
∑∑ 
)
∑∑  
{
∏∏ 
_logger
ππ 
.
ππ 
LogError
ππ  
(
ππ  !
$"
ππ! #
$str
ππ# @
{
ππ@ A
ex
ππA C
.
ππC D
Message
ππD K
}
ππK L
"
ππL M
)
ππM N
;
ππN O
await
∫∫ 
_errorHandler
∫∫ #
.
∫∫# $
HandleErrorAsync
∫∫$ 4
(
∫∫4 5
$str
∫∫5 W
,
∫∫W X 
Enum_ErrorSeverity
∫∫Y k
.
∫∫k l
Error
∫∫l q
,
∫∫q r
ex
∫∫s u
)
∫∫u v
;
∫∫v w
}
ªª 
finally
ºº 
{
ΩΩ 
IsBusy
ææ 
=
ææ 
false
ææ 
;
ææ 
}
øø 
}
¿¿ 	
[
≈≈ 	
RelayCommand
≈≈	 
(
≈≈ 

CanExecute
≈≈  
=
≈≈! "
nameof
≈≈# )
(
≈≈) *
CanSelectAll
≈≈* 6
)
≈≈6 7
)
≈≈7 8
]
≈≈8 9
private
∆∆ 
void
∆∆ 
	SelectAll
∆∆ 
(
∆∆ 
)
∆∆  
{
«« 	
bool
»» 
anyUnselected
»» 
=
»»  
Loads
»»! &
.
»»& '
Any
»»' *
(
»»* +
l
»»+ ,
=>
»»- /
!
»»0 1
l
»»1 2
.
»»2 3

IsSelected
»»3 =
)
»»= >
;
»»> ?
if
   
(
   
anyUnselected
   
)
   
{
ÀÀ 
foreach
ÃÃ 
(
ÃÃ 
var
ÃÃ 
load
ÃÃ !
in
ÃÃ" $
Loads
ÃÃ% *
)
ÃÃ* +
load
ÃÃ, 0
.
ÃÃ0 1

IsSelected
ÃÃ1 ;
=
ÃÃ< =
true
ÃÃ> B
;
ÃÃB C!
SelectAllButtonText
ÕÕ #
=
ÕÕ$ %
$str
ÕÕ& 4
;
ÕÕ4 5
}
ŒŒ 
else
œœ 
{
–– 
foreach
—— 
(
—— 
var
—— 
load
—— !
in
——" $
Loads
——% *
)
——* +
load
——, 0
.
——0 1

IsSelected
——1 ;
=
——< =
false
——> C
;
——C D!
SelectAllButtonText
““ #
=
““$ %
$str
““& 2
;
““2 3
}
”” 
}
‘‘ 	
private
ŸŸ 
bool
ŸŸ 
CanSelectAll
ŸŸ !
(
ŸŸ! "
)
ŸŸ" #
=>
ŸŸ$ &
Loads
ŸŸ' ,
.
ŸŸ, -
Count
ŸŸ- 2
>
ŸŸ3 4
$num
ŸŸ5 6
;
ŸŸ6 7
[
ﬁﬁ 	
RelayCommand
ﬁﬁ	 
(
ﬁﬁ 

CanExecute
ﬁﬁ  
=
ﬁﬁ! "
nameof
ﬁﬁ# )
(
ﬁﬁ) *
CanRemoveRow
ﬁﬁ* 6
)
ﬁﬁ6 7
)
ﬁﬁ7 8
]
ﬁﬁ8 9
private
ﬂﬂ 
void
ﬂﬂ 
	RemoveRow
ﬂﬂ 
(
ﬂﬂ 
)
ﬂﬂ  
{
‡‡ 	
var
·· 
selectedLoads
·· 
=
·· 
Loads
··  %
.
··% &
Where
··& +
(
··+ ,
l
··, -
=>
··. 0
l
··1 2
.
··2 3

IsSelected
··3 =
)
··= >
.
··> ?
ToList
··? E
(
··E F
)
··F G
;
··G H
if
„„ 
(
„„ 
selectedLoads
„„ 
.
„„ 
Any
„„ !
(
„„! "
)
„„" #
)
„„# $
{
‰‰ 
_logger
ÂÂ 
.
ÂÂ 
LogInfo
ÂÂ 
(
ÂÂ  
$"
ÂÂ  "
$str
ÂÂ" +
{
ÂÂ+ ,
selectedLoads
ÂÂ, 9
.
ÂÂ9 :
Count
ÂÂ: ?
}
ÂÂ? @
$str
ÂÂ@ O
"
ÂÂO P
)
ÂÂP Q
;
ÂÂQ R
foreach
ÊÊ 
(
ÊÊ 
var
ÊÊ 
load
ÊÊ !
in
ÊÊ" $
selectedLoads
ÊÊ% 2
)
ÊÊ2 3
{
ÁÁ 
_deletedLoads
ËË !
.
ËË! "
Add
ËË" %
(
ËË% &
load
ËË& *
)
ËË* +
;
ËË+ ,
_workflowService
ÈÈ $
.
ÈÈ$ %
CurrentSession
ÈÈ% 3
.
ÈÈ3 4
Loads
ÈÈ4 9
.
ÈÈ9 :
Remove
ÈÈ: @
(
ÈÈ@ A
load
ÈÈA E
)
ÈÈE F
;
ÈÈF G
	_allLoads
ÍÍ 
.
ÍÍ 
Remove
ÍÍ $
(
ÍÍ$ %
load
ÍÍ% )
)
ÍÍ) *
;
ÍÍ* +
_filteredLoads
ÎÎ "
.
ÎÎ" #
Remove
ÎÎ# )
(
ÎÎ) *
load
ÎÎ* .
)
ÎÎ. /
;
ÎÎ/ 0
Loads
ÏÏ 
.
ÏÏ 
Remove
ÏÏ  
(
ÏÏ  !
load
ÏÏ! %
)
ÏÏ% &
;
ÏÏ& '
}
ÌÌ 
FilterAndPaginate
ÔÔ !
(
ÔÔ! "
)
ÔÔ" #
;
ÔÔ# $
}
 
else
ÒÒ 
if
ÒÒ 
(
ÒÒ 
SelectedLoad
ÒÒ !
!=
ÒÒ" $
null
ÒÒ% )
)
ÒÒ) *
{
ÚÚ 
_logger
ÛÛ 
.
ÛÛ 
LogInfo
ÛÛ 
(
ÛÛ  
$"
ÛÛ  "
$str
ÛÛ" 0
{
ÛÛ0 1
SelectedLoad
ÛÛ1 =
.
ÛÛ= >

LoadNumber
ÛÛ> H
}
ÛÛH I
$str
ÛÛI T
{
ÛÛT U
SelectedLoad
ÛÛU a
.
ÛÛa b
PartID
ÛÛb h
}
ÛÛh i
$str
ÛÛi j
"
ÛÛj k
)
ÛÛk l
;
ÛÛl m
_deletedLoads
ÙÙ 
.
ÙÙ 
Add
ÙÙ !
(
ÙÙ! "
SelectedLoad
ÙÙ" .
)
ÙÙ. /
;
ÙÙ/ 0
_workflowService
ıı  
.
ıı  !
CurrentSession
ıı! /
.
ıı/ 0
Loads
ıı0 5
.
ıı5 6
Remove
ıı6 <
(
ıı< =
SelectedLoad
ıı= I
)
ııI J
;
ııJ K
	_allLoads
ˆˆ 
.
ˆˆ 
Remove
ˆˆ  
(
ˆˆ  !
SelectedLoad
ˆˆ! -
)
ˆˆ- .
;
ˆˆ. /
_filteredLoads
˜˜ 
.
˜˜ 
Remove
˜˜ %
(
˜˜% &
SelectedLoad
˜˜& 2
)
˜˜2 3
;
˜˜3 4
Loads
¯¯ 
.
¯¯ 
Remove
¯¯ 
(
¯¯ 
SelectedLoad
¯¯ )
)
¯¯) *
;
¯¯* +
FilterAndPaginate
˙˙ !
(
˙˙! "
)
˙˙" #
;
˙˙# $
}
˚˚ 
else
¸¸ 
{
˝˝ 
_logger
˛˛ 
.
˛˛ 

LogWarning
˛˛ "
(
˛˛" #
$str
˛˛# N
)
˛˛N O
;
˛˛O P
}
ˇˇ 
SaveCommand
ÄÄ 
.
ÄÄ %
NotifyCanExecuteChanged
ÄÄ /
(
ÄÄ/ 0
)
ÄÄ0 1
;
ÄÄ1 2
}
ÅÅ 	
private
ÜÜ 
bool
ÜÜ 
CanRemoveRow
ÜÜ !
(
ÜÜ! "
)
ÜÜ" #
=>
ÜÜ$ &
Loads
ÜÜ' ,
.
ÜÜ, -
Any
ÜÜ- 0
(
ÜÜ0 1
l
ÜÜ1 2
=>
ÜÜ3 5
l
ÜÜ6 7
.
ÜÜ7 8

IsSelected
ÜÜ8 B
)
ÜÜB C
;
ÜÜC D
[
ãã 	
RelayCommand
ãã	 
(
ãã 

CanExecute
ãã  
=
ãã! "
nameof
ãã# )
(
ãã) *
CanSave
ãã* 1
)
ãã1 2
)
ãã2 3
]
ãã3 4
private
åå 
async
åå 
Task
åå 
	SaveAsync
åå $
(
åå$ %
)
åå% &
{
çç 	
try
éé 
{
èè 
_logger
êê 
.
êê 
LogInfo
êê 
(
êê  
$"
êê  "
$str
êê" 8
{
êê8 9
_filteredLoads
êê9 G
.
êêG H
Count
êêH M
}
êêM N
$str
êêN c
"
êêc d
)
êêd e
;
êêe f
IsBusy
ëë 
=
ëë 
true
ëë 
;
ëë 
StatusMessage
íí 
=
íí 
$str
íí  5
;
íí5 6
foreach
ññ 
(
ññ 
var
ññ 
load
ññ !
in
ññ" $
	_allLoads
ññ% .
)
ññ. /
{
óó 
if
òò 
(
òò 
string
òò 
.
òò  
IsNullOrWhiteSpace
òò 1
(
òò1 2
load
òò2 6
.
òò6 7
HeatLotNumber
òò7 D
)
òòD E
)
òòE F
{
ôô 
load
öö 
.
öö 
HeatLotNumber
öö *
=
öö+ ,
$str
öö- >
;
öö> ?
}
õõ 
}
úú 
var
ûû 
validationErrors
ûû $
=
ûû% &
ValidateLoads
ûû' 4
(
ûû4 5
_filteredLoads
ûû5 C
)
ûûC D
;
ûûD E
if
üü 
(
üü 
validationErrors
üü $
.
üü$ %
Any
üü% (
(
üü( )
)
üü) *
)
üü* +
{
†† 
var
°° 
errorMessage
°° $
=
°°% &
string
°°' -
.
°°- .
Join
°°. 2
(
°°2 3
$str
°°3 7
,
°°7 8
validationErrors
°°9 I
)
°°I J
;
°°J K
_logger
¢¢ 
.
¢¢ 

LogWarning
¢¢ &
(
¢¢& '
$"
¢¢' )
$str
¢¢) F
{
¢¢F G
validationErrors
¢¢G W
.
¢¢W X
Count
¢¢X ]
}
¢¢] ^
$str
¢¢^ e
"
¢¢e f
)
¢¢f g
;
¢¢g h
await
££ 
_errorHandler
££ '
.
££' (
HandleErrorAsync
££( 8
(
££8 9
$"
§§ 
$str
§§ .
{
§§. /
errorMessage
§§/ ;
}
§§; <
"
§§< =
,
§§= > 
Enum_ErrorSeverity
•• *
.
••* +
Warning
••+ 2
)
••2 3
;
••3 4
return
¶¶ 
;
¶¶ 
}
ßß 
StatusMessage
©© 
=
©© 
$str
©©  0
;
©©0 1
switch
´´ 
(
´´ 
CurrentDataSource
´´ )
)
´´) *
{
¨¨ 
case
≠≠ !
Enum_DataSourceType
≠≠ ,
.
≠≠, -
Memory
≠≠- 3
:
≠≠3 4
await
ÆÆ 
_workflowService
ÆÆ .
.
ÆÆ. /$
AdvanceToNextStepAsync
ÆÆ/ E
(
ÆÆE F
)
ÆÆF G
;
ÆÆG H
break
ØØ 
;
ØØ 
case
±± !
Enum_DataSourceType
±± ,
.
±±, -
CurrentLabels
±±- :
:
±±: ;
if
≤≤ 
(
≤≤ 
string
≤≤ "
.
≤≤" #
IsNullOrEmpty
≤≤# 0
(
≤≤0 1
_currentCsvPath
≤≤1 @
)
≤≤@ A
)
≤≤A B
{
≥≥ 
await
¥¥ !
_errorHandler
¥¥" /
.
¥¥/ 0
HandleErrorAsync
¥¥0 @
(
¥¥@ A
$str
¥¥A k
,
¥¥k l 
Enum_ErrorSeverity
¥¥m 
.¥¥ Ä
Error¥¥Ä Ö
)¥¥Ö Ü
;¥¥Ü á
return
µµ "
;
µµ" #
}
∂∂ 
_logger
∏∏ 
.
∏∏  
LogInfo
∏∏  '
(
∏∏' (
$"
∏∏( *
$str
∏∏* B
{
∏∏B C
_currentCsvPath
∏∏C R
}
∏∏R S
"
∏∏S T
)
∏∏T U
;
∏∏U V
await
ππ 

_csvWriter
ππ (
.
ππ( )
WriteToFileAsync
ππ) 9
(
ππ9 :
_currentCsvPath
ππ: I
,
ππI J
	_allLoads
ππK T
,
ππT U
append
ππV \
:
ππ\ ]
false
ππ^ c
)
ππc d
;
ππd e
StatusMessage
∫∫ %
=
∫∫& '
$str
∫∫( I
;
∫∫I J
await
ªª 
_errorHandler
ªª +
.
ªª+ ,"
ShowErrorDialogAsync
ªª, @
(
ªª@ A
$str
ªªA J
,
ªªJ K
$str
ªªL n
,
ªªn o!
Enum_ErrorSeverityªªp Ç
.ªªÇ É
InfoªªÉ á
)ªªá à
;ªªà â
break
ºº 
;
ºº 
case
ææ !
Enum_DataSourceType
ææ ,
.
ææ, -
History
ææ- 4
:
ææ4 5
_logger
øø 
.
øø  
LogInfo
øø  '
(
øø' (
$str
øø( B
)
øøB C
;
øøC D
int
¿¿ 
deleted
¿¿ #
=
¿¿$ %
$num
¿¿& '
;
¿¿' (
if
¡¡ 
(
¡¡ 
_deletedLoads
¡¡ )
.
¡¡) *
Count
¡¡* /
>
¡¡0 1
$num
¡¡2 3
)
¡¡3 4
{
¬¬ 
_logger
√√ #
.
√√# $
LogInfo
√√$ +
(
√√+ ,
$"
√√, .
$str
√√. 7
{
√√7 8
_deletedLoads
√√8 E
.
√√E F
Count
√√F K
}
√√K L
$str
√√L \
"
√√\ ]
)
√√] ^
;
√√^ _
deleted
ƒƒ #
=
ƒƒ$ %
await
ƒƒ& +
_mysqlService
ƒƒ, 9
.
ƒƒ9 :'
DeleteReceivingLoadsAsync
ƒƒ: S
(
ƒƒS T
_deletedLoads
ƒƒT a
)
ƒƒa b
;
ƒƒb c
}
≈≈ 
int
«« 
updated
«« #
=
««$ %
$num
««& '
;
««' (
if
»» 
(
»» 
_filteredLoads
»» *
.
»»* +
Count
»»+ 0
>
»»1 2
$num
»»3 4
)
»»4 5
{
…… 
updated
   #
=
  $ %
await
  & +
_mysqlService
  , 9
.
  9 :'
UpdateReceivingLoadsAsync
  : S
(
  S T
_filteredLoads
  T b
)
  b c
;
  c d
}
ÀÀ 
StatusMessage
ÕÕ %
=
ÕÕ& '
$"
ÕÕ( *
$str
ÕÕ* ;
{
ÕÕ; <
updated
ÕÕ< C
}
ÕÕC D
$str
ÕÕD N
{
ÕÕN O
deleted
ÕÕO V
}
ÕÕV W
$str
ÕÕW `
"
ÕÕ` a
;
ÕÕa b
await
ŒŒ 
_errorHandler
ŒŒ +
.
ŒŒ+ ,"
ShowErrorDialogAsync
ŒŒ, @
(
ŒŒ@ A
$str
ŒŒA J
,
ŒŒJ K
$"
ŒŒL N
$str
ŒŒN m
{
ŒŒm n
updated
ŒŒn u
}
ŒŒu v
$strŒŒv â
{ŒŒâ ä
deletedŒŒä ë
}ŒŒë í
$strŒŒí £
"ŒŒ£ §
,ŒŒ§ •"
Enum_ErrorSeverityŒŒ¶ ∏
.ŒŒ∏ π
InfoŒŒπ Ω
)ŒŒΩ æ
;ŒŒæ ø
break
œœ 
;
œœ 
}
–– 
_logger
““ 
.
““ 
LogInfo
““ 
(
““  
$"
““  "
$str
““" T
{
““T U
CurrentDataSource
““U f
}
““f g
"
““g h
)
““h i
;
““i j
_deletedLoads
”” 
.
”” 
Clear
”” #
(
””# $
)
””$ %
;
””% &
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
÷÷ 
_logger
◊◊ 
.
◊◊ 
LogError
◊◊  
(
◊◊  !
$"
◊◊! #
$str
◊◊# B
{
◊◊B C
ex
◊◊C E
.
◊◊E F
Message
◊◊F M
}
◊◊M N
"
◊◊N O
)
◊◊O P
;
◊◊P Q
await
ÿÿ 
_errorHandler
ÿÿ #
.
ÿÿ# $
HandleErrorAsync
ÿÿ$ 4
(
ÿÿ4 5
$str
ÿÿ5 T
,
ÿÿT U 
Enum_ErrorSeverity
ÿÿV h
.
ÿÿh i
Critical
ÿÿi q
,
ÿÿq r
ex
ÿÿs u
)
ÿÿu v
;
ÿÿv w
}
ŸŸ 
finally
⁄⁄ 
{
€€ 
IsBusy
‹‹ 
=
‹‹ 
false
‹‹ 
;
‹‹ 
}
›› 
}
ﬁﬁ 	
private
„„ 
bool
„„ 
CanSave
„„ 
(
„„ 
)
„„ 
{
‰‰ 	
return
ÂÂ 
_filteredLoads
ÂÂ !
.
ÂÂ! "
Count
ÂÂ" '
>
ÂÂ( )
$num
ÂÂ* +
||
ÂÂ, .
_deletedLoads
ÂÂ/ <
.
ÂÂ< =
Count
ÂÂ= B
>
ÂÂC D
$num
ÂÂE F
;
ÂÂF G
}
ÊÊ 	
[
ÎÎ 	
RelayCommand
ÎÎ	 
]
ÎÎ 
private
ÏÏ 
async
ÏÏ 
Task
ÏÏ (
ReturnToModeSelectionAsync
ÏÏ 5
(
ÏÏ5 6
)
ÏÏ6 7
{
ÌÌ 	
var
ÓÓ 
xamlRoot
ÓÓ 
=
ÓÓ 
_windowService
ÓÓ )
.
ÓÓ) *
GetXamlRoot
ÓÓ* 5
(
ÓÓ5 6
)
ÓÓ6 7
;
ÓÓ7 8
if
ÔÔ 
(
ÔÔ 
xamlRoot
ÔÔ 
==
ÔÔ 
null
ÔÔ  
)
ÔÔ  !
{
 
_logger
ÒÒ 
.
ÒÒ 
LogError
ÒÒ  
(
ÒÒ  !
$str
ÒÒ! G
)
ÒÒG H
;
ÒÒH I
await
ÚÚ 
_errorHandler
ÚÚ #
.
ÚÚ# $
HandleErrorAsync
ÚÚ$ 4
(
ÚÚ4 5
$str
ÚÚ5 O
,
ÚÚO P 
Enum_ErrorSeverity
ÚÚQ c
.
ÚÚc d
Error
ÚÚd i
)
ÚÚi j
;
ÚÚj k
return
ÛÛ 
;
ÛÛ 
}
ÙÙ 
var
ˆˆ 
dialog
ˆˆ 
=
ˆˆ 
new
ˆˆ 
	Microsoft
ˆˆ &
.
ˆˆ& '
UI
ˆˆ' )
.
ˆˆ) *
Xaml
ˆˆ* .
.
ˆˆ. /
Controls
ˆˆ/ 7
.
ˆˆ7 8
ContentDialog
ˆˆ8 E
{
˜˜ 
Title
¯¯ 
=
¯¯ 
$str
¯¯ &
,
¯¯& '
Content
˘˘ 
=
˘˘ 
$str˘˘ Ö
,˘˘Ö Ü
PrimaryButtonText
˙˙ !
=
˙˙" #
$str
˙˙$ 6
,
˙˙6 7
CloseButtonText
˚˚ 
=
˚˚  !
$str
˚˚" *
,
˚˚* +
DefaultButton
¸¸ 
=
¸¸ 
	Microsoft
¸¸  )
.
¸¸) *
UI
¸¸* ,
.
¸¸, -
Xaml
¸¸- 1
.
¸¸1 2
Controls
¸¸2 :
.
¸¸: ;!
ContentDialogButton
¸¸; N
.
¸¸N O
Close
¸¸O T
,
¸¸T U
XamlRoot
˝˝ 
=
˝˝ 
xamlRoot
˝˝ #
}
˛˛ 
;
˛˛ 
var
ÄÄ 
result
ÄÄ 
=
ÄÄ 
await
ÄÄ 
dialog
ÄÄ %
.
ÄÄ% &
	ShowAsync
ÄÄ& /
(
ÄÄ/ 0
)
ÄÄ0 1
.
ÄÄ1 2
AsTask
ÄÄ2 8
(
ÄÄ8 9
)
ÄÄ9 :
;
ÄÄ: ;
if
ÅÅ 
(
ÅÅ 
result
ÅÅ 
==
ÅÅ 
	Microsoft
ÅÅ #
.
ÅÅ# $
UI
ÅÅ$ &
.
ÅÅ& '
Xaml
ÅÅ' +
.
ÅÅ+ ,
Controls
ÅÅ, 4
.
ÅÅ4 5!
ContentDialogResult
ÅÅ5 H
.
ÅÅH I
Primary
ÅÅI P
)
ÅÅP Q
{
ÇÇ 
try
ÉÉ 
{
ÑÑ 
_logger
ÖÖ 
.
ÖÖ 
LogInfo
ÖÖ #
(
ÖÖ# $
$str
ÖÖ$ a
)
ÖÖa b
;
ÖÖb c
await
ÜÜ 
_workflowService
ÜÜ *
.
ÜÜ* + 
ResetWorkflowAsync
ÜÜ+ =
(
ÜÜ= >
)
ÜÜ> ?
;
ÜÜ? @
_workflowService
áá $
.
áá$ %
GoToStep
áá% -
(
áá- .
WorkflowStep
áá. :
.
áá: ;
ModeSelection
áá; H
)
ááH I
;
ááI J
}
àà 
catch
ââ 
(
ââ 
	Exception
ââ  
ex
ââ! #
)
ââ# $
{
ää 
_logger
ãã 
.
ãã 
LogError
ãã $
(
ãã$ %
$"
ãã% '
$str
ãã' A
{
ããA B
ex
ããB D
.
ããD E
Message
ããE L
}
ããL M
"
ããM N
)
ããN O
;
ããO P
await
åå 
_errorHandler
åå '
.
åå' (
HandleErrorAsync
åå( 8
(
åå8 9
$str
åå9 ]
,
åå] ^ 
Enum_ErrorSeverity
åå_ q
.
ååq r
Error
åår w
,
ååw x
ex
ååy {
)
åå{ |
;
åå| }
}
çç 
}
éé 
else
èè 
{
êê 
_logger
ëë 
.
ëë 
LogInfo
ëë 
(
ëë  
$str
ëë  I
)
ëëI J
;
ëëJ K
}
íí 
}
ìì 	
private
òò 
System
òò 
.
òò 
Collections
òò "
.
òò" #
Generic
òò# *
.
òò* +
List
òò+ /
<
òò/ 0
string
òò0 6
>
òò6 7
ValidateLoads
òò8 E
(
òòE F
IEnumerable
òòF Q
<
òòQ R!
Model_ReceivingLoad
òòR e
>
òòe f
loadsToValidate
òòg v
)
òòv w
{
ôô 	
var
öö 
errors
öö 
=
öö 
new
öö 
System
öö #
.
öö# $
Collections
öö$ /
.
öö/ 0
Generic
öö0 7
.
öö7 8
List
öö8 <
<
öö< =
string
öö= C
>
ööC D
(
ööD E
)
ööE F
;
ööF G
if
úú 
(
úú 
!
úú 
loadsToValidate
úú  
.
úú  !
Any
úú! $
(
úú$ %
)
úú% &
&&
úú' )
_deletedLoads
úú* 7
.
úú7 8
Count
úú8 =
==
úú> @
$num
úúA B
)
úúB C
{
ùù 
errors
ûû 
.
ûû 
Add
ûû 
(
ûû 
$str
ûû -
)
ûû- .
;
ûû. /
return
üü 
errors
üü 
;
üü 
}
†† 
foreach
¢¢ 
(
¢¢ 
var
¢¢ 
load
¢¢ 
in
¢¢  
loadsToValidate
¢¢! 0
)
¢¢0 1
{
££ 
if
§§ 
(
§§ 
string
§§ 
.
§§  
IsNullOrWhiteSpace
§§ -
(
§§- .
load
§§. 2
.
§§2 3
PartID
§§3 9
)
§§9 :
)
§§: ;
{
•• 
errors
¶¶ 
.
¶¶ 
Add
¶¶ 
(
¶¶ 
$"
¶¶ !
$str
¶¶! '
{
¶¶' (
load
¶¶( ,
.
¶¶, -

LoadNumber
¶¶- 7
}
¶¶7 8
$str
¶¶8 M
"
¶¶M N
)
¶¶N O
;
¶¶O P
}
ßß 
if
©© 
(
©© 
load
©© 
.
©© 
WeightQuantity
©© '
<=
©©( *
$num
©©+ ,
)
©©, -
{
™™ 
errors
´´ 
.
´´ 
Add
´´ 
(
´´ 
$"
´´ !
$str
´´! '
{
´´' (
load
´´( ,
.
´´, -

LoadNumber
´´- 7
}
´´7 8
$str
´´8 c
"
´´c d
)
´´d e
;
´´e f
}
¨¨ 
if
ÆÆ 
(
ÆÆ 
load
ÆÆ 
.
ÆÆ 
PackagesPerLoad
ÆÆ (
<=
ÆÆ) +
$num
ÆÆ, -
)
ÆÆ- .
{
ØØ 
errors
∞∞ 
.
∞∞ 
Add
∞∞ 
(
∞∞ 
$"
∞∞ !
$str
∞∞! '
{
∞∞' (
load
∞∞( ,
.
∞∞, -

LoadNumber
∞∞- 7
}
∞∞7 8
$str
∞∞8 e
"
∞∞e f
)
∞∞f g
;
∞∞g h
}
±± 
}
≤≤ 
return
¥¥ 
errors
¥¥ 
;
¥¥ 
}
µµ 	
}
∂∂ 
}∑∑ «
kC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Main\Main_CarrierDeliveryLabelViewModel.cs
	namespace

 	%
MTM_Receiving_Application


 #
.

# $

ViewModels

$ .
.

. /
Main

/ 3
;

3 4
public 
partial 
class .
"Main_CarrierDeliveryLabelViewModel 7
:8 9 
Shared_BaseViewModel: N
{ 
public 
.
"Main_CarrierDeliveryLabelViewModel -
(- .!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
: 	
base
 
( 
errorHandler 
, 
logger #
)# $
{ !
CarrierDeliveryLabels 
= 
new  # 
ObservableCollection$ 8
<8 9&
Model_CarrierDeliveryLabel9 S
>S T
(T U
)U V
;V W
_currentLabel 
= 
new &
Model_CarrierDeliveryLabel 6
(6 7
)7 8
;8 9
} 
public 
 
ObservableCollection 
<  &
Model_CarrierDeliveryLabel  :
>: ;!
CarrierDeliveryLabels< Q
{R S
getT W
;W X
}Y Z
[ 
ObservableProperty 
] 
private &
Model_CarrierDeliveryLabel &
_currentLabel' 4
;4 5
[ 
RelayCommand 
] 
private   
async   
Task   
AddLabelAsync   $
(  $ %
)  % &
{!! 
await## 
Task## 
.## 
CompletedTask##  
;##  !
}$$ 
}%% ˚
fC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Helpers\SpecInputViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Dunnage/ 6
.6 7
Helpers7 >
;> ?
public		 
partial		 
class		 
SpecInputViewModel		 '
:		( )
ObservableObject		* :
{

 
[ 
ObservableProperty 
] 
private 
string 
	_specName 
= 
string %
.% &
Empty& +
;+ ,
[ 
ObservableProperty 
] 
private 
string 
	_dataType 
= 
string %
.% &
Empty& +
;+ ,
[ 
ObservableProperty 
] 
private 
object 
? 
_value 
; 
[ 
ObservableProperty 
] 
private 
string 
_unit 
= 
string !
.! "
Empty" '
;' (
[ 
ObservableProperty 
] 
private 
bool 
_isRequired 
; 
[ 
ObservableProperty 
] 
private 
object 
? 
_defaultValue !
;! "
} ·¢
jC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Dunnage_TypeSelectionViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Dunnage/ 6
;6 7
public 
partial 
class *
Dunnage_TypeSelectionViewModel 3
:4 5 
Shared_BaseViewModel6 J
{ 
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
private 
readonly "
IService_MySQL_Dunnage +
_dunnageService, ;
;; <
private 
readonly 
IService_Pagination (
_paginationService) ;
;; <
public 
*
Dunnage_TypeSelectionViewModel )
() *$
IService_DunnageWorkflow  
workflowService! 0
,0 1"
IService_MySQL_Dunnage 
dunnageService -
,- .
IService_Pagination 
paginationService -
,- .!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
:( )
base* .
(. /
errorHandler/ ;
,; <
logger= C
)C D
{ 
_workflowService 
= 
workflowService *
;* +
_dunnageService 
= 
dunnageService (
;( )
_paginationService   
=   
paginationService   .
;  . /
_paginationService## 
.## 
PageChanged## &
+=##' )
OnPageChanged##* 7
;##7 8
}$$ 
[(( 
ObservableProperty(( 
](( 
private))  
ObservableCollection))  
<))  !
Model_DunnageType))! 2
>))2 3
_displayedTypes))4 C
=))D E
new))F I
())I J
)))J K
;))K L
[++ 
ObservableProperty++ 
]++ 
private,, 
Model_DunnageType,, 
?,, 
_selectedType,, ,
;,,, -
[.. 
ObservableProperty.. 
].. 
private// 
int// 
_currentPage// 
=// 
$num//  
;//  !
[11 
ObservableProperty11 
]11 
private22 
int22 
_totalPages22 
=22 
$num22 
;22  
[44 
ObservableProperty44 
]44 
private55 
bool55 

_canGoNext55 
;55 
[77 
ObservableProperty77 
]77 
private88 
bool88 
_canGoPrevious88 
;88  
[:: 
ObservableProperty:: 
]:: 
private;; 
string;; 
	_pageInfo;; 
=;; 
$str;; ,
;;;, -
publicDD 

asyncDD 
TaskDD 
InitializeAsyncDD %
(DD% &
)DD& '
{EE 
_loggerFF 
.FF 
LogInfoFF 
(FF 
$strFF ?
,FF? @
$strFFA a
)FFa b
;FFb c
ifHH 

(HH 
IsBusyHH 
)HH 
{II 	
_loggerJJ 
.JJ 
LogInfoJJ 
(JJ 
$strJJ D
,JJD E
$strJJF f
)JJf g
;JJg h
returnKK 
;KK 
}LL 	
tryNN 
{OO 	
IsBusyPP 
=PP 
truePP 
;PP 
StatusMessageQQ 
=QQ 
$strQQ 6
;QQ6 7
_loggerRR 
.RR 
LogInfoRR 
(RR 
$strRR C
,RRC D
$strRRE e
)RRe f
;RRf g
awaitTT 
LoadTypesAsyncTT  
(TT  !
)TT! "
;TT" #
StatusMessageVV 
=VV 
$"VV 
$strVV %
{VV% &
_paginationServiceVV& 8
.VV8 9

TotalItemsVV9 C
}VVC D
$strVVD R
"VVR S
;VVS T
}WW 	
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX 
{YY 	
_errorHandlerZZ 
.ZZ 
HandleErrorAsyncZZ *
(ZZ* +
$str[[ .
,[[. /
Enum_ErrorSeverity\\ "
.\\" #
Error\\# (
,\\( )
ex]] 
,]] 
true^^ 
)__ 
.__ 
Wait__ 
(__ 
)__ 
;__ 
StatusMessage`` 
=`` 
$str`` 1
;``1 2
}aa 	
finallybb 
{cc 	
IsBusydd 
=dd 
falsedd 
;dd 
}ee 	
}ff 
[ll 
RelayCommandll 
]ll 
privatemm 
asyncmm 
Taskmm 
LoadTypesAsyncmm %
(mm% &
)mm& '
{nn 
_loggeroo 
.oo 
LogInfooo 
(oo 
$stroo >
,oo> ?
$stroo@ `
)oo` a
;ooa b
tryqq 
{rr 	
_loggerss 
.ss 
LogInfoss 
(ss 
$strss O
,ssO P
$strssQ q
)ssq r
;ssr s
varuu 
resultuu 
=uu 
awaituu 
_dunnageServiceuu .
.uu. /
GetAllTypesAsyncuu/ ?
(uu? @
)uu@ A
;uuA B
_loggerww 
.ww 
LogInfoww 
(ww 
$"ww 
$strww K
{wwK L
resultwwL R
.wwR S
	IsSuccesswwS \
}ww\ ]
$strww] j
{wwj k
resultwwk q
.wwq r
Datawwr v
==www y
nullwwz ~
}ww~ 
$str	ww à
{
wwà â
result
wwâ è
.
wwè ê
Data
wwê î
?
wwî ï
.
wwï ñ
Count
wwñ õ
??
wwú û
$num
wwü †
}
ww† °
"
ww° ¢
,
ww¢ £
$str
ww§ ƒ
)
wwƒ ≈
;
ww≈ ∆
ifyy 
(yy 
resultyy 
.yy 
	IsSuccessyy  
&&yy! #
resultyy$ *
.yy* +
Datayy+ /
!=yy0 2
nullyy3 7
)yy7 8
{zz 
_paginationService|| "
.||" #
PageSize||# +
=||, -
$num||. /
;||/ 0
_paginationService}} "
.}}" #
	SetSource}}# ,
(}}, -
result}}- 3
.}}3 4
Data}}4 8
)}}8 9
;}}9 :
_logger~~ 
.~~ 
LogInfo~~ 
(~~  
$"~~  "
$str~~" c
{~~c d
result~~d j
.~~j k
Data~~k o
.~~o p
Count~~p u
}~~u v
"~~v w
,~~w x
$str	~~y ô
)
~~ô ö
;
~~ö õ(
UpdatePaginationProperties
ÄÄ *
(
ÄÄ* +
)
ÄÄ+ ,
;
ÄÄ, -
UpdatePageDisplay
ÅÅ !
(
ÅÅ! "
)
ÅÅ" #
;
ÅÅ# $
_logger
ÉÉ 
.
ÉÉ 
LogInfo
ÉÉ 
(
ÉÉ  
$"
ÉÉ  "
$str
ÉÉ" E
{
ÉÉE F
result
ÉÉF L
.
ÉÉL M
Data
ÉÉM Q
.
ÉÉQ R
Count
ÉÉR W
}
ÉÉW X
$str
ÉÉX l
{
ÉÉl m

TotalPages
ÉÉm w
}
ÉÉw x
$strÉÉx ï
{ÉÉï ñ
DisplayedTypesÉÉñ §
.ÉÉ§ •
CountÉÉ• ™
}ÉÉ™ ´
"ÉÉ´ ¨
,ÉÉ¨ ≠
$strÉÉÆ Œ
)ÉÉŒ œ
;ÉÉœ –
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 
await
áá 
_errorHandler
áá #
.
áá# $!
HandleDaoErrorAsync
áá$ 7
(
áá7 8
result
àà 
,
àà 
nameof
ââ 
(
ââ 
LoadTypesAsync
ââ )
)
ââ) *
,
ââ* +
true
ää 
)
ãã 
;
ãã 
}
åå 
}
çç 	
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé 
{
èè 	
await
êê 
_errorHandler
êê 
.
êê  
HandleErrorAsync
êê  0
(
êê0 1
$str
ëë -
,
ëë- . 
Enum_ErrorSeverity
íí "
.
íí" #
Error
íí# (
,
íí( )
ex
ìì 
,
ìì 
true
îî 
)
ïï 
;
ïï 
}
ññ 	
}
óó 
[
ùù 
RelayCommand
ùù 
(
ùù 

CanExecute
ùù 
=
ùù 
nameof
ùù %
(
ùù% &
	CanGoNext
ùù& /
)
ùù/ 0
)
ùù0 1
]
ùù1 2
private
ûû 
void
ûû 
NextPage
ûû 
(
ûû 
)
ûû 
{
üü  
_paginationService
†† 
.
†† 
NextPage
†† #
(
††# $
)
††$ %
;
††% &
}
°° 
[
££ 
RelayCommand
££ 
(
££ 

CanExecute
££ 
=
££ 
nameof
££ %
(
££% &
CanGoPrevious
££& 3
)
££3 4
)
££4 5
]
££5 6
private
§§ 
void
§§ 
PreviousPage
§§ 
(
§§ 
)
§§ 
{
••  
_paginationService
¶¶ 
.
¶¶ 
PreviousPage
¶¶ '
(
¶¶' (
)
¶¶( )
;
¶¶) *
}
ßß 
[
©© 
RelayCommand
©© 
]
©© 
private
™™ 
void
™™ 
	FirstPage
™™ 
(
™™ 
)
™™ 
{
´´  
_paginationService
¨¨ 
.
¨¨ 
	FirstPage
¨¨ $
(
¨¨$ %
)
¨¨% &
;
¨¨& '
}
≠≠ 
[
ØØ 
RelayCommand
ØØ 
]
ØØ 
private
∞∞ 
void
∞∞ 
LastPage
∞∞ 
(
∞∞ 
)
∞∞ 
{
±±  
_paginationService
≤≤ 
.
≤≤ 
LastPage
≤≤ #
(
≤≤# $
)
≤≤$ %
;
≤≤% &
}
≥≥ 
[
ππ 
RelayCommand
ππ 
]
ππ 
private
∫∫ 
async
∫∫ 
Task
∫∫ 
SelectTypeAsync
∫∫ &
(
∫∫& '
Model_DunnageType
∫∫' 8
?
∫∫8 9
type
∫∫: >
)
∫∫> ?
{
ªª 
if
ºº 

(
ºº 
type
ºº 
==
ºº 
null
ºº 
||
ºº 
IsBusy
ºº "
)
ºº" #
return
ºº$ *
;
ºº* +
try
ææ 
{
øø 	
IsBusy
¿¿ 
=
¿¿ 
true
¿¿ 
;
¿¿ 
SelectedType
¡¡ 
=
¡¡ 
type
¡¡ 
;
¡¡  
_logger
√√ 
.
√√ 
LogInfo
√√ 
(
√√ 
$"
√√ 
$str
√√ 5
{
√√5 6
type
√√6 :
.
√√: ;
TypeName
√√; C
}
√√C D
$str
√√D J
{
√√J K
type
√√K O
.
√√O P
Id
√√P R
}
√√R S
$str
√√S T
"
√√T U
)
√√U V
;
√√V W
_workflowService
∆∆ 
.
∆∆ 
CurrentSession
∆∆ +
.
∆∆+ ,
SelectedTypeId
∆∆, :
=
∆∆; <
type
∆∆= A
.
∆∆A B
Id
∆∆B D
;
∆∆D E
_workflowService
«« 
.
«« 
CurrentSession
«« +
.
««+ ,
SelectedTypeName
««, <
=
««= >
type
««? C
.
««C D
TypeName
««D L
;
««L M
_workflowService
   
.
   
GoToStep
   %
(
  % &&
Enum_DunnageWorkflowStep
  & >
.
  > ?
PartSelection
  ? L
)
  L M
;
  M N
}
ÀÀ 	
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ 
{
ÕÕ 	
await
ŒŒ 
_errorHandler
ŒŒ 
.
ŒŒ  
HandleErrorAsync
ŒŒ  0
(
ŒŒ0 1
$str
œœ .
,
œœ. / 
Enum_ErrorSeverity
–– "
.
––" #
Error
––# (
,
––( )
ex
—— 
,
—— 
true
““ 
)
”” 
;
”” 
}
‘‘ 	
finally
’’ 
{
÷÷ 	
IsBusy
◊◊ 
=
◊◊ 
false
◊◊ 
;
◊◊ 
}
ÿÿ 	
}
ŸŸ 
[
€€ 
RelayCommand
€€ 
]
€€ 
private
‹‹ 
async
‹‹ 
Task
‹‹ 
QuickAddTypeAsync
‹‹ (
(
‹‹( )
)
‹‹) *
{
›› 
try
ﬁﬁ 
{
ﬂﬂ 	
_logger
‡‡ 
.
‡‡ 
LogInfo
‡‡ 
(
‡‡ 
$str
‡‡ 6
,
‡‡6 7
$str
‡‡8 G
)
‡‡G H
;
‡‡H I
var
„„ 
dialog
„„ 
=
„„ 
new
„„ 
Views
„„ "
.
„„" #
Dunnage
„„# *
.
„„* +(
Dunnage_QuickAddTypeDialog
„„+ E
{
‰‰ 
XamlRoot
ÂÂ 
=
ÂÂ 
App
ÂÂ 
.
ÂÂ 

MainWindow
ÂÂ )
?
ÂÂ) *
.
ÂÂ* +
Content
ÂÂ+ 2
?
ÂÂ2 3
.
ÂÂ3 4
XamlRoot
ÂÂ4 <
}
ÊÊ 
;
ÊÊ 
if
ËË 
(
ËË 
dialog
ËË 
.
ËË 
XamlRoot
ËË 
==
ËË  "
null
ËË# '
)
ËË' (
{
ÈÈ 
_logger
ÍÍ 
.
ÍÍ 
LogInfo
ÍÍ 
(
ÍÍ  
$str
ÍÍ  F
,
ÍÍF G
$str
ÍÍH W
)
ÍÍW X
;
ÍÍX Y
return
ÎÎ 
;
ÎÎ 
}
ÏÏ 
var
ÓÓ 
result
ÓÓ 
=
ÓÓ 
await
ÓÓ 
dialog
ÓÓ %
.
ÓÓ% &
	ShowAsync
ÓÓ& /
(
ÓÓ/ 0
)
ÓÓ0 1
;
ÓÓ1 2
if
 
(
 
result
 
==
 
	Microsoft
 #
.
# $
UI
$ &
.
& '
Xaml
' +
.
+ ,
Controls
, 4
.
4 5!
ContentDialogResult
5 H
.
H I
Primary
I P
)
P Q
{
ÒÒ 
var
ÚÚ 
typeName
ÚÚ 
=
ÚÚ 
dialog
ÚÚ %
.
ÚÚ% &
TypeName
ÚÚ& .
;
ÚÚ. /
var
ÛÛ 
	iconGlyph
ÛÛ 
=
ÛÛ 
dialog
ÛÛ  &
.
ÛÛ& '
SelectedIconGlyph
ÛÛ' 8
;
ÛÛ8 9
_logger
ıı 
.
ıı 
LogInfo
ıı 
(
ıı  
$"
ıı  "
$str
ıı" 3
{
ıı3 4
typeName
ıı4 <
}
ıı< =
$str
ıı= H
{
ııH I
	iconGlyph
ııI R
}
ııR S
"
ııS T
,
ııT U
$str
ııV e
)
ııe f
;
ııf g
var
¯¯ 
newType
¯¯ 
=
¯¯ 
new
¯¯ !
Model_DunnageType
¯¯" 3
{
˘˘ 
TypeName
˙˙ 
=
˙˙ 
typeName
˙˙ '
}
¸¸ 
;
¸¸ 
var
˛˛ 
insertResult
˛˛  
=
˛˛! "
await
˛˛# (
_dunnageService
˛˛) 8
.
˛˛8 9
InsertTypeAsync
˛˛9 H
(
˛˛H I
newType
˛˛I P
)
˛˛P Q
;
˛˛Q R
if
ÄÄ 
(
ÄÄ 
insertResult
ÄÄ  
.
ÄÄ  !
	IsSuccess
ÄÄ! *
)
ÄÄ* +
{
ÅÅ 
_logger
ÇÇ 
.
ÇÇ 
LogInfo
ÇÇ #
(
ÇÇ# $
$"
ÇÇ$ &
$str
ÇÇ& ?
{
ÇÇ? @
typeName
ÇÇ@ H
}
ÇÇH I
"
ÇÇI J
,
ÇÇJ K
$str
ÇÇL [
)
ÇÇ[ \
;
ÇÇ\ ]
await
ÖÖ 
LoadTypesAsync
ÖÖ (
(
ÖÖ( )
)
ÖÖ) *
;
ÖÖ* +
StatusMessage
áá !
=
áá" #
$"
áá$ &
$str
áá& 6
{
áá6 7
typeName
áá7 ?
}
áá? @
"
áá@ A
;
ááA B
}
àà 
else
ââ 
{
ää 
await
ãã 
_errorHandler
ãã '
.
ãã' (!
HandleDaoErrorAsync
ãã( ;
(
ãã; <
insertResult
åå $
,
åå$ %
nameof
çç 
(
çç 
QuickAddTypeAsync
çç 0
)
çç0 1
,
çç1 2
true
éé 
)
èè 
;
èè 
}
êê 
}
ëë 
}
íí 	
catch
ìì 
(
ìì 
	Exception
ìì 
ex
ìì 
)
ìì 
{
îî 	
await
ïï 
_errorHandler
ïï 
.
ïï  
HandleErrorAsync
ïï  0
(
ïï0 1
$str
ññ /
,
ññ/ 0 
Enum_ErrorSeverity
óó "
.
óó" #
Error
óó# (
,
óó( )
ex
òò 
,
òò 
true
ôô 
)
öö 
;
öö 
}
õõ 	
}
úú 
private
¢¢ 
void
¢¢ 
OnPageChanged
¢¢ 
(
¢¢ 
object
¢¢ %
?
¢¢% &
sender
¢¢' -
,
¢¢- .
	EventArgs
¢¢/ 8
e
¢¢9 :
)
¢¢: ;
{
££ (
UpdatePaginationProperties
§§ "
(
§§" #
)
§§# $
;
§§$ %
UpdatePageDisplay
•• 
(
•• 
)
•• 
;
•• 
}
¶¶ 
private
®® 
void
®® (
UpdatePaginationProperties
®® +
(
®®+ ,
)
®®, -
{
©© 
CurrentPage
™™ 
=
™™  
_paginationService
™™ (
.
™™( )
CurrentPage
™™) 4
;
™™4 5

TotalPages
´´ 
=
´´  
_paginationService
´´ '
.
´´' (

TotalPages
´´( 2
;
´´2 3
	CanGoNext
¨¨ 
=
¨¨  
_paginationService
¨¨ &
.
¨¨& '
HasNextPage
¨¨' 2
;
¨¨2 3
CanGoPrevious
≠≠ 
=
≠≠  
_paginationService
≠≠ *
.
≠≠* +
HasPreviousPage
≠≠+ :
;
≠≠: ;
PageInfo
ÆÆ 
=
ÆÆ 
$"
ÆÆ 
$str
ÆÆ 
{
ÆÆ 
CurrentPage
ÆÆ &
}
ÆÆ& '
$str
ÆÆ' +
{
ÆÆ+ ,

TotalPages
ÆÆ, 6
}
ÆÆ6 7
"
ÆÆ7 8
;
ÆÆ8 9
NextPageCommand
±± 
.
±± %
NotifyCanExecuteChanged
±± /
(
±±/ 0
)
±±0 1
;
±±1 2!
PreviousPageCommand
≤≤ 
.
≤≤ %
NotifyCanExecuteChanged
≤≤ 3
(
≤≤3 4
)
≤≤4 5
;
≤≤5 6
}
≥≥ 
private
µµ 
void
µµ 
UpdatePageDisplay
µµ "
(
µµ" #
)
µµ# $
{
∂∂ 
var
∑∑ 
currentItems
∑∑ 
=
∑∑  
_paginationService
∑∑ -
.
∑∑- .!
GetCurrentPageItems
∑∑. A
<
∑∑A B
Model_DunnageType
∑∑B S
>
∑∑S T
(
∑∑T U
)
∑∑U V
;
∑∑V W
_logger
∏∏ 
.
∏∏ 
LogInfo
∏∏ 
(
∏∏ 
$"
∏∏ 
$str
∏∏ A
{
∏∏A B
currentItems
∏∏B N
.
∏∏N O
Count
∏∏O T
(
∏∏T U
)
∏∏U V
}
∏∏V W
$str
∏∏W u
"
∏∏u v
,
∏∏v w
$str∏∏x ò
)∏∏ò ô
;∏∏ô ö
DisplayedTypes
∫∫ 
.
∫∫ 
Clear
∫∫ 
(
∫∫ 
)
∫∫ 
;
∫∫ 
foreach
ªª 
(
ªª 
var
ªª 
type
ªª 
in
ªª 
currentItems
ªª )
)
ªª) *
{
ºº 	
DisplayedTypes
ΩΩ 
.
ΩΩ 
Add
ΩΩ 
(
ΩΩ 
type
ΩΩ #
)
ΩΩ# $
;
ΩΩ$ %
_logger
ææ 
.
ææ 
LogInfo
ææ 
(
ææ 
$"
ææ 
$str
ææ P
{
ææP Q
type
ææQ U
.
ææU V
Id
ææV X
}
ææX Y
$str
ææY a
{
ææa b
type
ææb f
.
ææf g
TypeName
ææg o
}
ææo p
"
ææp q
,
ææq r
$strææs ì
)ææì î
;ææî ï
}
øø 	
_logger
¡¡ 
.
¡¡ 
LogInfo
¡¡ 
(
¡¡ 
$"
¡¡ 
$str
¡¡ L
{
¡¡L M
DisplayedTypes
¡¡M [
.
¡¡[ \
Count
¡¡\ a
}
¡¡a b
"
¡¡b c
,
¡¡c d
$str¡¡e Ö
)¡¡Ö Ü
;¡¡Ü á
}
¬¬ 
}≈≈ éI
eC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Main\Main_ReceivingLabelViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Main/ 3
;3 4
public 
partial 
class (
Main_ReceivingLabelViewModel 1
:2 3 
Shared_BaseViewModel4 H
{ 
private 
readonly (
IService_MySQL_ReceivingLine 1!
_receivingLineService2 G
;G H
public 
(
Main_ReceivingLabelViewModel '
(' ((
IService_MySQL_ReceivingLine $ 
receivingLineService% 9
,9 :!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
: 	
base
 
( 
errorHandler 
, 
logger #
)# $
{ !
_receivingLineService 
=  
receivingLineService  4
;4 5
ReceivingLines 
= 
new  
ObservableCollection 1
<1 2
Model_ReceivingLine2 E
>E F
(F G
)G H
;H I
} 
public!! 
 
ObservableCollection!! 
<!!  
Model_ReceivingLine!!  3
>!!3 4
ReceivingLines!!5 C
{!!D E
get!!F I
;!!I J
}!!K L
[## 
ObservableProperty## 
]## 
private$$ 
Model_ReceivingLine$$ 
_currentLine$$  ,
=$$- .
new$$/ 2
Model_ReceivingLine$$3 F
($$F G
)$$G H
;$$H I
[&& 
ObservableProperty&& 
]&& 
private'' 
int'' 

_totalRows'' 
;'' 
[)) 
ObservableProperty)) 
])) 
private** 
int** 
_employeeNumber** 
=**  !
$num**" &
;**& '
[// 
RelayCommand// 
]// 
private00 
async00 
Task00 
AddLineAsync00 #
(00# $
)00$ %
{11 
if22 

(22 
IsBusy22 
)22 
return22 
;22 
try44 
{55 	
IsBusy66 
=66 
true66 
;66 
StatusMessage77 
=77 
$str77 6
;776 7
if:: 
(:: 
string:: 
.:: 
IsNullOrEmpty:: $
(::$ %
CurrentLine::% 0
.::0 1
PartID::1 7
)::7 8
)::8 9
{;; 
await<< 
_errorHandler<< #
.<<# $
HandleErrorAsync<<$ 4
(<<4 5
$str== )
,==) *
Models>> 
.>> 
Enums>>  
.>>  !
Enum_ErrorSeverity>>! 3
.>>3 4
Warning>>4 ;
,>>; <

showDialog?? 
:?? 
true??  $
)@@ 
;@@ 
returnAA 
;AA 
}BB 
CurrentLineEE 
.EE 
EmployeeNumberEE &
=EE' (
EmployeeNumberEE) 7
;EE7 8
varHH 
resultHH 
=HH 
awaitHH !
_receivingLineServiceHH 4
.HH4 5$
InsertReceivingLineAsyncHH5 M
(HHM N
CurrentLineHHN Y
)HHY Z
;HHZ [
ifJJ 
(JJ 
resultJJ 
.JJ 
	IsSuccessJJ  
)JJ  !
{KK 
ReceivingLinesLL 
.LL 
AddLL "
(LL" #
CurrentLineLL# .
)LL. /
;LL/ 0
	TotalRowsMM 
=MM 
ReceivingLinesMM *
.MM* +
CountMM+ 0
;MM0 1
CurrentLineOO 
=OO 
newOO !
Model_ReceivingLineOO" 5
(OO5 6
)OO6 7
;OO7 8
OnPropertyChangedPP !
(PP! "
nameofPP" (
(PP( )
CurrentLinePP) 4
)PP4 5
)PP5 6
;PP6 7
StatusMessageQQ 
=QQ 
$strQQ  9
;QQ9 :
}RR 
elseSS 
{TT 
awaitUU 
_errorHandlerUU #
.UU# $
HandleErrorAsyncUU$ 4
(UU4 5
resultVV 
.VV 
ErrorMessageVV '
,VV' (
resultWW 
.WW 
SeverityWW #
,WW# $

showDialogXX 
:XX 
trueXX  $
)YY 
;YY 
}ZZ 
}[[ 	
catch\\ 
(\\ 
	Exception\\ 
ex\\ 
)\\ 
{]] 	
await^^ 
_errorHandler^^ 
.^^  
HandleErrorAsync^^  0
(^^0 1
$"__ 
$str__ /
{__/ 0
ex__0 2
.__2 3
Message__3 :
}__: ;
"__; <
,__< =
Models`` 
.`` 
Enums`` 
.`` 
Enum_ErrorSeverity`` /
.``/ 0
Error``0 5
,``5 6
exaa 
,aa 

showDialogbb 
:bb 
truebb  
)cc 
;cc 
}dd 	
finallyee 
{ff 	
IsBusygg 
=gg 
falsegg 
;gg 
}hh 	
}ii 
[nn 
RelayCommandnn 
]nn 
privateoo 
asyncoo 
Taskoo 
SaveToHistoryAsyncoo )
(oo) *
)oo* +
{pp 
ifqq 

(qq 
IsBusyqq 
)qq 
returnqq 
;qq 
tryss 
{tt 	
IsBusyuu 
=uu 
trueuu 
;uu 
StatusMessagevv 
=vv 
$strvv 2
;vv2 3
awaityy 
Taskyy 
.yy 
Delayyy 
(yy 
$numyy  
)yy  !
;yy! "
ReceivingLines{{ 
.{{ 
Clear{{  
({{  !
){{! "
;{{" #
	TotalRows|| 
=|| 
$num|| 
;|| 
StatusMessage}} 
=}} 
$str}} .
;}}. /
}~~ 	
catch 
( 
	Exception 
ex 
) 
{
ÄÄ 	
await
ÅÅ 
_errorHandler
ÅÅ 
.
ÅÅ  
HandleErrorAsync
ÅÅ  0
(
ÅÅ0 1
$"
ÇÇ 
$str
ÇÇ +
{
ÇÇ+ ,
ex
ÇÇ, .
.
ÇÇ. /
Message
ÇÇ/ 6
}
ÇÇ6 7
"
ÇÇ7 8
,
ÇÇ8 9
Models
ÉÉ 
.
ÉÉ 
Enums
ÉÉ 
.
ÉÉ  
Enum_ErrorSeverity
ÉÉ /
.
ÉÉ/ 0
Error
ÉÉ0 5
,
ÉÉ5 6
ex
ÑÑ 
,
ÑÑ 

showDialog
ÖÖ 
:
ÖÖ 
true
ÖÖ  
)
ÜÜ 
;
ÜÜ 
}
áá 	
finally
àà 
{
ââ 	
IsBusy
ää 
=
ää 
false
ää 
;
ää 
}
ãã 	
}
åå 
[
ëë 
RelayCommand
ëë 
]
ëë 
private
íí 
async
íí 
Task
íí "
FillBlankSpacesAsync
íí +
(
íí+ ,
)
íí, -
{
ìì 
try
îî 
{
ïï 	
StatusMessage
óó 
=
óó 
$str
óó 1
;
óó1 2
}
òò 	
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô 
{
öö 	
await
õõ 
_errorHandler
õõ 
.
õõ  
HandleErrorAsync
õõ  0
(
õõ0 1
$"
úú 
$str
úú .
{
úú. /
ex
úú/ 1
.
úú1 2
Message
úú2 9
}
úú9 :
"
úú: ;
,
úú; <
Models
ùù 
.
ùù 
Enums
ùù 
.
ùù  
Enum_ErrorSeverity
ùù /
.
ùù/ 0
Warning
ùù0 7
,
ùù7 8
ex
ûû 
,
ûû 

showDialog
üü 
:
üü 
true
üü  
)
†† 
;
†† 
}
°° 	
}
¢¢ 
[
ßß 
RelayCommand
ßß 
]
ßß 
private
®® 
async
®® 
Task
®® "
SortForPrintingAsync
®® +
(
®®+ ,
)
®®, -
{
©© 
try
™™ 
{
´´ 	
StatusMessage
≠≠ 
=
≠≠ 
$str
≠≠ 1
;
≠≠1 2
}
ÆÆ 	
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ 
{
∞∞ 	
await
±± 
_errorHandler
±± 
.
±±  
HandleErrorAsync
±±  0
(
±±0 1
$"
≤≤ 
$str
≤≤ .
{
≤≤. /
ex
≤≤/ 1
.
≤≤1 2
Message
≤≤2 9
}
≤≤9 :
"
≤≤: ;
,
≤≤; <
Models
≥≥ 
.
≥≥ 
Enums
≥≥ 
.
≥≥  
Enum_ErrorSeverity
≥≥ /
.
≥≥/ 0
Warning
≥≥0 7
,
≥≥7 8
ex
¥¥ 
,
¥¥ 

showDialog
µµ 
:
µµ 
true
µµ  
)
∂∂ 
;
∂∂ 
}
∑∑ 	
}
∏∏ 
}ππ ‰I
cC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Dunnage_ReviewViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Dunnage/ 6
;6 7
public 
partial 
class #
Dunnage_ReviewViewModel ,
:- . 
Shared_BaseViewModel/ C
{ 
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
private 
readonly "
IService_MySQL_Dunnage +
_dunnageService, ;
;; <
private 
readonly %
IService_DunnageCSVWriter .

_csvWriter/ 9
;9 :
public 
#
Dunnage_ReviewViewModel "
(" #$
IService_DunnageWorkflow  
workflowService! 0
,0 1"
IService_MySQL_Dunnage 
dunnageService -
,- .%
IService_DunnageCSVWriter !
	csvWriter" +
,+ ,!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
:( )
base* .
(. /
errorHandler/ ;
,; <
logger= C
)C D
{ 
_workflowService 
= 
workflowService *
;* +
_dunnageService 
= 
dunnageService (
;( )

_csvWriter   
=   
	csvWriter   
;   
}!! 
[%% 
ObservableProperty%% 
]%% 
private&&  
ObservableCollection&&  
<&&  !
Model_DunnageLoad&&! 2
>&&2 3
_sessionLoads&&4 A
=&&B C
new&&D G
(&&G H
)&&H I
;&&I J
[(( 
ObservableProperty(( 
](( 
private)) 
int)) 

_loadCount)) 
;)) 
[++ 
ObservableProperty++ 
]++ 
private,, 
bool,, 
_canSave,, 
=,, 
true,,  
;,,  !
[.. 
ObservableProperty.. 
].. 
private// 
bool// $
_isSuccessMessageVisible// )
=//* +
false//, 1
;//1 2
[11 
ObservableProperty11 
]11 
private22 
string22 
_successMessage22 "
=22# $
string22% +
.22+ ,
Empty22, 1
;221 2
public;; 

void;; 
LoadSessionLoads;;  
(;;  !
);;! "
{<< 
try== 
{>> 	
SessionLoads?? 
.?? 
Clear?? 
(?? 
)??  
;??  !
varAA 
loadsAA 
=AA 
_workflowServiceAA (
.AA( )
CurrentSessionAA) 7
.AA7 8
LoadsAA8 =
;AA= >
foreachBB 
(BB 
varBB 
loadBB 
inBB  
loadsBB! &
)BB& '
{CC 
SessionLoadsDD 
.DD 
AddDD  
(DD  !
loadDD! %
)DD% &
;DD& '
}EE 
	LoadCountGG 
=GG 
SessionLoadsGG $
.GG$ %
CountGG% *
;GG* +
CanSaveHH 
=HH 
	LoadCountHH 
>HH  !
$numHH" #
;HH# $
_loggerJJ 
.JJ 
LogInfoJJ 
(JJ 
$"JJ 
$strJJ %
{JJ% &
	LoadCountJJ& /
}JJ/ 0
$strJJ0 A
"JJA B
,JJB C
$strJJD L
)JJL M
;JJM N
}KK 	
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL 
{MM 	
_loggerNN 
.NN 
LogErrorNN 
(NN 
$"NN 
$strNN <
{NN< =
exNN= ?
.NN? @
MessageNN@ G
}NNG H
"NNH I
,NNI J
exNNK M
,NNM N
$strNNO W
)NNW X
;NNX Y
}OO 	
}PP 
[VV 
RelayCommandVV 
]VV 
privateWW 
voidWW 

AddAnotherWW 
(WW 
)WW 
{XX 
_loggerYY 
.YY 
LogInfoYY 
(YY 
$strYY A
,YYA B
$strYYC K
)YYK L
;YYL M
_workflowService\\ 
.\\ 
GoToStep\\ !
(\\! "$
Enum_DunnageWorkflowStep\\" :
.\\: ;
TypeSelection\\; H
)\\H I
;\\I J
}]] 
[__ 
RelayCommand__ 
]__ 
private`` 
async`` 
Task`` 
SaveAllAsync`` #
(``# $
)``$ %
{aa 
ifbb 

(bb 
!bb 
CanSavebb 
||bb 
IsBusybb 
)bb 
returnbb  &
;bb& '
trydd 
{ee 	
IsBusyff 
=ff 
trueff 
;ff 
CanSavegg 
=gg 
falsegg 
;gg 
StatusMessagehh 
=hh 
$strhh -
;hh- .
varkk 

saveResultkk 
=kk 
awaitkk "
_dunnageServicekk# 2
.kk2 3
SaveLoadsAsynckk3 A
(kkA B
SessionLoadskkB N
.kkN O
ToListkkO U
(kkU V
)kkV W
)kkW X
;kkX Y
ifmm 
(mm 
!mm 

saveResultmm 
.mm 
Successmm #
)mm# $
{nn 
awaitoo 
_errorHandleroo #
.oo# $
HandleDaoErrorAsyncoo$ 7
(oo7 8

saveResultoo8 B
,ooB C
$strooD R
,ooR S
trueooT X
)ooX Y
;ooY Z
returnpp 
;pp 
}qq 
StatusMessagess 
=ss 
$strss 1
;ss1 2
varvv 
	csvResultvv 
=vv 
awaitvv !

_csvWritervv" ,
.vv, -
WriteToCSVAsyncvv- <
(vv< =
SessionLoadsvv= I
.vvI J
ToListvvJ P
(vvP Q
)vvQ R
)vvR S
;vvS T
ifxx 
(xx 
!xx 
	csvResultxx 
.xx 
LocalSuccessxx '
)xx' (
{yy 
awaitzz 
_errorHandlerzz #
.zz# $
HandleErrorAsynczz$ 4
(zz4 5
	csvResult{{ 
.{{ 
ErrorMessage{{ *
??{{+ -
$str{{. A
,{{A B
Enum_ErrorSeverity|| &
.||& '
Warning||' .
,||. /
null}} 
,}} 
true~~ 
)~~ 
;~~ 
}
ÄÄ 
SuccessMessage
ÉÉ 
=
ÉÉ 
$"
ÉÉ 
$str
ÉÉ 4
{
ÉÉ4 5
	LoadCount
ÉÉ5 >
}
ÉÉ> ?
$str
ÉÉ? g
"
ÉÉg h
;
ÉÉh i%
IsSuccessMessageVisible
ÑÑ #
=
ÑÑ$ %
true
ÑÑ& *
;
ÑÑ* +
_logger
ÜÜ 
.
ÜÜ 
LogInfo
ÜÜ 
(
ÜÜ 
$"
ÜÜ 
$str
ÜÜ $
{
ÜÜ$ %
	LoadCount
ÜÜ% .
}
ÜÜ. /
$str
ÜÜ/ B
"
ÜÜB C
,
ÜÜC D
$str
ÜÜE M
)
ÜÜM N
;
ÜÜN O
await
ââ 
Task
ââ 
.
ââ 
Delay
ââ 
(
ââ 
$num
ââ !
)
ââ! "
;
ââ" #
_workflowService
åå 
.
åå 
ClearSession
åå )
(
åå) *
)
åå* +
;
åå+ ,
_workflowService
çç 
.
çç 
GoToStep
çç %
(
çç% &&
Enum_DunnageWorkflowStep
çç& >
.
çç> ?
ModeSelection
çç? L
)
ççL M
;
ççM N
}
éé 	
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè 
{
êê 	
await
ëë 
_errorHandler
ëë 
.
ëë  
HandleErrorAsync
ëë  0
(
ëë0 1
$str
íí $
,
íí$ % 
Enum_ErrorSeverity
ìì "
.
ìì" #
Error
ìì# (
,
ìì( )
ex
îî 
,
îî 
true
ïï 
)
ññ 
;
ññ 
}
óó 	
finally
òò 
{
ôô 	
IsBusy
öö 
=
öö 
false
öö 
;
öö 
CanSave
õõ 
=
õõ 
true
õõ 
;
õõ 
}
úú 	
}
ùù 
[
üü 
RelayCommand
üü 
]
üü 
private
†† 
void
†† 
Cancel
†† 
(
†† 
)
†† 
{
°° 
_logger
¢¢ 
.
¢¢ 
LogInfo
¢¢ 
(
¢¢ 
$str
¢¢ =
,
¢¢= >
$str
¢¢? G
)
¢¢G H
;
¢¢H I
_workflowService
•• 
.
•• 
ClearSession
•• %
(
••% &
)
••& '
;
••' (
_workflowService
¶¶ 
.
¶¶ 
GoToStep
¶¶ !
(
¶¶! "&
Enum_DunnageWorkflowStep
¶¶" :
.
¶¶: ;
ModeSelection
¶¶; H
)
¶¶H I
;
¶¶I J
}
ßß 
}™™ â6
jC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Dunnage_QuantityEntryViewModel.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $

ViewModels		$ .
.		. /
Dunnage		/ 6
;		6 7
public 
partial 
class *
Dunnage_QuantityEntryViewModel 3
:4 5 
Shared_BaseViewModel6 J
{ 
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
public 
*
Dunnage_QuantityEntryViewModel )
() *$
IService_DunnageWorkflow  
workflowService! 0
,0 1!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
:( )
base* .
(. /
errorHandler/ ;
,; <
logger= C
)C D
{ 
_workflowService 
= 
workflowService *
;* +
} 
[ 
ObservableProperty 
] 
[ $
NotifyPropertyChangedFor 
( 
nameof $
($ %
IsValid% ,
), -
)- .
]. /
private 
int 
	_quantity 
= 
$num 
; 
[   
ObservableProperty   
]   
private!! 
string!! 
_selectedTypeName!! $
=!!% &
string!!' -
.!!- .
Empty!!. 3
;!!3 4
[## 
ObservableProperty## 
]## 
private$$ 
string$$ 
_selectedPartName$$ $
=$$% &
string$$' -
.$$- .
Empty$$. 3
;$$3 4
[&& 
ObservableProperty&& 
]&& 
private'' 
string'' 
_validationMessage'' %
=''& '
string''( .
.''. /
Empty''/ 4
;''4 5
public,, 

bool,, 
IsValid,, 
=>,, 
Quantity,, #
>,,$ %
$num,,& '
;,,' (
public55 

void55 
LoadContextData55 
(55  
)55  !
{66 
try77 
{88 	
SelectedTypeName99 
=99 
_workflowService99 /
.99/ 0
CurrentSession990 >
.99> ?
SelectedTypeName99? O
??99P R
string99S Y
.99Y Z
Empty99Z _
;99_ `
SelectedPartName:: 
=:: 
_workflowService:: /
.::/ 0
CurrentSession::0 >
.::> ?
SelectedPart::? K
?::K L
.::L M
PartId::M S
??::T V
string::W ]
.::] ^
Empty::^ c
;::c d
_logger<< 
.<< 
LogInfo<< 
(<< 
$"<< 
$str<< 3
{<<3 4
SelectedTypeName<<4 D
}<<D E
$str<<E L
{<<L M
SelectedPartName<<M ]
}<<] ^
"<<^ _
,<<_ `
$str<<a p
)<<p q
;<<q r
}== 	
catch>> 
(>> 
	Exception>> 
ex>> 
)>> 
{?? 	
_logger@@ 
.@@ 
LogError@@ 
(@@ 
$"@@ 
$str@@ ;
{@@; <
ex@@< >
.@@> ?
Message@@? F
}@@F G
"@@G H
,@@H I
ex@@J L
,@@L M
$str@@N ]
)@@] ^
;@@^ _
}AA 	
}BB 
partialHH 
voidHH 
OnQuantityChangedHH "
(HH" #
intHH# &
valueHH' ,
)HH, -
{II 
ValidateQuantityJJ 
(JJ 
)JJ 
;JJ 
GoNextCommandKK 
.KK #
NotifyCanExecuteChangedKK -
(KK- .
)KK. /
;KK/ 0
}LL 
privateNN 
voidNN 
ValidateQuantityNN !
(NN! "
)NN" #
{OO 
ifPP 

(PP 
QuantityPP 
<=PP 
$numPP 
)PP 
{QQ 	
ValidationMessageRR 
=RR 
$strRR  A
;RRA B
}SS 	
elseTT 
{UU 	
ValidationMessageVV 
=VV 
stringVV  &
.VV& '
EmptyVV' ,
;VV, -
}WW 	
}XX 
[^^ 
RelayCommand^^ 
]^^ 
private__ 
void__ 
GoBack__ 
(__ 
)__ 
{`` 
_loggeraa 
.aa 
LogInfoaa 
(aa 
$straa ;
,aa; <
$straa= L
)aaL M
;aaM N
_workflowServicebb 
.bb 
GoToStepbb !
(bb! "$
Enum_DunnageWorkflowStepbb" :
.bb: ;
PartSelectionbb; H
)bbH I
;bbI J
}cc 
[ee 
RelayCommandee 
(ee 

CanExecuteee 
=ee 
nameofee %
(ee% &
IsValidee& -
)ee- .
)ee. /
]ee/ 0
privateff 
asyncff 
Taskff 
GoNextAsyncff "
(ff" #
)ff# $
{gg 
ifhh 

(hh 
!hh 
IsValidhh 
||hh 
IsBusyhh 
)hh 
returnhh  &
;hh& '
tryjj 
{kk 	
IsBusyll 
=ll 
truell 
;ll 
StatusMessagemm 
=mm 
$strmm 0
;mm0 1
_workflowServicepp 
.pp 
CurrentSessionpp +
.pp+ ,
Quantitypp, 4
=pp5 6
Quantitypp7 ?
;pp? @
_loggerrr 
.rr 
LogInforr 
(rr 
$"rr 
$strrr .
{rr. /
Quantityrr/ 7
}rr7 8
"rr8 9
,rr9 :
$strrr; J
)rrJ K
;rrK L
_workflowServiceuu 
.uu 
GoToStepuu %
(uu% &$
Enum_DunnageWorkflowStepuu& >
.uu> ?
DetailsEntryuu? K
)uuK L
;uuL M
}vv 	
catchww 
(ww 
	Exceptionww 
exww 
)ww 
{xx 	
awaityy 
_errorHandleryy 
.yy  
HandleErrorAsyncyy  0
(yy0 1
$strzz '
,zz' (
Enum_ErrorSeverity{{ "
.{{" #
Error{{# (
,{{( )
ex|| 
,|| 
true}} 
)~~ 
;~~ 
} 	
finally
ÄÄ 
{
ÅÅ 	
IsBusy
ÇÇ 
=
ÇÇ 
false
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
}áá —î
jC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Dunnage_PartSelectionViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Dunnage/ 6
;6 7
public 
partial 
class *
Dunnage_PartSelectionViewModel 3
:4 5 
Shared_BaseViewModel6 J
{ 
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
private 
readonly "
IService_MySQL_Dunnage +
_dunnageService, ;
;; <
public 
*
Dunnage_PartSelectionViewModel )
() *$
IService_DunnageWorkflow  
workflowService! 0
,0 1"
IService_MySQL_Dunnage 
dunnageService -
,- .!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
:( )
base* .
(. /
errorHandler/ ;
,; <
logger= C
)C D
{ 
_workflowService 
= 
workflowService *
;* +
_dunnageService 
= 
dunnageService (
;( )
} 
["" 
ObservableProperty"" 
]"" 
private##  
ObservableCollection##  
<##  !
Model_DunnagePart##! 2
>##2 3
_availableParts##4 C
=##D E
new##F I
(##I J
)##J K
;##K L
[%% 
ObservableProperty%% 
]%% 
[&& $
NotifyPropertyChangedFor&& 
(&& 
nameof&& $
(&&$ %
IsPartSelected&&% 3
)&&3 4
)&&4 5
]&&5 6
private'' 
Model_DunnagePart'' 
?'' 
_selectedPart'' ,
;'', -
[)) 
ObservableProperty)) 
])) 
private** 
bool** +
_isInventoryNotificationVisible** 0
;**0 1
[,, 
ObservableProperty,, 
],, 
private-- 
string-- )
_inventoryNotificationMessage-- 0
=--1 2
string--3 9
.--9 :
Empty--: ?
;--? @
[// 
ObservableProperty// 
]// 
private00 
string00 
_inventoryMethod00 #
=00$ %
$str00& 1
;001 2
[22 
ObservableProperty22 
]22 
private33 
string33 
_selectedTypeName33 $
=33% &
string33' -
.33- .
Empty33. 3
;333 4
[55 
ObservableProperty55 
]55 
private66 
int66 
_selectedTypeId66 
;66  
public;; 

bool;; 
IsPartSelected;; 
=>;; !
SelectedPart;;" .
!=;;/ 1
null;;2 6
;;;6 7
publicDD 

asyncDD 
TaskDD 
InitializeAsyncDD %
(DD% &
)DD& '
{EE 
ifFF 

(FF 
IsBusyFF 
)FF 
returnFF 
;FF 
tryHH 
{II 	
IsBusyJJ 
=JJ 
trueJJ 
;JJ 
StatusMessageKK 
=KK 
$strKK .
;KK. /
SelectedTypeIdNN 
=NN 
_workflowServiceNN -
.NN- .
CurrentSessionNN. <
.NN< =
SelectedTypeIdNN= K
;NNK L
SelectedTypeNameOO 
=OO 
_workflowServiceOO /
.OO/ 0
CurrentSessionOO0 >
.OO> ?
SelectedTypeNameOO? O
??OOP R
stringOOS Y
.OOY Z
EmptyOOZ _
;OO_ `
awaitQQ 
LoadPartsAsyncQQ  
(QQ  !
)QQ! "
;QQ" #
StatusMessageSS 
=SS 
$"SS 
$strSS %
{SS% &
AvailablePartsSS& 4
.SS4 5
CountSS5 :
}SS: ;
$strSS; F
{SSF G
SelectedTypeNameSSG W
}SSW X
"SSX Y
;SSY Z
}TT 	
catchUU 
(UU 
	ExceptionUU 
exUU 
)UU 
{VV 	
awaitWW 
_errorHandlerWW 
.WW  
HandleErrorAsyncWW  0
(WW0 1
$strXX 5
,XX5 6
Enum_ErrorSeverityYY "
.YY" #
ErrorYY# (
,YY( )
exZZ 
,ZZ 
true[[ 
)\\ 
;\\ 
StatusMessage]] 
=]] 
$str]] 1
;]]1 2
}^^ 	
finally__ 
{`` 	
IsBusyaa 
=aa 
falseaa 
;aa 
}bb 	
}cc 
[ii 
RelayCommandii 
]ii 
privatejj 
asyncjj 
Taskjj 
LoadPartsAsyncjj %
(jj% &
)jj& '
{kk 
ifll 

(ll 
IsBusyll 
||ll 
SelectedTypeIdll $
==ll% '
$numll( )
)ll) *
returnll+ 1
;ll1 2
trynn 
{oo 	
IsBusypp 
=pp 
truepp 
;pp 
varrr 
resultrr 
=rr 
awaitrr 
_dunnageServicerr .
.rr. /
GetPartsByTypeAsyncrr/ B
(rrB C
SelectedTypeIdrrC Q
)rrQ R
;rrR S
iftt 
(tt 
resulttt 
.tt 
	IsSuccesstt  
&&tt! #
resulttt$ *
.tt* +
Datatt+ /
!=tt0 2
nulltt3 7
)tt7 8
{uu 
AvailablePartsvv 
.vv 
Clearvv $
(vv$ %
)vv% &
;vv& '
foreachww 
(ww 
varww 
partww !
inww" $
resultww% +
.ww+ ,
Dataww, 0
)ww0 1
{xx 
AvailablePartsyy "
.yy" #
Addyy# &
(yy& '
partyy' +
)yy+ ,
;yy, -
}zz 
_logger|| 
.|| 
LogInfo|| 
(||  
$"||  "
$str||" )
{||) *
AvailableParts||* 8
.||8 9
Count||9 >
}||> ?
$str||? R
{||R S
SelectedTypeId||S a
}||a b
"||b c
,||c d
$str||e t
)||t u
;||u v
}}} 
else~~ 
{ 
await
ÄÄ 
_errorHandler
ÄÄ #
.
ÄÄ# $!
HandleDaoErrorAsync
ÄÄ$ 7
(
ÄÄ7 8
result
ÅÅ 
,
ÅÅ 
nameof
ÇÇ 
(
ÇÇ 
LoadPartsAsync
ÇÇ )
)
ÇÇ) *
,
ÇÇ* +
true
ÉÉ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
}
ÜÜ 	
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá 
{
àà 	
await
ââ 
_errorHandler
ââ 
.
ââ  
HandleErrorAsync
ââ  0
(
ââ0 1
$str
ää %
,
ää% & 
Enum_ErrorSeverity
ãã "
.
ãã" #
Error
ãã# (
,
ãã( )
ex
åå 
,
åå 
true
çç 
)
éé 
;
éé 
}
èè 	
finally
êê 
{
ëë 	
IsBusy
íí 
=
íí 
false
íí 
;
íí 
}
ìì 	
}
îî 
partial
öö 
void
öö #
OnSelectedPartChanged
öö &
(
öö& '
Model_DunnagePart
öö' 8
?
öö8 9
oldValue
öö: B
,
ööB C
Model_DunnagePart
ööD U
?
ööU V
newValue
ööW _
)
öö_ `
{
õõ 
if
úú 

(
úú 
newValue
úú 
!=
úú 
null
úú 
)
úú 
{
ùù 	
_
ûû 
=
ûû '
CheckInventoryStatusAsync
ûû )
(
ûû) *
newValue
ûû* 2
)
ûû2 3
;
ûû3 4
}
üü 	
else
†† 
{
°° 	,
IsInventoryNotificationVisible
¢¢ *
=
¢¢+ ,
false
¢¢- 2
;
¢¢2 3
}
££ 	
SelectPartCommand
¶¶ 
.
¶¶ %
NotifyCanExecuteChanged
¶¶ 1
(
¶¶1 2
)
¶¶2 3
;
¶¶3 4
}
ßß 
private
©© 
async
©© 
Task
©© '
CheckInventoryStatusAsync
©© 0
(
©©0 1
Model_DunnagePart
©©1 B
part
©©C G
)
©©G H
{
™™ 
try
´´ 
{
¨¨ 	
var
≠≠ 
isInventoried
≠≠ 
=
≠≠ 
await
≠≠  %
_dunnageService
≠≠& 5
.
≠≠5 6$
IsPartInventoriedAsync
≠≠6 L
(
≠≠L M
part
≠≠M Q
.
≠≠Q R
PartId
≠≠R X
)
≠≠X Y
;
≠≠Y Z
if
ØØ 
(
ØØ 
isInventoried
ØØ 
)
ØØ 
{
∞∞ ,
IsInventoryNotificationVisible
≤≤ .
=
≤≤/ 0
true
≤≤1 5
;
≤≤5 6
InventoryMethod
≥≥ 
=
≥≥  !
$str
≥≥" -
;
≥≥- .$
UpdateInventoryMessage
¥¥ &
(
¥¥& '
)
¥¥' (
;
¥¥( )
_logger
∂∂ 
.
∂∂ 
LogInfo
∂∂ 
(
∂∂  
$"
∂∂  "
$str
∂∂" '
{
∂∂' (
part
∂∂( ,
.
∂∂, -
PartId
∂∂- 3
}
∂∂3 4
$str
∂∂4 Z
"
∂∂Z [
,
∂∂[ \
$str
∂∂] l
)
∂∂l m
;
∂∂m n
}
∑∑ 
else
∏∏ 
{
ππ ,
IsInventoryNotificationVisible
∫∫ .
=
∫∫/ 0
false
∫∫1 6
;
∫∫6 7
}
ªª 
}
ºº 	
catch
ΩΩ 
(
ΩΩ 
	Exception
ΩΩ 
ex
ΩΩ 
)
ΩΩ 
{
ææ 	
_logger
øø 
.
øø 
LogError
øø 
(
øø 
$"
øø 
$str
øø @
{
øø@ A
ex
øøA C
.
øøC D
Message
øøD K
}
øøK L
"
øøL M
,
øøM N
ex
øøO Q
,
øøQ R
$str
øøS b
)
øøb c
;
øøc d,
IsInventoryNotificationVisible
¡¡ *
=
¡¡+ ,
false
¡¡- 2
;
¡¡2 3
}
¬¬ 	
}
√√ 
private
≈≈ 
void
≈≈ $
UpdateInventoryMessage
≈≈ '
(
≈≈' (
)
≈≈( )
{
∆∆ *
InventoryNotificationMessage
«« $
=
««% &
$"
««' )
$str
««) \
{
««\ ]
InventoryMethod
««] l
}
««l m
"
««m n
;
««n o
}
»» 
[
ŒŒ 
RelayCommand
ŒŒ 
]
ŒŒ 
private
œœ 
void
œœ 
GoBack
œœ 
(
œœ 
)
œœ 
{
–– 
_logger
—— 
.
—— 
LogInfo
—— 
(
—— 
$str
—— 5
,
——5 6
$str
——7 F
)
——F G
;
——G H
_workflowService
““ 
.
““ 
GoToStep
““ !
(
““! "&
Enum_DunnageWorkflowStep
““" :
.
““: ;
TypeSelection
““; H
)
““H I
;
““I J
}
”” 
[
’’ 
RelayCommand
’’ 
(
’’ 

CanExecute
’’ 
=
’’ 
nameof
’’ %
(
’’% &
IsPartSelected
’’& 4
)
’’4 5
)
’’5 6
]
’’6 7
private
÷÷ 
async
÷÷ 
Task
÷÷ 
SelectPartAsync
÷÷ &
(
÷÷& '
)
÷÷' (
{
◊◊ 
if
ÿÿ 

(
ÿÿ 
SelectedPart
ÿÿ 
==
ÿÿ 
null
ÿÿ  
||
ÿÿ! #
IsBusy
ÿÿ$ *
)
ÿÿ* +
return
ÿÿ, 2
;
ÿÿ2 3
try
⁄⁄ 
{
€€ 	
IsBusy
‹‹ 
=
‹‹ 
true
‹‹ 
;
‹‹ 
_workflowService
ﬂﬂ 
.
ﬂﬂ 
CurrentSession
ﬂﬂ +
.
ﬂﬂ+ ,
SelectedPart
ﬂﬂ, 8
=
ﬂﬂ9 :
SelectedPart
ﬂﬂ; G
;
ﬂﬂG H
_logger
·· 
.
·· 
LogInfo
·· 
(
·· 
$"
·· 
$str
·· -
{
··- .
SelectedPart
··. :
.
··: ;
PartId
··; A
}
··A B
"
··B C
,
··C D
$str
··E T
)
··T U
;
··U V
_workflowService
‰‰ 
.
‰‰ 
GoToStep
‰‰ %
(
‰‰% &&
Enum_DunnageWorkflowStep
‰‰& >
.
‰‰> ?
QuantityEntry
‰‰? L
)
‰‰L M
;
‰‰M N
}
ÂÂ 	
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ 
{
ÁÁ 	
await
ËË 
_errorHandler
ËË 
.
ËË  
HandleErrorAsync
ËË  0
(
ËË0 1
$str
ÈÈ &
,
ÈÈ& ' 
Enum_ErrorSeverity
ÍÍ "
.
ÍÍ" #
Error
ÍÍ# (
,
ÍÍ( )
ex
ÎÎ 
,
ÎÎ 
true
ÏÏ 
)
ÌÌ 
;
ÌÌ 
}
ÓÓ 	
finally
ÔÔ 
{
 	
IsBusy
ÒÒ 
=
ÒÒ 
false
ÒÒ 
;
ÒÒ 
}
ÚÚ 	
}
ÛÛ 
[
ıı 
RelayCommand
ıı 
]
ıı 
private
ˆˆ 
async
ˆˆ 
Task
ˆˆ 
QuickAddPartAsync
ˆˆ (
(
ˆˆ( )
)
ˆˆ) *
{
˜˜ 
try
¯¯ 
{
˘˘ 	
_logger
˙˙ 
.
˙˙ 
LogInfo
˙˙ 
(
˙˙ 
$"
˙˙ 
$str
˙˙ @
{
˙˙@ A
SelectedTypeName
˙˙A Q
}
˙˙Q R
"
˙˙R S
,
˙˙S T
$str
˙˙U d
)
˙˙d e
;
˙˙e f
var
˝˝ 
dialog
˝˝ 
=
˝˝ 
new
˝˝ 
Views
˝˝ "
.
˝˝" #
Dunnage
˝˝# *
.
˝˝* +(
Dunnage_QuickAddPartDialog
˝˝+ E
(
˝˝E F
SelectedTypeId
˝˝F T
,
˝˝T U
SelectedTypeName
˝˝V f
)
˝˝f g
{
˛˛ 
XamlRoot
ˇˇ 
=
ˇˇ 
App
ˇˇ 
.
ˇˇ 

MainWindow
ˇˇ )
?
ˇˇ) *
.
ˇˇ* +
Content
ˇˇ+ 2
?
ˇˇ2 3
.
ˇˇ3 4
XamlRoot
ˇˇ4 <
}
ÄÄ 
;
ÄÄ 
if
ÇÇ 
(
ÇÇ 
dialog
ÇÇ 
.
ÇÇ 
XamlRoot
ÇÇ 
==
ÇÇ  "
null
ÇÇ# '
)
ÇÇ' (
{
ÉÉ 
_logger
ÑÑ 
.
ÑÑ 
LogInfo
ÑÑ 
(
ÑÑ  
$str
ÑÑ  F
,
ÑÑF G
$str
ÑÑH W
)
ÑÑW X
;
ÑÑX Y
return
ÖÖ 
;
ÖÖ 
}
ÜÜ 
var
àà 
result
àà 
=
àà 
await
àà 
dialog
àà %
.
àà% &
	ShowAsync
àà& /
(
àà/ 0
)
àà0 1
;
àà1 2
if
ää 
(
ää 
result
ää 
==
ää 
	Microsoft
ää #
.
ää# $
UI
ää$ &
.
ää& '
Xaml
ää' +
.
ää+ ,
Controls
ää, 4
.
ää4 5!
ContentDialogResult
ää5 H
.
ääH I
Primary
ääI P
)
ääP Q
{
ãã 
var
åå 
partId
åå 
=
åå 
dialog
åå #
.
åå# $
PartId
åå$ *
;
åå* +
var
çç 
specValuesJson
çç "
=
çç# $
dialog
çç% +
.
çç+ ,
SpecValuesJson
çç, :
;
çç: ;
_logger
èè 
.
èè 
LogInfo
èè 
(
èè  
$"
èè  "
$str
èè" 3
{
èè3 4
partId
èè4 :
}
èè: ;
$str
èè; E
{
èèE F
SelectedTypeName
èèF V
}
èèV W
"
èèW X
,
èèX Y
$str
èèZ i
)
èèi j
;
èèj k
var
íí 
newPart
íí 
=
íí 
new
íí !
Model_DunnagePart
íí" 3
{
ìì 
PartId
îî 
=
îî 
partId
îî #
,
îî# $
TypeId
ïï 
=
ïï 
SelectedTypeId
ïï +
,
ïï+ ,

SpecValues
ññ 
=
ññ  
specValuesJson
ññ! /
,
ññ/ 0
DunnageTypeName
óó #
=
óó$ %
SelectedTypeName
óó& 6
}
òò 
;
òò 
var
õõ 
insertResult
õõ  
=
õõ! "
await
õõ# (
_dunnageService
õõ) 8
.
õõ8 9
InsertPartAsync
õõ9 H
(
õõH I
newPart
õõI P
)
õõP Q
;
õõQ R
if
ùù 
(
ùù 
insertResult
ùù  
.
ùù  !
	IsSuccess
ùù! *
)
ùù* +
{
ûû 
_logger
üü 
.
üü 
LogInfo
üü #
(
üü# $
$"
üü$ &
$str
üü& ?
{
üü? @
partId
üü@ F
}
üüF G
"
üüG H
,
üüH I
$str
üüJ Y
)
üüY Z
;
üüZ [
await
¢¢ 
LoadPartsAsync
¢¢ (
(
¢¢( )
)
¢¢) *
;
¢¢* +
var
•• 
	addedPart
•• !
=
••" #
AvailableParts
••$ 2
.
••2 3
FirstOrDefault
••3 A
(
••A B
p
••B C
=>
••D F
p
••G H
.
••H I
PartId
••I O
==
••P R
partId
••S Y
)
••Y Z
;
••Z [
if
¶¶ 
(
¶¶ 
	addedPart
¶¶ !
!=
¶¶" $
null
¶¶% )
)
¶¶) *
{
ßß 
SelectedPart
®® $
=
®®% &
	addedPart
®®' 0
;
®®0 1
}
©© 
StatusMessage
´´ !
=
´´" #
$"
´´$ &
$str
´´& 6
{
´´6 7
partId
´´7 =
}
´´= >
"
´´> ?
;
´´? @
}
¨¨ 
else
≠≠ 
{
ÆÆ 
await
ØØ 
_errorHandler
ØØ '
.
ØØ' (!
HandleDaoErrorAsync
ØØ( ;
(
ØØ; <
insertResult
∞∞ $
,
∞∞$ %
nameof
±± 
(
±± 
QuickAddPartAsync
±± 0
)
±±0 1
,
±±1 2
true
≤≤ 
)
≥≥ 
;
≥≥ 
}
¥¥ 
}
µµ 
}
∂∂ 	
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
ex
∑∑ 
)
∑∑ 
{
∏∏ 	
await
ππ 
_errorHandler
ππ 
.
ππ  
HandleErrorAsync
ππ  0
(
ππ0 1
$str
∫∫ /
,
∫∫/ 0 
Enum_ErrorSeverity
ªª "
.
ªª" #
Error
ªª# (
,
ªª( )
ex
ºº 
,
ºº 
true
ΩΩ 
)
ææ 
;
ææ 
}
øø 	
}
¿¿ 
}√√ Ü(
jC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Dunnage_ModeSelectionViewModel.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $

ViewModels		$ .
.		. /
Dunnage		/ 6
;		6 7
public 
partial 
class *
Dunnage_ModeSelectionViewModel 3
:4 5 
Shared_BaseViewModel6 J
{ 
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
public 
*
Dunnage_ModeSelectionViewModel )
() *$
IService_DunnageWorkflow  
workflowService! 0
,0 1!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
:( )
base* .
(. /
errorHandler/ ;
,; <
logger= C
)C D
{ 
_workflowService 
= 
workflowService *
;* +
} 
[ 
ObservableProperty 
] 
private 
bool  
_isGuidedModeDefault %
;% &
[ 
ObservableProperty 
] 
private   
bool    
_isManualModeDefault   %
;  % &
["" 
ObservableProperty"" 
]"" 
private## 
bool## 
_isEditModeDefault## #
;### $
[)) 
RelayCommand)) 
])) 
private** 
void** 
SelectGuidedMode** !
(**! "
)**" #
{++ 
_logger,, 
.,, 
LogInfo,, 
(,, 
$str,, :
),,: ;
;,,; <
_workflowService-- 
.-- 
GoToStep-- !
(--! "$
Enum_DunnageWorkflowStep--" :
.--: ;
TypeSelection--; H
)--H I
;--I J
}.. 
[00 
RelayCommand00 
]00 
private11 
void11 
SelectManualMode11 !
(11! "
)11" #
{22 
_logger33 
.33 
LogInfo33 
(33 
$str33 9
)339 :
;33: ;
_workflowService44 
.44 
GoToStep44 !
(44! "$
Enum_DunnageWorkflowStep44" :
.44: ;
ManualEntry44; F
)44F G
;44G H
}55 
[77 
RelayCommand77 
]77 
private88 
void88 
SelectEditMode88 
(88  
)88  !
{99 
_logger:: 
.:: 
LogInfo:: 
(:: 
$str:: 1
)::1 2
;::2 3
_workflowService;; 
.;; 
GoToStep;; !
(;;! "$
Enum_DunnageWorkflowStep;;" :
.;;: ;
EditMode;;; C
);;C D
;;;D E
}<< 
[BB 
RelayCommandBB 
]BB 
privateCC 
voidCC 
SetGuidedAsDefaultCC #
(CC# $
boolCC$ (
	isCheckedCC) 2
)CC2 3
{DD 
IsGuidedModeDefaultEE 
=EE 
	isCheckedEE '
;EE' (
ifFF 

(FF 
	isCheckedFF 
)FF 
{GG 	
IsManualModeDefaultHH 
=HH  !
falseHH" '
;HH' (
IsEditModeDefaultII 
=II 
falseII  %
;II% &
_loggerKK 
.KK 
LogInfoKK 
(KK 
$strKK 8
)KK8 9
;KK9 :
}LL 	
}MM 
[OO 
RelayCommandOO 
]OO 
privatePP 
voidPP 
SetManualAsDefaultPP #
(PP# $
boolPP$ (
	isCheckedPP) 2
)PP2 3
{QQ 
IsManualModeDefaultRR 
=RR 
	isCheckedRR '
;RR' (
ifSS 

(SS 
	isCheckedSS 
)SS 
{TT 	
IsGuidedModeDefaultUU 
=UU  !
falseUU" '
;UU' (
IsEditModeDefaultVV 
=VV 
falseVV  %
;VV% &
_loggerXX 
.XX 
LogInfoXX 
(XX 
$strXX 8
)XX8 9
;XX9 :
}YY 	
}ZZ 
[\\ 
RelayCommand\\ 
]\\ 
private]] 
void]] 
SetEditAsDefault]] !
(]]! "
bool]]" &
	isChecked]]' 0
)]]0 1
{^^ 
IsEditModeDefault__ 
=__ 
	isChecked__ %
;__% &
if`` 

(`` 
	isChecked`` 
)`` 
{aa 	
IsGuidedModeDefaultbb 
=bb  !
falsebb" '
;bb' (
IsManualModeDefaultcc 
=cc  !
falsecc" '
;cc' (
_loggeree 
.ee 
LogInfoee 
(ee 
$stree 6
)ee6 7
;ee7 8
}ff 	
}gg 
}jj Üı
hC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Dunnage_ManualEntryViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Dunnage/ 6
;6 7
public 
partial 
class (
Dunnage_ManualEntryViewModel 1
:2 3 
Shared_BaseViewModel4 H
{ 
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
private 
readonly "
IService_MySQL_Dunnage +
_dunnageService, ;
;; <
private 
readonly %
IService_DunnageCSVWriter .

_csvWriter/ 9
;9 :
private 
readonly 
IService_Window $
_windowService% 3
;3 4
public 
(
Dunnage_ManualEntryViewModel '
(' ($
IService_DunnageWorkflow  
workflowService! 0
,0 1"
IService_MySQL_Dunnage 
dunnageService -
,- .%
IService_DunnageCSVWriter !
	csvWriter" +
,+ ,!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
,& '
IService_Window   
windowService   %
)  % &
:  ' (
base  ) -
(  - .
errorHandler  . :
,  : ;
logger  < B
)  B C
{!! 
_workflowService"" 
="" 
workflowService"" *
;""* +
_dunnageService## 
=## 
dunnageService## (
;##( )

_csvWriter$$ 
=$$ 
	csvWriter$$ 
;$$ 
_windowService%% 
=%% 
windowService%% &
;%%& '
}&& 
[** 
ObservableProperty** 
]** 
private++  
ObservableCollection++  
<++  !
Model_DunnageLoad++! 2
>++2 3
_loads++4 :
=++; <
new++= @
(++@ A
)++A B
;++B C
[-- 
ObservableProperty-- 
]-- 
private.. 
Model_DunnageLoad.. 
?.. 
_selectedLoad.. ,
;.., -
[00 
ObservableProperty00 
]00 
private11 
bool11 
_canSave11 
=11 
false11 !
;11! "
[33 
ObservableProperty33 
]33 
private44  
ObservableCollection44  
<44  !
Model_DunnageType44! 2
>442 3
_availableTypes444 C
=44D E
new44F I
(44I J
)44J K
;44K L
[66 
ObservableProperty66 
]66 
private77  
ObservableCollection77  
<77  !
Model_DunnagePart77! 2
>772 3
_availableParts774 C
=77D E
new77F I
(77I J
)77J K
;77K L
public== 

async== 
Task== 
InitializeAsync== %
(==% &
)==& '
{>> 
try?? 
{@@ 	
IsBusyAA 
=AA 
trueAA 
;AA 
StatusMessageBB 
=BB 
$strBB 8
;BB8 9
varEE 
typesResultEE 
=EE 
awaitEE #
_dunnageServiceEE$ 3
.EE3 4
GetAllTypesAsyncEE4 D
(EED E
)EEE F
;EEF G
ifFF 
(FF 
typesResultFF 
.FF 
SuccessFF #
&&FF$ &
typesResultFF' 2
.FF2 3
DataFF3 7
!=FF8 :
nullFF; ?
)FF? @
{GG 
AvailableTypesHH 
.HH 
ClearHH $
(HH$ %
)HH% &
;HH& '
foreachII 
(II 
varII 
typeII !
inII" $
typesResultII% 0
.II0 1
DataII1 5
)II5 6
{JJ 
AvailableTypesKK "
.KK" #
AddKK# &
(KK& '
typeKK' +
)KK+ ,
;KK, -
}LL 
}MM 
varPP 
partsResultPP 
=PP 
awaitPP #
_dunnageServicePP$ 3
.PP3 4
GetAllPartsAsyncPP4 D
(PPD E
)PPE F
;PPF G
ifQQ 
(QQ 
partsResultQQ 
.QQ 
SuccessQQ #
&&QQ$ &
partsResultQQ' 2
.QQ2 3
DataQQ3 7
!=QQ8 :
nullQQ; ?
)QQ? @
{RR 
AvailablePartsSS 
.SS 
ClearSS $
(SS$ %
)SS% &
;SS& '
foreachTT 
(TT 
varTT 
partTT !
inTT" $
partsResultTT% 0
.TT0 1
DataTT1 5
)TT5 6
{UU 
AvailablePartsVV "
.VV" #
AddVV# &
(VV& '
partVV' +
)VV+ ,
;VV, -
}WW 
}XX 
AddRow[[ 
([[ 
)[[ 
;[[ 
_logger]] 
.]] 
LogInfo]] 
(]] 
$str]] 6
,]]6 7
$str]]8 E
)]]E F
;]]F G
}^^ 	
catch__ 
(__ 
	Exception__ 
ex__ 
)__ 
{`` 	
awaitaa 
_errorHandleraa 
.aa  
HandleErrorAsyncaa  0
(aa0 1
$strbb 1
,bb1 2
Enum_ErrorSeveritycc "
.cc" #
Errorcc# (
,cc( )
exdd 
,dd 
trueee 
)ff 
;ff 
}gg 	
finallyhh 
{ii 	
IsBusyjj 
=jj 
falsejj 
;jj 
}kk 	
}ll 
[rr 
RelayCommandrr 
]rr 
privatess 
voidss 
AddRowss 
(ss 
)ss 
{tt 
varuu 
newLoaduu 
=uu 
newuu 
Model_DunnageLoaduu +
{vv 	
Quantityww 
=ww 
$numww 
,ww 
CreatedDatexx 
=xx 
DateTimexx "
.xx" #
Nowxx# &
,xx& '
	CreatedByyy 
=yy 
Environmentyy #
.yy# $
UserNameyy$ ,
}zz 	
;zz	 

Loads|| 
.|| 
Add|| 
(|| 
newLoad|| 
)|| 
;|| 
SelectedLoad}} 
=}} 
newLoad}} 
;}} 
UpdateCanSave~~ 
(~~ 
)~~ 
;~~ 
_logger
ÄÄ 
.
ÄÄ 
LogInfo
ÄÄ 
(
ÄÄ 
$"
ÄÄ 
$str
ÄÄ 0
{
ÄÄ0 1
Loads
ÄÄ1 6
.
ÄÄ6 7
Count
ÄÄ7 <
}
ÄÄ< =
"
ÄÄ= >
,
ÄÄ> ?
$str
ÄÄ@ M
)
ÄÄM N
;
ÄÄN O
}
ÅÅ 
[
ÉÉ 
RelayCommand
ÉÉ 
]
ÉÉ 
private
ÑÑ 
void
ÑÑ 
AddMultiple
ÑÑ 
(
ÑÑ 
string
ÑÑ #
countStr
ÑÑ$ ,
)
ÑÑ, -
{
ÖÖ 
if
ÜÜ 

(
ÜÜ 
!
ÜÜ 
int
ÜÜ 
.
ÜÜ 
TryParse
ÜÜ 
(
ÜÜ 
countStr
ÜÜ "
,
ÜÜ" #
out
ÜÜ$ '
int
ÜÜ( +
count
ÜÜ, 1
)
ÜÜ1 2
||
ÜÜ3 5
count
ÜÜ6 ;
<=
ÜÜ< >
$num
ÜÜ? @
||
ÜÜA C
count
ÜÜD I
>
ÜÜJ K
$num
ÜÜL O
)
ÜÜO P
{
áá 	
StatusMessage
àà 
=
àà 
$str
àà E
;
ààE F
return
ââ 
;
ââ 
}
ää 	
for
åå 
(
åå 
int
åå 
i
åå 
=
åå 
$num
åå 
;
åå 
i
åå 
<
åå 
count
åå !
;
åå! "
i
åå# $
++
åå$ &
)
åå& '
{
çç 	
var
éé 
newLoad
éé 
=
éé 
new
éé 
Model_DunnageLoad
éé /
{
èè 
Quantity
êê 
=
êê 
$num
êê 
,
êê 
CreatedDate
ëë 
=
ëë 
DateTime
ëë &
.
ëë& '
Now
ëë' *
,
ëë* +
	CreatedBy
íí 
=
íí 
Environment
íí '
.
íí' (
UserName
íí( 0
}
ìì 
;
ìì 
Loads
îî 
.
îî 
Add
îî 
(
îî 
newLoad
îî 
)
îî 
;
îî 
}
ïï 	
UpdateCanSave
óó 
(
óó 
)
óó 
;
óó 
_logger
òò 
.
òò 
LogInfo
òò 
(
òò 
$"
òò 
$str
òò  
{
òò  !
count
òò! &
}
òò& '
$str
òò' 5
{
òò5 6
Loads
òò6 ;
.
òò; <
Count
òò< A
}
òòA B
"
òòB C
,
òòC D
$str
òòE R
)
òòR S
;
òòS T
}
ôô 
[
õõ 
RelayCommand
õõ 
]
õõ 
private
úú 
void
úú 
	RemoveRow
úú 
(
úú 
)
úú 
{
ùù 
if
ûû 

(
ûû 
SelectedLoad
ûû 
==
ûû 
null
ûû  
)
ûû  !
return
ûû" (
;
ûû( )
Loads
†† 
.
†† 
Remove
†† 
(
†† 
SelectedLoad
†† !
)
††! "
;
††" #
SelectedLoad
°° 
=
°° 
Loads
°° 
.
°° 
LastOrDefault
°° *
(
°°* +
)
°°+ ,
;
°°, -
UpdateCanSave
¢¢ 
(
¢¢ 
)
¢¢ 
;
¢¢ 
_logger
§§ 
.
§§ 
LogInfo
§§ 
(
§§ 
$"
§§ 
$str
§§ .
{
§§. /
Loads
§§/ 4
.
§§4 5
Count
§§5 :
}
§§: ;
"
§§; <
,
§§< =
$str
§§> K
)
§§K L
;
§§L M
}
•• 
[
´´ 
RelayCommand
´´ 
]
´´ 
private
¨¨ 
void
¨¨ 
FillBlankSpaces
¨¨  
(
¨¨  !
)
¨¨! "
{
≠≠ 
if
ÆÆ 

(
ÆÆ 
Loads
ÆÆ 
.
ÆÆ 
Count
ÆÆ 
<
ÆÆ 
$num
ÆÆ 
)
ÆÆ 
return
ÆÆ #
;
ÆÆ# $
var
∞∞ 
lastLoad
∞∞ 
=
∞∞ 
Loads
∞∞ 
.
∞∞ 
LastOrDefault
∞∞ *
(
∞∞* +
)
∞∞+ ,
;
∞∞, -
if
±± 

(
±± 
lastLoad
±± 
==
±± 
null
±± 
)
±± 
return
±± $
;
±±$ %
foreach
≥≥ 
(
≥≥ 
var
≥≥ 
load
≥≥ 
in
≥≥ 
Loads
≥≥ "
)
≥≥" #
{
¥¥ 	
if
∂∂ 
(
∂∂ 
string
∂∂ 
.
∂∂  
IsNullOrWhiteSpace
∂∂ )
(
∂∂) *
load
∂∂* .
.
∂∂. /
PoNumber
∂∂/ 7
)
∂∂7 8
&&
∂∂9 ;
!
∂∂< =
string
∂∂= C
.
∂∂C D 
IsNullOrWhiteSpace
∂∂D V
(
∂∂V W
lastLoad
∂∂W _
.
∂∂_ `
PoNumber
∂∂` h
)
∂∂h i
)
∂∂i j
{
∑∑ 
load
∏∏ 
.
∏∏ 
PoNumber
∏∏ 
=
∏∏ 
lastLoad
∏∏  (
.
∏∏( )
PoNumber
∏∏) 1
;
∏∏1 2
}
ππ 
if
ºº 
(
ºº 
string
ºº 
.
ºº  
IsNullOrWhiteSpace
ºº )
(
ºº) *
load
ºº* .
.
ºº. /
Location
ºº/ 7
)
ºº7 8
&&
ºº9 ;
!
ºº< =
string
ºº= C
.
ººC D 
IsNullOrWhiteSpace
ººD V
(
ººV W
lastLoad
ººW _
.
ºº_ `
Location
ºº` h
)
ººh i
)
ººi j
{
ΩΩ 
load
ææ 
.
ææ 
Location
ææ 
=
ææ 
lastLoad
ææ  (
.
ææ( )
Location
ææ) 1
;
ææ1 2
}
øø 
if
¬¬ 
(
¬¬ 
load
¬¬ 
.
¬¬ 

SpecValues
¬¬ 
==
¬¬  "
null
¬¬# '
&&
¬¬( *
lastLoad
¬¬+ 3
.
¬¬3 4

SpecValues
¬¬4 >
!=
¬¬? A
null
¬¬B F
)
¬¬F G
{
√√ 
load
ƒƒ 
.
ƒƒ 

SpecValues
ƒƒ 
=
ƒƒ  !
new
ƒƒ" %

Dictionary
ƒƒ& 0
<
ƒƒ0 1
string
ƒƒ1 7
,
ƒƒ7 8
object
ƒƒ9 ?
>
ƒƒ? @
(
ƒƒ@ A
lastLoad
ƒƒA I
.
ƒƒI J

SpecValues
ƒƒJ T
)
ƒƒT U
;
ƒƒU V
}
≈≈ 
}
∆∆ 	
StatusMessage
»» 
=
»» 
$str
»» ;
;
»»; <
_logger
…… 
.
…… 
LogInfo
…… 
(
…… 
$str
…… 4
,
……4 5
$str
……6 C
)
……C D
;
……D E
}
   
[
ÃÃ 
RelayCommand
ÃÃ 
]
ÃÃ 
private
ÕÕ 
void
ÕÕ 
SortForPrinting
ÕÕ  
(
ÕÕ  !
)
ÕÕ! "
{
ŒŒ 
var
œœ 
sorted
œœ 
=
œœ 
Loads
œœ 
.
–– 
OrderBy
–– 
(
–– 
l
–– 
=>
–– 
l
–– 
.
–– 
PartId
–– "
)
––" #
.
—— 
ThenBy
—— 
(
—— 
l
—— 
=>
—— 
l
—— 
.
—— 
PoNumber
—— #
)
——# $
.
““ 
ThenBy
““ 
(
““ 
l
““ 
=>
““ 
l
““ 
.
““ 
TypeName
““ #
)
““# $
.
”” 
ToList
”” 
(
”” 
)
”” 
;
”” 
Loads
’’ 
.
’’ 
Clear
’’ 
(
’’ 
)
’’ 
;
’’ 
foreach
÷÷ 
(
÷÷ 
var
÷÷ 
load
÷÷ 
in
÷÷ 
sorted
÷÷ #
)
÷÷# $
{
◊◊ 	
Loads
ÿÿ 
.
ÿÿ 
Add
ÿÿ 
(
ÿÿ 
load
ÿÿ 
)
ÿÿ 
;
ÿÿ 
}
ŸŸ 	
StatusMessage
€€ 
=
€€ 
$str
€€ C
;
€€C D
_logger
‹‹ 
.
‹‹ 
LogInfo
‹‹ 
(
‹‹ 
$str
‹‹ 4
,
‹‹4 5
$str
‹‹6 C
)
‹‹C D
;
‹‹D E
}
›› 
[
ﬂﬂ 
RelayCommand
ﬂﬂ 
]
ﬂﬂ 
private
‡‡ 
async
‡‡ 
Task
‡‡ 
AutoFillAsync
‡‡ $
(
‡‡$ %
)
‡‡% &
{
·· 
if
‚‚ 

(
‚‚ 
Loads
‚‚ 
.
‚‚ 
Count
‚‚ 
==
‚‚ 
$num
‚‚ 
)
‚‚ 
return
‚‚ $
;
‚‚$ %
try
‰‰ 
{
ÂÂ 	
IsBusy
ÊÊ 
=
ÊÊ 
true
ÊÊ 
;
ÊÊ 
StatusMessage
ÁÁ 
=
ÁÁ 
$str
ÁÁ 2
;
ÁÁ2 3
foreach
ÍÍ 
(
ÍÍ 
var
ÍÍ 
load
ÍÍ 
in
ÍÍ  
Loads
ÍÍ! &
)
ÍÍ& '
{
ÎÎ 
if
ÌÌ 
(
ÌÌ 
!
ÌÌ 
string
ÌÌ 
.
ÌÌ  
IsNullOrWhiteSpace
ÌÌ .
(
ÌÌ. /
load
ÌÌ/ 3
.
ÌÌ3 4
PartId
ÌÌ4 :
)
ÌÌ: ;
&&
ÌÌ< >
string
ÌÌ? E
.
ÌÌE F 
IsNullOrWhiteSpace
ÌÌF X
(
ÌÌX Y
load
ÌÌY ]
.
ÌÌ] ^
TypeName
ÌÌ^ f
)
ÌÌf g
)
ÌÌg h
{
ÓÓ 
var
ÔÔ 
part
ÔÔ 
=
ÔÔ 
AvailableParts
ÔÔ -
.
ÔÔ- .
FirstOrDefault
ÔÔ. <
(
ÔÔ< =
p
ÔÔ= >
=>
ÔÔ? A
p
ÔÔB C
.
ÔÔC D
PartId
ÔÔD J
==
ÔÔK M
load
ÔÔN R
.
ÔÔR S
PartId
ÔÔS Y
)
ÔÔY Z
;
ÔÔZ [
if
 
(
 
part
 
!=
 
null
  $
)
$ %
{
ÒÒ 
var
ÚÚ 
type
ÚÚ  
=
ÚÚ! "
AvailableTypes
ÚÚ# 1
.
ÚÚ1 2
FirstOrDefault
ÚÚ2 @
(
ÚÚ@ A
t
ÚÚA B
=>
ÚÚC E
t
ÚÚF G
.
ÚÚG H
Id
ÚÚH J
==
ÚÚK M
part
ÚÚN R
.
ÚÚR S
TypeId
ÚÚS Y
)
ÚÚY Z
;
ÚÚZ [
if
ÛÛ 
(
ÛÛ 
type
ÛÛ  
!=
ÛÛ! #
null
ÛÛ$ (
)
ÛÛ( )
{
ÙÙ 
load
ıı  
.
ıı  !
TypeName
ıı! )
=
ıı* +
type
ıı, 0
.
ıı0 1
TypeName
ıı1 9
;
ıı9 :
}
ˆˆ 
}
˜˜ 
}
¯¯ 
if
˚˚ 
(
˚˚ 
load
˚˚ 
.
˚˚ 
Quantity
˚˚ !
<=
˚˚" $
$num
˚˚% &
)
˚˚& '
{
¸¸ 
load
˝˝ 
.
˝˝ 
Quantity
˝˝ !
=
˝˝" #
$num
˝˝$ %
;
˝˝% &
}
˛˛ 
if
ÅÅ 
(
ÅÅ 
string
ÅÅ 
.
ÅÅ  
IsNullOrWhiteSpace
ÅÅ -
(
ÅÅ- .
load
ÅÅ. 2
.
ÅÅ2 3
InventoryMethod
ÅÅ3 B
)
ÅÅB C
)
ÅÅC D
{
ÇÇ 
load
ÉÉ 
.
ÉÉ 
InventoryMethod
ÉÉ (
=
ÉÉ) *
string
ÉÉ+ 1
.
ÉÉ1 2 
IsNullOrWhiteSpace
ÉÉ2 D
(
ÉÉD E
load
ÉÉE I
.
ÉÉI J
PoNumber
ÉÉJ R
)
ÉÉR S
?
ÉÉT U
$str
ÉÉV a
:
ÉÉb c
$str
ÉÉd p
;
ÉÉp q
}
ÑÑ 
}
ÖÖ 
StatusMessage
áá 
=
áá 
$str
áá 1
;
áá1 2
_logger
àà 
.
àà 
LogInfo
àà 
(
àà 
$str
àà 0
,
àà0 1
$str
àà2 ?
)
àà? @
;
àà@ A
}
ââ 	
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää 
{
ãã 	
await
åå 
_errorHandler
åå 
.
åå  
HandleErrorAsync
åå  0
(
åå0 1
$str
çç (
,
çç( ) 
Enum_ErrorSeverity
éé "
.
éé" #
Warning
éé# *
,
éé* +
ex
èè 
,
èè 
true
êê 
)
ëë 
;
ëë 
}
íí 	
finally
ìì 
{
îî 	
IsBusy
ïï 
=
ïï 
false
ïï 
;
ïï 
}
ññ 	
}
óó 
[
ùù 
RelayCommand
ùù 
]
ùù 
private
ûû 
async
ûû 
Task
ûû  
SaveToHistoryAsync
ûû )
(
ûû) *
)
ûû* +
{
üü 
if
†† 

(
†† 
Loads
†† 
.
†† 
Count
†† 
==
†† 
$num
†† 
)
†† 
return
†† $
;
††$ %
try
¢¢ 
{
££ 	
IsBusy
§§ 
=
§§ 
true
§§ 
;
§§ 
CanSave
•• 
=
•• 
false
•• 
;
•• 
StatusMessage
¶¶ 
=
¶¶ 
$str
¶¶ 2
;
¶¶2 3
var
©© 
result
©© 
=
©© 
await
©© 
_dunnageService
©© .
.
©©. /
SaveLoadsAsync
©©/ =
(
©©= >
Loads
©©> C
.
©©C D
ToList
©©D J
(
©©J K
)
©©K L
)
©©L M
;
©©M N
if
´´ 
(
´´ 
result
´´ 
.
´´ 
Success
´´ 
)
´´ 
{
¨¨ 
StatusMessage
≠≠ 
=
≠≠ 
$"
≠≠  "
$str
≠≠" (
{
≠≠( )
Loads
≠≠) .
.
≠≠. /
Count
≠≠/ 4
}
≠≠4 5
$str
≠≠5 F
"
≠≠F G
;
≠≠G H
_logger
ÆÆ 
.
ÆÆ 
LogInfo
ÆÆ 
(
ÆÆ  
$"
ÆÆ  "
$str
ÆÆ" (
{
ÆÆ( )
Loads
ÆÆ) .
.
ÆÆ. /
Count
ÆÆ/ 4
}
ÆÆ4 5
$str
ÆÆ5 F
"
ÆÆF G
,
ÆÆG H
$str
ÆÆI V
)
ÆÆV W
;
ÆÆW X
}
ØØ 
else
∞∞ 
{
±± 
await
≤≤ 
_errorHandler
≤≤ #
.
≤≤# $!
HandleDaoErrorAsync
≤≤$ 7
(
≤≤7 8
result
≤≤8 >
,
≤≤> ?
$str
≤≤@ T
,
≤≤T U
true
≤≤V Z
)
≤≤Z [
;
≤≤[ \
}
≥≥ 
}
¥¥ 	
catch
µµ 
(
µµ 
	Exception
µµ 
ex
µµ 
)
µµ 
{
∂∂ 	
await
∑∑ 
_errorHandler
∑∑ 
.
∑∑  
HandleErrorAsync
∑∑  0
(
∑∑0 1
$str
∏∏ )
,
∏∏) * 
Enum_ErrorSeverity
ππ "
.
ππ" #
Error
ππ# (
,
ππ( )
ex
∫∫ 
,
∫∫ 
true
ªª 
)
ºº 
;
ºº 
}
ΩΩ 	
finally
ææ 
{
øø 	
IsBusy
¿¿ 
=
¿¿ 
false
¿¿ 
;
¿¿ 
CanSave
¡¡ 
=
¡¡ 
true
¡¡ 
;
¡¡ 
}
¬¬ 	
}
√√ 
[
≈≈ 
RelayCommand
≈≈ 
]
≈≈ 
private
∆∆ 
async
∆∆ 
Task
∆∆ 
SaveAllAsync
∆∆ #
(
∆∆# $
)
∆∆$ %
{
«« 
if
»» 

(
»» 
Loads
»» 
.
»» 
Count
»» 
==
»» 
$num
»» 
)
»» 
return
»» $
;
»»$ %
try
   
{
ÀÀ 	
IsBusy
ÃÃ 
=
ÃÃ 
true
ÃÃ 
;
ÃÃ 
CanSave
ÕÕ 
=
ÕÕ 
false
ÕÕ 
;
ÕÕ 
StatusMessage
ŒŒ 
=
ŒŒ 
$str
ŒŒ -
;
ŒŒ- .
foreach
—— 
(
—— 
var
—— 
load
—— 
in
——  
Loads
——! &
)
——& '
{
““ 
if
”” 
(
”” 
string
”” 
.
””  
IsNullOrWhiteSpace
”” -
(
””- .
load
””. 2
.
””2 3
TypeName
””3 ;
)
””; <
||
””= ?
string
””@ F
.
””F G 
IsNullOrWhiteSpace
””G Y
(
””Y Z
load
””Z ^
.
””^ _
PartId
””_ e
)
””e f
)
””f g
{
‘‘ 
StatusMessage
’’ !
=
’’" #
$str
’’$ J
;
’’J K
return
÷÷ 
;
÷÷ 
}
◊◊ 
}
ÿÿ 
var
€€ 

saveResult
€€ 
=
€€ 
await
€€ "
_dunnageService
€€# 2
.
€€2 3
SaveLoadsAsync
€€3 A
(
€€A B
Loads
€€B G
.
€€G H
ToList
€€H N
(
€€N O
)
€€O P
)
€€P Q
;
€€Q R
if
›› 
(
›› 
!
›› 

saveResult
›› 
.
›› 
Success
›› #
)
››# $
{
ﬁﬁ 
await
ﬂﬂ 
_errorHandler
ﬂﬂ #
.
ﬂﬂ# $!
HandleDaoErrorAsync
ﬂﬂ$ 7
(
ﬂﬂ7 8

saveResult
ﬂﬂ8 B
,
ﬂﬂB C
$str
ﬂﬂD R
,
ﬂﬂR S
true
ﬂﬂT X
)
ﬂﬂX Y
;
ﬂﬂY Z
return
‡‡ 
;
‡‡ 
}
·· 
var
‰‰ 
	csvResult
‰‰ 
=
‰‰ 
await
‰‰ !

_csvWriter
‰‰" ,
.
‰‰, -
WriteToCSVAsync
‰‰- <
(
‰‰< =
Loads
‰‰= B
.
‰‰B C
ToList
‰‰C I
(
‰‰I J
)
‰‰J K
)
‰‰K L
;
‰‰L M
if
ÊÊ 
(
ÊÊ 
!
ÊÊ 
	csvResult
ÊÊ 
.
ÊÊ 
LocalSuccess
ÊÊ '
)
ÊÊ' (
{
ÁÁ 
await
ËË 
_errorHandler
ËË #
.
ËË# $
HandleErrorAsync
ËË$ 4
(
ËË4 5
	csvResult
ÈÈ 
.
ÈÈ 
ErrorMessage
ÈÈ *
??
ÈÈ+ -
$str
ÈÈ. A
,
ÈÈA B 
Enum_ErrorSeverity
ÍÍ &
.
ÍÍ& '
Warning
ÍÍ' .
,
ÍÍ. /
null
ÎÎ 
,
ÎÎ 
true
ÏÏ 
)
ÏÏ 
;
ÏÏ 
}
ÌÌ 
StatusMessage
ÔÔ 
=
ÔÔ 
$"
ÔÔ 
$str
ÔÔ 1
{
ÔÔ1 2
Loads
ÔÔ2 7
.
ÔÔ7 8
Count
ÔÔ8 =
}
ÔÔ= >
$str
ÔÔ> D
"
ÔÔD E
;
ÔÔE F
_logger
 
.
 
LogInfo
 
(
 
$"
 
$str
 $
{
$ %
Loads
% *
.
* +
Count
+ 0
}
0 1
$str
1 7
"
7 8
,
8 9
$str
: G
)
G H
;
H I
Loads
ÛÛ 
.
ÛÛ 
Clear
ÛÛ 
(
ÛÛ 
)
ÛÛ 
;
ÛÛ 
AddRow
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ıı 	
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ 
{
˜˜ 	
await
¯¯ 
_errorHandler
¯¯ 
.
¯¯  
HandleErrorAsync
¯¯  0
(
¯¯0 1
$str
˘˘ $
,
˘˘$ % 
Enum_ErrorSeverity
˙˙ "
.
˙˙" #
Error
˙˙# (
,
˙˙( )
ex
˚˚ 
,
˚˚ 
true
¸¸ 
)
˝˝ 
;
˝˝ 
}
˛˛ 	
finally
ˇˇ 
{
ÄÄ 	
IsBusy
ÅÅ 
=
ÅÅ 
false
ÅÅ 
;
ÅÅ 
CanSave
ÇÇ 
=
ÇÇ 
true
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
[
ää 
RelayCommand
ää 
]
ää 
private
ãã 
async
ãã 
Task
ãã (
ReturnToModeSelectionAsync
ãã 1
(
ãã1 2
)
ãã2 3
{
åå 
var
çç 
xamlRoot
çç 
=
çç 
_windowService
çç %
.
çç% &
GetXamlRoot
çç& 1
(
çç1 2
)
çç2 3
;
çç3 4
if
éé 

(
éé 
xamlRoot
éé 
==
éé 
null
éé 
)
éé 
{
èè 	
_logger
êê 
.
êê 
LogError
êê 
(
êê 
$str
êê C
,
êêC D
null
êêE I
,
êêI J
$str
êêK X
)
êêX Y
;
êêY Z
await
ëë 
_errorHandler
ëë 
.
ëë  
HandleErrorAsync
ëë  0
(
ëë0 1
$str
ëë1 K
,
ëëK L 
Enum_ErrorSeverity
ëëM _
.
ëë_ `
Error
ëë` e
,
ëëe f
null
ëëg k
,
ëëk l
true
ëëm q
)
ëëq r
;
ëër s
return
íí 
;
íí 
}
ìì 	
var
ïï 
dialog
ïï 
=
ïï 
new
ïï 
	Microsoft
ïï "
.
ïï" #
UI
ïï# %
.
ïï% &
Xaml
ïï& *
.
ïï* +
Controls
ïï+ 3
.
ïï3 4
ContentDialog
ïï4 A
{
ññ 	
Title
óó 
=
óó 
$str
óó "
,
óó" #
Content
òò 
=
òò 
$stròò Å
,òòÅ Ç
PrimaryButtonText
ôô 
=
ôô 
$str
ôô  2
,
ôô2 3
CloseButtonText
öö 
=
öö 
$str
öö &
,
öö& '
DefaultButton
õõ 
=
õõ 
	Microsoft
õõ %
.
õõ% &
UI
õõ& (
.
õõ( )
Xaml
õõ) -
.
õõ- .
Controls
õõ. 6
.
õõ6 7!
ContentDialogButton
õõ7 J
.
õõJ K
Close
õõK P
,
õõP Q
XamlRoot
úú 
=
úú 
xamlRoot
úú 
}
ùù 	
;
ùù	 

var
üü 
result
üü 
=
üü 
await
üü 
dialog
üü !
.
üü! "
	ShowAsync
üü" +
(
üü+ ,
)
üü, -
.
üü- .
AsTask
üü. 4
(
üü4 5
)
üü5 6
;
üü6 7
if
†† 

(
†† 
result
†† 
==
†† 
	Microsoft
†† 
.
††  
UI
††  "
.
††" #
Xaml
††# '
.
††' (
Controls
††( 0
.
††0 1!
ContentDialogResult
††1 D
.
††D E
Primary
††E L
)
††L M
{
°° 	
try
¢¢ 
{
££ 
_logger
§§ 
.
§§ 
LogInfo
§§ 
(
§§  
$str
§§  Y
,
§§Y Z
$str
§§[ h
)
§§h i
;
§§i j
Loads
•• 
.
•• 
Clear
•• 
(
•• 
)
•• 
;
•• 
_workflowService
¶¶  
.
¶¶  !
ClearSession
¶¶! -
(
¶¶- .
)
¶¶. /
;
¶¶/ 0
_workflowService
ßß  
.
ßß  !
GoToStep
ßß! )
(
ßß) *&
Enum_DunnageWorkflowStep
ßß* B
.
ßßB C
ModeSelection
ßßC P
)
ßßP Q
;
ßßQ R
}
®® 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
™™ 
_logger
´´ 
.
´´ 
LogError
´´  
(
´´  !
$"
´´! #
$str
´´# G
{
´´G H
ex
´´H J
.
´´J K
Message
´´K R
}
´´R S
"
´´S T
,
´´T U
ex
´´V X
,
´´X Y
$str
´´Z g
)
´´g h
;
´´h i
await
¨¨ 
_errorHandler
¨¨ #
.
¨¨# $
HandleErrorAsync
¨¨$ 4
(
¨¨4 5
$str
¨¨5 Y
,
¨¨Y Z 
Enum_ErrorSeverity
¨¨[ m
.
¨¨m n
Error
¨¨n s
,
¨¨s t
ex
¨¨u w
,
¨¨w x
true
¨¨y }
)
¨¨} ~
;
¨¨~ 
}
≠≠ 
}
ÆÆ 	
else
ØØ 
{
∞∞ 	
_logger
±± 
.
±± 
LogInfo
±± 
(
±± 
$str
±± E
,
±±E F
$str
±±G T
)
±±T U
;
±±U V
}
≤≤ 	
}
≥≥ 
private
ππ 
void
ππ 
UpdateCanSave
ππ 
(
ππ 
)
ππ  
{
∫∫ 
CanSave
ªª 
=
ªª 
Loads
ªª 
.
ªª 
Any
ªª 
(
ªª 
l
ªª 
=>
ªª  
!
ªª! "
string
ªª" (
.
ªª( ) 
IsNullOrWhiteSpace
ªª) ;
(
ªª; <
l
ªª< =
.
ªª= >
TypeName
ªª> F
)
ªªF G
||
ªªH J
!
ªªK L
string
ªªL R
.
ªªR S 
IsNullOrWhiteSpace
ªªS e
(
ªªe f
l
ªªf g
.
ªªg h
PartId
ªªh n
)
ªªn o
)
ªªo p
;
ªªp q
}
ºº 
}øø  7
TC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Service_Pagination.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
{ 
public 

class 
Service_Pagination #
:$ %
IService_Pagination& 9
{		 
private

 
IEnumerable

 
<

 
object

 "
>

" #
?

# $
_source

% ,
;

, -
private 
int 
_currentPage  
=! "
$num# $
;$ %
private 
int 
	_pageSize 
= 
$num  "
;" #
public 
int 
CurrentPage 
=> !
_currentPage" .
;. /
public 
int 

TotalPages 
{ 	
get 
{ 
if 
( 
_source 
== 
null #
||$ &
!' (
_source( /
./ 0
Any0 3
(3 4
)4 5
)5 6
return7 =
$num> ?
;? @
return 
( 
int 
) 
Math  
.  !
Ceiling! (
(( )
() *
double* 0
)0 1

TotalItems1 ;
/< =
PageSize> F
)F G
;G H
} 
} 	
public 
int 
PageSize 
{ 	
get 
=> 
	_pageSize 
; 
set 
{ 
if 
( 
	_pageSize 
!=  
value! &
)& '
{ 
	_pageSize   
=   
value    %
;  % &
_currentPage!!  
=!!! "
$num!!# $
;!!$ %
OnPageChanged"" !
(""! "
)""" #
;""# $
}## 
}$$ 
}%% 	
public'' 
int'' 

TotalItems'' 
=>''  
_source''! (
?''( )
.'') *
Count''* /
(''/ 0
)''0 1
??''2 4
$num''5 6
;''6 7
public)) 
bool)) 
HasNextPage)) 
=>))  "
CurrentPage))# .
<))/ 0

TotalPages))1 ;
;)); <
public++ 
bool++ 
HasPreviousPage++ #
=>++$ &
CurrentPage++' 2
>++3 4
$num++5 6
;++6 7
public-- 
event-- 
EventHandler-- !
?--! "
PageChanged--# .
;--. /
public// 
void// 
	SetSource// 
<// 
T// 
>//  
(//  !
IEnumerable//! ,
<//, -
T//- .
>//. /
source//0 6
)//6 7
{00 	
_source11 
=11 
source11 
?11 
.11 
Cast11 "
<11" #
object11# )
>11) *
(11* +
)11+ ,
??11- /

Enumerable110 :
.11: ;
Empty11; @
<11@ A
object11A G
>11G H
(11H I
)11I J
;11J K
_currentPage22 
=22 
$num22 
;22 
OnPageChanged33 
(33 
)33 
;33 
}44 	
public66 
IEnumerable66 
<66 
T66 
>66 
GetCurrentPageItems66 1
<661 2
T662 3
>663 4
(664 5
)665 6
{77 	
if88 
(88 
_source88 
==88 
null88 
)88  
return88! '

Enumerable88( 2
.882 3
Empty883 8
<888 9
T889 :
>88: ;
(88; <
)88< =
;88= >
return:: 
_source:: 
.;; 
Skip;; 
(;; 
(;; 
CurrentPage;; "
-;;# $
$num;;% &
);;& '
*;;( )
PageSize;;* 2
);;2 3
.<< 
Take<< 
(<< 
PageSize<< 
)<< 
.== 
Cast== 
<== 
T== 
>== 
(== 
)== 
;== 
}>> 	
public@@ 
void@@ 
NextPage@@ 
(@@ 
)@@ 
{AA 	
ifBB 
(BB 
HasNextPageBB 
)BB 
{CC 
_currentPageDD 
++DD 
;DD 
OnPageChangedEE 
(EE 
)EE 
;EE  
}FF 
}GG 	
publicII 
voidII 
PreviousPageII  
(II  !
)II! "
{JJ 	
ifKK 
(KK 
HasPreviousPageKK 
)KK  
{LL 
_currentPageMM 
--MM 
;MM 
OnPageChangedNN 
(NN 
)NN 
;NN  
}OO 
}PP 	
publicRR 
voidRR 
	FirstPageRR 
(RR 
)RR 
{SS 	
ifTT 
(TT 
_currentPageTT 
!=TT 
$numTT  !
)TT! "
{UU 
_currentPageVV 
=VV 
$numVV  
;VV  !
OnPageChangedWW 
(WW 
)WW 
;WW  
}XX 
}YY 	
public[[ 
void[[ 
LastPage[[ 
([[ 
)[[ 
{\\ 	
if]] 
(]] 
_currentPage]] 
!=]] 

TotalPages]]  *
)]]* +
{^^ 
_currentPage__ 
=__ 

TotalPages__ )
;__) *
OnPageChanged`` 
(`` 
)`` 
;``  
}aa 
}bb 	
publicdd 
voiddd 
GoToPagedd 
(dd 
intdd  

pageNumberdd! +
)dd+ ,
{ee 	
ifff 
(ff 

pageNumberff 
<ff 
$numff 
)ff 

pageNumberff  *
=ff+ ,
$numff- .
;ff. /
ifgg 
(gg 

pageNumbergg 
>gg 

TotalPagesgg '
)gg' (

pageNumbergg) 3
=gg4 5

TotalPagesgg6 @
;gg@ A
ifii 
(ii 
_currentPageii 
!=ii 

pageNumberii  *
)ii* +
{jj 
_currentPagekk 
=kk 

pageNumberkk )
;kk) *
OnPageChangedll 
(ll 
)ll 
;ll  
}mm 
}nn 	
privatepp 
voidpp 
OnPageChangedpp "
(pp" #
)pp# $
{qq 	
PageChangedrr 
?rr 
.rr 
Invokerr 
(rr  
thisrr  $
,rr$ %
	EventArgsrr& /
.rr/ 0
Emptyrr0 5
)rr5 6
;rr6 7
}ss 	
}tt 
}uu “í
iC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Dunnage_DetailsEntryViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Dunnage/ 6
;6 7
public 
partial 
class )
Dunnage_DetailsEntryViewModel 2
:3 4 
Shared_BaseViewModel5 I
{ 
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
private 
readonly "
IService_MySQL_Dunnage +
_dunnageService, ;
;; <
public 
)
Dunnage_DetailsEntryViewModel (
(( )$
IService_DunnageWorkflow  
workflowService! 0
,0 1"
IService_MySQL_Dunnage 
dunnageService -
,- .!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
:( )
base* .
(. /
errorHandler/ ;
,; <
logger= C
)C D
{ 
_workflowService 
= 
workflowService *
;* +
_dunnageService 
= 
dunnageService (
;( )
}   
[$$ 
ObservableProperty$$ 
]$$ 
private%% 
string%% 
	_poNumber%% 
=%% 
string%% %
.%%% &
Empty%%& +
;%%+ ,
['' 
ObservableProperty'' 
]'' 
private(( 
string(( 
	_location(( 
=(( 
string(( %
.((% &
Empty((& +
;((+ ,
[** 
ObservableProperty** 
]** 
private++  
ObservableCollection++  
<++  !
Model_SpecInput++! 0
>++0 1
_specInputs++2 =
=++> ?
new++@ C
(++C D
)++D E
;++E F
[-- 
ObservableProperty-- 
]-- 
private.. 
bool.. +
_isInventoryNotificationVisible.. 0
=..1 2
false..3 8
;..8 9
[00 
ObservableProperty00 
]00 
private11 
string11 )
_inventoryNotificationMessage11 0
=111 2
string113 9
.119 :
Empty11: ?
;11? @
[33 
ObservableProperty33 
]33 
private44 
string44 
_inventoryMethod44 #
=44$ %
$str44& 1
;441 2
public== 

async== 
Task== )
LoadSpecsForSelectedPartAsync== 3
(==3 4
)==4 5
{>> 
try?? 
{@@ 	
IsBusyAA 
=AA 
trueAA 
;AA 
StatusMessageBB 
=BB 
$strBB 4
;BB4 5
varDD 
selectedTypeDD 
=DD 
_workflowServiceDD /
.DD/ 0
CurrentSessionDD0 >
.DD> ?
SelectedTypeDD? K
;DDK L
ifEE 
(EE 
selectedTypeEE 
==EE 
nullEE  $
)EE$ %
{FF 
_loggerGG 
.GG 
LogErrorGG  
(GG  !
$strGG! G
,GGG H
nullGGI M
,GGM N
$strGGO ]
)GG] ^
;GG^ _
returnHH 
;HH 
}II 
varLL 
specsLL 
=LL  
DeserializeSpecsJsonLL ,
(LL, -
selectedTypeLL- 9
.LL9 :
	SpecsJsonLL: C
)LLC D
;LLD E

SpecInputsOO 
.OO 
ClearOO 
(OO 
)OO 
;OO 
foreachPP 
(PP 
varPP 
specPP 
inPP  
specsPP! &
)PP& '
{QQ 
varRR 
inputRR 
=RR 
newRR 
Model_SpecInputRR  /
{SS 
SpecNameTT 
=TT 
specTT #
.TT# $
KeyTT$ '
,TT' (
SpecTypeUU 
=UU 
DetermineSpecTypeUU 0
(UU0 1
specUU1 5
.UU5 6
ValueUU6 ;
)UU; <
,UU< =
UnitVV 
=VV 
ExtractUnitVV &
(VV& '
specVV' +
.VV+ ,
ValueVV, 1
)VV1 2
,VV2 3

IsRequiredWW 
=WW  
IsSpecRequiredWW! /
(WW/ 0
specWW0 4
.WW4 5
ValueWW5 :
)WW: ;
,WW; <
ValueXX 
=XX 
nullXX  
}YY 
;YY 

SpecInputs[[ 
.[[ 
Add[[ 
([[ 
input[[ $
)[[$ %
;[[% &
}\\ 
_logger^^ 
.^^ 
LogInfo^^ 
(^^ 
$"^^ 
$str^^ %
{^^% &

SpecInputs^^& 0
.^^0 1
Count^^1 6
}^^6 7
$str^^7 C
"^^C D
,^^D E
$str^^F T
)^^T U
;^^U V
varaa 
selectedPartaa 
=aa 
_workflowServiceaa /
.aa/ 0
CurrentSessionaa0 >
.aa> ?
SelectedPartaa? K
;aaK L
ifbb 
(bb 
selectedPartbb 
!=bb 
nullbb  $
)bb$ %
{cc 
vardd 
isInventorieddd !
=dd" #
awaitdd$ )
_dunnageServicedd* 9
.dd9 :"
IsPartInventoriedAsyncdd: P
(ddP Q
selectedPartddQ ]
.dd] ^
PartIddd^ d
)ddd e
;dde f
ifee 
(ee 
isInventoriedee !
)ee! "
{ff *
IsInventoryNotificationVisiblegg 2
=gg3 4
truegg5 9
;gg9 :"
UpdateInventoryMessagehh *
(hh* +
)hh+ ,
;hh, -
}ii 
}jj 
}kk 	
catchll 
(ll 
	Exceptionll 
exll 
)ll 
{mm 	
awaitnn 
_errorHandlernn 
.nn  
HandleErrorAsyncnn  0
(nn0 1
$stroo %
,oo% &
Enum_ErrorSeveritypp "
.pp" #
Errorpp# (
,pp( )
exqq 
,qq 
truerr 
)ss 
;ss 
}tt 	
finallyuu 
{vv 	
IsBusyww 
=ww 
falseww 
;ww 
}xx 	
}yy 
private 

Dictionary 
< 
string 
, 
object %
>% & 
DeserializeSpecsJson' ;
(; <
string< B
	specsJsonC L
)L M
{
ÄÄ 
try
ÅÅ 
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
string
ÉÉ 
.
ÉÉ  
IsNullOrWhiteSpace
ÉÉ )
(
ÉÉ) *
	specsJson
ÉÉ* 3
)
ÉÉ3 4
)
ÉÉ4 5
return
ÑÑ 
new
ÑÑ 

Dictionary
ÑÑ %
<
ÑÑ% &
string
ÑÑ& ,
,
ÑÑ, -
object
ÑÑ. 4
>
ÑÑ4 5
(
ÑÑ5 6
)
ÑÑ6 7
;
ÑÑ7 8
return
ÜÜ 
JsonSerializer
ÜÜ !
.
ÜÜ! "
Deserialize
ÜÜ" -
<
ÜÜ- .

Dictionary
ÜÜ. 8
<
ÜÜ8 9
string
ÜÜ9 ?
,
ÜÜ? @
object
ÜÜA G
>
ÜÜG H
>
ÜÜH I
(
ÜÜI J
	specsJson
ÜÜJ S
)
ÜÜS T
??
áá 
new
áá 

Dictionary
áá !
<
áá! "
string
áá" (
,
áá( )
object
áá* 0
>
áá0 1
(
áá1 2
)
áá2 3
;
áá3 4
}
àà 	
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ 
{
ää 	
_logger
ãã 
.
ãã 
LogError
ãã 
(
ãã 
$"
ãã 
$str
ãã A
{
ããA B
ex
ããB D
.
ããD E
Message
ããE L
}
ããL M
"
ããM N
,
ããN O
ex
ããP R
,
ããR S
$str
ããT b
)
ããb c
;
ããc d
return
åå 
new
åå 

Dictionary
åå !
<
åå! "
string
åå" (
,
åå( )
object
åå* 0
>
åå0 1
(
åå1 2
)
åå2 3
;
åå3 4
}
çç 	
}
éé 
private
êê 
string
êê 
DetermineSpecType
êê $
(
êê$ %
object
êê% +
	specValue
êê, 5
)
êê5 6
{
ëë 
if
íí 

(
íí 
	specValue
íí 
==
íí 
null
íí 
)
íí 
return
íí %
$str
íí& ,
;
íí, -
var
îî 
specStr
îî 
=
îî 
	specValue
îî 
.
îî  
ToString
îî  (
(
îî( )
)
îî) *
?
îî* +
.
îî+ ,
ToLowerInvariant
îî, <
(
îî< =
)
îî= >
??
îî? A
string
îîB H
.
îîH I
Empty
îîI N
;
îîN O
if
óó 

(
óó 
specStr
óó 
.
óó 
Contains
óó 
(
óó 
$str
óó %
)
óó% &
||
óó' )
specStr
óó* 1
.
óó1 2
Contains
óó2 :
(
óó: ;
$str
óó; D
)
óóD E
||
óóF H
specStr
óóI P
.
óóP Q
Contains
óóQ Y
(
óóY Z
$str
óóZ ^
)
óó^ _
||
óó` b
specStr
óóc j
.
óój k
Contains
óók s
(
óós t
$str
óót |
)
óó| }
)
óó} ~
return
òò 
$str
òò 
;
òò 
if
öö 

(
öö 
specStr
öö 
.
öö 
Contains
öö 
(
öö 
$str
öö #
)
öö# $
||
öö% '
specStr
öö( /
.
öö/ 0
Contains
öö0 8
(
öö8 9
$str
öö9 A
)
ööA B
||
ööC E
specStr
ööF M
.
ööM N
Contains
ööN V
(
ööV W
$str
ööW c
)
ööc d
)
ööd e
return
õõ 
$str
õõ 
;
õõ 
return
ùù 
$str
ùù 
;
ùù 
}
ûû 
private
†† 
string
†† 
?
†† 
ExtractUnit
†† 
(
††  
object
††  &
	specValue
††' 0
)
††0 1
{
°° 
if
¢¢ 

(
¢¢ 
	specValue
¢¢ 
==
¢¢ 
null
¢¢ 
)
¢¢ 
return
¢¢ %
null
¢¢& *
;
¢¢* +
var
§§ 
specStr
§§ 
=
§§ 
	specValue
§§ 
.
§§  
ToString
§§  (
(
§§( )
)
§§) *
??
§§+ -
string
§§. 4
.
§§4 5
Empty
§§5 :
;
§§: ;
if
ßß 

(
ßß 
specStr
ßß 
.
ßß 
Contains
ßß 
(
ßß 
$str
ßß !
,
ßß! "
StringComparison
ßß# 3
.
ßß3 4
OrdinalIgnoreCase
ßß4 E
)
ßßE F
)
ßßF G
return
®® 
$str
®® 
;
®® 
if
©© 

(
©© 
specStr
©© 
.
©© 
Contains
©© 
(
©© 
$str
©© #
,
©©# $
StringComparison
©©% 5
.
©©5 6
OrdinalIgnoreCase
©©6 G
)
©©G H
)
©©H I
return
™™ 
$str
™™ 
;
™™ 
if
´´ 

(
´´ 
specStr
´´ 
.
´´ 
Contains
´´ 
(
´´ 
$str
´´ !
,
´´! "
StringComparison
´´# 3
.
´´3 4
OrdinalIgnoreCase
´´4 E
)
´´E F
)
´´F G
return
¨¨ 
$str
¨¨ 
;
¨¨ 
return
ÆÆ 
null
ÆÆ 
;
ÆÆ 
}
ØØ 
private
±± 
bool
±± 
IsSpecRequired
±± 
(
±±  
object
±±  &
	specValue
±±' 0
)
±±0 1
{
≤≤ 
if
≥≥ 

(
≥≥ 
	specValue
≥≥ 
==
≥≥ 
null
≥≥ 
)
≥≥ 
return
≥≥ %
false
≥≥& +
;
≥≥+ ,
var
µµ 
specStr
µµ 
=
µµ 
	specValue
µµ 
.
µµ  
ToString
µµ  (
(
µµ( )
)
µµ) *
?
µµ* +
.
µµ+ ,
ToLowerInvariant
µµ, <
(
µµ< =
)
µµ= >
??
µµ? A
string
µµB H
.
µµH I
Empty
µµI N
;
µµN O
return
∂∂ 
specStr
∂∂ 
.
∂∂ 
Contains
∂∂ 
(
∂∂  
$str
∂∂  *
)
∂∂* +
;
∂∂+ ,
}
∑∑ 
partial
ΩΩ 
void
ΩΩ 
OnPoNumberChanged
ΩΩ "
(
ΩΩ" #
string
ΩΩ# )
value
ΩΩ* /
)
ΩΩ/ 0
{
ææ 
if
øø 

(
øø 
string
øø 
.
øø  
IsNullOrWhiteSpace
øø %
(
øø% &
value
øø& +
)
øø+ ,
)
øø, -
{
¿¿ 	
InventoryMethod
¡¡ 
=
¡¡ 
$str
¡¡ )
;
¡¡) *
}
¬¬ 	
else
√√ 
{
ƒƒ 	
InventoryMethod
≈≈ 
=
≈≈ 
$str
≈≈ *
;
≈≈* +
}
∆∆ 	$
UpdateInventoryMessage
»» 
(
»» 
)
»»  
;
»»  !
}
…… 
private
ÀÀ 
void
ÀÀ $
UpdateInventoryMessage
ÀÀ '
(
ÀÀ' (
)
ÀÀ( )
{
ÃÃ 
if
ÕÕ 

(
ÕÕ ,
IsInventoryNotificationVisible
ÕÕ *
)
ÕÕ* +
{
ŒŒ 	*
InventoryNotificationMessage
œœ (
=
œœ) *
$"
œœ+ -
$str
œœ- k
{
œœk l
InventoryMethod
œœl {
}
œœ{ |
"
œœ| }
;
œœ} ~
}
–– 	
}
—— 
private
◊◊ 
bool
◊◊ 
ValidateInputs
◊◊ 
(
◊◊  
)
◊◊  !
{
ÿÿ 
foreach
⁄⁄ 
(
⁄⁄ 
var
⁄⁄ 
spec
⁄⁄ 
in
⁄⁄ 

SpecInputs
⁄⁄ '
.
⁄⁄' (
Where
⁄⁄( -
(
⁄⁄- .
s
⁄⁄. /
=>
⁄⁄0 2
s
⁄⁄3 4
.
⁄⁄4 5

IsRequired
⁄⁄5 ?
)
⁄⁄? @
)
⁄⁄@ A
{
€€ 	
if
‹‹ 
(
‹‹ 
spec
‹‹ 
.
‹‹ 
Value
‹‹ 
==
‹‹ 
null
‹‹ "
||
‹‹# %
string
‹‹& ,
.
‹‹, - 
IsNullOrWhiteSpace
‹‹- ?
(
‹‹? @
spec
‹‹@ D
.
‹‹D E
Value
‹‹E J
.
‹‹J K
ToString
‹‹K S
(
‹‹S T
)
‹‹T U
)
‹‹U V
)
‹‹V W
{
›› 
StatusMessage
ﬁﬁ 
=
ﬁﬁ 
$"
ﬁﬁ  "
$str
ﬁﬁ" :
{
ﬁﬁ: ;
spec
ﬁﬁ; ?
.
ﬁﬁ? @
SpecName
ﬁﬁ@ H
}
ﬁﬁH I
"
ﬁﬁI J
;
ﬁﬁJ K
return
ﬂﬂ 
false
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 
}
·· 	
return
„„ 
true
„„ 
;
„„ 
}
‰‰ 
[
ÍÍ 
RelayCommand
ÍÍ 
]
ÍÍ 
private
ÎÎ 
void
ÎÎ 
GoBack
ÎÎ 
(
ÎÎ 
)
ÎÎ 
{
ÏÏ 
_logger
ÌÌ 
.
ÌÌ 
LogInfo
ÌÌ 
(
ÌÌ 
$str
ÌÌ ;
,
ÌÌ; <
$str
ÌÌ= K
)
ÌÌK L
;
ÌÌL M
_workflowService
ÓÓ 
.
ÓÓ 
GoToStep
ÓÓ !
(
ÓÓ! "&
Enum_DunnageWorkflowStep
ÓÓ" :
.
ÓÓ: ;
QuantityEntry
ÓÓ; H
)
ÓÓH I
;
ÓÓI J
}
ÔÔ 
[
ÒÒ 
RelayCommand
ÒÒ 
]
ÒÒ 
private
ÚÚ 
async
ÚÚ 
Task
ÚÚ 
GoNextAsync
ÚÚ "
(
ÚÚ" #
)
ÚÚ# $
{
ÛÛ 
if
ÙÙ 

(
ÙÙ 
IsBusy
ÙÙ 
)
ÙÙ 
return
ÙÙ 
;
ÙÙ 
try
ˆˆ 
{
˜˜ 	
IsBusy
¯¯ 
=
¯¯ 
true
¯¯ 
;
¯¯ 
StatusMessage
˘˘ 
=
˘˘ 
$str
˘˘ +
;
˘˘+ ,
if
˚˚ 
(
˚˚ 
!
˚˚ 
ValidateInputs
˚˚ 
(
˚˚  
)
˚˚  !
)
˚˚! "
{
¸¸ 
return
˝˝ 
;
˝˝ 
}
˛˛ 
_workflowService
ÅÅ 
.
ÅÅ 
CurrentSession
ÅÅ +
.
ÅÅ+ ,
PONumber
ÅÅ, 4
=
ÅÅ5 6
PoNumber
ÅÅ7 ?
;
ÅÅ? @
_workflowService
ÇÇ 
.
ÇÇ 
CurrentSession
ÇÇ +
.
ÇÇ+ ,
Location
ÇÇ, 4
=
ÇÇ5 6
Location
ÇÇ7 ?
;
ÇÇ? @
var
ÖÖ 

specValues
ÖÖ 
=
ÖÖ 

SpecInputs
ÖÖ '
.
ÖÖ' (
ToDictionary
ÖÖ( 4
(
ÖÖ4 5
s
ÜÜ 
=>
ÜÜ 
s
ÜÜ 
.
ÜÜ 
SpecName
ÜÜ 
,
ÜÜ  
s
áá 
=>
áá 
s
áá 
.
áá 
Value
áá 
??
áá 
string
áá  &
.
áá& '
Empty
áá' ,
)
àà 
;
àà 
_workflowService
ää 
.
ää 
CurrentSession
ää +
.
ää+ ,

SpecValues
ää, 6
=
ää7 8

specValues
ää9 C
;
ääC D
_logger
åå 
.
åå 
LogInfo
åå 
(
åå 
$str
åå A
,
ååA B
$str
ååC Q
)
ååQ R
;
ååR S
_workflowService
èè 
.
èè 
GoToStep
èè %
(
èè% &&
Enum_DunnageWorkflowStep
èè& >
.
èè> ?
Review
èè? E
)
èèE F
;
èèF G
}
êê 	
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë 
{
íí 	
await
ìì 
_errorHandler
ìì 
.
ìì  
HandleErrorAsync
ìì  0
(
ìì0 1
$str
îî &
,
îî& ' 
Enum_ErrorSeverity
ïï "
.
ïï" #
Error
ïï# (
,
ïï( )
ex
ññ 
,
ññ 
true
óó 
)
òò 
;
òò 
}
ôô 	
finally
öö 
{
õõ 	
IsBusy
úú 
=
úú 
false
úú 
;
úú 
}
ùù 	
}
ûû 
}°° ÊA
cC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Main\Main_DunnageLabelViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Main/ 3
;3 4
public 
partial 
class &
Main_DunnageLabelViewModel /
:0 1 
Shared_BaseViewModel2 F
{ 
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
public 
&
Main_DunnageLabelViewModel %
(% &$
IService_DunnageWorkflow  
workflowService! 0
,0 1!
IService_ErrorHandler 
errorHandler *
,* +#
IService_LoggingUtility 
logger  &
)& '
: 	
base
 
( 
errorHandler 
, 
logger #
)# $
{ 
_workflowService 
= 
workflowService *
;* +
_workflowService 
. 
StepChanged $
+=% '!
OnWorkflowStepChanged( =
;= >
DunnageLines 
= 
new  
ObservableCollection /
</ 0
Model_DunnageLine0 A
>A B
(B C
)C D
;D E
_currentLine 
= 
new 
Model_DunnageLine ,
(, -
)- .
;. /"
IsModeSelectionVisible"" 
=""  
true""! %
;""% &
}## 
public%% 
 
ObservableCollection%% 
<%%  
Model_DunnageLine%%  1
>%%1 2
DunnageLines%%3 ?
{%%@ A
get%%B E
;%%E F
}%%G H
['' 
ObservableProperty'' 
]'' 
private(( 
Model_DunnageLine(( 
_currentLine(( *
;((* +
[,, 
ObservableProperty,, 
],, 
private-- 
bool-- #
_isModeSelectionVisible-- (
;--( )
[// 
ObservableProperty// 
]// 
private00 
bool00 #
_isTypeSelectionVisible00 (
;00( )
[22 
ObservableProperty22 
]22 
private33 
bool33 #
_isPartSelectionVisible33 (
;33( )
[55 
ObservableProperty55 
]55 
private66 
bool66 #
_isQuantityEntryVisible66 (
;66( )
[88 
ObservableProperty88 
]88 
private99 
bool99 "
_isDetailsEntryVisible99 '
;99' (
[;; 
ObservableProperty;; 
];; 
private<< 
bool<< 
_isReviewVisible<< !
;<<! "
[>> 
ObservableProperty>> 
]>> 
private?? 
bool?? !
_isManualEntryVisible?? &
;??& '
[AA 
ObservablePropertyAA 
]AA 
privateBB 
boolBB 
_isEditModeVisibleBB #
;BB# $
[DD 
ObservablePropertyDD 
]DD 
privateEE 
stringEE 
_currentStepTitleEE $
=EE% &
$strEE' 7
;EE7 8
[KK 
ObservablePropertyKK 
]KK 
privateLL 
boolLL 
_isStatusOpenLL 
;LL 
[NN 
ObservablePropertyNN 
]NN 
privateOO 
stringOO 
_statusMessageOO !
=OO" #
stringOO$ *
.OO* +
EmptyOO+ 0
;OO0 1
[QQ 
ObservablePropertyQQ 
]QQ 
privateRR 
Enum_ErrorSeverityRR 
_statusSeverityRR .
=RR/ 0
Enum_ErrorSeverityRR1 C
.RRC D
InfoRRD H
;RRH I
privateXX 
voidXX !
OnWorkflowStepChangedXX &
(XX& '
objectXX' -
?XX- .
senderXX/ 5
,XX5 6
	EventArgsXX7 @
eXXA B
)XXB C
{YY "
IsModeSelectionVisible[[ 
=[[  
false[[! &
;[[& '"
IsTypeSelectionVisible\\ 
=\\  
false\\! &
;\\& '"
IsPartSelectionVisible]] 
=]]  
false]]! &
;]]& '"
IsQuantityEntryVisible^^ 
=^^  
false^^! &
;^^& '!
IsDetailsEntryVisible__ 
=__ 
false__  %
;__% &
IsReviewVisible`` 
=`` 
false`` 
;``   
IsManualEntryVisibleaa 
=aa 
falseaa $
;aa$ %
IsEditModeVisiblebb 
=bb 
falsebb !
;bb! "
switchee 
(ee 
_workflowServiceee  
.ee  !
CurrentStepee! ,
)ee, -
{ff 	
casegg $
Enum_DunnageWorkflowStepgg )
.gg) *
ModeSelectiongg* 7
:gg7 8"
IsModeSelectionVisiblehh &
=hh' (
truehh) -
;hh- .
CurrentStepTitleii  
=ii! "
$strii# 3
;ii3 4
breakjj 
;jj 
casekk $
Enum_DunnageWorkflowStepkk )
.kk) *
TypeSelectionkk* 7
:kk7 8"
IsTypeSelectionVisiblell &
=ll' (
truell) -
;ll- .
CurrentStepTitlemm  
=mm! "
$strmm# 0
;mm0 1
breaknn 
;nn 
caseoo $
Enum_DunnageWorkflowStepoo )
.oo) *
PartSelectionoo* 7
:oo7 8"
IsPartSelectionVisiblepp &
=pp' (
truepp) -
;pp- .
CurrentStepTitleqq  
=qq! "
$strqq# 0
;qq0 1
breakrr 
;rr 
casess $
Enum_DunnageWorkflowStepss )
.ss) *
QuantityEntryss* 7
:ss7 8"
IsQuantityEntryVisiblett &
=tt' (
truett) -
;tt- .
CurrentStepTitleuu  
=uu! "
$struu# 3
;uu3 4
breakvv 
;vv 
caseww $
Enum_DunnageWorkflowStepww )
.ww) *
DetailsEntryww* 6
:ww6 7!
IsDetailsEntryVisiblexx %
=xx& '
truexx( ,
;xx, -
CurrentStepTitleyy  
=yy! "
$stryy# 2
;yy2 3
breakzz 
;zz 
case{{ $
Enum_DunnageWorkflowStep{{ )
.{{) *
Review{{* 0
:{{0 1
IsReviewVisible|| 
=||  !
true||" &
;||& '
CurrentStepTitle}}  
=}}! "
$str}}# 2
;}}2 3
break~~ 
;~~ 
case $
Enum_DunnageWorkflowStep )
.) *
ManualEntry* 5
:5 6"
IsManualEntryVisible
ÄÄ $
=
ÄÄ% &
true
ÄÄ' +
;
ÄÄ+ ,
CurrentStepTitle
ÅÅ  
=
ÅÅ! "
$str
ÅÅ# 1
;
ÅÅ1 2
break
ÇÇ 
;
ÇÇ 
case
ÉÉ &
Enum_DunnageWorkflowStep
ÉÉ )
.
ÉÉ) *
EditMode
ÉÉ* 2
:
ÉÉ2 3
IsEditModeVisible
ÑÑ !
=
ÑÑ" #
true
ÑÑ$ (
;
ÑÑ( )
CurrentStepTitle
ÖÖ  
=
ÖÖ! "
$str
ÖÖ# .
;
ÖÖ. /
break
ÜÜ 
;
ÜÜ 
}
áá 	
}
àà 
[
éé 
RelayCommand
éé 
]
éé 
private
èè 
void
èè #
ReturnToModeSelection
èè &
(
èè& '
)
èè' (
{
êê 
_workflowService
ëë 
.
ëë 
ClearSession
ëë %
(
ëë% &
)
ëë& '
;
ëë' (
_workflowService
íí 
.
íí 
GoToStep
íí !
(
íí! "&
Enum_DunnageWorkflowStep
íí" :
.
íí: ;
ModeSelection
íí; H
)
ííH I
;
ííI J
}
ìì 
[
ïï 
RelayCommand
ïï 
]
ïï 
private
ññ 
async
ññ 
Task
ññ 
AddLineAsync
ññ #
(
ññ# $
)
ññ$ %
{
óó 
await
ôô 
Task
ôô 
.
ôô 
CompletedTask
ôô  
;
ôô  !
}
öö 
}ùù £π
hC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Startup\Service_OnStartup_AppLifecycle.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Services		$ ,
.		, -
Startup		- 4
{

 
public 

class *
Service_OnStartup_AppLifecycle /
:0 1+
IService_OnStartup_AppLifecycle2 Q
{ 
private 
readonly 
IServiceProvider )
_serviceProvider* :
;: ;
private 
readonly #
IService_Authentication 0
_authService1 =
;= >
private 
readonly '
IService_UserSessionManager 4
_sessionManager5 D
;D E
private 
readonly !
IService_ErrorHandler .
_errorHandler/ <
;< =
private 
readonly 
IService_CSVWriter +

_csvWriter, 6
;6 7
private 
Views 
. 
Shared 
. %
Shared_SplashScreenWindow 6
?6 7
_splashScreen8 E
;E F
public *
Service_OnStartup_AppLifecycle -
(- .
IServiceProvider 
serviceProvider ,
,, -#
IService_Authentication #
authService$ /
,/ 0'
IService_UserSessionManager '
sessionManager( 6
,6 7!
IService_ErrorHandler !
errorHandler" .
,. /
IService_CSVWriter 
	csvWriter (
)( )
{ 	
_serviceProvider 
= 
serviceProvider .
;. /
_authService 
= 
authService &
;& '
_sessionManager 
= 
sessionManager ,
;, -
_errorHandler 
= 
errorHandler (
;( )

_csvWriter 
= 
	csvWriter "
;" #
}   	
public"" 
async"" 
Task"" 

StartAsync"" $
(""$ %
)""% &
{## 	
try$$ 
{%% 
_splashScreen'' 
='' 
_serviceProvider''  0
.''0 1
GetRequiredService''1 C
<''C D
Views''D I
.''I J
Shared''J P
.''P Q%
Shared_SplashScreenWindow''Q j
>''j k
(''k l
)''l m
;''m n
_splashScreen(( 
.(( 
Activate(( &
(((& '
)((' (
;((( )
UpdateSplash)) 
()) 
$num)) 
,)) 
$str))  9
)))9 :
;)): ;
await** 
Task** 
.** 
Delay**  
(**  !
$num**! $
)**$ %
;**% &
UpdateSplash-- 
(-- 
$num-- 
,--  
$str--! 9
)--9 :
;--: ;
var.. 

mainWindow.. 
=..  
_serviceProvider..! 1
...1 2
GetRequiredService..2 D
<..D E

MainWindow..E O
>..O P
(..P Q
)..Q R
;..R S
App// 
.// 

MainWindow// 
=//  

mainWindow//! +
;//+ ,
await22 
Task22 
.22 
Delay22  
(22  !
$num22! $
)22$ %
;22% &
UpdateSplash55 
(55 
$num55 
,55  
$str55! ;
)55; <
;55< =
await66 
Task66 
.66 
Delay66  
(66  !
$num66! $
)66$ %
;66% &
UpdateSplash99 
(99 
$num99 
,99  
$str99! ;
)99; <
;99< =
var:: 
windowsUser:: 
=::  !
Environment::" -
.::- .
UserName::. 6
;::6 7
var;; 
userCheckResult;; #
=;;$ %
await;;& +
_authService;;, 8
.;;8 9.
"AuthenticateByWindowsUsernameAsync;;9 [
(;;[ \
windowsUser;;\ g
);;g h
;;;h i

Model_User== 
?== 
authenticatedUser== -
===. /
null==0 4
;==4 5
string>> 

authMethod>> !
=>>" #
$str>>$ &
;>>& '
ifAA 
(AA 
!AA 
userCheckResultAA $
.AA$ %
SuccessAA% ,
)AA, -
{BB "
SetSplashIndeterminateCC *
(CC* +
$strCC+ d
)CCd e
;CCe f
varFF 
newUserViewModelFF (
=FF) *
_serviceProviderFF+ ;
.FF; <
GetRequiredServiceFF< N
<FFN O

ViewModelsFFO Y
.FFY Z
SharedFFZ `
.FF` a(
Shared_NewUserSetupViewModelFFa }
>FF} ~
(FF~ 
)	FF Ä
;
FFÄ Å
newUserViewModelGG $
.GG$ %
WindowsUsernameGG% 4
=GG5 6
windowsUserGG7 B
;GGB C
newUserViewModelHH $
.HH$ %
	CreatedByHH% .
=HH/ 0
windowsUserHH1 <
;HH< =
varJJ 
newUserDialogJJ %
=JJ& '
newJJ( +
ViewsJJ, 1
.JJ1 2
SharedJJ2 8
.JJ8 9%
Shared_NewUserSetupDialogJJ9 R
(JJR S
newUserViewModelJJS c
)JJc d
;JJd e
ifMM 
(MM 
_splashScreenMM %
?MM% &
.MM& '
ContentMM' .
isMM/ 1
	MicrosoftMM2 ;
.MM; <
UIMM< >
.MM> ?
XamlMM? C
.MMC D
	UIElementMMD M
rootElementMMN Y
)MMY Z
{NN 
newUserDialogOO %
.OO% &
XamlRootOO& .
=OO/ 0
rootElementOO1 <
.OO< =
XamlRootOO= E
;OOE F
}PP 
varSS 
dialogResultSS $
=SS% &
awaitSS' ,
newUserDialogSS- :
.SS: ;
	ShowAsyncSS; D
(SSD E
)SSE F
;SSF G
ifVV 
(VV 
newUserViewModelVV (
.VV( )
NewEmployeeNumberVV) :
>VV; <
$numVV= >
&&VV? A
!VVB C
newUserViewModelVVC S
.VVS T
IsCancelledVVT _
)VV_ `
{WW 
UpdateSplashYY $
(YY$ %
$numYY% '
,YY' (
$strYY) F
)YYF G
;YYG H
userCheckResultZZ '
=ZZ( )
awaitZZ* /
_authServiceZZ0 <
.ZZ< =.
"AuthenticateByWindowsUsernameAsyncZZ= _
(ZZ_ `
windowsUserZZ` k
)ZZk l
;ZZl m
if\\ 
(\\ 
userCheckResult\\ +
.\\+ ,
Success\\, 3
)\\3 4
{]] 
authenticatedUser^^ -
=^^. /
userCheckResult^^0 ?
.^^? @
User^^@ D
;^^D E
UpdateSplash__ (
(__( )
$num__) +
,__+ ,
$"__- /
$str__/ C
{__C D
authenticatedUser__D U
?__U V
.__V W
FullName__W _
}___ `
"__` a
)__a b
;__b c
}`` 
}aa 
elsebb 
ifbb 
(bb 
newUserViewModelbb -
.bb- .
IsCancelledbb. 9
)bb9 :
{cc 
awaitee 
_errorHandleree +
.ee+ ,
HandleErrorAsyncee, <
(ee< =
$strff S
,ffS T
Modelsgg "
.gg" #
Enumsgg# (
.gg( )
Enum_ErrorSeveritygg) ;
.gg; <
Infogg< @
,gg@ A

showDialoghh &
:hh& '
falsehh( -
)hh- .
;hh. /
_splashScreenkk %
?kk% &
.kk& '
Closekk' ,
(kk, -
)kk- .
;kk. /
ifnn 
(nn 
Appnn 
.nn  

MainWindownn  *
!=nn+ -
nullnn. 2
)nn2 3
{oo 
Apppp 
.pp  

MainWindowpp  *
.pp* +
Closepp+ 0
(pp0 1
)pp1 2
;pp2 3
}qq 
Applicationtt #
.tt# $
Currenttt$ +
.tt+ ,
Exittt, 0
(tt0 1
)tt1 2
;tt2 3
returnuu 
;uu 
}vv 
}ww 
elsexx 
{yy 
authenticatedUser{{ %
={{& '
userCheckResult{{( 7
.{{7 8
User{{8 <
;{{< =
}|| 
UpdateSplash 
( 
$num 
,  
$str! I
)I J
;J K
var
ÄÄ 
workstationConfig
ÄÄ %
=
ÄÄ& '
await
ÄÄ( -
_authService
ÄÄ. :
.
ÄÄ: ;(
DetectWorkstationTypeAsync
ÄÄ; U
(
ÄÄU V
)
ÄÄV W
;
ÄÄW X
System
ÉÉ 
.
ÉÉ 
Diagnostics
ÉÉ "
.
ÉÉ" #
Debug
ÉÉ# (
.
ÉÉ( )
	WriteLine
ÉÉ) 2
(
ÉÉ2 3
$"
ÉÉ3 5
$str
ÉÉ5 B
{
ÉÉB C
workstationConfig
ÉÉC T
.
ÉÉT U
ComputerName
ÉÉU a
}
ÉÉa b
"
ÉÉb c
)
ÉÉc d
;
ÉÉd e
System
ÑÑ 
.
ÑÑ 
Diagnostics
ÑÑ "
.
ÑÑ" #
Debug
ÑÑ# (
.
ÑÑ( )
	WriteLine
ÑÑ) 2
(
ÑÑ2 3
$"
ÑÑ3 5
$str
ÑÑ5 ;
{
ÑÑ; <
workstationConfig
ÑÑ< M
.
ÑÑM N
WorkstationType
ÑÑN ]
}
ÑÑ] ^
"
ÑÑ^ _
)
ÑÑ_ `
;
ÑÑ` a
System
ÖÖ 
.
ÖÖ 
Diagnostics
ÖÖ "
.
ÖÖ" #
Debug
ÖÖ# (
.
ÖÖ( )
	WriteLine
ÖÖ) 2
(
ÖÖ2 3
$"
ÖÖ3 5
$str
ÖÖ5 @
{
ÖÖ@ A
workstationConfig
ÖÖA R
.
ÖÖR S
IsSharedTerminal
ÖÖS c
}
ÖÖc d
"
ÖÖd e
)
ÖÖe f
;
ÖÖf g
System
ÜÜ 
.
ÜÜ 
Diagnostics
ÜÜ "
.
ÜÜ" #
Debug
ÜÜ# (
.
ÜÜ( )
	WriteLine
ÜÜ) 2
(
ÜÜ2 3
$"
ÜÜ3 5
$str
ÜÜ5 B
{
ÜÜB C
workstationConfig
ÜÜC T
.
ÜÜT U#
IsPersonalWorkstation
ÜÜU j
}
ÜÜj k
"
ÜÜk l
)
ÜÜl m
;
ÜÜm n
if
ââ 
(
ââ 
workstationConfig
ââ %
.
ââ% &#
IsPersonalWorkstation
ââ& ;
)
ââ; <
{
ää 
UpdateSplash
åå  
(
åå  !
$num
åå! #
,
åå# $
$str
åå% T
)
ååT U
;
ååU V

authMethod
çç 
=
çç  
$str
çç! /
;
çç/ 0
UpdateSplash
éé  
(
éé  !
$num
éé! #
,
éé# $
$"
éé% '
$str
éé' 0
{
éé0 1
authenticatedUser
éé1 B
?
ééB C
.
ééC D
FullName
ééD L
}
ééL M
"
ééM N
)
ééN O
;
ééO P
}
èè 
else
êê 
if
êê 
(
êê 
workstationConfig
êê *
.
êê* +
IsSharedTerminal
êê+ ;
)
êê; <
{
ëë 
authenticatedUser
îî %
=
îî& '
null
îî( ,
;
îî, -$
SetSplashIndeterminate
ññ *
(
ññ* +
$str
ññ+ _
)
ññ_ `
;
ññ` a
var
ôô 
loginViewModel
ôô &
=
ôô' (
_serviceProvider
ôô) 9
.
ôô9 : 
GetRequiredService
ôô: L
<
ôôL M

ViewModels
ôôM W
.
ôôW X
Shared
ôôX ^
.
ôô^ _2
#Shared_SharedTerminalLoginViewModelôô_ Ç
>ôôÇ É
(ôôÉ Ñ
)ôôÑ Ö
;ôôÖ Ü
var
öö 
loginDialog
öö #
=
öö$ %
new
öö& )
Views
öö* /
.
öö/ 0
Shared
öö0 6
.
öö6 7.
 Shared_SharedTerminalLoginDialog
öö7 W
(
ööW X
loginViewModel
ööX f
)
ööf g
;
öög h
if
ùù 
(
ùù 
_splashScreen
ùù %
?
ùù% &
.
ùù& '
Content
ùù' .
is
ùù/ 1
	Microsoft
ùù2 ;
.
ùù; <
UI
ùù< >
.
ùù> ?
Xaml
ùù? C
.
ùùC D
	UIElement
ùùD M
rootElement
ùùN Y
)
ùùY Z
{
ûû 
loginDialog
üü #
.
üü# $
XamlRoot
üü$ ,
=
üü- .
rootElement
üü/ :
.
üü: ;
XamlRoot
üü; C
;
üüC D
}
†† 
var
££ 
dialogResult
££ $
=
££% &
await
££' ,
loginDialog
££- 8
.
££8 9
	ShowAsync
££9 B
(
££B C
)
££C D
;
££D E
if
¶¶ 
(
¶¶ 
loginViewModel
¶¶ &
.
¶¶& '
AuthenticatedUser
¶¶' 8
!=
¶¶9 ;
null
¶¶< @
&&
¶¶A C
!
¶¶D E
loginViewModel
¶¶E S
.
¶¶S T
IsCancelled
¶¶T _
&&
¶¶` b
!
¶¶c d
loginViewModel
¶¶d r
.
¶¶r s
IsLockedOut
¶¶s ~
)
¶¶~ 
{
ßß 
authenticatedUser
©© )
=
©©* +
loginViewModel
©©, :
.
©©: ;
AuthenticatedUser
©©; L
;
©©L M

authMethod
™™ "
=
™™# $
$str
™™% 0
;
™™0 1
UpdateSplash
´´ $
(
´´$ %
$num
´´% '
,
´´' (
$"
´´) +
$str
´´+ 4
{
´´4 5
authenticatedUser
´´5 F
.
´´F G
FullName
´´G O
}
´´O P
"
´´P Q
)
´´Q R
;
´´R S
}
¨¨ 
else
≠≠ 
if
≠≠ 
(
≠≠ 
loginViewModel
≠≠ +
.
≠≠+ ,
IsLockedOut
≠≠, 7
)
≠≠7 8
{
ÆÆ 
await
∞∞ 
_errorHandler
∞∞ +
.
∞∞+ ,
HandleErrorAsync
∞∞, <
(
∞∞< =
$str
±± `
,
±±` a
Models
≤≤ "
.
≤≤" #
Enums
≤≤# (
.
≤≤( ) 
Enum_ErrorSeverity
≤≤) ;
.
≤≤; <
Warning
≤≤< C
,
≤≤C D

showDialog
≥≥ &
:
≥≥& '
false
≥≥( -
)
≥≥- .
;
≥≥. /
	Microsoft
∂∂ !
.
∂∂! "
Windows
∂∂" )
.
∂∂) *
AppLifecycle
∂∂* 6
.
∂∂6 7
AppInstance
∂∂7 B
.
∂∂B C

GetCurrent
∂∂C M
(
∂∂M N
)
∂∂N O
.
∂∂O P
UnregisterKey
∂∂P ]
(
∂∂] ^
)
∂∂^ _
;
∂∂_ `
System
∑∑ 
.
∑∑ 
Environment
∑∑ *
.
∑∑* +
Exit
∑∑+ /
(
∑∑/ 0
$num
∑∑0 1
)
∑∑1 2
;
∑∑2 3
return
∏∏ 
;
∏∏ 
}
ππ 
else
∫∫ 
if
∫∫ 
(
∫∫ 
loginViewModel
∫∫ +
.
∫∫+ ,
IsCancelled
∫∫, 7
)
∫∫7 8
{
ªª 
await
ΩΩ 
_errorHandler
ΩΩ +
.
ΩΩ+ ,
HandleErrorAsync
ΩΩ, <
(
ΩΩ< =
$str
ææ H
,
ææH I
Models
øø "
.
øø" #
Enums
øø# (
.
øø( ) 
Enum_ErrorSeverity
øø) ;
.
øø; <
Info
øø< @
,
øø@ A

showDialog
¿¿ &
:
¿¿& '
false
¿¿( -
)
¿¿- .
;
¿¿. /
System
¬¬ 
.
¬¬ 
Environment
¬¬ *
.
¬¬* +
Exit
¬¬+ /
(
¬¬/ 0
$num
¬¬0 1
)
¬¬1 2
;
¬¬2 3
return
√√ 
;
√√ 
}
ƒƒ 
else
≈≈ 
{
∆∆ 
await
»» 
_errorHandler
»» +
.
»»+ ,
HandleErrorAsync
»», <
(
»»< =
$str
…… T
,
……T U
Models
   "
.
  " #
Enums
  # (
.
  ( ) 
Enum_ErrorSeverity
  ) ;
.
  ; <
Info
  < @
,
  @ A

showDialog
ÀÀ &
:
ÀÀ& '
false
ÀÀ( -
)
ÀÀ- .
;
ÀÀ. /
System
ÕÕ 
.
ÕÕ 
Environment
ÕÕ *
.
ÕÕ* +
Exit
ÕÕ+ /
(
ÕÕ/ 0
$num
ÕÕ0 1
)
ÕÕ1 2
;
ÕÕ2 3
return
ŒŒ 
;
ŒŒ 
}
œœ 
}
–– 
if
”” 
(
”” 
authenticatedUser
”” %
!=
””& (
null
””) -
)
””- .
{
‘‘ 
UpdateSplash
’’  
(
’’  !
$num
’’! #
,
’’# $
$str
’’% ?
)
’’? @
;
’’@ A
_sessionManager
÷÷ #
.
÷÷# $
CreateSession
÷÷$ 1
(
÷÷1 2
authenticatedUser
÷÷2 C
,
÷÷C D
workstationConfig
÷÷E V
,
÷÷V W

authMethod
÷÷X b
)
÷÷b c
;
÷÷c d
_sessionManager
◊◊ #
.
◊◊# $$
StartTimeoutMonitoring
◊◊$ :
(
◊◊: ;
)
◊◊; <
;
◊◊< =
if
⁄⁄ 
(
⁄⁄ 
App
⁄⁄ 
.
⁄⁄ 

MainWindow
⁄⁄ &
is
⁄⁄' )

MainWindow
⁄⁄* 4
mainWin
⁄⁄5 <
)
⁄⁄< =
{
€€ 
mainWin
‹‹ 
.
‹‹  
DispatcherQueue
‹‹  /
.
‹‹/ 0

TryEnqueue
‹‹0 :
(
‹‹: ;
(
‹‹; <
)
‹‹< =
=>
‹‹> @
mainWin
‹‹A H
.
‹‹H I
UpdateUserDisplay
‹‹I Z
(
‹‹Z [
)
‹‹[ \
)
‹‹\ ]
;
‹‹] ^
}
›› 
}
ﬁﬁ 
else
ﬂﬂ 
{
‡‡ 
await
‚‚ 
_errorHandler
‚‚ '
.
‚‚' (
HandleErrorAsync
‚‚( 8
(
‚‚8 9
$str
„„ E
,
„„E F
Models
‰‰ 
.
‰‰ 
Enums
‰‰ $
.
‰‰$ % 
Enum_ErrorSeverity
‰‰% 7
.
‰‰7 8
Warning
‰‰8 ?
,
‰‰? @

showDialog
ÂÂ "
:
ÂÂ" #
false
ÂÂ$ )
)
ÂÂ) *
;
ÂÂ* +
System
ÊÊ 
.
ÊÊ 
Environment
ÊÊ &
.
ÊÊ& '
Exit
ÊÊ' +
(
ÊÊ+ ,
$num
ÊÊ, -
)
ÊÊ- .
;
ÊÊ. /
return
ÁÁ 
;
ÁÁ 
}
ËË 
UpdateSplash
ÎÎ 
(
ÎÎ 
$num
ÎÎ  
,
ÎÎ  !
$str
ÎÎ" *
)
ÎÎ* +
;
ÎÎ+ ,
await
ÏÏ 
Task
ÏÏ 
.
ÏÏ 
Delay
ÏÏ  
(
ÏÏ  !
$num
ÏÏ! $
)
ÏÏ$ %
;
ÏÏ% &
App
ÔÔ 
.
ÔÔ 

MainWindow
ÔÔ 
?
ÔÔ 
.
ÔÔ  
Activate
ÔÔ  (
(
ÔÔ( )
)
ÔÔ) *
;
ÔÔ* +
if
 
(
 
_splashScreen
 !
!=
" $
null
% )
)
) *
{
ÒÒ 
_splashScreen
ÚÚ !
.
ÚÚ! "!
IsProgrammaticClose
ÚÚ" 5
=
ÚÚ6 7
true
ÚÚ8 <
;
ÚÚ< =
_splashScreen
ÛÛ !
.
ÛÛ! "
Close
ÛÛ" '
(
ÛÛ' (
)
ÛÛ( )
;
ÛÛ) *
}
ÙÙ 
_splashScreen
ıı 
=
ıı 
null
ıı  $
;
ıı$ %
}
¯¯ 
catch
˘˘ 
(
˘˘ 
	Exception
˘˘ 
ex
˘˘ 
)
˘˘  
{
˙˙ 
await
˚˚ 
_errorHandler
˚˚ #
.
˚˚# $
HandleErrorAsync
˚˚$ 4
(
˚˚4 5
$str
˚˚5 E
,
˚˚E F
Models
˚˚G M
.
˚˚M N
Enums
˚˚N S
.
˚˚S T 
Enum_ErrorSeverity
˚˚T f
.
˚˚f g
Critical
˚˚g o
,
˚˚o p
ex
˚˚q s
)
˚˚s t
;
˚˚t u
_splashScreen
¸¸ 
?
¸¸ 
.
¸¸ 
Close
¸¸ $
(
¸¸$ %
)
¸¸% &
;
¸¸& '
System
˝˝ 
.
˝˝ 
Environment
˝˝ "
.
˝˝" #
Exit
˝˝# '
(
˝˝' (
$num
˝˝( )
)
˝˝) *
;
˝˝* +
}
˛˛ 
}
ˇˇ 	
private
ÅÅ 
void
ÅÅ 
UpdateSplash
ÅÅ !
(
ÅÅ! "
double
ÅÅ" (

percentage
ÅÅ) 3
,
ÅÅ3 4
string
ÅÅ5 ;
message
ÅÅ< C
)
ÅÅC D
{
ÇÇ 	
_splashScreen
ÉÉ 
?
ÉÉ 
.
ÉÉ 
	ViewModel
ÉÉ $
.
ÉÉ$ %
UpdateProgress
ÉÉ% 3
(
ÉÉ3 4

percentage
ÉÉ4 >
,
ÉÉ> ?
message
ÉÉ@ G
)
ÉÉG H
;
ÉÉH I
}
ÑÑ 	
private
ÜÜ 
void
ÜÜ $
SetSplashIndeterminate
ÜÜ +
(
ÜÜ+ ,
string
ÜÜ, 2
message
ÜÜ3 :
)
ÜÜ: ;
{
áá 	
_splashScreen
àà 
?
àà 
.
àà 
	ViewModel
àà $
.
àà$ %
SetIndeterminate
àà% 5
(
àà5 6
message
àà6 =
)
àà= >
;
àà> ?
}
ââ 	
private
ãã 
async
ãã 
Task
ãã (
CheckAndResetCSVFilesAsync
ãã 5
(
ãã5 6
)
ãã6 7
{
åå 	
if
ññ 
(
ññ 
App
ññ 
.
ññ 

MainWindow
ññ 
==
ññ !
null
ññ" &
)
ññ& '
return
ññ( .
;
ññ. /
await
òò 
App
òò 
.
òò 

MainWindow
òò  
.
òò  !
DispatcherQueue
òò! 0
.
òò0 1
EnqueueAsync
òò1 =
(
òò= >
async
òò> C
(
òòD E
)
òòE F
=>
òòG I
{
ôô 
var
öö 
dialog
öö 
=
öö 
new
öö  
	Microsoft
öö! *
.
öö* +
UI
öö+ -
.
öö- .
Xaml
öö. 2
.
öö2 3
Controls
öö3 ;
.
öö; <
ContentDialog
öö< I
{
õõ 
Title
úú 
=
úú 
$str
úú .
,
úú. /
Content
ùù 
=
ùù 
$str
ùù o
,
ùùo p
PrimaryButtonText
ûû %
=
ûû& '
$str
ûû( 4
,
ûû4 5
CloseButtonText
üü #
=
üü$ %
$str
üü& 4
,
üü4 5
DefaultButton
†† !
=
††" #
	Microsoft
††$ -
.
††- .
UI
††. 0
.
††0 1
Xaml
††1 5
.
††5 6
Controls
††6 >
.
††> ?!
ContentDialogButton
††? R
.
††R S
Close
††S X
,
††X Y
XamlRoot
°° 
=
°° 
App
°° "
.
°°" #

MainWindow
°°# -
.
°°- .
Content
°°. 5
.
°°5 6
XamlRoot
°°6 >
}
¢¢ 
;
¢¢ 
var
§§ 
result
§§ 
=
§§ 
await
§§ "
dialog
§§# )
.
§§) *
	ShowAsync
§§* 3
(
§§3 4
)
§§4 5
;
§§5 6
if
¶¶ 
(
¶¶ 
result
¶¶ 
==
¶¶ 
	Microsoft
¶¶ '
.
¶¶' (
UI
¶¶( *
.
¶¶* +
Xaml
¶¶+ /
.
¶¶/ 0
Controls
¶¶0 8
.
¶¶8 9!
ContentDialogResult
¶¶9 L
.
¶¶L M
Primary
¶¶M T
)
¶¶T U
{
ßß 
await
®® 

_csvWriter
®® $
.
®®$ %!
DeleteCSVFilesAsync
®®% 8
(
®®8 9
)
®®9 :
;
®®: ;
}
©© 
}
™™ 
)
™™ 
;
™™ 
}
´´ 	
}
¨¨ 
}≠≠ ô
PC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Service_Window.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
;, -
public 
class 
Service_Window 
: 
IService_Window -
{ 
public 

XamlRoot 
? 
GetXamlRoot  
(  !
)! "
{		 
return

 
App

 
.

 

MainWindow

 
?

 
.

 
Content

 &
?

& '
.

' (
XamlRoot

( 0
;

0 1
} 
} Í‰
eC:\Users\johnk\source\repos\MTM_Receiving_Application\ViewModels\Dunnage\Dunnage_EditModeViewModel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

ViewModels$ .
.. /
Dunnage/ 6
;6 7
public 
partial 
class %
Dunnage_EditModeViewModel .
:/ 0 
Shared_BaseViewModel1 E
{ 
private 
readonly "
IService_MySQL_Dunnage +
_dunnageService, ;
;; <
private 
readonly 
IService_Pagination (
_paginationService) ;
;; <
private 
readonly %
IService_DunnageCSVWriter .

_csvWriter/ 9
;9 :
private 
readonly $
IService_DunnageWorkflow -
_workflowService. >
;> ?
private 
readonly 
IService_Window $
_windowService% 3
;3 4
private 
const 
int 
	PAGE_SIZE 
=  !
$num" $
;$ %
public 
%
Dunnage_EditModeViewModel $
($ %"
IService_MySQL_Dunnage 
dunnageService -
,- .
IService_Pagination   
paginationService   -
,  - .%
IService_DunnageCSVWriter!! !
	csvWriter!!" +
,!!+ ,$
IService_DunnageWorkflow""  
workflowService""! 0
,""0 1
IService_Window## 
windowService## %
,##% &!
IService_ErrorHandler$$ 
errorHandler$$ *
,$$* +#
IService_LoggingUtility%% 
logger%%  &
)%%& '
:%%( )
base%%* .
(%%. /
errorHandler%%/ ;
,%%; <
logger%%= C
)%%C D
{&& 
_dunnageService'' 
='' 
dunnageService'' (
;''( )
_paginationService(( 
=(( 
paginationService(( .
;((. /

_csvWriter)) 
=)) 
	csvWriter)) 
;)) 
_workflowService** 
=** 
workflowService** *
;*** +
_windowService++ 
=++ 
windowService++ &
;++& '
ToDate.. 
=.. 
DateTimeOffset.. 
...  
Now..  #
;..# $
FromDate// 
=// 
DateTimeOffset// !
.//! "
Now//" %
.//% &
AddDays//& -
(//- .
-//. /
$num/// 0
)//0 1
;//1 2
}00 
[44 
ObservableProperty44 
]44 
private55  
ObservableCollection55  
<55  !
Model_DunnageLoad55! 2
>552 3
_filteredLoads554 B
=55C D
new55E H
(55H I
)55I J
;55J K
[77 
ObservableProperty77 
]77 
private88  
ObservableCollection88  
<88  !
Model_DunnageLoad88! 2
>882 3
_selectedLoads884 B
=88C D
new88E H
(88H I
)88I J
;88J K
[:: 
ObservableProperty:: 
]:: 
private;; 
DateTimeOffset;; 
?;; 
	_fromDate;; %
;;;% &
[== 
ObservableProperty== 
]== 
private>> 
DateTimeOffset>> 
?>> 
_toDate>> #
;>># $
[@@ 
ObservableProperty@@ 
]@@ 
privateAA 
intAA 
_currentPageAA 
=AA 
$numAA  
;AA  !
[CC 
ObservablePropertyCC 
]CC 
privateDD 
intDD 
_totalPagesDD 
=DD 
$numDD 
;DD  
[FF 
ObservablePropertyFF 
]FF 
privateGG 
intGG 
_totalRecordsGG 
=GG 
$numGG  !
;GG! "
[II 
ObservablePropertyII 
]II 
privateJJ 
boolJJ 
_canSaveJJ 
=JJ 
falseJJ !
;JJ! "
[LL 
ObservablePropertyLL 
]LL 
privateMM 
boolMM 
_canNavigateMM 
=MM 
falseMM  %
;MM% &
privateOO 
ListOO 
<OO 
Model_DunnageLoadOO "
>OO" #
	_allLoadsOO$ -
=OO. /
newOO0 3
(OO3 4
)OO4 5
;OO5 6
[UU 
RelayCommandUU 
]UU 
privateVV 
asyncVV 
TaskVV  
LoadFromHistoryAsyncVV +
(VV+ ,
)VV, -
{WW 
tryXX 
{YY 	
IsBusyZZ 
=ZZ 
trueZZ 
;ZZ 
StatusMessage[[ 
=[[ 
$str[[ 8
;[[8 9
var]] 
	startDate]] 
=]] 
FromDate]] $
?]]$ %
.]]% &
DateTime]]& .
??]]/ 1
DateTime]]2 :
.]]: ;
Now]]; >
.]]> ?
AddDays]]? F
(]]F G
-]]G H
$num]]H I
)]]I J
;]]J K
var^^ 
endDate^^ 
=^^ 
ToDate^^  
?^^  !
.^^! "
DateTime^^" *
??^^+ -
DateTime^^. 6
.^^6 7
Now^^7 :
;^^: ;
var`` 
result`` 
=`` 
await`` 
_dunnageService`` .
.``. /$
GetLoadsByDateRangeAsync``/ G
(``G H
	startDate``H Q
,``Q R
endDate``S Z
)``Z [
;``[ \
ifbb 
(bb 
!bb 
resultbb 
.bb 
Successbb 
)bb  
{cc 
awaitdd 
_errorHandlerdd #
.dd# $
HandleDaoErrorAsyncdd$ 7
(dd7 8
resultdd8 >
,dd> ?
$strdd@ V
,ddV W
trueddX \
)dd\ ]
;dd] ^
returnee 
;ee 
}ff 
	_allLoadshh 
=hh 
resulthh 
.hh 
Datahh #
??hh$ &
newhh' *
Listhh+ /
<hh/ 0
Model_DunnageLoadhh0 A
>hhA B
(hhB C
)hhC D
;hhD E
TotalRecordsii 
=ii 
	_allLoadsii $
.ii$ %
Countii% *
;ii* +
_paginationServicell 
.ll 
	SetSourcell (
(ll( )
	_allLoadsll) 2
)ll2 3
;ll3 4

TotalPagesmm 
=mm 
_paginationServicemm +
.mm+ ,

TotalPagesmm, 6
;mm6 7
CurrentPagenn 
=nn 
_paginationServicenn ,
.nn, -
CurrentPagenn- 8
;nn8 9
LoadPageqq 
(qq 
$numqq 
)qq 
;qq 
CanNavigatess 
=ss 

TotalPagesss $
>ss% &
$numss' (
;ss( )
StatusMessagett 
=tt 
$"tt 
$strtt %
{tt% &
TotalRecordstt& 2
}tt2 3
$strtt3 ;
"tt; <
;tt< =
_loggervv 
.vv 
LogInfovv 
(vv 
$"vv 
$strvv %
{vv% &
TotalRecordsvv& 2
}vv2 3
$strvv3 J
{vvJ K
	startDatevvK T
:vvT U
$strvvU V
}vvV W
$strvvW [
{vv[ \
endDatevv\ c
:vvc d
$strvvd e
}vve f
"vvf g
,vvg h
$strvvi s
)vvs t
;vvt u
}ww 	
catchxx 
(xx 
	Exceptionxx 
exxx 
)xx 
{yy 	
awaitzz 
_errorHandlerzz 
.zz  
HandleErrorAsynczz  0
(zz0 1
$str{{ /
,{{/ 0
Enum_ErrorSeverity|| "
.||" #
Error||# (
,||( )
ex}} 
,}} 
true~~ 
) 
; 
}
ÄÄ 	
finally
ÅÅ 
{
ÇÇ 	
IsBusy
ÉÉ 
=
ÉÉ 
false
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
}
ÖÖ 
[
áá 
RelayCommand
áá 
]
áá 
private
àà 
async
àà 
Task
àà !
SetFilterTodayAsync
àà *
(
àà* +
)
àà+ ,
{
ââ 
FromDate
ää 
=
ää 
DateTime
ää 
.
ää 
Now
ää 
.
ää  
Date
ää  $
;
ää$ %
ToDate
ãã 
=
ãã 
DateTime
ãã 
.
ãã 
Now
ãã 
.
ãã 
Date
ãã "
;
ãã" #
await
åå "
LoadFromHistoryAsync
åå "
(
åå" #
)
åå# $
;
åå$ %
}
çç 
[
èè 
RelayCommand
èè 
]
èè 
private
êê 
async
êê 
Task
êê $
SetFilterThisWeekAsync
êê -
(
êê- .
)
êê. /
{
ëë 
var
íí 
today
íí 
=
íí 
DateTime
íí 
.
íí 
Now
íí  
.
íí  !
Date
íí! %
;
íí% &
var
ìì 
startOfWeek
ìì 
=
ìì 
today
ìì 
.
ìì  
AddDays
ìì  '
(
ìì' (
-
ìì( )
(
ìì) *
int
ìì* -
)
ìì- .
today
ìì. 3
.
ìì3 4
	DayOfWeek
ìì4 =
)
ìì= >
;
ìì> ?
FromDate
îî 
=
îî 
startOfWeek
îî 
;
îî 
ToDate
ïï 
=
ïï 
today
ïï 
;
ïï 
await
ññ "
LoadFromHistoryAsync
ññ "
(
ññ" #
)
ññ# $
;
ññ$ %
}
óó 
[
ôô 
RelayCommand
ôô 
]
ôô 
private
öö 
async
öö 
Task
öö %
SetFilterThisMonthAsync
öö .
(
öö. /
)
öö/ 0
{
õõ 
var
úú 
today
úú 
=
úú 
DateTime
úú 
.
úú 
Now
úú  
.
úú  !
Date
úú! %
;
úú% &
FromDate
ùù 
=
ùù 
new
ùù 
DateTime
ùù 
(
ùù  
today
ùù  %
.
ùù% &
Year
ùù& *
,
ùù* +
today
ùù, 1
.
ùù1 2
Month
ùù2 7
,
ùù7 8
$num
ùù9 :
)
ùù: ;
;
ùù; <
ToDate
ûû 
=
ûû 
today
ûû 
;
ûû 
await
üü "
LoadFromHistoryAsync
üü "
(
üü" #
)
üü# $
;
üü$ %
}
†† 
[
¢¢ 
RelayCommand
¢¢ 
]
¢¢ 
private
££ 
async
££ 
Task
££ #
SetFilterShowAllAsync
££ ,
(
££, -
)
££- .
{
§§ 
FromDate
•• 
=
•• 
DateTime
•• 
.
•• 
Now
•• 
.
••  
Date
••  $
.
••$ %
AddYears
••% -
(
••- .
-
••. /
$num
••/ 0
)
••0 1
;
••1 2
ToDate
¶¶ 
=
¶¶ 
DateTime
¶¶ 
.
¶¶ 
Now
¶¶ 
.
¶¶ 
Date
¶¶ "
;
¶¶" #
await
ßß "
LoadFromHistoryAsync
ßß "
(
ßß" #
)
ßß# $
;
ßß$ %
}
®® 
[
™™ 
RelayCommand
™™ 
]
™™ 
private
´´ 
void
´´ 
SetDateRangeToday
´´ "
(
´´" #
)
´´# $
{
¨¨ 
FromDate
≠≠ 
=
≠≠ 
DateTime
≠≠ 
.
≠≠ 
Now
≠≠ 
.
≠≠  
Date
≠≠  $
;
≠≠$ %
ToDate
ÆÆ 
=
ÆÆ 
DateTime
ÆÆ 
.
ÆÆ 
Now
ÆÆ 
.
ÆÆ 
Date
ÆÆ "
;
ÆÆ" #
}
ØØ 
[
±± 
RelayCommand
±± 
]
±± 
private
≤≤ 
void
≤≤ "
SetDateRangeLastWeek
≤≤ %
(
≤≤% &
)
≤≤& '
{
≥≥ 
ToDate
¥¥ 
=
¥¥ 
DateTime
¥¥ 
.
¥¥ 
Now
¥¥ 
.
¥¥ 
Date
¥¥ "
;
¥¥" #
FromDate
µµ 
=
µµ 
DateTime
µµ 
.
µµ 
Now
µµ 
.
µµ  
Date
µµ  $
.
µµ$ %
AddDays
µµ% ,
(
µµ, -
-
µµ- .
$num
µµ. /
)
µµ/ 0
;
µµ0 1
}
∂∂ 
[
∏∏ 
RelayCommand
∏∏ 
]
∏∏ 
private
ππ 
void
ππ #
SetDateRangeLastMonth
ππ &
(
ππ& '
)
ππ' (
{
∫∫ 
ToDate
ªª 
=
ªª 
DateTime
ªª 
.
ªª 
Now
ªª 
.
ªª 
Date
ªª "
;
ªª" #
FromDate
ºº 
=
ºº 
DateTime
ºº 
.
ºº 
Now
ºº 
.
ºº  
Date
ºº  $
.
ºº$ %
	AddMonths
ºº% .
(
ºº. /
-
ºº/ 0
$num
ºº0 1
)
ºº1 2
;
ºº2 3
}
ΩΩ 
[
√√ 
RelayCommand
√√ 
]
√√ 
private
ƒƒ 
void
ƒƒ 
	FirstPage
ƒƒ 
(
ƒƒ 
)
ƒƒ 
{
≈≈ 
if
∆∆ 

(
∆∆ 
CurrentPage
∆∆ 
==
∆∆ 
$num
∆∆ 
)
∆∆ 
return
∆∆ $
;
∆∆$ %
LoadPage
«« 
(
«« 
$num
«« 
)
«« 
;
«« 
}
»» 
[
   
RelayCommand
   
]
   
private
ÀÀ 
void
ÀÀ 
PreviousPage
ÀÀ 
(
ÀÀ 
)
ÀÀ 
{
ÃÃ 
if
ÕÕ 

(
ÕÕ 
CurrentPage
ÕÕ 
<=
ÕÕ 
$num
ÕÕ 
)
ÕÕ 
return
ÕÕ $
;
ÕÕ$ %
LoadPage
ŒŒ 
(
ŒŒ 
CurrentPage
ŒŒ 
-
ŒŒ 
$num
ŒŒ  
)
ŒŒ  !
;
ŒŒ! "
}
œœ 
[
—— 
RelayCommand
—— 
]
—— 
private
““ 
void
““ 
NextPage
““ 
(
““ 
)
““ 
{
”” 
if
‘‘ 

(
‘‘ 
CurrentPage
‘‘ 
>=
‘‘ 

TotalPages
‘‘ %
)
‘‘% &
return
‘‘' -
;
‘‘- .
LoadPage
’’ 
(
’’ 
CurrentPage
’’ 
+
’’ 
$num
’’  
)
’’  !
;
’’! "
}
÷÷ 
[
ÿÿ 
RelayCommand
ÿÿ 
]
ÿÿ 
private
ŸŸ 
void
ŸŸ 
LastPage
ŸŸ 
(
ŸŸ 
)
ŸŸ 
{
⁄⁄ 
if
€€ 

(
€€ 
CurrentPage
€€ 
==
€€ 

TotalPages
€€ %
)
€€% &
return
€€' -
;
€€- .
LoadPage
‹‹ 
(
‹‹ 

TotalPages
‹‹ 
)
‹‹ 
;
‹‹ 
}
›› 
private
ﬂﬂ 
void
ﬂﬂ 
LoadPage
ﬂﬂ 
(
ﬂﬂ 
int
ﬂﬂ 

pageNumber
ﬂﬂ (
)
ﬂﬂ( )
{
‡‡  
_paginationService
·· 
.
·· 
GoToPage
·· #
(
··# $

pageNumber
··$ .
)
··. /
;
··/ 0
CurrentPage
‚‚ 
=
‚‚  
_paginationService
‚‚ (
.
‚‚( )
CurrentPage
‚‚) 4
;
‚‚4 5
var
‰‰ 
	pageLoads
‰‰ 
=
‰‰  
_paginationService
‰‰ *
.
‰‰* +!
GetCurrentPageItems
‰‰+ >
<
‰‰> ?
Model_DunnageLoad
‰‰? P
>
‰‰P Q
(
‰‰Q R
)
‰‰R S
;
‰‰S T
FilteredLoads
ÊÊ 
.
ÊÊ 
Clear
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
foreach
ÁÁ 
(
ÁÁ 
var
ÁÁ 
load
ÁÁ 
in
ÁÁ 
	pageLoads
ÁÁ &
)
ÁÁ& '
{
ËË 	
FilteredLoads
ÈÈ 
.
ÈÈ 
Add
ÈÈ 
(
ÈÈ 
load
ÈÈ "
)
ÈÈ" #
;
ÈÈ# $
}
ÍÍ 	
StatusMessage
ÏÏ 
=
ÏÏ 
$"
ÏÏ 
$str
ÏÏ 
{
ÏÏ  
CurrentPage
ÏÏ  +
}
ÏÏ+ ,
$str
ÏÏ, 0
{
ÏÏ0 1

TotalPages
ÏÏ1 ;
}
ÏÏ; <
"
ÏÏ< =
;
ÏÏ= >
_logger
ÌÌ 
.
ÌÌ 
LogInfo
ÌÌ 
(
ÌÌ 
$"
ÌÌ 
$str
ÌÌ &
{
ÌÌ& '
CurrentPage
ÌÌ' 2
}
ÌÌ2 3
$str
ÌÌ3 7
{
ÌÌ7 8

TotalPages
ÌÌ8 B
}
ÌÌB C
"
ÌÌC D
,
ÌÌD E
$str
ÌÌF P
)
ÌÌP Q
;
ÌÌQ R
}
ÓÓ 
[
ÙÙ 
RelayCommand
ÙÙ 
]
ÙÙ 
private
ıı 
void
ıı 
	SelectAll
ıı 
(
ıı 
)
ıı 
{
ˆˆ 
SelectedLoads
˜˜ 
.
˜˜ 
Clear
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
foreach
¯¯ 
(
¯¯ 
var
¯¯ 
load
¯¯ 
in
¯¯ 
FilteredLoads
¯¯ *
)
¯¯* +
{
˘˘ 	
SelectedLoads
˙˙ 
.
˙˙ 
Add
˙˙ 
(
˙˙ 
load
˙˙ "
)
˙˙" #
;
˙˙# $
}
˚˚ 	
UpdateCanSave
˝˝ 
(
˝˝ 
)
˝˝ 
;
˝˝ 
_logger
˛˛ 
.
˛˛ 
LogInfo
˛˛ 
(
˛˛ 
$"
˛˛ 
$str
˛˛ '
{
˛˛' (
FilteredLoads
˛˛( 5
.
˛˛5 6
Count
˛˛6 ;
}
˛˛; <
$str
˛˛< J
"
˛˛J K
,
˛˛K L
$str
˛˛M W
)
˛˛W X
;
˛˛X Y
}
ˇˇ 
[
ÅÅ 
RelayCommand
ÅÅ 
]
ÅÅ 
private
ÇÇ 
void
ÇÇ  
RemoveSelectedRows
ÇÇ #
(
ÇÇ# $
)
ÇÇ$ %
{
ÉÉ 
if
ÑÑ 

(
ÑÑ 
SelectedLoads
ÑÑ 
.
ÑÑ 
Count
ÑÑ 
==
ÑÑ  "
$num
ÑÑ# $
)
ÑÑ$ %
return
ÑÑ& ,
;
ÑÑ, -
var
ÜÜ 
loadsToRemove
ÜÜ 
=
ÜÜ 
SelectedLoads
ÜÜ )
.
ÜÜ) *
ToList
ÜÜ* 0
(
ÜÜ0 1
)
ÜÜ1 2
;
ÜÜ2 3
foreach
àà 
(
àà 
var
àà 
load
àà 
in
àà 
loadsToRemove
àà *
)
àà* +
{
ââ 	
FilteredLoads
ää 
.
ää 
Remove
ää  
(
ää  !
load
ää! %
)
ää% &
;
ää& '
	_allLoads
ãã 
.
ãã 
Remove
ãã 
(
ãã 
load
ãã !
)
ãã! "
;
ãã" #
}
åå 	
SelectedLoads
éé 
.
éé 
Clear
éé 
(
éé 
)
éé 
;
éé 
TotalRecords
èè 
=
èè 
	_allLoads
èè  
.
èè  !
Count
èè! &
;
èè& '
UpdateCanSave
êê 
(
êê 
)
êê 
;
êê 
_logger
íí 
.
íí 
LogInfo
íí 
(
íí 
$"
íí 
$str
íí "
{
íí" #
loadsToRemove
íí# 0
.
íí0 1
Count
íí1 6
}
íí6 7
$str
íí7 =
"
íí= >
,
íí> ?
$str
íí@ J
)
ííJ K
;
ííK L
}
ìì 
[
ôô 
RelayCommand
ôô 
]
ôô 
private
öö 
async
öö 
Task
öö 
SaveAllAsync
öö #
(
öö# $
)
öö$ %
{
õõ 
if
úú 

(
úú 
	_allLoads
úú 
.
úú 
Count
úú 
==
úú 
$num
úú  
)
úú  !
return
úú" (
;
úú( )
try
ûû 
{
üü 	
IsBusy
†† 
=
†† 
true
†† 
;
†† 
CanSave
°° 
=
°° 
false
°° 
;
°° 
StatusMessage
¢¢ 
=
¢¢ 
$str
¢¢ /
;
¢¢/ 0
foreach
•• 
(
•• 
var
•• 
load
•• 
in
••  
	_allLoads
••! *
)
••* +
{
¶¶ 
if
ßß 
(
ßß 
string
ßß 
.
ßß  
IsNullOrWhiteSpace
ßß -
(
ßß- .
load
ßß. 2
.
ßß2 3
TypeName
ßß3 ;
)
ßß; <
||
ßß= ?
string
ßß@ F
.
ßßF G 
IsNullOrWhiteSpace
ßßG Y
(
ßßY Z
load
ßßZ ^
.
ßß^ _
PartId
ßß_ e
)
ßße f
)
ßßf g
{
®® 
StatusMessage
©© !
=
©©" #
$str
©©$ J
;
©©J K
return
™™ 
;
™™ 
}
´´ 
}
¨¨ 
var
ØØ 

saveResult
ØØ 
=
ØØ 
await
ØØ "
_dunnageService
ØØ# 2
.
ØØ2 3
SaveLoadsAsync
ØØ3 A
(
ØØA B
	_allLoads
ØØB K
)
ØØK L
;
ØØL M
if
±± 
(
±± 
!
±± 

saveResult
±± 
.
±± 
Success
±± #
)
±±# $
{
≤≤ 
await
≥≥ 
_errorHandler
≥≥ #
.
≥≥# $!
HandleDaoErrorAsync
≥≥$ 7
(
≥≥7 8

saveResult
≥≥8 B
,
≥≥B C
$str
≥≥D R
,
≥≥R S
true
≥≥T X
)
≥≥X Y
;
≥≥Y Z
return
¥¥ 
;
¥¥ 
}
µµ 
var
∏∏ 
	csvResult
∏∏ 
=
∏∏ 
await
∏∏ !

_csvWriter
∏∏" ,
.
∏∏, -
WriteToCSVAsync
∏∏- <
(
∏∏< =
	_allLoads
∏∏= F
)
∏∏F G
;
∏∏G H
if
∫∫ 
(
∫∫ 
!
∫∫ 
	csvResult
∫∫ 
.
∫∫ 
LocalSuccess
∫∫ '
)
∫∫' (
{
ªª 
await
ºº 
_errorHandler
ºº #
.
ºº# $
HandleErrorAsync
ºº$ 4
(
ºº4 5
	csvResult
ΩΩ 
.
ΩΩ 
ErrorMessage
ΩΩ *
??
ΩΩ+ -
$str
ΩΩ. A
,
ΩΩA B 
Enum_ErrorSeverity
ææ &
.
ææ& '
Warning
ææ' .
,
ææ. /
null
øø 
,
øø 
true
¿¿ 
)
¿¿ 
;
¿¿ 
}
¡¡ 
StatusMessage
√√ 
=
√√ 
$"
√√ 
$str
√√ 1
{
√√1 2
	_allLoads
√√2 ;
.
√√; <
Count
√√< A
}
√√A B
$str
√√B H
"
√√H I
;
√√I J
_logger
ƒƒ 
.
ƒƒ 
LogInfo
ƒƒ 
(
ƒƒ 
$"
ƒƒ 
$str
ƒƒ $
{
ƒƒ$ %
	_allLoads
ƒƒ% .
.
ƒƒ. /
Count
ƒƒ/ 4
}
ƒƒ4 5
$str
ƒƒ5 ;
"
ƒƒ; <
,
ƒƒ< =
$str
ƒƒ> H
)
ƒƒH I
;
ƒƒI J
}
≈≈ 	
catch
∆∆ 
(
∆∆ 
	Exception
∆∆ 
ex
∆∆ 
)
∆∆ 
{
«« 	
await
»» 
_errorHandler
»» 
.
»»  
HandleErrorAsync
»»  0
(
»»0 1
$str
…… $
,
……$ % 
Enum_ErrorSeverity
   "
.
  " #
Error
  # (
,
  ( )
ex
ÀÀ 
,
ÀÀ 
true
ÃÃ 
)
ÕÕ 
;
ÕÕ 
}
ŒŒ 	
finally
œœ 
{
–– 	
IsBusy
—— 
=
—— 
false
—— 
;
—— 
CanSave
““ 
=
““ 
true
““ 
;
““ 
}
”” 	
}
‘‘ 
[
⁄⁄ 
RelayCommand
⁄⁄ 
]
⁄⁄ 
private
€€ 
async
€€ 
Task
€€ (
ReturnToModeSelectionAsync
€€ 1
(
€€1 2
)
€€2 3
{
‹‹ 
var
›› 
xamlRoot
›› 
=
›› 
_windowService
›› %
.
››% &
GetXamlRoot
››& 1
(
››1 2
)
››2 3
;
››3 4
if
ﬁﬁ 

(
ﬁﬁ 
xamlRoot
ﬁﬁ 
==
ﬁﬁ 
null
ﬁﬁ 
)
ﬁﬁ 
{
ﬂﬂ 	
_logger
‡‡ 
.
‡‡ 
LogError
‡‡ 
(
‡‡ 
$str
‡‡ C
,
‡‡C D
null
‡‡E I
,
‡‡I J
$str
‡‡K U
)
‡‡U V
;
‡‡V W
await
·· 
_errorHandler
·· 
.
··  
HandleErrorAsync
··  0
(
··0 1
$str
··1 K
,
··K L 
Enum_ErrorSeverity
··M _
.
··_ `
Error
··` e
,
··e f
null
··g k
,
··k l
true
··m q
)
··q r
;
··r s
return
‚‚ 
;
‚‚ 
}
„„ 	
var
ÂÂ 
dialog
ÂÂ 
=
ÂÂ 
new
ÂÂ 
	Microsoft
ÂÂ "
.
ÂÂ" #
UI
ÂÂ# %
.
ÂÂ% &
Xaml
ÂÂ& *
.
ÂÂ* +
Controls
ÂÂ+ 3
.
ÂÂ3 4
ContentDialog
ÂÂ4 A
{
ÊÊ 	
Title
ÁÁ 
=
ÁÁ 
$str
ÁÁ "
,
ÁÁ" #
Content
ËË 
=
ËË 
$strËË Å
,ËËÅ Ç
PrimaryButtonText
ÈÈ 
=
ÈÈ 
$str
ÈÈ  2
,
ÈÈ2 3
CloseButtonText
ÍÍ 
=
ÍÍ 
$str
ÍÍ &
,
ÍÍ& '
DefaultButton
ÎÎ 
=
ÎÎ 
	Microsoft
ÎÎ %
.
ÎÎ% &
UI
ÎÎ& (
.
ÎÎ( )
Xaml
ÎÎ) -
.
ÎÎ- .
Controls
ÎÎ. 6
.
ÎÎ6 7!
ContentDialogButton
ÎÎ7 J
.
ÎÎJ K
Close
ÎÎK P
,
ÎÎP Q
XamlRoot
ÏÏ 
=
ÏÏ 
xamlRoot
ÏÏ 
}
ÌÌ 	
;
ÌÌ	 

var
ÔÔ 
result
ÔÔ 
=
ÔÔ 
await
ÔÔ 
dialog
ÔÔ !
.
ÔÔ! "
	ShowAsync
ÔÔ" +
(
ÔÔ+ ,
)
ÔÔ, -
.
ÔÔ- .
AsTask
ÔÔ. 4
(
ÔÔ4 5
)
ÔÔ5 6
;
ÔÔ6 7
if
 

(
 
result
 
==
 
	Microsoft
 
.
  
UI
  "
.
" #
Xaml
# '
.
' (
Controls
( 0
.
0 1!
ContentDialogResult
1 D
.
D E
Primary
E L
)
L M
{
ÒÒ 	
try
ÚÚ 
{
ÛÛ 
_logger
ÙÙ 
.
ÙÙ 
LogInfo
ÙÙ 
(
ÙÙ  
$str
ÙÙ  X
,
ÙÙX Y
$str
ÙÙZ d
)
ÙÙd e
;
ÙÙe f
FilteredLoads
ıı 
.
ıı 
Clear
ıı #
(
ıı# $
)
ıı$ %
;
ıı% &
	_allLoads
ˆˆ 
.
ˆˆ 
Clear
ˆˆ 
(
ˆˆ  
)
ˆˆ  !
;
ˆˆ! "
_workflowService
˜˜  
.
˜˜  !
ClearSession
˜˜! -
(
˜˜- .
)
˜˜. /
;
˜˜/ 0
_workflowService
¯¯  
.
¯¯  !
GoToStep
¯¯! )
(
¯¯) *&
Enum_DunnageWorkflowStep
¯¯* B
.
¯¯B C
ModeSelection
¯¯C P
)
¯¯P Q
;
¯¯Q R
}
˘˘ 
catch
˙˙ 
(
˙˙ 
	Exception
˙˙ 
ex
˙˙ 
)
˙˙  
{
˚˚ 
_logger
¸¸ 
.
¸¸ 
LogError
¸¸  
(
¸¸  !
$"
¸¸! #
$str
¸¸# G
{
¸¸G H
ex
¸¸H J
.
¸¸J K
Message
¸¸K R
}
¸¸R S
"
¸¸S T
,
¸¸T U
ex
¸¸V X
,
¸¸X Y
$str
¸¸Z d
)
¸¸d e
;
¸¸e f
await
˝˝ 
_errorHandler
˝˝ #
.
˝˝# $
HandleErrorAsync
˝˝$ 4
(
˝˝4 5
$str
˝˝5 Y
,
˝˝Y Z 
Enum_ErrorSeverity
˝˝[ m
.
˝˝m n
Error
˝˝n s
,
˝˝s t
ex
˝˝u w
,
˝˝w x
true
˝˝y }
)
˝˝} ~
;
˝˝~ 
}
˛˛ 
}
ˇˇ 	
else
ÄÄ 
{
ÅÅ 	
_logger
ÇÇ 
.
ÇÇ 
LogInfo
ÇÇ 
(
ÇÇ 
$str
ÇÇ E
,
ÇÇE F
$str
ÇÇG Q
)
ÇÇQ R
;
ÇÇR S
}
ÉÉ 	
}
ÑÑ 
private
ää 
void
ää 
UpdateCanSave
ää 
(
ää 
)
ää  
{
ãã 
CanSave
åå 
=
åå 
	_allLoads
åå 
.
åå 
Any
åå 
(
åå  
l
åå  !
=>
åå" $
!
åå% &
string
åå& ,
.
åå, - 
IsNullOrWhiteSpace
åå- ?
(
åå? @
l
åå@ A
.
ååA B
TypeName
ååB J
)
ååJ K
||
ååL N
!
ååO P
string
ååP V
.
ååV W 
IsNullOrWhiteSpace
ååW i
(
ååi j
l
ååj k
.
ååk l
PartId
åål r
)
åår s
)
åås t
;
ååt u
}
çç 
}êê ÿ
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Service_DispatcherTimerWrapper.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
{ 
public

 

class

 *
Service_DispatcherTimerWrapper

 /
:

0 1$
IService_DispatcherTimer

2 J
{ 
private 
readonly  
DispatcherQueueTimer -
_timer. 4
;4 5
public *
Service_DispatcherTimerWrapper -
(- . 
DispatcherQueueTimer. B
timerC H
)H I
{ 	
_timer 
= 
timer 
?? 
throw #
new$ '!
ArgumentNullException( =
(= >
nameof> D
(D E
timerE J
)J K
)K L
;L M
_timer 
. 
Tick 
+= 
( 
s 
, 
e  
)  !
=>" $
Tick% )
?) *
.* +
Invoke+ 1
(1 2
this2 6
,6 7
e8 9
)9 :
;: ;
} 	
public 
TimeSpan 
Interval  
{ 	
get 
=> 
_timer 
. 
Interval "
;" #
set 
=> 
_timer 
. 
Interval "
=# $
value% *
;* +
} 	
public 
bool 
IsRepeating 
{ 	
get 
=> 
_timer 
. 
IsRepeating %
;% &
set 
=> 
_timer 
. 
IsRepeating %
=& '
value( -
;- .
} 	
public   
bool   
	IsRunning   
=>    
_timer  ! '
.  ' (
	IsRunning  ( 1
;  1 2
public"" 
event"" 
EventHandler"" !
<""! "
object""" (
>""( )
?"") *
Tick""+ /
;""/ 0
public$$ 
void$$ 
Start$$ 
($$ 
)$$ 
=>$$ 
_timer$$ %
.$$% &
Start$$& +
($$+ ,
)$$, -
;$$- .
public&& 
void&& 
Stop&& 
(&& 
)&& 
=>&& 
_timer&& $
.&&$ %
Stop&&% )
(&&) *
)&&* +
;&&+ ,
}'' 
}(( ü
TC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Service_Dispatcher.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
{ 
public

 

class

 
Service_Dispatcher

 #
:

$ %
IService_Dispatcher

& 9
{ 
private 
readonly 
DispatcherQueue (
_dispatcherQueue) 9
;9 :
public 
Service_Dispatcher !
(! "
DispatcherQueue" 1
dispatcherQueue2 A
)A B
{ 	
_dispatcherQueue 
= 
dispatcherQueue .
??/ 1
throw2 7
new8 ;!
ArgumentNullException< Q
(Q R
nameofR X
(X Y
dispatcherQueueY h
)h i
)i j
;j k
} 	
public $
IService_DispatcherTimer '
CreateTimer( 3
(3 4
)4 5
{ 	
return 
new *
Service_DispatcherTimerWrapper 5
(5 6
_dispatcherQueue6 F
.F G
CreateTimerG R
(R S
)S T
)T U
;U V
} 	
public 
bool 

TryEnqueue 
( 
Action %
callback& .
). /
{ 	
return 
_dispatcherQueue #
.# $

TryEnqueue$ .
(. /
(/ 0
)0 1
=>2 4
callback5 =
(= >
)> ?
)? @
;@ A
} 	
} 
} º<
bC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Receiving\Service_SessionManager.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Services		$ ,
.		, -
	Receiving		- 6
{

 
public 

class "
Service_SessionManager '
:( )#
IService_SessionManager* A
{ 
private 
readonly 
string 
_sessionPath  ,
;, -
private 
readonly #
IService_LoggingUtility 0
_logger1 8
;8 9
public "
Service_SessionManager %
(% &#
IService_LoggingUtility& =
logger> D
)D E
{ 	
_logger 
= 
logger 
?? 
throw  %
new& )!
ArgumentNullException* ?
(? @
nameof@ F
(F G
loggerG M
)M N
)N O
;O P
var 
appDataPath 
= 
Environment )
.) *
GetFolderPath* 7
(7 8
Environment8 C
.C D
SpecialFolderD Q
.Q R
ApplicationDataR a
)a b
;b c
var 
	appFolder 
= 
Path  
.  !
Combine! (
(( )
appDataPath) 4
,4 5
$str6 Q
)Q R
;R S
if 
( 
! 
	Directory 
. 
Exists !
(! "
	appFolder" +
)+ ,
), -
{ 
	Directory 
. 
CreateDirectory )
() *
	appFolder* 3
)3 4
;4 5
} 
_sessionPath   
=   
Path   
.    
Combine    '
(  ' (
	appFolder  ( 1
,  1 2
$str  3 A
)  A B
;  B C
}!! 	
public## 
async## 
Task## 
SaveSessionAsync## *
(##* +"
Model_ReceivingSession##+ A
session##B I
)##I J
{$$ 	
_logger%% 
.%% 
LogInfo%% 
(%% 
$str%% 7
)%%7 8
;%%8 9
if&& 
(&& 
session&& 
==&& 
null&& 
)&&  
throw'' 
new'' !
ArgumentNullException'' /
(''/ 0
nameof''0 6
(''6 7
session''7 >
)''> ?
)''? @
;''@ A
try)) 
{** 
var++ 
options++ 
=++ 
new++ !!
JsonSerializerOptions++" 7
{,, 
WriteIndented-- !
=--" #
true--$ (
,--( ) 
PropertyNamingPolicy.. (
=..) *
JsonNamingPolicy..+ ;
...; <
	CamelCase..< E
}// 
;// 
_logger11 
.11 
LogInfo11 
(11  
$str11  8
)118 9
;119 :
var22 
json22 
=22 
JsonSerializer22 )
.22) *
	Serialize22* 3
(223 4
session224 ;
,22; <
options22= D
)22D E
;22E F
_logger33 
.33 
LogInfo33 
(33  
$"33  "
$str33" ;
{33; <
_sessionPath33< H
}33H I
"33I J
)33J K
;33K L
await44 
File44 
.44 
WriteAllTextAsync44 ,
(44, -
_sessionPath44- 9
,449 :
json44; ?
)44? @
;44@ A
_logger55 
.55 
LogInfo55 
(55  
$str55  =
)55= >
;55> ?
}66 
catch77 
(77 
	Exception77 
ex77 
)77  
{88 
_logger99 
.99 
LogError99  
(99  !
$"99! #
$str99# C
{99C D
ex99D F
.99F G
Message99G N
}99N O
"99O P
,99P Q
ex99R T
)99T U
;99U V
throw:: 
new:: %
InvalidOperationException:: 3
(::3 4
$str::4 T
,::T U
ex::V X
)::X Y
;::Y Z
};; 
}<< 	
public>> 
async>> 
Task>> 
<>> "
Model_ReceivingSession>> 0
?>>0 1
>>>1 2
LoadSessionAsync>>3 C
(>>C D
)>>D E
{?? 	
if@@ 
(@@ 
!@@ 
File@@ 
.@@ 
Exists@@ 
(@@ 
_sessionPath@@ )
)@@) *
)@@* +
returnAA 
nullAA 
;AA 
tryCC 
{DD 
varEE 
jsonEE 
=EE 
awaitEE  
FileEE! %
.EE% &
ReadAllTextAsyncEE& 6
(EE6 7
_sessionPathEE7 C
)EEC D
;EED E
varGG 
optionsGG 
=GG 
newGG !!
JsonSerializerOptionsGG" 7
{HH  
PropertyNamingPolicyII (
=II) *
JsonNamingPolicyII+ ;
.II; <
	CamelCaseII< E
}JJ 
;JJ 
returnLL 
JsonSerializerLL %
.LL% &
DeserializeLL& 1
<LL1 2"
Model_ReceivingSessionLL2 H
>LLH I
(LLI J
jsonLLJ N
,LLN O
optionsLLP W
)LLW X
;LLX Y
}MM 
catchNN 
(NN 
JsonExceptionNN  
)NN  !
{OO 
tryQQ 
{RR 
FileSS 
.SS 
DeleteSS 
(SS  
_sessionPathSS  ,
)SS, -
;SS- .
}TT 
catchUU 
{VV 
}XX 
returnYY 
nullYY 
;YY 
}ZZ 
catch[[ 
([[ 
	Exception[[ 
ex[[ 
)[[  
{\\ 
throw]] 
new]] %
InvalidOperationException]] 3
(]]3 4
$str]]4 V
,]]V W
ex]]X Z
)]]Z [
;]][ \
}^^ 
}__ 	
publicaa 
asyncaa 
Taskaa 
<aa 
boolaa 
>aa 
ClearSessionAsyncaa  1
(aa1 2
)aa2 3
{bb 	
ifcc 
(cc 
!cc 
Filecc 
.cc 
Existscc 
(cc 
_sessionPathcc )
)cc) *
)cc* +
returndd 
falsedd 
;dd 
tryff 
{gg 
awaithh 
Taskhh 
.hh 
Runhh 
(hh 
(hh  
)hh  !
=>hh" $
Filehh% )
.hh) *
Deletehh* 0
(hh0 1
_sessionPathhh1 =
)hh= >
)hh> ?
;hh? @
returnii 
trueii 
;ii 
}jj 
catchkk 
{ll 
returnmm 
falsemm 
;mm 
}nn 
}oo 	
publicqq 
boolqq 
SessionExistsqq !
(qq! "
)qq" #
{rr 	
returnss 
Filess 
.ss 
Existsss 
(ss 
_sessionPathss +
)ss+ ,
;ss, -
}tt 	
publicvv 
stringvv 
GetSessionFilePathvv (
(vv( )
)vv) *
{ww 	
returnxx 
_sessionPathxx 
;xx  
}yy 	
}zz 
}{{ §´
eC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Receiving\Service_ReceivingWorkflow.cs
	namespace

 	%
MTM_Receiving_Application


 #
.

# $
Services

$ ,
.

, -
	Receiving

- 6
{ 
public 

class %
Service_ReceivingWorkflow *
:+ ,&
IService_ReceivingWorkflow- G
{ 
private 
readonly #
IService_SessionManager 0
_sessionManager1 @
;@ A
private 
readonly 
IService_CSVWriter +

_csvWriter, 6
;6 7
private 
readonly $
IService_MySQL_Receiving 1
_mysqlReceiving2 A
;A B
private 
readonly (
IService_ReceivingValidation 5
_validation6 A
;A B
private 
readonly #
IService_LoggingUtility 0
_logger1 8
;8 9
private 
List 
< 
Model_ReceivingLoad (
>( )
_currentBatchLoads* <
== >
new? B
(B C
)C D
;D E
public 
event 
EventHandler !
?! "
StepChanged# .
;. /
public 
event 
EventHandler !
<! "
string" (
>( )
?) *
StatusMessageRaised+ >
;> ?
public 
void 
RaiseStatusMessage &
(& '
string' -
message. 5
)5 6
{ 	
StatusMessageRaised 
?  
.  !
Invoke! '
(' (
this( ,
,, -
message. 5
)5 6
;6 7
} 	
private!! 
WorkflowStep!! 
_currentStep!! )
=!!* +
WorkflowStep!!, 8
.!!8 9
ModeSelection!!9 F
;!!F G
public"" 
WorkflowStep"" 
CurrentStep"" '
{## 	
get$$ 
=>$$ 
_currentStep$$ 
;$$  
private%% 
set%% 
{&& 
if'' 
('' 
_currentStep''  
!=''! #
value''$ )
)'') *
{(( 
_logger)) 
.)) 
LogInfo)) #
())# $
$"))$ &
$str))& 9
{))9 :
_currentStep)): F
}))F G
$str))G K
{))K L
value))L Q
}))Q R
"))R S
)))S T
;))T U
_currentStep**  
=**! "
value**# (
;**( )
StepChanged++ 
?++  
.++  !
Invoke++! '
(++' (
this++( ,
,++, -
	EventArgs++. 7
.++7 8
Empty++8 =
)++= >
;++> ?
_logger,, 
.,, 
LogInfo,, #
(,,# $
$",,$ &
$str,,& 6
{,,6 7
value,,7 <
},,< =
$str,,= K
",,K L
),,L M
;,,M N
}-- 
}.. 
}// 	
public00 "
Model_ReceivingSession00 %
CurrentSession00& 4
{005 6
get007 :
;00: ;
private00< C
set00D G
;00G H
}00I J
=00K L
new00M P
(00P Q
)00Q R
;00R S
public11 
string11 
?11 
CurrentPONumber11 &
{11' (
get11) ,
;11, -
set11. 1
;111 2
}113 4
public22 !
Model_InforVisualPart22 $
?22$ %
CurrentPart22& 1
{222 3
get224 7
;227 8
set229 <
;22< =
}22> ?
public33 
bool33 
IsNonPOItem33 
{33  !
get33" %
;33% &
set33' *
;33* +
}33, -
public44 
int44 
NumberOfLoads44  
{44! "
get44# &
;44& '
set44( +
;44+ ,
}44- .
=44/ 0
$num441 2
;442 3
public66 %
Service_ReceivingWorkflow66 (
(66( )#
IService_SessionManager77 #
sessionManager77$ 2
,772 3
IService_CSVWriter88 
	csvWriter88 (
,88( )$
IService_MySQL_Receiving99 $
mysqlReceiving99% 3
,993 4(
IService_ReceivingValidation:: (

validation::) 3
,::3 4#
IService_LoggingUtility;; #
logger;;$ *
);;* +
{<< 	
_sessionManager== 
=== 
sessionManager== ,
??==- /
throw==0 5
new==6 9!
ArgumentNullException==: O
(==O P
nameof==P V
(==V W
sessionManager==W e
)==e f
)==f g
;==g h

_csvWriter>> 
=>> 
	csvWriter>> "
??>># %
throw>>& +
new>>, /!
ArgumentNullException>>0 E
(>>E F
nameof>>F L
(>>L M
	csvWriter>>M V
)>>V W
)>>W X
;>>X Y
_mysqlReceiving?? 
=?? 
mysqlReceiving?? ,
????- /
throw??0 5
new??6 9!
ArgumentNullException??: O
(??O P
nameof??P V
(??V W
mysqlReceiving??W e
)??e f
)??f g
;??g h
_validation@@ 
=@@ 

validation@@ $
??@@% '
throw@@( -
new@@. 1!
ArgumentNullException@@2 G
(@@G H
nameof@@H N
(@@N O

validation@@O Y
)@@Y Z
)@@Z [
;@@[ \
_loggerAA 
=AA 
loggerAA 
??AA 
throwAA  %
newAA& )!
ArgumentNullExceptionAA* ?
(AA? @
nameofAA@ F
(AAF G
loggerAAG M
)AAM N
)AAN O
;AAO P
}BB 	
publicDD 
asyncDD 
TaskDD 
<DD 
boolDD 
>DD 
StartWorkflowAsyncDD  2
(DD2 3
)DD3 4
{EE 	
_loggerFF 
.FF 
LogInfoFF 
(FF 
$strFF :
)FF: ;
;FF; <
varHH 
existingSessionHH 
=HH  !
awaitHH" '
_sessionManagerHH( 7
.HH7 8
LoadSessionAsyncHH8 H
(HHH I
)HHI J
;HHJ K
ifJJ 
(JJ 
existingSessionJJ 
!=JJ  "
nullJJ# '
&&JJ( *
existingSessionJJ+ :
.JJ: ;
HasLoadsJJ; C
)JJC D
{KK 
_loggerLL 
.LL 
LogInfoLL 
(LL  
$strLL  =
)LL= >
;LL> ?
CurrentSessionMM 
=MM  
existingSessionMM! 0
;MM0 1
CurrentStepOO 
=OO 
WorkflowStepOO *
.OO* +
ReviewOO+ 1
;OO1 2
returnPP 
truePP 
;PP 
}QQ 
CurrentSessionTT 
=TT 
newTT  "
Model_ReceivingSessionTT! 7
(TT7 8
)TT8 9
;TT9 :
NumberOfLoadsUU 
=UU 
$numUU 
;UU 
CurrentStepVV 
=VV 
WorkflowStepVV &
.VV& '
ModeSelectionVV' 4
;VV4 5
returnWW 
falseWW 
;WW 
}XX 	
publicZZ 
asyncZZ 
TaskZZ 
<ZZ 
WorkflowStepResultZZ ,
>ZZ, -"
AdvanceToNextStepAsyncZZ. D
(ZZD E
)ZZE F
{[[ 	
var]] 
validationErrors]]  
=]]! "
new]]# &
List]]' +
<]]+ ,
string]], 2
>]]2 3
(]]3 4
)]]4 5
;]]5 6
switch__ 
(__ 
CurrentStep__ 
)__  
{`` 
caseaa 
WorkflowStepaa !
.aa! "
ModeSelectionaa" /
:aa/ 0
returncc 
WorkflowStepResultcc -
.cc- .
SuccessResultcc. ;
(cc; <
CurrentStepcc< G
)ccG H
;ccH I
caseee 
WorkflowStepee !
.ee! "
ManualEntryee" -
:ee- .
CurrentStephh 
=hh  !
WorkflowStephh" .
.hh. /
Savinghh/ 5
;hh5 6
returnii 
WorkflowStepResultii -
.ii- .
SuccessResultii. ;
(ii; <
CurrentStepii< G
)iiG H
;iiH I
casekk 
WorkflowStepkk !
.kk! "
EditModekk" *
:kk* +
CurrentStepmm 
=mm  !
WorkflowStepmm" .
.mm. /
Savingmm/ 5
;mm5 6
returnnn 
WorkflowStepResultnn -
.nn- .
SuccessResultnn. ;
(nn; <
CurrentStepnn< G
)nnG H
;nnH I
casepp 
WorkflowSteppp !
.pp! "
POEntrypp" )
:pp) *
ifqq 
(qq 
stringqq 
.qq 
IsNullOrEmptyqq ,
(qq, -
CurrentPONumberqq- <
)qq< =
&&qq> @
!qqA B
IsNonPOItemqqB M
)qqM N
{rr 
validationErrorsss (
.ss( )
Addss) ,
(ss, -
$strss- E
)ssE F
;ssF G
returntt 
WorkflowStepResulttt 1
.tt1 2
ErrorResulttt2 =
(tt= >
validationErrorstt> N
)ttN O
;ttO P
}uu 
ifvv 
(vv 
CurrentPartvv #
==vv$ &
nullvv' +
)vv+ ,
{ww 
validationErrorsxx (
.xx( )
Addxx) ,
(xx, -
$strxx- J
)xxJ K
;xxK L
returnyy 
WorkflowStepResultyy 1
.yy1 2
ErrorResultyy2 =
(yy= >
validationErrorsyy> N
)yyN O
;yyO P
}zz 
CurrentSession}} "
.}}" #
IsNonPO}}# *
=}}+ ,
IsNonPOItem}}- 8
;}}8 9
CurrentSession~~ "
.~~" #
PoNumber~~# +
=~~, -
IsNonPOItem~~. 9
?~~: ;
null~~< @
:~~A B
CurrentPONumber~~C R
;~~R S
CurrentStep
ÄÄ 
=
ÄÄ  !
WorkflowStep
ÄÄ" .
.
ÄÄ. /
	LoadEntry
ÄÄ/ 8
;
ÄÄ8 9
break
ÅÅ 
;
ÅÅ 
case
ÉÉ 
WorkflowStep
ÉÉ !
.
ÉÉ! "
	LoadEntry
ÉÉ" +
:
ÉÉ+ ,
if
ÑÑ 
(
ÑÑ 
NumberOfLoads
ÑÑ %
<
ÑÑ& '
$num
ÑÑ( )
)
ÑÑ) *
{
ÖÖ 
validationErrors
ÜÜ (
.
ÜÜ( )
Add
ÜÜ) ,
(
ÜÜ, -
$str
ÜÜ- R
)
ÜÜR S
;
ÜÜS T
return
áá  
WorkflowStepResult
áá 1
.
áá1 2
ErrorResult
áá2 =
(
áá= >
validationErrors
áá> N
)
ááN O
;
ááO P
}
àà 
GenerateLoads
ââ !
(
ââ! "
)
ââ" #
;
ââ# $
CurrentStep
ää 
=
ää  !
WorkflowStep
ää" .
.
ää. /!
WeightQuantityEntry
ää/ B
;
ääB C
break
ãã 
;
ãã 
case
çç 
WorkflowStep
çç !
.
çç! "!
WeightQuantityEntry
çç" 5
:
çç5 6
foreach
éé 
(
éé 
var
éé  
load
éé! %
in
éé& (
CurrentSession
éé) 7
.
éé7 8
Loads
éé8 =
)
éé= >
{
èè 
var
êê 
result
êê "
=
êê# $
_validation
êê% 0
.
êê0 1$
ValidateWeightQuantity
êê1 G
(
êêG H
load
êêH L
.
êêL M
WeightQuantity
êêM [
)
êê[ \
;
êê\ ]
if
ëë 
(
ëë 
!
ëë 
result
ëë #
.
ëë# $
IsValid
ëë$ +
)
ëë+ ,
{
íí 
validationErrors
ìì ,
.
ìì, -
Add
ìì- 0
(
ìì0 1
$"
ìì1 3
$str
ìì3 8
{
ìì8 9
load
ìì9 =
.
ìì= >

LoadNumber
ìì> H
}
ììH I
$str
ììI K
{
ììK L
result
ììL R
.
ììR S
Message
ììS Z
}
ììZ [
"
ìì[ \
)
ìì\ ]
;
ìì] ^
}
îî 
}
ïï 
if
ññ 
(
ññ 
validationErrors
ññ (
.
ññ( )
Count
ññ) .
>
ññ/ 0
$num
ññ1 2
)
ññ2 3
{
óó 
return
òò  
WorkflowStepResult
òò 1
.
òò1 2
ErrorResult
òò2 =
(
òò= >
validationErrors
òò> N
)
òòN O
;
òòO P
}
ôô 
CurrentStep
öö 
=
öö  !
WorkflowStep
öö" .
.
öö. /
HeatLotEntry
öö/ ;
;
öö; <
break
õõ 
;
õõ 
case
ùù 
WorkflowStep
ùù !
.
ùù! "
HeatLotEntry
ùù" .
:
ùù. /
foreach
ûû 
(
ûû 
var
ûû  
load
ûû! %
in
ûû& (
CurrentSession
ûû) 7
.
ûû7 8
Loads
ûû8 =
)
ûû= >
{
üü 
var
†† 
result
†† "
=
††# $
_validation
††% 0
.
††0 1#
ValidateHeatLotNumber
††1 F
(
††F G
load
††G K
.
††K L
HeatLotNumber
††L Y
)
††Y Z
;
††Z [
if
°° 
(
°° 
!
°° 
result
°° #
.
°°# $
IsValid
°°$ +
)
°°+ ,
{
¢¢ 
validationErrors
££ ,
.
££, -
Add
££- 0
(
££0 1
$"
££1 3
$str
££3 8
{
££8 9
load
££9 =
.
££= >

LoadNumber
££> H
}
££H I
$str
££I K
{
££K L
result
££L R
.
££R S
Message
££S Z
}
££Z [
"
££[ \
)
££\ ]
;
££] ^
}
§§ 
}
•• 
if
¶¶ 
(
¶¶ 
validationErrors
¶¶ (
.
¶¶( )
Count
¶¶) .
>
¶¶/ 0
$num
¶¶1 2
)
¶¶2 3
{
ßß 
return
®®  
WorkflowStepResult
®® 1
.
®®1 2
ErrorResult
®®2 =
(
®®= >
validationErrors
®®> N
)
®®N O
;
®®O P
}
©© 
CurrentStep
™™ 
=
™™  !
WorkflowStep
™™" .
.
™™. /
PackageTypeEntry
™™/ ?
;
™™? @
break
´´ 
;
´´ 
case
≠≠ 
WorkflowStep
≠≠ !
.
≠≠! "
PackageTypeEntry
≠≠" 2
:
≠≠2 3
foreach
ÆÆ 
(
ÆÆ 
var
ÆÆ  
load
ÆÆ! %
in
ÆÆ& (
CurrentSession
ÆÆ) 7
.
ÆÆ7 8
Loads
ÆÆ8 =
)
ÆÆ= >
{
ØØ 
var
∞∞ 
result
∞∞ "
=
∞∞# $
_validation
∞∞% 0
.
∞∞0 1"
ValidatePackageCount
∞∞1 E
(
∞∞E F
load
∞∞F J
.
∞∞J K
PackagesPerLoad
∞∞K Z
)
∞∞Z [
;
∞∞[ \
if
±± 
(
±± 
!
±± 
result
±± #
.
±±# $
IsValid
±±$ +
)
±±+ ,
{
≤≤ 
validationErrors
≥≥ ,
.
≥≥, -
Add
≥≥- 0
(
≥≥0 1
$"
≥≥1 3
$str
≥≥3 8
{
≥≥8 9
load
≥≥9 =
.
≥≥= >

LoadNumber
≥≥> H
}
≥≥H I
$str
≥≥I K
{
≥≥K L
result
≥≥L R
.
≥≥R S
Message
≥≥S Z
}
≥≥Z [
"
≥≥[ \
)
≥≥\ ]
;
≥≥] ^
}
¥¥ 
if
µµ 
(
µµ 
string
µµ "
.
µµ" # 
IsNullOrWhiteSpace
µµ# 5
(
µµ5 6
load
µµ6 :
.
µµ: ;
PackageTypeName
µµ; J
)
µµJ K
)
µµK L
{
∂∂ 
validationErrors
∑∑ ,
.
∑∑, -
Add
∑∑- 0
(
∑∑0 1
$"
∑∑1 3
$str
∑∑3 8
{
∑∑8 9
load
∑∑9 =
.
∑∑= >

LoadNumber
∑∑> H
}
∑∑H I
$str
∑∑I d
"
∑∑d e
)
∑∑e f
;
∑∑f g
}
∏∏ 
}
ππ 
if
∫∫ 
(
∫∫ 
validationErrors
∫∫ (
.
∫∫( )
Count
∫∫) .
>
∫∫/ 0
$num
∫∫1 2
)
∫∫2 3
{
ªª 
return
ºº  
WorkflowStepResult
ºº 1
.
ºº1 2
ErrorResult
ºº2 =
(
ºº= >
validationErrors
ºº> N
)
ººN O
;
ººO P
}
ΩΩ 
CurrentStep
ææ 
=
ææ  !
WorkflowStep
ææ" .
.
ææ. /
Review
ææ/ 5
;
ææ5 6
break
øø 
;
øø 
case
¡¡ 
WorkflowStep
¡¡ !
.
¡¡! "
Review
¡¡" (
:
¡¡( )
_logger
¬¬ 
.
¬¬ 
LogInfo
¬¬ #
(
¬¬# $
$str
¬¬$ L
)
¬¬L M
;
¬¬M N
CurrentStep
√√ 
=
√√  !
WorkflowStep
√√" .
.
√√. /
Saving
√√/ 5
;
√√5 6
break
ƒƒ 
;
ƒƒ 
case
∆∆ 
WorkflowStep
∆∆ !
.
∆∆! "
Saving
∆∆" (
:
∆∆( )
CurrentStep
«« 
=
««  !
WorkflowStep
««" .
.
««. /
Complete
««/ 7
;
««7 8
break
»» 
;
»» 
default
   
:
   
validationErrors
ÀÀ $
.
ÀÀ$ %
Add
ÀÀ% (
(
ÀÀ( )
$"
ÀÀ) +
$str
ÀÀ+ D
{
ÀÀD E
CurrentStep
ÀÀE P
}
ÀÀP Q
"
ÀÀQ R
)
ÀÀR S
;
ÀÀS T
return
ÃÃ  
WorkflowStepResult
ÃÃ -
.
ÃÃ- .
ErrorResult
ÃÃ. 9
(
ÃÃ9 :
validationErrors
ÃÃ: J
)
ÃÃJ K
;
ÃÃK L
}
ÕÕ 
_logger
–– 
.
–– 
LogInfo
–– 
(
–– 
$str
–– 3
)
––3 4
;
––4 5
await
—— !
PersistSessionAsync
—— %
(
——% &
)
——& '
;
——' (
_logger
““ 
.
““ 
LogInfo
““ 
(
““ 
$str
““ 0
)
““0 1
;
““1 2
return
‘‘  
WorkflowStepResult
‘‘ %
.
‘‘% &
SuccessResult
‘‘& 3
(
‘‘3 4
CurrentStep
‘‘4 ?
,
‘‘? @
$"
‘‘A C
$str
‘‘C O
{
‘‘O P
CurrentStep
‘‘P [
}
‘‘[ \
"
‘‘\ ]
)
‘‘] ^
;
‘‘^ _
}
’’ 	
private
◊◊ 
void
◊◊ 
GenerateLoads
◊◊ "
(
◊◊" #
)
◊◊# $
{
ÿÿ 	
if
⁄⁄ 
(
⁄⁄  
_currentBatchLoads
⁄⁄ "
.
⁄⁄" #
Any
⁄⁄# &
(
⁄⁄& '
)
⁄⁄' (
)
⁄⁄( )
{
€€ 
foreach
‹‹ 
(
‹‹ 
var
‹‹ 
load
‹‹ !
in
‹‹" $ 
_currentBatchLoads
‹‹% 7
)
‹‹7 8
{
›› 
CurrentSession
ﬁﬁ "
.
ﬁﬁ" #
Loads
ﬁﬁ# (
.
ﬁﬁ( )
Remove
ﬁﬁ) /
(
ﬁﬁ/ 0
load
ﬁﬁ0 4
)
ﬁﬁ4 5
;
ﬁﬁ5 6
}
ﬂﬂ  
_currentBatchLoads
‡‡ "
.
‡‡" #
Clear
‡‡# (
(
‡‡( )
)
‡‡) *
;
‡‡* +
}
·· 
for
„„ 
(
„„ 
int
„„ 
i
„„ 
=
„„ 
$num
„„ 
;
„„ 
i
„„ 
<=
„„  
NumberOfLoads
„„! .
;
„„. /
i
„„0 1
++
„„1 3
)
„„3 4
{
‰‰ 
var
ÂÂ 
load
ÂÂ 
=
ÂÂ 
new
ÂÂ !
Model_ReceivingLoad
ÂÂ 2
{
ÊÊ 
PartID
ÁÁ 
=
ÁÁ 
CurrentPart
ÁÁ (
?
ÁÁ( )
.
ÁÁ) *
PartID
ÁÁ* 0
??
ÁÁ1 3
string
ÁÁ4 :
.
ÁÁ: ;
Empty
ÁÁ; @
,
ÁÁ@ A
PartType
ËË 
=
ËË 
CurrentPart
ËË *
?
ËË* +
.
ËË+ ,
PartType
ËË, 4
??
ËË5 7
string
ËË8 >
.
ËË> ?
Empty
ËË? D
,
ËËD E
PoNumber
ÈÈ 
=
ÈÈ 
IsNonPOItem
ÈÈ *
?
ÈÈ+ ,
null
ÈÈ- 1
:
ÈÈ2 3
CurrentPONumber
ÈÈ4 C
,
ÈÈC D
PoLineNumber
ÍÍ  
=
ÍÍ! "
CurrentPart
ÍÍ# .
?
ÍÍ. /
.
ÍÍ/ 0
POLineNumber
ÍÍ0 <
??
ÍÍ= ?
string
ÍÍ@ F
.
ÍÍF G
Empty
ÍÍG L
,
ÍÍL M

LoadNumber
ÎÎ 
=
ÎÎ  
CurrentSession
ÎÎ! /
.
ÎÎ/ 0
Loads
ÎÎ0 5
.
ÎÎ5 6
Count
ÎÎ6 ;
+
ÎÎ< =
$num
ÎÎ> ?
,
ÎÎ? @
IsNonPOItem
ÏÏ 
=
ÏÏ  !
IsNonPOItem
ÏÏ" -
}
ÌÌ 
;
ÌÌ 
CurrentSession
ÓÓ 
.
ÓÓ 
Loads
ÓÓ $
.
ÓÓ$ %
Add
ÓÓ% (
(
ÓÓ( )
load
ÓÓ) -
)
ÓÓ- .
;
ÓÓ. / 
_currentBatchLoads
ÔÔ "
.
ÔÔ" #
Add
ÔÔ# &
(
ÔÔ& '
load
ÔÔ' +
)
ÔÔ+ ,
;
ÔÔ, -
}
 
}
ÒÒ 	
public
ÛÛ  
WorkflowStepResult
ÛÛ !
GoToPreviousStep
ÛÛ" 2
(
ÛÛ2 3
)
ÛÛ3 4
{
ÙÙ 	
switch
ıı 
(
ıı 
CurrentStep
ıı 
)
ıı  
{
ˆˆ 
case
˜˜ 
WorkflowStep
˜˜ !
.
˜˜! "
	LoadEntry
˜˜" +
:
˜˜+ ,
CurrentStep
¯¯ 
=
¯¯  !
WorkflowStep
¯¯" .
.
¯¯. /
POEntry
¯¯/ 6
;
¯¯6 7
break
˘˘ 
;
˘˘ 
case
˚˚ 
WorkflowStep
˚˚ !
.
˚˚! "!
WeightQuantityEntry
˚˚" 5
:
˚˚5 6
CurrentStep
¸¸ 
=
¸¸  !
WorkflowStep
¸¸" .
.
¸¸. /
	LoadEntry
¸¸/ 8
;
¸¸8 9
break
˝˝ 
;
˝˝ 
case
ˇˇ 
WorkflowStep
ˇˇ !
.
ˇˇ! "
HeatLotEntry
ˇˇ" .
:
ˇˇ. /
CurrentStep
ÄÄ 
=
ÄÄ  !
WorkflowStep
ÄÄ" .
.
ÄÄ. /!
WeightQuantityEntry
ÄÄ/ B
;
ÄÄB C
break
ÅÅ 
;
ÅÅ 
case
ÉÉ 
WorkflowStep
ÉÉ !
.
ÉÉ! "
PackageTypeEntry
ÉÉ" 2
:
ÉÉ2 3
CurrentStep
ÑÑ 
=
ÑÑ  !
WorkflowStep
ÑÑ" .
.
ÑÑ. /
HeatLotEntry
ÑÑ/ ;
;
ÑÑ; <
break
ÖÖ 
;
ÖÖ 
case
áá 
WorkflowStep
áá !
.
áá! "
Review
áá" (
:
áá( )
CurrentStep
àà 
=
àà  !
WorkflowStep
àà" .
.
àà. /
PackageTypeEntry
àà/ ?
;
àà? @
break
ââ 
;
ââ 
default
ãã 
:
ãã 
return
åå  
WorkflowStepResult
åå -
.
åå- .
ErrorResult
åå. 9
(
åå9 :
new
åå: =
List
åå> B
<
ååB C
string
ååC I
>
ååI J
{
ååK L
$"
ååM O
$str
ååO h
{
ååh i
CurrentStep
ååi t
}
ååt u
"
ååu v
}
ååw x
)
ååx y
;
ååy z
}
çç 
return
èè  
WorkflowStepResult
èè %
.
èè% &
SuccessResult
èè& 3
(
èè3 4
CurrentStep
èè4 ?
,
èè? @
$"
èèA C
$str
èèC O
{
èèO P
CurrentStep
èèP [
}
èè[ \
"
èè\ ]
)
èè] ^
;
èè^ _
}
êê 	
public
ëë  
WorkflowStepResult
ëë !
GoToStep
ëë" *
(
ëë* +
WorkflowStep
ëë+ 7
step
ëë8 <
)
ëë< =
{
íí 	
CurrentStep
ìì 
=
ìì 
step
ìì 
;
ìì 
return
îî  
WorkflowStepResult
îî %
.
îî% &
SuccessResult
îî& 3
(
îî3 4
CurrentStep
îî4 ?
,
îî? @
$"
îîA C
$str
îîC P
{
îîP Q
CurrentStep
îîQ \
}
îî\ ]
"
îî] ^
)
îî^ _
;
îî_ `
}
ïï 	
public
óó 
async
óó 
Task
óó *
AddCurrentPartToSessionAsync
óó 6
(
óó6 7
)
óó7 8
{
òò 	 
_currentBatchLoads
öö 
.
öö 
Clear
öö $
(
öö$ %
)
öö% &
;
öö& '
CurrentPONumber
ùù 
=
ùù 
null
ùù "
;
ùù" #
CurrentPart
ûû 
=
ûû 
null
ûû 
;
ûû 
IsNonPOItem
üü 
=
üü 
false
üü 
;
üü  
NumberOfLoads
†† 
=
†† 
$num
†† 
;
†† 
await
¢¢ !
PersistSessionAsync
¢¢ %
(
¢¢% &
)
¢¢& '
;
¢¢' (
CurrentStep
££ 
=
££ 
WorkflowStep
££ &
.
££& '
POEntry
££' .
;
££. /
}
§§ 	
public
¶¶ 
async
¶¶ 
Task
¶¶ 
<
¶¶ 

SaveResult
¶¶ $
>
¶¶$ %
SaveSessionAsync
¶¶& 6
(
¶¶6 7
	IProgress
¶¶7 @
<
¶¶@ A
string
¶¶A G
>
¶¶G H
?
¶¶H I
messageProgress
¶¶J Y
=
¶¶Z [
null
¶¶\ `
,
¶¶` a
	IProgress
¶¶b k
<
¶¶k l
int
¶¶l o
>
¶¶o p
?
¶¶p q
percentProgress¶¶r Å
=¶¶Ç É
null¶¶Ñ à
)¶¶à â
{
ßß 	
_logger
®® 
.
®® 
LogInfo
®® 
(
®® 
$str
®® 4
)
®®4 5
;
®®5 6
var
©© 
result
©© 
=
©© 
new
©© 

SaveResult
©© '
(
©©' (
)
©©( )
;
©©) *
messageProgress
´´ 
?
´´ 
.
´´ 
Report
´´ #
(
´´# $
$str
´´$ ;
)
´´; <
;
´´< =
percentProgress
¨¨ 
?
¨¨ 
.
¨¨ 
Report
¨¨ #
(
¨¨# $
$num
¨¨$ &
)
¨¨& '
;
¨¨' (
_logger
ØØ 
.
ØØ 
LogInfo
ØØ 
(
ØØ 
$str
ØØ ?
)
ØØ? @
;
ØØ@ A
var
∞∞ 

validation
∞∞ 
=
∞∞ 
_validation
∞∞ (
.
∞∞( )
ValidateSession
∞∞) 8
(
∞∞8 9
CurrentSession
∞∞9 G
.
∞∞G H
Loads
∞∞H M
)
∞∞M N
;
∞∞N O
if
±± 
(
±± 
!
±± 

validation
±± 
.
±± 
IsValid
±± #
)
±±# $
{
≤≤ 
_logger
≥≥ 
.
≥≥ 

LogWarning
≥≥ "
(
≥≥" #
$"
≥≥# %
$str
≥≥% @
{
≥≥@ A
string
≥≥A G
.
≥≥G H
Join
≥≥H L
(
≥≥L M
$str
≥≥M Q
,
≥≥Q R

validation
≥≥S ]
.
≥≥] ^
Errors
≥≥^ d
)
≥≥d e
}
≥≥e f
"
≥≥f g
)
≥≥g h
;
≥≥h i
result
¥¥ 
.
¥¥ 
Success
¥¥ 
=
¥¥  
false
¥¥! &
;
¥¥& '
result
µµ 
.
µµ 
Errors
µµ 
=
µµ 

validation
µµ  *
.
µµ* +
Errors
µµ+ 1
;
µµ1 2
return
∂∂ 
result
∂∂ 
;
∂∂ 
}
∑∑ 
try
ππ 
{
∫∫ 
_logger
ªª 
.
ªª 
LogInfo
ªª 
(
ªª  
$str
ªª  L
)
ªªL M
;
ªªM N
messageProgress
ºº 
?
ºº  
.
ºº  !
Report
ºº! '
(
ºº' (
$str
ºº( @
)
ºº@ A
;
ººA B
percentProgress
ΩΩ 
?
ΩΩ  
.
ΩΩ  !
Report
ΩΩ! '
(
ΩΩ' (
$num
ΩΩ( *
)
ΩΩ* +
;
ΩΩ+ ,
_logger
¿¿ 
.
¿¿ 
LogInfo
¿¿ 
(
¿¿  
$str
¿¿  G
)
¿¿G H
;
¿¿H I
var
¡¡ 
	csvResult
¡¡ 
=
¡¡ 
await
¡¡  %

_csvWriter
¡¡& 0
.
¡¡0 1
WriteToCSVAsync
¡¡1 @
(
¡¡@ A
CurrentSession
¡¡A O
.
¡¡O P
Loads
¡¡P U
)
¡¡U V
;
¡¡V W
_logger
¬¬ 
.
¬¬ 
LogInfo
¬¬ 
(
¬¬  
$"
¬¬  "
$str
¬¬" >
{
¬¬> ?
	csvResult
¬¬? H
.
¬¬H I
LocalSuccess
¬¬I U
}
¬¬U V
$str
¬¬V a
{
¬¬a b
	csvResult
¬¬b k
.
¬¬k l
NetworkSuccess
¬¬l z
}
¬¬z {
"
¬¬{ |
)
¬¬| }
;
¬¬} ~
result
ƒƒ 
.
ƒƒ 
LocalCSVSuccess
ƒƒ &
=
ƒƒ' (
	csvResult
ƒƒ) 2
.
ƒƒ2 3
LocalSuccess
ƒƒ3 ?
;
ƒƒ? @
result
≈≈ 
.
≈≈ 
NetworkCSVSuccess
≈≈ (
=
≈≈) *
	csvResult
≈≈+ 4
.
≈≈4 5
NetworkSuccess
≈≈5 C
;
≈≈C D
result
∆∆ 
.
∆∆ 
LocalCSVPath
∆∆ #
=
∆∆$ %

_csvWriter
∆∆& 0
.
∆∆0 1
GetLocalCSVPath
∆∆1 @
(
∆∆@ A
)
∆∆A B
;
∆∆B C
result
«« 
.
«« 
NetworkCSVPath
«« %
=
««& '

_csvWriter
««( 2
.
««2 3
GetNetworkCSVPath
««3 D
(
««D E
)
««E F
;
««F G
if
…… 
(
…… 
!
…… 
	csvResult
…… 
.
…… 
LocalSuccess
…… +
)
……+ ,
{
   
var
ÀÀ 
msg
ÀÀ 
=
ÀÀ 
$"
ÀÀ  
$str
ÀÀ  8
{
ÀÀ8 9
	csvResult
ÀÀ9 B
.
ÀÀB C

LocalError
ÀÀC M
}
ÀÀM N
"
ÀÀN O
;
ÀÀO P
result
ÃÃ 
.
ÃÃ 
Errors
ÃÃ !
.
ÃÃ! "
Add
ÃÃ" %
(
ÃÃ% &
msg
ÃÃ& )
)
ÃÃ) *
;
ÃÃ* +
_logger
ÕÕ 
.
ÕÕ 
LogError
ÕÕ $
(
ÕÕ$ %
msg
ÕÕ% (
)
ÕÕ( )
;
ÕÕ) *
}
ŒŒ 
if
–– 
(
–– 
!
–– 
	csvResult
–– 
.
–– 
NetworkSuccess
–– -
)
––- .
{
—— 
var
““ 
msg
““ 
=
““ 
$"
““  
$str
““  :
{
““: ;
	csvResult
““; D
.
““D E
NetworkError
““E Q
}
““Q R
"
““R S
;
““S T
result
”” 
.
”” 
Warnings
”” #
.
””# $
Add
””$ '
(
””' (
msg
””( +
)
””+ ,
;
””, -
_logger
‘‘ 
.
‘‘ 

LogWarning
‘‘ &
(
‘‘& '
msg
‘‘' *
)
‘‘* +
;
‘‘+ ,
}
’’ 
_logger
◊◊ 
.
◊◊ 
LogInfo
◊◊ 
(
◊◊  
$str
◊◊  K
)
◊◊K L
;
◊◊L M
messageProgress
ÿÿ 
?
ÿÿ  
.
ÿÿ  !
Report
ÿÿ! '
(
ÿÿ' (
$str
ÿÿ( ?
)
ÿÿ? @
;
ÿÿ@ A
percentProgress
ŸŸ 
?
ŸŸ  
.
ŸŸ  !
Report
ŸŸ! '
(
ŸŸ' (
$num
ŸŸ( *
)
ŸŸ* +
;
ŸŸ+ ,
try
‹‹ 
{
›› 
_logger
ﬁﬁ 
.
ﬁﬁ 
LogInfo
ﬁﬁ #
(
ﬁﬁ# $
$str
ﬁﬁ$ X
)
ﬁﬁX Y
;
ﬁﬁY Z
int
ﬂﬂ 

savedCount
ﬂﬂ "
=
ﬂﬂ# $
await
ﬂﬂ% *
_mysqlReceiving
ﬂﬂ+ :
.
ﬂﬂ: ;%
SaveReceivingLoadsAsync
ﬂﬂ; R
(
ﬂﬂR S
CurrentSession
ﬂﬂS a
.
ﬂﬂa b
Loads
ﬂﬂb g
)
ﬂﬂg h
;
ﬂﬂh i
result
‡‡ 
.
‡‡ 
DatabaseSuccess
‡‡ *
=
‡‡+ ,
true
‡‡- 1
;
‡‡1 2
result
·· 
.
·· 

LoadsSaved
·· %
=
··& '

savedCount
··( 2
;
··2 3
_logger
‚‚ 
.
‚‚ 
LogInfo
‚‚ #
(
‚‚# $
$"
‚‚$ &
$str
‚‚& 9
{
‚‚9 :

savedCount
‚‚: D
}
‚‚D E
$str
‚‚E X
"
‚‚X Y
)
‚‚Y Z
;
‚‚Z [
}
„„ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ÂÂ 
result
ÊÊ 
.
ÊÊ 
DatabaseSuccess
ÊÊ *
=
ÊÊ+ ,
false
ÊÊ- 2
;
ÊÊ2 3
result
ÁÁ 
.
ÁÁ 
Errors
ÁÁ !
.
ÁÁ! "
Add
ÁÁ" %
(
ÁÁ% &
$"
ÁÁ& (
$str
ÁÁ( >
{
ÁÁ> ?
ex
ÁÁ? A
.
ÁÁA B
Message
ÁÁB I
}
ÁÁI J
"
ÁÁJ K
)
ÁÁK L
;
ÁÁL M
_logger
ËË 
.
ËË 
LogError
ËË $
(
ËË$ %
$str
ËË% ;
,
ËË; <
ex
ËË= ?
)
ËË? @
;
ËË@ A
}
ÈÈ 
_logger
ÎÎ 
.
ÎÎ 
LogInfo
ÎÎ 
(
ÎÎ  
$str
ÎÎ  C
)
ÎÎC D
;
ÎÎD E
messageProgress
ÏÏ 
?
ÏÏ  
.
ÏÏ  !
Report
ÏÏ! '
(
ÏÏ' (
$str
ÏÏ( 7
)
ÏÏ7 8
;
ÏÏ8 9
percentProgress
ÌÌ 
?
ÌÌ  
.
ÌÌ  !
Report
ÌÌ! '
(
ÌÌ' (
$num
ÌÌ( *
)
ÌÌ* +
;
ÌÌ+ ,
result
 
.
 
Success
 
=
  
result
! '
.
' (
LocalCSVSuccess
( 7
&&
8 :
result
; A
.
A B
DatabaseSuccess
B Q
;
Q R
if
ÛÛ 
(
ÛÛ 
result
ÛÛ 
.
ÛÛ 
Success
ÛÛ "
)
ÛÛ" #
{
ÙÙ 
await
ıı 
_sessionManager
ıı )
.
ıı) *
ClearSessionAsync
ıı* ;
(
ıı; <
)
ıı< =
;
ıı= >
_logger
ˆˆ 
.
ˆˆ 
LogInfo
ˆˆ #
(
ˆˆ# $
$str
ˆˆ$ M
)
ˆˆM N
;
ˆˆN O
}
˜˜ 
else
¯¯ 
{
˘˘ 
_logger
˙˙ 
.
˙˙ 

LogWarning
˙˙ &
(
˙˙& '
$str
˙˙' L
)
˙˙L M
;
˙˙M N
}
˚˚ 
percentProgress
˝˝ 
?
˝˝  
.
˝˝  !
Report
˝˝! '
(
˝˝' (
$num
˝˝( +
)
˝˝+ ,
;
˝˝, -
return
˛˛ 
result
˛˛ 
;
˛˛ 
}
ˇˇ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
result
ÇÇ 
.
ÇÇ 
Success
ÇÇ 
=
ÇÇ  
false
ÇÇ! &
;
ÇÇ& '
result
ÉÉ 
.
ÉÉ 
Errors
ÉÉ 
.
ÉÉ 
Add
ÉÉ !
(
ÉÉ! "
$"
ÉÉ" $
$str
ÉÉ$ A
{
ÉÉA B
ex
ÉÉB D
.
ÉÉD E
Message
ÉÉE L
}
ÉÉL M
"
ÉÉM N
)
ÉÉN O
;
ÉÉO P
_logger
ÑÑ 
.
ÑÑ 
LogError
ÑÑ  
(
ÑÑ  !
$str
ÑÑ! 8
,
ÑÑ8 9
ex
ÑÑ: <
)
ÑÑ< =
;
ÑÑ= >
return
ÖÖ 
result
ÖÖ 
;
ÖÖ 
}
ÜÜ 
}
áá 	
public
ââ 
async
ââ 
Task
ââ  
ResetWorkflowAsync
ââ ,
(
ââ, -
)
ââ- .
{
ää 	
CurrentSession
ãã 
=
ãã 
new
ãã  $
Model_ReceivingSession
ãã! 7
(
ãã7 8
)
ãã8 9
;
ãã9 :
NumberOfLoads
åå 
=
åå 
$num
åå 
;
åå 
CurrentStep
çç 
=
çç 
WorkflowStep
çç &
.
çç& '
POEntry
çç' .
;
çç. /
CurrentPONumber
éé 
=
éé 
null
éé "
;
éé" #
CurrentPart
èè 
=
èè 
null
èè 
;
èè 
IsNonPOItem
êê 
=
êê 
false
êê 
;
êê   
_currentBatchLoads
ëë 
.
ëë 
Clear
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '
await
ìì 
_sessionManager
ìì !
.
ìì! "
ClearSessionAsync
ìì" 3
(
ìì3 4
)
ìì4 5
;
ìì5 6
StepChanged
îî 
?
îî 
.
îî 
Invoke
îî 
(
îî  
this
îî  $
,
îî$ %
	EventArgs
îî& /
.
îî/ 0
Empty
îî0 5
)
îî5 6
;
îî6 7
}
ïï 	
public
óó 
async
óó 
Task
óó 
<
óó 
CSVDeleteResult
óó )
>
óó) * 
ResetCSVFilesAsync
óó+ =
(
óó= >
)
óó> ?
{
òò 	
_logger
ôô 
.
ôô 
LogInfo
ôô 
(
ôô 
$str
ôô <
)
ôô< =
;
ôô= >
return
öö 
await
öö 

_csvWriter
öö #
.
öö# $!
DeleteCSVFilesAsync
öö$ 7
(
öö7 8
)
öö8 9
;
öö9 :
}
õõ 	
public
ùù 
async
ùù 
Task
ùù !
PersistSessionAsync
ùù -
(
ùù- .
)
ùù. /
{
ûû 	
if
üü 
(
üü 
CurrentSession
üü 
.
üü 
HasLoads
üü '
)
üü' (
{
†† 
await
°° 
_sessionManager
°° %
.
°°% &
SaveSessionAsync
°°& 6
(
°°6 7
CurrentSession
°°7 E
)
°°E F
;
°°F G
}
¢¢ 
}
££ 	
}
§§ 
}•• ◊Ü
gC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Receiving\Service_ReceivingValidation.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
., -
	Receiving- 6
{ 
public 

class '
Service_ReceivingValidation ,
:- .(
IService_ReceivingValidation/ K
{ 
private 
readonly  
IService_InforVisual -
_inforVisualService. A
;A B
public '
Service_ReceivingValidation *
(* + 
IService_InforVisual+ ?
inforVisualService@ R
)R S
{ 	
_inforVisualService 
=  !
inforVisualService" 4
??5 7
throw8 =
new> A!
ArgumentNullExceptionB W
(W X
nameofX ^
(^ _
inforVisualService_ q
)q r
)r s
;s t
} 	
public %
ReceivingValidationResult (
ValidatePONumber) 9
(9 :
string: @
poNumberA I
)I J
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
poNumber* 2
)2 3
)3 4
return %
ReceivingValidationResult 0
.0 1
Error1 6
(6 7
$str7 N
)N O
;O P
if 
( 
! 
Regex 
. 
IsMatch 
( 
poNumber '
,' (
$str) ;
,; <
RegexOptions= I
.I J

IgnoreCaseJ T
)T U
)U V
return   %
ReceivingValidationResult   0
.  0 1
Error  1 6
(  6 7
$str  7 z
)  z {
;  { |
return"" %
ReceivingValidationResult"" ,
."", -
Success""- 4
(""4 5
)""5 6
;""6 7
}## 	
public%% %
ReceivingValidationResult%% (
ValidatePartID%%) 7
(%%7 8
string%%8 >
partID%%? E
)%%E F
{&& 	
if'' 
('' 
string'' 
.'' 
IsNullOrWhiteSpace'' )
('') *
partID''* 0
)''0 1
)''1 2
return(( %
ReceivingValidationResult(( 0
.((0 1
Error((1 6
(((6 7
$str((7 L
)((L M
;((M N
if** 
(** 
partID** 
.** 
Length** 
>** 
$num**  "
)**" #
return++ %
ReceivingValidationResult++ 0
.++0 1
Error++1 6
(++6 7
$str++7 \
)++\ ]
;++] ^
return-- %
ReceivingValidationResult-- ,
.--, -
Success--- 4
(--4 5
)--5 6
;--6 7
}.. 	
public00 %
ReceivingValidationResult00 (!
ValidateNumberOfLoads00) >
(00> ?
int00? B
numLoads00C K
)00K L
{11 	
if22 
(22 
numLoads22 
<22 
$num22 
)22 
return33 %
ReceivingValidationResult33 0
.330 1
Error331 6
(336 7
$str337 [
)33[ \
;33\ ]
if55 
(55 
numLoads55 
>55 
$num55 
)55 
return66 %
ReceivingValidationResult66 0
.660 1
Error661 6
(666 7
$str667 Y
)66Y Z
;66Z [
return88 %
ReceivingValidationResult88 ,
.88, -
Success88- 4
(884 5
)885 6
;886 7
}99 	
public;; %
ReceivingValidationResult;; ("
ValidateWeightQuantity;;) ?
(;;? @
decimal;;@ G
weightQuantity;;H V
);;V W
{<< 	
if== 
(== 
weightQuantity== 
<=== !
$num==" #
)==# $
return>> %
ReceivingValidationResult>> 0
.>>0 1
Error>>1 6
(>>6 7
$str>>7 _
)>>_ `
;>>` a
return@@ %
ReceivingValidationResult@@ ,
.@@, -
Success@@- 4
(@@4 5
)@@5 6
;@@6 7
}AA 	
publicCC %
ReceivingValidationResultCC ( 
ValidatePackageCountCC) =
(CC= >
intCC> A
packagesPerLoadCCB Q
)CCQ R
{DD 	
ifEE 
(EE 
packagesPerLoadEE 
<=EE  "
$numEE# $
)EE$ %
returnFF %
ReceivingValidationResultFF 0
.FF0 1
ErrorFF1 6
(FF6 7
$strFF7 ]
)FF] ^
;FF^ _
returnHH %
ReceivingValidationResultHH ,
.HH, -
SuccessHH- 4
(HH4 5
)HH5 6
;HH6 7
}II 	
publicKK %
ReceivingValidationResultKK (!
ValidateHeatLotNumberKK) >
(KK> ?
stringKK? E
heatLotNumberKKF S
)KKS T
{LL 	
ifMM 
(MM 
stringMM 
.MM 
IsNullOrWhiteSpaceMM )
(MM) *
heatLotNumberMM* 7
)MM7 8
)MM8 9
returnNN %
ReceivingValidationResultNN 0
.NN0 1
ErrorNN1 6
(NN6 7
$strNN7 T
)NNT U
;NNU V
ifPP 
(PP 
heatLotNumberPP 
.PP 
LengthPP $
>PP% &
$numPP' )
)PP) *
returnQQ %
ReceivingValidationResultQQ 0
.QQ0 1
ErrorQQ1 6
(QQ6 7
$strQQ7 d
)QQd e
;QQe f
returnSS %
ReceivingValidationResultSS ,
.SS, -
SuccessSS- 4
(SS4 5
)SS5 6
;SS6 7
}TT 	
publicVV 
TaskVV 
<VV %
ReceivingValidationResultVV -
>VV- .*
ValidateAgainstPOQuantityAsyncVV/ M
(VVM N
decimalVVN U
totalQuantityVVV c
,VVc d
decimalVVe l
orderedQuantityVVm |
,VV| }
string	VV~ Ñ
partID
VVÖ ã
)
VVã å
{WW 	
ifXX 
(XX 
totalQuantityXX 
>XX 
orderedQuantityXX  /
)XX/ 0
{YY 
returnZZ 
TaskZZ 
.ZZ 

FromResultZZ &
(ZZ& '%
ReceivingValidationResultZZ' @
.ZZ@ A
WarningZZA H
(ZZH I
$"[[ 
$str[[ &
{[[& '
totalQuantity[[' 4
:[[4 5
$str[[5 7
}[[7 8
$str[[8 W
{[[W X
orderedQuantity[[X g
:[[g h
$str[[h j
}[[j k
$str[[k v
{[[v w
partID[[w }
}[[} ~
$str	[[~ ò
"
[[ò ô
)
[[ô ö
)
[[ö õ
;
[[õ ú
}\\ 
return^^ 
Task^^ 
.^^ 

FromResult^^ "
(^^" #%
ReceivingValidationResult^^# <
.^^< =
Success^^= D
(^^D E
)^^E F
)^^F G
;^^G H
}__ 	
publicaa 
asyncaa 
Taskaa 
<aa %
ReceivingValidationResultaa 3
>aa3 4&
CheckSameDayReceivingAsyncaa5 O
(aaO P
stringaaP V
poNumberaaW _
,aa_ `
stringaaa g
partIDaah n
,aan o
decimalaap w 
userEnteredQuantity	aax ã
)
aaã å
{bb 	
varcc 
resultcc 
=cc 
awaitcc 
_inforVisualServicecc 2
.cc2 3,
 GetSameDayReceivingQuantityAsynccc3 S
(ccS T
poNumberccT \
,cc\ ]
partIDcc^ d
,ccd e
DateTimeccf n
.ccn o
Todaycco t
)cct u
;ccu v
ifee 
(ee 
resultee 
.ee 
Successee 
)ee 
{ff 
vargg 

sameDayQtygg 
=gg  
resultgg! '
.gg' (
Datagg( ,
;gg, -
ifhh 
(hh 

sameDayQtyhh 
>hh  
$numhh! "
)hh" #
{ii 
returnjj %
ReceivingValidationResultjj 4
.jj4 5
Warningjj5 <
(jj< =
$"kk 
$strkk 
{kk  
partIDkk  &
}kk& '
$strkk' Q
{kkQ R

sameDayQtykkR \
:kk\ ]
$strkk] _
}kk_ `
$strkk` }
{kk} ~ 
userEnteredQuantity	kk~ ë
:
kkë í
$str
kkí î
}
kkî ï
$str
kkï •
"
kk• ¶
)
kk¶ ß
;
kkß ®
}ll 
}mm 
returnpp %
ReceivingValidationResultpp ,
.pp, -
Successpp- 4
(pp4 5
)pp5 6
;pp6 7
}qq 	
publicss %
ReceivingValidationResultss (!
ValidateReceivingLoadss) >
(ss> ?
Model_ReceivingLoadss? R
loadssS W
)ssW X
{tt 	
varuu 
errorsuu 
=uu 
newuu 
Listuu !
<uu! "
stringuu" (
>uu( )
(uu) *
)uu* +
;uu+ ,
ifww 
(ww 
stringww 
.ww 
IsNullOrWhiteSpaceww )
(ww) *
loadww* .
.ww. /
PartIDww/ 5
)ww5 6
)ww6 7
errorsxx 
.xx 
Addxx 
(xx 
$strxx 0
)xx0 1
;xx1 2
ifzz 
(zz 
stringzz 
.zz 
IsNullOrWhiteSpacezz )
(zz) *
loadzz* .
.zz. /
PartTypezz/ 7
)zz7 8
)zz8 9
errors{{ 
.{{ 
Add{{ 
({{ 
$str{{ 2
){{2 3
;{{3 4
if}} 
(}} 
load}} 
.}} 

LoadNumber}} 
<}}  !
$num}}" #
)}}# $
errors~~ 
.~~ 
Add~~ 
(~~ 
$str~~ ;
)~~; <
;~~< =
if
ÄÄ 
(
ÄÄ 
load
ÄÄ 
.
ÄÄ 
WeightQuantity
ÄÄ #
<=
ÄÄ$ &
$num
ÄÄ' (
)
ÄÄ( )
errors
ÅÅ 
.
ÅÅ 
Add
ÅÅ 
(
ÅÅ 
$"
ÅÅ 
$str
ÅÅ "
{
ÅÅ" #
load
ÅÅ# '
.
ÅÅ' (

LoadNumber
ÅÅ( 2
}
ÅÅ2 3
$str
ÅÅ3 [
"
ÅÅ[ \
)
ÅÅ\ ]
;
ÅÅ] ^
if
ÉÉ 
(
ÉÉ 
string
ÉÉ 
.
ÉÉ  
IsNullOrWhiteSpace
ÉÉ )
(
ÉÉ) *
load
ÉÉ* .
.
ÉÉ. /
HeatLotNumber
ÉÉ/ <
)
ÉÉ< =
)
ÉÉ= >
errors
ÑÑ 
.
ÑÑ 
Add
ÑÑ 
(
ÑÑ 
$"
ÑÑ 
$str
ÑÑ "
{
ÑÑ" #
load
ÑÑ# '
.
ÑÑ' (

LoadNumber
ÑÑ( 2
}
ÑÑ2 3
$str
ÑÑ3 P
"
ÑÑP Q
)
ÑÑQ R
;
ÑÑR S
if
ÜÜ 
(
ÜÜ 
load
ÜÜ 
.
ÜÜ 
PackagesPerLoad
ÜÜ $
<=
ÜÜ% '
$num
ÜÜ( )
)
ÜÜ) *
errors
áá 
.
áá 
Add
áá 
(
áá 
$"
áá 
$str
áá "
{
áá" #
load
áá# '
.
áá' (

LoadNumber
áá( 2
}
áá2 3
$str
áá3 Y
"
ááY Z
)
ááZ [
;
áá[ \
if
ââ 
(
ââ 
string
ââ 
.
ââ  
IsNullOrWhiteSpace
ââ )
(
ââ) *
load
ââ* .
.
ââ. /
PackageTypeName
ââ/ >
)
ââ> ?
)
ââ? @
errors
ää 
.
ää 
Add
ää 
(
ää 
$"
ää 
$str
ää "
{
ää" #
load
ää# '
.
ää' (

LoadNumber
ää( 2
}
ää2 3
$str
ää3 M
"
ääM N
)
ääN O
;
ääO P
if
åå 
(
åå 
errors
åå 
.
åå 
Any
åå 
(
åå 
)
åå 
)
åå 
{
çç 
var
éé 
result
éé 
=
éé '
ReceivingValidationResult
éé 6
.
éé6 7
Error
éé7 <
(
éé< =
string
éé= C
.
ééC D
Join
ééD H
(
ééH I
$str
ééI M
,
ééM N
errors
ééO U
)
ééU V
)
ééV W
;
ééW X
result
èè 
.
èè 
Errors
èè 
=
èè 
errors
èè  &
;
èè& '
return
êê 
result
êê 
;
êê 
}
ëë 
return
ìì '
ReceivingValidationResult
ìì ,
.
ìì, -
Success
ìì- 4
(
ìì4 5
)
ìì5 6
;
ìì6 7
}
îî 	
public
ññ '
ReceivingValidationResult
ññ (
ValidateSession
ññ) 8
(
ññ8 9
List
ññ9 =
<
ññ= >!
Model_ReceivingLoad
ññ> Q
>
ññQ R
loads
ññS X
)
ññX Y
{
óó 	
if
òò 
(
òò 
loads
òò 
==
òò 
null
òò 
||
òò  
loads
òò! &
.
òò& '
Count
òò' ,
==
òò- /
$num
òò0 1
)
òò1 2
return
ôô '
ReceivingValidationResult
ôô 0
.
ôô0 1
Error
ôô1 6
(
ôô6 7
$str
ôô7 _
)
ôô_ `
;
ôô` a
var
õõ 
	allErrors
õõ 
=
õõ 
new
õõ 
List
õõ  $
<
õõ$ %
string
õõ% +
>
õõ+ ,
(
õõ, -
)
õõ- .
;
õõ. /
foreach
ùù 
(
ùù 
var
ùù 
load
ùù 
in
ùù  
loads
ùù! &
)
ùù& '
{
ûû 
var
üü 
loadValidation
üü "
=
üü# $#
ValidateReceivingLoad
üü% :
(
üü: ;
load
üü; ?
)
üü? @
;
üü@ A
if
†† 
(
†† 
!
†† 
loadValidation
†† #
.
††# $
IsValid
††$ +
)
††+ ,
{
°° 
	allErrors
¢¢ 
.
¢¢ 
AddRange
¢¢ &
(
¢¢& '
loadValidation
¢¢' 5
.
¢¢5 6
Errors
¢¢6 <
)
¢¢< =
;
¢¢= >
}
££ 
}
§§ 
if
¶¶ 
(
¶¶ 
	allErrors
¶¶ 
.
¶¶ 
Any
¶¶ 
(
¶¶ 
)
¶¶ 
)
¶¶  
{
ßß 
var
®® 
result
®® 
=
®® '
ReceivingValidationResult
®® 6
.
®®6 7
Error
®®7 <
(
®®< =
$"
®®= ?
{
®®? @
	allErrors
®®@ I
.
®®I J
Count
®®J O
}
®®O P
$str
®®P j
"
®®j k
)
®®k l
;
®®l m
result
©© 
.
©© 
Errors
©© 
=
©© 
	allErrors
©©  )
;
©©) *
return
™™ 
result
™™ 
;
™™ 
}
´´ 
return
≠≠ '
ReceivingValidationResult
≠≠ ,
.
≠≠, -
Success
≠≠- 4
(
≠≠4 5
)
≠≠5 6
;
≠≠6 7
}
ÆÆ 	
public
∞∞ 
async
∞∞ 
Task
∞∞ 
<
∞∞ '
ReceivingValidationResult
∞∞ 3
>
∞∞3 4-
ValidatePartExistsInVisualAsync
∞∞5 T
(
∞∞T U
string
∞∞U [
partID
∞∞\ b
)
∞∞b c
{
±± 	
var
≤≤ 
result
≤≤ 
=
≤≤ 
await
≤≤ !
_inforVisualService
≤≤ 2
.
≤≤2 3
GetPartByIDAsync
≤≤3 C
(
≤≤C D
partID
≤≤D J
)
≤≤J K
;
≤≤K L
if
¥¥ 
(
¥¥ 
!
¥¥ 
result
¥¥ 
.
¥¥ 
Success
¥¥ 
)
¥¥  
{
µµ 
return
∂∂ '
ReceivingValidationResult
∂∂ 0
.
∂∂0 1
Error
∂∂1 6
(
∂∂6 7
$"
∂∂7 9
$str
∂∂9 P
{
∂∂P Q
result
∂∂Q W
.
∂∂W X
ErrorMessage
∂∂X d
}
∂∂d e
"
∂∂e f
)
∂∂f g
;
∂∂g h
}
∑∑ 
if
ππ 
(
ππ 
result
ππ 
.
ππ 
Data
ππ 
==
ππ 
null
ππ #
)
ππ# $
{
∫∫ 
return
ªª '
ReceivingValidationResult
ªª 0
.
ªª0 1
Error
ªª1 6
(
ªª6 7
$"
ªª7 9
$str
ªª9 A
{
ªªA B
partID
ªªB H
}
ªªH I
$str
ªªI l
"
ªªl m
)
ªªm n
;
ªªn o
}
ºº 
return
ææ '
ReceivingValidationResult
ææ ,
.
ææ, -
Success
ææ- 4
(
ææ4 5
)
ææ5 6
;
ææ6 7
}
øø 	
}
¿¿ 
}¡¡ ±
gC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Receiving\Service_MySQL_ReceivingLine.cs
	namespace

 	%
MTM_Receiving_Application


 #
.

# $
Services

$ ,
.

, -
	Receiving

- 6
;

6 7
public 
class '
Service_MySQL_ReceivingLine (
:) *(
IService_MySQL_ReceivingLine+ G
{ 
private 
readonly 
Dao_ReceivingLine &
_receivingLineDao' 8
;8 9
private 
readonly #
IService_LoggingUtility ,
_logger- 4
;4 5
private 
readonly !
IService_ErrorHandler *
_errorHandler+ 8
;8 9
public 
'
Service_MySQL_ReceivingLine &
(& '
Dao_ReceivingLine 
receivingLineDao *
,* +#
IService_LoggingUtility 
logger  &
,& '!
IService_ErrorHandler 
errorHandler *
)* +
{ 
_receivingLineDao 
= 
receivingLineDao ,
;, -
_logger 
= 
logger 
; 
_errorHandler 
= 
errorHandler $
;$ %
} 
public 

async 
Task 
< 
Model_Dao_Result &
>& '$
InsertReceivingLineAsync( @
(@ A
Model_ReceivingLineA T
lineU Y
)Y Z
{ 
try 
{ 	
var!! 
result!! 
=!! 
await!! 
_receivingLineDao!! 0
.!!0 1$
InsertReceivingLineAsync!!1 I
(!!I J
line!!J N
)!!N O
;!!O P
if## 
(## 
!## 
result## 
.## 
	IsSuccess## !
)##! "
{$$ 
_logger%% 
.%% 
LogError%%  
(%%  !
$"&& 
$str&& 7
{&&7 8
result&&8 >
.&&> ?
ErrorMessage&&? K
}&&K L
"&&L M
,&&M N
null&&O S
,&&S T
$str&&U d
)&&d e
;&&e f
}'' 
else(( 
{)) 
_logger** 
.** 
LogInfo** 
(**  
$"++ 
$str++ 4
{++4 5
line++5 9
.++9 :
PONumber++: B
}++B C
$str++C J
{++J K
line++K O
.++O P
PartID++P V
}++V W
"++W X
,++X Y
$str++Z i
)++i j
;++j k
},, 
return.. 
result.. 
;.. 
}// 	
catch00 
(00 
	Exception00 
ex00 
)00 
{11 	
await22 
_errorHandler22 
.22  
HandleErrorAsync22  0
(220 1
$"33 
$str33 
{33 
nameof33 "
(33" #$
InsertReceivingLineAsync33# ;
)33; <
}33< =
$str33= ?
{33? @
ex33@ B
.33B C
Message33C J
}33J K
"33K L
,33L M
Enum_ErrorSeverity44 "
.44" #
Critical44# +
,44+ ,
ex55 
)55 
;55 
return77 $
Model_Dao_Result_Factory77 +
.77+ ,
Failure77, 3
(773 4
$str88 C
,88C D
ex88E G
)88G H
;88H I
}99 	
}:: 
};; —p
cC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Receiving\Service_DunnageWorkflow.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Services		$ ,
.		, -
	Receiving		- 6
{

 
public 

class #
Service_DunnageWorkflow (
:) *$
IService_DunnageWorkflow+ C
{ 
private 
readonly "
IService_MySQL_Dunnage /
_dunnageService0 ?
;? @
private 
readonly %
IService_DunnageCSVWriter 2

_csvWriter3 =
;= >
private 
readonly '
IService_UserSessionManager 4
_sessionManager5 D
;D E
private 
readonly #
IService_LoggingUtility 0
_logger1 8
;8 9
private 
readonly !
IService_ErrorHandler .
_errorHandler/ <
;< =
public $
Enum_DunnageWorkflowStep '
CurrentStep( 3
{4 5
get6 9
;9 :
private; B
setC F
;F G
}H I
public  
Model_DunnageSession #
CurrentSession$ 2
{3 4
get5 8
;8 9
private: A
setB E
;E F
}G H
=I J
newK N
(N O
)O P
;P Q
public 
event 
EventHandler !
?! "
StepChanged# .
;. /
public 
event 
EventHandler !
<! "
string" (
>( )
?) *
StatusMessageRaised+ >
;> ?
public #
Service_DunnageWorkflow &
(& '"
IService_MySQL_Dunnage "
dunnageService# 1
,1 2%
IService_DunnageCSVWriter %
	csvWriter& /
,/ 0'
IService_UserSessionManager '
sessionManager( 6
,6 7#
IService_LoggingUtility #
logger$ *
,* +!
IService_ErrorHandler !
errorHandler" .
). /
{ 	
_dunnageService   
=   
dunnageService   ,
;  , -

_csvWriter!! 
=!! 
	csvWriter!! "
;!!" #
_sessionManager"" 
="" 
sessionManager"" ,
;"", -
_logger## 
=## 
logger## 
;## 
_errorHandler$$ 
=$$ 
errorHandler$$ (
;$$( )
}%% 	
public'' 
Task'' 
<'' 
bool'' 
>'' 
StartWorkflowAsync'' ,
('', -
)''- .
{(( 	
ClearSession)) 
()) 
))) 
;)) 
GoToStep** 
(** $
Enum_DunnageWorkflowStep** -
.**- .
ModeSelection**. ;
)**; <
;**< =
StatusMessageRaised++ 
?++  
.++  !
Invoke++! '
(++' (
this++( ,
,++, -
$str++. @
)++@ A
;++A B
return,, 
Task,, 
.,, 

FromResult,, "
(,," #
true,,# '
),,' (
;,,( )
}-- 	
public// 
Task// 
<// $
Model_WorkflowStepResult// ,
>//, -"
AdvanceToNextStepAsync//. D
(//D E
)//E F
{00 	
try11 
{22 
switch33 
(33 
CurrentStep33 #
)33# $
{44 
case55 $
Enum_DunnageWorkflowStep55 1
.551 2
ModeSelection552 ?
:55? @
GoToStep66  
(66  !$
Enum_DunnageWorkflowStep66! 9
.669 :
TypeSelection66: G
)66G H
;66H I
break77 
;77 
case99 $
Enum_DunnageWorkflowStep99 1
.991 2
TypeSelection992 ?
:99? @
if:: 
(:: 
CurrentSession:: *
.::* +
SelectedTypeId::+ 9
<=::: <
$num::= >
)::> ?
{;; 
return<< "
Task<<# '
.<<' (

FromResult<<( 2
(<<2 3
new<<3 6$
Model_WorkflowStepResult<<7 O
{<<P Q
	IsSuccess<<R [
=<<\ ]
false<<^ c
,<<c d
ErrorMessage<<e q
=<<r s
$str	<<t ì
}
<<î ï
)
<<ï ñ
;
<<ñ ó
}== 
GoToStep>>  
(>>  !$
Enum_DunnageWorkflowStep>>! 9
.>>9 :
PartSelection>>: G
)>>G H
;>>H I
break?? 
;?? 
caseAA $
Enum_DunnageWorkflowStepAA 1
.AA1 2
PartSelectionAA2 ?
:AA? @
ifBB 
(BB 
CurrentSessionBB *
.BB* +
SelectedPartBB+ 7
==BB8 :
nullBB; ?
)BB? @
{CC 
returnDD "
TaskDD# '
.DD' (

FromResultDD( 2
(DD2 3
newDD3 6$
Model_WorkflowStepResultDD7 O
{DDP Q
	IsSuccessDDR [
=DD\ ]
falseDD^ c
,DDc d
ErrorMessageDDe q
=DDr s
$str	DDt ã
}
DDå ç
)
DDç é
;
DDé è
}EE 
GoToStepFF  
(FF  !$
Enum_DunnageWorkflowStepFF! 9
.FF9 :
QuantityEntryFF: G
)FFG H
;FFH I
breakGG 
;GG 
caseII $
Enum_DunnageWorkflowStepII 1
.II1 2
QuantityEntryII2 ?
:II? @
ifJJ 
(JJ 
CurrentSessionJJ *
.JJ* +
QuantityJJ+ 3
<=JJ4 6
$numJJ7 8
)JJ8 9
{KK 
returnLL "
TaskLL# '
.LL' (

FromResultLL( 2
(LL2 3
newLL3 6$
Model_WorkflowStepResultLL7 O
{LLP Q
	IsSuccessLLR [
=LL\ ]
falseLL^ c
,LLc d
ErrorMessageLLe q
=LLr s
$str	LLt ô
}
LLö õ
)
LLõ ú
;
LLú ù
}MM 
GoToStepNN  
(NN  !$
Enum_DunnageWorkflowStepNN! 9
.NN9 :
DetailsEntryNN: F
)NNF G
;NNG H
breakOO 
;OO 
caseQQ $
Enum_DunnageWorkflowStepQQ 1
.QQ1 2
DetailsEntryQQ2 >
:QQ> ?
GoToStepRR  
(RR  !$
Enum_DunnageWorkflowStepRR! 9
.RR9 :
ReviewRR: @
)RR@ A
;RRA B
breakSS 
;SS 
caseUU $
Enum_DunnageWorkflowStepUU 1
.UU1 2
ReviewUU2 8
:UU8 9
returnVV 
TaskVV #
.VV# $

FromResultVV$ .
(VV. /
newVV/ 2$
Model_WorkflowStepResultVV3 K
{VVL M
	IsSuccessVVN W
=VVX Y
falseVVZ _
,VV_ `
ErrorMessageVVa m
=VVn o
$str	VVp ù
}
VVû ü
)
VVü †
;
VV† °
}WW 
returnYY 
TaskYY 
.YY 

FromResultYY &
(YY& '
newYY' *$
Model_WorkflowStepResultYY+ C
{YYD E
	IsSuccessYYF O
=YYP Q
trueYYR V
,YYV W

TargetStepYYX b
=YYc d
CurrentStepYYe p
}YYq r
)YYr s
;YYs t
}ZZ 
catch[[ 
([[ 
	Exception[[ 
ex[[ 
)[[  
{\\ 
_errorHandler]] 
.]] 
HandleErrorAsync]] .
(]]. /
$str]]/ E
,]]E F
Enum_ErrorSeverity]]G Y
.]]Y Z
Error]]Z _
,]]_ `
ex]]a c
,]]c d
true]]e i
)]]i j
;]]j k
return^^ 
Task^^ 
.^^ 

FromResult^^ &
(^^& '
new^^' *$
Model_WorkflowStepResult^^+ C
{^^D E
	IsSuccess^^F O
=^^P Q
false^^R W
,^^W X
ErrorMessage^^Y e
=^^f g
ex^^h j
.^^j k
Message^^k r
}^^s t
)^^t u
;^^u v
}__ 
}`` 	
publicbb 
voidbb 
GoToStepbb 
(bb $
Enum_DunnageWorkflowStepbb 5
stepbb6 :
)bb: ;
{cc 	
CurrentStepdd 
=dd 
stepdd 
;dd 
StepChangedee 
?ee 
.ee 
Invokeee 
(ee  
thisee  $
,ee$ %
	EventArgsee& /
.ee/ 0
Emptyee0 5
)ee5 6
;ee6 7
}ff 	
publichh 
asynchh 
Taskhh 
<hh 
Model_SaveResulthh *
>hh* +
SaveSessionAsynchh, <
(hh< =
)hh= >
{ii 	
tryjj 
{kk 
varll 
loadsll 
=ll 
newll 
Systemll  &
.ll& '
Collectionsll' 2
.ll2 3
Genericll3 :
.ll: ;
Listll; ?
<ll? @
Model_DunnageLoadll@ Q
>llQ R
(llR S
CurrentSessionllS a
.lla b
Loadsllb g
)llg h
;llh i
ifoo 
(oo 
loadsoo 
.oo 
Countoo 
==oo  "
$numoo# $
)oo$ %
{pp 
ifqq 
(qq 
CurrentSessionqq &
.qq& '
SelectedPartqq' 3
!=qq4 6
nullqq7 ;
&&qq< >
CurrentSessionqq? M
.qqM N
QuantityqqN V
>qqW X
$numqqY Z
)qqZ [
{rr 
varss 
loadss  
=ss! "
newss# &
Model_DunnageLoadss' 8
{tt 
LoadUuiduu $
=uu% &
Guiduu' +
.uu+ ,
NewGuiduu, 3
(uu3 4
)uu4 5
,uu5 6
PartIdvv "
=vv# $
CurrentSessionvv% 3
.vv3 4
SelectedPartvv4 @
.vv@ A
PartIdvvA G
,vvG H
Quantityww $
=ww% &
CurrentSessionww' 5
.ww5 6
Quantityww6 >
,ww> ?
PoNumberxx $
=xx% &
CurrentSessionxx' 5
.xx5 6
PONumberxx6 >
,xx> ?
DunnageTypeyy '
=yy( )
CurrentSessionyy* 8
.yy8 9
SelectedTypeNameyy9 I
,yyI J
Specszz !
=zz" #
CurrentSessionzz$ 2
.zz2 3
SelectedPartzz3 ?
.zz? @
SpecValuesDictzz@ N
,zzN O
ReceivedDate{{ (
={{) *
DateTime{{+ 3
.{{3 4
Now{{4 7
,{{7 8
	CreatedBy|| %
=||& '
_sessionManager||( 7
.||7 8
CurrentSession||8 F
?||F G
.||G H
User||H L
?||L M
.||M N
WindowsUsername||N ]
??||^ `
$str||a j
}}} 
;}} 
loads~~ 
.~~ 
Add~~ !
(~~! "
load~~" &
)~~& '
;~~' (
CurrentSession &
.& '
Loads' ,
., -
Add- 0
(0 1
load1 5
)5 6
;6 7
}
ÄÄ 
else
ÅÅ 
{
ÇÇ 
return
ÉÉ 
new
ÉÉ "
Model_SaveResult
ÉÉ# 3
{
ÉÉ4 5
	IsSuccess
ÉÉ6 ?
=
ÉÉ@ A
false
ÉÉB G
,
ÉÉG H
ErrorMessage
ÉÉI U
=
ÉÉV W
$str
ÉÉX j
}
ÉÉk l
;
ÉÉl m
}
ÑÑ 
}
ÖÖ 
var
àà 
dbResult
àà 
=
àà 
await
àà $
_dunnageService
àà% 4
.
àà4 5
SaveLoadsAsync
àà5 C
(
ààC D
loads
ààD I
)
ààI J
;
ààJ K
if
ââ 
(
ââ 
!
ââ 
dbResult
ââ 
.
ââ 
	IsSuccess
ââ '
)
ââ' (
{
ää 
return
ãã 
new
ãã 
Model_SaveResult
ãã /
{
ãã0 1
	IsSuccess
ãã2 ;
=
ãã< =
false
ãã> C
,
ããC D
ErrorMessage
ããE Q
=
ããR S
dbResult
ããT \
.
ãã\ ]
ErrorMessage
ãã] i
}
ããj k
;
ããk l
}
åå 
var
èè 
	csvResult
èè 
=
èè 
await
èè  %

_csvWriter
èè& 0
.
èè0 1
WriteToCSVAsync
èè1 @
(
èè@ A
loads
èèA F
)
èèF G
;
èèG H
return
ëë 
new
ëë 
Model_SaveResult
ëë +
{
íí 
	IsSuccess
ìì 
=
ìì 
true
ìì  $
,
ìì$ %
RecordsSaved
îî  
=
îî! "
loads
îî# (
.
îî( )
Count
îî) .
,
îî. /
CSVExportResult
ïï #
=
ïï$ %
	csvResult
ïï& /
}
ññ 
;
ññ 
}
óó 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
ôô 
await
öö 
_errorHandler
öö #
.
öö# $
HandleErrorAsync
öö$ 4
(
öö4 5
$str
öö5 K
,
ööK L 
Enum_ErrorSeverity
ööM _
.
öö_ `
Error
öö` e
,
ööe f
ex
öög i
,
ööi j
true
öök o
)
ööo p
;
ööp q
return
õõ 
new
õõ 
Model_SaveResult
õõ +
{
õõ, -
	IsSuccess
õõ. 7
=
õõ8 9
false
õõ: ?
,
õõ? @
ErrorMessage
õõA M
=
õõN O
ex
õõP R
.
õõR S
Message
õõS Z
}
õõ[ \
;
õõ\ ]
}
úú 
}
ùù 	
public
üü 
void
üü 
ClearSession
üü  
(
üü  !
)
üü! "
{
†† 	
CurrentSession
°° 
=
°° 
new
°°  "
Model_DunnageSession
°°! 5
(
°°5 6
)
°°6 7
;
°°7 8!
StatusMessageRaised
¢¢ 
?
¢¢  
.
¢¢  !
Invoke
¢¢! '
(
¢¢' (
this
¢¢( ,
,
¢¢, -
$str
¢¢. ?
)
¢¢? @
;
¢¢@ A
}
££ 	
}
§§ 
}•• ”Z
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Receiving\Service_DunnageCSVWriter.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
., -
	Receiving- 6
{ 
public 

class $
Service_DunnageCSVWriter )
:* +%
IService_DunnageCSVWriter, E
{ 
private 
readonly "
IService_MySQL_Dunnage /
_dunnageService0 ?
;? @
private 
readonly '
IService_UserSessionManager 4
_sessionManager5 D
;D E
private 
readonly #
IService_LoggingUtility 0
_logger1 8
;8 9
private 
readonly !
IService_ErrorHandler .
_errorHandler/ <
;< =
public $
Service_DunnageCSVWriter '
(' ("
IService_MySQL_Dunnage "
dunnageService# 1
,1 2'
IService_UserSessionManager '
sessionManager( 6
,6 7#
IService_LoggingUtility #
logger$ *
,* +!
IService_ErrorHandler !
errorHandler" .
). /
{ 	
_dunnageService 
= 
dunnageService ,
;, -
_sessionManager 
= 
sessionManager ,
;, -
_logger   
=   
logger   
;   
_errorHandler!! 
=!! 
errorHandler!! (
;!!( )
}"" 	
public$$ 
async$$ 
Task$$ 
<$$  
Model_CSVWriteResult$$ .
>$$. /
WriteToCSVAsync$$0 ?
($$? @
List$$@ D
<$$D E
Model_DunnageLoad$$E V
>$$V W
loads$$X ]
)$$] ^
{%% 	
if&& 
(&& 
loads&& 
==&& 
null&& 
||&&  
loads&&! &
.&&& '
Count&&' ,
==&&- /
$num&&0 1
)&&1 2
{'' 
return(( 
new((  
Model_CSVWriteResult(( /
{((0 1
ErrorMessage((2 >
=((? @
$str((A V
}((W X
;((X Y
})) 
try++ 
{,, 
var.. 
specKeys.. 
=.. 
await.. $
_dunnageService..% 4
...4 5
GetAllSpecKeysAsync..5 H
(..H I
)..I J
;..J K
specKeys// 
.// 
Sort// 
(// 
)// 
;//  
var22 
records22 
=22 
new22 !
List22" &
<22& '
dynamic22' .
>22. /
(22/ 0
)220 1
;221 2
foreach33 
(33 
var33 
load33 !
in33" $
loads33% *
)33* +
{44 
dynamic55 
record55 "
=55# $
new55% (
ExpandoObject55) 6
(556 7
)557 8
;558 9
var66 
dict66 
=66 
(66  
IDictionary66  +
<66+ ,
string66, 2
,662 3
object664 :
>66: ;
)66; <
record66< B
;66B C
dict99 
[99 
$str99 &
]99& '
=99( )
load99* .
.99. /
DunnageType99/ :
;99: ;
dict:: 
[:: 
$str:: !
]::! "
=::# $
load::% )
.::) *
PartId::* 0
;::0 1
dict;; 
[;; 
$str;; #
];;# $
=;;% &
load;;' +
.;;+ ,
Quantity;;, 4
;;;4 5
dict<< 
[<< 
$str<< #
]<<# $
=<<% &
load<<' +
.<<+ ,
PoNumber<<, 4
;<<4 5
dict== 
[== 
$str== '
]==' (
===) *
load==+ /
.==/ 0
ReceivedDate==0 <
.==< =
ToString=== E
(==E F
$str==F [
)==[ \
;==\ ]
dict>> 
[>> 
$str>> #
]>># $
=>>% &
load>>' +
.>>+ ,
	CreatedBy>>, 5
;>>5 6
foreachAA 
(AA 
varAA  
keyAA! $
inAA% '
specKeysAA( 0
)AA0 1
{BB 
ifCC 
(CC 
loadCC  
.CC  !
SpecsCC! &
!=CC' )
nullCC* .
&&CC/ 1
loadCC2 6
.CC6 7
SpecsCC7 <
.CC< =
ContainsKeyCC= H
(CCH I
keyCCI L
)CCL M
)CCM N
{DD 
dictEE  
[EE  !
keyEE! $
]EE$ %
=EE& '
loadEE( ,
.EE, -
SpecsEE- 2
[EE2 3
keyEE3 6
]EE6 7
;EE7 8
}FF 
elseGG 
{HH 
dictII  
[II  !
keyII! $
]II$ %
=II& '
$strII( *
;II* +
}JJ 
}KK 
recordsLL 
.LL 
AddLL 
(LL  
recordLL  &
)LL& '
;LL' (
}MM 
varPP 
	localPathPP 
=PP 
GetLocalPathPP  ,
(PP, -
)PP- .
;PP. /
awaitQQ 
WriteCsvFileAsyncQQ '
(QQ' (
	localPathQQ( 1
,QQ1 2
recordsQQ3 :
)QQ: ;
;QQ; <
stringTT 
networkPathTT "
=TT# $
$strTT% '
;TT' (
boolUU 
networkSuccessUU #
=UU$ %
falseUU& +
;UU+ ,
tryVV 
{WW 
networkPathXX 
=XX  !
GetNetworkPathXX" 0
(XX0 1
)XX1 2
;XX2 3
varZZ 

networkDirZZ "
=ZZ# $
PathZZ% )
.ZZ) *
GetDirectoryNameZZ* :
(ZZ: ;
networkPathZZ; F
)ZZF G
;ZZG H
if[[ 
([[ 
![[ 
string[[ 
.[[  
IsNullOrEmpty[[  -
([[- .

networkDir[[. 8
)[[8 9
&&[[: <
![[= >
	Directory[[> G
.[[G H
Exists[[H N
([[N O

networkDir[[O Y
)[[Y Z
)[[Z [
{\\ 
	Directory]] !
.]]! "
CreateDirectory]]" 1
(]]1 2

networkDir]]2 <
)]]< =
;]]= >
}^^ 
await__ 
WriteCsvFileAsync__ +
(__+ ,
networkPath__, 7
,__7 8
records__9 @
)__@ A
;__A B
networkSuccess`` "
=``# $
true``% )
;``) *
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
_loggerdd 
.dd 
LogErrordd $
(dd$ %
$strdd% F
,ddF G
exddH J
,ddJ K
$strddL v
)ddv w
;ddw x
}ff 
returnhh 
newhh  
Model_CSVWriteResulthh /
{ii 
LocalSuccessjj  
=jj! "
truejj# '
,jj' (
LocalFilePathkk !
=kk" #
	localPathkk$ -
,kk- .
NetworkSuccessll "
=ll# $
networkSuccessll% 3
,ll3 4
NetworkFilePathmm #
=mm$ %
networkPathmm& 1
,mm1 2
ErrorMessagenn  
=nn! "
networkSuccessnn# 1
?nn2 3
$strnn4 6
:nn7 8
$strnn9 Z
}oo 
;oo 
}pp 
catchqq 
(qq 
	Exceptionqq 
exqq 
)qq  
{rr 
awaitss 
_errorHandlerss #
.ss# $
HandleErrorAsyncss$ 4
(ss4 5
$"ss5 7
$strss7 F
{ssF G
exssG I
.ssI J
MessagessJ Q
}ssQ R
"ssR S
,ssS T
Enum_ErrorSeverityssU g
.ssg h
Errorssh m
,ssm n
exsso q
,ssq r
truesss w
)ssw x
;ssx y
returntt 
newtt  
Model_CSVWriteResulttt /
{tt0 1
ErrorMessagett2 >
=tt? @
$"ttA C
$strttC R
{ttR S
exttS U
.ttU V
MessagettV ]
}tt] ^
"tt^ _
}tt` a
;tta b
}uu 
}vv 	
privatexx 
asyncxx 
Taskxx 
WriteCsvFileAsyncxx ,
(xx, -
stringxx- 3
pathxx4 8
,xx8 9
IEnumerablexx: E
<xxE F
dynamicxxF M
>xxM N
recordsxxO V
)xxV W
{yy 	
usingzz 
(zz 
varzz 
writerzz 
=zz 
newzz  #
StreamWriterzz$ 0
(zz0 1
pathzz1 5
)zz5 6
)zz6 7
using{{ 
({{ 
var{{ 
csv{{ 
={{ 
new{{  
	CsvWriter{{! *
({{* +
writer{{+ 1
,{{1 2
CultureInfo{{3 >
.{{> ?
InvariantCulture{{? O
){{O P
){{P Q
{|| 
await}} 
csv}} 
.}} 
WriteRecordsAsync}} +
(}}+ ,
records}}, 3
)}}3 4
;}}4 5
}~~ 
} 	
private
ÅÅ 
string
ÅÅ 
GetLocalPath
ÅÅ #
(
ÅÅ# $
)
ÅÅ$ %
{
ÇÇ 	
var
ÉÉ 
appData
ÉÉ 
=
ÉÉ 
Environment
ÉÉ %
.
ÉÉ% &
GetFolderPath
ÉÉ& 3
(
ÉÉ3 4
Environment
ÉÉ4 ?
.
ÉÉ? @
SpecialFolder
ÉÉ@ M
.
ÉÉM N
ApplicationData
ÉÉN ]
)
ÉÉ] ^
;
ÉÉ^ _
var
ÑÑ 
folder
ÑÑ 
=
ÑÑ 
Path
ÑÑ 
.
ÑÑ 
Combine
ÑÑ %
(
ÑÑ% &
appData
ÑÑ& -
,
ÑÑ- .
$str
ÑÑ/ J
)
ÑÑJ K
;
ÑÑK L
if
ÖÖ 
(
ÖÖ 
!
ÖÖ 
	Directory
ÖÖ 
.
ÖÖ 
Exists
ÖÖ !
(
ÖÖ! "
folder
ÖÖ" (
)
ÖÖ( )
)
ÖÖ) *
{
ÜÜ 
	Directory
áá 
.
áá 
CreateDirectory
áá )
(
áá) *
folder
áá* 0
)
áá0 1
;
áá1 2
}
àà 
return
ââ 
Path
ââ 
.
ââ 
Combine
ââ 
(
ââ  
folder
ââ  &
,
ââ& '
$str
ââ( 9
)
ââ9 :
;
ââ: ;
}
ää 	
private
åå 
string
åå 
GetNetworkPath
åå %
(
åå% &
)
åå& '
{
çç 	
var
éé 
username
éé 
=
éé 
_sessionManager
éé *
.
éé* +
CurrentSession
éé+ 9
?
éé9 :
.
éé: ;
User
éé; ?
?
éé? @
.
éé@ A
WindowsUsername
ééA P
??
ééQ S
$str
ééT ]
;
éé] ^
var
èè 
folder
èè 
=
èè 
$@"
èè 
$str
èè h
{
èèh i
username
èèi q
}
èèq r
"
èèr s
;
èès t
return
êê 
Path
êê 
.
êê 
Combine
êê 
(
êê  
folder
êê  &
,
êê& '
$str
êê( 9
)
êê9 :
;
êê: ;
}
ëë 	
}
íí 
}ìì ¶¥
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Receiving\Service_CSVWriter.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
., -
	Receiving- 6
{ 
public 

class 
Service_CSVWriter "
:# $
IService_CSVWriter% 7
{ 
private 
readonly 
string 
_localCSVPath  -
;- .
private 
readonly '
IService_UserSessionManager 4
_sessionManager5 D
;D E
private 
readonly #
IService_LoggingUtility 0
_logger1 8
;8 9
public 
Service_CSVWriter  
(  !'
IService_UserSessionManager! <
sessionManager= K
,K L#
IService_LoggingUtilityM d
loggere k
)k l
{ 	
_sessionManager 
= 
sessionManager ,
??- /
throw0 5
new6 9!
ArgumentNullException: O
(O P
nameofP V
(V W
sessionManagerW e
)e f
)f g
;g h
_logger 
= 
logger 
?? 
throw  %
new& )!
ArgumentNullException* ?
(? @
nameof@ F
(F G
loggerG M
)M N
)N O
;O P
var 
appDataPath 
= 
Environment )
.) *
GetFolderPath* 7
(7 8
Environment8 C
.C D
SpecialFolderD Q
.Q R
ApplicationDataR a
)a b
;b c
var 
appDir 
= 
Path 
. 
Combine %
(% &
appDataPath& 1
,1 2
$str3 N
)N O
;O P
if   
(   
!   
	Directory   
.   
Exists   !
(  ! "
appDir  " (
)  ( )
)  ) *
{!! 
	Directory"" 
."" 
CreateDirectory"" )
("") *
appDir""* 0
)""0 1
;""1 2
}## 
_localCSVPath$$ 
=$$ 
Path$$  
.$$  !
Combine$$! (
($$( )
appDir$$) /
,$$/ 0
$str$$1 D
)$$D E
;$$E F
}%% 	
private'' 
string'' %
GetNetworkCSVPathInternal'' 0
(''0 1
)''1 2
{(( 	
_logger)) 
.)) 
LogInfo)) 
()) 
$str)) ;
))); <
;))< =
try** 
{++ 
string,, 
userName,, 
;,,  
if-- 
(-- 
_sessionManager-- #
.--# $
CurrentSession--$ 2
?--2 3
.--3 4
User--4 8
!=--9 ;
null--< @
)--@ A
{.. 
userName// 
=// 
_sessionManager// .
.//. /
CurrentSession/// =
.//= >
User//> B
.//B C
WindowsUsername//C R
;//R S
}00 
else11 
{22 
userName33 
=33 
Environment33 *
.33* +
UserName33+ 3
;333 4
}44 
var66 
networkBase66 
=66  !
$str66" p
;66p q
var77 
userDir77 
=77 
Path77 "
.77" #
Combine77# *
(77* +
networkBase77+ 6
,776 7
userName778 @
)77@ A
;77A B
_logger99 
.99 
LogInfo99 
(99  
$"99  "
$str99" >
{99> ?
userDir99? F
}99F G
"99G H
)99H I
;99I J
if;; 
(;; 
!;; 
	Directory;; 
.;; 
Exists;; %
(;;% &
userDir;;& -
);;- .
);;. /
{<< 
try== 
{>> 
_logger?? 
.??  
LogInfo??  '
(??' (
$"??( *
$str??* F
{??F G
userDir??G N
}??N O
"??O P
)??P Q
;??Q R
	Directory@@ !
.@@! "
CreateDirectory@@" 1
(@@1 2
userDir@@2 9
)@@9 :
;@@: ;
}AA 
catchBB 
(BB 
	ExceptionBB $
exBB% '
)BB' (
{CC 
_loggerDD 
.DD  

LogWarningDD  *
(DD* +
$"DD+ -
$strDD- Q
{DDQ R
exDDR T
.DDT U
MessageDDU \
}DD\ ]
"DD] ^
)DD^ _
;DD_ `
}EE 
}FF 
returnGG 
PathGG 
.GG 
CombineGG #
(GG# $
userDirGG$ +
,GG+ ,
$strGG- @
)GG@ A
;GGA B
}HH 
catchII 
(II 
	ExceptionII 
exII 
)II  
{JJ 
_loggerKK 
.KK 
LogErrorKK  
(KK  !
$"KK! #
$strKK# A
{KKA B
exKKB D
.KKD E
MessageKKE L
}KKL M
"KKM N
)KKN O
;KKO P
returnLL 
$str	LL É
;
LLÉ Ñ
}MM 
}NN 	
publicPP 
asyncPP 
TaskPP 
<PP 
CSVWriteResultPP (
>PP( )
WriteToCSVAsyncPP* 9
(PP9 :
ListPP: >
<PP> ?
Model_ReceivingLoadPP? R
>PPR S
loadsPPT Y
)PPY Z
{QQ 	
_loggerRR 
.RR 
LogInfoRR 
(RR 
$"RR 
$strRR ;
{RR; <
loadsRR< A
?RRA B
.RRB C
CountRRC H
??RRI K
$numRRL M
}RRM N
$strRRN U
"RRU V
)RRV W
;RRW X
ifSS 
(SS 
loadsSS 
==SS 
nullSS 
||SS  
loadsSS! &
.SS& '
CountSS' ,
==SS- /
$numSS0 1
)SS1 2
throwTT 
newTT 
ArgumentExceptionTT +
(TT+ ,
$strTT, P
,TTP Q
nameofTTR X
(TTX Y
loadsTTY ^
)TT^ _
)TT_ `
;TT` a
varVV 
resultVV 
=VV 
newVV 
CSVWriteResultVV +
{VV, -
RecordsWrittenVV. <
=VV= >
loadsVV? D
.VVD E
CountVVE J
}VVK L
;VVL M
tryYY 
{ZZ 
_logger[[ 
.[[ 
LogInfo[[ 
([[  
$"[[  "
$str[[" 8
{[[8 9
_localCSVPath[[9 F
}[[F G
"[[G H
)[[H I
;[[I J
await\\ 
WriteToFileAsync\\ &
(\\& '
_localCSVPath\\' 4
,\\4 5
loads\\6 ;
)\\; <
;\\< =
result]] 
.]] 
LocalSuccess]] #
=]]$ %
true]]& *
;]]* +
_logger^^ 
.^^ 
LogInfo^^ 
(^^  
$str^^  =
)^^= >
;^^> ?
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
_loggerbb 
.bb 
LogErrorbb  
(bb  !
$"bb! #
$strbb# ;
{bb; <
exbb< >
.bb> ?
Messagebb? F
}bbF G
"bbG H
)bbH I
;bbI J
resultcc 
.cc 
LocalSuccesscc #
=cc$ %
falsecc& +
;cc+ ,
resultdd 
.dd 

LocalErrordd !
=dd" #
exdd$ &
.dd& '
Messagedd' .
;dd. /
throwee 
newee %
InvalidOperationExceptionee 3
(ee3 4
$stree4 T
,eeT U
exeeV X
)eeX Y
;eeY Z
}ff 
tryii 
{jj 
_loggerkk 
.kk 
LogInfokk 
(kk  
$strkk  A
)kkA B
;kkB C
varll 
networkPathll 
=ll  !
awaitll" '
Taskll( ,
.ll, -
Runll- 0
(ll0 1
(ll1 2
)ll2 3
=>ll4 6%
GetNetworkCSVPathInternalll7 P
(llP Q
)llQ R
)llR S
;llS T
_loggermm 
.mm 
LogInfomm 
(mm  
$"mm  "
$strmm" 9
{mm9 :
networkPathmm: E
}mmE F
"mmF G
)mmG H
;mmH I
awaitnn 
WriteToFileAsyncnn &
(nn& '
networkPathnn' 2
,nn2 3
loadsnn4 9
)nn9 :
;nn: ;
resultoo 
.oo 
NetworkSuccessoo %
=oo& '
trueoo( ,
;oo, -
_loggerpp 
.pp 
LogInfopp 
(pp  
$strpp  ?
)pp? @
;pp@ A
}qq 
catchrr 
(rr 
	Exceptionrr 
exrr 
)rr  
{ss 
_loggertt 
.tt 

LogWarningtt "
(tt" #
$"tt# %
$strtt% ?
{tt? @
extt@ B
.ttB C
MessagettC J
}ttJ K
"ttK L
)ttL M
;ttM N
resultuu 
.uu 
NetworkSuccessuu %
=uu& '
falseuu( -
;uu- .
resultvv 
.vv 
NetworkErrorvv #
=vv$ %
exvv& (
.vv( )
Messagevv) 0
;vv0 1
}xx 
returnzz 
resultzz 
;zz 
}{{ 	
public}} 
async}} 
Task}} 
WriteToFileAsync}} *
(}}* +
string}}+ 1
filePath}}2 :
,}}: ;
List}}< @
<}}@ A
Model_ReceivingLoad}}A T
>}}T U
loads}}V [
,}}[ \
bool}}] a
append}}b h
=}}i j
true}}k o
)}}o p
{~~ 	
_logger 
. 
LogInfo 
( 
$" 
$str ;
{; <
filePath< D
}D E
$strE O
{O P
appendP V
}V W
"W X
)X Y
;Y Z
await
ÄÄ 
Task
ÄÄ 
.
ÄÄ 
Run
ÄÄ 
(
ÄÄ 
async
ÄÄ  
(
ÄÄ! "
)
ÄÄ" #
=>
ÄÄ$ &
{
ÅÅ 
try
ÇÇ 
{
ÉÉ 
bool
ÑÑ 
	isNewFile
ÑÑ "
=
ÑÑ# $
!
ÑÑ% &
File
ÑÑ& *
.
ÑÑ* +
Exists
ÑÑ+ 1
(
ÑÑ1 2
filePath
ÑÑ2 :
)
ÑÑ: ;
||
ÑÑ< >
!
ÑÑ? @
append
ÑÑ@ F
;
ÑÑF G
_logger
ÖÖ 
.
ÖÖ 
LogInfo
ÖÖ #
(
ÖÖ# $
$"
ÖÖ$ &
$str
ÖÖ& <
{
ÖÖ< =
filePath
ÖÖ= E
}
ÖÖE F
$str
ÖÖF H
{
ÖÖH I
!
ÖÖI J
	isNewFile
ÖÖJ S
}
ÖÖS T
"
ÖÖT U
)
ÖÖU V
;
ÖÖV W
var
áá 
config
áá 
=
áá  
new
áá! $
CsvConfiguration
áá% 5
(
áá5 6
CultureInfo
áá6 A
.
ááA B
InvariantCulture
ááB R
)
ááR S
{
àà 
}
ää 
;
ää 
var
åå 
fileMode
åå  
=
åå! "
append
åå# )
?
åå* +
FileMode
åå, 4
.
åå4 5
Append
åå5 ;
:
åå< =
FileMode
åå> F
.
ååF G
Create
ååG M
;
ååM N
using
çç 
var
çç 
stream
çç $
=
çç% &
new
çç' *

FileStream
çç+ 5
(
çç5 6
filePath
çç6 >
,
çç> ?
fileMode
çç@ H
,
ççH I

FileAccess
ççJ T
.
ççT U
Write
ççU Z
,
ççZ [
	FileShare
çç\ e
.
ççe f
Read
ççf j
)
ççj k
;
ççk l
using
éé 
var
éé 
writer
éé $
=
éé% &
new
éé' *
StreamWriter
éé+ 7
(
éé7 8
stream
éé8 >
)
éé> ?
;
éé? @
using
èè 
var
èè 
csv
èè !
=
èè" #
new
èè$ '
	CsvWriter
èè( 1
(
èè1 2
writer
èè2 8
,
èè8 9
config
èè: @
)
èè@ A
;
èèA B
if
ëë 
(
ëë 
	isNewFile
ëë !
)
ëë! "
{
íí 
csv
ìì 
.
ìì 
WriteHeader
ìì '
<
ìì' (!
Model_ReceivingLoad
ìì( ;
>
ìì; <
(
ìì< =
)
ìì= >
;
ìì> ?
csv
îî 
.
îî 

NextRecord
îî &
(
îî& '
)
îî' (
;
îî( )
}
ïï 
foreach
óó 
(
óó 
var
óó  
load
óó! %
in
óó& (
loads
óó) .
)
óó. /
{
òò 
csv
ôô 
.
ôô 
WriteRecord
ôô '
(
ôô' (
load
ôô( ,
)
ôô, -
;
ôô- .
csv
öö 
.
öö 

NextRecord
öö &
(
öö& '
)
öö' (
;
öö( )
}
õõ 
await
ùù 
writer
ùù  
.
ùù  !

FlushAsync
ùù! +
(
ùù+ ,
)
ùù, -
;
ùù- .
_logger
ûû 
.
ûû 
LogInfo
ûû #
(
ûû# $
$"
ûû$ &
$str
ûû& <
{
ûû< =
filePath
ûû= E
}
ûûE F
"
ûûF G
)
ûûG H
;
ûûH I
}
üü 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
°° 
_logger
¢¢ 
.
¢¢ 
LogError
¢¢ $
(
¢¢$ %
$"
¢¢% '
$str
¢¢' =
{
¢¢= >
filePath
¢¢> F
}
¢¢F G
$str
¢¢G I
{
¢¢I J
ex
¢¢J L
.
¢¢L M
Message
¢¢M T
}
¢¢T U
"
¢¢U V
)
¢¢V W
;
¢¢W X
throw
££ 
;
££ 
}
§§ 
}
•• 
)
•• 
;
•• 
}
¶¶ 	
public
®® 
async
®® 
Task
®® 
<
®® 
List
®® 
<
®® !
Model_ReceivingLoad
®® 2
>
®®2 3
>
®®3 4
ReadFromCSVAsync
®®5 E
(
®®E F
string
®®F L
filePath
®®M U
)
®®U V
{
©© 	
_logger
™™ 
.
™™ 
LogInfo
™™ 
(
™™ 
$"
™™ 
$str
™™ ;
{
™™; <
filePath
™™< D
}
™™D E
"
™™E F
)
™™F G
;
™™G H
return
´´ 
await
´´ 
Task
´´ 
.
´´ 
Run
´´ !
(
´´! "
(
´´" #
)
´´# $
=>
´´% '
{
¨¨ 
try
≠≠ 
{
ÆÆ 
if
ØØ 
(
ØØ 
!
ØØ 
File
ØØ 
.
ØØ 
Exists
ØØ $
(
ØØ$ %
filePath
ØØ% -
)
ØØ- .
)
ØØ. /
{
∞∞ 
throw
±± 
new
±± !#
FileNotFoundException
±±" 7
(
±±7 8
$"
±±8 :
$str
±±: N
{
±±N O
filePath
±±O W
}
±±W X
"
±±X Y
)
±±Y Z
;
±±Z [
}
≤≤ 
var
¥¥ 
config
¥¥ 
=
¥¥  
new
¥¥! $
CsvConfiguration
¥¥% 5
(
¥¥5 6
CultureInfo
¥¥6 A
.
¥¥A B
InvariantCulture
¥¥B R
)
¥¥R S
{
µµ 
HeaderValidated
∂∂ '
=
∂∂( )
null
∂∂* .
,
∂∂. /
MissingFieldFound
∑∑ )
=
∑∑* +
null
∑∑, 0
}
∏∏ 
;
∏∏ 
using
∫∫ 
var
∫∫ 
reader
∫∫ $
=
∫∫% &
new
∫∫' *
StreamReader
∫∫+ 7
(
∫∫7 8
filePath
∫∫8 @
)
∫∫@ A
;
∫∫A B
using
ªª 
var
ªª 
csv
ªª !
=
ªª" #
new
ªª$ '
	CsvReader
ªª( 1
(
ªª1 2
reader
ªª2 8
,
ªª8 9
config
ªª: @
)
ªª@ A
;
ªªA B
var
ΩΩ 
records
ΩΩ 
=
ΩΩ  !
csv
ΩΩ" %
.
ΩΩ% &

GetRecords
ΩΩ& 0
<
ΩΩ0 1!
Model_ReceivingLoad
ΩΩ1 D
>
ΩΩD E
(
ΩΩE F
)
ΩΩF G
;
ΩΩG H
var
ææ 
loads
ææ 
=
ææ 
new
ææ  #
List
ææ$ (
<
ææ( )!
Model_ReceivingLoad
ææ) <
>
ææ< =
(
ææ= >
records
ææ> E
)
ææE F
;
ææF G
_logger
¿¿ 
.
¿¿ 
LogInfo
¿¿ #
(
¿¿# $
$"
¿¿$ &
$str
¿¿& 8
{
¿¿8 9
loads
¿¿9 >
.
¿¿> ?
Count
¿¿? D
}
¿¿D E
$str
¿¿E S
{
¿¿S T
filePath
¿¿T \
}
¿¿\ ]
"
¿¿] ^
)
¿¿^ _
;
¿¿_ `
return
¡¡ 
loads
¡¡  
;
¡¡  !
}
¬¬ 
catch
√√ 
(
√√ 
	Exception
√√  
ex
√√! #
)
√√# $
{
ƒƒ 
_logger
≈≈ 
.
≈≈ 
LogError
≈≈ $
(
≈≈$ %
$"
≈≈% '
$str
≈≈' ?
{
≈≈? @
filePath
≈≈@ H
}
≈≈H I
$str
≈≈I K
{
≈≈K L
ex
≈≈L N
.
≈≈N O
Message
≈≈O V
}
≈≈V W
"
≈≈W X
)
≈≈X Y
;
≈≈Y Z
throw
∆∆ 
;
∆∆ 
}
«« 
}
»» 
)
»» 
;
»» 
}
…… 	
public
ÀÀ 
async
ÀÀ 
Task
ÀÀ 
<
ÀÀ 
CSVDeleteResult
ÀÀ )
>
ÀÀ) *!
DeleteCSVFilesAsync
ÀÀ+ >
(
ÀÀ> ?
)
ÀÀ? @
{
ÃÃ 	
var
ÕÕ 
result
ÕÕ 
=
ÕÕ 
new
ÕÕ 
CSVDeleteResult
ÕÕ ,
(
ÕÕ, -
)
ÕÕ- .
;
ÕÕ. /
if
–– 
(
–– 
File
–– 
.
–– 
Exists
–– 
(
–– 
_localCSVPath
–– )
)
––) *
)
––* +
{
—— 
try
““ 
{
”” 
await
‘‘ 
Task
‘‘ 
.
‘‘ 
Run
‘‘ "
(
‘‘" #
(
‘‘# $
)
‘‘$ %
=>
‘‘& (
File
‘‘) -
.
‘‘- .
Delete
‘‘. 4
(
‘‘4 5
_localCSVPath
‘‘5 B
)
‘‘B C
)
‘‘C D
;
‘‘D E
result
’’ 
.
’’ 
LocalDeleted
’’ '
=
’’( )
true
’’* .
;
’’. /
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊  
ex
◊◊! #
)
◊◊# $
{
ÿÿ 
result
ŸŸ 
.
ŸŸ 
LocalDeleted
ŸŸ '
=
ŸŸ( )
false
ŸŸ* /
;
ŸŸ/ 0
result
⁄⁄ 
.
⁄⁄ 

LocalError
⁄⁄ %
=
⁄⁄& '
ex
⁄⁄( *
.
⁄⁄* +
Message
⁄⁄+ 2
;
⁄⁄2 3
}
€€ 
}
‹‹ 
await
ﬂﬂ 
Task
ﬂﬂ 
.
ﬂﬂ 
Run
ﬂﬂ 
(
ﬂﬂ 
(
ﬂﬂ 
)
ﬂﬂ 
=>
ﬂﬂ  
{
‡‡ 
try
·· 
{
‚‚ 
var
„„ 
networkPath
„„ #
=
„„$ %'
GetNetworkCSVPathInternal
„„& ?
(
„„? @
)
„„@ A
;
„„A B
if
‰‰ 
(
‰‰ 
File
‰‰ 
.
‰‰ 
Exists
‰‰ #
(
‰‰# $
networkPath
‰‰$ /
)
‰‰/ 0
)
‰‰0 1
{
ÂÂ 
File
ÊÊ 
.
ÊÊ 
Delete
ÊÊ #
(
ÊÊ# $
networkPath
ÊÊ$ /
)
ÊÊ/ 0
;
ÊÊ0 1
result
ÁÁ 
.
ÁÁ 
NetworkDeleted
ÁÁ -
=
ÁÁ. /
true
ÁÁ0 4
;
ÁÁ4 5
}
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
result
ÏÏ 
.
ÏÏ 
NetworkDeleted
ÏÏ )
=
ÏÏ* +
false
ÏÏ, 1
;
ÏÏ1 2
result
ÌÌ 
.
ÌÌ 
NetworkError
ÌÌ '
=
ÌÌ( )
ex
ÌÌ* ,
.
ÌÌ, -
Message
ÌÌ- 4
;
ÌÌ4 5
}
ÓÓ 
}
ÔÔ 
)
ÔÔ 
;
ÔÔ 
return
ÒÒ 
result
ÒÒ 
;
ÒÒ 
}
ÚÚ 	
public
ÙÙ 
async
ÙÙ 
Task
ÙÙ 
<
ÙÙ  
CSVExistenceResult
ÙÙ ,
>
ÙÙ, -%
CheckCSVFilesExistAsync
ÙÙ. E
(
ÙÙE F
)
ÙÙF G
{
ıı 	
var
ˆˆ 
result
ˆˆ 
=
ˆˆ 
new
ˆˆ  
CSVExistenceResult
ˆˆ /
(
ˆˆ/ 0
)
ˆˆ0 1
;
ˆˆ1 2
await
¯¯ 
Task
¯¯ 
.
¯¯ 
Run
¯¯ 
(
¯¯ 
(
¯¯ 
)
¯¯ 
=>
¯¯  
{
˘˘ 
result
˙˙ 
.
˙˙ 
LocalExists
˙˙ "
=
˙˙# $
File
˙˙% )
.
˙˙) *
Exists
˙˙* 0
(
˙˙0 1
_localCSVPath
˙˙1 >
)
˙˙> ?
;
˙˙? @
try
¸¸ 
{
˝˝ 
var
˛˛ 
networkPath
˛˛ #
=
˛˛$ %'
GetNetworkCSVPathInternal
˛˛& ?
(
˛˛? @
)
˛˛@ A
;
˛˛A B
result
ˇˇ 
.
ˇˇ 
NetworkExists
ˇˇ (
=
ˇˇ) *
File
ˇˇ+ /
.
ˇˇ/ 0
Exists
ˇˇ0 6
(
ˇˇ6 7
networkPath
ˇˇ7 B
)
ˇˇB C
;
ˇˇC D
result
ÄÄ 
.
ÄÄ 
NetworkAccessible
ÄÄ ,
=
ÄÄ- .
true
ÄÄ/ 3
;
ÄÄ3 4
}
ÅÅ 
catch
ÇÇ 
{
ÉÉ 
result
ÑÑ 
.
ÑÑ 
NetworkExists
ÑÑ (
=
ÑÑ) *
false
ÑÑ+ 0
;
ÑÑ0 1
result
ÖÖ 
.
ÖÖ 
NetworkAccessible
ÖÖ ,
=
ÖÖ- .
false
ÖÖ/ 4
;
ÖÖ4 5
}
ÜÜ 
}
áá 
)
áá 
;
áá 
return
ââ 
result
ââ 
;
ââ 
}
ää 	
public
åå 
string
åå 
GetLocalCSVPath
åå %
(
åå% &
)
åå& '
=>
åå( *
_localCSVPath
åå+ 8
;
åå8 9
public
éé 
string
éé 
GetNetworkCSVPath
éé '
(
éé' (
)
éé( )
=>
éé* ,'
GetNetworkCSVPathInternal
éé- F
(
ééF G
)
ééG H
;
ééH I
}
èè 
}êê ßI
bC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Database\Service_UserPreferences.cs
	namespace

 	%
MTM_Receiving_Application


 #
.

# $
Services

$ ,
.

, -
Database

- 5
;

5 6
public 
class #
Service_UserPreferences $
:% &$
IService_UserPreferences' ?
{ 
private 
readonly 
Dao_User 
_userDao &
;& '
private 
readonly #
IService_LoggingUtility ,
_logger- 4
;4 5
private 
readonly !
IService_ErrorHandler *
_errorHandler+ 8
;8 9
public 
#
Service_UserPreferences "
(" #
Dao_User 
userDao 
, #
IService_LoggingUtility 
logger  &
,& '!
IService_ErrorHandler 
errorHandler *
)* +
{ 
_userDao 
= 
userDao 
; 
_logger 
= 
logger 
; 
_errorHandler 
= 
errorHandler $
;$ %
} 
public 

async 
Task 
< 
Model_Dao_Result &
<& ' 
Model_UserPreference' ;
>; <
>< =(
GetLatestUserPreferenceAsync> Z
(Z [
string[ a
usernameb j
)j k
{ 
try 
{ 	
var!! 
normalizedUsername!! "
=!!# $
username!!% -
?!!- .
.!!. /
Trim!!/ 3
(!!3 4
)!!4 5
;!!5 6
if"" 
("" 
string"" 
."" 
IsNullOrWhiteSpace"" )
("") *
normalizedUsername""* <
)""< =
)""= >
{## 
return$$ $
Model_Dao_Result_Factory$$ /
.$$/ 0
Failure$$0 7
<$$7 8 
Model_UserPreference$$8 L
>$$L M
($$M N
$str%% .
)%%. /
;%%/ 0
}&& 
var)) 

userResult)) 
=)) 
await)) "
_userDao))# +
.))+ ,)
GetUserByWindowsUsernameAsync)), I
())I J
normalizedUsername))J \
)))\ ]
;))] ^
if++ 
(++ 
!++ 

userResult++ 
.++ 
	IsSuccess++ %
)++% &
{,, 
_logger-- 
.-- 
LogError--  
(--  !
$".. 
$str.. -
{..- .
normalizedUsername... @
}..@ A
$str..A C
{..C D

userResult..D N
...N O
ErrorMessage..O [
}..[ \
"..\ ]
,..] ^
null.._ c
,..c d
$str..e v
)..v w
;..w x
return// $
Model_Dao_Result_Factory// /
./// 0
Failure//0 7
<//7 8 
Model_UserPreference//8 L
>//L M
(//M N

userResult//N X
.//X Y
ErrorMessage//Y e
)//e f
;//f g
}00 
if22 
(22 

userResult22 
.22 
Data22 
==22  "
null22# '
)22' (
{33 
return44 $
Model_Dao_Result_Factory44 /
.44/ 0
Failure440 7
<447 8 
Model_UserPreference448 L
>44L M
(44M N
$str44N ^
)44^ _
;44_ `
}55 
var77 

preference77 
=77 
new77   
Model_UserPreference77! 5
{88 
Username99 
=99 

userResult99 %
.99% &
Data99& *
.99* +
WindowsUsername99+ :
,99: ; 
PreferredPackageType:: $
=::% &

userResult::' 1
.::1 2
Data::2 6
.::6 7 
DefaultReceivingMode::7 K
??::L N
$str::O X
,::X Y
LastUpdated;; 
=;; 
DateTime;; &
.;;& '
Now;;' *
}<< 
;<< 
_logger?? 
.?? 
LogInfo?? 
(?? 
$"@@ 
$str@@ 0
{@@0 1
normalizedUsername@@1 C
}@@C D
"@@D E
,@@E F
$str@@G X
)@@X Y
;@@Y Z
returnBB $
Model_Dao_Result_FactoryBB +
.BB+ ,
SuccessBB, 3
(BB3 4

preferenceBB4 >
)BB> ?
;BB? @
}CC 	
catchDD 
(DD 
	ExceptionDD 
exDD 
)DD 
{EE 	
awaitFF 
_errorHandlerFF 
.FF  
HandleErrorAsyncFF  0
(FF0 1
$"GG 
$strGG 
{GG 
nameofGG "
(GG" #(
GetLatestUserPreferenceAsyncGG# ?
)GG? @
}GG@ A
$strGGA C
{GGC D
exGGD F
.GGF G
MessageGGG N
}GGN O
"GGO P
,GGP Q
Enum_ErrorSeverityHH "
.HH" #
CriticalHH# +
,HH+ ,
exII 
)II 
;II 
returnKK $
Model_Dao_Result_FactoryKK +
.KK+ ,
FailureKK, 3
<KK3 4 
Model_UserPreferenceKK4 H
>KKH I
(KKI J
$strLL F
,LLF G
exLLH J
)LLJ K
;LLK L
}MM 	
}NN 
publicPP 

asyncPP 
TaskPP 
<PP 
Model_Dao_ResultPP &
>PP& '"
UpdateDefaultModeAsyncPP( >
(PP> ?
stringPP? E
usernamePPF N
,PPN O
stringPPP V
defaultModePPW b
)PPb c
{QQ 
tryRR 
{SS 	
varUU 
normalizedUsernameUU "
=UU# $
usernameUU% -
?UU- .
.UU. /
TrimUU/ 3
(UU3 4
)UU4 5
;UU5 6
ifVV 
(VV 
stringVV 
.VV 
IsNullOrWhiteSpaceVV )
(VV) *
normalizedUsernameVV* <
)VV< =
)VV= >
{WW 
returnXX $
Model_Dao_Result_FactoryXX /
.XX/ 0
FailureXX0 7
(XX7 8
$strXX8 R
)XXR S
;XXS T
}YY 
if[[ 
([[ 
defaultMode[[ 
!=[[ 
$str[[ (
&&[[) +
defaultMode[[, 7
!=[[8 :
$str[[; C
)[[C D
{\\ 
return]] $
Model_Dao_Result_Factory]] /
.]]/ 0
Failure]]0 7
(]]7 8
$"^^ 
$str^^ ,
{^^, -
defaultMode^^- 8
}^^8 9
$str^^9 Z
"^^Z [
)^^[ \
;^^\ ]
}__ 
varbb 

userResultbb 
=bb 
awaitbb "
_userDaobb# +
.bb+ ,)
GetUserByWindowsUsernameAsyncbb, I
(bbI J
normalizedUsernamebbJ \
)bb\ ]
;bb] ^
ifcc 
(cc 
!cc 

userResultcc 
.cc 
	IsSuccesscc %
||cc& (

userResultcc) 3
.cc3 4
Datacc4 8
==cc9 ;
nullcc< @
)cc@ A
{dd 
returnee $
Model_Dao_Result_Factoryee /
.ee/ 0
Failureee0 7
(ee7 8
$"ee8 :
$stree: @
{ee@ A
normalizedUsernameeeA S
}eeS T
$streeT `
"ee` a
)eea b
;eeb c
}ff 
varii 
resultii 
=ii 
awaitii 
_userDaoii '
.ii' ("
UpdateDefaultModeAsyncii( >
(ii> ?

userResultii? I
.iiI J
DataiiJ N
.iiN O
EmployeeNumberiiO ]
,ii] ^
defaultModeii_ j
)iij k
;iik l
ifll 
(ll 
resultll 
.ll 
	IsSuccessll  
)ll  !
{mm 
_loggernn 
.nn 
LogInfonn 
(nn  
$"oo 
$stroo -
{oo- .
normalizedUsernameoo. @
}oo@ A
$strooA C
{ooC D
defaultModeooD O
}ooO P
"ooP Q
,ooQ R
$strooS d
)ood e
;ooe f
}pp 
returnrr 
resultrr 
;rr 
}ss 	
catchtt 
(tt 
	Exceptiontt 
extt 
)tt 
{uu 	
awaitvv 
_errorHandlervv 
.vv  
HandleErrorAsyncvv  0
(vv0 1
$"ww 
$strww 
{ww 
nameofww "
(ww" #"
UpdateDefaultModeAsyncww# 9
)ww9 :
}ww: ;
$strww; =
{ww= >
exww> @
.ww@ A
MessagewwA H
}wwH I
"wwI J
,wwJ K
Enum_ErrorSeverityxx "
.xx" #
Criticalxx# +
,xx+ ,
exyy 
)yy 
;yy 
return{{ $
Model_Dao_Result_Factory{{ +
.{{+ ,
Failure{{, 3
({{3 4
$str{{4 b
,{{b c
ex{{d f
){{f g
;{{g h
}|| 	
}}} 
}~~ ¡\
bC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Database\Service_MySQL_Receiving.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Services		$ ,
.		, -
Database		- 5
{

 
public 

class #
Service_MySQL_Receiving (
:) *$
IService_MySQL_Receiving+ C
{ 
private 
readonly 
Dao_ReceivingLoad *
_receivingLoadDao+ <
;< =
private 
readonly #
IService_LoggingUtility 0
_logger1 8
;8 9
public #
Service_MySQL_Receiving &
(& '
Dao_ReceivingLoad 
receivingLoadDao .
,. /#
IService_LoggingUtility #
logger$ *
)* +
{ 	
_receivingLoadDao 
= 
receivingLoadDao  0
;0 1
_logger 
= 
logger 
?? 
throw  %
new& )!
ArgumentNullException* ?
(? @
nameof@ F
(F G
loggerG M
)M N
)N O
;O P
} 	
public #
Service_MySQL_Receiving &
(& '
string' -
connectionString. >
,> ?#
IService_LoggingUtility@ W
loggerX ^
)^ _
{ 	
_receivingLoadDao 
= 
new  #
Dao_ReceivingLoad$ 5
(5 6
connectionString6 F
)F G
;G H
_logger 
= 
logger 
?? 
throw  %
new& )!
ArgumentNullException* ?
(? @
nameof@ F
(F G
loggerG M
)M N
)N O
;O P
}   	
public"" 
async"" 
Task"" 
<"" 
int"" 
>"" #
SaveReceivingLoadsAsync"" 6
(""6 7
List""7 ;
<""; <
Model_ReceivingLoad""< O
>""O P
loads""Q V
)""V W
{## 	
if$$ 
($$ 
loads$$ 
==$$ 
null$$ 
)$$ 
return%% 
$num%% 
;%% 
_logger'' 
.'' 
LogInfo'' 
('' 
$"'' 
$str'' %
{''% &
loads''& +
.''+ ,
Count'', 1
}''1 2
$str''2 E
"''E F
)''F G
;''G H
var)) 
result)) 
=)) 
await)) 
_receivingLoadDao)) 0
.))0 1
SaveLoadsAsync))1 ?
())? @
loads))@ E
)))E F
;))F G
if++ 
(++ 
result++ 
.++ 
	IsSuccess++  
)++  !
{,, 
_logger-- 
.-- 
LogInfo-- 
(--  
$"--  "
$str--" 5
{--5 6
result--6 <
.--< =
Data--= A
}--A B
$str--B I
"--I J
)--J K
;--K L
return.. 
result.. 
... 
Data.. "
;.." #
}// 
else00 
{11 
_logger22 
.22 
LogError22  
(22  !
$"22! #
$str22# 9
{229 :
result22: @
.22@ A
ErrorMessage22A M
}22M N
"22N O
,22O P
result22Q W
.22W X
	Exception22X a
)22a b
;22b c
throw33 
new33 %
InvalidOperationException33 3
(333 4
result334 :
.33: ;
ErrorMessage33; G
,33G H
result33I O
.33O P
	Exception33P Y
)33Y Z
;33Z [
}44 
}55 	
public77 
async77 
Task77 
<77 
int77 
>77 %
UpdateReceivingLoadsAsync77 8
(778 9
List779 =
<77= >
Model_ReceivingLoad77> Q
>77Q R
loads77S X
)77X Y
{88 	
if99 
(99 
loads99 
==99 
null99 
)99 
return:: 
$num:: 
;:: 
_logger<< 
.<< 
LogInfo<< 
(<< 
$"<< 
$str<< '
{<<' (
loads<<( -
.<<- .
Count<<. 3
}<<3 4
$str<<4 G
"<<G H
)<<H I
;<<I J
var>> 
result>> 
=>> 
await>> 
_receivingLoadDao>> 0
.>>0 1
UpdateLoadsAsync>>1 A
(>>A B
loads>>B G
)>>G H
;>>H I
if@@ 
(@@ 
result@@ 
.@@ 
	IsSuccess@@  
)@@  !
{AA 
_loggerBB 
.BB 
LogInfoBB 
(BB  
$"BB  "
$strBB" 7
{BB7 8
resultBB8 >
.BB> ?
DataBB? C
}BBC D
$strBBD K
"BBK L
)BBL M
;BBM N
returnCC 
resultCC 
.CC 
DataCC "
;CC" #
}DD 
elseEE 
{FF 
_loggerGG 
.GG 
LogErrorGG  
(GG  !
$"GG! #
$strGG# ;
{GG; <
resultGG< B
.GGB C
ErrorMessageGGC O
}GGO P
"GGP Q
,GGQ R
resultGGS Y
.GGY Z
	ExceptionGGZ c
)GGc d
;GGd e
throwHH 
newHH %
InvalidOperationExceptionHH 3
(HH3 4
resultHH4 :
.HH: ;
ErrorMessageHH; G
,HHG H
resultHHI O
.HHO P
	ExceptionHHP Y
)HHY Z
;HHZ [
}II 
}JJ 	
publicLL 
asyncLL 
TaskLL 
<LL 
intLL 
>LL %
DeleteReceivingLoadsAsyncLL 8
(LL8 9
ListLL9 =
<LL= >
Model_ReceivingLoadLL> Q
>LLQ R
loadsLLS X
)LLX Y
{MM 	
ifNN 
(NN 
loadsNN 
==NN 
nullNN 
)NN 
returnOO 
$numOO 
;OO 
_loggerQQ 
.QQ 
LogInfoQQ 
(QQ 
$"QQ 
$strQQ '
{QQ' (
loadsQQ( -
.QQ- .
CountQQ. 3
}QQ3 4
$strQQ4 I
"QQI J
)QQJ K
;QQK L
varSS 
resultSS 
=SS 
awaitSS 
_receivingLoadDaoSS 0
.SS0 1
DeleteLoadsAsyncSS1 A
(SSA B
loadsSSB G
)SSG H
;SSH I
ifUU 
(UU 
resultUU 
.UU 
	IsSuccessUU  
)UU  !
{VV 
_loggerWW 
.WW 
LogInfoWW 
(WW  
$"WW  "
$strWW" 7
{WW7 8
resultWW8 >
.WW> ?
DataWW? C
}WWC D
$strWWD K
"WWK L
)WWL M
;WWM N
returnXX 
resultXX 
.XX 
DataXX "
;XX" #
}YY 
elseZZ 
{[[ 
_logger\\ 
.\\ 
LogError\\  
(\\  !
$"\\! #
$str\\# ;
{\\; <
result\\< B
.\\B C
ErrorMessage\\C O
}\\O P
"\\P Q
,\\Q R
result\\S Y
.\\Y Z
	Exception\\Z c
)\\c d
;\\d e
throw]] 
new]] %
InvalidOperationException]] 3
(]]3 4
result]]4 :
.]]: ;
ErrorMessage]]; G
,]]G H
result]]I O
.]]O P
	Exception]]P Y
)]]Y Z
;]]Z [
}^^ 
}__ 	
publicaa 
asyncaa 
Taskaa 
<aa 
Listaa 
<aa 
Model_ReceivingLoadaa 2
>aa2 3
>aa3 4$
GetReceivingHistoryAsyncaa5 M
(aaM N
stringaaN T
partIDaaU [
,aa[ \
DateTimeaa] e
	startDateaaf o
,aao p
DateTimeaaq y
endDate	aaz Å
)
aaÅ Ç
{bb 	
varcc 
resultcc 
=cc 
awaitcc 
_receivingLoadDaocc 0
.cc0 1
GetHistoryAsynccc1 @
(cc@ A
partIDccA G
,ccG H
	startDateccI R
,ccR S
endDateccT [
)cc[ \
;cc\ ]
ifee 
(ee 
resultee 
.ee 
	IsSuccessee  
)ee  !
{ff 
returngg 
resultgg 
.gg 
Datagg "
??gg# %
newgg& )
Listgg* .
<gg. /
Model_ReceivingLoadgg/ B
>ggB C
(ggC D
)ggD E
;ggE F
}hh 
elseii 
{jj 
_loggerkk 
.kk 
LogErrorkk  
(kk  !
$"kk! #
$strkk# D
{kkD E
resultkkE K
.kkK L
ErrorMessagekkL X
}kkX Y
"kkY Z
,kkZ [
resultkk\ b
.kkb c
	Exceptionkkc l
)kkl m
;kkm n
returnoo 
newoo 
Listoo 
<oo  
Model_ReceivingLoadoo  3
>oo3 4
(oo4 5
)oo5 6
;oo6 7
}pp 
}qq 	
publicss 
asyncss 
Taskss 
<ss 
Model_Dao_Resultss *
<ss* +
Listss+ /
<ss/ 0
Model_ReceivingLoadss0 C
>ssC D
>ssD E
>ssE F%
GetAllReceivingLoadsAsyncssG `
(ss` a
DateTimessa i
	startDatessj s
,sss t
DateTimessu }
endDate	ss~ Ö
)
ssÖ Ü
{tt 	
_loggeruu 
.uu 
LogInfouu 
(uu 
$"uu 
$struu B
{uuB C
	startDateuuC L
:uuL M
$struuM W
}uuW X
$struuX \
{uu\ ]
endDateuu] d
:uud e
$struue o
}uuo p
"uup q
)uuq r
;uur s
varww 
resultww 
=ww 
awaitww 
_receivingLoadDaoww 0
.ww0 1
GetAllAsyncww1 <
(ww< =
	startDateww= F
,wwF G
endDatewwH O
)wwO P
;wwP Q
ifyy 
(yy 
resultyy 
.yy 
	IsSuccessyy  
)yy  !
{zz 
_logger{{ 
.{{ 
LogInfo{{ 
({{  
$"{{  "
$str{{" ,
{{{, -
result{{- 3
.{{3 4
Data{{4 8
?{{8 9
.{{9 :
Count{{: ?
??{{@ B
$num{{C D
}{{D E
$str{{E c
"{{c d
){{d e
;{{e f
return|| 
result|| 
;|| 
}}} 
else~~ 
{ 
_logger
ÄÄ 
.
ÄÄ 
LogError
ÄÄ  
(
ÄÄ  !
$"
ÄÄ! #
$str
ÄÄ# G
{
ÄÄG H
result
ÄÄH N
.
ÄÄN O
ErrorMessage
ÄÄO [
}
ÄÄ[ \
"
ÄÄ\ ]
,
ÄÄ] ^
result
ÄÄ_ e
.
ÄÄe f
	Exception
ÄÄf o
)
ÄÄo p
;
ÄÄp q
return
ÅÅ 
result
ÅÅ 
;
ÅÅ 
}
ÇÇ 
}
ÉÉ 	
public
ÖÖ 
async
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
bool
ÖÖ 
>
ÖÖ !
TestConnectionAsync
ÖÖ  3
(
ÖÖ3 4
)
ÖÖ4 5
{
ÜÜ 	
return
ëë 
true
ëë 
;
ëë 
}
íí 	
}
ìì 
}îî µ"
kC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Database\Service_MySQL_PackagePreferences.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
., -
Database- 5
{ 
public 

class ,
 Service_MySQL_PackagePreferences 1
:2 3-
!IService_MySQL_PackagePreferences4 U
{ 
private 
readonly %
Dao_PackageTypePreference 2
_dao3 7
;7 8
public ,
 Service_MySQL_PackagePreferences /
(/ 0%
Dao_PackageTypePreference0 I
daoJ M
)M N
{ 	
_dao 
= 
dao 
?? 
throw 
new  #!
ArgumentNullException$ 9
(9 :
nameof: @
(@ A
daoA D
)D E
)E F
;F G
} 	
public ,
 Service_MySQL_PackagePreferences /
(/ 0
string0 6
connectionString7 G
)G H
{ 	
_dao 
= 
new %
Dao_PackageTypePreference 0
(0 1
connectionString1 A
)A B
;B C
} 	
public 
async 
Task 
< '
Model_PackageTypePreference 5
?5 6
>6 7
GetPreferenceAsync8 J
(J K
stringK Q
partIDR X
)X Y
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
partID* 0
)0 1
)1 2
throw 
new 
ArgumentException +
(+ ,
$str, M
,M N
nameofO U
(U V
partIDV \
)\ ]
)] ^
;^ _
var   
result   
=   
await   
_dao   #
.  # $
GetPreferenceAsync  $ 6
(  6 7
partID  7 =
)  = >
;  > ?
if"" 
("" 
result"" 
."" 
	IsSuccess""  
)""  !
{## 
return$$ 
result$$ 
.$$ 
Data$$ "
;$$" #
}%% 
return'' 
null'' 
;'' 
}(( 	
public** 
async** 
Task** 
SavePreferenceAsync** -
(**- .'
Model_PackageTypePreference**. I

preference**J T
)**T U
{++ 	
if,, 
(,, 

preference,, 
==,, 
null,, "
),," #
throw-- 
new-- !
ArgumentNullException-- /
(--/ 0
nameof--0 6
(--6 7

preference--7 A
)--A B
)--B C
;--C D
var// 
result// 
=// 
await// 
_dao// #
.//# $
SavePreferenceAsync//$ 7
(//7 8

preference//8 B
)//B C
;//C D
if11 
(11 
!11 
result11 
.11 
	IsSuccess11 !
)11! "
{22 
throw33 
new33 
	Exception33 #
(33# $
result33$ *
.33* +
ErrorMessage33+ 7
)337 8
;338 9
}44 
}55 	
public77 
async77 
Task77 
<77 
bool77 
>77 !
DeletePreferenceAsync77  5
(775 6
string776 <
partID77= C
)77C D
{88 	
if99 
(99 
string99 
.99 
IsNullOrWhiteSpace99 )
(99) *
partID99* 0
)990 1
)991 2
throw:: 
new:: 
ArgumentException:: +
(::+ ,
$str::, M
,::M N
nameof::O U
(::U V
partID::V \
)::\ ]
)::] ^
;::^ _
var<< 
result<< 
=<< 
await<< 
_dao<< #
.<<# $!
DeletePreferenceAsync<<$ 9
(<<9 :
partID<<: @
)<<@ A
;<<A B
return>> 
result>> 
.>> 
	IsSuccess>> #
;>># $
}?? 	
}@@ 
}AA Õæ
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Database\Service_MySQL_Dunnage.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
., -
Database- 5
{ 
public 

class !
Service_MySQL_Dunnage &
:' ("
IService_MySQL_Dunnage) ?
{ 
private 
readonly !
IService_ErrorHandler .
_errorHandler/ <
;< =
private 
readonly #
IService_LoggingUtility 0
_logger1 8
;8 9
private 
readonly '
IService_UserSessionManager 4
_sessionManager5 D
;D E
private 
readonly 
Dao_DunnageLoad (
_daoDunnageLoad) 8
;8 9
private 
readonly 
Dao_DunnageType (
_daoDunnageType) 8
;8 9
private 
readonly 
Dao_DunnagePart (
_daoDunnagePart) 8
;8 9
private 
readonly 
Dao_DunnageSpec (
_daoDunnageSpec) 8
;8 9
private 
readonly "
Dao_InventoriedDunnage /"
_daoInventoriedDunnage0 F
;F G
private 
string 
CurrentUser "
=># %
_sessionManager& 5
.5 6
CurrentSession6 D
?D E
.E F
UserF J
.J K
WindowsUsernameK Z
??[ ]
$str^ f
;f g
public !
Service_MySQL_Dunnage $
($ %!
IService_ErrorHandler !
errorHandler" .
,. /#
IService_LoggingUtility #
logger$ *
,* +'
IService_UserSessionManager '
sessionManager( 6
,6 7
Dao_DunnageLoad 
daoDunnageLoad *
,* +
Dao_DunnageType 
daoDunnageType *
,* +
Dao_DunnagePart   
daoDunnagePart   *
,  * +
Dao_DunnageSpec!! 
daoDunnageSpec!! *
,!!* +"
Dao_InventoriedDunnage"" "!
daoInventoriedDunnage""# 8
)""8 9
{## 	
_errorHandler$$ 
=$$ 
errorHandler$$ (
;$$( )
_logger%% 
=%% 
logger%% 
;%% 
_sessionManager&& 
=&& 
sessionManager&& ,
;&&, -
_daoDunnageLoad'' 
='' 
daoDunnageLoad'' ,
;'', -
_daoDunnageType(( 
=(( 
daoDunnageType(( ,
;((, -
_daoDunnagePart)) 
=)) 
daoDunnagePart)) ,
;)), -
_daoDunnageSpec** 
=** 
daoDunnageSpec** ,
;**, -"
_daoInventoriedDunnage++ "
=++# $!
daoInventoriedDunnage++% :
;++: ;
},, 	
public00 
async00 
Task00 
<00 
Model_Dao_Result00 *
<00* +
List00+ /
<00/ 0
Model_DunnageType000 A
>00A B
>00B C
>00C D
GetAllTypesAsync00E U
(00U V
)00V W
{11 	
try22 
{33 
return44 
await44 
_daoDunnageType44 ,
.44, -
GetAllAsync44- 8
(448 9
)449 :
;44: ;
}55 
catch66 
(66 
	Exception66 
ex66 
)66  
{77 
HandleException88 
(88  
ex88  "
,88" #
Enum_ErrorSeverity88$ 6
.886 7
Error887 <
,88< =
nameof88> D
(88D E
GetAllTypesAsync88E U
)88U V
,88V W
nameof88X ^
(88^ _!
Service_MySQL_Dunnage88_ t
)88t u
)88u v
;88v w
return99 $
Model_Dao_Result_Factory99 /
.99/ 0
Failure990 7
<997 8
List998 <
<99< =
Model_DunnageType99= N
>99N O
>99O P
(99P Q
$"99Q S
$str99S s
{99s t
ex99t v
.99v w
Message99w ~
}99~ 
"	99 Ä
)
99Ä Å
;
99Å Ç
}:: 
};; 	
public== 
async== 
Task== 
<== 
Model_Dao_Result== *
<==* +
Model_DunnageType==+ <
>==< =
>=== >
GetTypeByIdAsync==? O
(==O P
int==P S
typeId==T Z
)==Z [
{>> 	
try?? 
{@@ 
returnAA 
awaitAA 
_daoDunnageTypeAA ,
.AA, -
GetByIdAsyncAA- 9
(AA9 :
typeIdAA: @
)AA@ A
;AAA B
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
HandleExceptionEE 
(EE  
exEE  "
,EE" #
Enum_ErrorSeverityEE$ 6
.EE6 7
ErrorEE7 <
,EE< =
nameofEE> D
(EED E
GetTypeByIdAsyncEEE U
)EEU V
,EEV W
nameofEEX ^
(EE^ _!
Service_MySQL_DunnageEE_ t
)EEt u
)EEu v
;EEv w
returnFF $
Model_Dao_Result_FactoryFF /
.FF/ 0
FailureFF0 7
<FF7 8
Model_DunnageTypeFF8 I
>FFI J
(FFJ K
$"FFK M
$strFFM l
{FFl m
exFFm o
.FFo p
MessageFFp w
}FFw x
"FFx y
)FFy z
;FFz {
}GG 
}HH 	
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
Model_Dao_ResultJJ *
>JJ* +
InsertTypeAsyncJJ, ;
(JJ; <
Model_DunnageTypeJJ< M
typeJJN R
)JJR S
{KK 	
tryLL 
{MM 
varNN 
resultNN 
=NN 
awaitNN "
_daoDunnageTypeNN# 2
.NN2 3
InsertAsyncNN3 >
(NN> ?
typeNN? C
.NNC D
TypeNameNND L
,NNL M
CurrentUserNNN Y
)NNY Z
;NNZ [
ifOO 
(OO 
resultOO 
.OO 
	IsSuccessOO $
)OO$ %
{PP 
typeQQ 
.QQ 
IdQQ 
=QQ 
resultQQ $
.QQ$ %
DataQQ% )
;QQ) *
returnRR $
Model_Dao_Result_FactoryRR 3
.RR3 4
SuccessRR4 ;
(RR; <
)RR< =
;RR= >
}SS 
returnTT $
Model_Dao_Result_FactoryTT /
.TT/ 0
FailureTT0 7
(TT7 8
resultTT8 >
.TT> ?
ErrorMessageTT? K
)TTK L
;TTL M
}UU 
catchVV 
(VV 
	ExceptionVV 
exVV 
)VV  
{WW 
HandleExceptionXX 
(XX  
exXX  "
,XX" #
Enum_ErrorSeverityXX$ 6
.XX6 7
ErrorXX7 <
,XX< =
nameofXX> D
(XXD E
InsertTypeAsyncXXE T
)XXT U
,XXU V
nameofXXW ]
(XX] ^!
Service_MySQL_DunnageXX^ s
)XXs t
)XXt u
;XXu v
returnYY $
Model_Dao_Result_FactoryYY /
.YY/ 0
FailureYY0 7
(YY7 8
$"YY8 :
$strYY: X
{YYX Y
exYYY [
.YY[ \
MessageYY\ c
}YYc d
"YYd e
)YYe f
;YYf g
}ZZ 
}[[ 	
public]] 
async]] 
Task]] 
<]] 
Model_Dao_Result]] *
>]]* +
UpdateTypeAsync]], ;
(]]; <
Model_DunnageType]]< M
type]]N R
)]]R S
{^^ 	
try__ 
{`` 
returnaa 
awaitaa 
_daoDunnageTypeaa ,
.aa, -
UpdateAsyncaa- 8
(aa8 9
typeaa9 =
.aa= >
Idaa> @
,aa@ A
typeaaB F
.aaF G
TypeNameaaG O
,aaO P
CurrentUseraaQ \
)aa\ ]
;aa] ^
}bb 
catchcc 
(cc 
	Exceptioncc 
excc 
)cc  
{dd 
HandleExceptionee 
(ee  
exee  "
,ee" #
Enum_ErrorSeverityee$ 6
.ee6 7
Erroree7 <
,ee< =
nameofee> D
(eeD E
UpdateTypeAsynceeE T
)eeT U
,eeU V
nameofeeW ]
(ee] ^!
Service_MySQL_Dunnageee^ s
)ees t
)eet u
;eeu v
returnff $
Model_Dao_Result_Factoryff /
.ff/ 0
Failureff0 7
(ff7 8
$"ff8 :
$strff: W
{ffW X
exffX Z
.ffZ [
Messageff[ b
}ffb c
"ffc d
)ffd e
;ffe f
}gg 
}hh 	
publicjj 
asyncjj 
Taskjj 
<jj 
Model_Dao_Resultjj *
>jj* +
DeleteTypeAsyncjj, ;
(jj; <
intjj< ?
typeIdjj@ F
)jjF G
{kk 	
tryll 
{mm 
varoo 
partsResultoo 
=oo  !
awaitoo" '
_daoDunnagePartoo( 7
.oo7 8
GetByTypeAsyncoo8 F
(ooF G
typeIdooG M
)ooM N
;ooN O
ifpp 
(pp 
partsResultpp 
.pp  
	IsSuccesspp  )
&&pp* ,
partsResultpp- 8
.pp8 9
Datapp9 =
?pp= >
.pp> ?
Countpp? D
>ppE F
$numppG H
)ppH I
{qq 
returnrr $
Model_Dao_Result_Factoryrr 3
.rr3 4
Failurerr4 ;
(rr; <
$"rr< >
$strrr> `
{rr` a
partsResultrra l
.rrl m
Datarrm q
.rrq r
Countrrr w
}rrw x
$strrrx 
"	rr Ä
)
rrÄ Å
;
rrÅ Ç
}ss 
varvv 
specsResultvv 
=vv  !
awaitvv" '
_daoDunnageSpecvv( 7
.vv7 8
GetByTypeAsyncvv8 F
(vvF G
typeIdvvG M
)vvM N
;vvN O
ifww 
(ww 
specsResultww 
.ww  
	IsSuccessww  )
&&ww* ,
specsResultww- 8
.ww8 9
Dataww9 =
?ww= >
.ww> ?
Countww? D
>wwE F
$numwwG H
)wwH I
{xx 
returnyy $
Model_Dao_Result_Factoryyy 3
.yy3 4
Failureyy4 ;
(yy; <
$"yy< >
$stryy> Y
{yyY Z
specsResultyyZ e
.yye f
Datayyf j
.yyj k
Countyyk p
}yyp q
$str	yyq £
"
yy£ §
)
yy§ •
;
yy• ¶
}zz 
return|| 
await|| 
_daoDunnageType|| ,
.||, -
DeleteAsync||- 8
(||8 9
typeId||9 ?
)||? @
;||@ A
}}} 
catch~~ 
(~~ 
	Exception~~ 
ex~~ 
)~~  
{ 
HandleException
ÄÄ 
(
ÄÄ  
ex
ÄÄ  "
,
ÄÄ" # 
Enum_ErrorSeverity
ÄÄ$ 6
.
ÄÄ6 7
Error
ÄÄ7 <
,
ÄÄ< =
nameof
ÄÄ> D
(
ÄÄD E
DeleteTypeAsync
ÄÄE T
)
ÄÄT U
,
ÄÄU V
nameof
ÄÄW ]
(
ÄÄ] ^#
Service_MySQL_Dunnage
ÄÄ^ s
)
ÄÄs t
)
ÄÄt u
;
ÄÄu v
return
ÅÅ &
Model_Dao_Result_Factory
ÅÅ /
.
ÅÅ/ 0
Failure
ÅÅ0 7
(
ÅÅ7 8
$"
ÅÅ8 :
$str
ÅÅ: W
{
ÅÅW X
ex
ÅÅX Z
.
ÅÅZ [
Message
ÅÅ[ b
}
ÅÅb c
"
ÅÅc d
)
ÅÅd e
;
ÅÅe f
}
ÇÇ 
}
ÉÉ 	
public
áá 
async
áá 
Task
áá 
<
áá 
Model_Dao_Result
áá *
<
áá* +
List
áá+ /
<
áá/ 0
Model_DunnageSpec
áá0 A
>
ááA B
>
ááB C
>
ááC D"
GetSpecsForTypeAsync
ááE Y
(
ááY Z
int
ááZ ]
typeId
áá^ d
)
áád e
{
àà 	
try
ââ 
{
ää 
return
ãã 
await
ãã 
_daoDunnageSpec
ãã ,
.
ãã, -
GetByTypeAsync
ãã- ;
(
ãã; <
typeId
ãã< B
)
ããB C
;
ããC D
}
åå 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
éé 
HandleException
èè 
(
èè  
ex
èè  "
,
èè" # 
Enum_ErrorSeverity
èè$ 6
.
èè6 7
Error
èè7 <
,
èè< =
nameof
èè> D
(
èèD E"
GetSpecsForTypeAsync
èèE Y
)
èèY Z
,
èèZ [
nameof
èè\ b
(
èèb c#
Service_MySQL_Dunnage
èèc x
)
èèx y
)
èèy z
;
èèz {
return
êê &
Model_Dao_Result_Factory
êê /
.
êê/ 0
Failure
êê0 7
<
êê7 8
List
êê8 <
<
êê< =
Model_DunnageSpec
êê= N
>
êêN O
>
êêO P
(
êêP Q
$"
êêQ S
$str
êêS k
{
êêk l
ex
êêl n
.
êên o
Message
êêo v
}
êêv w
"
êêw x
)
êêx y
;
êêy z
}
ëë 
}
íí 	
public
îî 
async
îî 
Task
îî 
<
îî 
Model_Dao_Result
îî *
>
îî* +
InsertSpecAsync
îî, ;
(
îî; <
Model_DunnageSpec
îî< M
spec
îîN R
)
îîR S
{
ïï 	
try
ññ 
{
óó 
var
òò 
result
òò 
=
òò 
await
òò "
_daoDunnageSpec
òò# 2
.
òò2 3
InsertAsync
òò3 >
(
òò> ?
spec
òò? C
.
òòC D
TypeId
òòD J
,
òòJ K
spec
òòL P
.
òòP Q
SpecKey
òòQ X
,
òòX Y
spec
òòZ ^
.
òò^ _
	SpecValue
òò_ h
,
òòh i
CurrentUser
òòj u
)
òòu v
;
òòv w
if
ôô 
(
ôô 
result
ôô 
.
ôô 
	IsSuccess
ôô $
)
ôô$ %
{
öö 
spec
õõ 
.
õõ 
Id
õõ 
=
õõ 
result
õõ $
.
õõ$ %
Data
õõ% )
;
õõ) *
return
úú &
Model_Dao_Result_Factory
úú 3
.
úú3 4
Success
úú4 ;
(
úú; <
)
úú< =
;
úú= >
}
ùù 
return
ûû &
Model_Dao_Result_Factory
ûû /
.
ûû/ 0
Failure
ûû0 7
(
ûû7 8
result
ûû8 >
.
ûû> ?
ErrorMessage
ûû? K
)
ûûK L
;
ûûL M
}
üü 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
°° 
HandleException
¢¢ 
(
¢¢  
ex
¢¢  "
,
¢¢" # 
Enum_ErrorSeverity
¢¢$ 6
.
¢¢6 7
Error
¢¢7 <
,
¢¢< =
nameof
¢¢> D
(
¢¢D E
InsertSpecAsync
¢¢E T
)
¢¢T U
,
¢¢U V
nameof
¢¢W ]
(
¢¢] ^#
Service_MySQL_Dunnage
¢¢^ s
)
¢¢s t
)
¢¢t u
;
¢¢u v
return
££ &
Model_Dao_Result_Factory
££ /
.
££/ 0
Failure
££0 7
(
££7 8
$"
££8 :
$str
££: P
{
££P Q
ex
££Q S
.
££S T
Message
££T [
}
££[ \
"
££\ ]
)
££] ^
;
££^ _
}
§§ 
}
•• 	
public
ßß 
async
ßß 
Task
ßß 
<
ßß 
Model_Dao_Result
ßß *
>
ßß* +
UpdateSpecAsync
ßß, ;
(
ßß; <
Model_DunnageSpec
ßß< M
spec
ßßN R
)
ßßR S
{
®® 	
try
©© 
{
™™ 
return
´´ 
await
´´ 
_daoDunnageSpec
´´ ,
.
´´, -
UpdateAsync
´´- 8
(
´´8 9
spec
´´9 =
.
´´= >
Id
´´> @
,
´´@ A
spec
´´B F
.
´´F G
	SpecValue
´´G P
,
´´P Q
CurrentUser
´´R ]
)
´´] ^
;
´´^ _
}
¨¨ 
catch
≠≠ 
(
≠≠ 
	Exception
≠≠ 
ex
≠≠ 
)
≠≠  
{
ÆÆ 
HandleException
ØØ 
(
ØØ  
ex
ØØ  "
,
ØØ" # 
Enum_ErrorSeverity
ØØ$ 6
.
ØØ6 7
Error
ØØ7 <
,
ØØ< =
nameof
ØØ> D
(
ØØD E
UpdateSpecAsync
ØØE T
)
ØØT U
,
ØØU V
nameof
ØØW ]
(
ØØ] ^#
Service_MySQL_Dunnage
ØØ^ s
)
ØØs t
)
ØØt u
;
ØØu v
return
∞∞ &
Model_Dao_Result_Factory
∞∞ /
.
∞∞/ 0
Failure
∞∞0 7
(
∞∞7 8
$"
∞∞8 :
$str
∞∞: O
{
∞∞O P
ex
∞∞P R
.
∞∞R S
Message
∞∞S Z
}
∞∞Z [
"
∞∞[ \
)
∞∞\ ]
;
∞∞] ^
}
±± 
}
≤≤ 	
public
¥¥ 
async
¥¥ 
Task
¥¥ 
<
¥¥ 
Model_Dao_Result
¥¥ *
>
¥¥* +
DeleteSpecAsync
¥¥, ;
(
¥¥; <
int
¥¥< ?
specId
¥¥@ F
)
¥¥F G
{
µµ 	
try
∂∂ 
{
∑∑ 
return
∏∏ 
await
∏∏ 
_daoDunnageSpec
∏∏ ,
.
∏∏, -
DeleteByIdAsync
∏∏- <
(
∏∏< =
specId
∏∏= C
)
∏∏C D
;
∏∏D E
}
ππ 
catch
∫∫ 
(
∫∫ 
	Exception
∫∫ 
ex
∫∫ 
)
∫∫  
{
ªª 
HandleException
ºº 
(
ºº  
ex
ºº  "
,
ºº" # 
Enum_ErrorSeverity
ºº$ 6
.
ºº6 7
Error
ºº7 <
,
ºº< =
nameof
ºº> D
(
ººD E
DeleteSpecAsync
ººE T
)
ººT U
,
ººU V
nameof
ººW ]
(
ºº] ^#
Service_MySQL_Dunnage
ºº^ s
)
ººs t
)
ººt u
;
ººu v
return
ΩΩ &
Model_Dao_Result_Factory
ΩΩ /
.
ΩΩ/ 0
Failure
ΩΩ0 7
(
ΩΩ7 8
$"
ΩΩ8 :
$str
ΩΩ: O
{
ΩΩO P
ex
ΩΩP R
.
ΩΩR S
Message
ΩΩS Z
}
ΩΩZ [
"
ΩΩ[ \
)
ΩΩ\ ]
;
ΩΩ] ^
}
ææ 
}
øø 	
public
¡¡ 
async
¡¡ 
Task
¡¡ 
<
¡¡ 
Model_Dao_Result
¡¡ *
>
¡¡* +&
DeleteSpecsByTypeIdAsync
¡¡, D
(
¡¡D E
int
¡¡E H
typeId
¡¡I O
)
¡¡O P
{
¬¬ 	
try
√√ 
{
ƒƒ 
return
≈≈ 
await
≈≈ 
_daoDunnageSpec
≈≈ ,
.
≈≈, -
DeleteByTypeAsync
≈≈- >
(
≈≈> ?
typeId
≈≈? E
)
≈≈E F
;
≈≈F G
}
∆∆ 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
»» 
HandleException
…… 
(
……  
ex
……  "
,
……" # 
Enum_ErrorSeverity
……$ 6
.
……6 7
Error
……7 <
,
……< =
nameof
……> D
(
……D E&
DeleteSpecsByTypeIdAsync
……E ]
)
……] ^
,
……^ _
nameof
……` f
(
……f g#
Service_MySQL_Dunnage
……g |
)
……| }
)
……} ~
;
……~ 
return
   &
Model_Dao_Result_Factory
   /
.
  / 0
Failure
  0 7
(
  7 8
$"
  8 :
$str
  : Y
{
  Y Z
ex
  Z \
.
  \ ]
Message
  ] d
}
  d e
"
  e f
)
  f g
;
  g h
}
ÀÀ 
}
ÃÃ 	
public
ŒŒ 
async
ŒŒ 
Task
ŒŒ 
<
ŒŒ 
List
ŒŒ 
<
ŒŒ 
string
ŒŒ %
>
ŒŒ% &
>
ŒŒ& '!
GetAllSpecKeysAsync
ŒŒ( ;
(
ŒŒ; <
)
ŒŒ< =
{
œœ 	
try
–– 
{
—— 
var
““ 
result
““ 
=
““ 
await
““ "
_daoDunnageSpec
““# 2
.
““2 3
GetAllAsync
““3 >
(
““> ?
)
““? @
;
““@ A
if
”” 
(
”” 
result
”” 
.
”” 
	IsSuccess
”” $
&&
””% '
result
””( .
.
””. /
Data
””/ 3
!=
””4 6
null
””7 ;
)
””; <
{
‘‘ 
return
’’ 
result
’’ !
.
’’! "
Data
’’" &
.
’’& '
Select
’’' -
(
’’- .
s
’’. /
=>
’’0 2
s
’’3 4
.
’’4 5
SpecKey
’’5 <
)
’’< =
.
’’= >
Distinct
’’> F
(
’’F G
)
’’G H
.
’’H I
OrderBy
’’I P
(
’’P Q
k
’’Q R
=>
’’S U
k
’’V W
)
’’W X
.
’’X Y
ToList
’’Y _
(
’’_ `
)
’’` a
;
’’a b
}
÷÷ 
return
◊◊ 
new
◊◊ 
List
◊◊ 
<
◊◊  
string
◊◊  &
>
◊◊& '
(
◊◊' (
)
◊◊( )
;
◊◊) *
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
⁄⁄ 
HandleException
€€ 
(
€€  
ex
€€  "
,
€€" # 
Enum_ErrorSeverity
€€$ 6
.
€€6 7
Warning
€€7 >
,
€€> ?
nameof
€€@ F
(
€€F G!
GetAllSpecKeysAsync
€€G Z
)
€€Z [
,
€€[ \
nameof
€€] c
(
€€c d#
Service_MySQL_Dunnage
€€d y
)
€€y z
)
€€z {
;
€€{ |
return
‹‹ 
new
‹‹ 
List
‹‹ 
<
‹‹  
string
‹‹  &
>
‹‹& '
(
‹‹' (
)
‹‹( )
;
‹‹) *
}
›› 
}
ﬁﬁ 	
public
‚‚ 
async
‚‚ 
Task
‚‚ 
<
‚‚ 
Model_Dao_Result
‚‚ *
<
‚‚* +
List
‚‚+ /
<
‚‚/ 0
Model_DunnagePart
‚‚0 A
>
‚‚A B
>
‚‚B C
>
‚‚C D
GetAllPartsAsync
‚‚E U
(
‚‚U V
)
‚‚V W
{
„„ 	
try
‰‰ 
{
ÂÂ 
return
ÊÊ 
await
ÊÊ 
_daoDunnagePart
ÊÊ ,
.
ÊÊ, -
GetAllAsync
ÊÊ- 8
(
ÊÊ8 9
)
ÊÊ9 :
;
ÊÊ: ;
}
ÁÁ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÈÈ 
HandleException
ÍÍ 
(
ÍÍ  
ex
ÍÍ  "
,
ÍÍ" # 
Enum_ErrorSeverity
ÍÍ$ 6
.
ÍÍ6 7
Error
ÍÍ7 <
,
ÍÍ< =
nameof
ÍÍ> D
(
ÍÍD E
GetAllPartsAsync
ÍÍE U
)
ÍÍU V
,
ÍÍV W
nameof
ÍÍX ^
(
ÍÍ^ _#
Service_MySQL_Dunnage
ÍÍ_ t
)
ÍÍt u
)
ÍÍu v
;
ÍÍv w
return
ÎÎ &
Model_Dao_Result_Factory
ÎÎ /
.
ÎÎ/ 0
Failure
ÎÎ0 7
<
ÎÎ7 8
List
ÎÎ8 <
<
ÎÎ< =
Model_DunnagePart
ÎÎ= N
>
ÎÎN O
>
ÎÎO P
(
ÎÎP Q
$"
ÎÎQ S
$str
ÎÎS k
{
ÎÎk l
ex
ÎÎl n
.
ÎÎn o
Message
ÎÎo v
}
ÎÎv w
"
ÎÎw x
)
ÎÎx y
;
ÎÎy z
}
ÏÏ 
}
ÌÌ 	
public
ÔÔ 
async
ÔÔ 
Task
ÔÔ 
<
ÔÔ 
Model_Dao_Result
ÔÔ *
<
ÔÔ* +
List
ÔÔ+ /
<
ÔÔ/ 0
Model_DunnagePart
ÔÔ0 A
>
ÔÔA B
>
ÔÔB C
>
ÔÔC D!
GetPartsByTypeAsync
ÔÔE X
(
ÔÔX Y
int
ÔÔY \
typeId
ÔÔ] c
)
ÔÔc d
{
 	
try
ÒÒ 
{
ÚÚ 
return
ÛÛ 
await
ÛÛ 
_daoDunnagePart
ÛÛ ,
.
ÛÛ, -
GetByTypeAsync
ÛÛ- ;
(
ÛÛ; <
typeId
ÛÛ< B
)
ÛÛB C
;
ÛÛC D
}
ÙÙ 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
ˆˆ 
HandleException
˜˜ 
(
˜˜  
ex
˜˜  "
,
˜˜" # 
Enum_ErrorSeverity
˜˜$ 6
.
˜˜6 7
Error
˜˜7 <
,
˜˜< =
nameof
˜˜> D
(
˜˜D E!
GetPartsByTypeAsync
˜˜E X
)
˜˜X Y
,
˜˜Y Z
nameof
˜˜[ a
(
˜˜a b#
Service_MySQL_Dunnage
˜˜b w
)
˜˜w x
)
˜˜x y
;
˜˜y z
return
¯¯ &
Model_Dao_Result_Factory
¯¯ /
.
¯¯/ 0
Failure
¯¯0 7
<
¯¯7 8
List
¯¯8 <
<
¯¯< =
Model_DunnagePart
¯¯= N
>
¯¯N O
>
¯¯O P
(
¯¯P Q
$"
¯¯Q S
$str
¯¯S s
{
¯¯s t
ex
¯¯t v
.
¯¯v w
Message
¯¯w ~
}
¯¯~ 
"¯¯ Ä
)¯¯Ä Å
;¯¯Å Ç
}
˘˘ 
}
˙˙ 	
public
¸¸ 
async
¸¸ 
Task
¸¸ 
<
¸¸ 
Model_Dao_Result
¸¸ *
<
¸¸* +
Model_DunnagePart
¸¸+ <
>
¸¸< =
>
¸¸= >
GetPartByIdAsync
¸¸? O
(
¸¸O P
string
¸¸P V
partId
¸¸W ]
)
¸¸] ^
{
˝˝ 	
try
˛˛ 
{
ˇˇ 
return
ÄÄ 
await
ÄÄ 
_daoDunnagePart
ÄÄ ,
.
ÄÄ, -
GetByIdAsync
ÄÄ- 9
(
ÄÄ9 :
partId
ÄÄ: @
)
ÄÄ@ A
;
ÄÄA B
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÉÉ 
HandleException
ÑÑ 
(
ÑÑ  
ex
ÑÑ  "
,
ÑÑ" # 
Enum_ErrorSeverity
ÑÑ$ 6
.
ÑÑ6 7
Error
ÑÑ7 <
,
ÑÑ< =
nameof
ÑÑ> D
(
ÑÑD E
GetPartByIdAsync
ÑÑE U
)
ÑÑU V
,
ÑÑV W
nameof
ÑÑX ^
(
ÑÑ^ _#
Service_MySQL_Dunnage
ÑÑ_ t
)
ÑÑt u
)
ÑÑu v
;
ÑÑv w
return
ÖÖ &
Model_Dao_Result_Factory
ÖÖ /
.
ÖÖ/ 0
Failure
ÖÖ0 7
<
ÖÖ7 8
Model_DunnagePart
ÖÖ8 I
>
ÖÖI J
(
ÖÖJ K
$"
ÖÖK M
$str
ÖÖM d
{
ÖÖd e
ex
ÖÖe g
.
ÖÖg h
Message
ÖÖh o
}
ÖÖo p
"
ÖÖp q
)
ÖÖq r
;
ÖÖr s
}
ÜÜ 
}
áá 	
public
ââ 
async
ââ 
Task
ââ 
<
ââ 
Model_Dao_Result
ââ *
>
ââ* +
InsertPartAsync
ââ, ;
(
ââ; <
Model_DunnagePart
ââ< M
part
ââN R
)
ââR S
{
ää 	
try
ãã 
{
åå 
var
çç 
result
çç 
=
çç 
await
çç "
_daoDunnagePart
çç# 2
.
çç2 3
InsertAsync
çç3 >
(
çç> ?
part
çç? C
.
ççC D
PartId
ççD J
,
ççJ K
part
ççL P
.
ççP Q
TypeId
ççQ W
,
ççW X
part
ççY ]
.
çç] ^

SpecValues
çç^ h
,
ççh i
CurrentUser
ççj u
)
ççu v
;
ççv w
if
éé 
(
éé 
result
éé 
.
éé 
	IsSuccess
éé $
)
éé$ %
{
èè 
part
êê 
.
êê 
Id
êê 
=
êê 
result
êê $
.
êê$ %
Data
êê% )
;
êê) *
return
ëë &
Model_Dao_Result_Factory
ëë 3
.
ëë3 4
Success
ëë4 ;
(
ëë; <
)
ëë< =
;
ëë= >
}
íí 
return
ìì &
Model_Dao_Result_Factory
ìì /
.
ìì/ 0
Failure
ìì0 7
(
ìì7 8
result
ìì8 >
.
ìì> ?
ErrorMessage
ìì? K
)
ììK L
;
ììL M
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ññ 
HandleException
óó 
(
óó  
ex
óó  "
,
óó" # 
Enum_ErrorSeverity
óó$ 6
.
óó6 7
Error
óó7 <
,
óó< =
nameof
óó> D
(
óóD E
InsertPartAsync
óóE T
)
óóT U
,
óóU V
nameof
óóW ]
(
óó] ^#
Service_MySQL_Dunnage
óó^ s
)
óós t
)
óót u
;
óóu v
return
òò &
Model_Dao_Result_Factory
òò /
.
òò/ 0
Failure
òò0 7
(
òò7 8
$"
òò8 :
$str
òò: P
{
òòP Q
ex
òòQ S
.
òòS T
Message
òòT [
}
òò[ \
"
òò\ ]
)
òò] ^
;
òò^ _
}
ôô 
}
öö 	
public
úú 
async
úú 
Task
úú 
<
úú 
Model_Dao_Result
úú *
>
úú* +
UpdatePartAsync
úú, ;
(
úú; <
Model_DunnagePart
úú< M
part
úúN R
)
úúR S
{
ùù 	
try
ûû 
{
üü 
return
†† 
await
†† 
_daoDunnagePart
†† ,
.
††, -
UpdateAsync
††- 8
(
††8 9
part
††9 =
.
††= >
Id
††> @
,
††@ A
part
††B F
.
††F G

SpecValues
††G Q
,
††Q R
CurrentUser
††S ^
)
††^ _
;
††_ `
}
°° 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
HandleException
§§ 
(
§§  
ex
§§  "
,
§§" # 
Enum_ErrorSeverity
§§$ 6
.
§§6 7
Error
§§7 <
,
§§< =
nameof
§§> D
(
§§D E
UpdatePartAsync
§§E T
)
§§T U
,
§§U V
nameof
§§W ]
(
§§] ^#
Service_MySQL_Dunnage
§§^ s
)
§§s t
)
§§t u
;
§§u v
return
•• &
Model_Dao_Result_Factory
•• /
.
••/ 0
Failure
••0 7
(
••7 8
$"
••8 :
$str
••: O
{
••O P
ex
••P R
.
••R S
Message
••S Z
}
••Z [
"
••[ \
)
••\ ]
;
••] ^
}
¶¶ 
}
ßß 	
public
©© 
async
©© 
Task
©© 
<
©© 
Model_Dao_Result
©© *
>
©©* +
DeletePartAsync
©©, ;
(
©©; <
string
©©< B
partId
©©C I
)
©©I J
{
™™ 	
return
¨¨ &
Model_Dao_Result_Factory
¨¨ +
.
¨¨+ ,
Failure
¨¨, 3
(
¨¨3 4
$str
¨¨4 ]
)
¨¨] ^
;
¨¨^ _
}
≠≠ 	
public
ØØ 
async
ØØ 
Task
ØØ 
<
ØØ 
Model_Dao_Result
ØØ *
<
ØØ* +
List
ØØ+ /
<
ØØ/ 0
Model_DunnagePart
ØØ0 A
>
ØØA B
>
ØØB C
>
ØØC D
SearchPartsAsync
ØØE U
(
ØØU V
string
ØØV \

searchText
ØØ] g
,
ØØg h
int
ØØi l
?
ØØl m
typeId
ØØn t
)
ØØt u
{
∞∞ 	
try
±± 
{
≤≤ 
Model_Dao_Result
≥≥  
<
≥≥  !
List
≥≥! %
<
≥≥% &
Model_DunnagePart
≥≥& 7
>
≥≥7 8
>
≥≥8 9
result
≥≥: @
;
≥≥@ A
if
¥¥ 
(
¥¥ 
typeId
¥¥ 
.
¥¥ 
HasValue
¥¥ #
)
¥¥# $
{
µµ 
result
∂∂ 
=
∂∂ 
await
∂∂ "
_daoDunnagePart
∂∂# 2
.
∂∂2 3
GetByTypeAsync
∂∂3 A
(
∂∂A B
typeId
∂∂B H
.
∂∂H I
Value
∂∂I N
)
∂∂N O
;
∂∂O P
}
∑∑ 
else
∏∏ 
{
ππ 
result
∫∫ 
=
∫∫ 
await
∫∫ "
_daoDunnagePart
∫∫# 2
.
∫∫2 3
GetAllAsync
∫∫3 >
(
∫∫> ?
)
∫∫? @
;
∫∫@ A
}
ªª 
if
ΩΩ 
(
ΩΩ 
!
ΩΩ 
result
ΩΩ 
.
ΩΩ 
	IsSuccess
ΩΩ %
||
ΩΩ& (
result
ΩΩ) /
.
ΩΩ/ 0
Data
ΩΩ0 4
==
ΩΩ5 7
null
ΩΩ8 <
)
ΩΩ< =
return
ΩΩ> D
result
ΩΩE K
;
ΩΩK L
if
øø 
(
øø 
string
øø 
.
øø  
IsNullOrWhiteSpace
øø -
(
øø- .

searchText
øø. 8
)
øø8 9
)
øø9 :
return
øø; A
result
øøB H
;
øøH I
var
¡¡ 
filtered
¡¡ 
=
¡¡ 
result
¡¡ %
.
¡¡% &
Data
¡¡& *
.
¡¡* +
Where
¡¡+ 0
(
¡¡0 1
p
¡¡1 2
=>
¡¡3 5
p
¬¬ 
.
¬¬ 
PartId
¬¬ 
.
¬¬ 
Contains
¬¬ %
(
¬¬% &

searchText
¬¬& 0
,
¬¬0 1
StringComparison
¬¬2 B
.
¬¬B C
OrdinalIgnoreCase
¬¬C T
)
¬¬T U
||
¬¬V X
p
√√ 
.
√√ 
DunnageTypeName
√√ %
.
√√% &
Contains
√√& .
(
√√. /

searchText
√√/ 9
,
√√9 :
StringComparison
√√; K
.
√√K L
OrdinalIgnoreCase
√√L ]
)
√√] ^
)
ƒƒ 
.
ƒƒ 
ToList
ƒƒ 
(
ƒƒ 
)
ƒƒ 
;
ƒƒ 
return
∆∆ &
Model_Dao_Result_Factory
∆∆ /
.
∆∆/ 0
Success
∆∆0 7
<
∆∆7 8
List
∆∆8 <
<
∆∆< =
Model_DunnagePart
∆∆= N
>
∆∆N O
>
∆∆O P
(
∆∆P Q
filtered
∆∆Q Y
)
∆∆Y Z
;
∆∆Z [
}
«« 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
…… 
HandleException
   
(
    
ex
    "
,
  " # 
Enum_ErrorSeverity
  $ 6
.
  6 7
Error
  7 <
,
  < =
nameof
  > D
(
  D E
SearchPartsAsync
  E U
)
  U V
,
  V W
nameof
  X ^
(
  ^ _#
Service_MySQL_Dunnage
  _ t
)
  t u
)
  u v
;
  v w
return
ÀÀ &
Model_Dao_Result_Factory
ÀÀ /
.
ÀÀ/ 0
Failure
ÀÀ0 7
<
ÀÀ7 8
List
ÀÀ8 <
<
ÀÀ< =
Model_DunnagePart
ÀÀ= N
>
ÀÀN O
>
ÀÀO P
(
ÀÀP Q
$"
ÀÀQ S
$str
ÀÀS j
{
ÀÀj k
ex
ÀÀk m
.
ÀÀm n
Message
ÀÀn u
}
ÀÀu v
"
ÀÀv w
)
ÀÀw x
;
ÀÀx y
}
ÃÃ 
}
ÕÕ 	
public
—— 
async
—— 
Task
—— 
<
—— 
Model_Dao_Result
—— *
>
——* +
SaveLoadsAsync
——, :
(
——: ;
List
——; ?
<
——? @
Model_DunnageLoad
——@ Q
>
——Q R
loads
——S X
)
——X Y
{
““ 	
try
”” 
{
‘‘ 
if
’’ 
(
’’ 
loads
’’ 
==
’’ 
null
’’ !
||
’’" $
loads
’’% *
.
’’* +
Count
’’+ 0
==
’’1 3
$num
’’4 5
)
’’5 6
return
’’7 =&
Model_Dao_Result_Factory
’’> V
.
’’V W
Success
’’W ^
(
’’^ _
)
’’_ `
;
’’` a
return
÷÷ 
await
÷÷ 
_daoDunnageLoad
÷÷ ,
.
÷÷, -
InsertBatchAsync
÷÷- =
(
÷÷= >
loads
÷÷> C
,
÷÷C D
CurrentUser
÷÷E P
)
÷÷P Q
;
÷÷Q R
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
ŸŸ 
HandleException
⁄⁄ 
(
⁄⁄  
ex
⁄⁄  "
,
⁄⁄" # 
Enum_ErrorSeverity
⁄⁄$ 6
.
⁄⁄6 7
Error
⁄⁄7 <
,
⁄⁄< =
nameof
⁄⁄> D
(
⁄⁄D E
SaveLoadsAsync
⁄⁄E S
)
⁄⁄S T
,
⁄⁄T U
nameof
⁄⁄V \
(
⁄⁄\ ]#
Service_MySQL_Dunnage
⁄⁄] r
)
⁄⁄r s
)
⁄⁄s t
;
⁄⁄t u
return
€€ &
Model_Dao_Result_Factory
€€ /
.
€€/ 0
Failure
€€0 7
(
€€7 8
$"
€€8 :
$str
€€: N
{
€€N O
ex
€€O Q
.
€€Q R
Message
€€R Y
}
€€Y Z
"
€€Z [
)
€€[ \
;
€€\ ]
}
‹‹ 
}
›› 	
public
ﬂﬂ 
async
ﬂﬂ 
Task
ﬂﬂ 
<
ﬂﬂ 
Model_Dao_Result
ﬂﬂ *
<
ﬂﬂ* +
List
ﬂﬂ+ /
<
ﬂﬂ/ 0
Model_DunnageLoad
ﬂﬂ0 A
>
ﬂﬂA B
>
ﬂﬂB C
>
ﬂﬂC D&
GetLoadsByDateRangeAsync
ﬂﬂE ]
(
ﬂﬂ] ^
DateTime
ﬂﬂ^ f
start
ﬂﬂg l
,
ﬂﬂl m
DateTime
ﬂﬂn v
end
ﬂﬂw z
)
ﬂﬂz {
{
‡‡ 	
try
·· 
{
‚‚ 
return
„„ 
await
„„ 
_daoDunnageLoad
„„ ,
.
„„, -!
GetByDateRangeAsync
„„- @
(
„„@ A
start
„„A F
,
„„F G
end
„„H K
)
„„K L
;
„„L M
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÊÊ 
HandleException
ÁÁ 
(
ÁÁ  
ex
ÁÁ  "
,
ÁÁ" # 
Enum_ErrorSeverity
ÁÁ$ 6
.
ÁÁ6 7
Error
ÁÁ7 <
,
ÁÁ< =
nameof
ÁÁ> D
(
ÁÁD E&
GetLoadsByDateRangeAsync
ÁÁE ]
)
ÁÁ] ^
,
ÁÁ^ _
nameof
ÁÁ` f
(
ÁÁf g#
Service_MySQL_Dunnage
ÁÁg |
)
ÁÁ| }
)
ÁÁ} ~
;
ÁÁ~ 
return
ËË &
Model_Dao_Result_Factory
ËË /
.
ËË/ 0
Failure
ËË0 7
<
ËË7 8
List
ËË8 <
<
ËË< =
Model_DunnageLoad
ËË= N
>
ËËN O
>
ËËO P
(
ËËP Q
$"
ËËQ S
$str
ËËS k
{
ËËk l
ex
ËËl n
.
ËËn o
Message
ËËo v
}
ËËv w
"
ËËw x
)
ËËx y
;
ËËy z
}
ÈÈ 
}
ÍÍ 	
public
ÏÏ 
async
ÏÏ 
Task
ÏÏ 
<
ÏÏ 
Model_Dao_Result
ÏÏ *
<
ÏÏ* +
List
ÏÏ+ /
<
ÏÏ/ 0
Model_DunnageLoad
ÏÏ0 A
>
ÏÏA B
>
ÏÏB C
>
ÏÏC D
GetAllLoadsAsync
ÏÏE U
(
ÏÏU V
)
ÏÏV W
{
ÌÌ 	
try
ÓÓ 
{
ÔÔ 
return
 
await
 
_daoDunnageLoad
 ,
.
, -
GetAllAsync
- 8
(
8 9
)
9 :
;
: ;
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
HandleException
ÙÙ 
(
ÙÙ  
ex
ÙÙ  "
,
ÙÙ" # 
Enum_ErrorSeverity
ÙÙ$ 6
.
ÙÙ6 7
Error
ÙÙ7 <
,
ÙÙ< =
nameof
ÙÙ> D
(
ÙÙD E
GetAllLoadsAsync
ÙÙE U
)
ÙÙU V
,
ÙÙV W
nameof
ÙÙX ^
(
ÙÙ^ _#
Service_MySQL_Dunnage
ÙÙ_ t
)
ÙÙt u
)
ÙÙu v
;
ÙÙv w
return
ıı &
Model_Dao_Result_Factory
ıı /
.
ıı/ 0
Failure
ıı0 7
<
ıı7 8
List
ıı8 <
<
ıı< =
Model_DunnageLoad
ıı= N
>
ııN O
>
ııO P
(
ııP Q
$"
ııQ S
$str
ııS o
{
ııo p
ex
ııp r
.
ıır s
Message
ııs z
}
ıız {
"
ıı{ |
)
ıı| }
;
ıı} ~
}
ˆˆ 
}
˜˜ 	
public
˘˘ 
async
˘˘ 
Task
˘˘ 
<
˘˘ 
Model_Dao_Result
˘˘ *
<
˘˘* +
Model_DunnageLoad
˘˘+ <
>
˘˘< =
>
˘˘= >
GetLoadByIdAsync
˘˘? O
(
˘˘O P
string
˘˘P V
loadUuid
˘˘W _
)
˘˘_ `
{
˙˙ 	
try
˚˚ 
{
¸¸ 
if
˝˝ 
(
˝˝ 
Guid
˝˝ 
.
˝˝ 
TryParse
˝˝ !
(
˝˝! "
loadUuid
˝˝" *
,
˝˝* +
out
˝˝, /
var
˝˝0 3
guid
˝˝4 8
)
˝˝8 9
)
˝˝9 :
{
˛˛ 
return
ˇˇ 
await
ˇˇ  
_daoDunnageLoad
ˇˇ! 0
.
ˇˇ0 1
GetByIdAsync
ˇˇ1 =
(
ˇˇ= >
guid
ˇˇ> B
)
ˇˇB C
;
ˇˇC D
}
ÄÄ 
return
ÅÅ &
Model_Dao_Result_Factory
ÅÅ /
.
ÅÅ/ 0
Failure
ÅÅ0 7
<
ÅÅ7 8
Model_DunnageLoad
ÅÅ8 I
>
ÅÅI J
(
ÅÅJ K
$str
ÅÅK `
)
ÅÅ` a
;
ÅÅa b
}
ÇÇ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÑÑ 
HandleException
ÖÖ 
(
ÖÖ  
ex
ÖÖ  "
,
ÖÖ" # 
Enum_ErrorSeverity
ÖÖ$ 6
.
ÖÖ6 7
Error
ÖÖ7 <
,
ÖÖ< =
nameof
ÖÖ> D
(
ÖÖD E
GetLoadByIdAsync
ÖÖE U
)
ÖÖU V
,
ÖÖV W
nameof
ÖÖX ^
(
ÖÖ^ _#
Service_MySQL_Dunnage
ÖÖ_ t
)
ÖÖt u
)
ÖÖu v
;
ÖÖv w
return
ÜÜ &
Model_Dao_Result_Factory
ÜÜ /
.
ÜÜ/ 0
Failure
ÜÜ0 7
<
ÜÜ7 8
Model_DunnageLoad
ÜÜ8 I
>
ÜÜI J
(
ÜÜJ K
$"
ÜÜK M
$str
ÜÜM d
{
ÜÜd e
ex
ÜÜe g
.
ÜÜg h
Message
ÜÜh o
}
ÜÜo p
"
ÜÜp q
)
ÜÜq r
;
ÜÜr s
}
áá 
}
àà 	
public
ää 
async
ää 
Task
ää 
<
ää 
Model_Dao_Result
ää *
>
ää* +
UpdateLoadAsync
ää, ;
(
ää; <
Model_DunnageLoad
ää< M
load
ääN R
)
ääR S
{
ãã 	
return
åå &
Model_Dao_Result_Factory
åå +
.
åå+ ,
Failure
åå, 3
(
åå3 4
$str
åå4 ]
)
åå] ^
;
åå^ _
}
çç 	
public
èè 
async
èè 
Task
èè 
<
èè 
Model_Dao_Result
èè *
>
èè* +
DeleteLoadAsync
èè, ;
(
èè; <
string
èè< B
loadUuid
èèC K
)
èèK L
{
êê 	
return
ëë &
Model_Dao_Result_Factory
ëë +
.
ëë+ ,
Failure
ëë, 3
(
ëë3 4
$str
ëë4 ]
)
ëë] ^
;
ëë^ _
}
íí 	
public
ññ 
async
ññ 
Task
ññ 
<
ññ 
bool
ññ 
>
ññ $
IsPartInventoriedAsync
ññ  6
(
ññ6 7
string
ññ7 =
partId
ññ> D
)
ññD E
{
óó 	
try
òò 
{
ôô 
var
öö 
result
öö 
=
öö 
await
öö "$
_daoInventoriedDunnage
öö# 9
.
öö9 :

CheckAsync
öö: D
(
ööD E
partId
ööE K
)
ööK L
;
ööL M
return
õõ 
result
õõ 
.
õõ 
	IsSuccess
õõ '
&&
õõ( *
result
õõ+ 1
.
õõ1 2
Data
õõ2 6
;
õõ6 7
}
úú 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
ûû 
HandleException
üü 
(
üü  
ex
üü  "
,
üü" # 
Enum_ErrorSeverity
üü$ 6
.
üü6 7
Warning
üü7 >
,
üü> ?
nameof
üü@ F
(
üüF G$
IsPartInventoriedAsync
üüG ]
)
üü] ^
,
üü^ _
nameof
üü` f
(
üüf g#
Service_MySQL_Dunnage
üüg |
)
üü| }
)
üü} ~
;
üü~ 
return
†† 
false
†† 
;
†† 
}
°° 
}
¢¢ 	
public
§§ 
async
§§ 
Task
§§ 
<
§§ 
Model_Dao_Result
§§ *
<
§§* +&
Model_InventoriedDunnage
§§+ C
>
§§C D
>
§§D E&
GetInventoryDetailsAsync
§§F ^
(
§§^ _
string
§§_ e
partId
§§f l
)
§§l m
{
•• 	
try
¶¶ 
{
ßß 
return
®® 
await
®® $
_daoInventoriedDunnage
®® 3
.
®®3 4
GetByPartAsync
®®4 B
(
®®B C
partId
®®C I
)
®®I J
;
®®J K
}
©© 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
´´ 
HandleException
¨¨ 
(
¨¨  
ex
¨¨  "
,
¨¨" # 
Enum_ErrorSeverity
¨¨$ 6
.
¨¨6 7
Error
¨¨7 <
,
¨¨< =
nameof
¨¨> D
(
¨¨D E&
GetInventoryDetailsAsync
¨¨E ]
)
¨¨] ^
,
¨¨^ _
nameof
¨¨` f
(
¨¨f g#
Service_MySQL_Dunnage
¨¨g |
)
¨¨| }
)
¨¨} ~
;
¨¨~ 
return
≠≠ &
Model_Dao_Result_Factory
≠≠ /
.
≠≠/ 0
Failure
≠≠0 7
<
≠≠7 8&
Model_InventoriedDunnage
≠≠8 P
>
≠≠P Q
(
≠≠Q R
$"
≠≠R T
$str
≠≠T x
{
≠≠x y
ex
≠≠y {
.
≠≠{ |
Message≠≠| É
}≠≠É Ñ
"≠≠Ñ Ö
)≠≠Ö Ü
;≠≠Ü á
}
ÆÆ 
}
ØØ 	
public
±± 
async
±± 
Task
±± 
<
±± 
Model_Dao_Result
±± *
<
±±* +
List
±±+ /
<
±±/ 0&
Model_InventoriedDunnage
±±0 H
>
±±H I
>
±±I J
>
±±J K)
GetAllInventoriedPartsAsync
±±L g
(
±±g h
)
±±h i
{
≤≤ 	
try
≥≥ 
{
¥¥ 
return
µµ 
await
µµ $
_daoInventoriedDunnage
µµ 3
.
µµ3 4
GetAllAsync
µµ4 ?
(
µµ? @
)
µµ@ A
;
µµA B
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
ex
∑∑ 
)
∑∑  
{
∏∏ 
HandleException
ππ 
(
ππ  
ex
ππ  "
,
ππ" # 
Enum_ErrorSeverity
ππ$ 6
.
ππ6 7
Error
ππ7 <
,
ππ< =
nameof
ππ> D
(
ππD E)
GetAllInventoriedPartsAsync
ππE `
)
ππ` a
,
ππa b
nameof
ππc i
(
ππi j#
Service_MySQL_Dunnage
ππj 
)ππ Ä
)ππÄ Å
;ππÅ Ç
return
∫∫ &
Model_Dao_Result_Factory
∫∫ /
.
∫∫/ 0
Failure
∫∫0 7
<
∫∫7 8
List
∫∫8 <
<
∫∫< =&
Model_InventoriedDunnage
∫∫= U
>
∫∫U V
>
∫∫V W
(
∫∫W X
$"
∫∫X Z
$str
∫∫Z ~
{
∫∫~ 
ex∫∫ Å
.∫∫Å Ç
Message∫∫Ç â
}∫∫â ä
"∫∫ä ã
)∫∫ã å
;∫∫å ç
}
ªª 
}
ºº 	
public
ææ 
async
ææ 
Task
ææ 
<
ææ 
Model_Dao_Result
ææ *
>
ææ* +'
AddToInventoriedListAsync
ææ, E
(
ææE F&
Model_InventoriedDunnage
ææF ^
item
ææ_ c
)
ææc d
{
øø 	
try
¿¿ 
{
¡¡ 
var
¬¬ 
result
¬¬ 
=
¬¬ 
await
¬¬ "$
_daoInventoriedDunnage
¬¬# 9
.
¬¬9 :
InsertAsync
¬¬: E
(
¬¬E F
item
¬¬F J
.
¬¬J K
PartId
¬¬K Q
,
¬¬Q R
item
¬¬S W
.
¬¬W X
InventoryMethod
¬¬X g
??
¬¬h j
string
¬¬k q
.
¬¬q r
Empty
¬¬r w
,
¬¬w x
item
¬¬y }
.
¬¬} ~
Notes¬¬~ É
??¬¬Ñ Ü
string¬¬á ç
.¬¬ç é
Empty¬¬é ì
,¬¬ì î
CurrentUser¬¬ï †
)¬¬† °
;¬¬° ¢
if
√√ 
(
√√ 
result
√√ 
.
√√ 
	IsSuccess
√√ $
)
√√$ %
{
ƒƒ 
item
≈≈ 
.
≈≈ 
Id
≈≈ 
=
≈≈ 
result
≈≈ $
.
≈≈$ %
Data
≈≈% )
;
≈≈) *
return
∆∆ &
Model_Dao_Result_Factory
∆∆ 3
.
∆∆3 4
Success
∆∆4 ;
(
∆∆; <
)
∆∆< =
;
∆∆= >
}
«« 
return
»» &
Model_Dao_Result_Factory
»» /
.
»»/ 0
Failure
»»0 7
(
»»7 8
result
»»8 >
.
»»> ?
ErrorMessage
»»? K
)
»»K L
;
»»L M
}
…… 
catch
   
(
   
	Exception
   
ex
   
)
    
{
ÀÀ 
HandleException
ÃÃ 
(
ÃÃ  
ex
ÃÃ  "
,
ÃÃ" # 
Enum_ErrorSeverity
ÃÃ$ 6
.
ÃÃ6 7
Error
ÃÃ7 <
,
ÃÃ< =
nameof
ÃÃ> D
(
ÃÃD E'
AddToInventoriedListAsync
ÃÃE ^
)
ÃÃ^ _
,
ÃÃ_ `
nameof
ÃÃa g
(
ÃÃg h#
Service_MySQL_Dunnage
ÃÃh }
)
ÃÃ} ~
)
ÃÃ~ 
;ÃÃ Ä
return
ÕÕ &
Model_Dao_Result_Factory
ÕÕ /
.
ÕÕ/ 0
Failure
ÕÕ0 7
(
ÕÕ7 8
$"
ÕÕ8 :
$str
ÕÕ: Z
{
ÕÕZ [
ex
ÕÕ[ ]
.
ÕÕ] ^
Message
ÕÕ^ e
}
ÕÕe f
"
ÕÕf g
)
ÕÕg h
;
ÕÕh i
}
ŒŒ 
}
œœ 	
public
—— 
async
—— 
Task
—— 
<
—— 
Model_Dao_Result
—— *
>
——* +,
RemoveFromInventoriedListAsync
——, J
(
——J K
string
——K Q
partId
——R X
)
——X Y
{
““ 	
return
”” &
Model_Dao_Result_Factory
”” +
.
””+ ,
Failure
””, 3
(
””3 4
$str
””4 l
)
””l m
;
””m n
}
‘‘ 	
public
÷÷ 
async
÷÷ 
Task
÷÷ 
<
÷÷ 
Model_Dao_Result
÷÷ *
>
÷÷* +(
UpdateInventoriedPartAsync
÷÷, F
(
÷÷F G&
Model_InventoriedDunnage
÷÷G _
item
÷÷` d
)
÷÷d e
{
◊◊ 	
try
ÿÿ 
{
ŸŸ 
return
⁄⁄ 
await
⁄⁄ $
_daoInventoriedDunnage
⁄⁄ 3
.
⁄⁄3 4
UpdateAsync
⁄⁄4 ?
(
⁄⁄? @
item
⁄⁄@ D
.
⁄⁄D E
Id
⁄⁄E G
,
⁄⁄G H
item
⁄⁄I M
.
⁄⁄M N
InventoryMethod
⁄⁄N ]
??
⁄⁄^ `
string
⁄⁄a g
.
⁄⁄g h
Empty
⁄⁄h m
,
⁄⁄m n
item
⁄⁄o s
.
⁄⁄s t
Notes
⁄⁄t y
??
⁄⁄z |
string⁄⁄} É
.⁄⁄É Ñ
Empty⁄⁄Ñ â
,⁄⁄â ä
CurrentUser⁄⁄ã ñ
)⁄⁄ñ ó
;⁄⁄ó ò
}
€€ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
›› 
HandleException
ﬁﬁ 
(
ﬁﬁ  
ex
ﬁﬁ  "
,
ﬁﬁ" # 
Enum_ErrorSeverity
ﬁﬁ$ 6
.
ﬁﬁ6 7
Error
ﬁﬁ7 <
,
ﬁﬁ< =
nameof
ﬁﬁ> D
(
ﬁﬁD E(
UpdateInventoriedPartAsync
ﬁﬁE _
)
ﬁﬁ_ `
,
ﬁﬁ` a
nameof
ﬁﬁb h
(
ﬁﬁh i#
Service_MySQL_Dunnage
ﬁﬁi ~
)
ﬁﬁ~ 
)ﬁﬁ Ä
;ﬁﬁÄ Å
return
ﬂﬂ &
Model_Dao_Result_Factory
ﬂﬂ /
.
ﬂﬂ/ 0
Failure
ﬂﬂ0 7
(
ﬂﬂ7 8
$"
ﬂﬂ8 :
$str
ﬂﬂ: Y
{
ﬂﬂY Z
ex
ﬂﬂZ \
.
ﬂﬂ\ ]
Message
ﬂﬂ] d
}
ﬂﬂd e
"
ﬂﬂe f
)
ﬂﬂf g
;
ﬂﬂg h
}
‡‡ 
}
·· 	
public
ÂÂ 
async
ÂÂ 
Task
ÂÂ 
<
ÂÂ 
int
ÂÂ 
>
ÂÂ '
GetPartCountByTypeIdAsync
ÂÂ 8
(
ÂÂ8 9
int
ÂÂ9 <
typeId
ÂÂ= C
)
ÂÂC D
{
ÊÊ 	
try
ÁÁ 
{
ËË 
var
ÈÈ 
result
ÈÈ 
=
ÈÈ 
await
ÈÈ "
_daoDunnagePart
ÈÈ# 2
.
ÈÈ2 3
GetByTypeAsync
ÈÈ3 A
(
ÈÈA B
typeId
ÈÈB H
)
ÈÈH I
;
ÈÈI J
return
ÍÍ 
result
ÍÍ 
.
ÍÍ 
	IsSuccess
ÍÍ '
?
ÍÍ( )
(
ÍÍ* +
result
ÍÍ+ 1
.
ÍÍ1 2
Data
ÍÍ2 6
?
ÍÍ6 7
.
ÍÍ7 8
Count
ÍÍ8 =
??
ÍÍ> @
$num
ÍÍA B
)
ÍÍB C
:
ÍÍD E
$num
ÍÍF G
;
ÍÍG H
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ÌÌ 
HandleException
ÓÓ 
(
ÓÓ  
ex
ÓÓ  "
,
ÓÓ" # 
Enum_ErrorSeverity
ÓÓ$ 6
.
ÓÓ6 7
Warning
ÓÓ7 >
,
ÓÓ> ?
nameof
ÓÓ@ F
(
ÓÓF G'
GetPartCountByTypeIdAsync
ÓÓG `
)
ÓÓ` a
,
ÓÓa b
nameof
ÓÓc i
(
ÓÓi j#
Service_MySQL_Dunnage
ÓÓj 
)ÓÓ Ä
)ÓÓÄ Å
;ÓÓÅ Ç
return
ÔÔ 
$num
ÔÔ 
;
ÔÔ 
}
 
}
ÒÒ 	
public
ÛÛ 
async
ÛÛ 
Task
ÛÛ 
<
ÛÛ 
int
ÛÛ 
>
ÛÛ .
 GetTransactionCountByPartIdAsync
ÛÛ ?
(
ÛÛ? @
string
ÛÛ@ F
partId
ÛÛG M
)
ÛÛM N
{
ÙÙ 	
return
ˆˆ 
$num
ˆˆ 
;
ˆˆ 
}
˜˜ 	
public
˘˘ 
async
˘˘ 
Task
˘˘ 
<
˘˘ 
int
˘˘ 
>
˘˘ .
 GetTransactionCountByTypeIdAsync
˘˘ ?
(
˘˘? @
int
˘˘@ C
typeId
˘˘D J
)
˘˘J K
{
˙˙ 	
return
¸¸ 
$num
¸¸ 
;
¸¸ 
}
˝˝ 	
public
ˇˇ 
async
ˇˇ 
Task
ˇˇ 
<
ˇˇ 
int
ˇˇ 
>
ˇˇ (
GetPartCountBySpecKeyAsync
ˇˇ 9
(
ˇˇ9 :
int
ˇˇ: =
typeId
ˇˇ> D
,
ˇˇD E
string
ˇˇF L
specKey
ˇˇM T
)
ˇˇT U
{
ÄÄ 	
try
ÅÅ 
{
ÇÇ 
var
ÉÉ 
result
ÉÉ 
=
ÉÉ 
await
ÉÉ "
_daoDunnageSpec
ÉÉ# 2
.
ÉÉ2 3&
CountPartsUsingSpecAsync
ÉÉ3 K
(
ÉÉK L
typeId
ÉÉL R
,
ÉÉR S
specKey
ÉÉT [
)
ÉÉ[ \
;
ÉÉ\ ]
return
ÑÑ 
result
ÑÑ 
.
ÑÑ 
	IsSuccess
ÑÑ '
?
ÑÑ( )
result
ÑÑ* 0
.
ÑÑ0 1
Data
ÑÑ1 5
:
ÑÑ6 7
$num
ÑÑ8 9
;
ÑÑ9 :
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
áá 
HandleException
àà 
(
àà  
ex
àà  "
,
àà" # 
Enum_ErrorSeverity
àà$ 6
.
àà6 7
Warning
àà7 >
,
àà> ?
nameof
àà@ F
(
ààF G(
GetPartCountBySpecKeyAsync
ààG a
)
ààa b
,
ààb c
nameof
ààd j
(
ààj k$
Service_MySQL_Dunnageààk Ä
)ààÄ Å
)ààÅ Ç
;ààÇ É
return
ââ 
$num
ââ 
;
ââ 
}
ää 
}
ãã 	
private
çç 
void
çç 
HandleException
çç $
(
çç$ %
	Exception
çç% .
ex
çç/ 1
,
çç1 2 
Enum_ErrorSeverity
çç3 E
severity
ççF N
,
ççN O
string
ççP V
method
ççW ]
,
çç] ^
string
çç_ e
	className
ççf o
)
çço p
{
éé 	
_
èè 
=
èè 
_errorHandler
èè 
.
èè 
HandleErrorAsync
èè .
(
èè. /
$"
èè/ 1
$str
èè1 :
{
èè: ;
method
èè; A
}
èèA B
$str
èèB D
{
èèD E
	className
èèE N
}
èèN O
$str
èèO R
{
èèR S
ex
èèS U
.
èèU V
Message
èèV ]
}
èè] ^
"
èè^ _
,
èè_ `
severity
èèa i
,
èèi j
ex
èèk m
)
èèm n
;
èèn o
}
êê 	
}
ëë 
}íí ﬁà
aC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Database\Service_LoggingUtility.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
., -
Database- 5
;5 6
public 
class "
Service_LoggingUtility #
:$ %#
IService_LoggingUtility& =
{ 
private 
readonly 
string 
_logDirectory )
;) *
private 
readonly 
object 
_lockObject '
=( )
new* -
object. 4
(4 5
)5 6
;6 7
private 
readonly 
System 
. 
Collections '
.' (

Concurrent( 2
.2 3
BlockingCollection3 E
<E F
stringF L
>L M
	_logQueueN W
=X Y
newZ ]
(] ^
)^ _
;_ `
public 
"
Service_LoggingUtility !
(! "
)" #
{ 
_logDirectory 
= 
Path 
. 
Combine $
($ %
Environment 
. 
GetFolderPath %
(% &
Environment& 1
.1 2
SpecialFolder2 ?
.? @
ApplicationData@ O
)O P
,P Q
$str '
,' (
$str 
) 	
;	 
$
EnsureLogDirectoryExists  
(  !
)! "
;" #
System 
. 
	Threading 
. 
Tasks 
. 
Task #
.# $
Factory$ +
.+ ,
StartNew, 4
(4 5
ProcessLogQueue5 D
,D E
System 
. 
	Threading 
. 
CancellationToken .
.. /
None/ 3
,3 4
System 
. 
	Threading 
. 
Tasks "
." #
TaskCreationOptions# 6
.6 7
LongRunning7 B
,B C
System   
.   
	Threading   
.   
Tasks   "
.  " #
TaskScheduler  # 0
.  0 1
Default  1 8
)  8 9
;  9 :
}!! 
private## 
void## 
ProcessLogQueue##  
(##  !
)##! "
{$$ 
foreach%% 
(%% 
var%% 
logEntry%% 
in%%  
	_logQueue%%! *
.%%* +"
GetConsumingEnumerable%%+ A
(%%A B
)%%B C
)%%C D
{&& 	
try'' 
{(( 
string)) 
logFilePath)) "
=))# $!
GetCurrentLogFilePath))% :
()): ;
))); <
;))< =
lock** 
(** 
_lockObject** !
)**! "
{++ 
File,, 
.,, 
AppendAllText,, &
(,,& '
logFilePath,,' 2
,,,2 3
logEntry,,4 <
,,,< =
Encoding,,> F
.,,F G
UTF8,,G K
),,K L
;,,L M
}-- 
}.. 
catch// 
(// 
	Exception// 
ex// 
)//  
{00 
System11 
.11 
Diagnostics11 "
.11" #
Debug11# (
.11( )
	WriteLine11) 2
(112 3
$"113 5
$str115 P
{11P Q
ex11Q S
.11S T
Message11T [
}11[ \
"11\ ]
)11] ^
;11^ _
}22 
}33 	
}44 
public99 

void99 
LogInfo99 
(99 
string99 
message99 &
,99& '
string99( .
?99. /
context990 7
=998 9
null99: >
)99> ?
{:: 
WriteLog;; 
(;; 
$str;; 
,;; 
message;;  
,;;  !
null;;" &
,;;& '
context;;( /
);;/ 0
;;;0 1
}<< 
publicAA 

voidAA 

LogWarningAA 
(AA 
stringAA !
messageAA" )
,AA) *
stringAA+ 1
?AA1 2
contextAA3 :
=AA; <
nullAA= A
)AAA B
{BB 
WriteLogCC 
(CC 
$strCC 
,CC 
messageCC #
,CC# $
nullCC% )
,CC) *
contextCC+ 2
)CC2 3
;CC3 4
}DD 
publicII 

voidII 
LogErrorII 
(II 
stringII 
messageII  '
,II' (
	ExceptionII) 2
?II2 3
	exceptionII4 =
=II> ?
nullII@ D
,IID E
stringIIF L
?IIL M
contextIIN U
=IIV W
nullIIX \
)II\ ]
{JJ 
WriteLogKK 
(KK 
$strKK 
,KK 
messageKK !
,KK! "
	exceptionKK# ,
,KK, -
contextKK. 5
)KK5 6
;KK6 7
}LL 
publicQQ 

voidQQ 
LogCriticalQQ 
(QQ 
stringQQ "
messageQQ# *
,QQ* +
	ExceptionQQ, 5
?QQ5 6
	exceptionQQ7 @
=QQA B
nullQQC G
,QQG H
stringQQI O
?QQO P
contextQQQ X
=QQY Z
nullQQ[ _
)QQ_ `
{RR 
WriteLogSS 
(SS 
$strSS 
,SS 
messageSS $
,SS$ %
	exceptionSS& /
,SS/ 0
contextSS1 8
)SS8 9
;SS9 :
}TT 
publicYY 

voidYY 
LogFatalYY 
(YY 
stringYY 
messageYY  '
,YY' (
	ExceptionYY) 2
?YY2 3
	exceptionYY4 =
=YY> ?
nullYY@ D
,YYD E
stringYYF L
?YYL M
contextYYN U
=YYV W
nullYYX \
)YY\ ]
{ZZ 
WriteLog[[ 
([[ 
$str[[ 
,[[ 
message[[ !
,[[! "
	exception[[# ,
,[[, -
context[[. 5
)[[5 6
;[[6 7
}\\ 
publicaa 

stringaa !
GetCurrentLogFilePathaa '
(aa' (
)aa( )
{bb 
stringcc 
fileNamecc 
=cc 
$"cc 
$strcc  
{cc  !
DateTimecc! )
.cc) *
Nowcc* -
:cc- .
$strcc. 8
}cc8 9
$strcc9 =
"cc= >
;cc> ?
returndd 
Pathdd 
.dd 
Combinedd 
(dd 
_logDirectorydd )
,dd) *
fileNamedd+ 3
)dd3 4
;dd4 5
}ee 
publicjj 

booljj $
EnsureLogDirectoryExistsjj (
(jj( )
)jj) *
{kk 
tryll 
{mm 	
ifnn 
(nn 
!nn 
	Directorynn 
.nn 
Existsnn !
(nn! "
_logDirectorynn" /
)nn/ 0
)nn0 1
{oo 
	Directorypp 
.pp 
CreateDirectorypp )
(pp) *
_logDirectorypp* 7
)pp7 8
;pp8 9
}qq 
returnrr 
truerr 
;rr 
}ss 	
catchtt 
(tt 
	Exceptiontt 
extt 
)tt 
{uu 	
Systemww 
.ww 
Diagnosticsww 
.ww 
Debugww $
.ww$ %
	WriteLineww% .
(ww. /
$"ww/ 1
$strww1 Q
{wwQ R
exwwR T
.wwT U
MessagewwU \
}ww\ ]
"ww] ^
)ww^ _
;ww_ `
returnxx 
falsexx 
;xx 
}yy 	
}zz 
public 

int 
ArchiveOldLogs 
( 
int !

daysToKeep" ,
=- .
$num/ 1
)1 2
{
ÄÄ 
int
ÅÅ 
archivedCount
ÅÅ 
=
ÅÅ 
$num
ÅÅ 
;
ÅÅ 
try
ÉÉ 
{
ÑÑ 	
if
ÖÖ 
(
ÖÖ 
!
ÖÖ 
	Directory
ÖÖ 
.
ÖÖ 
Exists
ÖÖ !
(
ÖÖ! "
_logDirectory
ÖÖ" /
)
ÖÖ/ 0
)
ÖÖ0 1
{
ÜÜ 
return
áá 
$num
áá 
;
áá 
}
àà 
var
ää 

cutoffDate
ää 
=
ää 
DateTime
ää %
.
ää% &
Now
ää& )
.
ää) *
AddDays
ää* 1
(
ää1 2
-
ää2 3

daysToKeep
ää3 =
)
ää= >
;
ää> ?
var
ãã 
archiveDirectory
ãã  
=
ãã! "
Path
ãã# '
.
ãã' (
Combine
ãã( /
(
ãã/ 0
_logDirectory
ãã0 =
,
ãã= >
$str
ãã? H
)
ããH I
;
ããI J
foreach
çç 
(
çç 
var
çç 
file
çç 
in
çç  
	Directory
çç! *
.
çç* +
GetFiles
çç+ 3
(
çç3 4
_logDirectory
çç4 A
,
ççA B
$str
ççC N
)
ççN O
)
ççO P
{
éé 
var
èè 
fileInfo
èè 
=
èè 
new
èè "
FileInfo
èè# +
(
èè+ ,
file
èè, 0
)
èè0 1
;
èè1 2
if
ëë 
(
ëë 
fileInfo
ëë 
.
ëë 
LastWriteTime
ëë *
<
ëë+ ,

cutoffDate
ëë- 7
)
ëë7 8
{
íí 
if
îî 
(
îî 
!
îî 
	Directory
îî "
.
îî" #
Exists
îî# )
(
îî) *
archiveDirectory
îî* :
)
îî: ;
)
îî; <
{
ïï 
	Directory
ññ !
.
ññ! "
CreateDirectory
ññ" 1
(
ññ1 2
archiveDirectory
ññ2 B
)
ññB C
;
ññC D
}
óó 
string
öö 
archivePath
öö &
=
öö' (
Path
öö) -
.
öö- .
Combine
öö. 5
(
öö5 6
archiveDirectory
öö6 F
,
ööF G
fileInfo
ööH P
.
ööP Q
Name
ööQ U
)
ööU V
;
ööV W
if
ùù 
(
ùù 
File
ùù 
.
ùù 
Exists
ùù #
(
ùù# $
archivePath
ùù$ /
)
ùù/ 0
)
ùù0 1
{
ûû 
File
üü 
.
üü 
Delete
üü #
(
üü# $
archivePath
üü$ /
)
üü/ 0
;
üü0 1
}
†† 
File
¢¢ 
.
¢¢ 
Move
¢¢ 
(
¢¢ 
file
¢¢ "
,
¢¢" #
archivePath
¢¢$ /
)
¢¢/ 0
;
¢¢0 1
archivedCount
££ !
++
££! #
;
££# $
}
§§ 
}
•• 
}
¶¶ 	
catch
ßß 
(
ßß 
	Exception
ßß 
ex
ßß 
)
ßß 
{
®® 	
WriteLog
©© 
(
©© 
$str
©© 
,
©© 
$"
©©  
$str
©©  <
{
©©< =
ex
©©= ?
.
©©? @
Message
©©@ G
}
©©G H
"
©©H I
,
©©I J
ex
©©K M
,
©©M N
$str
©©O n
)
©©n o
;
©©o p
}
™™ 	
return
¨¨ 
archivedCount
¨¨ 
;
¨¨ 
}
≠≠ 
private
≤≤ 
void
≤≤ 
WriteLog
≤≤ 
(
≤≤ 
string
≤≤  
severity
≤≤! )
,
≤≤) *
string
≤≤+ 1
message
≤≤2 9
,
≤≤9 :
	Exception
≤≤; D
?
≤≤D E
	exception
≤≤F O
,
≤≤O P
string
≤≤Q W
?
≤≤W X
context
≤≤Y `
)
≤≤` a
{
≥≥ 
try
¥¥ 
{
µµ 	
string
∂∂ 
logFilePath
∂∂ 
=
∂∂  #
GetCurrentLogFilePath
∂∂! 6
(
∂∂6 7
)
∂∂7 8
;
∂∂8 9
var
∑∑ 
logEntry
∑∑ 
=
∑∑ 
new
∑∑ 
StringBuilder
∑∑ ,
(
∑∑, -
)
∑∑- .
;
∑∑. /
logEntry
∫∫ 
.
∫∫ 

AppendLine
∫∫ 
(
∫∫  
$"
∫∫  "
$str
∫∫" #
{
∫∫# $
DateTime
∫∫$ ,
.
∫∫, -
Now
∫∫- 0
:
∫∫0 1
$str
∫∫1 H
}
∫∫H I
$str
∫∫I L
{
∫∫L M
severity
∫∫M U
}
∫∫U V
$str
∫∫V X
{
∫∫X Y
(
∫∫Y Z
context
∫∫Z a
!=
∫∫b d
null
∫∫e i
?
∫∫j k
$"
∫∫l n
$str
∫∫n o
{
∫∫o p
context
∫∫p w
}
∫∫w x
$str
∫∫x y
"
∫∫y z
:
∫∫{ |
$str
∫∫} 
)∫∫ Ä
}∫∫Ä Å
"∫∫Å Ç
)∫∫Ç É
;∫∫É Ñ
logEntry
ªª 
.
ªª 

AppendLine
ªª 
(
ªª  
$"
ªª  "
$str
ªª" +
{
ªª+ ,
message
ªª, 3
}
ªª3 4
"
ªª4 5
)
ªª5 6
;
ªª6 7
if
ææ 
(
ææ 
!
ææ 
string
ææ 
.
ææ 
IsNullOrEmpty
ææ %
(
ææ% &
context
ææ& -
)
ææ- .
)
ææ. /
{
øø 
logEntry
¿¿ 
.
¿¿ 

AppendLine
¿¿ #
(
¿¿# $
$"
¿¿$ &
$str
¿¿& 4
{
¿¿4 5
Environment
¿¿5 @
.
¿¿@ A
UserName
¿¿A I
}
¿¿I J
$str
¿¿J T
{
¿¿T U
Environment
¿¿U `
.
¿¿` a
MachineName
¿¿a l
}
¿¿l m
"
¿¿m n
)
¿¿n o
;
¿¿o p
}
¡¡ 
if
ƒƒ 
(
ƒƒ 
	exception
ƒƒ 
!=
ƒƒ 
null
ƒƒ !
)
ƒƒ! "
{
≈≈ 
logEntry
∆∆ 
.
∆∆ 

AppendLine
∆∆ #
(
∆∆# $
$"
∆∆$ &
$str
∆∆& 1
{
∆∆1 2
	exception
∆∆2 ;
.
∆∆; <
GetType
∆∆< C
(
∆∆C D
)
∆∆D E
.
∆∆E F
FullName
∆∆F N
}
∆∆N O
$str
∆∆O Q
{
∆∆Q R
	exception
∆∆R [
.
∆∆[ \
Message
∆∆\ c
}
∆∆c d
"
∆∆d e
)
∆∆e f
;
∆∆f g
logEntry
«« 
.
«« 

AppendLine
«« #
(
««# $
$"
««$ &
$str
««& 2
"
««2 3
)
««3 4
;
««4 5
logEntry
»» 
.
»» 

AppendLine
»» #
(
»»# $
	exception
»»$ -
.
»»- .

StackTrace
»». 8
)
»»8 9
;
»»9 :
var
ÀÀ 
innerException
ÀÀ "
=
ÀÀ# $
	exception
ÀÀ% .
.
ÀÀ. /
InnerException
ÀÀ/ =
;
ÀÀ= >
while
ÃÃ 
(
ÃÃ 
innerException
ÃÃ %
!=
ÃÃ& (
null
ÃÃ) -
)
ÃÃ- .
{
ÕÕ 
logEntry
ŒŒ 
.
ŒŒ 

AppendLine
ŒŒ '
(
ŒŒ' (
$"
ŒŒ( *
$str
ŒŒ* ;
{
ŒŒ; <
innerException
ŒŒ< J
.
ŒŒJ K
GetType
ŒŒK R
(
ŒŒR S
)
ŒŒS T
.
ŒŒT U
FullName
ŒŒU ]
}
ŒŒ] ^
$str
ŒŒ^ `
{
ŒŒ` a
innerException
ŒŒa o
.
ŒŒo p
Message
ŒŒp w
}
ŒŒw x
"
ŒŒx y
)
ŒŒy z
;
ŒŒz {
logEntry
œœ 
.
œœ 

AppendLine
œœ '
(
œœ' (
innerException
œœ( 6
.
œœ6 7

StackTrace
œœ7 A
)
œœA B
;
œœB C
innerException
–– "
=
––# $
innerException
––% 3
.
––3 4
InnerException
––4 B
;
––B C
}
—— 
}
““ 
logEntry
‘‘ 
.
‘‘ 

AppendLine
‘‘ 
(
‘‘  
)
‘‘  !
;
‘‘! "
	_logQueue
◊◊ 
.
◊◊ 
Add
◊◊ 
(
◊◊ 
logEntry
◊◊ "
.
◊◊" #
ToString
◊◊# +
(
◊◊+ ,
)
◊◊, -
)
◊◊- .
;
◊◊. /
System
⁄⁄ 
.
⁄⁄ 
Diagnostics
⁄⁄ 
.
⁄⁄ 
Debug
⁄⁄ $
.
⁄⁄$ %
Write
⁄⁄% *
(
⁄⁄* +
logEntry
⁄⁄+ 3
.
⁄⁄3 4
ToString
⁄⁄4 <
(
⁄⁄< =
)
⁄⁄= >
)
⁄⁄> ?
;
⁄⁄? @
}
€€ 	
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹ 
{
›› 	
System
ﬂﬂ 
.
ﬂﬂ 
Diagnostics
ﬂﬂ 
.
ﬂﬂ 
Debug
ﬂﬂ $
.
ﬂﬂ$ %
	WriteLine
ﬂﬂ% .
(
ﬂﬂ. /
$"
ﬂﬂ/ 1
$str
ﬂﬂ1 A
{
ﬂﬂA B
ex
ﬂﬂB D
.
ﬂﬂD E
Message
ﬂﬂE L
}
ﬂﬂL M
"
ﬂﬂM N
)
ﬂﬂN O
;
ﬂﬂO P
System
‡‡ 
.
‡‡ 
Diagnostics
‡‡ 
.
‡‡ 
Debug
‡‡ $
.
‡‡$ %
	WriteLine
‡‡% .
(
‡‡. /
$"
‡‡/ 1
$str
‡‡1 C
{
‡‡C D
message
‡‡D K
}
‡‡K L
"
‡‡L M
)
‡‡M N
;
‡‡N O
}
·· 	
}
‚‚ 
}„„ ıZ
^C:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Database\Service_InforVisual.cs
	namespace

 	%
MTM_Receiving_Application


 #
.

# $
Services

$ ,
.

, -
Database

- 5
{ 
public 

class 
Service_InforVisual $
:% & 
IService_InforVisual' ;
{ 
private 
readonly '
IService_UserSessionManager 4
_sessionManager5 D
;D E
private 
readonly #
IService_LoggingUtility 0
?0 1
_logger2 9
;9 :
private 
readonly 
Dao_InforVisualPO *
_daoPO+ 1
;1 2
private 
readonly 
Dao_InforVisualPart ,
_daoPart- 5
;5 6
private 
const 
string 
DefaultServer *
=+ ,
$str- 5
;5 6
private 
const 
string 
DefaultDatabase ,
=- .
$str/ 6
;6 7
private 
const 
string 
DefaultUsername ,
=- .
$str/ 6
;6 7
private 
const 
string 
DefaultPassword ,
=- .
$str/ 5
;5 6
public 
Service_InforVisual "
(" #'
IService_UserSessionManager '
sessionManager( 6
,6 7
Dao_InforVisualPO 
daoPO #
,# $
Dao_InforVisualPart 
daoPart  '
,' (#
IService_LoggingUtility   #
?  # $
logger  % +
=  , -
null  . 2
)  2 3
{!! 	
_sessionManager"" 
="" 
sessionManager"" ,
??""- /
throw""0 5
new""6 9!
ArgumentNullException"": O
(""O P
nameof""P V
(""V W
sessionManager""W e
)""e f
)""f g
;""g h
_daoPO## 
=## 
daoPO## 
??## 
throw## #
new##$ '!
ArgumentNullException##( =
(##= >
nameof##> D
(##D E
daoPO##E J
)##J K
)##K L
;##L M
_daoPart$$ 
=$$ 
daoPart$$ 
??$$ !
throw$$" '
new$$( +!
ArgumentNullException$$, A
($$A B
nameof$$B H
($$H I
daoPart$$I P
)$$P Q
)$$Q R
;$$R S
_logger%% 
=%% 
logger%% 
;%% 
}&& 	
public++ 
static++ 
string++ (
BuildDefaultConnectionString++ 9
(++9 :
)++: ;
{,, 	
return-- 
$"-- 
$str-- 
{-- 
DefaultServer-- *
}--* +
$str--+ 5
{--5 6
DefaultDatabase--6 E
}--E F
$str--F O
{--O P
DefaultUsername--P _
}--_ `
$str--` j
{--j k
DefaultPassword--k z
}--z {
$str	--{ ≥
"
--≥ ¥
;
--¥ µ
}.. 	
public00 
async00 
Task00 
<00 
Model_Dao_Result00 *
<00* +
Model_InforVisualPO00+ >
?00> ?
>00? @
>00@ A
GetPOWithPartsAsync00B U
(00U V
string00V \
poNumber00] e
)00e f
{11 	
if22 
(22 
string22 
.22 
IsNullOrWhiteSpace22 )
(22) *
poNumber22* 2
)222 3
)223 4
return33 $
Model_Dao_Result_Factory33 /
.33/ 0
Failure330 7
<337 8
Model_InforVisualPO338 K
?33K L
>33L M
(33M N
$str33N q
)33q r
;33r s
string66 
cleanPoNumber66  
=66! "
poNumber66# +
;66+ ,
if77 
(77 
poNumber77 
.77 

StartsWith77 #
(77# $
$str77$ )
,77) *
StringComparison77+ ;
.77; <
OrdinalIgnoreCase77< M
)77M N
)77N O
{88 
cleanPoNumber99 
=99 
poNumber99  (
.99( )
	Substring99) 2
(992 3
$num993 4
)994 5
;995 6
}:: 
_logger== 
?== 
.== 
LogInfo== 
(== 
$"== 
$str== Q
{==Q R
poNumber==R Z
}==Z [
$str==[ d
{==d e
cleanPoNumber==e r
}==r s
$str==s t
"==t u
)==u v
;==v w
var>> 
debugPO>> 
=>> 
new>> 
Model_InforVisualPO>> 1
{?? 
PONumber@@ 
=@@ 
cleanPoNumber@@ (
,@@( )
VendorAA 
=AA 
$strAA '
,AA' (
StatusBB 
=BB 
$strBB 
,BB 
PartsCC 
=CC 
newCC 
ListCC  
<CC  !!
Model_InforVisualPartCC! 6
>CC6 7
{DD 
newEE !
Model_InforVisualPartEE -
{FF 
PartIDGG 
=GG  
$strGG! 1
,GG1 2
POLineNumberHH $
=HH% &
$strHH' *
,HH* +
PartTypeII  
=II! "
$strII# (
,II( )

QtyOrderedJJ "
=JJ# $
$numJJ% (
,JJ( )
DescriptionKK #
=KK$ %
$strKK& @
,KK@ A
RemainingQuantityLL )
=LL* +
$numLL, .
}MM 
,MM 
newNN !
Model_InforVisualPartNN -
{OO 
PartIDPP 
=PP  
$strPP! 1
,PP1 2
POLineNumberQQ $
=QQ% &
$strQQ' *
,QQ* +
PartTypeRR  
=RR! "
$strRR# '
,RR' (

QtyOrderedSS "
=SS# $
$numSS% '
,SS' (
DescriptionTT #
=TT$ %
$strTT& @
,TT@ A
RemainingQuantityUU )
=UU* +
$numUU, .
}VV 
}WW 
}XX 
;XX 
returnYY $
Model_Dao_Result_FactoryYY +
.YY+ ,
SuccessYY, 3
<YY3 4
Model_InforVisualPOYY4 G
?YYG H
>YYH I
(YYI J
debugPOYYJ Q
)YYQ R
;YYR S
}vv 	
publicxx 
asyncxx 
Taskxx 
<xx 
Model_Dao_Resultxx *
<xx* +!
Model_InforVisualPartxx+ @
?xx@ A
>xxA B
>xxB C
GetPartByIDAsyncxxD T
(xxT U
stringxxU [
partIDxx\ b
)xxb c
{yy 	
ifzz 
(zz 
stringzz 
.zz 
IsNullOrWhiteSpacezz )
(zz) *
partIDzz* 0
)zz0 1
)zz1 2
return{{ $
Model_Dao_Result_Factory{{ /
.{{/ 0
Failure{{0 7
<{{7 8!
Model_InforVisualPart{{8 M
?{{M N
>{{N O
({{O P
$str{{P q
){{q r
;{{r s
_logger~~ 
?~~ 
.~~ 
LogInfo~~ 
(~~ 
$"~~ 
$str~~ S
{~~S T
partID~~T Z
}~~Z [
"~~[ \
)~~\ ]
;~~] ^
var 
	debugPart 
= 
new !
Model_InforVisualPart  5
{
ÄÄ 
PartID
ÅÅ 
=
ÅÅ 
partID
ÅÅ 
,
ÅÅ  
PartType
ÇÇ 
=
ÇÇ 
$str
ÇÇ '
,
ÇÇ' (
Description
ÉÉ 
=
ÉÉ 
$str
ÉÉ 6
,
ÉÉ6 7
POLineNumber
ÑÑ 
=
ÑÑ 
$str
ÑÑ $
,
ÑÑ$ %

QtyOrdered
ÖÖ 
=
ÖÖ 
$num
ÖÖ 
}
ÜÜ 
;
ÜÜ 
return
áá &
Model_Dao_Result_Factory
áá +
.
áá+ ,
Success
áá, 3
<
áá3 4#
Model_InforVisualPart
áá4 I
?
ááI J
>
ááJ K
(
ááK L
	debugPart
ááL U
)
ááU V
;
ááV W
}
§§ 	
public
¶¶ 
async
¶¶ 
Task
¶¶ 
<
¶¶ 
Model_Dao_Result
¶¶ *
<
¶¶* +
decimal
¶¶+ 2
>
¶¶2 3
>
¶¶3 4.
 GetSameDayReceivingQuantityAsync
¶¶5 U
(
¶¶U V
string
¶¶V \
poNumber
¶¶] e
,
¶¶e f
string
¶¶g m
partID
¶¶n t
,
¶¶t u
DateTime
¶¶v ~
date¶¶ É
)¶¶É Ñ
{
ßß 	
_logger
©© 
?
©© 
.
©© 
LogInfo
©© 
(
©© 
$"
©© 
$str
©© d
{
©©d e
poNumber
©©e m
}
©©m n
$str
©©n v
{
©©v w
partID
©©w }
}
©©} ~
"
©©~ 
)©© Ä
;©©Ä Å
return
™™ &
Model_Dao_Result_Factory
™™ +
.
™™+ ,
Success
™™, 3
<
™™3 4
decimal
™™4 ;
>
™™; <
(
™™< =
$num
™™= >
)
™™> ?
;
™™? @
}
√√ 	
public
≈≈ 
async
≈≈ 
Task
≈≈ 
<
≈≈ 
Model_Dao_Result
≈≈ *
<
≈≈* +
int
≈≈+ .
>
≈≈. /
>
≈≈/ 0'
GetRemainingQuantityAsync
≈≈1 J
(
≈≈J K
string
≈≈K Q
poNumber
≈≈R Z
,
≈≈Z [
string
≈≈\ b
partID
≈≈c i
)
≈≈i j
{
∆∆ 	
if
«« 
(
«« 
string
«« 
.
««  
IsNullOrWhiteSpace
«« )
(
««) *
poNumber
««* 2
)
««2 3
)
««3 4
return
»» &
Model_Dao_Result_Factory
»» /
.
»»/ 0
Failure
»»0 7
<
»»7 8
int
»»8 ;
>
»»; <
(
»»< =
$str
»»= `
)
»»` a
;
»»a b
if
   
(
   
string
   
.
    
IsNullOrWhiteSpace
   )
(
  ) *
partID
  * 0
)
  0 1
)
  1 2
return
ÀÀ &
Model_Dao_Result_Factory
ÀÀ /
.
ÀÀ/ 0
Failure
ÀÀ0 7
<
ÀÀ7 8
int
ÀÀ8 ;
>
ÀÀ; <
(
ÀÀ< =
$str
ÀÀ= ^
)
ÀÀ^ _
;
ÀÀ_ `
_logger
ŒŒ 
?
ŒŒ 
.
ŒŒ 
LogInfo
ŒŒ 
(
ŒŒ 
$"
ŒŒ 
$str
ŒŒ d
{
ŒŒd e
poNumber
ŒŒe m
}
ŒŒm n
$str
ŒŒn v
{
ŒŒv w
partID
ŒŒw }
}
ŒŒ} ~
"
ŒŒ~ 
)ŒŒ Ä
;ŒŒÄ Å
return
œœ &
Model_Dao_Result_Factory
œœ +
.
œœ+ ,
Success
œœ, 3
<
œœ3 4
int
œœ4 7
>
œœ7 8
(
œœ8 9
$num
œœ9 <
)
œœ< =
;
œœ= >
}
ËË 	
public
ÍÍ 
async
ÍÍ 
Task
ÍÍ 
<
ÍÍ 
bool
ÍÍ 
>
ÍÍ !
TestConnectionAsync
ÍÍ  3
(
ÍÍ3 4
)
ÍÍ4 5
{
ÎÎ 	
_logger
ÌÌ 
?
ÌÌ 
.
ÌÌ 
LogInfo
ÌÌ 
(
ÌÌ 
$str
ÌÌ R
)
ÌÌR S
;
ÌÌS T
return
ÓÓ 
true
ÓÓ 
;
ÓÓ 
}
ää 	
}
ãã 
}åå îD
_C:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Database\Service_ErrorHandler.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Services		$ ,
.		, -
Database		- 5
;		5 6
public 
class  
Service_ErrorHandler !
:" #!
IService_ErrorHandler$ 9
{ 
private 
readonly #
IService_LoggingUtility ,
_loggingService- <
;< =
private 
readonly 
IService_Window $
_windowService% 3
;3 4
public 
 
Service_ErrorHandler 
(  #
IService_LoggingUtility  7
loggingService8 F
,F G
IService_WindowH W
windowServiceX e
)e f
{ 
_loggingService 
= 
loggingService (
??) +
throw, 1
new2 5!
ArgumentNullException6 K
(K L
nameofL R
(R S
loggingServiceS a
)a b
)b c
;c d
_windowService 
= 
windowService &
??' )
throw* /
new0 3!
ArgumentNullException4 I
(I J
nameofJ P
(P Q
windowServiceQ ^
)^ _
)_ `
;` a
} 
public 

async 
Task 
HandleErrorAsync &
(& '
string 
errorMessage 
, 
Enum_ErrorSeverity 
severity #
,# $
	Exception   
?   
	exception   
=   
null   #
,  # $
bool!! 

showDialog!! 
=!! 
true!! 
)!! 
{"" 
await$$ 
LogErrorAsync$$ 
($$ 
errorMessage$$ (
,$$( )
severity$$* 2
,$$2 3
	exception$$4 =
)$$= >
;$$> ?
if'' 

('' 

showDialog'' 
)'' 
{(( 	
string)) 
title)) 
=)) 
GetDialogTitle)) )
())) *
severity))* 2
)))2 3
;))3 4
await**  
ShowErrorDialogAsync** &
(**& '
title**' ,
,**, -
errorMessage**. :
,**: ;
severity**< D
)**D E
;**E F
}++ 	
},, 
public11 

Task11 
LogErrorAsync11 
(11 
string22 
errorMessage22 
,22 
Enum_ErrorSeverity33 
severity33 #
,33# $
	Exception44 
?44 
	exception44 
=44 
null44 #
)44# $
{55 
return66 
Task66 
.66 
Run66 
(66 
(66 
)66 
=>66 
{77 	
switch88 
(88 
severity88 
)88 
{99 
case:: 
Enum_ErrorSeverity:: '
.::' (
Info::( ,
:::, -
_loggingService;; #
.;;# $
LogInfo;;$ +
(;;+ ,
errorMessage;;, 8
);;8 9
;;;9 :
break<< 
;<< 
case== 
Enum_ErrorSeverity== '
.==' (
Warning==( /
:==/ 0
_loggingService>> #
.>># $

LogWarning>>$ .
(>>. /
errorMessage>>/ ;
)>>; <
;>>< =
break?? 
;?? 
case@@ 
Enum_ErrorSeverity@@ '
.@@' (
Error@@( -
:@@- .
_loggingServiceAA #
.AA# $
LogErrorAA$ ,
(AA, -
errorMessageAA- 9
,AA9 :
	exceptionAA; D
)AAD E
;AAE F
breakBB 
;BB 
caseCC 
Enum_ErrorSeverityCC '
.CC' (
CriticalCC( 0
:CC0 1
_loggingServiceDD #
.DD# $
LogCriticalDD$ /
(DD/ 0
errorMessageDD0 <
,DD< =
	exceptionDD> G
)DDG H
;DDH I
breakEE 
;EE 
caseFF 
Enum_ErrorSeverityFF '
.FF' (
FatalFF( -
:FF- .
_loggingServiceGG #
.GG# $
LogFatalGG$ ,
(GG, -
errorMessageGG- 9
,GG9 :
	exceptionGG; D
)GGD E
;GGE F
breakHH 
;HH 
}II 
}JJ 	
)JJ	 

;JJ
 
}KK 
publicPP 

asyncPP 
TaskPP  
ShowErrorDialogAsyncPP *
(PP* +
stringQQ 
titleQQ 
,QQ 
stringRR 
messageRR 
,RR 
Enum_ErrorSeveritySS 
severitySS #
)SS# $
{TT 
tryUU 
{VV 	
varcc 
xamlRootcc 
=cc 
_windowServicecc )
.cc) *
GetXamlRootcc* 5
(cc5 6
)cc6 7
;cc7 8
ifee 
(ee 
xamlRootee 
==ee 
nullee  
)ee  !
{ff 
_loggingServicehh 
.hh  

LogWarninghh  *
(hh* +
$strhh+ R
)hhR S
;hhS T
returnii 
;ii 
}jj 
varll 
dialogll 
=ll 
newll 
ContentDialogll *
{mm 
Titlenn 
=nn 
titlenn 
,nn 
Contentoo 
=oo 
messageoo !
,oo! "
CloseButtonTextpp 
=pp  !
$strpp" &
,pp& '
XamlRootqq 
=qq 
xamlRootqq #
}rr 
;rr 
awaitvv 
dialogvv 
.vv 
	ShowAsyncvv "
(vv" #
)vv# $
;vv$ %
}ww 	
catchxx 
(xx 
	Exceptionxx 
exxx 
)xx 
{yy 	
_loggingService{{ 
.{{ 
LogError{{ $
({{$ %
$"{{% '
$str{{' D
{{{D E
ex{{E G
.{{G H
Message{{H O
}{{O P
"{{P Q
,{{Q R
ex{{S U
){{U V
;{{V W
}|| 	
}}} 
public
ÇÇ 

async
ÇÇ 
Task
ÇÇ !
HandleDaoErrorAsync
ÇÇ )
(
ÇÇ) *
Model_Dao_Result
ÉÉ 
result
ÉÉ 
,
ÉÉ  
string
ÑÑ 
operationName
ÑÑ 
,
ÑÑ 
bool
ÖÖ 

showDialog
ÖÖ 
=
ÖÖ 
true
ÖÖ 
)
ÖÖ 
{
ÜÜ 
if
áá 

(
áá 
result
áá 
.
áá 
Success
áá 
)
áá 
{
àà 	
return
ää 
;
ää 
}
ãã 	
string
çç 
errorMessage
çç 
=
çç 
$"
çç  
$str
çç  4
{
çç4 5
operationName
çç5 B
}
ççB C
$str
ççC M
{
ççM N
result
ççN T
.
ççT U
ErrorMessage
ççU a
}
çça b
"
ççb c
;
ççc d
await
èè 
HandleErrorAsync
èè 
(
èè 
errorMessage
êê 
,
êê 
result
ëë 
.
ëë 
Severity
ëë 
,
ëë 
	exception
íí 
:
íí 
null
íí 
,
íí 

showDialog
ìì 
:
ìì 

showDialog
ìì "
)
îî 	
;
îî	 

}
ïï 
private
öö 
static
öö 
string
öö 
GetDialogTitle
öö (
(
öö( ) 
Enum_ErrorSeverity
öö) ;
severity
öö< D
)
ööD E
{
õõ 
return
úú 
severity
úú 
switch
úú 
{
ùù 	 
Enum_ErrorSeverity
ûû 
.
ûû 
Info
ûû #
=>
ûû$ &
$str
ûû' 4
,
ûû4 5 
Enum_ErrorSeverity
üü 
.
üü 
Warning
üü &
=>
üü' )
$str
üü* 3
,
üü3 4 
Enum_ErrorSeverity
†† 
.
†† 
Error
†† $
=>
††% '
$str
††( /
,
††/ 0 
Enum_ErrorSeverity
°° 
.
°° 
Critical
°° '
=>
°°( *
$str
°°+ ;
,
°°; < 
Enum_ErrorSeverity
¢¢ 
.
¢¢ 
Fatal
¢¢ $
=>
¢¢% '
$str
¢¢( 5
,
¢¢5 6
_
££ 
=>
££ 
$str
££ 
}
§§ 	
;
§§	 

}
•• 
}¶¶ ÍT
kC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Authentication\Service_UserSessionManager.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
., -
Authentication- ;
{ 
public 

class &
Service_UserSessionManager +
:, -'
IService_UserSessionManager. I
{ 
private 
readonly 
Dao_User !
_daoUser" *
;* +
private 
readonly 
IService_Dispatcher ,
_dispatcherService- ?
;? @
private $
IService_DispatcherTimer (
?( )
_timeoutTimer* 7
;7 8
private 
const 
int  
TimerIntervalSeconds .
=/ 0
$num1 3
;3 4
public &
Service_UserSessionManager )
() *
Dao_User* 2
daoUser3 :
,: ;
IService_Dispatcher< O
dispatcherServiceP a
)a b
{ 	
_daoUser 
= 
daoUser 
?? !
throw" '
new( +!
ArgumentNullException, A
(A B
nameofB H
(H I
daoUserI P
)P Q
)Q R
;R S
_dispatcherService 
=  
dispatcherService! 2
??3 5
throw6 ;
new< ?!
ArgumentNullException@ U
(U V
nameofV \
(\ ]
dispatcherService] n
)n o
)o p
;p q
} 	
public$$ 
Model_UserSession$$  
?$$  !
CurrentSession$$" 0
{$$1 2
get$$3 6
;$$6 7
private$$8 ?
set$$@ C
;$$C D
}$$E F
public++ 
Model_UserSession++  
CreateSession++! .
(++. /

Model_User,, 
user,, 
,,, #
Model_WorkstationConfig-- #
workstationConfig--$ 5
,--5 6
string..  
authenticationMethod.. '
)..' (
{// 	
if00 
(00 
user00 
==00 
null00 
)00 
throw00 #
new00$ '!
ArgumentNullException00( =
(00= >
nameof00> D
(00D E
user00E I
)00I J
)00J K
;00K L
if11 
(11 
workstationConfig11 !
==11" $
null11% )
)11) *
throw11+ 0
new111 4!
ArgumentNullException115 J
(11J K
nameof11K Q
(11Q R
workstationConfig11R c
)11c d
)11d e
;11e f
CurrentSession33 
=33 
new33  
Model_UserSession33! 2
{44 
User55 
=55 
user55 
,55 
WorkstationName66 
=66  !
workstationConfig66" 3
.663 4
ComputerName664 @
,66@ A
WorkstationType77 
=77  !
workstationConfig77" 3
.773 4
WorkstationType774 C
,77C D 
AuthenticationMethod88 $
=88% & 
authenticationMethod88' ;
,88; <
LoginTimestamp99 
=99  
DateTime99! )
.99) *
Now99* -
,99- .!
LastActivityTimestamp:: %
=::& '
DateTime::( 0
.::0 1
Now::1 4
,::4 5
TimeoutDuration;; 
=;;  !
workstationConfig;;" 3
.;;3 4
TimeoutDuration;;4 C
}<< 
;<< 
return>> 
CurrentSession>> !
;>>! "
}?? 	
publicBB 
voidBB 
UpdateLastActivityBB &
(BB& '
)BB' (
{CC 	
ifDD 
(DD 
CurrentSessionDD 
!=DD !
nullDD" &
)DD& '
{EE 
CurrentSessionFF 
.FF 
UpdateLastActivityFF 1
(FF1 2
)FF2 3
;FF3 4
}GG 
}HH 	
publicOO 
voidOO "
StartTimeoutMonitoringOO *
(OO* +
)OO+ ,
{PP 	
ifQQ 
(QQ 
CurrentSessionQQ 
==QQ !
nullQQ" &
)QQ& '
{RR 
throwSS 
newSS %
InvalidOperationExceptionSS 3
(SS3 4
$strSS4 o
)SSo p
;SSp q
}TT !
StopTimeoutMonitoringWW !
(WW! "
)WW" #
;WW# $
_timeoutTimerZZ 
=ZZ 
_dispatcherServiceZZ .
.ZZ. /
CreateTimerZZ/ :
(ZZ: ;
)ZZ; <
;ZZ< =
_timeoutTimer[[ 
.[[ 
Interval[[ "
=[[# $
TimeSpan[[% -
.[[- .
FromSeconds[[. 9
([[9 : 
TimerIntervalSeconds[[: N
)[[N O
;[[O P
_timeoutTimer\\ 
.\\ 
IsRepeating\\ %
=\\& '
true\\( ,
;\\, -
_timeoutTimer]] 
.]] 
Tick]] 
+=]] !
OnTimerTick]]" -
;]]- .
_timeoutTimer^^ 
.^^ 
Start^^ 
(^^  
)^^  !
;^^! "
System`` 
.`` 
Diagnostics`` 
.`` 
Debug`` $
.``$ %
	WriteLine``% .
(``. /
$"``/ 1
$str``1 ^
{``^ _
CurrentSession``_ m
.``m n
TimeoutDuration``n }
.``} ~
TotalMinutes	``~ ä
}
``ä ã
$str
``ã ì
"
``ì î
)
``î ï
;
``ï ñ
}aa 	
publicdd 
voiddd !
StopTimeoutMonitoringdd )
(dd) *
)dd* +
{ee 	
ifff 
(ff 
_timeoutTimerff 
!=ff  
nullff! %
)ff% &
{gg 
_timeoutTimerhh 
.hh 
Stophh "
(hh" #
)hh# $
;hh$ %
_timeoutTimerii 
.ii 
Tickii "
-=ii# %
OnTimerTickii& 1
;ii1 2
_timeoutTimerjj 
=jj 
nulljj  $
;jj$ %
Systemll 
.ll 
Diagnosticsll "
.ll" #
Debugll# (
.ll( )
	WriteLinell) 2
(ll2 3
$strll3 W
)llW X
;llX Y
}mm 
}nn 	
publicqq 
boolqq 
IsSessionTimedOutqq %
(qq% &
)qq& '
{rr 	
returnss 
CurrentSessionss !
?ss! "
.ss" #

IsTimedOutss# -
??ss. 0
falsess1 6
;ss6 7
}tt 	
publicww 
asyncww 
Taskww 
EndSessionAsyncww )
(ww) *
stringww* 0
reasonww1 7
)ww7 8
{xx 	
ifyy 
(yy 
CurrentSessionyy 
==yy !
nullyy" &
)yy& '
returnyy( .
;yy. /
try{{ 
{|| 
await~~ 
_daoUser~~ 
.~~  
LogUserActivityAsync~~ 3
(~~3 4
reason 
, 
CurrentSession
ÄÄ "
.
ÄÄ" #
User
ÄÄ# '
.
ÄÄ' (
WindowsUsername
ÄÄ( 7
,
ÄÄ7 8
CurrentSession
ÅÅ "
.
ÅÅ" #
WorkstationName
ÅÅ# 2
,
ÅÅ2 3
$"
ÇÇ 
$str
ÇÇ /
{
ÇÇ/ 0
(
ÇÇ0 1
DateTime
ÇÇ1 9
.
ÇÇ9 :
Now
ÇÇ: =
-
ÇÇ> ?
CurrentSession
ÇÇ@ N
.
ÇÇN O
LoginTimestamp
ÇÇO ]
)
ÇÇ] ^
.
ÇÇ^ _
TotalMinutes
ÇÇ_ k
:
ÇÇk l
$str
ÇÇl n
}
ÇÇn o
$str
ÇÇo w
"
ÇÇw x
)
ÇÇx y
;
ÇÇy z
System
ÑÑ 
.
ÑÑ 
Diagnostics
ÑÑ "
.
ÑÑ" #
Debug
ÑÑ# (
.
ÑÑ( )
	WriteLine
ÑÑ) 2
(
ÑÑ2 3
$"
ÑÑ3 5
$str
ÑÑ5 L
{
ÑÑL M
reason
ÑÑM S
}
ÑÑS T
"
ÑÑT U
)
ÑÑU V
;
ÑÑV W
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
áá 
System
àà 
.
àà 
Diagnostics
àà "
.
àà" #
Debug
àà# (
.
àà( )
	WriteLine
àà) 2
(
àà2 3
$"
àà3 5
$str
àà5 P
{
ààP Q
ex
ààQ S
.
ààS T
Message
ààT [
}
àà[ \
"
àà\ ]
)
àà] ^
;
àà^ _
}
ââ 
finally
ää 
{
ãã #
StopTimeoutMonitoring
çç %
(
çç% &
)
çç& '
;
çç' (
CurrentSession
éé 
=
éé  
null
éé! %
;
éé% &
}
èè 
}
êê 	
public
óó 
event
óó 
EventHandler
óó !
<
óó! "&
SessionTimedOutEventArgs
óó" :
>
óó: ;
?
óó; <
SessionTimedOut
óó= L
;
óóL M
private
†† 
void
†† 
OnTimerTick
††  
(
††  !
object
††! '
?
††' (
sender
††) /
,
††/ 0
object
††1 7
args
††8 <
)
††< =
{
°° 	
if
¢¢ 
(
¢¢ 
CurrentSession
¢¢ 
==
¢¢ !
null
¢¢" &
)
¢¢& '
return
¢¢( .
;
¢¢. /
if
§§ 
(
§§ 
IsSessionTimedOut
§§ !
(
§§! "
)
§§" #
)
§§# $
{
•• 
System
¶¶ 
.
¶¶ 
Diagnostics
¶¶ "
.
¶¶" #
Debug
¶¶# (
.
¶¶( )
	WriteLine
¶¶) 2
(
¶¶2 3
$"
ßß 
$str
ßß ;
{
ßß; <
CurrentSession
ßß< J
.
ßßJ K#
TimeSinceLastActivity
ßßK `
.
ßß` a
TotalMinutes
ßßa m
:
ßßm n
$str
ßßn p
}
ßßp q
$str
ßßq y
"
ßßy z
)
ßßz {
;
ßß{ |
SessionTimedOut
™™ 
?
™™  
.
™™  !
Invoke
™™! '
(
™™' (
this
™™( ,
,
™™, -
new
™™. 1&
SessionTimedOutEventArgs
™™2 J
{
´´ 
Session
¨¨ 
=
¨¨ 
CurrentSession
¨¨ ,
,
¨¨, -
IdleDuration
≠≠  
=
≠≠! "
CurrentSession
≠≠# 1
.
≠≠1 2#
TimeSinceLastActivity
≠≠2 G
}
ÆÆ 
)
ÆÆ 
;
ÆÆ #
StopTimeoutMonitoring
±± %
(
±±% &
)
±±& '
;
±±' (
}
≤≤ 
}
≥≥ 	
}
¥¥ 
}µµ øÀ
gC:\Users\johnk\source\repos\MTM_Receiving_Application\Services\Authentication\Service_Authentication.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Services$ ,
., -
Authentication- ;
{ 
public 

class "
Service_Authentication '
:( )#
IService_Authentication* A
{ 
private 
readonly 
Dao_User !
_daoUser" *
;* +
private 
readonly !
IService_ErrorHandler .
_errorHandler/ <
;< =
public "
Service_Authentication %
(% &
Dao_User& .
daoUser/ 6
,6 7!
IService_ErrorHandler8 M
errorHandlerN Z
)Z [
{ 	
_daoUser 
= 
daoUser 
?? !
throw" '
new( +!
ArgumentNullException, A
(A B
nameofB H
(H I
daoUserI P
)P Q
)Q R
;R S
_errorHandler 
= 
errorHandler (
??) +
throw, 1
new2 5!
ArgumentNullException6 K
(K L
nameofL R
(R S
errorHandlerS _
)_ `
)` a
;a b
} 	
public&& 
async&& 
Task&& 
<&&  
AuthenticationResult&& .
>&&. /.
"AuthenticateByWindowsUsernameAsync&&0 R
(&&R S
string'' 
windowsUsername'' "
,''" #
	IProgress(( 
<(( 
string(( 
>(( 
?(( 
progress(( '
=((( )
null((* .
)((. /
{)) 	
try** 
{++ 
progress,, 
?,, 
.,, 
Report,,  
(,,  !
$str,,! A
),,A B
;,,B C
if// 
(// 
string// 
.// 
IsNullOrWhiteSpace// -
(//- .
windowsUsername//. =
)//= >
)//> ?
{00 
return11  
AuthenticationResult11 /
.11/ 0
ErrorResult110 ;
(11; <
$str11< Z
)11Z [
;11[ \
}22 
var55 
result55 
=55 
await55 "
_daoUser55# +
.55+ ,)
GetUserByWindowsUsernameAsync55, I
(55I J
windowsUsername55J Y
)55Y Z
;55Z [
if77 
(77 
!77 
result77 
.77 
Success77 #
)77# $
{88 
progress99 
?99 
.99 
Report99 $
(99$ %
$str99% A
)99A B
;99B C
return::  
AuthenticationResult:: /
.::/ 0
ErrorResult::0 ;
(::; <
result::< B
.::B C
ErrorMessage::C O
)::O P
;::P Q
};; 
if== 
(== 
result== 
.== 
Data== 
====  "
null==# '
)==' (
{>> 
return??  
AuthenticationResult?? /
.??/ 0
ErrorResult??0 ;
(??; <
$str??< R
)??R S
;??S T
}@@ 
awaitCC  
LogUserActivityAsyncCC *
(CC* +
$strDD #
,DD# $
windowsUsernameEE #
,EE# $
EnvironmentFF 
.FF  
MachineNameFF  +
,FF+ ,
$strGG 7
)GG7 8
;GG8 9
progressII 
?II 
.II 
ReportII  
(II  !
$"II! #
$strII# ,
{II, -
resultII- 3
.II3 4
DataII4 8
.II8 9
FullNameII9 A
}IIA B
"IIB C
)IIC D
;IID E
returnJJ  
AuthenticationResultJJ +
.JJ+ ,
SuccessResultJJ, 9
(JJ9 :
resultJJ: @
.JJ@ A
DataJJA E
)JJE F
;JJF G
}KK 
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL  
{MM 
ifNN 
(NN 
_errorHandlerNN !
!=NN" $
nullNN% )
)NN) *
awaitOO 
_errorHandlerOO '
.OO' (
HandleErrorAsyncOO( 8
(OO8 9
$strOO9 d
,OOd e
Enum_ErrorSeverityOOf x
.OOx y
ErrorOOy ~
,OO~ 
ex
OOÄ Ç
,
OOÇ É
false
OOÑ â
)
OOâ ä
;
OOä ã
returnPP  
AuthenticationResultPP +
.PP+ ,
ErrorResultPP, 7
(PP7 8
$"PP8 :
$strPP: P
{PPP Q
exPPQ S
.PPS T
MessagePPT [
}PP[ \
"PP\ ]
)PP] ^
;PP^ _
}QQ 
}RR 	
publicUU 
asyncUU 
TaskUU 
<UU  
AuthenticationResultUU .
>UU. /"
AuthenticateByPinAsyncUU0 F
(UUF G
stringVV 
usernameVV 
,VV 
stringWW 
pinWW 
,WW 
	IProgressXX 
<XX 
stringXX 
>XX 
?XX 
progressXX '
=XX( )
nullXX* .
)XX. /
{YY 	
tryZZ 
{[[ 
progress\\ 
?\\ 
.\\ 
Report\\  
(\\  !
$str\\! <
)\\< =
;\\= >
if__ 
(__ 
string__ 
.__ 
IsNullOrWhiteSpace__ -
(__- .
username__. 6
)__6 7
)__7 8
{`` 
returnaa  
AuthenticationResultaa /
.aa/ 0
ErrorResultaa0 ;
(aa; <
$straa< R
)aaR S
;aaS T
}bb 
ifdd 
(dd 
stringdd 
.dd 
IsNullOrWhiteSpacedd -
(dd- .
pindd. 1
)dd1 2
)dd2 3
{ee 
returnff  
AuthenticationResultff /
.ff/ 0
ErrorResultff0 ;
(ff; <
$strff< M
)ffM N
;ffN O
}gg 
ifjj 
(jj 
pinjj 
.jj 
Lengthjj 
!=jj !
$numjj" #
||jj$ &
!jj' (
pinjj( +
.jj+ ,
Alljj, /
(jj/ 0
charjj0 4
.jj4 5
IsDigitjj5 <
)jj< =
)jj= >
{kk 
returnll  
AuthenticationResultll /
.ll/ 0
ErrorResultll0 ;
(ll; <
$strll< b
)llb c
;llc d
}mm 
varpp 
resultpp 
=pp 
awaitpp "
_daoUserpp# +
.pp+ , 
ValidateUserPinAsyncpp, @
(pp@ A
usernameppA I
,ppI J
pinppK N
)ppN O
;ppO P
ifrr 
(rr 
!rr 
resultrr 
.rr 
Successrr #
||rr$ &
resultrr' -
.rr- .
Datarr. 2
==rr3 5
nullrr6 :
)rr: ;
{ss 
awaituu  
LogUserActivityAsyncuu .
(uu. /
$strvv &
,vv& '
usernameww  
,ww  !
Environmentxx #
.xx# $
MachineNamexx$ /
,xx/ 0
$"yy 
$stryy 8
{yy8 9
usernameyy9 A
}yyA B
"yyB C
)yyC D
;yyD E
progress{{ 
?{{ 
.{{ 
Report{{ $
({{$ %
$str{{% >
){{> ?
;{{? @
return||  
AuthenticationResult|| /
.||/ 0
ErrorResult||0 ;
(||; <
$str||< U
)||U V
;||V W
}}} 
await
ÄÄ "
LogUserActivityAsync
ÄÄ *
(
ÄÄ* +
$str
ÅÅ #
,
ÅÅ# $
result
ÇÇ 
.
ÇÇ 
Data
ÇÇ 
.
ÇÇ  
WindowsUsername
ÇÇ  /
,
ÇÇ/ 0
Environment
ÉÉ 
.
ÉÉ  
MachineName
ÉÉ  +
,
ÉÉ+ ,
$"
ÑÑ 
$str
ÑÑ 8
{
ÑÑ8 9
result
ÑÑ9 ?
.
ÑÑ? @
Data
ÑÑ@ D
.
ÑÑD E
FullName
ÑÑE M
}
ÑÑM N
"
ÑÑN O
)
ÑÑO P
;
ÑÑP Q
progress
ÜÜ 
?
ÜÜ 
.
ÜÜ 
Report
ÜÜ  
(
ÜÜ  !
$"
ÜÜ! #
$str
ÜÜ# ,
{
ÜÜ, -
result
ÜÜ- 3
.
ÜÜ3 4
Data
ÜÜ4 8
.
ÜÜ8 9
FullName
ÜÜ9 A
}
ÜÜA B
"
ÜÜB C
)
ÜÜC D
;
ÜÜD E
return
áá "
AuthenticationResult
áá +
.
áá+ ,
SuccessResult
áá, 9
(
áá9 :
result
áá: @
.
áá@ A
Data
ááA E
)
ááE F
;
ááF G
}
àà 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ää 
if
ãã 
(
ãã 
_errorHandler
ãã !
!=
ãã" $
null
ãã% )
)
ãã) *
await
åå 
_errorHandler
åå '
.
åå' (
HandleErrorAsync
åå( 8
(
åå8 9
$str
åå9 W
,
ååW X 
Enum_ErrorSeverity
ååY k
.
ååk l
Error
åål q
,
ååq r
ex
åås u
,
ååu v
false
ååw |
)
åå| }
;
åå} ~
return
çç "
AuthenticationResult
çç +
.
çç+ ,
ErrorResult
çç, 7
(
çç7 8
$"
çç8 :
$str
çç: P
{
ççP Q
ex
ççQ S
.
ççS T
Message
ççT [
}
çç[ \
"
çç\ ]
)
çç] ^
;
çç^ _
}
éé 
}
èè 	
public
ññ 
async
ññ 
Task
ññ 
<
ññ 
CreateUserResult
ññ *
>
ññ* + 
CreateNewUserAsync
ññ, >
(
ññ> ?

Model_User
óó 
user
óó 
,
óó 
string
òò 
	createdBy
òò 
,
òò 
	IProgress
ôô 
<
ôô 
string
ôô 
>
ôô 
?
ôô 
progress
ôô '
=
ôô( )
null
ôô* .
)
ôô. /
{
öö 	
try
õõ 
{
úú 
progress
ùù 
?
ùù 
.
ùù 
Report
ùù  
(
ùù  !
$str
ùù! :
)
ùù: ;
;
ùù; <
if
†† 
(
†† 
string
†† 
.
††  
IsNullOrWhiteSpace
†† -
(
††- .
user
††. 2
.
††2 3
WindowsUsername
††3 B
)
††B C
)
††C D
{
°° 
return
¢¢ 
CreateUserResult
¢¢ +
.
¢¢+ ,
ErrorResult
¢¢, 7
(
¢¢7 8
$str
¢¢8 V
)
¢¢V W
;
¢¢W X
}
££ 
if
•• 
(
•• 
string
•• 
.
••  
IsNullOrWhiteSpace
•• -
(
••- .
user
••. 2
.
••2 3
FullName
••3 ;
)
••; <
)
••< =
{
¶¶ 
return
ßß 
CreateUserResult
ßß +
.
ßß+ ,
ErrorResult
ßß, 7
(
ßß7 8
$str
ßß8 O
)
ßßO P
;
ßßP Q
}
®® 
if
™™ 
(
™™ 
string
™™ 
.
™™  
IsNullOrWhiteSpace
™™ -
(
™™- .
user
™™. 2
.
™™2 3

Department
™™3 =
)
™™= >
)
™™> ?
{
´´ 
return
¨¨ 
CreateUserResult
¨¨ +
.
¨¨+ ,
ErrorResult
¨¨, 7
(
¨¨7 8
$str
¨¨8 P
)
¨¨P Q
;
¨¨Q R
}
≠≠ 
if
ØØ 
(
ØØ 
string
ØØ 
.
ØØ  
IsNullOrWhiteSpace
ØØ -
(
ØØ- .
user
ØØ. 2
.
ØØ2 3
Shift
ØØ3 8
)
ØØ8 9
)
ØØ9 :
{
∞∞ 
return
±± 
CreateUserResult
±± +
.
±±+ ,
ErrorResult
±±, 7
(
±±7 8
$str
±±8 K
)
±±K L
;
±±L M
}
≤≤ 
var
µµ 
pinValidation
µµ !
=
µµ" #
await
µµ$ )
ValidatePinAsync
µµ* :
(
µµ: ;
user
µµ; ?
.
µµ? @
Pin
µµ@ C
)
µµC D
;
µµD E
if
∂∂ 
(
∂∂ 
!
∂∂ 
pinValidation
∂∂ "
.
∂∂" #
IsValid
∂∂# *
)
∂∂* +
{
∑∑ 
return
∏∏ 
CreateUserResult
∏∏ +
.
∏∏+ ,
ErrorResult
∏∏, 7
(
∏∏7 8
pinValidation
∏∏8 E
.
∏∏E F
ErrorMessage
∏∏F R
)
∏∏R S
;
∏∏S T
}
ππ 
progress
ªª 
?
ªª 
.
ªª 
Report
ªª  
(
ªª  !
$str
ªª! ;
)
ªª; <
;
ªª< =
var
ææ 
result
ææ 
=
ææ 
await
ææ "
_daoUser
ææ# +
.
ææ+ , 
CreateNewUserAsync
ææ, >
(
ææ> ?
user
ææ? C
,
ææC D
	createdBy
ææE N
)
ææN O
;
ææO P
if
¿¿ 
(
¿¿ 
!
¿¿ 
result
¿¿ 
.
¿¿ 
Success
¿¿ #
||
¿¿$ &
result
¿¿' -
.
¿¿- .
Data
¿¿. 2
==
¿¿3 5
$num
¿¿6 7
)
¿¿7 8
{
¡¡ 
return
¬¬ 
CreateUserResult
¬¬ +
.
¬¬+ ,
ErrorResult
¬¬, 7
(
¬¬7 8
result
¬¬8 >
.
¬¬> ?
ErrorMessage
¬¬? K
)
¬¬K L
;
¬¬L M
}
√√ 
await
∆∆ "
LogUserActivityAsync
∆∆ *
(
∆∆* +
$str
«« "
,
««" #
user
»» 
.
»» 
WindowsUsername
»» (
,
»»( )
Environment
…… 
.
……  
MachineName
……  +
,
……+ ,
$"
   
$str
   (
{
  ( )
user
  ) -
.
  - .
FullName
  . 6
}
  6 7
$str
  7 >
{
  > ?
result
  ? E
.
  E F
Data
  F J
}
  J K
$str
  K P
{
  P Q
	createdBy
  Q Z
}
  Z [
"
  [ \
)
  \ ]
;
  ] ^
progress
ÃÃ 
?
ÃÃ 
.
ÃÃ 
Report
ÃÃ  
(
ÃÃ  !
$"
ÃÃ! #
$str
ÃÃ# K
{
ÃÃK L
result
ÃÃL R
.
ÃÃR S
Data
ÃÃS W
}
ÃÃW X
"
ÃÃX Y
)
ÃÃY Z
;
ÃÃZ [
return
ÕÕ 
CreateUserResult
ÕÕ '
.
ÕÕ' (
SuccessResult
ÕÕ( 5
(
ÕÕ5 6
result
ÕÕ6 <
.
ÕÕ< =
Data
ÕÕ= A
)
ÕÕA B
;
ÕÕB C
}
ŒŒ 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
–– 
if
—— 
(
—— 
_errorHandler
—— !
!=
——" $
null
——% )
)
——) *
await
““ 
_errorHandler
““ '
.
““' (
HandleErrorAsync
““( 8
(
““8 9
$str
““9 Q
,
““Q R 
Enum_ErrorSeverity
““S e
.
““e f
Error
““f k
,
““k l
ex
““m o
,
““o p
false
““q v
)
““v w
;
““w x
return
”” 
CreateUserResult
”” '
.
””' (
ErrorResult
””( 3
(
””3 4
$"
””4 6
$str
””6 K
{
””K L
ex
””L N
.
””N O
Message
””O V
}
””V W
"
””W X
)
””X Y
;
””Y Z
}
‘‘ 
}
’’ 	
public
‹‹ 
async
‹‹ 
Task
‹‹ 
<
‹‹ 
ValidationResult
‹‹ *
>
‹‹* +
ValidatePinAsync
‹‹, <
(
‹‹< =
string
‹‹= C
pin
‹‹D G
,
‹‹G H
int
‹‹I L
?
‹‹L M#
excludeEmployeeNumber
‹‹N c
=
‹‹d e
null
‹‹f j
)
‹‹j k
{
›› 	
try
ﬁﬁ 
{
ﬂﬂ 
if
·· 
(
·· 
string
·· 
.
··  
IsNullOrWhiteSpace
·· -
(
··- .
pin
··. 1
)
··1 2
)
··2 3
{
‚‚ 
return
„„ 
ValidationResult
„„ +
.
„„+ ,
Invalid
„„, 3
(
„„3 4
$str
„„4 E
)
„„E F
;
„„F G
}
‰‰ 
if
ÊÊ 
(
ÊÊ 
pin
ÊÊ 
.
ÊÊ 
Length
ÊÊ 
!=
ÊÊ !
$num
ÊÊ" #
)
ÊÊ# $
{
ÁÁ 
return
ËË 
ValidationResult
ËË +
.
ËË+ ,
Invalid
ËË, 3
(
ËË3 4
$str
ËË4 R
)
ËËR S
;
ËËS T
}
ÈÈ 
if
ÎÎ 
(
ÎÎ 
!
ÎÎ 
Regex
ÎÎ 
.
ÎÎ 
IsMatch
ÎÎ "
(
ÎÎ" #
pin
ÎÎ# &
,
ÎÎ& '
$str
ÎÎ( 2
)
ÎÎ2 3
)
ÎÎ3 4
{
ÏÏ 
return
ÌÌ 
ValidationResult
ÌÌ +
.
ÌÌ+ ,
Invalid
ÌÌ, 3
(
ÌÌ3 4
$str
ÌÌ4 Z
)
ÌÌZ [
;
ÌÌ[ \
}
ÓÓ 
var
ÒÒ 
uniqueResult
ÒÒ  
=
ÒÒ! "
await
ÒÒ# (
_daoUser
ÒÒ) 1
.
ÒÒ1 2
IsPinUniqueAsync
ÒÒ2 B
(
ÒÒB C
pin
ÒÒC F
,
ÒÒF G#
excludeEmployeeNumber
ÒÒH ]
)
ÒÒ] ^
;
ÒÒ^ _
if
ÚÚ 
(
ÚÚ 
uniqueResult
ÚÚ  
.
ÚÚ  !
Success
ÚÚ! (
&&
ÚÚ) +
uniqueResult
ÚÚ, 8
.
ÚÚ8 9
Data
ÚÚ9 =
==
ÚÚ> @
false
ÚÚA F
)
ÚÚF G
{
ÛÛ 
return
ÙÙ 
ValidationResult
ÙÙ +
.
ÙÙ+ ,
Invalid
ÙÙ, 3
(
ÙÙ3 4
$str
ÙÙ4 P
)
ÙÙP Q
;
ÙÙQ R
}
ıı 
return
˜˜ 
ValidationResult
˜˜ '
.
˜˜' (
Valid
˜˜( -
(
˜˜- .
)
˜˜. /
;
˜˜/ 0
}
¯¯ 
catch
˘˘ 
(
˘˘ 
	Exception
˘˘ 
ex
˘˘ 
)
˘˘  
{
˙˙ 
if
˚˚ 
(
˚˚ 
_errorHandler
˚˚ !
!=
˚˚" $
null
˚˚% )
)
˚˚) *
await
¸¸ 
_errorHandler
¸¸ '
.
¸¸' (
HandleErrorAsync
¸¸( 8
(
¸¸8 9
$str
¸¸9 P
,
¸¸P Q 
Enum_ErrorSeverity
¸¸R d
.
¸¸d e
Error
¸¸e j
,
¸¸j k
ex
¸¸l n
,
¸¸n o
false
¸¸p u
)
¸¸u v
;
¸¸v w
return
˝˝ 
ValidationResult
˝˝ '
.
˝˝' (
Invalid
˝˝( /
(
˝˝/ 0
$"
˝˝0 2
$str
˝˝2 D
{
˝˝D E
ex
˝˝E G
.
˝˝G H
Message
˝˝H O
}
˝˝O P
"
˝˝P Q
)
˝˝Q R
;
˝˝R S
}
˛˛ 
}
ˇˇ 	
public
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
<
ÜÜ %
Model_WorkstationConfig
ÜÜ 1
>
ÜÜ1 2(
DetectWorkstationTypeAsync
ÜÜ3 M
(
ÜÜM N
string
ÜÜN T
?
ÜÜT U
computerName
ÜÜV b
=
ÜÜc d
null
ÜÜe i
)
ÜÜi j
{
áá 	
try
àà 
{
ââ 
computerName
ää 
??=
ää  
Environment
ää! ,
.
ää, -
MachineName
ää- 8
;
ää8 9
var
çç #
sharedTerminalsResult
çç )
=
çç* +
await
çç, 1
_daoUser
çç2 :
.
çç: ;)
GetSharedTerminalNamesAsync
çç; V
(
ççV W
)
ççW X
;
ççX Y
var
èè 
config
èè 
=
èè 
new
èè  %
Model_WorkstationConfig
èè! 8
(
èè8 9
computerName
èè9 E
)
èèE F
;
èèF G
if
ëë 
(
ëë #
sharedTerminalsResult
ëë )
.
ëë) *
Success
ëë* 1
&&
ëë2 4#
sharedTerminalsResult
ëë5 J
.
ëëJ K
Data
ëëK O
!=
ëëP R
null
ëëS W
)
ëëW X
{
íí 
var
îî 
isShared
îî  
=
îî! "#
sharedTerminalsResult
îî# 8
.
îî8 9
Data
îî9 =
.
îî= >
Contains
îî> F
(
îîF G
computerName
îîG S
)
îîS T
;
îîT U
config
ïï 
.
ïï 
WorkstationType
ïï *
=
ïï+ ,
isShared
ïï- 5
?
ïï6 7
$str
ïï8 I
:
ïïJ K
$str
ïïL b
;
ïïb c
config
ññ 
.
ññ 
Description
ññ &
=
ññ' (
isShared
ññ) 1
?
óó 
$str
óó I
:
òò 
$str
òò I
;
òòI J
}
ôô 
else
öö 
{
õõ 
config
ùù 
.
ùù 
WorkstationType
ùù *
=
ùù+ ,
$str
ùù- C
;
ùùC D
config
ûû 
.
ûû 
Description
ûû &
=
ûû' (
$str
ûû) I
;
ûûI J
}
üü 
return
°° 
config
°° 
;
°° 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
§§ 
if
•• 
(
•• 
_errorHandler
•• !
!=
••" $
null
••% )
)
••) *
await
¶¶ 
_errorHandler
¶¶ '
.
¶¶' (
HandleErrorAsync
¶¶( 8
(
¶¶8 9
$str
¶¶9 \
,
¶¶\ ] 
Enum_ErrorSeverity
¶¶^ p
.
¶¶p q
Warning
¶¶q x
,
¶¶x y
ex
¶¶z |
,
¶¶| }
false¶¶~ É
)¶¶É Ñ
;¶¶Ñ Ö
return
©© 
new
©© %
Model_WorkstationConfig
©© 2
(
©©2 3
computerName
©©3 ?
??
©©@ B
Environment
©©C N
.
©©N O
MachineName
©©O Z
)
©©Z [
{
™™ 
WorkstationType
´´ #
=
´´$ %
$str
´´& <
,
´´< =
Description
¨¨ 
=
¨¨  !
$str
¨¨" N
}
≠≠ 
;
≠≠ 
}
ÆÆ 
}
ØØ 	
public
≤≤ 
async
≤≤ 
Task
≤≤ 
<
≤≤ 
List
≤≤ 
<
≤≤ 
string
≤≤ %
>
≤≤% &
>
≤≤& ''
GetActiveDepartmentsAsync
≤≤( A
(
≤≤A B
)
≤≤B C
{
≥≥ 	
try
¥¥ 
{
µµ 
var
∂∂ 
result
∂∂ 
=
∂∂ 
await
∂∂ "
_daoUser
∂∂# +
.
∂∂+ ,'
GetActiveDepartmentsAsync
∂∂, E
(
∂∂E F
)
∂∂F G
;
∂∂G H
if
∏∏ 
(
∏∏ 
result
∏∏ 
.
∏∏ 
Success
∏∏ "
&&
∏∏# %
result
∏∏& ,
.
∏∏, -
Data
∏∏- 1
!=
∏∏2 4
null
∏∏5 9
)
∏∏9 :
{
ππ 
return
∫∫ 
result
∫∫ !
.
∫∫! "
Data
∫∫" &
;
∫∫& '
}
ªª 
return
ææ 
new
ææ 
List
ææ 
<
ææ  
string
ææ  &
>
ææ& '
(
ææ' (
)
ææ( )
;
ææ) *
}
øø 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
¡¡ 
if
¬¬ 
(
¬¬ 
_errorHandler
¬¬ !
!=
¬¬" $
null
¬¬% )
)
¬¬) *
await
√√ 
_errorHandler
√√ '
.
√√' (
HandleErrorAsync
√√( 8
(
√√8 9
$str
√√9 X
,
√√X Y 
Enum_ErrorSeverity
√√Z l
.
√√l m
Warning
√√m t
,
√√t u
ex
√√v x
,
√√x y
false
√√z 
)√√ Ä
;√√Ä Å
return
ƒƒ 
new
ƒƒ 
List
ƒƒ 
<
ƒƒ  
string
ƒƒ  &
>
ƒƒ& '
(
ƒƒ' (
)
ƒƒ( )
;
ƒƒ) *
}
≈≈ 
}
∆∆ 	
public
ÕÕ 
async
ÕÕ 
Task
ÕÕ "
LogUserActivityAsync
ÕÕ .
(
ÕÕ. /
string
ÕÕ/ 5
	eventType
ÕÕ6 ?
,
ÕÕ? @
string
ÕÕA G
username
ÕÕH P
,
ÕÕP Q
string
ÕÕR X
workstationName
ÕÕY h
,
ÕÕh i
string
ÕÕj p
details
ÕÕq x
)
ÕÕx y
{
ŒŒ 	
try
œœ 
{
–– 
await
—— 
_daoUser
—— 
.
—— "
LogUserActivityAsync
—— 3
(
——3 4
	eventType
——4 =
,
——= >
username
——? G
,
——G H
workstationName
——I X
,
——X Y
details
——Z a
)
——a b
;
——b c
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
‘‘ 
if
÷÷ 
(
÷÷ 
_errorHandler
÷÷ !
!=
÷÷" $
null
÷÷% )
)
÷÷) *
await
◊◊ 
_errorHandler
◊◊ '
.
◊◊' (
HandleErrorAsync
◊◊( 8
(
◊◊8 9
$str
◊◊9 R
,
◊◊R S 
Enum_ErrorSeverity
◊◊T f
.
◊◊f g
Info
◊◊g k
,
◊◊k l
ex
◊◊m o
,
◊◊o p
false
◊◊q v
)
◊◊v w
;
◊◊w x
System
ÿÿ 
.
ÿÿ 
Diagnostics
ÿÿ "
.
ÿÿ" #
Debug
ÿÿ# (
.
ÿÿ( )
	WriteLine
ÿÿ) 2
(
ÿÿ2 3
$"
ÿÿ3 5
$str
ÿÿ5 M
{
ÿÿM N
ex
ÿÿN P
.
ÿÿP Q
Message
ÿÿQ X
}
ÿÿX Y
"
ÿÿY Z
)
ÿÿZ [
;
ÿÿ[ \
}
ŸŸ 
}
⁄⁄ 	
}
€€ 
}‹‹ ≥
_C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Systems\Model_WorkstationConfig.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Systems+ 2
{ 
public		 

class		 #
Model_WorkstationConfig		 (
{

 
public 
string 
ComputerName "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 
string 
WorkstationType %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
string6 <
.< =
Empty= B
;B C
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public%% 
bool%% 
IsSharedTerminal%% $
=>%%% '
WorkstationType%%( 7
==%%8 :
$str%%; L
;%%L M
public** 
bool** !
IsPersonalWorkstation** )
=>*** ,
WorkstationType**- <
==**= ?
$str**@ V
;**V W
public00 
TimeSpan00 
TimeoutDuration00 '
=>00( *
IsSharedTerminal00+ ;
?11 
TimeSpan11 
.11 
FromMinutes11 "
(11" #
$num11# %
)11% &
:22 
TimeSpan22 
.22 
FromMinutes22 "
(22" #
$num22# %
)22% &
;22& '
public;; #
Model_WorkstationConfig;; &
(;;& '
);;' (
{<< 	
}== 	
publicCC #
Model_WorkstationConfigCC &
(CC& '
stringCC' -
?CC- .
computerNameCC/ ;
=CC< =
nullCC> B
)CCB C
{DD 	
ComputerNameEE 
=EE 
computerNameEE '
??EE( *
EnvironmentEE+ 6
.EE6 7
MachineNameEE7 B
;EEB C
}FF 	
}GG 
}HH ±
YC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Systems\Model_UserSession.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Systems+ 2
{ 
public		 

class		 
Model_UserSession		 "
{

 
public 

Model_User 
User 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
null/ 3
!3 4
;4 5
public 
string 
WorkstationName %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
string6 <
.< =
Empty= B
;B C
public   
string   
WorkstationType   %
{  & '
get  ( +
;  + ,
set  - 0
;  0 1
}  2 3
=  4 5
string  6 <
.  < =
Empty  = B
;  B C
public%% 
string%%  
AuthenticationMethod%% *
{%%+ ,
get%%- 0
;%%0 1
set%%2 5
;%%5 6
}%%7 8
=%%9 :
string%%; A
.%%A B
Empty%%B G
;%%G H
public** 
DateTime** 
LoginTimestamp** &
{**' (
get**) ,
;**, -
set**. 1
;**1 2
}**3 4
public00 
DateTime00 !
LastActivityTimestamp00 -
{00. /
get000 3
;003 4
set005 8
;008 9
}00: ;
public:: 
TimeSpan:: 
TimeoutDuration:: '
{::( )
get::* -
;::- .
set::/ 2
;::2 3
}::4 5
public?? 
TimeSpan?? !
TimeSinceLastActivity?? -
=>??. 0
DateTime??1 9
.??9 :
Now??: =
-??> ?!
LastActivityTimestamp??@ U
;??U V
publicDD 
boolDD 

IsTimedOutDD 
=>DD !!
TimeSinceLastActivityDD" 7
>=DD8 :
TimeoutDurationDD; J
;DDJ K
publicII 
boolII 
HasErpAccessII  
=>II! #
UserII$ (
?II( )
.II) *
HasErpAccessII* 6
??II7 9
falseII: ?
;II? @
publicSS 
voidSS 
UpdateLastActivitySS &
(SS& '
)SS' (
{TT 	!
LastActivityTimestampUU !
=UU" #
DateTimeUU$ ,
.UU, -
NowUU- 0
;UU0 1
}VV 	
public__ 
Model_UserSession__  
(__  !
)__! "
{`` 	
LoginTimestampaa 
=aa 
DateTimeaa %
.aa% &
Nowaa& )
;aa) *!
LastActivityTimestampbb !
=bb" #
DateTimebb$ ,
.bb, -
Nowbb- 0
;bb0 1
}cc 	
}dd 
}ee Ø
RC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Systems\Model_User.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Systems+ 2
{ 
public		 

class		 

Model_User		 
{

 
public 
int 
EmployeeNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
WindowsUsername %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
string6 <
.< =
Empty= B
;B C
public 
string 
FullName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public## 
string## 
Pin## 
{## 
get## 
;##  
set##! $
;##$ %
}##& '
=##( )
string##* 0
.##0 1
Empty##1 6
;##6 7
public(( 
string(( 

Department((  
{((! "
get((# &
;((& '
set((( +
;((+ ,
}((- .
=((/ 0
string((1 7
.((7 8
Empty((8 =
;((= >
public-- 
string-- 
Shift-- 
{-- 
get-- !
;--! "
set--# &
;--& '
}--( )
=--* +
string--, 2
.--2 3
Empty--3 8
;--8 9
public22 
bool22 
IsActive22 
{22 
get22 "
;22" #
set22$ '
;22' (
}22) *
=22+ ,
true22- 1
;221 2
public77 
string77 
?77 
VisualUsername77 %
{77& '
get77( +
;77+ ,
set77- 0
;770 1
}772 3
public<< 
string<< 
?<< 
VisualPassword<< %
{<<& '
get<<( +
;<<+ ,
set<<- 0
;<<0 1
}<<2 3
publicAA 
stringAA 
?AA  
DefaultReceivingModeAA +
{AA, -
getAA. 1
;AA1 2
setAA3 6
;AA6 7
}AA8 9
publicFF 
DateTimeFF 
CreatedDateFF #
{FF$ %
getFF& )
;FF) *
setFF+ .
;FF. /
}FF0 1
publicKK 
stringKK 
?KK 
	CreatedByKK  
{KK! "
getKK# &
;KK& '
setKK( +
;KK+ ,
}KK- .
publicPP 
DateTimePP 
ModifiedDatePP $
{PP% &
getPP' *
;PP* +
setPP, /
;PP/ 0
}PP1 2
publicZZ 
stringZZ 
DisplayNameZZ !
=>ZZ" $
$"ZZ% '
{ZZ' (
FullNameZZ( 0
}ZZ0 1
$strZZ1 8
{ZZ8 9
EmployeeNumberZZ9 G
}ZZG H
$strZZH I
"ZZI J
;ZZJ K
public__ 
bool__ 
HasErpAccess__  
=>__! #
!__$ %
string__% +
.__+ ,
IsNullOrWhiteSpace__, >
(__> ?
VisualUsername__? M
)__M N
;__N O
publichh 

Model_Userhh 
(hh 
)hh 
{ii 	
CreatedDatejj 
=jj 
DateTimejj "
.jj" #
Nowjj# &
;jj& '
ModifiedDatekk 
=kk 
DateTimekk #
.kk# $
Nowkk$ '
;kk' (
}ll 	
}mm 
}nn º
bC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_WorkflowStepResult.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public 

class $
Model_WorkflowStepResult )
{ 
public 
bool 
	IsSuccess 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
ErrorMessage "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public		 $
Enum_DunnageWorkflowStep		 '
?		' (

TargetStep		) 3
{		4 5
get		6 9
;		9 :
set		; >
;		> ?
}		@ A
}

 
} ò

^C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_UserPreference.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
;4 5
public 
partial 
class  
Model_UserPreference )
:* +
ObservableObject, <
{ 
[		 
ObservableProperty		 
]		 
private

 
int

 
_preferenceId

 
;

 
[ 
ObservableProperty 
] 
private 
string 
	_username 
= 
string %
.% &
Empty& +
;+ ,
[ 
ObservableProperty 
] 
private 
string !
_preferredPackageType (
=) *
$str+ 4
;4 5
[ 
ObservableProperty 
] 
private 
DateTime 
_lastUpdated !
;! "
[ 
ObservableProperty 
] 
private 
string 
_workstation 
=  !
string" (
.( )
Empty) .
;. /
}  
ZC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_SaveResult.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public 

class 
Model_SaveResult !
{ 
public 
bool 
	IsSuccess 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
ErrorMessage "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 
int 
RecordsSaved 
{  !
get" %
;% &
set' *
;* +
}, -
public  
Model_CSVWriteResult #
?# $
CSVExportResult% 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
}		 
}

  
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_ReceivingSession.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public 

class "
Model_ReceivingSession '
{ 
public 
Guid 
	SessionID 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
Guid. 2
.2 3
NewGuid3 :
(: ;
); <
;< =
public 
DateTime 
CreatedDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
DateTime4 <
.< =
Now= @
;@ A
public 
List 
< 
Model_ReceivingLoad '
>' (
Loads) .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
== >
new? B
(B C
)C D
;D E
public 
bool 
IsNonPO 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
PoNumber 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Model_User 
? 
User 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
TotalLoadsCount "
=># %
Loads& +
?+ ,
., -
Count- 2
??3 5
$num6 7
;7 8
public$$ 
decimal$$ 
TotalWeightQuantity$$ *
=>$$+ -
Loads$$. 3
?$$3 4
.$$4 5
Sum$$5 8
($$8 9
l$$9 :
=>$$; =
l$$> ?
.$$? @
WeightQuantity$$@ N
)$$N O
??$$P R
$num$$S T
;$$T U
public)) 
List)) 
<)) 
string)) 
>)) 
UniqueParts)) '
=>))( *
Loads** 
?** 
.** 
Select** 
(** 
l** 
=>** 
l**  
.**  !
PartID**! '
)**' (
.**( )
Distinct**) 1
(**1 2
)**2 3
.**3 4
ToList**4 :
(**: ;
)**; <
??**= ?
new**@ C
List**D H
<**H I
string**I O
>**O P
(**P Q
)**Q R
;**R S
public// 
bool// 
HasLoads// 
=>// 
Loads//  %
!=//& (
null//) -
&&//. 0
Loads//1 6
.//6 7
Count//7 <
>//= >
$num//? @
;//@ A
}00 
}11 ¢A
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_ReceivingLoad.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public 

partial 
class 
Model_ReceivingLoad ,
:- .
ObservableObject/ ?
{ 
[ 	
ObservableProperty	 
] 
private 
Guid 
_loadID 
= 
Guid #
.# $
NewGuid$ +
(+ ,
), -
;- .
[ 	
ObservableProperty	 
] 
private 
bool 
_isSelected  
;  !
[ 	
ObservableProperty	 
] 
private 
string 
_partID 
=  
string! '
.' (
Empty( -
;- .
[ 	
ObservableProperty	 
] 
private 
string 
	_partType  
=! "
string# )
.) *
Empty* /
;/ 0
[ 	
ObservableProperty	 
] 
private 
string 
? 
	_poNumber !
;! "
[ 	
ObservableProperty	 
] 
private 
string 
_poLineNumber $
=% &
string' -
.- .
Empty. 3
;3 4
[ 	
ObservableProperty	 
] 
private   
int   
_loadNumber   
;    
["" 	
ObservableProperty""	 
]"" 
private## 
decimal## 
_weightQuantity## '
;##' (
[%% 	
ObservableProperty%%	 
]%% 
private&& 
string&& 
_heatLotNumber&& %
=&&& '
string&&( .
.&&. /
Empty&&/ 4
;&&4 5
[(( 	
ObservableProperty((	 
](( 
private)) 
int)) 
_remainingQuantity)) &
;))& '
[++ 	
ObservableProperty++	 
]++ 
private,, 
int,, 
_packagesPerLoad,, $
=,,% &
$num,,' (
;,,( )
[.. 	
ObservableProperty..	 
].. 
private// 
string// 
_packageTypeName// '
=//( )
Enum_PackageType//* :
.//: ;
Skid//; ?
.//? @
ToString//@ H
(//H I
)//I J
;//J K
[11 	
ObservableProperty11	 
]11 
private22 
Enum_PackageType22  
_packageType22! -
=22. /
Enum_PackageType220 @
.22@ A
Skid22A E
;22E F
[44 	
ObservableProperty44	 
]44 
private55 
decimal55 
_weightPerPackage55 )
;55) *
[77 	
ObservableProperty77	 
]77 
private88 
bool88 
_isNonPOItem88 !
;88! "
[:: 	
ObservableProperty::	 
]:: 
private;; 
DateTime;; 
_receivedDate;; &
=;;' (
DateTime;;) 1
.;;1 2
Now;;2 5
;;;5 6
[== 	
ObservableProperty==	 
]== 
private>> 
string>> 
?>> 
_userId>> 
;>>  
partial@@ 
void@@ 
OnPartIDChanged@@ $
(@@$ %
string@@% +
value@@, 1
)@@1 2
{AA 	
ifBB 
(BB 
stringBB 
.BB 
IsNullOrWhiteSpaceBB )
(BB) *
valueBB* /
)BB/ 0
)BB0 1
returnBB2 8
;BB8 9
ifEE 
(EE 
PackagesPerLoadEE 
==EE  "
$numEE# $
)EE$ %
{FF 
PackagesPerLoadGG 
=GG  !
$numGG" #
;GG# $
}HH 
tryJJ 
{KK 
varLL 

upperValueLL 
=LL  
valueLL! &
.LL& '
ToUpperInvariantLL' 7
(LL7 8
)LL8 9
;LL9 :
ifMM 
(MM 

upperValueMM 
.MM 
ContainsMM '
(MM' (
$strMM( -
)MM- .
)MM. /
{NN 
PackageTypeOO 
=OO  !
Enum_PackageTypeOO" 2
.OO2 3
CoilOO3 7
;OO7 8
}PP 
elseQQ 
ifQQ 
(QQ 

upperValueQQ #
.QQ# $
ContainsQQ$ ,
(QQ, -
$strQQ- 2
)QQ2 3
)QQ3 4
{RR 
PackageTypeSS 
=SS  !
Enum_PackageTypeSS" 2
.SS2 3
SheetSS3 8
;SS8 9
}TT 
}UU 
catchVV 
(VV 
	ExceptionVV 
exVV 
)VV  
{WW 
SystemXX 
.XX 
DiagnosticsXX "
.XX" #
DebugXX# (
.XX( )
	WriteLineXX) 2
(XX2 3
$"XX3 5
$strXX5 b
{XXb c
exXXc e
.XXe f
MessageXXf m
}XXm n
"XXn o
)XXo p
;XXp q
}YY 
}ZZ 	
partial\\ 
void\\  
OnPackageTypeChanged\\ )
(\\) *
Enum_PackageType\\* :
value\\; @
)\\@ A
{]] 	
PackageTypeName^^ 
=^^ 
value^^ #
.^^# $
ToString^^$ ,
(^^, -
)^^- .
;^^. /
}__ 	
partialaa 
voidaa $
OnPackageTypeNameChangedaa -
(aa- .
stringaa. 4
valueaa5 :
)aa: ;
{bb 	
ifcc 
(cc 
Enumcc 
.cc 
TryParsecc 
<cc 
Enum_PackageTypecc .
>cc. /
(cc/ 0
valuecc0 5
,cc5 6
outcc7 :
varcc; >
resultcc? E
)ccE F
)ccF G
{dd 
ifee 
(ee 
PackageTypeee 
!=ee  "
resultee# )
)ee) *
{ff 
PackageTypegg 
=gg  !
resultgg" (
;gg( )
}hh 
}ii 
}jj 	
partialoo 
voidoo #
OnWeightQuantityChangedoo ,
(oo, -
decimaloo- 4
valueoo5 :
)oo: ;
{pp 	%
CalculateWeightPerPackageqq %
(qq% &
)qq& '
;qq' (
}rr 	
partialww 
voidww $
OnPackagesPerLoadChangedww -
(ww- .
intww. 1
valueww2 7
)ww7 8
{xx 	%
CalculateWeightPerPackageyy %
(yy% &
)yy& '
;yy' (
}zz 	
private 
void %
CalculateWeightPerPackage .
(. /
)/ 0
{
ÄÄ 	
if
ÅÅ 
(
ÅÅ 
PackagesPerLoad
ÅÅ 
>
ÅÅ  !
$num
ÅÅ" #
)
ÅÅ# $
{
ÇÇ 
WeightPerPackage
ÑÑ  
=
ÑÑ! "
Math
ÑÑ# '
.
ÑÑ' (
Round
ÑÑ( -
(
ÑÑ- .
WeightQuantity
ÑÑ. <
/
ÑÑ= >
PackagesPerLoad
ÑÑ? N
,
ÑÑN O
$num
ÑÑP Q
)
ÑÑQ R
;
ÑÑR S
}
ÖÖ 
else
ÜÜ 
{
áá 
WeightPerPackage
àà  
=
àà! "
$num
àà# $
;
àà$ %
}
ââ 
}
ää 	
public
èè 
string
èè %
WeightPerPackageDisplay
èè -
=>
èè. 0
$"
êê 
{
êê 
WeightPerPackage
êê 
:
êê  
$str
êê  "
}
êê" #
$str
êê# ,
{
êê, -
PackageTypeName
êê- <
}
êê< =
"
êê= >
;
êê> ?
public
ïï 
string
ïï 
PONumberDisplay
ïï %
=>
ïï& (
string
ññ 
.
ññ 
IsNullOrEmpty
ññ  
(
ññ  !
PoNumber
ññ! )
)
ññ) *
?
ññ+ ,
$str
ññ- 2
:
ññ3 4
PoNumber
ññ5 =
;
ññ= >
}
óó 
}òò ö
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_ReceivingLine.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
;4 5
public		 
class		 
Model_ReceivingLine		  
{

 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

int 
Quantity 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
PartID 
{ 
get 
; 
set  #
;# $
}% &
=' (
string) /
./ 0
Empty0 5
;5 6
public 

int 
PONumber 
{ 
get 
; 
set "
;" #
}$ %
public"" 

int"" 
EmployeeNumber"" 
{"" 
get""  #
;""# $
set""% (
;""( )
}""* +
public'' 

string'' 
Heat'' 
{'' 
get'' 
;'' 
set'' !
;''! "
}''# $
=''% &
string''' -
.''- .
Empty''. 3
;''3 4
public,, 

DateTime,, 
Date,, 
{,, 
get,, 
;,, 
set,,  #
;,,# $
},,% &
=,,' (
DateTime,,) 1
.,,1 2
Now,,2 5
;,,5 6
public11 

string11 
InitialLocation11 !
{11" #
get11$ '
;11' (
set11) ,
;11, -
}11. /
=110 1
string112 8
.118 9
Empty119 >
;11> ?
public66 

int66 
?66 
CoilsOnSkid66 
{66 
get66 !
;66! "
set66# &
;66& '
}66( )
public;; 

int;; 
LabelNumber;; 
{;; 
get;;  
;;;  !
set;;" %
;;;% &
};;' (
=;;) *
$num;;+ ,
;;;, -
public@@ 

int@@ 
TotalLabels@@ 
{@@ 
get@@  
;@@  !
set@@" %
;@@% &
}@@' (
=@@) *
$num@@+ ,
;@@, -
publicEE 

stringEE 

VendorNameEE 
{EE 
getEE "
;EE" #
setEE$ '
;EE' (
}EE) *
=EE+ ,
$strEE- 6
;EE6 7
publicJJ 

stringJJ 
PartDescriptionJJ !
{JJ" #
getJJ$ '
;JJ' (
setJJ) ,
;JJ, -
}JJ. /
=JJ0 1
stringJJ2 8
.JJ8 9
EmptyJJ9 >
;JJ> ?
publicOO 

DateTimeOO 
	CreatedAtOO 
{OO 
getOO  #
;OO# $
setOO% (
;OO( )
}OO* +
publicTT 

stringTT 
	LabelTextTT 
=>TT 
$"TT !
{TT! "
LabelNumberTT" -
}TT- .
$strTT. 1
{TT1 2
TotalLabelsTT2 =
}TT= >
"TT> ?
;TT? @
}UU †
eC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_PackageTypePreference.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public		 

class		 '
Model_PackageTypePreference		 ,
{

 
public 
int 
PreferenceID 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
PartID 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 
string 
PackageTypeName %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
string6 <
.< =
Empty= B
;B C
public 
string 
? 
CustomTypeName %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
LastModified $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
DateTime5 =
.= >
UtcNow> D
;D E
} 
} •
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_InforVisualPO.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public		 

class		 
Model_InforVisualPO		 $
{

 
public 
string 
PONumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
string 
Vendor 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 
List 
< !
Model_InforVisualPart )
>) *
Parts+ 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
=? @
newA D
(D E
)E F
;F G
public 
bool 
HasParts 
=> 
Parts  %
!=& (
null) -
&&. 0
Parts1 6
.6 7
Count7 <
>= >
$num? @
;@ A
public 
string 
StatusDescription '
=>( *
Status+ 1
switch2 8
{ 	
$str 
=> 
$str 
, 
$str 
=> 
$str 
, 
$str 
=> 
$str 
, 
$str   
=>   
$str   '
,  ' (
$str!! 
=>!! 
$str!! 
,!! 
$str"" 
=>"" 
$str"" 
,"" 
$str## 
=>## 
$str## 
,## 
_$$ 
=>$$ 
$"$$ 
$str$$ 
{$$ 
Status$$ "
}$$" #
"$$# $
}%% 	
;%%	 

public** 
bool** 
IsClosed** 
=>** 
Status**  &
==**' )
$str*** -
||**. 0
Status**1 7
==**8 :
$str**; >
;**> ?
}++ 
},, ƒ
_C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_InforVisualPart.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public 

class !
Model_InforVisualPart &
{ 
public		 
string		 
PartID		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
=		+ ,
string		- 3
.		3 4
Empty		4 9
;		9 :
public 
string 
POLineNumber "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 
string 
PartType 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
decimal 

QtyOrdered !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
string2 8
.8 9
Empty9 >
;> ?
public 
int 
RemainingQuantity $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
DisplayText !
=>" $
$" 
{ 
PartID 
} 
$str 
{ 
Description %
}% &
$str& -
{- .
POLineNumber. :
}: ;
$str; <
"< =
;= >
} 
} ∑	
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_HeatCheckboxItem.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public		 

partial		 
class		 "
Model_HeatCheckboxItem		 /
:		0 1
ObservableObject		2 B
{

 
[ 	
ObservableProperty	 
] 
private 
string 
_heatLotNumber %
=& '
string( .
.. /
Empty/ 4
;4 5
[ 	
ObservableProperty	 
] 
private 
bool 

_isChecked 
;  
[ 	
ObservableProperty	 
] 
private 
int 
_firstLoadNumber $
;$ %
public 
string 
DisplayText !
=>" $
$" 
{ 
HeatLotNumber 
} 
$str )
{) *
FirstLoadNumber* 9
}9 :
$str: ;
"; <
;< =
} 
} ã
[C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_DunnageLine.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
;4 5
public		 
class		 
Model_DunnageLine		 
{

 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
Line1 
{ 
get 
; 
set "
;" #
}$ %
=& '
string( .
.. /
Empty/ 4
;4 5
public 

string 
Line2 
{ 
get 
; 
set "
;" #
}$ %
=& '
string( .
.. /
Empty/ 4
;4 5
public 

int 
PONumber 
{ 
get 
; 
set "
;" #
}$ %
public"" 

DateTime"" 
Date"" 
{"" 
get"" 
;"" 
set""  #
;""# $
}""% &
=""' (
DateTime"") 1
.""1 2
Now""2 5
;""5 6
public'' 

int'' 
EmployeeNumber'' 
{'' 
get''  #
;''# $
set''% (
;''( )
}''* +
public,, 

string,, 

VendorName,, 
{,, 
get,, "
;,," #
set,,$ '
;,,' (
},,) *
=,,+ ,
$str,,- 6
;,,6 7
public11 

string11 
Location11 
{11 
get11  
;11  !
set11" %
;11% &
}11' (
=11) *
string11+ 1
.111 2
Empty112 7
;117 8
public66 

int66 
LabelNumber66 
{66 
get66  
;66  !
set66" %
;66% &
}66' (
=66) *
$num66+ ,
;66, -
public;; 

DateTime;; 
	CreatedAt;; 
{;; 
get;;  #
;;;# $
set;;% (
;;;( )
};;* +
}<< Ñ
^C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_CSVWriteResult.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
{ 
public 

class  
Model_CSVWriteResult %
{ 
public 
bool 
LocalSuccess  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
NetworkSuccess "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
ErrorMessage "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 
string 
LocalFilePath #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
string4 :
.: ;
Empty; @
;@ A
public		 
string		 
NetworkFilePath		 %
{		& '
get		( +
;		+ ,
set		- 0
;		0 1
}		2 3
=		4 5
string		6 <
.		< =
Empty		= B
;		B C
}

 
} Ë
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_CarrierDeliveryLabel.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
;4 5
public

 
class

 &
Model_CarrierDeliveryLabel

 '
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
	DeliverTo 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 

string 

Department 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 

string 
PackageDescription $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
string5 ;
.; <
Empty< A
;A B
public## 

int## 
?## 
PONumber## 
{## 
get## 
;## 
set##  #
;### $
}##% &
public(( 

string(( 
WorkOrderNumber(( !
{((" #
get(($ '
;((' (
set(() ,
;((, -
}((. /
=((0 1
string((2 8
.((8 9
Empty((9 >
;((> ?
public-- 

int-- 
EmployeeNumber-- 
{-- 
get--  #
;--# $
set--% (
;--( )
}--* +
public22 

int22 
LabelNumber22 
{22 
get22  
;22  !
set22" %
;22% &
}22' (
=22) *
$num22+ ,
;22, -
public77 

DateTime77 
Date77 
{77 
get77 
;77 
set77  #
;77# $
}77% &
=77' (
DateTime77) 1
.771 2
Now772 5
;775 6
public<< 

DateTime<< 
	CreatedAt<< 
{<< 
get<<  #
;<<# $
set<<% (
;<<( )
}<<* +
}== 
eC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Receiving\Model_Application_Variables.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
	Receiving+ 4
;4 5
public		 
class		 '
Model_Application_Variables		 (
{

 
public 

string 
ApplicationName !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
$str2 S
;S T
public 

string 
Version 
{ 
get 
;  
set! $
;$ %
}& '
=( )
$str* 1
;1 2
public 

string 
ConnectionString "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 

string 
LogDirectory 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
Path/ 3
.3 4
Combine4 ;
(; <
Environment 
. 
GetFolderPath !
(! "
Environment" -
.- .
SpecialFolder. ;
.; <
ApplicationData< K
)K L
,L M
$str #
,# $
$str   
)!! 
;!! 
public&& 

string&& 
EnvironmentType&& !
{&&" #
get&&$ '
;&&' (
set&&) ,
;&&, -
}&&. /
=&&0 1
$str&&2 ?
;&&? @
}'' …
_C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\InforVisual\Model_InforVisualPO.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
InforVisual+ 6
;6 7
public 
partial 
class 
Model_InforVisualPO (
:) *
ObservableObject+ ;
{ 
[ 
ObservableProperty 
] 
private		 
string		 
	_poNumber		 
=		 
string		 %
.		% &
Empty		& +
;		+ ,
[ 
ObservableProperty 
] 
private 
int 
_poLine 
; 
[ 
ObservableProperty 
] 
private 
string 
_partNumber 
=  
string! '
.' (
Empty( -
;- .
[ 
ObservableProperty 
] 
private 
string 
_partDescription #
=$ %
string& ,
., -
Empty- 2
;2 3
[ 
ObservableProperty 
] 
private 
decimal 
_orderedQty 
;  
[ 
ObservableProperty 
] 
private 
decimal 
_receivedQty  
;  !
[ 
ObservableProperty 
] 
private 
decimal 
_remainingQty !
;! "
[ 
ObservableProperty 
] 
private 
string 
_unitOfMeasure !
=" #
$str$ (
;( )
[   
ObservableProperty   
]   
private!! 
DateTime!! 
?!! 
_dueDate!! 
;!! 
[## 
ObservableProperty## 
]## 
private$$ 
string$$ 
_vendorCode$$ 
=$$  
string$$! '
.$$' (
Empty$$( -
;$$- .
[&& 
ObservableProperty&& 
]&& 
private'' 
string'' 
_vendorName'' 
=''  
string''! '
.''' (
Empty''( -
;''- .
[)) 
ObservableProperty)) 
])) 
private** 
string** 
	_poStatus** 
=** 
string** %
.**% &
Empty**& +
;**+ ,
[,, 
ObservableProperty,, 
],, 
private-- 
string-- 
_siteId-- 
=-- 
$str-- "
;--" #
}.. ø
aC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\InforVisual\Model_InforVisualPart.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
InforVisual+ 6
;6 7
public 
partial 
class !
Model_InforVisualPart *
:+ ,
ObservableObject- =
{ 
[		 
ObservableProperty		 
]		 
private

 
string

 
_partNumber

 
=

  
string

! '
.

' (
Empty

( -
;

- .
[ 
ObservableProperty 
] 
private 
string 
_description 
=  !
string" (
.( )
Empty) .
;. /
[ 
ObservableProperty 
] 
private 
string 
	_partType 
= 
string %
.% &
Empty& +
;+ ,
[ 
ObservableProperty 
] 
private 
decimal 
	_unitCost 
; 
[ 
ObservableProperty 
] 
private 
string 
_primaryUom 
=  
$str! %
;% &
[ 
ObservableProperty 
] 
private 
decimal 

_onHandQty 
; 
[!! 
ObservableProperty!! 
]!! 
private"" 
decimal"" 
_allocatedQty"" !
;""! "
[%% 
ObservableProperty%% 
]%% 
private&& 
decimal&& 
_availableQty&& !
;&&! "
[)) 
ObservableProperty)) 
])) 
private** 
string** 
_defaultSite** 
=**  !
$str**" '
;**' (
[-- 
ObservableProperty-- 
]-- 
private.. 
string.. 
_partStatus.. 
=..  
$str..! )
;..) *
[11 
ObservableProperty11 
]11 
private22 
string22 
_productLine22 
=22  !
string22" (
.22( )
Empty22) .
;22. /
}33 ı
VC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Enums\Enum_PackageType.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Enums+ 0
{ 
public 

enum 
Enum_PackageType  
{ 
Skid 
, 
Box 
, 
Crate 
, 
Bundle 
, 
Roll		 
,		 
Piece

 
,

 
Pallet 
, 
Coil 
, 
Sheet 
} 
} î
TC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Enums\Enum_LabelType.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Enums+ 0
;0 1
public 
enum 
Enum_LabelType 
{ 
	Receiving 
= 
$num 
, 
Dunnage 
= 
$num 
, 
UPSFedEx 
= 
$num 
, 
MiniReceiving 
= 
$num 
, 
MiniCoil 
= 
$num 
}   å
XC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Enums\Enum_ErrorSeverity.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Enums+ 0
;0 1
public 
enum 
Enum_ErrorSeverity 
{ 
Info 
=	 

$num 
, 
Warning 
= 
$num 
, 
Error 	
=
 
$num 
, 
Critical 
= 
$num 
, 
Fatal 	
=
 
$num 
}   ü
^C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Enums\Enum_DunnageWorkflowStep.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Enums+ 0
{ 
public 

enum $
Enum_DunnageWorkflowStep (
{ 
ModeSelection 
= 
$num 
, 
TypeSelection 
= 
$num 
, 
PartSelection 
= 
$num 
, 
QuantityEntry 
= 
$num 
, 
DetailsEntry		 
=		 
$num		 
,		 
Review

 
=

 
$num

 
,

 
ManualEntry 
= 
$num 
, 
EditMode 
= 
$num 
} 
} Ω
YC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Enums\Enum_DataSourceType.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Enums+ 0
{ 
public 

enum 
Enum_DataSourceType #
{ 
Memory 
, 
CurrentLabels 
, 
History 
} 
}		 «	
WC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Dunnage\Model_SpecInput.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Dunnage+ 2
;2 3
public 
partial 
class 
Model_SpecInput $
:% &
ObservableObject' 7
{		 
[

 
ObservableProperty

 
]

 
private 
string 
	_specName 
= 
string %
.% &
Empty& +
;+ ,
[ 
ObservableProperty 
] 
private 
string 
	_specType 
= 
$str %
;% &
[ 
ObservableProperty 
] 
private 
object 
? 
_value 
; 
[ 
ObservableProperty 
] 
private 
string 
? 
_unit 
; 
[ 
ObservableProperty 
] 
private 
bool 
_isRequired 
; 
} î-
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Dunnage\Model_InventoriedDunnage.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Dunnage+ 2
;2 3
public 
class $
Model_InventoriedDunnage %
:& '"
INotifyPropertyChanged( >
{		 
private

 
int

 
_id

 
;

 
private 
string 
_partId 
= 
string #
.# $
Empty$ )
;) *
private 
string 
? 
_inventoryMethod $
;$ %
private 
string 
? 
_notes 
; 
private 
string 

_createdBy 
= 
string  &
.& '
Empty' ,
;, -
private 
DateTime 
_createdDate !
=" #
DateTime$ ,
., -
Now- 0
;0 1
private 
string 
? 
_modifiedBy 
;  
private 
DateTime 
? 
_modifiedDate #
;# $
public 

int 
Id 
{ 
get 
=> 
_id 
; 
set 
=> 
SetField 
( 
ref 
_id 
,  
value! &
)& '
;' (
} 
public 

string 
PartId 
{ 
get 
=> 
_partId 
; 
set 
=> 
SetField 
( 
ref 
_partId #
,# $
value% *
)* +
;+ ,
} 
public 

string 
? 
InventoryMethod "
{   
get!! 
=>!! 
_inventoryMethod!! 
;!!  
set"" 
=>"" 
SetField"" 
("" 
ref"" 
_inventoryMethod"" ,
,"", -
value"". 3
)""3 4
;""4 5
}## 
public%% 

string%% 
?%% 
Notes%% 
{&& 
get'' 
=>'' 
_notes'' 
;'' 
set(( 
=>(( 
SetField(( 
((( 
ref(( 
_notes(( "
,((" #
value(($ )
)(() *
;((* +
})) 
public++ 

string++ 
	CreatedBy++ 
{,, 
get-- 
=>-- 

_createdBy-- 
;-- 
set.. 
=>.. 
SetField.. 
(.. 
ref.. 

_createdBy.. &
,..& '
value..( -
)..- .
;... /
}// 
public11 

DateTime11 
CreatedDate11 
{22 
get33 
=>33 
_createdDate33 
;33 
set44 
=>44 
SetField44 
(44 
ref44 
_createdDate44 (
,44( )
value44* /
)44/ 0
;440 1
}55 
public77 

string77 
?77 

ModifiedBy77 
{88 
get99 
=>99 
_modifiedBy99 
;99 
set:: 
=>:: 
SetField:: 
(:: 
ref:: 
_modifiedBy:: '
,::' (
value::) .
)::. /
;::/ 0
};; 
public== 

DateTime== 
?== 
ModifiedDate== !
{>> 
get?? 
=>?? 
_modifiedDate?? 
;?? 
set@@ 
=>@@ 
SetField@@ 
(@@ 
ref@@ 
_modifiedDate@@ )
,@@) *
value@@+ 0
)@@0 1
;@@1 2
}AA 
publicCC 

eventCC '
PropertyChangedEventHandlerCC ,
?CC, -
PropertyChangedCC. =
;CC= >
	protectedEE 
virtualEE 
voidEE 
OnPropertyChangedEE ,
(EE, -
[EE- .
CallerMemberNameEE. >
]EE> ?
stringEE@ F
?EEF G
propertyNameEEH T
=EEU V
nullEEW [
)EE[ \
{FF 
PropertyChangedGG 
?GG 
.GG 
InvokeGG 
(GG  
thisGG  $
,GG$ %
newGG& )$
PropertyChangedEventArgsGG* B
(GGB C
propertyNameGGC O
)GGO P
)GGP Q
;GGQ R
}HH 
	protectedJJ 
boolJJ 
SetFieldJJ 
<JJ 
TJJ 
>JJ 
(JJ 
refJJ "
TJJ# $
fieldJJ% *
,JJ* +
TJJ, -
valueJJ. 3
,JJ3 4
[JJ5 6
CallerMemberNameJJ6 F
]JJF G
stringJJH N
?JJN O
propertyNameJJP \
=JJ] ^
nullJJ_ c
)JJc d
{KK 
ifLL 

(LL 
EqualityComparerLL 
<LL 
TLL 
>LL 
.LL  
DefaultLL  '
.LL' (
EqualsLL( .
(LL. /
fieldLL/ 4
,LL4 5
valueLL6 ;
)LL; <
)LL< =
returnLL> D
falseLLE J
;LLJ K
fieldMM 
=MM 
valueMM 
;MM 
OnPropertyChangedNN 
(NN 
propertyNameNN &
)NN& '
;NN' (
returnOO 
trueOO 
;OO 
}PP 
}QQ Î)
YC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Dunnage\Model_DunnageType.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Dunnage+ 2
;2 3
public 
class 
Model_DunnageType 
:  "
INotifyPropertyChanged! 7
{		 
private

 
int

 
_id

 
;

 
private 
string 
	_typeName 
= 
string %
.% &
Empty& +
;+ ,
private 
string 

_specsJson 
= 
string  &
.& '
Empty' ,
;, -
private 
string 

_createdBy 
= 
string  &
.& '
Empty' ,
;, -
private 
DateTime 
_createdDate !
=" #
DateTime$ ,
., -
Now- 0
;0 1
private 
string 
? 
_modifiedBy 
;  
private 
DateTime 
? 
_modifiedDate #
;# $
public 

int 
Id 
{ 
get 
=> 
_id 
; 
set 
=> 
SetField 
( 
ref 
_id 
,  
value! &
)& '
;' (
} 
public 

string 
TypeName 
{ 
get 
=> 
	_typeName 
; 
set 
=> 
SetField 
( 
ref 
	_typeName %
,% &
value' ,
), -
;- .
} 
public 

string 
	SpecsJson 
{ 
get   
=>   

_specsJson   
;   
set!! 
=>!! 
SetField!! 
(!! 
ref!! 

_specsJson!! &
,!!& '
value!!( -
)!!- .
;!!. /
}"" 
public$$ 

string$$ 
	CreatedBy$$ 
{%% 
get&& 
=>&& 

_createdBy&& 
;&& 
set'' 
=>'' 
SetField'' 
('' 
ref'' 

_createdBy'' &
,''& '
value''( -
)''- .
;''. /
}(( 
public** 

DateTime** 
CreatedDate** 
{++ 
get,, 
=>,, 
_createdDate,, 
;,, 
set-- 
=>-- 
SetField-- 
(-- 
ref-- 
_createdDate-- (
,--( )
value--* /
)--/ 0
;--0 1
}.. 
public00 

string00 
?00 

ModifiedBy00 
{11 
get22 
=>22 
_modifiedBy22 
;22 
set33 
=>33 
SetField33 
(33 
ref33 
_modifiedBy33 '
,33' (
value33) .
)33. /
;33/ 0
}44 
public66 

DateTime66 
?66 
ModifiedDate66 !
{77 
get88 
=>88 
_modifiedDate88 
;88 
set99 
=>99 
SetField99 
(99 
ref99 
_modifiedDate99 )
,99) *
value99+ 0
)990 1
;991 2
}:: 
public<< 

event<< '
PropertyChangedEventHandler<< ,
?<<, -
PropertyChanged<<. =
;<<= >
	protected>> 
virtual>> 
void>> 
OnPropertyChanged>> ,
(>>, -
[>>- .
CallerMemberName>>. >
]>>> ?
string>>@ F
?>>F G
propertyName>>H T
=>>U V
null>>W [
)>>[ \
{?? 
PropertyChanged@@ 
?@@ 
.@@ 
Invoke@@ 
(@@  
this@@  $
,@@$ %
new@@& )$
PropertyChangedEventArgs@@* B
(@@B C
propertyName@@C O
)@@O P
)@@P Q
;@@Q R
}AA 
	protectedCC 
boolCC 
SetFieldCC 
<CC 
TCC 
>CC 
(CC 
refCC "
TCC# $
fieldCC% *
,CC* +
TCC, -
valueCC. 3
,CC3 4
[CC5 6
CallerMemberNameCC6 F
]CCF G
stringCCH N
?CCN O
propertyNameCCP \
=CC] ^
nullCC_ c
)CCc d
{DD 
ifEE 

(EE 
EqualityComparerEE 
<EE 
TEE 
>EE 
.EE  
DefaultEE  '
.EE' (
EqualsEE( .
(EE. /
fieldEE/ 4
,EE4 5
valueEE6 ;
)EE; <
)EE< =
returnEE> D
falseEEE J
;EEJ K
fieldFF 
=FF 
valueFF 
;FF 
OnPropertyChangedGG 
(GG 
propertyNameGG &
)GG& '
;GG' (
returnHH 
trueHH 
;HH 
}II 
}JJ Ô>
YC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Dunnage\Model_DunnageSpec.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Dunnage+ 2
;2 3
public		 
class		 
Model_DunnageSpec		 
:		  "
INotifyPropertyChanged		! 7
{

 
private 
int 
_id 
; 
private 
int 
_typeId 
; 
private 
string 
_specKey 
= 
string $
.$ %
Empty% *
;* +
private 
string 

_specValue 
= 
string  &
.& '
Empty' ,
;, -
private 

Dictionary 
< 
string 
, 
object %
>% &
_specsDefinition' 7
=8 9
new: =
(= >
)> ?
;? @
private 
string 

_createdBy 
= 
string  &
.& '
Empty' ,
;, -
private 
DateTime 
_createdDate !
=" #
DateTime$ ,
., -
Now- 0
;0 1
private 
string 
? 
_modifiedBy 
;  
private 
DateTime 
? 
_modifiedDate #
;# $
public 

int 
Id 
{ 
get 
=> 
_id 
; 
set 
=> 
SetField 
( 
ref 
_id 
,  
value! &
)& '
;' (
} 
public 

int 
TypeId 
{ 
get 
=> 
_typeId 
; 
set 
=> 
SetField 
( 
ref 
_typeId #
,# $
value% *
)* +
;+ ,
} 
public!! 

string!! 
SpecKey!! 
{"" 
get## 
=>## 
_specKey## 
;## 
set$$ 
=>$$ 
SetField$$ 
($$ 
ref$$ 
_specKey$$ $
,$$$ %
value$$& +
)$$+ ,
;$$, -
}%% 
public'' 

string'' 
	SpecValue'' 
{(( 
get)) 
=>)) 

_specValue)) 
;)) 
set** 
{++ 	
if,, 
(,, 
SetField,, 
(,, 
ref,, 

_specValue,, '
,,,' (
value,,) .
),,. /
),,/ 0
{-- 
DeserializeSpecs..  
(..  !
)..! "
;.." #
}// 
}00 	
}11 
public33 


Dictionary33 
<33 
string33 
,33 
object33 $
>33$ %
SpecsDefinition33& 5
{44 
get55 
=>55 
_specsDefinition55 
;55  
set66 
=>66 
SetField66 
(66 
ref66 
_specsDefinition66 ,
,66, -
value66. 3
)663 4
;664 5
}77 
public99 

string99 
	CreatedBy99 
{:: 
get;; 
=>;; 

_createdBy;; 
;;; 
set<< 
=><< 
SetField<< 
(<< 
ref<< 

_createdBy<< &
,<<& '
value<<( -
)<<- .
;<<. /
}== 
public?? 

DateTime?? 
CreatedDate?? 
{@@ 
getAA 
=>AA 
_createdDateAA 
;AA 
setBB 
=>BB 
SetFieldBB 
(BB 
refBB 
_createdDateBB (
,BB( )
valueBB* /
)BB/ 0
;BB0 1
}CC 
publicEE 

stringEE 
?EE 

ModifiedByEE 
{FF 
getGG 
=>GG 
_modifiedByGG 
;GG 
setHH 
=>HH 
SetFieldHH 
(HH 
refHH 
_modifiedByHH '
,HH' (
valueHH) .
)HH. /
;HH/ 0
}II 
publicKK 

DateTimeKK 
?KK 
ModifiedDateKK !
{LL 
getMM 
=>MM 
_modifiedDateMM 
;MM 
setNN 
=>NN 
SetFieldNN 
(NN 
refNN 
_modifiedDateNN )
,NN) *
valueNN+ 0
)NN0 1
;NN1 2
}OO 
publicQQ 

eventQQ '
PropertyChangedEventHandlerQQ ,
?QQ, -
PropertyChangedQQ. =
;QQ= >
	protectedSS 
virtualSS 
voidSS 
OnPropertyChangedSS ,
(SS, -
[SS- .
CallerMemberNameSS. >
]SS> ?
stringSS@ F
?SSF G
propertyNameSSH T
=SSU V
nullSSW [
)SS[ \
{TT 
PropertyChangedUU 
?UU 
.UU 
InvokeUU 
(UU  
thisUU  $
,UU$ %
newUU& )$
PropertyChangedEventArgsUU* B
(UUB C
propertyNameUUC O
)UUO P
)UUP Q
;UUQ R
}VV 
	protectedXX 
boolXX 
SetFieldXX 
<XX 
TXX 
>XX 
(XX 
refXX "
TXX# $
fieldXX% *
,XX* +
TXX, -
valueXX. 3
,XX3 4
[XX5 6
CallerMemberNameXX6 F
]XXF G
stringXXH N
?XXN O
propertyNameXXP \
=XX] ^
nullXX_ c
)XXc d
{YY 
ifZZ 

(ZZ 
EqualityComparerZZ 
<ZZ 
TZZ 
>ZZ 
.ZZ  
DefaultZZ  '
.ZZ' (
EqualsZZ( .
(ZZ. /
fieldZZ/ 4
,ZZ4 5
valueZZ6 ;
)ZZ; <
)ZZ< =
returnZZ> D
falseZZE J
;ZZJ K
field[[ 
=[[ 
value[[ 
;[[ 
OnPropertyChanged\\ 
(\\ 
propertyName\\ &
)\\& '
;\\' (
return]] 
true]] 
;]] 
}^^ 
private`` 
void`` 
DeserializeSpecs`` !
(``! "
)``" #
{aa 
trybb 
{cc 	
ifdd 
(dd 
stringdd 
.dd 
IsNullOrWhiteSpacedd )
(dd) *
	SpecValuedd* 3
)dd3 4
)dd4 5
{ee 
SpecsDefinitionff 
=ff  !
newff" %

Dictionaryff& 0
<ff0 1
stringff1 7
,ff7 8
objectff9 ?
>ff? @
(ff@ A
)ffA B
;ffB C
returngg 
;gg 
}hh 
varjj 
dictjj 
=jj 
JsonSerializerjj %
.jj% &
Deserializejj& 1
<jj1 2

Dictionaryjj2 <
<jj< =
stringjj= C
,jjC D
objectjjE K
>jjK L
>jjL M
(jjM N
	SpecValuejjN W
)jjW X
;jjX Y
SpecsDefinitionkk 
=kk 
dictkk "
??kk# %
newkk& )

Dictionarykk* 4
<kk4 5
stringkk5 ;
,kk; <
objectkk= C
>kkC D
(kkD E
)kkE F
;kkF G
}ll 	
catchmm 
{nn 	
SpecsDefinitionoo 
=oo 
newoo !

Dictionaryoo" ,
<oo, -
stringoo- 3
,oo3 4
objectoo5 ;
>oo; <
(oo< =
)oo= >
;oo> ?
}pp 	
}qq 
}rr ˙<
\C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Dunnage\Model_DunnageSession.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Dunnage+ 2
;2 3
public		 
class		  
Model_DunnageSession		 !
:		" #"
INotifyPropertyChanged		$ :
{

 
private 
int 
_selectedTypeId 
;  
private 
string 
_selectedTypeName $
=% &
string' -
.- .
Empty. 3
;3 4
private 
Model_DunnagePart 
? 
_selectedPart ,
;, -
private 
decimal 
	_quantity 
; 
private 
string 
	_poNumber 
= 
string %
.% &
Empty& +
;+ ,
private 
string 
	_location 
= 
string %
.% &
Empty& +
;+ ,
private  
ObservableCollection  
<  !
Model_DunnageLoad! 2
>2 3
_loads4 :
=; <
new= @
(@ A
)A B
;B C
private 

Dictionary 
< 
string 
, 
object %
>% &
?& '
_specValues( 3
;3 4
private 
Model_DunnageType 
? 
_selectedType ,
;, -
public 

int 
SelectedTypeId 
{ 
get 
=> 
_selectedTypeId 
; 
set 
=> 
SetField 
( 
ref 
_selectedTypeId +
,+ ,
value- 2
)2 3
;3 4
} 
public 

string 
SelectedTypeName "
{ 
get 
=> 
_selectedTypeName  
;  !
set 
=> 
SetField 
( 
ref 
_selectedTypeName -
,- .
value/ 4
)4 5
;5 6
}   
public"" 

Model_DunnagePart"" 
?"" 
SelectedPart"" *
{## 
get$$ 
=>$$ 
_selectedPart$$ 
;$$ 
set%% 
=>%% 
SetField%% 
(%% 
ref%% 
_selectedPart%% )
,%%) *
value%%+ 0
)%%0 1
;%%1 2
}&& 
public(( 

decimal(( 
Quantity(( 
{)) 
get** 
=>** 
	_quantity** 
;** 
set++ 
=>++ 
SetField++ 
(++ 
ref++ 
	_quantity++ %
,++% &
value++' ,
)++, -
;++- .
},, 
public.. 

string.. 
PONumber.. 
{// 
get00 
=>00 
	_poNumber00 
;00 
set11 
=>11 
SetField11 
(11 
ref11 
	_poNumber11 %
,11% &
value11' ,
)11, -
;11- .
}22 
public44 

string44 
Location44 
{55 
get66 
=>66 
	_location66 
;66 
set77 
=>77 
SetField77 
(77 
ref77 
	_location77 %
,77% &
value77' ,
)77, -
;77- .
}88 
public:: 
 
ObservableCollection:: 
<::  
Model_DunnageLoad::  1
>::1 2
Loads::3 8
{;; 
get<< 
=><< 
_loads<< 
;<< 
set== 
{>> 	
if?? 
(?? 
SetField?? 
(?? 
ref?? 
_loads?? #
,??# $
value??% *
)??* +
)??+ ,
{@@ 
OnPropertyChangedAA !
(AA! "
nameofAA" (
(AA( )
HasLoadsAA) 1
)AA1 2
)AA2 3
;AA3 4
_loadsBB 
.BB 
CollectionChangedBB (
+=BB) +
(BB, -
sBB- .
,BB. /
eBB0 1
)BB1 2
=>BB3 5
OnPropertyChangedBB6 G
(BBG H
nameofBBH N
(BBN O
HasLoadsBBO W
)BBW X
)BBX Y
;BBY Z
}CC 
}DD 	
}EE 
publicGG 


DictionaryGG 
<GG 
stringGG 
,GG 
objectGG $
>GG$ %
?GG% &

SpecValuesGG' 1
{HH 
getII 
=>II 
_specValuesII 
;II 
setJJ 
=>JJ 
SetFieldJJ 
(JJ 
refJJ 
_specValuesJJ '
,JJ' (
valueJJ) .
)JJ. /
;JJ/ 0
}KK 
publicMM 

Model_DunnageTypeMM 
?MM 
SelectedTypeMM *
{NN 
getOO 
=>OO 
_selectedTypeOO 
;OO 
setPP 
=>PP 
SetFieldPP 
(PP 
refPP 
_selectedTypePP )
,PP) *
valuePP+ 0
)PP0 1
;PP1 2
}QQ 
publicSS 

boolSS 
HasLoadsSS 
=>SS 
LoadsSS !
.SS! "
CountSS" '
>SS( )
$numSS* +
;SS+ ,
publicUU 
 
Model_DunnageSessionUU 
(UU  
)UU  !
{VV 
_loadsWW 
.WW 
CollectionChangedWW  
+=WW! #
(WW$ %
sWW% &
,WW& '
eWW( )
)WW) *
=>WW+ -
OnPropertyChangedWW. ?
(WW? @
nameofWW@ F
(WWF G
HasLoadsWWG O
)WWO P
)WWP Q
;WWQ R
}XX 
publicZZ 

eventZZ '
PropertyChangedEventHandlerZZ ,
?ZZ, -
PropertyChangedZZ. =
;ZZ= >
	protected\\ 
virtual\\ 
void\\ 
OnPropertyChanged\\ ,
(\\, -
[\\- .
CallerMemberName\\. >
]\\> ?
string\\@ F
?\\F G
propertyName\\H T
=\\U V
null\\W [
)\\[ \
{]] 
PropertyChanged^^ 
?^^ 
.^^ 
Invoke^^ 
(^^  
this^^  $
,^^$ %
new^^& )$
PropertyChangedEventArgs^^* B
(^^B C
propertyName^^C O
)^^O P
)^^P Q
;^^Q R
}__ 
	protectedaa 
boolaa 
SetFieldaa 
<aa 
Taa 
>aa 
(aa 
refaa "
Taa# $
fieldaa% *
,aa* +
Taa, -
valueaa. 3
,aa3 4
[aa5 6
CallerMemberNameaa6 F
]aaF G
stringaaH N
?aaN O
propertyNameaaP \
=aa] ^
nullaa_ c
)aac d
{bb 
ifcc 

(cc 
EqualityComparercc 
<cc 
Tcc 
>cc 
.cc  
Defaultcc  '
.cc' (
Equalscc( .
(cc. /
fieldcc/ 4
,cc4 5
valuecc6 ;
)cc; <
)cc< =
returncc> D
falseccE J
;ccJ K
fielddd 
=dd 
valuedd 
;dd 
OnPropertyChangedee 
(ee 
propertyNameee &
)ee& '
;ee' (
returnff 
trueff 
;ff 
}gg 
}hh ıB
YC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Dunnage\Model_DunnagePart.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Dunnage+ 2
;2 3
public		 
class		 
Model_DunnagePart		 
:		  "
INotifyPropertyChanged		! 7
{

 
private 
int 
_id 
; 
private 
string 
_partId 
= 
string #
.# $
Empty$ )
;) *
private 
int 
_typeId 
; 
private 
string 
_specValues 
=  
string! '
.' (
Empty( -
;- .
private 

Dictionary 
< 
string 
, 
object %
>% &
_specValuesDict' 6
=7 8
new9 <
(< =
)= >
;> ?
private 
string 
_dunnageTypeName #
=$ %
string& ,
., -
Empty- 2
;2 3
private 
string 

_createdBy 
= 
string  &
.& '
Empty' ,
;, -
private 
DateTime 
_createdDate !
=" #
DateTime$ ,
., -
Now- 0
;0 1
private 
string 
? 
_modifiedBy 
;  
private 
DateTime 
? 
_modifiedDate #
;# $
public 

int 
Id 
{ 
get 
=> 
_id 
; 
set 
=> 
SetField 
( 
ref 
_id 
,  
value! &
)& '
;' (
} 
public 

string 
PartId 
{ 
get 
=> 
_partId 
; 
set 
=> 
SetField 
( 
ref 
_partId #
,# $
value% *
)* +
;+ ,
}   
public"" 

int"" 
TypeId"" 
{## 
get$$ 
=>$$ 
_typeId$$ 
;$$ 
set%% 
=>%% 
SetField%% 
(%% 
ref%% 
_typeId%% #
,%%# $
value%%% *
)%%* +
;%%+ ,
}&& 
public(( 

string(( 

SpecValues(( 
{)) 
get** 
=>** 
_specValues** 
;** 
set++ 
{,, 	
if-- 
(-- 
SetField-- 
(-- 
ref-- 
_specValues-- (
,--( )
value--* /
)--/ 0
)--0 1
{.. !
DeserializeSpecValues// %
(//% &
)//& '
;//' (
}00 
}11 	
}22 
public44 


Dictionary44 
<44 
string44 
,44 
object44 $
>44$ %
SpecValuesDict44& 4
{55 
get66 
=>66 
_specValuesDict66 
;66 
set77 
=>77 
SetField77 
(77 
ref77 
_specValuesDict77 +
,77+ ,
value77- 2
)772 3
;773 4
}88 
public:: 

string:: 
DunnageTypeName:: !
{;; 
get<< 
=><< 
_dunnageTypeName<< 
;<<  
set== 
=>== 
SetField== 
(== 
ref== 
_dunnageTypeName== ,
,==, -
value==. 3
)==3 4
;==4 5
}>> 
public@@ 

string@@ 
	CreatedBy@@ 
{AA 
getBB 
=>BB 

_createdByBB 
;BB 
setCC 
=>CC 
SetFieldCC 
(CC 
refCC 

_createdByCC &
,CC& '
valueCC( -
)CC- .
;CC. /
}DD 
publicFF 

DateTimeFF 
CreatedDateFF 
{GG 
getHH 
=>HH 
_createdDateHH 
;HH 
setII 
=>II 
SetFieldII 
(II 
refII 
_createdDateII (
,II( )
valueII* /
)II/ 0
;II0 1
}JJ 
publicLL 

stringLL 
?LL 

ModifiedByLL 
{MM 
getNN 
=>NN 
_modifiedByNN 
;NN 
setOO 
=>OO 
SetFieldOO 
(OO 
refOO 
_modifiedByOO '
,OO' (
valueOO) .
)OO. /
;OO/ 0
}PP 
publicRR 

DateTimeRR 
?RR 
ModifiedDateRR !
{SS 
getTT 
=>TT 
_modifiedDateTT 
;TT 
setUU 
=>UU 
SetFieldUU 
(UU 
refUU 
_modifiedDateUU )
,UU) *
valueUU+ 0
)UU0 1
;UU1 2
}VV 
publicXX 

eventXX '
PropertyChangedEventHandlerXX ,
?XX, -
PropertyChangedXX. =
;XX= >
	protectedZZ 
virtualZZ 
voidZZ 
OnPropertyChangedZZ ,
(ZZ, -
[ZZ- .
CallerMemberNameZZ. >
]ZZ> ?
stringZZ@ F
?ZZF G
propertyNameZZH T
=ZZU V
nullZZW [
)ZZ[ \
{[[ 
PropertyChanged\\ 
?\\ 
.\\ 
Invoke\\ 
(\\  
this\\  $
,\\$ %
new\\& )$
PropertyChangedEventArgs\\* B
(\\B C
propertyName\\C O
)\\O P
)\\P Q
;\\Q R
}]] 
	protected__ 
bool__ 
SetField__ 
<__ 
T__ 
>__ 
(__ 
ref__ "
T__# $
field__% *
,__* +
T__, -
value__. 3
,__3 4
[__5 6
CallerMemberName__6 F
]__F G
string__H N
?__N O
propertyName__P \
=__] ^
null___ c
)__c d
{`` 
ifaa 

(aa 
EqualityCompareraa 
<aa 
Taa 
>aa 
.aa  
Defaultaa  '
.aa' (
Equalsaa( .
(aa. /
fieldaa/ 4
,aa4 5
valueaa6 ;
)aa; <
)aa< =
returnaa> D
falseaaE J
;aaJ K
fieldbb 
=bb 
valuebb 
;bb 
OnPropertyChangedcc 
(cc 
propertyNamecc &
)cc& '
;cc' (
returndd 
truedd 
;dd 
}ee 
privategg 
voidgg !
DeserializeSpecValuesgg &
(gg& '
)gg' (
{hh 
tryii 
{jj 	
ifkk 
(kk 
stringkk 
.kk 
IsNullOrWhiteSpacekk )
(kk) *

SpecValueskk* 4
)kk4 5
)kk5 6
{ll 
SpecValuesDictmm 
=mm  
newmm! $

Dictionarymm% /
<mm/ 0
stringmm0 6
,mm6 7
objectmm8 >
>mm> ?
(mm? @
)mm@ A
;mmA B
returnnn 
;nn 
}oo 
varqq 
dictqq 
=qq 
JsonSerializerqq %
.qq% &
Deserializeqq& 1
<qq1 2

Dictionaryqq2 <
<qq< =
stringqq= C
,qqC D
objectqqE K
>qqK L
>qqL M
(qqM N

SpecValuesqqN X
)qqX Y
;qqY Z
SpecValuesDictrr 
=rr 
dictrr !
??rr" $
newrr% (

Dictionaryrr) 3
<rr3 4
stringrr4 :
,rr: ;
objectrr< B
>rrB C
(rrC D
)rrD E
;rrE F
}ss 	
catchtt 
{uu 	
SpecValuesDictvv 
=vv 
newvv  

Dictionaryvv! +
<vv+ ,
stringvv, 2
,vv2 3
objectvv4 :
>vv: ;
(vv; <
)vv< =
;vv= >
}ww 	
}xx 
}yy ﬂx
HC:\Users\johnk\source\repos\MTM_Receiving_Application\MainWindow.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
{ 
public 

sealed 
partial 
class 

MainWindow  *
:+ ,
Window- 3
{ 
public &
Shared_MainWindowViewModel )
	ViewModel* 3
{4 5
get6 9
;9 :
}; <
private 
readonly '
IService_UserSessionManager 4
_sessionManager5 D
;D E
public 

MainWindow 
( &
Shared_MainWindowViewModel 4
	viewModel5 >
,> ?'
IService_UserSessionManager@ [
sessionManager\ j
)j k
{ 	
InitializeComponent 
(  
)  !
;! "
	ViewModel 
= 
	viewModel !
;! "
_sessionManager 
= 
sessionManager ,
;, -
	AppWindow 
. 
Resize 
( 
new  
Windows! (
.( )
Graphics) 1
.1 2
	SizeInt322 ;
(; <
$num< @
,@ A
$numB E
)E F
)F G
;G H
CenterWindow 
( 
) 
; 
try 
{ 
if   
(   
	AppWindow   
.   
TitleBar   &
!=  ' )
null  * .
)  . /
{!! 
var"" 
redColor""  
=""! "
Windows""# *
.""* +
UI""+ -
.""- .
Color"". 3
.""3 4
FromArgb""4 <
(""< =
$num""= @
,""@ A
$num""B E
,""E F
$num""G I
,""I J
$num""K M
)""M N
;""N O
var## 

whiteColor## "
=### $
Windows##% ,
.##, -
UI##- /
.##/ 0
Color##0 5
.##5 6
FromArgb##6 >
(##> ?
$num##? B
,##B C
$num##D G
,##G H
$num##I L
,##L M
$num##N Q
)##Q R
;##R S
	AppWindow%% 
.%% 
TitleBar%% &
.%%& '
ForegroundColor%%' 6
=%%7 8

whiteColor%%9 C
;%%C D
	AppWindow&& 
.&& 
TitleBar&& &
.&&& '
BackgroundColor&&' 6
=&&7 8
redColor&&9 A
;&&A B
	AppWindow'' 
.'' 
TitleBar'' &
.''& '!
ButtonForegroundColor''' <
=''= >

whiteColor''? I
;''I J
	AppWindow(( 
.(( 
TitleBar(( &
.((& '!
ButtonBackgroundColor((' <
=((= >
redColor((? G
;((G H
	AppWindow)) 
.)) 
TitleBar)) &
.))& '&
ButtonHoverBackgroundColor))' A
=))B C
Windows))D K
.))K L
UI))L N
.))N O
Color))O T
.))T U
FromArgb))U ]
())] ^
$num))^ a
,))a b
$num))c f
,))f g
$num))h j
,))j k
$num))l n
)))n o
;))o p
	AppWindow** 
.** 
TitleBar** &
.**& '&
ButtonHoverForegroundColor**' A
=**B C

whiteColor**D N
;**N O
	AppWindow++ 
.++ 
TitleBar++ &
.++& '#
InactiveForegroundColor++' >
=++? @
Windows++A H
.++H I
UI++I K
.++K L
Color++L Q
.++Q R
FromArgb++R Z
(++Z [
$num++[ ^
,++^ _
$num++` c
,++c d
$num++e h
,++h i
$num++j m
)++m n
;++n o
	AppWindow,, 
.,, 
TitleBar,, &
.,,& '#
InactiveBackgroundColor,,' >
=,,? @
Windows,,A H
.,,H I
UI,,I K
.,,K L
Color,,L Q
.,,Q R
FromArgb,,R Z
(,,Z [
$num,,[ ^
,,,^ _
$num,,` c
,,,c d
$num,,e f
,,,f g
$num,,h i
),,i j
;,,j k
}-- 
this.. 
... 
Title.. 
=.. 
$str.. \
;..\ ]
}// 
catch00 
{00 
}00> ?
if44 
(44 
_sessionManager44 
.44  
CurrentSession44  .
!=44/ 1
null442 6
)446 7
{55 
var66 
user66 
=66 
_sessionManager66 *
.66* +
CurrentSession66+ 9
.669 :
User66: >
;66> ? 
UserDisplayTextBlock77 $
.77$ %
Text77% )
=77* +
user77, 0
.770 1
DisplayName771 <
;77< =
UserPicture88 
.88 
DisplayName88 '
=88( )
user88* .
.88. /
DisplayName88/ :
;88: ;
}99 
if<< 
(<< 
Content<< 
is<< 
	UIElement<< $
rootElement<<% 0
)<<0 1
{== 
rootElement>> 
.>> 
PointerMoved>> (
+=>>) +
(>>, -
s>>- .
,>>. /
e>>0 1
)>>1 2
=>>>3 5
_sessionManager>>6 E
.>>E F
UpdateLastActivity>>F X
(>>X Y
)>>Y Z
;>>Z [
rootElement?? 
.?? 
KeyDown?? #
+=??$ &
(??' (
s??( )
,??) *
e??+ ,
)??, -
=>??. 0
_sessionManager??1 @
.??@ A
UpdateLastActivity??A S
(??S T
)??T U
;??U V
}@@ 
thisBB 
.BB 
	ActivatedBB 
+=BB  
MainWindow_ActivatedBB 2
;BB2 3
thisCC 
.CC 
ClosedCC 
+=CC 
MainWindow_ClosedCC ,
;CC, -
}DD 	
privateFF 
voidFF 
MainWindow_ClosedFF &
(FF& '
objectFF' -
senderFF. 4
,FF4 5
WindowEventArgsFF6 E
argsFFF J
)FFJ K
{GG 	
ApplicationII 
.II 
CurrentII 
.II  
ExitII  $
(II$ %
)II% &
;II& '
}JJ 	
privateLL 
voidLL  
MainWindow_ActivatedLL )
(LL) *
objectLL* 0
senderLL1 7
,LL7 8$
WindowActivatedEventArgsLL9 Q
argsLLR V
)LLV W
{MM 	
ifNN 
(NN 
argsNN 
.NN !
WindowActivationStateNN *
!=NN+ -!
WindowActivationStateNN. C
.NNC D
DeactivatedNND O
)NNO P
{OO 
_sessionManagerPP 
.PP  
UpdateLastActivityPP  2
(PP2 3
)PP3 4
;PP4 5
}QQ 
}RR 	
privateTT 
voidTT $
NavView_SelectionChangedTT -
(TT- .
NavigationViewTT. <
senderTT= C
,TTC D3
'NavigationViewSelectionChangedEventArgsTTE l
argsTTm q
)TTq r
{UU 	
ifVV 
(VV 
argsVV 
.VV 
IsSettingsSelectedVV '
)VV' (
{WW 
PageTitleTextBlockXX "
.XX" #
TextXX# '
=XX( )
$strXX* 4
;XX4 5
}ZZ 
else[[ 
if[[ 
([[ 
args[[ 
.[[ 
SelectedItem[[ &
is[[' )
NavigationViewItem[[* <
item[[= A
)[[A B
{\\ 
var]] 
tag]] 
=]] 
item]] 
.]] 
Tag]] "
?]]" #
.]]# $
ToString]]$ ,
(]], -
)]]- .
;]]. /
switch^^ 
(^^ 
tag^^ 
)^^ 
{__ 
case`` 
$str`` 0
:``0 1
PageTitleTextBlockaa *
.aa* +
Textaa+ /
=aa0 1
$straa2 F
;aaF G
ContentFramebb $
.bb$ %
Navigatebb% -
(bb- .
typeofbb. 4
(bb4 5
Viewsbb5 :
.bb: ;
	Receivingbb; D
.bbD E"
Receiving_WorkflowViewbbE [
)bb[ \
)bb\ ]
;bb] ^
ContentFramecc $
.cc$ %
	Navigatedcc% .
+=cc/ 1"
ContentFrame_Navigatedcc2 H
;ccH I
breakdd 
;dd 
caseee 
$stree +
:ee+ ,
PageTitleTextBlockff *
.ff* +
Textff+ /
=ff0 1
$strff2 B
;ffB C
ContentFramegg $
.gg$ %
Navigategg% -
(gg- .
typeofgg. 4
(gg4 5
Viewsgg5 :
.gg: ;
Dunnagegg; B
.ggB C 
Dunnage_WorkflowViewggC W
)ggW X
)ggX Y
;ggY Z
ContentFramehh $
.hh$ %
	Navigatedhh% .
+=hh/ 1"
ContentFrame_Navigatedhh2 H
;hhH I
breakii 
;ii 
casejj 
$strjj 3
:jj3 4
PageTitleTextBlockkk *
.kk* +
Textkk+ /
=kk0 1
$strkk2 D
;kkD E
ContentFramell $
.ll$ %
Navigatell% -
(ll- .
typeofll. 4
(ll4 5
Viewsll5 :
.ll: ;
Mainll; ?
.ll? @)
Main_CarrierDeliveryLabelPagell@ ]
)ll] ^
)ll^ _
;ll_ `
breakmm 
;mm 
}nn 
}oo 
}pp 	
privaterr 
voidrr "
ContentFrame_Navigatedrr +
(rr+ ,
objectrr, 2
senderrr3 9
,rr9 :
	Microsoftrr; D
.rrD E
UIrrE G
.rrG H
XamlrrH L
.rrL M

NavigationrrM W
.rrW X
NavigationEventArgsrrX k
errl m
)rrm n
{ss 	
ifuu 
(uu 
ContentFrameuu 
.uu 
Contentuu $
isuu% '
Viewsuu( -
.uu- .
	Receivinguu. 7
.uu7 8"
Receiving_WorkflowViewuu8 N
receivingViewuuO \
)uu\ ]
{vv 
varww 
	viewModelww 
=ww 
receivingViewww  -
.ww- .
	ViewModelww. 7
;ww7 8
ifxx 
(xx 
	viewModelxx 
!=xx  
nullxx! %
)xx% &
{yy 
PageTitleTextBlock{{ &
.{{& '
Text{{' +
={{, -
	viewModel{{. 7
.{{7 8
CurrentStepTitle{{8 H
;{{H I
	viewModel~~ 
.~~ 
PropertyChanged~~ -
+=~~. 0
(~~1 2
s~~2 3
,~~3 4
args~~5 9
)~~9 :
=>~~; =
{ 
if
ÄÄ 
(
ÄÄ 
args
ÄÄ  
.
ÄÄ  !
PropertyName
ÄÄ! -
==
ÄÄ. 0
nameof
ÄÄ1 7
(
ÄÄ7 8
	viewModel
ÄÄ8 A
.
ÄÄA B
CurrentStepTitle
ÄÄB R
)
ÄÄR S
)
ÄÄS T
{
ÅÅ  
PageTitleTextBlock
ÇÇ .
.
ÇÇ. /
Text
ÇÇ/ 3
=
ÇÇ4 5
	viewModel
ÇÇ6 ?
.
ÇÇ? @
CurrentStepTitle
ÇÇ@ P
;
ÇÇP Q
}
ÉÉ 
}
ÑÑ 
;
ÑÑ 
}
ÖÖ 
}
ÜÜ 
else
àà 
if
àà 
(
àà 
ContentFrame
àà !
.
àà! "
Content
àà" )
is
àà* ,
Views
àà- 2
.
àà2 3
Dunnage
àà3 :
.
àà: ;"
Dunnage_WorkflowView
àà; O
dunnageView
ààP [
)
àà[ \
{
ââ 
var
ää 
	viewModel
ää 
=
ää 
dunnageView
ää  +
.
ää+ ,
	ViewModel
ää, 5
;
ää5 6
if
ãã 
(
ãã 
	viewModel
ãã 
!=
ãã  
null
ãã! %
)
ãã% &
{
åå  
PageTitleTextBlock
éé &
.
éé& '
Text
éé' +
=
éé, -
	viewModel
éé. 7
.
éé7 8
CurrentStepTitle
éé8 H
;
ééH I
	viewModel
ëë 
.
ëë 
PropertyChanged
ëë -
+=
ëë. 0
(
ëë1 2
s
ëë2 3
,
ëë3 4
args
ëë5 9
)
ëë9 :
=>
ëë; =
{
íí 
if
ìì 
(
ìì 
args
ìì  
.
ìì  !
PropertyName
ìì! -
==
ìì. 0
nameof
ìì1 7
(
ìì7 8
	viewModel
ìì8 A
.
ììA B
CurrentStepTitle
ììB R
)
ììR S
)
ììS T
{
îî  
PageTitleTextBlock
ïï .
.
ïï. /
Text
ïï/ 3
=
ïï4 5
	viewModel
ïï6 ?
.
ïï? @
CurrentStepTitle
ïï@ P
;
ïïP Q
}
ññ 
}
óó 
;
óó 
}
òò 
}
ôô 
}
öö 	
public
†† 
void
†† 
UpdateUserDisplay
†† %
(
††% &
)
††& '
{
°° 	
if
¢¢ 
(
¢¢ 
_sessionManager
¢¢ 
.
¢¢  
CurrentSession
¢¢  .
!=
¢¢/ 1
null
¢¢2 6
)
¢¢6 7
{
££ 
var
§§ 
user
§§ 
=
§§ 
_sessionManager
§§ *
.
§§* +
CurrentSession
§§+ 9
.
§§9 :
User
§§: >
;
§§> ?"
UserDisplayTextBlock
•• $
.
••$ %
Text
••% )
=
••* +
user
••, 0
.
••0 1
DisplayName
••1 <
;
••< =
UserPicture
¶¶ 
.
¶¶ 
DisplayName
¶¶ '
=
¶¶( )
user
¶¶* .
.
¶¶. /
DisplayName
¶¶/ :
;
¶¶: ;
}
ßß 
}
®® 	
private
≠≠ 
void
≠≠ 
CenterWindow
≠≠ !
(
≠≠! "
)
≠≠" #
{
ÆÆ 	
var
ØØ 
displayArea
ØØ 
=
ØØ 
	Microsoft
ØØ '
.
ØØ' (
UI
ØØ( *
.
ØØ* +
	Windowing
ØØ+ 4
.
ØØ4 5
DisplayArea
ØØ5 @
.
ØØ@ A
Primary
ØØA H
;
ØØH I
var
∞∞ 
workArea
∞∞ 
=
∞∞ 
displayArea
∞∞ &
.
∞∞& '
WorkArea
∞∞' /
;
∞∞/ 0
var
≤≤ 
centerX
≤≤ 
=
≤≤ 
(
≤≤ 
workArea
≤≤ #
.
≤≤# $
Width
≤≤$ )
-
≤≤* +
$num
≤≤, 0
)
≤≤0 1
/
≤≤2 3
$num
≤≤4 5
;
≤≤5 6
var
≥≥ 
centerY
≥≥ 
=
≥≥ 
(
≥≥ 
workArea
≥≥ #
.
≥≥# $
Height
≥≥$ *
-
≥≥+ ,
$num
≥≥- 0
)
≥≥0 1
/
≥≥2 3
$num
≥≥4 5
;
≥≥5 6
	AppWindow
µµ 
.
µµ 
Move
µµ 
(
µµ 
new
µµ 
Windows
µµ &
.
µµ& '
Graphics
µµ' /
.
µµ/ 0

PointInt32
µµ0 :
(
µµ: ;
centerX
µµ; B
,
µµB C
centerY
µµD K
)
µµK L
)
µµL M
;
µµM N
}
∂∂ 	
}
∑∑ 
}∏∏ «
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Core\Model_Dao_Result_Factory.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Core+ /
;/ 0
public		 
static		 
class		 $
Model_Dao_Result_Factory		 ,
{

 
public 

static 
Model_Dao_Result "
Failure# *
(* +
string+ 1
message2 9
,9 :
	Exception; D
?D E
exF H
=I J
nullK O
)O P
{ 
return 
new 
Model_Dao_Result #
{ 	
Success 
= 
false 
, 
ErrorMessage 
= 
message "
," #
	Exception 
= 
ex 
, 
Severity 
= 
Enum_ErrorSeverity )
.) *
Error* /
} 	
;	 

} 
public 

static 
Model_Dao_Result "
Success# *
(* +
int+ .
affectedRows/ ;
=< =
$num> ?
)? @
{ 
return 
new 
Model_Dao_Result #
{ 	
Success 
= 
true 
, 
AffectedRows 
= 
affectedRows '
} 	
;	 

} 
public 

static 
Model_Dao_Result "
<" #
T# $
>$ %
Failure& -
<- .
T. /
>/ 0
(0 1
string1 7
message8 ?
,? @
	ExceptionA J
?J K
exL N
=O P
nullQ U
)U V
{   
return!! 
new!! 
Model_Dao_Result!! #
<!!# $
T!!$ %
>!!% &
{"" 	
Success## 
=## 
false## 
,## 
ErrorMessage$$ 
=$$ 
message$$ "
,$$" #
	Exception%% 
=%% 
ex%% 
,%% 
Severity&& 
=&& 
Enum_ErrorSeverity&& )
.&&) *
Error&&* /
}'' 	
;''	 

}(( 
public** 

static** 
Model_Dao_Result** "
<**" #
T**# $
>**$ %
Success**& -
<**- .
T**. /
>**/ 0
(**0 1
T**1 2
data**3 7
,**7 8
int**9 <
affectedRows**= I
=**J K
$num**L M
)**M N
{++ 
return,, 
new,, 
Model_Dao_Result,, #
<,,# $
T,,$ %
>,,% &
{-- 	
Success.. 
=.. 
true.. 
,.. 
Data// 
=// 
data// 
,// 
AffectedRows00 
=00 
affectedRows00 '
}11 	
;11	 

}22 
}33 ˝
UC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Core\Model_Dao_Result.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Core+ /
;/ 0
public

 
class

 
Model_Dao_Result

 
{ 
public 

bool 
Success 
{ 
get 
; 
set "
;" #
}$ %
=& '
false( -
;- .
public 

bool 
	IsSuccess 
=> 
Success $
;$ %
public 

string 
ErrorMessage 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 

Enum_ErrorSeverity 
Severity &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
Enum_ErrorSeverity7 I
.I J
InfoJ N
;N O
public## 

int## 
AffectedRows## 
{## 
get## !
;##! "
set### &
;##& '
}##( )
=##* +
$num##, -
;##- .
public(( 

long(( 
ExecutionTimeMs(( 
{((  !
get((" %
;((% &
set((' *
;((* +
}((, -
=((. /
$num((0 1
;((1 2
public-- 

object-- 
?-- 
ReturnValue-- 
{--  
get--! $
;--$ %
set--& )
;--) *
}--+ ,
=--- .
null--/ 3
;--3 4
public22 

	Exception22 
?22 
	Exception22 
{22  !
get22" %
;22% &
set22' *
;22* +
}22, -
}55 
public;; 
class;; 
Model_Dao_Result;; 
<;; 
T;; 
>;;  
:;;! "
Model_Dao_Result;;# 3
{<< 
public@@ 

T@@ 
?@@ 
Data@@ 
{@@ 
get@@ 
;@@ 
set@@ 
;@@ 
}@@  
}BB æR
YC:\Users\johnk\source\repos\MTM_Receiving_Application\Models\Dunnage\Model_DunnageLoad.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Models$ *
.* +
Dunnage+ 2
;2 3
public 
class 
Model_DunnageLoad 
:  "
INotifyPropertyChanged! 7
{		 
private

 
Guid

 
	_loadUuid

 
;

 
private 
string 
_partId 
= 
string #
.# $
Empty$ )
;) *
private 
decimal 
	_quantity 
; 
private 
string 
	_poNumber 
= 
string %
.% &
Empty& +
;+ ,
private 
string 
_dunnageType 
=  !
string" (
.( )
Empty) .
;. /
private 

Dictionary 
< 
string 
, 
object %
>% &
_specs' -
=. /
new0 3
(3 4
)4 5
;5 6
private 
string 
	_location 
= 
string %
.% &
Empty& +
;+ ,
private 
string 
	_typeName 
= 
string %
.% &
Empty& +
;+ ,
private 
string 
_inventoryMethod #
=$ %
$str& 1
;1 2
private 

Dictionary 
< 
string 
, 
object %
>% &
?& '
_specValues( 3
;3 4
private 
DateTime 
_receivedDate "
=# $
DateTime% -
.- .
Now. 1
;1 2
private 
string 

_createdBy 
= 
string  &
.& '
Empty' ,
;, -
private 
DateTime 
_createdDate !
=" #
DateTime$ ,
., -
Now- 0
;0 1
private 
string 
? 
_modifiedBy 
;  
private 
DateTime 
? 
_modifiedDate #
;# $
private 
int 
_loadNumber 
; 
private 
bool 
_isSelected 
; 
public 

Guid 
LoadUuid 
{ 
get 
=> 
	_loadUuid 
; 
set   
=>   
SetField   
(   
ref   
	_loadUuid   %
,  % &
value  ' ,
)  , -
;  - .
}!! 
public## 

string## 
PartId## 
{$$ 
get%% 
=>%% 
_partId%% 
;%% 
set&& 
=>&& 
SetField&& 
(&& 
ref&& 
_partId&& #
,&&# $
value&&% *
)&&* +
;&&+ ,
}'' 
public)) 

decimal)) 
Quantity)) 
{** 
get++ 
=>++ 
	_quantity++ 
;++ 
set,, 
=>,, 
SetField,, 
(,, 
ref,, 
	_quantity,, %
,,,% &
value,,' ,
),,, -
;,,- .
}-- 
public// 

string// 
PoNumber// 
{00 
get11 
=>11 
	_poNumber11 
;11 
set22 
=>22 
SetField22 
(22 
ref22 
	_poNumber22 %
,22% &
value22' ,
)22, -
;22- .
}33 
public55 

string55 
DunnageType55 
{66 
get77 
=>77 
_dunnageType77 
;77 
set88 
=>88 
SetField88 
(88 
ref88 
_dunnageType88 (
,88( )
value88* /
)88/ 0
;880 1
}99 
public;; 


Dictionary;; 
<;; 
string;; 
,;; 
object;; $
>;;$ %
Specs;;& +
{<< 
get== 
=>== 
_specs== 
;== 
set>> 
=>>> 
SetField>> 
(>> 
ref>> 
_specs>> "
,>>" #
value>>$ )
)>>) *
;>>* +
}?? 
publicAA 

stringAA 
LocationAA 
{BB 
getCC 
=>CC 
	_locationCC 
;CC 
setDD 
=>DD 
SetFieldDD 
(DD 
refDD 
	_locationDD %
,DD% &
valueDD' ,
)DD, -
;DD- .
}EE 
publicGG 

stringGG 
TypeNameGG 
{HH 
getII 
=>II 
	_typeNameII 
;II 
setJJ 
=>JJ 
SetFieldJJ 
(JJ 
refJJ 
	_typeNameJJ %
,JJ% &
valueJJ' ,
)JJ, -
;JJ- .
}KK 
publicMM 

stringMM 
InventoryMethodMM !
{NN 
getOO 
=>OO 
_inventoryMethodOO 
;OO  
setPP 
=>PP 
SetFieldPP 
(PP 
refPP 
_inventoryMethodPP ,
,PP, -
valuePP. 3
)PP3 4
;PP4 5
}QQ 
publicSS 


DictionarySS 
<SS 
stringSS 
,SS 
objectSS $
>SS$ %
?SS% &

SpecValuesSS' 1
{TT 
getUU 
=>UU 
_specValuesUU 
;UU 
setVV 
=>VV 
SetFieldVV 
(VV 
refVV 
_specValuesVV '
,VV' (
valueVV) .
)VV. /
;VV/ 0
}WW 
publicYY 

DateTimeYY 
ReceivedDateYY  
{ZZ 
get[[ 
=>[[ 
_receivedDate[[ 
;[[ 
set\\ 
=>\\ 
SetField\\ 
(\\ 
ref\\ 
_receivedDate\\ )
,\\) *
value\\+ 0
)\\0 1
;\\1 2
}]] 
public__ 

string__ 
	CreatedBy__ 
{`` 
getaa 
=>aa 

_createdByaa 
;aa 
setbb 
=>bb 
SetFieldbb 
(bb 
refbb 

_createdBybb &
,bb& '
valuebb( -
)bb- .
;bb. /
}cc 
publicee 

DateTimeee 
CreatedDateee 
{ff 
getgg 
=>gg 
_createdDategg 
;gg 
sethh 
=>hh 
SetFieldhh 
(hh 
refhh 
_createdDatehh (
,hh( )
valuehh* /
)hh/ 0
;hh0 1
}ii 
publickk 

stringkk 
?kk 

ModifiedBykk 
{ll 
getmm 
=>mm 
_modifiedBymm 
;mm 
setnn 
=>nn 
SetFieldnn 
(nn 
refnn 
_modifiedBynn '
,nn' (
valuenn) .
)nn. /
;nn/ 0
}oo 
publicqq 

DateTimeqq 
?qq 
ModifiedDateqq !
{rr 
getss 
=>ss 
_modifiedDatess 
;ss 
settt 
=>tt 
SetFieldtt 
(tt 
reftt 
_modifiedDatett )
,tt) *
valuett+ 0
)tt0 1
;tt1 2
}uu 
publicww 

intww 

LoadNumberww 
{xx 
getyy 
=>yy 
_loadNumberyy 
;yy 
setzz 
=>zz 
SetFieldzz 
(zz 
refzz 
_loadNumberzz '
,zz' (
valuezz) .
)zz. /
;zz/ 0
}{{ 
public}} 

bool}} 

IsSelected}} 
{~~ 
get 
=> 
_isSelected 
; 
set
ÄÄ 
=>
ÄÄ 
SetField
ÄÄ 
(
ÄÄ 
ref
ÄÄ 
_isSelected
ÄÄ '
,
ÄÄ' (
value
ÄÄ) .
)
ÄÄ. /
;
ÄÄ/ 0
}
ÅÅ 
public
ÉÉ 

event
ÉÉ )
PropertyChangedEventHandler
ÉÉ ,
?
ÉÉ, -
PropertyChanged
ÉÉ. =
;
ÉÉ= >
	protected
ÖÖ 
virtual
ÖÖ 
void
ÖÖ 
OnPropertyChanged
ÖÖ ,
(
ÖÖ, -
[
ÖÖ- .
CallerMemberName
ÖÖ. >
]
ÖÖ> ?
string
ÖÖ@ F
?
ÖÖF G
propertyName
ÖÖH T
=
ÖÖU V
null
ÖÖW [
)
ÖÖ[ \
{
ÜÜ 
PropertyChanged
áá 
?
áá 
.
áá 
Invoke
áá 
(
áá  
this
áá  $
,
áá$ %
new
áá& )&
PropertyChangedEventArgs
áá* B
(
ááB C
propertyName
ááC O
)
ááO P
)
ááP Q
;
ááQ R
}
àà 
	protected
ää 
bool
ää 
SetField
ää 
<
ää 
T
ää 
>
ää 
(
ää 
ref
ää "
T
ää# $
field
ää% *
,
ää* +
T
ää, -
value
ää. 3
,
ää3 4
[
ää5 6
CallerMemberName
ää6 F
]
ääF G
string
ääH N
?
ääN O
propertyName
ääP \
=
ää] ^
null
ää_ c
)
ääc d
{
ãã 
if
åå 

(
åå 
EqualityComparer
åå 
<
åå 
T
åå 
>
åå 
.
åå  
Default
åå  '
.
åå' (
Equals
åå( .
(
åå. /
field
åå/ 4
,
åå4 5
value
åå6 ;
)
åå; <
)
åå< =
return
åå> D
false
ååE J
;
ååJ K
field
çç 
=
çç 
value
çç 
;
çç 
OnPropertyChanged
éé 
(
éé 
propertyName
éé &
)
éé& '
;
éé' (
return
èè 
true
èè 
;
èè 
}
êê 
}ëë àå
gC:\Users\johnk\source\repos\MTM_Receiving_Application\Helpers\UI\Helper_WorkflowHelpContentGenerator.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Helpers$ +
.+ ,
UI, .
{ 
public 

static 
class /
#Helper_WorkflowHelpContentGenerator ;
{		 
public

 
static

 
	UIElement

 
GenerateHelpContent

  3
(

3 4
WorkflowStep

4 @
step

A E
)

E F
{ 	
return 
step 
switch 
{ 
WorkflowStep 
. 
ModeSelection *
=>+ -#
CreateModeSelectionHelp. E
(E F
)F G
,G H
WorkflowStep 
. 
ManualEntry (
=>) +!
CreateManualEntryHelp, A
(A B
)B C
,C D
WorkflowStep 
. 
POEntry $
=>% '
CreatePOEntryHelp( 9
(9 :
): ;
,; <
WorkflowStep 
. 
	LoadEntry &
=>' )
CreateLoadEntryHelp* =
(= >
)> ?
,? @
WorkflowStep 
. 
WeightQuantityEntry 0
=>1 3$
CreateWeightQuantityHelp4 L
(L M
)M N
,N O
WorkflowStep 
. 
HeatLotEntry )
=>* ,
CreateHeatLotHelp- >
(> ?
)? @
,@ A
WorkflowStep 
. 
PackageTypeEntry -
=>. 0!
CreatePackageTypeHelp1 F
(F G
)G H
,H I
WorkflowStep 
. 
Review #
=>$ &
CreateReviewHelp' 7
(7 8
)8 9
,9 :
_ 
=> 
CreateDefaultHelp &
(& '
)' (
} 
; 
} 	
private 
static 
	UIElement  #
CreateModeSelectionHelp! 8
(8 9
)9 :
{ 	
return 
CreateHelpPanel "
(" #
$str &
,& '
$str >
,> ?
new 
( 
string 
header "
," #
string$ *
content+ 2
)2 3
[3 4
]4 5
{   
(!! 
$str!! $
,!!$ %
$str	!!& Ω
)
!!Ω æ
,
!!æ ø
("" 
$str"" #
,""# $
$str	""% ò
)
""ò ô
}## 
)## 
;## 
}$$ 	
private&& 
static&& 
	UIElement&&  !
CreateManualEntryHelp&&! 6
(&&6 7
)&&7 8
{'' 	
return(( 
CreateHelpPanel(( "
(((" #
$str)) #
,))# $
$str** [
,**[ \
new++ 
(++ 
string++ 
header++ "
,++" #
string++$ *
content+++ 2
)++2 3
[++3 4
]++4 5
{,, 
(-- 
$str-- #
,--# $
$str	--% ¡
)
--¡ ¬
,
--¬ √
(.. 
$str.. $
,..$ %
$str	..& à
)
..à â
,
..â ä
(// 
$str//  
,//  !
$str	//" ó
)
//ó ò
}00 
)00 
;00 
}11 	
private33 
static33 
	UIElement33  
CreatePOEntryHelp33! 2
(332 3
)333 4
{44 	
return55 
CreateHelpPanel55 "
(55" #
$str66 &
,66& '
$str77 @
,77@ A
new88 
(88 
string88 
header88 "
,88" #
string88$ *
content88+ 2
)882 3
[883 4
]884 5
{99 
(:: 
$str:: '
,::' (
$str::) ~
)::~ 
,	:: Ä
(;; 
$str;; #
,;;# $
$str	;;% ¶
)
;;¶ ß
,
;;ß ®
(<< 
$str<< #
,<<# $
$str<<% 
)	<< Ä
}== 
)== 
;== 
}>> 	
private@@ 
static@@ 
	UIElement@@  
CreateLoadEntryHelp@@! 4
(@@4 5
)@@5 6
{AA 	
returnBB 
CreateHelpPanelBB "
(BB" #
$strCC !
,CC! "
$strDD G
,DDG H
newEE 
(EE 
stringEE 
headerEE "
,EE" #
stringEE$ *
contentEE+ 2
)EE2 3
[EE3 4
]EE4 5
{FF 
(GG 
$strGG 
,GG  
$str	GG! Ñ
)
GGÑ Ö
,
GGÖ Ü
(HH 
$strHH "
,HH" #
$strHH$ C
)HHC D
,HHD E
(II 
$strII 
,II 
$strII Q
)IIQ R
}JJ 
)JJ 
;JJ 
}KK 	
privateMM 
staticMM 
	UIElementMM  $
CreateWeightQuantityHelpMM! 9
(MM9 :
)MM: ;
{NN 	
returnOO 
CreateHelpPanelOO "
(OO" #
$strPP '
,PP' (
$strQQ =
,QQ= >
newRR 
(RR 
stringRR 
headerRR "
,RR" #
stringRR$ *
contentRR+ 2
)RR2 3
[RR3 4
]RR4 5
{SS 
(TT 
$strTT 3
,TT3 4
$str	TT5 ú
)
TTú ù
,
TTù û
(UU 
$strUU 1
,UU1 2
$strUU3 v
)UUv w
,UUw x
(VV 
$strVV 
,VV 
$strVV  i
)VVi j
}WW 
)WW 
;WW 
}XX 	
privateZZ 
staticZZ 
	UIElementZZ  
CreateHeatLotHelpZZ! 2
(ZZ2 3
)ZZ3 4
{[[ 	
return\\ 
CreateHelpPanel\\ "
(\\" #
$str]] "
,]]" #
$str^^ =
,^^= >
new__ 
(__ 
string__ 
header__ "
,__" #
string__$ *
content__+ 2
)__2 3
[__3 4
]__4 5
{`` 
(aa 
$straa 5
,aa5 6
$str	aa7 Å
)
aaÅ Ç
,
aaÇ É
(bb 
$strbb 2
,bb2 3
$str	bb4 è
)
bbè ê
,
bbê ë
(cc 
$strcc %
,cc% &
$strcc' U
)ccU V
}dd 
)dd 
;dd 
}ee 	
privategg 
staticgg 
	UIElementgg  !
CreatePackageTypeHelpgg! 6
(gg6 7
)gg7 8
{hh 	
returnii 
CreateHelpPanelii "
(ii" #
$strjj !
,jj! "
$strkk V
,kkV W
newll 
(ll 
stringll 
headerll "
,ll" #
stringll$ *
contentll+ 2
)ll2 3
[ll3 4
]ll4 5
{mm 
(nn 
$strnn $
,nn$ %
$str	nn& √
)
nn√ ƒ
,
nnƒ ≈
(oo 
$stroo (
,oo( )
$str	oo* Ñ
)
ooÑ Ö
,
ooÖ Ü
(pp 
$strpp )
,pp) *
$strpp+ u
)ppu v
}qq 
)qq 
;qq 
}rr 	
privatett 
statictt 
	UIElementtt  
CreateReviewHelptt! 1
(tt1 2
)tt2 3
{uu 	
returnvv 
CreateHelpPanelvv "
(vv" #
$strww 
,ww  
$strxx A
,xxA B
newyy 
(yy 
stringyy 
headeryy "
,yy" #
stringyy$ *
contentyy+ 2
)yy2 3
[yy3 4
]yy4 5
{zz 
({{ 
$str{{ (
,{{( )
$str	{{* É
)
{{É Ñ
,
{{Ñ Ö
(|| 
$str|| !
,||! "
$str||# |
)||| }
,||} ~
(}} 
$str}} &
,}}& '
$str	}}( ò
)
}}ò ô
}~~ 
)~~ 
;~~ 
} 	
private
ÅÅ 
static
ÅÅ 
	UIElement
ÅÅ  
CreateDefaultHelp
ÅÅ! 2
(
ÅÅ2 3
)
ÅÅ3 4
{
ÇÇ 	
var
ÉÉ 
stack
ÉÉ 
=
ÉÉ 
new
ÉÉ 

StackPanel
ÉÉ &
{
ÉÉ' (
Spacing
ÉÉ) 0
=
ÉÉ1 2
$num
ÉÉ3 5
,
ÉÉ5 6
Padding
ÉÉ7 >
=
ÉÉ? @
new
ÉÉA D
	Thickness
ÉÉE N
(
ÉÉN O
$num
ÉÉO P
)
ÉÉP Q
,
ÉÉQ R
MaxWidth
ÉÉS [
=
ÉÉ\ ]
$num
ÉÉ^ a
}
ÉÉb c
;
ÉÉc d
var
ÖÖ 
title
ÖÖ 
=
ÖÖ 
new
ÖÖ 
	TextBlock
ÖÖ %
{
ÜÜ 
Text
áá 
=
áá 
$str
áá 0
,
áá0 1
Style
àà 
=
àà 
Application
àà #
.
àà# $
Current
àà$ +
.
àà+ ,
	Resources
àà, 5
[
àà5 6
$str
àà6 N
]
ààN O
as
ààP R
Style
ààS X
}
ââ 
;
ââ 
var
ãã 
description
ãã 
=
ãã 
new
ãã !
	TextBlock
ãã" +
{
åå 
Text
çç 
=
çç 
$str
çç w
,
ççw x
TextWrapping
éé 
=
éé 
TextWrapping
éé +
.
éé+ ,
Wrap
éé, 0
}
èè 
;
èè 
stack
ëë 
.
ëë 
Children
ëë 
.
ëë 
Add
ëë 
(
ëë 
title
ëë $
)
ëë$ %
;
ëë% &
stack
íí 
.
íí 
Children
íí 
.
íí 
Add
íí 
(
íí 
description
íí *
)
íí* +
;
íí+ ,
return
îî 
stack
îî 
;
îî 
}
ïï 	
private
óó 
static
óó 
	UIElement
óó  
CreateHelpPanel
óó! 0
(
óó0 1
string
óó1 7
title
óó8 =
,
óó= >
string
óó? E
description
óóF Q
,
óóQ R
(
óóS T
string
óóT Z
header
óó[ a
,
óóa b
string
óóc i
content
óój q
)
óóq r
[
óór s
]
óós t
sections
óóu }
)
óó} ~
{
òò 	
var
ôô 
	mainStack
ôô 
=
ôô 
new
ôô 

StackPanel
ôô  *
{
ôô+ ,
Spacing
ôô- 4
=
ôô5 6
$num
ôô7 9
,
ôô9 :
Padding
ôô; B
=
ôôC D
new
ôôE H
	Thickness
ôôI R
(
ôôR S
$num
ôôS T
)
ôôT U
,
ôôU V
MaxWidth
ôôW _
=
ôô` a
$num
ôôb e
}
ôôf g
;
ôôg h
var
úú 

titleStack
úú 
=
úú 
new
úú  

StackPanel
úú! +
{
úú, -
Spacing
úú. 5
=
úú6 7
$num
úú8 9
}
úú: ;
;
úú; <
var
ùù 
	titleText
ùù 
=
ùù 
new
ùù 
	TextBlock
ùù  )
{
ûû 
Text
üü 
=
üü 
title
üü 
,
üü 
Style
†† 
=
†† 
Application
†† #
.
††# $
Current
††$ +
.
††+ ,
	Resources
††, 5
[
††5 6
$str
††6 N
]
††N O
as
††P R
Style
††S X
,
††X Y

Foreground
°° 
=
°° 
Application
°° (
.
°°( )
Current
°°) 0
.
°°0 1
	Resources
°°1 :
[
°°: ;
$str
°°; \
]
°°\ ]
as
°°^ `
SolidColorBrush
°°a p
}
¢¢ 
;
¢¢ 
var
§§ 
	underline
§§ 
=
§§ 
new
§§ 
Border
§§  &
{
•• 
Height
¶¶ 
=
¶¶ 
$num
¶¶ 
,
¶¶ 

Background
ßß 
=
ßß 
Application
ßß (
.
ßß( )
Current
ßß) 0
.
ßß0 1
	Resources
ßß1 :
[
ßß: ;
$str
ßß; X
]
ßßX Y
as
ßßZ \
SolidColorBrush
ßß] l
,
ßßl m
CornerRadius
®® 
=
®® 
new
®® "
CornerRadius
®®# /
(
®®/ 0
$num
®®0 1
)
®®1 2
,
®®2 3!
HorizontalAlignment
©© #
=
©©$ %!
HorizontalAlignment
©©& 9
.
©©9 :
Left
©©: >
,
©©> ?
Width
™™ 
=
™™ 
$num
™™ 
}
´´ 
;
´´ 
var
≠≠ 
descText
≠≠ 
=
≠≠ 
new
≠≠ 
	TextBlock
≠≠ (
{
ÆÆ 
Text
ØØ 
=
ØØ 
description
ØØ "
,
ØØ" #
TextWrapping
∞∞ 
=
∞∞ 
TextWrapping
∞∞ +
.
∞∞+ ,
Wrap
∞∞, 0
,
∞∞0 1

Foreground
±± 
=
±± 
Application
±± (
.
±±( )
Current
±±) 0
.
±±0 1
	Resources
±±1 :
[
±±: ;
$str
±±; X
]
±±X Y
as
±±Z \
SolidColorBrush
±±] l
}
≤≤ 
;
≤≤ 

titleStack
¥¥ 
.
¥¥ 
Children
¥¥ 
.
¥¥  
Add
¥¥  #
(
¥¥# $
	titleText
¥¥$ -
)
¥¥- .
;
¥¥. /

titleStack
µµ 
.
µµ 
Children
µµ 
.
µµ  
Add
µµ  #
(
µµ# $
	underline
µµ$ -
)
µµ- .
;
µµ. /

titleStack
∂∂ 
.
∂∂ 
Children
∂∂ 
.
∂∂  
Add
∂∂  #
(
∂∂# $
descText
∂∂$ ,
)
∂∂, -
;
∂∂- .
	mainStack
∑∑ 
.
∑∑ 
Children
∑∑ 
.
∑∑ 
Add
∑∑ "
(
∑∑" #

titleStack
∑∑# -
)
∑∑- .
;
∑∑. /
foreach
∫∫ 
(
∫∫ 
var
∫∫ 
section
∫∫  
in
∫∫! #
sections
∫∫$ ,
)
∫∫, -
{
ªª 
var
ºº 
border
ºº 
=
ºº 
new
ºº  
Border
ºº! '
{
ΩΩ 

Background
ææ 
=
ææ  
Application
ææ! ,
.
ææ, -
Current
ææ- 4
.
ææ4 5
	Resources
ææ5 >
[
ææ> ?
$str
ææ? [
]
ææ[ \
as
ææ] _
SolidColorBrush
ææ` o
,
ææo p
Padding
øø 
=
øø 
new
øø !
	Thickness
øø" +
(
øø+ ,
$num
øø, .
)
øø. /
,
øø/ 0
CornerRadius
¿¿  
=
¿¿! "
new
¿¿# &
CornerRadius
¿¿' 3
(
¿¿3 4
$num
¿¿4 5
)
¿¿5 6
,
¿¿6 7
BorderThickness
¡¡ #
=
¡¡$ %
new
¡¡& )
	Thickness
¡¡* 3
(
¡¡3 4
$num
¡¡4 5
)
¡¡5 6
,
¡¡6 7
BorderBrush
¬¬ 
=
¬¬  !
Application
¬¬" -
.
¬¬- .
Current
¬¬. 5
.
¬¬5 6
	Resources
¬¬6 ?
[
¬¬? @
$str
¬¬@ ]
]
¬¬] ^
as
¬¬_ a
SolidColorBrush
¬¬b q
}
√√ 
;
√√ 
var
≈≈ 
sectionStack
≈≈  
=
≈≈! "
new
≈≈# &

StackPanel
≈≈' 1
{
≈≈2 3
Spacing
≈≈4 ;
=
≈≈< =
$num
≈≈> ?
}
≈≈@ A
;
≈≈A B
var
«« 

headerText
«« 
=
««  
new
««! $
	TextBlock
««% .
{
»» 
Text
…… 
=
…… 
section
…… "
.
……" #
header
……# )
,
……) *

FontWeight
   
=
    
	Microsoft
  ! *
.
  * +
UI
  + -
.
  - .
Text
  . 2
.
  2 3
FontWeights
  3 >
.
  > ?
SemiBold
  ? G
,
  G H
FontSize
ÀÀ 
=
ÀÀ 
$num
ÀÀ !
}
ÃÃ 
;
ÃÃ 
var
ŒŒ 
contentText
ŒŒ 
=
ŒŒ  !
new
ŒŒ" %
	TextBlock
ŒŒ& /
{
œœ 
Text
–– 
=
–– 
section
–– "
.
––" #
content
––# *
,
––* +
TextWrapping
——  
=
——! "
TextWrapping
——# /
.
——/ 0
Wrap
——0 4
,
——4 5
FontSize
““ 
=
““ 
$num
““ !
,
““! "

Foreground
”” 
=
””  
Application
””! ,
.
””, -
Current
””- 4
.
””4 5
	Resources
””5 >
[
””> ?
$str
””? \
]
””\ ]
as
””^ `
SolidColorBrush
””a p
}
‘‘ 
;
‘‘ 
sectionStack
÷÷ 
.
÷÷ 
Children
÷÷ %
.
÷÷% &
Add
÷÷& )
(
÷÷) *

headerText
÷÷* 4
)
÷÷4 5
;
÷÷5 6
sectionStack
◊◊ 
.
◊◊ 
Children
◊◊ %
.
◊◊% &
Add
◊◊& )
(
◊◊) *
contentText
◊◊* 5
)
◊◊5 6
;
◊◊6 7
border
ÿÿ 
.
ÿÿ 
Child
ÿÿ 
=
ÿÿ 
sectionStack
ÿÿ +
;
ÿÿ+ ,
	mainStack
ŸŸ 
.
ŸŸ 
Children
ŸŸ "
.
ŸŸ" #
Add
ŸŸ# &
(
ŸŸ& '
border
ŸŸ' -
)
ŸŸ- .
;
ŸŸ. /
}
⁄⁄ 
return
‹‹ 
	mainStack
‹‹ 
;
‹‹ 
}
›› 	
}
ﬁﬁ 
}ﬂﬂ •@
[C:\Users\johnk\source\repos\MTM_Receiving_Application\Helpers\UI\Helper_WindowExtensions.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Helpers$ +
.+ ,
UI, .
;. /
public 
static 
class #
Helper_WindowExtensions +
{ 
public 

static 
void 
SetWindowSize $
($ %
this% )
Window* 0
window1 7
,7 8
int9 <
width= B
,B C
intD G
heightH N
)N O
{ 
var 
	appWindow 
= 
window 
. 
GetAppWindow +
(+ ,
), -
;- .
	appWindow 
. 
Resize 
( 
new 
Windows $
.$ %
Graphics% -
.- .
	SizeInt32. 7
(7 8
width8 =
,= >
height? E
)E F
)F G
;G H
} 
public 

static 
void 
CenterOnScreen %
(% &
this& *
Window+ 1
window2 8
)8 9
{ 
var 
	appWindow 
= 
window 
. 
GetAppWindow +
(+ ,
), -
;- .
var   
displayArea   
=   
DisplayArea   %
.  % &
Primary  & -
;  - .
var!! 
workArea!! 
=!! 
displayArea!! "
.!!" #
WorkArea!!# +
;!!+ ,
var## 
x## 
=## 
(## 
workArea## 
.## 
Width## 
-##  !
	appWindow##" +
.##+ ,
Size##, 0
.##0 1
Width##1 6
)##6 7
/##8 9
$num##: ;
;##; <
var$$ 
y$$ 
=$$ 
($$ 
workArea$$ 
.$$ 
Height$$  
-$$! "
	appWindow$$# ,
.$$, -
Size$$- 1
.$$1 2
Height$$2 8
)$$8 9
/$$: ;
$num$$< =
;$$= >
	appWindow&& 
.&& 
Move&& 
(&& 
new&& 
Windows&& "
.&&" #
Graphics&&# +
.&&+ ,

PointInt32&&, 6
(&&6 7
x&&7 8
,&&8 9
y&&: ;
)&&; <
)&&< =
;&&= >
}'' 
public// 

static// 
void// 
SetFixedSize// #
(//# $
this//$ (
Window//) /
window//0 6
,//6 7
bool//8 <
disableMaximize//= L
=//M N
true//O S
,//S T
bool//U Y
disableMinimize//Z i
=//j k
true//l p
)//p q
{00 
var11 
	appWindow11 
=11 
window11 
.11 
GetAppWindow11 +
(11+ ,
)11, -
;11- .
if33 

(33 
	appWindow33 
.33 
	Presenter33 
is33  "
OverlappedPresenter33# 6
	presenter337 @
)33@ A
{44 	
	presenter55 
.55 
IsResizable55 !
=55" #
false55$ )
;55) *
	presenter66 
.66 
IsMaximizable66 #
=66$ %
!66& '
disableMaximize66' 6
;666 7
	presenter77 
.77 
IsMinimizable77 #
=77$ %
!77& '
disableMinimize77' 6
;776 7
}88 	
}99 
public?? 

static?? 
void?? 
HideTitleBarIcon?? '
(??' (
this??( ,
Window??- 3
window??4 :
)??: ;
{@@ 
varAA 
	appWindowAA 
=AA 
windowAA 
.AA 
GetAppWindowAA +
(AA+ ,
)AA, -
;AA- .
varBB 
titleBarBB 
=BB 
	appWindowBB  
.BB  !
TitleBarBB! )
;BB) *
titleBarCC 
.CC 
IconShowOptionsCC  
=CC! "
IconShowOptionsCC# 2
.CC2 3!
HideIconAndSystemMenuCC3 H
;CCH I
}DD 
publicKK 

staticKK 
voidKK 
UseCustomTitleBarKK (
(KK( )
thisKK) -
WindowKK. 4
windowKK5 ;
,KK; <
	UIElementKK= F
?KKF G!
customTitleBarElementKKH ]
=KK^ _
nullKK` d
)KKd e
{LL 
windowMM 
.MM &
ExtendsContentIntoTitleBarMM )
=MM* +
trueMM, 0
;MM0 1
windowNN 
.NN 
SetTitleBarNN 
(NN !
customTitleBarElementNN 0
)NN0 1
;NN1 2
}OO 
publicUU 

staticUU 
voidUU #
MakeTitleBarTransparentUU .
(UU. /
thisUU/ 3
WindowUU4 :
windowUU; A
)UUA B
{VV 
varWW 
	appWindowWW 
=WW 
windowWW 
.WW 
GetAppWindowWW +
(WW+ ,
)WW, -
;WW- .
varXX 
titleBarXX 
=XX 
	appWindowXX  
.XX  !
TitleBarXX! )
;XX) *
titleBarZZ 
.ZZ !
ButtonBackgroundColorZZ &
=ZZ' (
	MicrosoftZZ) 2
.ZZ2 3
UIZZ3 5
.ZZ5 6
ColorsZZ6 <
.ZZ< =
TransparentZZ= H
;ZZH I
titleBar[[ 
.[[ )
ButtonInactiveBackgroundColor[[ .
=[[/ 0
	Microsoft[[1 :
.[[: ;
UI[[; =
.[[= >
Colors[[> D
.[[D E
Transparent[[E P
;[[P Q
titleBar\\ 
.\\ !
ButtonForegroundColor\\ &
=\\' (
	Microsoft\\) 2
.\\2 3
UI\\3 5
.\\5 6
Colors\\6 <
.\\< =
Transparent\\= H
;\\H I
titleBar]] 
.]] )
ButtonInactiveForegroundColor]] .
=]]/ 0
	Microsoft]]1 :
.]]: ;
UI]]; =
.]]= >
Colors]]> D
.]]D E
Transparent]]E P
;]]P Q
titleBar^^ 
.^^ &
ButtonHoverBackgroundColor^^ +
=^^, -
	Microsoft^^. 7
.^^7 8
UI^^8 :
.^^: ;
Colors^^; A
.^^A B
Transparent^^B M
;^^M N
titleBar__ 
.__ &
ButtonHoverForegroundColor__ +
=__, -
	Microsoft__. 7
.__7 8
UI__8 :
.__: ;
Colors__; A
.__A B
Transparent__B M
;__M N
titleBar`` 
.`` (
ButtonPressedBackgroundColor`` -
=``. /
	Microsoft``0 9
.``9 :
UI``: <
.``< =
Colors``= C
.``C D
Transparent``D O
;``O P
titleBaraa 
.aa (
ButtonPressedForegroundColoraa -
=aa. /
	Microsoftaa0 9
.aa9 :
UIaa: <
.aa< =
Colorsaa= C
.aaC D
TransparentaaD O
;aaO P
}bb 
privategg 
staticgg 
	AppWindowgg 
GetAppWindowgg )
(gg) *
thisgg* .
Windowgg/ 5
windowgg6 <
)gg< =
{hh 
varii 
hWndii 
=ii 
WindowNativeii 
.ii  
GetWindowHandleii  /
(ii/ 0
windowii0 6
)ii6 7
;ii7 8
varjj 
windowIdjj 
=jj 
	Microsoftjj  
.jj  !
UIjj! #
.jj# $
Win32Interopjj$ 0
.jj0 1!
GetWindowIdFromWindowjj1 F
(jjF G
hWndjjG K
)jjK L
;jjL M
returnkk 
	AppWindowkk 
.kk 
GetFromWindowIdkk (
(kk( )
windowIdkk) 1
)kk1 2
;kk2 3
}ll 
}mm ˙

cC:\Users\johnk\source\repos\MTM_Receiving_Application\Helpers\Database\Helper_Database_Variables.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Helpers$ +
.+ ,
Database, 4
;4 5
public 
static 
class %
Helper_Database_Variables -
{ 
public 

static 
string &
ProductionConnectionString 3
{4 5
get6 9
;9 :
}; <
== >
$str Z
;Z [
public 

static 
string  
TestConnectionString -
{. /
get0 3
;3 4
}5 6
=7 8
$str _
;_ `
public 

static 
string 
GetConnectionString ,
(, -
bool- 1
useProduction2 ?
=@ A
trueB F
)F G
{ 
return 
useProduction 
? &
ProductionConnectionString 9
:: ; 
TestConnectionString< P
;P Q
} 
public"" 

static"" 
string"" *
GetInforVisualConnectionString"" 7
(""7 8
)""8 9
{## 
return$$ 
$str	$$ Å
;
$$Å Ç
}%% 
}&& Õ⁄
YC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Receiving\Dao_ReceivingLoad.cs
	namespace

 	%
MTM_Receiving_Application


 #
.

# $
Data

$ (
.

( )
	Receiving

) 2
;

2 3
public 
class 
Dao_ReceivingLoad 
{ 
private 
readonly 
string 
_connectionString -
;- .
public 

Dao_ReceivingLoad 
( 
string #
connectionString$ 4
)4 5
{ 
_connectionString 
= 
connectionString ,
??- /
throw0 5
new6 9!
ArgumentNullException: O
(O P
nameofP V
(V W
connectionStringW g
)g h
)h i
;i j
} 
private 
string 
? 
CleanPONumber !
(! "
string" (
?( )
poNumber* 2
)2 3
{ 
if 

( 
string 
. 
IsNullOrEmpty  
(  !
poNumber! )
)) *
)* +
return, 2
null3 7
;7 8
return 
poNumber 
. 
Replace 
(  
$str  %
,% &
$str' )
,) *
StringComparison+ ;
.; <
OrdinalIgnoreCase< M
)M N
.N O
TrimO S
(S T
)T U
;U V
} 
public 

async 
Task 
< 
Model_Dao_Result &
<& '
int' *
>* +
>+ ,
SaveLoadsAsync- ;
(; <
List< @
<@ A
Model_ReceivingLoadA T
>T U
loadsV [
)[ \
{ 
if 

( 
loads 
== 
null 
|| 
loads "
." #
Count# (
==) +
$num, -
)- .
return $
Model_Dao_Result_Factory +
.+ ,
Failure, 3
<3 4
int4 7
>7 8
(8 9
$str9 ]
)] ^
;^ _
using   
var   

connection   
=   
new   "
MySqlConnection  # 2
(  2 3
_connectionString  3 D
)  D E
;  E F
await!! 

connection!! 
.!! 
	OpenAsync!! "
(!!" #
)!!# $
;!!$ %
using## 
var## 
transaction## 
=## 
await##  %

connection##& 0
.##0 1!
BeginTransactionAsync##1 F
(##F G
)##G H
;##H I
try$$ 
{%% 	
int&& 

savedCount&& 
=&& 
$num&& 
;&& 
foreach(( 
((( 
var(( 
load(( 
in((  
loads((! &
)((& '
{)) 
var** 

parameters** 
=**  
new**! $

Dictionary**% /
<**/ 0
string**0 6
,**6 7
object**8 >
>**> ?
{++ 
{,, 
$str,, 
,,, 
load,,  $
.,,$ %
LoadID,,% +
.,,+ ,
ToString,,, 4
(,,4 5
),,5 6
},,7 8
,,,8 9
{-- 
$str-- 
,-- 
load--  $
.--$ %
PartID--% +
}--, -
,--- .
{.. 
$str..  
,..  !
load.." &
...& '
PartType..' /
}..0 1
,..1 2
{// 
$str//  
,//  !
CleanPONumber//" /
(/// 0
load//0 4
.//4 5
PoNumber//5 =
)//= >
??//? A
(//B C
object//C I
)//I J
DBNull//J P
.//P Q
Value//Q V
}//W X
,//X Y
{00 
$str00 $
,00$ %
load00& *
.00* +
PoLineNumber00+ 7
}008 9
,009 :
{11 
$str11 "
,11" #
load11$ (
.11( )

LoadNumber11) 3
}114 5
,115 6
{22 
$str22 &
,22& '
load22( ,
.22, -
WeightQuantity22- ;
}22< =
,22= >
{33 
$str33 %
,33% &
load33' +
.33+ ,
HeatLotNumber33, 9
}33: ;
,33; <
{44 
$str44 '
,44' (
load44) -
.44- .
PackagesPerLoad44. =
}44> ?
,44? @
{55 
$str55 '
,55' (
load55) -
.55- .
PackageTypeName55. =
}55> ?
,55? @
{66 
$str66 (
,66( )
load66* .
.66. /
WeightPerPackage66/ ?
}66@ A
,66A B
{77 
$str77 #
,77# $
load77% )
.77) *
IsNonPOItem77* 5
}776 7
,777 8
{88 
$str88 $
,88$ %
load88& *
.88* +
ReceivedDate88+ 7
}888 9
}99 
;99 
var;; 
result;; 
=;; 
await;; "+
Helper_Database_StoredProcedure;;# B
.;;B C%
ExecuteInTransactionAsync;;C \
(;;\ ]

connection<< 
,<< 
transaction== 
,==  
$str>> ,
,>>, -

parameters?? 
)@@ 
;@@ 
ifBB 
(BB 
!BB 
resultBB 
.BB 
SuccessBB #
)BB# $
{CC 
throwDD 
newDD %
InvalidOperationExceptionDD 7
(DD7 8
resultDD8 >
.DD> ?
ErrorMessageDD? K
,DDK L
resultDDM S
.DDS T
	ExceptionDDT ]
)DD] ^
;DD^ _
}EE 

savedCountGG 
++GG 
;GG 
}HH 
awaitJJ 
transactionJJ 
.JJ 
CommitAsyncJJ )
(JJ) *
)JJ* +
;JJ+ ,
returnKK $
Model_Dao_Result_FactoryKK +
.KK+ ,
SuccessKK, 3
<KK3 4
intKK4 7
>KK7 8
(KK8 9

savedCountKK9 C
)KKC D
;KKD E
}LL 	
catchMM 
(MM 
	ExceptionMM 
exMM 
)MM 
{NN 	
awaitOO 
transactionOO 
.OO 
RollbackAsyncOO +
(OO+ ,
)OO, -
;OO- .
returnPP $
Model_Dao_Result_FactoryPP +
.PP+ ,
FailurePP, 3
<PP3 4
intPP4 7
>PP7 8
(PP8 9
$"PP9 ;
$strPP; Q
{PPQ R
exPPR T
.PPT U
MessagePPU \
}PP\ ]
"PP] ^
,PP^ _
exPP` b
)PPb c
;PPc d
}QQ 	
}RR 
publicTT 

asyncTT 
TaskTT 
<TT 
Model_Dao_ResultTT &
<TT& '
intTT' *
>TT* +
>TT+ ,
UpdateLoadsAsyncTT- =
(TT= >
ListTT> B
<TTB C
Model_ReceivingLoadTTC V
>TTV W
loadsTTX ]
)TT] ^
{UU 
ifVV 

(VV 
loadsVV 
==VV 
nullVV 
||VV 
loadsVV "
.VV" #
CountVV# (
==VV) +
$numVV, -
)VV- .
returnWW $
Model_Dao_Result_FactoryWW +
.WW+ ,
FailureWW, 3
<WW3 4
intWW4 7
>WW7 8
(WW8 9
$strWW9 ]
)WW] ^
;WW^ _
usingYY 
varYY 

connectionYY 
=YY 
newYY "
MySqlConnectionYY# 2
(YY2 3
_connectionStringYY3 D
)YYD E
;YYE F
awaitZZ 

connectionZZ 
.ZZ 
	OpenAsyncZZ "
(ZZ" #
)ZZ# $
;ZZ$ %
using\\ 
var\\ 
transaction\\ 
=\\ 
await\\  %

connection\\& 0
.\\0 1!
BeginTransactionAsync\\1 F
(\\F G
)\\G H
;\\H I
try]] 
{^^ 	
int__ 
updatedCount__ 
=__ 
$num__  
;__  !
foreachaa 
(aa 
varaa 
loadaa 
inaa  
loadsaa! &
)aa& '
{bb 
varcc 

parameterscc 
=cc  
newcc! $

Dictionarycc% /
<cc/ 0
stringcc0 6
,cc6 7
objectcc8 >
>cc> ?
{dd 
{ee 
$stree 
,ee 
loadee  $
.ee$ %
LoadIDee% +
.ee+ ,
ToStringee, 4
(ee4 5
)ee5 6
}ee7 8
,ee8 9
{ff 
$strff 
,ff 
loadff  $
.ff$ %
PartIDff% +
}ff, -
,ff- .
{gg 
$strgg  
,gg  !
loadgg" &
.gg& '
PartTypegg' /
}gg0 1
,gg1 2
{hh 
$strhh  
,hh  !
CleanPONumberhh" /
(hh/ 0
loadhh0 4
.hh4 5
PoNumberhh5 =
)hh= >
??hh? A
(hhB C
objecthhC I
)hhI J
DBNullhhJ P
.hhP Q
ValuehhQ V
}hhW X
,hhX Y
{ii 
$strii $
,ii$ %
loadii& *
.ii* +
PoLineNumberii+ 7
}ii8 9
,ii9 :
{jj 
$strjj "
,jj" #
loadjj$ (
.jj( )

LoadNumberjj) 3
}jj4 5
,jj5 6
{kk 
$strkk &
,kk& '
loadkk( ,
.kk, -
WeightQuantitykk- ;
}kk< =
,kk= >
{ll 
$strll %
,ll% &
loadll' +
.ll+ ,
HeatLotNumberll, 9
}ll: ;
,ll; <
{mm 
$strmm '
,mm' (
loadmm) -
.mm- .
PackagesPerLoadmm. =
}mm> ?
,mm? @
{nn 
$strnn '
,nn' (
loadnn) -
.nn- .
PackageTypeNamenn. =
}nn> ?
,nn? @
{oo 
$stroo (
,oo( )
loadoo* .
.oo. /
WeightPerPackageoo/ ?
}oo@ A
,ooA B
{pp 
$strpp #
,pp# $
loadpp% )
.pp) *
IsNonPOItempp* 5
}pp6 7
,pp7 8
{qq 
$strqq $
,qq$ %
loadqq& *
.qq* +
ReceivedDateqq+ 7
}qq8 9
}rr 
;rr 
vartt 
resulttt 
=tt 
awaittt "+
Helper_Database_StoredProcedurett# B
.ttB C%
ExecuteInTransactionAsyncttC \
(tt\ ]

connectionuu 
,uu 
transactionvv 
,vv  
$strww ,
,ww, -

parametersxx 
)yy 
;yy 
if{{ 
({{ 
!{{ 
result{{ 
.{{ 
Success{{ #
){{# $
{|| 
throw}} 
new}} %
InvalidOperationException}} 7
(}}7 8
result}}8 >
.}}> ?
ErrorMessage}}? K
,}}K L
result}}M S
.}}S T
	Exception}}T ]
)}}] ^
;}}^ _
}~~ 
updatedCount
ÄÄ 
++
ÄÄ 
;
ÄÄ 
}
ÅÅ 
await
ÉÉ 
transaction
ÉÉ 
.
ÉÉ 
CommitAsync
ÉÉ )
(
ÉÉ) *
)
ÉÉ* +
;
ÉÉ+ ,
return
ÑÑ &
Model_Dao_Result_Factory
ÑÑ +
.
ÑÑ+ ,
Success
ÑÑ, 3
<
ÑÑ3 4
int
ÑÑ4 7
>
ÑÑ7 8
(
ÑÑ8 9
updatedCount
ÑÑ9 E
)
ÑÑE F
;
ÑÑF G
}
ÖÖ 	
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ 
{
áá 	
await
àà 
transaction
àà 
.
àà 
RollbackAsync
àà +
(
àà+ ,
)
àà, -
;
àà- .
return
ââ &
Model_Dao_Result_Factory
ââ +
.
ââ+ ,
Failure
ââ, 3
<
ââ3 4
int
ââ4 7
>
ââ7 8
(
ââ8 9
$"
ââ9 ;
$str
ââ; S
{
ââS T
ex
ââT V
.
ââV W
Message
ââW ^
}
ââ^ _
"
ââ_ `
,
ââ` a
ex
ââb d
)
ââd e
;
ââe f
}
ää 	
}
ãã 
public
çç 

async
çç 
Task
çç 
<
çç 
Model_Dao_Result
çç &
<
çç& '
int
çç' *
>
çç* +
>
çç+ ,
DeleteLoadsAsync
çç- =
(
çç= >
List
çç> B
<
ççB C!
Model_ReceivingLoad
ççC V
>
ççV W
loads
ççX ]
)
çç] ^
{
éé 
if
èè 

(
èè 
loads
èè 
==
èè 
null
èè 
||
èè 
loads
èè "
.
èè" #
Count
èè# (
==
èè) +
$num
èè, -
)
èè- .
return
êê &
Model_Dao_Result_Factory
êê +
.
êê+ ,
Success
êê, 3
<
êê3 4
int
êê4 7
>
êê7 8
(
êê8 9
$num
êê9 :
)
êê: ;
;
êê; <
using
íí 
var
íí 

connection
íí 
=
íí 
new
íí "
MySqlConnection
íí# 2
(
íí2 3
_connectionString
íí3 D
)
ííD E
;
ííE F
await
ìì 

connection
ìì 
.
ìì 
	OpenAsync
ìì "
(
ìì" #
)
ìì# $
;
ìì$ %
using
ïï 
var
ïï 
transaction
ïï 
=
ïï 
await
ïï  %

connection
ïï& 0
.
ïï0 1#
BeginTransactionAsync
ïï1 F
(
ïïF G
)
ïïG H
;
ïïH I
try
ññ 
{
óó 	
int
òò 
deletedCount
òò 
=
òò 
$num
òò  
;
òò  !
foreach
öö 
(
öö 
var
öö 
load
öö 
in
öö  
loads
öö! &
)
öö& '
{
õõ 
var
úú 

parameters
úú 
=
úú  
new
úú! $

Dictionary
úú% /
<
úú/ 0
string
úú0 6
,
úú6 7
object
úú8 >
>
úú> ?
{
ùù 
{
ûû 
$str
ûû  
,
ûû  !
load
ûû" &
.
ûû& '
LoadID
ûû' -
.
ûû- .
ToString
ûû. 6
(
ûû6 7
)
ûû7 8
}
ûû9 :
}
üü 
;
üü 
var
°° 
result
°° 
=
°° 
await
°° "-
Helper_Database_StoredProcedure
°°# B
.
°°B C'
ExecuteInTransactionAsync
°°C \
(
°°\ ]

connection
¢¢ 
,
¢¢ 
transaction
££ 
,
££  
$str
§§ ,
,
§§, -

parameters
•• 
)
¶¶ 
;
¶¶ 
if
®® 
(
®® 
!
®® 
result
®® 
.
®® 
Success
®® #
)
®®# $
{
©© 
throw
™™ 
new
™™ '
InvalidOperationException
™™ 7
(
™™7 8
result
™™8 >
.
™™> ?
ErrorMessage
™™? K
,
™™K L
result
™™M S
.
™™S T
	Exception
™™T ]
)
™™] ^
;
™™^ _
}
´´ 
deletedCount
≠≠ 
++
≠≠ 
;
≠≠ 
}
ÆÆ 
await
∞∞ 
transaction
∞∞ 
.
∞∞ 
CommitAsync
∞∞ )
(
∞∞) *
)
∞∞* +
;
∞∞+ ,
return
±± &
Model_Dao_Result_Factory
±± +
.
±±+ ,
Success
±±, 3
<
±±3 4
int
±±4 7
>
±±7 8
(
±±8 9
deletedCount
±±9 E
)
±±E F
;
±±F G
}
≤≤ 	
catch
≥≥ 
(
≥≥ 
	Exception
≥≥ 
ex
≥≥ 
)
≥≥ 
{
¥¥ 	
await
µµ 
transaction
µµ 
.
µµ 
RollbackAsync
µµ +
(
µµ+ ,
)
µµ, -
;
µµ- .
return
∂∂ &
Model_Dao_Result_Factory
∂∂ +
.
∂∂+ ,
Failure
∂∂, 3
<
∂∂3 4
int
∂∂4 7
>
∂∂7 8
(
∂∂8 9
$"
∂∂9 ;
$str
∂∂; S
{
∂∂S T
ex
∂∂T V
.
∂∂V W
Message
∂∂W ^
}
∂∂^ _
"
∂∂_ `
,
∂∂` a
ex
∂∂b d
)
∂∂d e
;
∂∂e f
}
∑∑ 	
}
∏∏ 
public
∫∫ 

async
∫∫ 
Task
∫∫ 
<
∫∫ 
Model_Dao_Result
∫∫ &
<
∫∫& '
List
∫∫' +
<
∫∫+ ,!
Model_ReceivingLoad
∫∫, ?
>
∫∫? @
>
∫∫@ A
>
∫∫A B
GetHistoryAsync
∫∫C R
(
∫∫R S
string
∫∫S Y
partID
∫∫Z `
,
∫∫` a
DateTime
∫∫b j
	startDate
∫∫k t
,
∫∫t u
DateTime
∫∫v ~
endDate∫∫ Ü
)∫∫Ü á
{
ªª 
try
ºº 
{
ΩΩ 	
var
ææ 
loads
ææ 
=
ææ 
new
ææ 
List
ææ  
<
ææ  !!
Model_ReceivingLoad
ææ! 4
>
ææ4 5
(
ææ5 6
)
ææ6 7
;
ææ7 8
var
øø 

parameters
øø 
=
øø 
new
øø  

Dictionary
øø! +
<
øø+ ,
string
øø, 2
,
øø2 3
object
øø4 :
>
øø: ;
{
¿¿ 
{
¡¡ 
$str
¡¡ 
,
¡¡ 
partID
¡¡ "
}
¡¡# $
,
¡¡$ %
{
¬¬ 
$str
¬¬ 
,
¬¬ 
	startDate
¬¬ (
}
¬¬) *
,
¬¬* +
{
√√ 
$str
√√ 
,
√√ 
endDate
√√ $
}
√√% &
}
ƒƒ 
;
ƒƒ 
var
∆∆ 
result
∆∆ 
=
∆∆ 
await
∆∆ -
Helper_Database_StoredProcedure
∆∆ >
.
∆∆> ?#
ExecuteDataTableAsync
∆∆? T
(
∆∆T U
_connectionString
«« !
,
««! "
$str
»» (
,
»»( )

parameters
…… 
)
   
;
   
if
ÃÃ 
(
ÃÃ 
result
ÃÃ 
.
ÃÃ 
	IsSuccess
ÃÃ  
&&
ÃÃ! #
result
ÃÃ$ *
.
ÃÃ* +
Data
ÃÃ+ /
!=
ÃÃ0 2
null
ÃÃ3 7
)
ÃÃ7 8
{
ÕÕ 
foreach
ŒŒ 
(
ŒŒ 
DataRow
ŒŒ  
row
ŒŒ! $
in
ŒŒ% '
result
ŒŒ( .
.
ŒŒ. /
Data
ŒŒ/ 3
.
ŒŒ3 4
Rows
ŒŒ4 8
)
ŒŒ8 9
{
œœ 
loads
–– 
.
–– 
Add
–– 
(
–– 
MapRowToLoad
–– *
(
––* +
row
––+ .
)
––. /
)
––/ 0
;
––0 1
}
—— 
return
““ &
Model_Dao_Result_Factory
““ /
.
““/ 0
Success
““0 7
(
““7 8
loads
““8 =
)
““= >
;
““> ?
}
”” 
return
‘‘ &
Model_Dao_Result_Factory
‘‘ +
.
‘‘+ ,
Failure
‘‘, 3
<
‘‘3 4
List
‘‘4 8
<
‘‘8 9!
Model_ReceivingLoad
‘‘9 L
>
‘‘L M
>
‘‘M N
(
‘‘N O
result
‘‘O U
.
‘‘U V
ErrorMessage
‘‘V b
)
‘‘b c
;
‘‘c d
}
’’ 	
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷ 
{
◊◊ 	
return
ÿÿ &
Model_Dao_Result_Factory
ÿÿ +
.
ÿÿ+ ,
Failure
ÿÿ, 3
<
ÿÿ3 4
List
ÿÿ4 8
<
ÿÿ8 9!
Model_ReceivingLoad
ÿÿ9 L
>
ÿÿL M
>
ÿÿM N
(
ÿÿN O
$"
ÿÿO Q
$str
ÿÿQ k
{
ÿÿk l
ex
ÿÿl n
.
ÿÿn o
Message
ÿÿo v
}
ÿÿv w
"
ÿÿw x
,
ÿÿx y
ex
ÿÿz |
)
ÿÿ| }
;
ÿÿ} ~
}
ŸŸ 	
}
⁄⁄ 
public
‹‹ 

async
‹‹ 
Task
‹‹ 
<
‹‹ 
Model_Dao_Result
‹‹ &
<
‹‹& '
List
‹‹' +
<
‹‹+ ,!
Model_ReceivingLoad
‹‹, ?
>
‹‹? @
>
‹‹@ A
>
‹‹A B
GetAllAsync
‹‹C N
(
‹‹N O
DateTime
‹‹O W
	startDate
‹‹X a
,
‹‹a b
DateTime
‹‹c k
endDate
‹‹l s
)
‹‹s t
{
›› 
try
ﬁﬁ 
{
ﬂﬂ 	
var
‡‡ 
loads
‡‡ 
=
‡‡ 
new
‡‡ 
List
‡‡  
<
‡‡  !!
Model_ReceivingLoad
‡‡! 4
>
‡‡4 5
(
‡‡5 6
)
‡‡6 7
;
‡‡7 8
var
·· 

parameters
·· 
=
·· 
new
··  

Dictionary
··! +
<
··+ ,
string
··, 2
,
··2 3
object
··4 :
>
··: ;
{
‚‚ 
{
„„ 
$str
„„ 
,
„„ 
	startDate
„„ (
}
„„) *
,
„„* +
{
‰‰ 
$str
‰‰ 
,
‰‰ 
endDate
‰‰ $
}
‰‰% &
}
ÂÂ 
;
ÂÂ 
var
ÁÁ 
result
ÁÁ 
=
ÁÁ 
await
ÁÁ -
Helper_Database_StoredProcedure
ÁÁ >
.
ÁÁ> ?#
ExecuteDataTableAsync
ÁÁ? T
(
ÁÁT U
_connectionString
ËË !
,
ËË! "
$str
ÈÈ )
,
ÈÈ) *

parameters
ÍÍ 
)
ÎÎ 
;
ÎÎ 
if
ÌÌ 
(
ÌÌ 
result
ÌÌ 
.
ÌÌ 
	IsSuccess
ÌÌ  
&&
ÌÌ! #
result
ÌÌ$ *
.
ÌÌ* +
Data
ÌÌ+ /
!=
ÌÌ0 2
null
ÌÌ3 7
)
ÌÌ7 8
{
ÓÓ 
foreach
ÔÔ 
(
ÔÔ 
DataRow
ÔÔ  
row
ÔÔ! $
in
ÔÔ% '
result
ÔÔ( .
.
ÔÔ. /
Data
ÔÔ/ 3
.
ÔÔ3 4
Rows
ÔÔ4 8
)
ÔÔ8 9
{
 
loads
ÒÒ 
.
ÒÒ 
Add
ÒÒ 
(
ÒÒ 
MapRowToLoad
ÒÒ *
(
ÒÒ* +
row
ÒÒ+ .
)
ÒÒ. /
)
ÒÒ/ 0
;
ÒÒ0 1
}
ÚÚ 
return
ÛÛ &
Model_Dao_Result_Factory
ÛÛ /
.
ÛÛ/ 0
Success
ÛÛ0 7
(
ÛÛ7 8
loads
ÛÛ8 =
)
ÛÛ= >
;
ÛÛ> ?
}
ÙÙ 
return
ıı &
Model_Dao_Result_Factory
ıı +
.
ıı+ ,
Failure
ıı, 3
<
ıı3 4
List
ıı4 8
<
ıı8 9!
Model_ReceivingLoad
ıı9 L
>
ııL M
>
ııM N
(
ııN O
result
ııO U
.
ııU V
ErrorMessage
ııV b
)
ııb c
;
ııc d
}
ˆˆ 	
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜ 
{
¯¯ 	
return
˘˘ &
Model_Dao_Result_Factory
˘˘ +
.
˘˘+ ,
Failure
˘˘, 3
<
˘˘3 4
List
˘˘4 8
<
˘˘8 9!
Model_ReceivingLoad
˘˘9 L
>
˘˘L M
>
˘˘M N
(
˘˘N O
$"
˘˘O Q
$str
˘˘Q m
{
˘˘m n
ex
˘˘n p
.
˘˘p q
Message
˘˘q x
}
˘˘x y
"
˘˘y z
,
˘˘z {
ex
˘˘| ~
)
˘˘~ 
;˘˘ Ä
}
˙˙ 	
}
˚˚ 
private
˝˝ !
Model_ReceivingLoad
˝˝ 
MapRowToLoad
˝˝  ,
(
˝˝, -
DataRow
˝˝- 4
row
˝˝5 8
)
˝˝8 9
{
˛˛ 
return
ˇˇ 
new
ˇˇ !
Model_ReceivingLoad
ˇˇ &
{
ÄÄ 	
LoadID
ÅÅ 
=
ÅÅ 
Guid
ÅÅ 
.
ÅÅ 
Parse
ÅÅ 
(
ÅÅ  
row
ÅÅ  #
[
ÅÅ# $
$str
ÅÅ$ ,
]
ÅÅ, -
?
ÅÅ- .
.
ÅÅ. /
ToString
ÅÅ/ 7
(
ÅÅ7 8
)
ÅÅ8 9
??
ÅÅ: <
Guid
ÅÅ= A
.
ÅÅA B
Empty
ÅÅB G
.
ÅÅG H
ToString
ÅÅH P
(
ÅÅP Q
)
ÅÅQ R
)
ÅÅR S
,
ÅÅS T
PartID
ÇÇ 
=
ÇÇ 
row
ÇÇ 
[
ÇÇ 
$str
ÇÇ !
]
ÇÇ! "
?
ÇÇ" #
.
ÇÇ# $
ToString
ÇÇ$ ,
(
ÇÇ, -
)
ÇÇ- .
??
ÇÇ/ 1
string
ÇÇ2 8
.
ÇÇ8 9
Empty
ÇÇ9 >
,
ÇÇ> ?
PartType
ÉÉ 
=
ÉÉ 
row
ÉÉ 
[
ÉÉ 
$str
ÉÉ %
]
ÉÉ% &
?
ÉÉ& '
.
ÉÉ' (
ToString
ÉÉ( 0
(
ÉÉ0 1
)
ÉÉ1 2
??
ÉÉ3 5
string
ÉÉ6 <
.
ÉÉ< =
Empty
ÉÉ= B
,
ÉÉB C
PoNumber
ÑÑ 
=
ÑÑ 
row
ÑÑ 
[
ÑÑ 
$str
ÑÑ %
]
ÑÑ% &
==
ÑÑ' )
DBNull
ÑÑ* 0
.
ÑÑ0 1
Value
ÑÑ1 6
?
ÑÑ7 8
null
ÑÑ9 =
:
ÑÑ> ?
row
ÑÑ@ C
[
ÑÑC D
$str
ÑÑD N
]
ÑÑN O
.
ÑÑO P
ToString
ÑÑP X
(
ÑÑX Y
)
ÑÑY Z
,
ÑÑZ [
PoLineNumber
ÖÖ 
=
ÖÖ 
row
ÖÖ 
[
ÖÖ 
$str
ÖÖ -
]
ÖÖ- .
?
ÖÖ. /
.
ÖÖ/ 0
ToString
ÖÖ0 8
(
ÖÖ8 9
)
ÖÖ9 :
??
ÖÖ; =
string
ÖÖ> D
.
ÖÖD E
Empty
ÖÖE J
,
ÖÖJ K

LoadNumber
ÜÜ 
=
ÜÜ 
Convert
ÜÜ  
.
ÜÜ  !
ToInt32
ÜÜ! (
(
ÜÜ( )
row
ÜÜ) ,
[
ÜÜ, -
$str
ÜÜ- 9
]
ÜÜ9 :
)
ÜÜ: ;
,
ÜÜ; <
WeightQuantity
áá 
=
áá 
Convert
áá $
.
áá$ %
	ToDecimal
áá% .
(
áá. /
row
áá/ 2
[
áá2 3
$str
áá3 C
]
ááC D
)
ááD E
,
ááE F
HeatLotNumber
àà 
=
àà 
row
àà 
[
àà  
$str
àà  /
]
àà/ 0
?
àà0 1
.
àà1 2
ToString
àà2 :
(
àà: ;
)
àà; <
??
àà= ?
string
àà@ F
.
ààF G
Empty
ààG L
,
ààL M
PackagesPerLoad
ââ 
=
ââ 
Convert
ââ %
.
ââ% &
ToInt32
ââ& -
(
ââ- .
row
ââ. 1
[
ââ1 2
$str
ââ2 C
]
ââC D
)
ââD E
,
ââE F
PackageTypeName
ää 
=
ää 
row
ää !
[
ää! "
$str
ää" 3
]
ää3 4
?
ää4 5
.
ää5 6
ToString
ää6 >
(
ää> ?
)
ää? @
??
ääA C
string
ääD J
.
ääJ K
Empty
ääK P
,
ääP Q
WeightPerPackage
ãã 
=
ãã 
Convert
ãã &
.
ãã& '
	ToDecimal
ãã' 0
(
ãã0 1
row
ãã1 4
[
ãã4 5
$str
ãã5 G
]
ããG H
)
ããH I
,
ããI J
IsNonPOItem
åå 
=
åå 
Convert
åå !
.
åå! "
	ToBoolean
åå" +
(
åå+ ,
row
åå, /
[
åå/ 0
$str
åå0 =
]
åå= >
)
åå> ?
,
åå? @
ReceivedDate
çç 
=
çç 
Convert
çç "
.
çç" #

ToDateTime
çç# -
(
çç- .
row
çç. 1
[
çç1 2
$str
çç2 @
]
çç@ A
)
ççA B
}
éé 	
;
éé	 

}
èè 
}êê ‘/
YC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Receiving\Dao_ReceivingLine.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Data		$ (
.		( )
	Receiving		) 2
;		2 3
public 
class 
Dao_ReceivingLine 
{ 
private 
readonly 
string 
_connectionString -
;- .
public 

Dao_ReceivingLine 
( 
string #
connectionString$ 4
)4 5
{ 
_connectionString 
= 
connectionString ,
??- /
throw0 5
new6 9!
ArgumentNullException: O
(O P
nameofP V
(V W
connectionStringW g
)g h
)h i
;i j
} 
public 

async 
Task 
< 
Model_Dao_Result &
>& '$
InsertReceivingLineAsync( @
(@ A
Model_ReceivingLineA T
lineU Y
)Y Z
{ 
try 
{   	
var"" 

parameters"" 
="" 
new""  
MySqlParameter""! /
[""/ 0
]""0 1
{## 
new$$ 
MySqlParameter$$ "
($$" #
$str$$# 0
,$$0 1
line$$2 6
.$$6 7
Quantity$$7 ?
)$$? @
,$$@ A
new%% 
MySqlParameter%% "
(%%" #
$str%%# .
,%%. /
line%%0 4
.%%4 5
PartID%%5 ;
??%%< >
string%%? E
.%%E F
Empty%%F K
)%%K L
,%%L M
new&& 
MySqlParameter&& "
(&&" #
$str&&# 0
,&&0 1
line&&2 6
.&&6 7
PONumber&&7 ?
)&&? @
,&&@ A
new'' 
MySqlParameter'' "
(''" #
$str''# 6
,''6 7
line''8 <
.''< =
EmployeeNumber''= K
)''K L
,''L M
new(( 
MySqlParameter(( "
(((" #
$str((# ,
,((, -
line((. 2
.((2 3
Heat((3 7
??((8 :
string((; A
.((A B
Empty((B G
)((G H
,((H I
new)) 
MySqlParameter)) "
())" #
$str))# ,
,)), -
line)). 2
.))2 3
Date))3 7
)))7 8
,))8 9
new** 
MySqlParameter** "
(**" #
$str**# 7
,**7 8
line**9 =
.**= >
InitialLocation**> M
??**N P
string**Q W
.**W X
Empty**X ]
)**] ^
,**^ _
new++ 
MySqlParameter++ "
(++" #
$str++# 3
,++3 4
(++5 6
object++6 <
?++< =
)++= >
line++> B
.++B C
CoilsOnSkid++C N
??++O Q
DBNull++R X
.++X Y
Value++Y ^
)++^ _
,++_ `
new,, 
MySqlParameter,, "
(,," #
$str,,# 2
,,,2 3
line,,4 8
.,,8 9

VendorName,,9 C
??,,D F
$str,,G P
),,P Q
,,,Q R
new-- 
MySqlParameter-- "
(--" #
$str--# 7
,--7 8
line--9 =
.--= >
PartDescription--> M
??--N P
string--Q W
.--W X
Empty--X ]
)--] ^
,--^ _
new.. 
MySqlParameter.. "
(.." #
$str..# .
,... /
MySqlDbType..0 ;
...; <
Int32..< A
)..A B
{..C D
	Direction..E N
=..O P
System..Q W
...W X
Data..X \
...\ ]
ParameterDirection..] o
...o p
Output..p v
}..w x
,..x y
new// 
MySqlParameter// "
(//" #
$str//# 0
,//0 1
MySqlDbType//2 =
.//= >
VarChar//> E
,//E F
$num//G J
)//J K
{//L M
	Direction//N W
=//X Y
System//Z `
.//` a
Data//a e
.//e f
ParameterDirection//f x
.//x y
Output//y 
}
//Ä Å
}00 
;00 
if33 
(33 
!33 +
Helper_Database_StoredProcedure33 0
.330 1
ValidateParameters331 C
(33C D

parameters33D N
)33N O
)33O P
{44 
return55 
new55 
Model_Dao_Result55 +
{66 
Success77 
=77 
false77 #
,77# $
ErrorMessage88  
=88! "
$str88# O
,88O P
Severity99 
=99 
Models99 %
.99% &
Enums99& +
.99+ ,
Enum_ErrorSeverity99, >
.99> ?
Warning99? F
}:: 
;:: 
};; 
var>> 
result>> 
=>> 
await>> +
Helper_Database_StoredProcedure>> >
.>>> ?
ExecuteAsync>>? K
(>>K L
$str?? '
,??' (

parameters@@ 
,@@ 
_connectionStringAA !
)BB 
;BB 
returnDD 
resultDD 
;DD 
}EE 	
catchFF 
(FF 
	ExceptionFF 
exFF 
)FF 
{GG 	
returnHH 
newHH 
Model_Dao_ResultHH '
{II 
SuccessJJ 
=JJ 
falseJJ 
,JJ  
ErrorMessageKK 
=KK 
$"KK !
$strKK! L
{KKL M
exKKM O
.KKO P
MessageKKP W
}KKW X
"KKX Y
,KKY Z
SeverityLL 
=LL 
ModelsLL !
.LL! "
EnumsLL" '
.LL' (
Enum_ErrorSeverityLL( :
.LL: ;
ErrorLL; @
}MM 
;MM 
}NN 	
}OO 
}PP Äi
aC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Receiving\Dao_PackageTypePreference.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Data		$ (
.		( )
	Receiving		) 2
;		2 3
public 
class %
Dao_PackageTypePreference &
{ 
private 
readonly 
string 
_connectionString -
;- .
public 
%
Dao_PackageTypePreference $
($ %
string% +
connectionString, <
)< =
{ 
_connectionString 
= 
connectionString ,
??- /
throw0 5
new6 9!
ArgumentNullException: O
(O P
nameofP V
(V W
connectionStringW g
)g h
)h i
;i j
} 
public 

async 
Task 
< 
Model_Dao_Result &
<& ' 
Model_UserPreference' ;
>; <
>< =
GetByUserAsync> L
(L M
stringM S
usernameT \
)\ ]
{ 
try 
{ 	
var 

parameters 
= 
new  

Dictionary! +
<+ ,
string, 2
,2 3
object4 :
>: ;
{ 
{ 
$str 
, 
username &
}' (
} 
; 
return!! 
await!! +
Helper_Database_StoredProcedure!! 8
.!!8 9
ExecuteSingleAsync!!9 K
<!!K L 
Model_UserPreference!!L `
>!!` a
(!!a b
_connectionString"" !
,""! "
$str## 4
,##4 5
reader$$ 
=>$$ 
new$$  
Model_UserPreference$$ 2
{%% 
Username&& 
=&& 
reader&& %
[&&% &
$str&&& 0
]&&0 1
.&&1 2
ToString&&2 :
(&&: ;
)&&; <
??&&= ?
string&&@ F
.&&F G
Empty&&G L
,&&L M 
PreferredPackageType'' (
='') *
reader''+ 1
[''1 2
$str''2 J
]''J K
.''K L
ToString''L T
(''T U
)''U V
??''W Y
string''Z `
.''` a
Empty''a f
,''f g
Workstation(( 
=((  !
reader((" (
[((( )
$str(() 6
]((6 7
.((7 8
ToString((8 @
(((@ A
)((A B
??((C E
string((F L
.((L M
Empty((M R
,((R S
LastUpdated)) 
=))  !
Convert))" )
.))) *

ToDateTime))* 4
())4 5
reader))5 ;
[)); <
$str))< K
]))K L
)))L M
}** 
,** 

parameters++ 
)++ 
;++ 
},, 	
catch-- 
(-- 
	Exception-- 
ex-- 
)-- 
{.. 	
return// $
Model_Dao_Result_Factory// +
.//+ ,
Failure//, 3
<//3 4 
Model_UserPreference//4 H
>//H I
(//I J
$"00 
$str00 <
{00< =
ex00= ?
.00? @
Message00@ G
}00G H
"00H I
,00I J
ex11 
)11 
;11 
}22 	
}33 
public55 

async55 
Task55 
<55 
Model_Dao_Result55 &
>55& '
UpsertAsync55( 3
(553 4 
Model_UserPreference554 H

preference55I S
)55S T
{66 
try77 
{88 	
var99 

parameters99 
=99 
new99  

Dictionary99! +
<99+ ,
string99, 2
,992 3
object994 :
>99: ;
{:: 
{;; 
$str;; 
,;; 

preference;; (
.;;( )
Username;;) 1
};;2 3
,;;3 4
{<< 
$str<< *
,<<* +

preference<<, 6
.<<6 7 
PreferredPackageType<<7 K
}<<L M
,<<M N
{== 
$str== 
,==  

preference==! +
.==+ ,
Workstation==, 7
}==8 9
}>> 
;>> 
return@@ 
await@@ +
Helper_Database_StoredProcedure@@ 8
.@@8 9 
ExecuteNonQueryAsync@@9 M
(@@M N
_connectionStringAA !
,AA! "
$strBB /
,BB/ 0

parametersCC 
)CC 
;CC 
}DD 	
catchEE 
(EE 
	ExceptionEE 
exEE 
)EE 
{FF 	
returnGG $
Model_Dao_Result_FactoryGG +
.GG+ ,
FailureGG, 3
(GG3 4
$"HH 
$strHH ;
{HH; <
exHH< >
.HH> ?
MessageHH? F
}HHF G
"HHG H
,HHH I
exII 
)II 
;II 
}JJ 	
}KK 
publicQQ 

asyncQQ 
TaskQQ 
<QQ 
Model_Dao_ResultQQ &
<QQ& ''
Model_PackageTypePreferenceQQ' B
?QQB C
>QQC D
>QQD E
GetPreferenceAsyncQQF X
(QQX Y
stringQQY _
partIDQQ` f
)QQf g
{RR 
trySS 
{TT 	
varUU 

parametersUU 
=UU 
newUU  

DictionaryUU! +
<UU+ ,
stringUU, 2
,UU2 3
objectUU4 :
>UU: ;
{VV 
{WW 
$strWW 
,WW 
partIDWW %
}WW& '
}XX 
;XX 
var[[ 
result[[ 
=[[ 
await[[ +
Helper_Database_StoredProcedure[[ >
.[[> ?
ExecuteSingleAsync[[? Q
<[[Q R'
Model_PackageTypePreference[[R m
?[[m n
>[[n o
([[o p
_connectionString\\ !
,\\! "
$str]] -
,]]- .
reader^^ 
=>^^ 
new^^ '
Model_PackageTypePreference^^ 9
{__ 
PreferenceID``  
=``! "
Convert``# *
.``* +
ToInt32``+ 2
(``2 3
reader``3 9
[``9 :
$str``: H
]``H I
)``I J
,``J K
PartIDaa 
=aa 
readeraa #
[aa# $
$straa$ ,
]aa, -
.aa- .
ToStringaa. 6
(aa6 7
)aa7 8
??aa9 ;
stringaa< B
.aaB C
EmptyaaC H
,aaH I
PackageTypeNamebb #
=bb$ %
readerbb& ,
[bb, -
$strbb- >
]bb> ?
.bb? @
ToStringbb@ H
(bbH I
)bbI J
??bbK M
stringbbN T
.bbT U
EmptybbU Z
,bbZ [
CustomTypeNamecc "
=cc# $
readercc% +
[cc+ ,
$strcc, <
]cc< =
==cc> @
DBNullccA G
.ccG H
ValueccH M
?ccN O
nullccP T
:ccU V
readerccW ]
[cc] ^
$strcc^ n
]ccn o
.cco p
ToStringccp x
(ccx y
)ccy z
,ccz {
LastModifieddd  
=dd! "
Convertdd# *
.dd* +

ToDateTimedd+ 5
(dd5 6
readerdd6 <
[dd< =
$strdd= K
]ddK L
)ddL M
}ee 
,ee 

parametersff 
)gg 
;gg 
ifii 
(ii 
resultii 
.ii 
Successii 
)ii 
{jj 
returnkk $
Model_Dao_Result_Factorykk /
.kk/ 0
Successkk0 7
(kk7 8
resultkk8 >
.kk> ?
Datakk? C
)kkC D
;kkD E
}ll 
returnmm $
Model_Dao_Result_Factorymm +
.mm+ ,
Failuremm, 3
<mm3 4'
Model_PackageTypePreferencemm4 O
?mmO P
>mmP Q
(mmQ R
resultmmR X
.mmX Y
ErrorMessagemmY e
)mme f
;mmf g
}nn 	
catchoo 
(oo 
	Exceptionoo 
exoo 
)oo 
{pp 	
returnqq $
Model_Dao_Result_Factoryqq +
.qq+ ,
Failureqq, 3
<qq3 4'
Model_PackageTypePreferenceqq4 O
?qqO P
>qqP Q
(qqQ R
$"rr 
$strrr <
{rr< =
exrr= ?
.rr? @
Messagerr@ G
}rrG H
"rrH I
,rrI J
exss 
)ss 
;ss 
}tt 	
}uu 
publicww 

asyncww 
Taskww 
<ww 
Model_Dao_Resultww &
>ww& '
SavePreferenceAsyncww( ;
(ww; <'
Model_PackageTypePreferenceww< W

preferencewwX b
)wwb c
{xx 
tryyy 
{zz 	
var{{ 

parameters{{ 
={{ 
new{{  

Dictionary{{! +
<{{+ ,
string{{, 2
,{{2 3
object{{4 :
>{{: ;
{|| 
{}} 
$str}} 
,}} 

preference}} )
.}}) *
PartID}}* 0
}}}1 2
,}}2 3
{~~ 
$str~~ &
,~~& '

preference~~( 2
.~~2 3
PackageTypeName~~3 B
}~~C D
,~~D E
{ 
$str %
,% &

preference' 1
.1 2
CustomTypeName2 @
??A C
(D E
objectE K
)K L
DBNullL R
.R S
ValueS X
}Y Z
}
ÄÄ 
;
ÄÄ 
var
ÇÇ 
result
ÇÇ 
=
ÇÇ 
await
ÇÇ -
Helper_Database_StoredProcedure
ÇÇ >
.
ÇÇ> ?"
ExecuteNonQueryAsync
ÇÇ? S
(
ÇÇS T
_connectionString
ÉÉ !
,
ÉÉ! "
$str
ÑÑ .
,
ÑÑ. /

parameters
ÖÖ 
)
ÜÜ 
;
ÜÜ 
if
àà 
(
àà 
result
àà 
.
àà 
Success
àà 
)
àà 
{
ââ 
return
ää &
Model_Dao_Result_Factory
ää /
.
ää/ 0
Success
ää0 7
(
ää7 8
)
ää8 9
;
ää9 :
}
ãã 
return
åå &
Model_Dao_Result_Factory
åå +
.
åå+ ,
Failure
åå, 3
(
åå3 4
result
åå4 :
.
åå: ;
ErrorMessage
åå; G
)
ååG H
;
ååH I
}
çç 	
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé 
{
èè 	
return
êê &
Model_Dao_Result_Factory
êê +
.
êê+ ,
Failure
êê, 3
(
êê3 4
$"
ëë 
$str
ëë 8
{
ëë8 9
ex
ëë9 ;
.
ëë; <
Message
ëë< C
}
ëëC D
"
ëëD E
,
ëëE F
ex
íí 
)
íí 
;
íí 
}
ìì 	
}
îî 
public
ññ 

async
ññ 
Task
ññ 
<
ññ 
Model_Dao_Result
ññ &
<
ññ& '
bool
ññ' +
>
ññ+ ,
>
ññ, -#
DeletePreferenceAsync
ññ. C
(
ññC D
string
ññD J
partID
ññK Q
)
ññQ R
{
óó 
try
òò 
{
ôô 	
var
öö 

parameters
öö 
=
öö 
new
öö  

Dictionary
öö! +
<
öö+ ,
string
öö, 2
,
öö2 3
object
öö4 :
>
öö: ;
{
õõ 
{
úú 
$str
úú 
,
úú 
partID
úú %
}
úú& '
}
ùù 
;
ùù 
var
üü 
result
üü 
=
üü 
await
üü -
Helper_Database_StoredProcedure
üü >
.
üü> ?"
ExecuteNonQueryAsync
üü? S
(
üüS T
_connectionString
†† !
,
††! "
$str
°° 0
,
°°0 1

parameters
¢¢ 
)
££ 
;
££ 
if
•• 
(
•• 
result
•• 
.
•• 
Success
•• 
)
•• 
{
¶¶ 
return
ßß &
Model_Dao_Result_Factory
ßß /
.
ßß/ 0
Success
ßß0 7
(
ßß7 8
true
ßß8 <
)
ßß< =
;
ßß= >
}
®® 
return
©© &
Model_Dao_Result_Factory
©© +
.
©©+ ,
Failure
©©, 3
<
©©3 4
bool
©©4 8
>
©©8 9
(
©©9 :
result
©©: @
.
©©@ A
ErrorMessage
©©A M
)
©©M N
;
©©N O
}
™™ 	
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´ 
{
¨¨ 	
return
≠≠ &
Model_Dao_Result_Factory
≠≠ +
.
≠≠+ ,
Failure
≠≠, 3
<
≠≠3 4
bool
≠≠4 8
>
≠≠8 9
(
≠≠9 :
$"
ÆÆ 
$str
ÆÆ :
{
ÆÆ: ;
ex
ÆÆ; =
.
ÆÆ= >
Message
ÆÆ> E
}
ÆÆE F
"
ÆÆF G
,
ÆÆG H
ex
ØØ 
)
ØØ 
;
ØØ 
}
∞∞ 	
}
±± 
}≤≤ „/
WC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Receiving\Dao_DunnageLine.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Data		$ (
.		( )
	Receiving		) 2
;		2 3
public 
static 
class 
Dao_DunnageLine #
{ 
private 
static !
IService_ErrorHandler (
?( )
_errorHandler* 7
;7 8
public 

static 
void 
SetErrorHandler &
(& '!
IService_ErrorHandler' <
errorHandler= I
)I J
{ 
_errorHandler 
= 
errorHandler $
;$ %
} 
public   

static   
async   
Task   
<   
Model_Dao_Result   -
>  - ."
InsertDunnageLineAsync  / E
(  E F
Model_DunnageLine  F W
line  X \
)  \ ]
{!! 
try"" 
{## 	
string%% 
connectionString%% #
=%%$ %%
Helper_Database_Variables%%& ?
.%%? @
GetConnectionString%%@ S
(%%S T
useProduction%%T a
:%%a b
true%%c g
)%%g h
;%%h i
var(( 

parameters(( 
=(( 
new((  
MySqlParameter((! /
[((/ 0
]((0 1
{)) 
new** 
MySqlParameter** "
(**" #
$str**# -
,**- .
line**/ 3
.**3 4
Line1**4 9
??**: <
string**= C
.**C D
Empty**D I
)**I J
,**J K
new++ 
MySqlParameter++ "
(++" #
$str++# -
,++- .
line++/ 3
.++3 4
Line2++4 9
??++: <
string++= C
.++C D
Empty++D I
)++I J
,++J K
new,, 
MySqlParameter,, "
(,," #
$str,,# 0
,,,0 1
line,,2 6
.,,6 7
PONumber,,7 ?
),,? @
,,,@ A
new-- 
MySqlParameter-- "
(--" #
$str--# ,
,--, -
line--. 2
.--2 3
Date--3 7
)--7 8
,--8 9
new.. 
MySqlParameter.. "
(.." #
$str..# 6
,..6 7
line..8 <
...< =
EmployeeNumber..= K
)..K L
,..L M
new// 
MySqlParameter// "
(//" #
$str//# 2
,//2 3
line//4 8
.//8 9

VendorName//9 C
??//D F
$str//G P
)//P Q
,//Q R
new00 
MySqlParameter00 "
(00" #
$str00# 0
,000 1
line002 6
.006 7
Location007 ?
??00@ B
string00C I
.00I J
Empty00J O
)00O P
,00P Q
new11 
MySqlParameter11 "
(11" #
$str11# .
,11. /
MySqlDbType110 ;
.11; <
Int3211< A
)11A B
{11C D
	Direction11E N
=11O P
System11Q W
.11W X
Data11X \
.11\ ]
ParameterDirection11] o
.11o p
Output11p v
}11w x
,11x y
new22 
MySqlParameter22 "
(22" #
$str22# 0
,220 1
MySqlDbType222 =
.22= >
VarChar22> E
,22E F
$num22G J
)22J K
{22L M
	Direction22N W
=22X Y
System22Z `
.22` a
Data22a e
.22e f
ParameterDirection22f x
.22x y
Output22y 
}
22Ä Å
}33 
;33 
if66 
(66 
!66 +
Helper_Database_StoredProcedure66 0
.660 1
ValidateParameters661 C
(66C D

parameters66D N
)66N O
)66O P
{77 
return88 
new88 
Model_Dao_Result88 +
{99 
Success:: 
=:: 
false:: #
,::# $
ErrorMessage;;  
=;;! "
$str;;# O
,;;O P
Severity<< 
=<< 
Models<< %
.<<% &
Enums<<& +
.<<+ ,
Enum_ErrorSeverity<<, >
.<<> ?
Warning<<? F
}== 
;== 
}>> 
varAA 
resultAA 
=AA 
awaitAA +
Helper_Database_StoredProcedureAA >
.AA> ?
ExecuteAsyncAA? K
(AAK L
$strBB %
,BB% &

parametersCC 
,CC 
connectionStringDD  
)EE 
;EE 
returnGG 
resultGG 
;GG 
}HH 	
catchII 
(II 
	ExceptionII 
exII 
)II 
{JJ 	
varKK 
errorResultKK 
=KK 
newKK !
Model_Dao_ResultKK" 2
{LL 
SuccessMM 
=MM 
falseMM 
,MM  
ErrorMessageNN 
=NN 
$"NN !
$strNN! J
{NNJ K
exNNK M
.NNM N
MessageNNN U
}NNU V
"NNV W
,NNW X
SeverityOO 
=OO 
ModelsOO !
.OO! "
EnumsOO" '
.OO' (
Enum_ErrorSeverityOO( :
.OO: ;
ErrorOO; @
}PP 
;PP 
ifSS 
(SS 
_errorHandlerSS 
!=SS  
nullSS! %
)SS% &
{TT 
awaitUU 
_errorHandlerUU #
.UU# $
HandleErrorAsyncUU$ 4
(UU4 5
errorResultVV 
.VV  
ErrorMessageVV  ,
,VV, -
errorResultWW 
.WW  
SeverityWW  (
,WW( )
exXX 
,XX 

showDialogYY 
:YY 
falseYY  %
)ZZ 
;ZZ 
}[[ 
return]] 
errorResult]] 
;]] 
}^^ 	
}__ 
}`` ÅU
[C:\Users\johnk\source\repos\MTM_Receiving_Application\Data\InforVisual\Dao_InforVisualPO.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Data$ (
.( )
InforVisual) 4
;4 5
public

 
class

 
Dao_InforVisualPO

 
{ 
private 
readonly 
string 
_connectionString -
;- .
public 

Dao_InforVisualPO 
( 
string #'
inforVisualConnectionString$ ?
)? @
{ &
ValidateReadOnlyConnection "
(" #'
inforVisualConnectionString# >
)> ?
;? @
_connectionString 
= '
inforVisualConnectionString 7
;7 8
} 
private 
static 
void &
ValidateReadOnlyConnection 2
(2 3
string3 9
connectionString: J
)J K
{ 
if 

( 
string 
. 
IsNullOrWhiteSpace %
(% &
connectionString& 6
)6 7
)7 8
throw 
new !
ArgumentNullException +
(+ ,
nameof, 2
(2 3
connectionString3 C
)C D
)D E
;E F
try 
{ 	
var 
builder 
= 
new &
SqlConnectionStringBuilder 8
(8 9
connectionString9 I
)I J
;J K
if 
( 
builder 
. 
ApplicationIntent )
!=* ,
ApplicationIntent- >
.> ?
ReadOnly? G
)G H
{ 
throw 
new %
InvalidOperationException 3
(3 4
$"   
$str   f
"  f g
+  h i
$"!! 
$str!! 1
{!!1 2
builder!!2 9
.!!9 :
ApplicationIntent!!: K
}!!K L
$str!!L N
"!!N O
+!!P Q
$""" 
$str"" S
"""S T
+""U V
$str## R
)##R S
;##S T
}$$ 
}%% 	
catch&& 
(&& 
ArgumentException&&  
ex&&! #
)&&# $
{'' 	
throw(( 
new(( %
InvalidOperationException(( /
(((/ 0
$")) 
$str)) A
{))A B
ex))B D
.))D E
Message))E L
}))L M
"))M N
,))N O
ex))P R
)))R S
;))S T
}** 	
}++ 
public-- 

async-- 
Task-- 
<-- 
Model_Dao_Result-- &
<--& '
List--' +
<--+ ,
Model_InforVisualPO--, ?
>--? @
>--@ A
>--A B
GetByPoNumberAsync--C U
(--U V
string--V \
poNumber--] e
)--e f
{.. 
try// 
{00 	
using11 
var11 

connection11  
=11! "
new11# &
SqlConnection11' 4
(114 5
_connectionString115 F
)11F G
;11G H
await22 

connection22 
.22 
	OpenAsync22 &
(22& '
)22' (
;22( )
var44 
query44 
=44 
$str4I %
;II% &
usingKK 
varKK 
commandKK 
=KK 
newKK  #

SqlCommandKK$ .
(KK. /
queryKK/ 4
,KK4 5

connectionKK6 @
)KK@ A
;KKA B
commandLL 
.LL 

ParametersLL 
.LL 
AddWithValueLL +
(LL+ ,
$strLL, 7
,LL7 8
poNumberLL9 A
)LLA B
;LLB C
varNN 
listNN 
=NN 
newNN 
ListNN 
<NN  
Model_InforVisualPONN  3
>NN3 4
(NN4 5
)NN5 6
;NN6 7
usingOO 
varOO 
readerOO 
=OO 
awaitOO $
commandOO% ,
.OO, -
ExecuteReaderAsyncOO- ?
(OO? @
)OO@ A
;OOA B
whilePP 
(PP 
awaitPP 
readerPP 
.PP  
	ReadAsyncPP  )
(PP) *
)PP* +
)PP+ ,
{QQ 
listRR 
.RR 
AddRR 
(RR 
newRR 
Model_InforVisualPORR 0
{SS 
PoNumberTT 
=TT 
readerTT %
[TT% &
$strTT& 0
]TT0 1
.TT1 2
ToStringTT2 :
(TT: ;
)TT; <
??TT= ?
stringTT@ F
.TTF G
EmptyTTG L
,TTL M
PoLineUU 
=UU 
ConvertUU $
.UU$ %
ToInt32UU% ,
(UU, -
readerUU- 3
[UU3 4
$strUU4 <
]UU< =
)UU= >
,UU> ?

PartNumberVV 
=VV  
readerVV! '
[VV' (
$strVV( 4
]VV4 5
.VV5 6
ToStringVV6 >
(VV> ?
)VV? @
??VVA C
stringVVD J
.VVJ K
EmptyVVK P
,VVP Q
PartDescriptionWW #
=WW$ %
readerWW& ,
[WW, -
$strWW- >
]WW> ?
.WW? @
ToStringWW@ H
(WWH I
)WWI J
??WWK M
stringWWN T
.WWT U
EmptyWWU Z
,WWZ [

OrderedQtyXX 
=XX  
ConvertXX! (
.XX( )
	ToDecimalXX) 2
(XX2 3
readerXX3 9
[XX9 :
$strXX: F
]XXF G
)XXG H
,XXH I
ReceivedQtyYY 
=YY  !
ConvertYY" )
.YY) *
	ToDecimalYY* 3
(YY3 4
readerYY4 :
[YY: ;
$strYY; H
]YYH I
)YYI J
,YYJ K
RemainingQtyZZ  
=ZZ! "
ConvertZZ# *
.ZZ* +
	ToDecimalZZ+ 4
(ZZ4 5
readerZZ5 ;
[ZZ; <
$strZZ< J
]ZZJ K
)ZZK L
,ZZL M
UnitOfMeasure[[ !
=[[" #
reader[[$ *
[[[* +
$str[[+ :
][[: ;
.[[; <
ToString[[< D
([[D E
)[[E F
??[[G I
$str[[J N
,[[N O
DueDate\\ 
=\\ 
reader\\ $
[\\$ %
$str\\% .
]\\. /
==\\0 2
DBNull\\3 9
.\\9 :
Value\\: ?
?\\@ A
null\\B F
:\\G H
Convert\\I P
.\\P Q

ToDateTime\\Q [
(\\[ \
reader\\\ b
[\\b c
$str\\c l
]\\l m
)\\m n
,\\n o

VendorCode]] 
=]]  
reader]]! '
[]]' (
$str]]( 4
]]]4 5
.]]5 6
ToString]]6 >
(]]> ?
)]]? @
??]]A C
string]]D J
.]]J K
Empty]]K P
,]]P Q

VendorName^^ 
=^^  
reader^^! '
[^^' (
$str^^( 4
]^^4 5
.^^5 6
ToString^^6 >
(^^> ?
)^^? @
??^^A C
string^^D J
.^^J K
Empty^^K P
,^^P Q
PoStatus__ 
=__ 
reader__ %
[__% &
$str__& 0
]__0 1
.__1 2
ToString__2 :
(__: ;
)__; <
??__= ?
string__@ F
.__F G
Empty__G L
,__L M
SiteId`` 
=`` 
reader`` #
[``# $
$str``$ ,
]``, -
.``- .
ToString``. 6
(``6 7
)``7 8
??``9 ;
$str``< A
}aa 
)aa 
;aa 
}bb 
returndd $
Model_Dao_Result_Factorydd +
.dd+ ,
Successdd, 3
(dd3 4
listdd4 8
)dd8 9
;dd9 :
}ee 	
catchff 
(ff 
	Exceptionff 
exff 
)ff 
{gg 	
returnhh $
Model_Dao_Result_Factoryhh +
.hh+ ,
Failurehh, 3
<hh3 4
Listhh4 8
<hh8 9
Model_InforVisualPOhh9 L
>hhL M
>hhM N
(hhN O
$"ii 
$strii &
{ii& '
poNumberii' /
}ii/ 0
$strii0 2
{ii2 3
exii3 5
.ii5 6
Messageii6 =
}ii= >
"ii> ?
,ii? @
exjj 
)jj 
;jj 
}kk 	
}ll 
publicnn 

asyncnn 
Tasknn 
<nn 
Model_Dao_Resultnn &
<nn& '
boolnn' +
>nn+ ,
>nn, -!
ValidatePoNumberAsyncnn. C
(nnC D
stringnnD J
poNumbernnK S
)nnS T
{oo 
trypp 
{qq 	
usingrr 
varrr 

connectionrr  
=rr! "
newrr# &
SqlConnectionrr' 4
(rr4 5
_connectionStringrr5 F
)rrF G
;rrG H
awaitss 

connectionss 
.ss 
	OpenAsyncss &
(ss& '
)ss' (
;ss( )
varuu 
queryuu 
=uu 
$struu ^
;uu^ _
usingvv 
varvv 
commandvv 
=vv 
newvv  #

SqlCommandvv$ .
(vv. /
queryvv/ 4
,vv4 5

connectionvv6 @
)vv@ A
;vvA B
commandww 
.ww 

Parametersww 
.ww 
AddWithValueww +
(ww+ ,
$strww, 7
,ww7 8
poNumberww9 A
)wwA B
;wwB C
varyy 
countyy 
=yy 
Convertyy 
.yy  
ToInt32yy  '
(yy' (
awaityy( -
commandyy. 5
.yy5 6
ExecuteScalarAsyncyy6 H
(yyH I
)yyI J
)yyJ K
;yyK L
returnzz $
Model_Dao_Result_Factoryzz +
.zz+ ,
Successzz, 3
(zz3 4
countzz4 9
>zz: ;
$numzz< =
)zz= >
;zz> ?
}{{ 	
catch|| 
(|| 
	Exception|| 
ex|| 
)|| 
{}} 	
return~~ $
Model_Dao_Result_Factory~~ +
.~~+ ,
Failure~~, 3
<~~3 4
bool~~4 8
>~~8 9
(~~9 :
$" 
$str &
{& '
poNumber' /
}/ 0
$str0 2
{2 3
ex3 5
.5 6
Message6 =
}= >
"> ?
,? @
ex
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
}
ÇÇ 
}ÉÉ ‰¶
iC:\Users\johnk\source\repos\MTM_Receiving_Application\Helpers\Database\Helper_Database_StoredProcedure.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Helpers$ +
.+ ,
Database, 4
;4 5
public 
static 
class +
Helper_Database_StoredProcedure 3
{ 
private 
const 
int 

MaxRetries  
=! "
$num# $
;$ %
private 
static 
readonly 
int 
[  
]  !
RetryDelaysMs" /
=0 1
{2 3
$num4 7
,7 8
$num9 <
,< =
$num> A
}B C
;C D
public 

static 
async 
Task 
< 
Model_Dao_Result -
>- .
ExecuteAsync/ ;
(; <
string 
procedureName 
, 
MySqlParameter 
[ 
] 

parameters #
,# $
string 
connectionString 
)  
{ 
var 
result 
= 
new 
Model_Dao_Result )
() *
)* +
;+ ,
var 
	stopwatch 
= 
	Stopwatch !
.! "
StartNew" *
(* +
)+ ,
;, -
int   
attempt   
=   
$num   
;   
while"" 
("" 
attempt"" 
<"" 

MaxRetries"" #
)""# $
{## 	
attempt$$ 
++$$ 
;$$ 
try&& 
{'' 
using(( 
var(( 

connection(( $
=((% &
new((' *
MySqlConnection((+ :
(((: ;
connectionString((; K
)((K L
;((L M
await)) 

connection))  
.))  !
	OpenAsync))! *
())* +
)))+ ,
;)), -
using++ 
var++ 
command++ !
=++" #
new++$ '
MySqlCommand++( 4
(++4 5
procedureName++5 B
,++B C

connection++D N
)++N O
{,, 
CommandType-- 
=--  !
CommandType--" -
.--- .
StoredProcedure--. =
}.. 
;.. 
if00 
(00 

parameters00 
!=00 !
null00" &
)00& '
{11 
command22 
.22 

Parameters22 &
.22& '
AddRange22' /
(22/ 0

parameters220 :
)22: ;
;22; <
}33 
var55 
affectedRows55  
=55! "
await55# (
command55) 0
.550 1 
ExecuteNonQueryAsync551 E
(55E F
)55F G
;55G H
foreach88 
(88 
var88 
param88 "
in88# %
command88& -
.88- .

Parameters88. 8
)888 9
{99 
if:: 
(:: 
param:: 
is::  
MySqlParameter::! /
p::0 1
&&::2 4
(::5 6
p::6 7
.::7 8
	Direction::8 A
==::B D
ParameterDirection::E W
.::W X
Output::X ^
||::_ a
p::b c
.::c d
	Direction::d m
==::n p
ParameterDirection	::q É
.
::É Ñ
InputOutput
::Ñ è
)
::è ê
)
::ê ë
{;; 
}>> 
}?? 
	stopwatchAA 
.AA 
StopAA 
(AA 
)AA  
;AA  !
resultBB 
.BB 
SuccessBB 
=BB  
trueBB! %
;BB% &
resultCC 
.CC 
AffectedRowsCC #
=CC$ %
affectedRowsCC& 2
;CC2 3
resultDD 
.DD 
ExecutionTimeMsDD &
=DD' (
	stopwatchDD) 2
.DD2 3
ElapsedMillisecondsDD3 F
;DDF G
returnEE 
resultEE 
;EE 
}FF 
catchGG 
(GG 
MySqlExceptionGG !
exGG" $
)GG$ %
whenGG& *
(GG+ ,
IsTransientErrorGG, <
(GG< =
exGG= ?
)GG? @
&&GGA C
attemptGGD K
<GGL M

MaxRetriesGGN X
)GGX Y
{HH 
awaitII 
TaskII 
.II 
DelayII  
(II  !
RetryDelaysMsII! .
[II. /
attemptII/ 6
-II7 8
$numII9 :
]II: ;
)II; <
;II< =
continueJJ 
;JJ 
}KK 
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL  
{MM 
	stopwatchNN 
.NN 
StopNN 
(NN 
)NN  
;NN  !
returnOO $
Model_Dao_Result_FactoryOO /
.OO/ 0
FailureOO0 7
(OO7 8
$"OO8 :
$strOO: L
{OOL M
procedureNameOOM Z
}OOZ [
$strOO[ e
{OOe f
exOOf h
.OOh i
MessageOOi p
}OOp q
"OOq r
,OOr s
exOOt v
)OOv w
;OOw x
}PP 
}QQ 	
	stopwatchSS 
.SS 
StopSS 
(SS 
)SS 
;SS 
returnTT $
Model_Dao_Result_FactoryTT '
.TT' (
FailureTT( /
(TT/ 0
$"TT0 2
$strTT2 D
{TTD E
procedureNameTTE R
}TTR S
$strTTS b
{TTb c

MaxRetriesTTc m
}TTm n
$strTTn w
"TTw x
)TTx y
;TTy z
}UU 
publicZZ 

staticZZ 
boolZZ 
ValidateParametersZZ )
(ZZ) *
MySqlParameterZZ* 8
[ZZ8 9
]ZZ9 :

parametersZZ; E
)ZZE F
{[[ 
if\\ 

(\\ 

parameters\\ 
==\\ 
null\\ 
)\\ 
return\\  &
true\\' +
;\\+ ,
foreach^^ 
(^^ 
var^^ 
param^^ 
in^^ 

parameters^^ (
)^^( )
{__ 	
if`` 
(`` 
param`` 
.`` 
Value`` 
==`` 
null`` #
&&``$ &
param``' ,
.``, -
	Direction``- 6
==``7 9
ParameterDirection``: L
.``L M
Input``M R
)``R S
{aa 
returncc 
falsecc 
;cc 
}dd 
}ee 	
returnff 
trueff 
;ff 
}gg 
publicll 

staticll 
asyncll 
Taskll 
<ll 
Model_Dao_Resultll -
>ll- . 
ExecuteNonQueryAsyncll/ C
(llC D
stringmm 
connectionStringmm 
,mm  
stringnn 
procedureNamenn 
,nn 

Dictionaryoo 
<oo 
stringoo 
,oo 
objectoo !
>oo! "
?oo" #

parametersoo$ .
=oo/ 0
nulloo1 5
)oo5 6
{pp 
varqq 
resultqq 
=qq 
newqq 
Model_Dao_Resultqq )
(qq) *
)qq* +
;qq+ ,
varrr 
	stopwatchrr 
=rr 
	Stopwatchrr !
.rr! "
StartNewrr" *
(rr* +
)rr+ ,
;rr, -
intss 
attemptss 
=ss 
$numss 
;ss 
whileuu 
(uu 
attemptuu 
<uu 

MaxRetriesuu #
)uu# $
{vv 	
attemptww 
++ww 
;ww 
tryyy 
{zz 
using{{ 
var{{ 

connection{{ $
={{% &
new{{' *
MySqlConnection{{+ :
({{: ;
connectionString{{; K
){{K L
;{{L M
await|| 

connection||  
.||  !
	OpenAsync||! *
(||* +
)||+ ,
;||, -
using~~ 
var~~ 
command~~ !
=~~" #
new~~$ '
MySqlCommand~~( 4
(~~4 5
procedureName~~5 B
,~~B C

connection~~D N
)~~N O
{ 
CommandType
ÄÄ 
=
ÄÄ  !
CommandType
ÄÄ" -
.
ÄÄ- .
StoredProcedure
ÄÄ. =
}
ÅÅ 
;
ÅÅ 
AddParameters
ÉÉ 
(
ÉÉ 
command
ÉÉ %
,
ÉÉ% &

parameters
ÉÉ' 1
)
ÉÉ1 2
;
ÉÉ2 3
var
ÖÖ 
affectedRows
ÖÖ  
=
ÖÖ! "
await
ÖÖ# (
command
ÖÖ) 0
.
ÖÖ0 1"
ExecuteNonQueryAsync
ÖÖ1 E
(
ÖÖE F
)
ÖÖF G
;
ÖÖG H
	stopwatch
áá 
.
áá 
Stop
áá 
(
áá 
)
áá  
;
áá  !
result
àà 
.
àà 
Success
àà 
=
àà  
true
àà! %
;
àà% &
result
ââ 
.
ââ 
AffectedRows
ââ #
=
ââ$ %
affectedRows
ââ& 2
;
ââ2 3
result
ää 
.
ää 
ExecutionTimeMs
ää &
=
ää' (
	stopwatch
ää) 2
.
ää2 3!
ElapsedMilliseconds
ää3 F
;
ääF G
return
ãã 
result
ãã 
;
ãã 
}
åå 
catch
çç 
(
çç 
MySqlException
çç !
ex
çç" $
)
çç$ %
when
çç& *
(
çç+ ,
IsTransientError
çç, <
(
çç< =
ex
çç= ?
)
çç? @
&&
ççA C
attempt
ççD K
<
ççL M

MaxRetries
ççN X
)
ççX Y
{
éé 
await
èè 
Task
èè 
.
èè 
Delay
èè  
(
èè  !
RetryDelaysMs
èè! .
[
èè. /
attempt
èè/ 6
-
èè7 8
$num
èè9 :
]
èè: ;
)
èè; <
;
èè< =
continue
êê 
;
êê 
}
ëë 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
ìì 
	stopwatch
îî 
.
îî 
Stop
îî 
(
îî 
)
îî  
;
îî  !
result
ïï 
.
ïï 
Success
ïï 
=
ïï  
false
ïï! &
;
ïï& '
result
ññ 
.
ññ 
ErrorMessage
ññ #
=
ññ$ %
$"
ññ& (
$str
ññ( :
{
ññ: ;
procedureName
ññ; H
}
ññH I
$str
ññI S
{
ññS T
ex
ññT V
.
ññV W
Message
ññW ^
}
ññ^ _
"
ññ_ `
;
ññ` a
result
óó 
.
óó 
Severity
óó 
=
óó  ! 
Enum_ErrorSeverity
óó" 4
.
óó4 5
Error
óó5 :
;
óó: ;
result
òò 
.
òò 
ExecutionTimeMs
òò &
=
òò' (
	stopwatch
òò) 2
.
òò2 3!
ElapsedMilliseconds
òò3 F
;
òòF G
result
ôô 
.
ôô 
	Exception
ôô  
=
ôô! "
ex
ôô# %
;
ôô% &
return
öö 
result
öö 
;
öö 
}
õõ 
}
úú 	
	stopwatch
ûû 
.
ûû 
Stop
ûû 
(
ûû 
)
ûû 
;
ûû 
result
üü 
.
üü 
Success
üü 
=
üü 
false
üü 
;
üü 
result
†† 
.
†† 
ErrorMessage
†† 
=
†† 
$"
††  
$str
††  2
{
††2 3
procedureName
††3 @
}
††@ A
$str
††A P
{
††P Q

MaxRetries
††Q [
}
††[ \
$str
††\ e
"
††e f
;
††f g
result
°° 
.
°° 
Severity
°° 
=
°°  
Enum_ErrorSeverity
°° ,
.
°°, -
Critical
°°- 5
;
°°5 6
result
¢¢ 
.
¢¢ 
ExecutionTimeMs
¢¢ 
=
¢¢  
	stopwatch
¢¢! *
.
¢¢* +!
ElapsedMilliseconds
¢¢+ >
;
¢¢> ?
return
££ 
result
££ 
;
££ 
}
§§ 
public
©© 

static
©© 
async
©© 
Task
©© 
<
©© 
Model_Dao_Result
©© -
<
©©- .
T
©©. /
>
©©/ 0
>
©©0 1 
ExecuteSingleAsync
©©2 D
<
©©D E
T
©©E F
>
©©F G
(
©©G H
string
™™ 
connectionString
™™ 
,
™™  
string
´´ 
procedureName
´´ 
,
´´ 
Func
¨¨ 
<
¨¨ 
IDataReader
¨¨ 
,
¨¨ 
T
¨¨ 
>
¨¨ 
mapper
¨¨ #
,
¨¨# $

Dictionary
≠≠ 
<
≠≠ 
string
≠≠ 
,
≠≠ 
object
≠≠ !
>
≠≠! "
?
≠≠" #

parameters
≠≠$ .
=
≠≠/ 0
null
≠≠1 5
)
≠≠5 6
{
ÆÆ 
var
ØØ 
result
ØØ 
=
ØØ 
new
ØØ 
Model_Dao_Result
ØØ )
<
ØØ) *
T
ØØ* +
>
ØØ+ ,
(
ØØ, -
)
ØØ- .
;
ØØ. /
var
∞∞ 
	stopwatch
∞∞ 
=
∞∞ 
	Stopwatch
∞∞ !
.
∞∞! "
StartNew
∞∞" *
(
∞∞* +
)
∞∞+ ,
;
∞∞, -
int
±± 
attempt
±± 
=
±± 
$num
±± 
;
±± 
while
≥≥ 
(
≥≥ 
attempt
≥≥ 
<
≥≥ 

MaxRetries
≥≥ #
)
≥≥# $
{
¥¥ 	
attempt
µµ 
++
µµ 
;
µµ 
try
∑∑ 
{
∏∏ 
using
ππ 
var
ππ 

connection
ππ $
=
ππ% &
new
ππ' *
MySqlConnection
ππ+ :
(
ππ: ;
connectionString
ππ; K
)
ππK L
;
ππL M
await
∫∫ 

connection
∫∫  
.
∫∫  !
	OpenAsync
∫∫! *
(
∫∫* +
)
∫∫+ ,
;
∫∫, -
using
ºº 
var
ºº 
command
ºº !
=
ºº" #
new
ºº$ '
MySqlCommand
ºº( 4
(
ºº4 5
procedureName
ºº5 B
,
ººB C

connection
ººD N
)
ººN O
{
ΩΩ 
CommandType
ææ 
=
ææ  !
CommandType
ææ" -
.
ææ- .
StoredProcedure
ææ. =
}
øø 
;
øø 
AddParameters
¡¡ 
(
¡¡ 
command
¡¡ %
,
¡¡% &

parameters
¡¡' 1
)
¡¡1 2
;
¡¡2 3
using
√√ 
var
√√ 
reader
√√  
=
√√! "
await
√√# (
command
√√) 0
.
√√0 1 
ExecuteReaderAsync
√√1 C
(
√√C D
)
√√D E
;
√√E F
if
≈≈ 
(
≈≈ 
await
≈≈ 
reader
≈≈  
.
≈≈  !
	ReadAsync
≈≈! *
(
≈≈* +
)
≈≈+ ,
)
≈≈, -
{
∆∆ 
result
«« 
.
«« 
Data
«« 
=
««  !
mapper
««" (
(
««( )
reader
««) /
)
««/ 0
;
««0 1
result
»» 
.
»» 
Success
»» "
=
»»# $
true
»»% )
;
»») *
result
…… 
.
…… 
AffectedRows
…… '
=
……( )
$num
……* +
;
……+ ,
}
   
else
ÀÀ 
{
ÃÃ 
result
ÕÕ 
.
ÕÕ 
Success
ÕÕ "
=
ÕÕ# $
false
ÕÕ% *
;
ÕÕ* +
result
ŒŒ 
.
ŒŒ 
ErrorMessage
ŒŒ '
=
ŒŒ( )
$str
ŒŒ* ;
;
ŒŒ; <
result
œœ 
.
œœ 
Severity
œœ #
=
œœ$ % 
Enum_ErrorSeverity
œœ& 8
.
œœ8 9
Info
œœ9 =
;
œœ= >
}
–– 
	stopwatch
““ 
.
““ 
Stop
““ 
(
““ 
)
““  
;
““  !
result
”” 
.
”” 
ExecutionTimeMs
”” &
=
””' (
	stopwatch
””) 2
.
””2 3!
ElapsedMilliseconds
””3 F
;
””F G
return
‘‘ 
result
‘‘ 
;
‘‘ 
}
’’ 
catch
÷÷ 
(
÷÷ 
MySqlException
÷÷ !
ex
÷÷" $
)
÷÷$ %
when
÷÷& *
(
÷÷+ ,
IsTransientError
÷÷, <
(
÷÷< =
ex
÷÷= ?
)
÷÷? @
&&
÷÷A C
attempt
÷÷D K
<
÷÷L M

MaxRetries
÷÷N X
)
÷÷X Y
{
◊◊ 
await
ÿÿ 
Task
ÿÿ 
.
ÿÿ 
Delay
ÿÿ  
(
ÿÿ  !
RetryDelaysMs
ÿÿ! .
[
ÿÿ. /
attempt
ÿÿ/ 6
-
ÿÿ7 8
$num
ÿÿ9 :
]
ÿÿ: ;
)
ÿÿ; <
;
ÿÿ< =
continue
ŸŸ 
;
ŸŸ 
}
⁄⁄ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
‹‹ 
	stopwatch
›› 
.
›› 
Stop
›› 
(
›› 
)
››  
;
››  !
return
ﬁﬁ &
Model_Dao_Result_Factory
ﬁﬁ /
.
ﬁﬁ/ 0
Failure
ﬁﬁ0 7
<
ﬁﬁ7 8
T
ﬁﬁ8 9
>
ﬁﬁ9 :
(
ﬁﬁ: ;
$"
ﬁﬁ; =
$str
ﬁﬁ= O
{
ﬁﬁO P
procedureName
ﬁﬁP ]
}
ﬁﬁ] ^
$str
ﬁﬁ^ h
{
ﬁﬁh i
ex
ﬁﬁi k
.
ﬁﬁk l
Message
ﬁﬁl s
}
ﬁﬁs t
"
ﬁﬁt u
,
ﬁﬁu v
ex
ﬁﬁw y
)
ﬁﬁy z
;
ﬁﬁz {
}
ﬂﬂ 
}
‡‡ 	
	stopwatch
‚‚ 
.
‚‚ 
Stop
‚‚ 
(
‚‚ 
)
‚‚ 
;
‚‚ 
return
„„ &
Model_Dao_Result_Factory
„„ '
.
„„' (
Failure
„„( /
<
„„/ 0
T
„„0 1
>
„„1 2
(
„„2 3
$"
„„3 5
$str
„„5 G
{
„„G H
procedureName
„„H U
}
„„U V
$str
„„V e
{
„„e f

MaxRetries
„„f p
}
„„p q
$str
„„q z
"
„„z {
)
„„{ |
;
„„| }
}
‰‰ 
public
ÈÈ 

static
ÈÈ 
async
ÈÈ 
Task
ÈÈ 
<
ÈÈ 
Model_Dao_Result
ÈÈ -
<
ÈÈ- .
List
ÈÈ. 2
<
ÈÈ2 3
T
ÈÈ3 4
>
ÈÈ4 5
>
ÈÈ5 6
>
ÈÈ6 7
ExecuteListAsync
ÈÈ8 H
<
ÈÈH I
T
ÈÈI J
>
ÈÈJ K
(
ÈÈK L
string
ÍÍ 
connectionString
ÍÍ 
,
ÍÍ  
string
ÎÎ 
procedureName
ÎÎ 
,
ÎÎ 
Func
ÏÏ 
<
ÏÏ 
IDataReader
ÏÏ 
,
ÏÏ 
T
ÏÏ 
>
ÏÏ 
mapper
ÏÏ #
,
ÏÏ# $

Dictionary
ÌÌ 
<
ÌÌ 
string
ÌÌ 
,
ÌÌ 
object
ÌÌ !
>
ÌÌ! "
?
ÌÌ" #

parameters
ÌÌ$ .
=
ÌÌ/ 0
null
ÌÌ1 5
)
ÌÌ5 6
{
ÓÓ 
var
ÔÔ 
result
ÔÔ 
=
ÔÔ 
new
ÔÔ 
Model_Dao_Result
ÔÔ )
<
ÔÔ) *
List
ÔÔ* .
<
ÔÔ. /
T
ÔÔ/ 0
>
ÔÔ0 1
>
ÔÔ1 2
(
ÔÔ2 3
)
ÔÔ3 4
;
ÔÔ4 5
var
 
	stopwatch
 
=
 
	Stopwatch
 !
.
! "
StartNew
" *
(
* +
)
+ ,
;
, -
int
ÒÒ 
attempt
ÒÒ 
=
ÒÒ 
$num
ÒÒ 
;
ÒÒ 
while
ÛÛ 
(
ÛÛ 
attempt
ÛÛ 
<
ÛÛ 

MaxRetries
ÛÛ #
)
ÛÛ# $
{
ÙÙ 	
attempt
ıı 
++
ıı 
;
ıı 
try
˜˜ 
{
¯¯ 
using
˘˘ 
var
˘˘ 

connection
˘˘ $
=
˘˘% &
new
˘˘' *
MySqlConnection
˘˘+ :
(
˘˘: ;
connectionString
˘˘; K
)
˘˘K L
;
˘˘L M
await
˙˙ 

connection
˙˙  
.
˙˙  !
	OpenAsync
˙˙! *
(
˙˙* +
)
˙˙+ ,
;
˙˙, -
using
¸¸ 
var
¸¸ 
command
¸¸ !
=
¸¸" #
new
¸¸$ '
MySqlCommand
¸¸( 4
(
¸¸4 5
procedureName
¸¸5 B
,
¸¸B C

connection
¸¸D N
)
¸¸N O
{
˝˝ 
CommandType
˛˛ 
=
˛˛  !
CommandType
˛˛" -
.
˛˛- .
StoredProcedure
˛˛. =
}
ˇˇ 
;
ˇˇ 
AddParameters
ÅÅ 
(
ÅÅ 
command
ÅÅ %
,
ÅÅ% &

parameters
ÅÅ' 1
)
ÅÅ1 2
;
ÅÅ2 3
using
ÉÉ 
var
ÉÉ 
reader
ÉÉ  
=
ÉÉ! "
await
ÉÉ# (
command
ÉÉ) 0
.
ÉÉ0 1 
ExecuteReaderAsync
ÉÉ1 C
(
ÉÉC D
)
ÉÉD E
;
ÉÉE F
var
ÑÑ 
list
ÑÑ 
=
ÑÑ 
new
ÑÑ 
List
ÑÑ #
<
ÑÑ# $
T
ÑÑ$ %
>
ÑÑ% &
(
ÑÑ& '
)
ÑÑ' (
;
ÑÑ( )
while
ÜÜ 
(
ÜÜ 
await
ÜÜ 
reader
ÜÜ #
.
ÜÜ# $
	ReadAsync
ÜÜ$ -
(
ÜÜ- .
)
ÜÜ. /
)
ÜÜ/ 0
{
áá 
list
àà 
.
àà 
Add
àà 
(
àà 
mapper
àà #
(
àà# $
reader
àà$ *
)
àà* +
)
àà+ ,
;
àà, -
}
ââ 
result
ãã 
.
ãã 
Data
ãã 
=
ãã 
list
ãã "
;
ãã" #
result
åå 
.
åå 
Success
åå 
=
åå  
true
åå! %
;
åå% &
result
çç 
.
çç 
AffectedRows
çç #
=
çç$ %
list
çç& *
.
çç* +
Count
çç+ 0
;
çç0 1
	stopwatch
èè 
.
èè 
Stop
èè 
(
èè 
)
èè  
;
èè  !
result
êê 
.
êê 
ExecutionTimeMs
êê &
=
êê' (
	stopwatch
êê) 2
.
êê2 3!
ElapsedMilliseconds
êê3 F
;
êêF G
return
ëë 
result
ëë 
;
ëë 
}
íí 
catch
ìì 
(
ìì 
MySqlException
ìì !
ex
ìì" $
)
ìì$ %
when
ìì& *
(
ìì+ ,
IsTransientError
ìì, <
(
ìì< =
ex
ìì= ?
)
ìì? @
&&
ììA C
attempt
ììD K
<
ììL M

MaxRetries
ììN X
)
ììX Y
{
îî 
await
ïï 
Task
ïï 
.
ïï 
Delay
ïï  
(
ïï  !
RetryDelaysMs
ïï! .
[
ïï. /
attempt
ïï/ 6
-
ïï7 8
$num
ïï9 :
]
ïï: ;
)
ïï; <
;
ïï< =
continue
ññ 
;
ññ 
}
óó 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
ôô 
	stopwatch
öö 
.
öö 
Stop
öö 
(
öö 
)
öö  
;
öö  !
return
õõ &
Model_Dao_Result_Factory
õõ /
.
õõ/ 0
Failure
õõ0 7
<
õõ7 8
List
õõ8 <
<
õõ< =
T
õõ= >
>
õõ> ?
>
õõ? @
(
õõ@ A
$"
õõA C
$str
õõC U
{
õõU V
procedureName
õõV c
}
õõc d
$str
õõd n
{
õõn o
ex
õõo q
.
õõq r
Message
õõr y
}
õõy z
"
õõz {
,
õõ{ |
ex
õõ} 
)õõ Ä
;õõÄ Å
}
úú 
}
ùù 	
	stopwatch
üü 
.
üü 
Stop
üü 
(
üü 
)
üü 
;
üü 
return
†† &
Model_Dao_Result_Factory
†† '
.
††' (
Failure
††( /
<
††/ 0
List
††0 4
<
††4 5
T
††5 6
>
††6 7
>
††7 8
(
††8 9
$"
††9 ;
$str
††; M
{
††M N
procedureName
††N [
}
††[ \
$str
††\ k
{
††k l

MaxRetries
††l v
}
††v w
$str††w Ä
"††Ä Å
)††Å Ç
;††Ç É
}
°° 
public
¶¶ 

static
¶¶ 
async
¶¶ 
Task
¶¶ 
<
¶¶ 
Model_Dao_Result
¶¶ -
<
¶¶- .
	DataTable
¶¶. 7
>
¶¶7 8
>
¶¶8 9#
ExecuteDataTableAsync
¶¶: O
(
¶¶O P
string
ßß 
connectionString
ßß 
,
ßß  
string
®® 
procedureName
®® 
,
®® 

Dictionary
©© 
<
©© 
string
©© 
,
©© 
object
©© !
>
©©! "
?
©©" #

parameters
©©$ .
=
©©/ 0
null
©©1 5
)
©©5 6
{
™™ 
var
´´ 
result
´´ 
=
´´ 
new
´´ 
Model_Dao_Result
´´ )
<
´´) *
	DataTable
´´* 3
>
´´3 4
(
´´4 5
)
´´5 6
;
´´6 7
var
¨¨ 
	stopwatch
¨¨ 
=
¨¨ 
	Stopwatch
¨¨ !
.
¨¨! "
StartNew
¨¨" *
(
¨¨* +
)
¨¨+ ,
;
¨¨, -
int
≠≠ 
attempt
≠≠ 
=
≠≠ 
$num
≠≠ 
;
≠≠ 
while
ØØ 
(
ØØ 
attempt
ØØ 
<
ØØ 

MaxRetries
ØØ #
)
ØØ# $
{
∞∞ 	
attempt
±± 
++
±± 
;
±± 
try
≥≥ 
{
¥¥ 
using
µµ 
var
µµ 

connection
µµ $
=
µµ% &
new
µµ' *
MySqlConnection
µµ+ :
(
µµ: ;
connectionString
µµ; K
)
µµK L
;
µµL M
await
∂∂ 

connection
∂∂  
.
∂∂  !
	OpenAsync
∂∂! *
(
∂∂* +
)
∂∂+ ,
;
∂∂, -
using
∏∏ 
var
∏∏ 
command
∏∏ !
=
∏∏" #
new
∏∏$ '
MySqlCommand
∏∏( 4
(
∏∏4 5
procedureName
∏∏5 B
,
∏∏B C

connection
∏∏D N
)
∏∏N O
{
ππ 
CommandType
∫∫ 
=
∫∫  !
CommandType
∫∫" -
.
∫∫- .
StoredProcedure
∫∫. =
}
ªª 
;
ªª 
AddParameters
ΩΩ 
(
ΩΩ 
command
ΩΩ %
,
ΩΩ% &

parameters
ΩΩ' 1
)
ΩΩ1 2
;
ΩΩ2 3
using
øø 
var
øø 
reader
øø  
=
øø! "
await
øø# (
command
øø) 0
.
øø0 1 
ExecuteReaderAsync
øø1 C
(
øøC D
)
øøD E
;
øøE F
var
¿¿ 
	dataTable
¿¿ 
=
¿¿ 
new
¿¿  #
	DataTable
¿¿$ -
(
¿¿- .
)
¿¿. /
;
¿¿/ 0
	dataTable
¡¡ 
.
¡¡ 
Load
¡¡ 
(
¡¡ 
reader
¡¡ %
)
¡¡% &
;
¡¡& '
	stopwatch
√√ 
.
√√ 
Stop
√√ 
(
√√ 
)
√√  
;
√√  !
result
ƒƒ 
.
ƒƒ 
Success
ƒƒ 
=
ƒƒ  
true
ƒƒ! %
;
ƒƒ% &
result
≈≈ 
.
≈≈ 
Data
≈≈ 
=
≈≈ 
	dataTable
≈≈ '
;
≈≈' (
result
∆∆ 
.
∆∆ 
AffectedRows
∆∆ #
=
∆∆$ %
	dataTable
∆∆& /
.
∆∆/ 0
Rows
∆∆0 4
.
∆∆4 5
Count
∆∆5 :
;
∆∆: ;
result
«« 
.
«« 
ExecutionTimeMs
«« &
=
««' (
	stopwatch
««) 2
.
««2 3!
ElapsedMilliseconds
««3 F
;
««F G
return
»» 
result
»» 
;
»» 
}
…… 
catch
   
(
   
MySqlException
   !
ex
  " $
)
  $ %
when
  & *
(
  + ,
IsTransientError
  , <
(
  < =
ex
  = ?
)
  ? @
&&
  A C
attempt
  D K
<
  L M

MaxRetries
  N X
)
  X Y
{
ÀÀ 
await
ÃÃ 
Task
ÃÃ 
.
ÃÃ 
Delay
ÃÃ  
(
ÃÃ  !
RetryDelaysMs
ÃÃ! .
[
ÃÃ. /
attempt
ÃÃ/ 6
-
ÃÃ7 8
$num
ÃÃ9 :
]
ÃÃ: ;
)
ÃÃ; <
;
ÃÃ< =
continue
ÕÕ 
;
ÕÕ 
}
ŒŒ 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
–– 
	stopwatch
—— 
.
—— 
Stop
—— 
(
—— 
)
——  
;
——  !
result
““ 
.
““ 
Success
““ 
=
““  
false
““! &
;
““& '
result
”” 
.
”” 
ErrorMessage
”” #
=
””$ %
$"
””& (
$str
””( :
{
””: ;
procedureName
””; H
}
””H I
$str
””I S
{
””S T
ex
””T V
.
””V W
Message
””W ^
}
””^ _
"
””_ `
;
””` a
result
‘‘ 
.
‘‘ 
Severity
‘‘ 
=
‘‘  ! 
Enum_ErrorSeverity
‘‘" 4
.
‘‘4 5
Error
‘‘5 :
;
‘‘: ;
result
’’ 
.
’’ 
ExecutionTimeMs
’’ &
=
’’' (
	stopwatch
’’) 2
.
’’2 3!
ElapsedMilliseconds
’’3 F
;
’’F G
result
÷÷ 
.
÷÷ 
	Exception
÷÷  
=
÷÷! "
ex
÷÷# %
;
÷÷% &
return
◊◊ 
result
◊◊ 
;
◊◊ 
}
ÿÿ 
}
ŸŸ 	
	stopwatch
€€ 
.
€€ 
Stop
€€ 
(
€€ 
)
€€ 
;
€€ 
result
‹‹ 
.
‹‹ 
Success
‹‹ 
=
‹‹ 
false
‹‹ 
;
‹‹ 
result
›› 
.
›› 
ErrorMessage
›› 
=
›› 
$"
››  
$str
››  2
{
››2 3
procedureName
››3 @
}
››@ A
$str
››A P
{
››P Q

MaxRetries
››Q [
}
››[ \
$str
››\ e
"
››e f
;
››f g
result
ﬁﬁ 
.
ﬁﬁ 
Severity
ﬁﬁ 
=
ﬁﬁ  
Enum_ErrorSeverity
ﬁﬁ ,
.
ﬁﬁ, -
Critical
ﬁﬁ- 5
;
ﬁﬁ5 6
result
ﬂﬂ 
.
ﬂﬂ 
ExecutionTimeMs
ﬂﬂ 
=
ﬂﬂ  
	stopwatch
ﬂﬂ! *
.
ﬂﬂ* +!
ElapsedMilliseconds
ﬂﬂ+ >
;
ﬂﬂ> ?
return
‡‡ 
result
‡‡ 
;
‡‡ 
}
·· 
public
ÊÊ 

static
ÊÊ 
async
ÊÊ 
Task
ÊÊ 
<
ÊÊ 
Model_Dao_Result
ÊÊ -
>
ÊÊ- .'
ExecuteInTransactionAsync
ÊÊ/ H
(
ÊÊH I
MySqlConnection
ÁÁ 

connection
ÁÁ "
,
ÁÁ" #
MySqlTransaction
ËË 
transaction
ËË $
,
ËË$ %
string
ÈÈ 
procedureName
ÈÈ 
,
ÈÈ 

Dictionary
ÍÍ 
<
ÍÍ 
string
ÍÍ 
,
ÍÍ 
object
ÍÍ !
>
ÍÍ! "
?
ÍÍ" #

parameters
ÍÍ$ .
=
ÍÍ/ 0
null
ÍÍ1 5
)
ÍÍ5 6
{
ÎÎ 
var
ÏÏ 
result
ÏÏ 
=
ÏÏ 
new
ÏÏ 
Model_Dao_Result
ÏÏ )
(
ÏÏ) *
)
ÏÏ* +
;
ÏÏ+ ,
var
ÌÌ 
	stopwatch
ÌÌ 
=
ÌÌ 
	Stopwatch
ÌÌ !
.
ÌÌ! "
StartNew
ÌÌ" *
(
ÌÌ* +
)
ÌÌ+ ,
;
ÌÌ, -
try
ÔÔ 
{
 	
using
ÒÒ 
var
ÒÒ 
command
ÒÒ 
=
ÒÒ 
new
ÒÒ  #
MySqlCommand
ÒÒ$ 0
(
ÒÒ0 1
procedureName
ÒÒ1 >
,
ÒÒ> ?

connection
ÒÒ@ J
,
ÒÒJ K
transaction
ÒÒL W
)
ÒÒW X
{
ÚÚ 
CommandType
ÛÛ 
=
ÛÛ 
CommandType
ÛÛ )
.
ÛÛ) *
StoredProcedure
ÛÛ* 9
}
ÙÙ 
;
ÙÙ 
AddParameters
ˆˆ 
(
ˆˆ 
command
ˆˆ !
,
ˆˆ! "

parameters
ˆˆ# -
)
ˆˆ- .
;
ˆˆ. /
var
¯¯ 
affectedRows
¯¯ 
=
¯¯ 
await
¯¯ $
command
¯¯% ,
.
¯¯, -"
ExecuteNonQueryAsync
¯¯- A
(
¯¯A B
)
¯¯B C
;
¯¯C D
	stopwatch
˙˙ 
.
˙˙ 
Stop
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
result
˚˚ 
.
˚˚ 
Success
˚˚ 
=
˚˚ 
true
˚˚ !
;
˚˚! "
result
¸¸ 
.
¸¸ 
AffectedRows
¸¸ 
=
¸¸  !
affectedRows
¸¸" .
;
¸¸. /
result
˝˝ 
.
˝˝ 
ExecutionTimeMs
˝˝ "
=
˝˝# $
	stopwatch
˝˝% .
.
˝˝. /!
ElapsedMilliseconds
˝˝/ B
;
˝˝B C
return
˛˛ 
result
˛˛ 
;
˛˛ 
}
ˇˇ 	
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ 
{
ÅÅ 	
	stopwatch
ÇÇ 
.
ÇÇ 
Stop
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
result
ÉÉ 
.
ÉÉ 
Success
ÉÉ 
=
ÉÉ 
false
ÉÉ "
;
ÉÉ" #
result
ÑÑ 
.
ÑÑ 
ErrorMessage
ÑÑ 
=
ÑÑ  !
$"
ÑÑ" $
$str
ÑÑ$ 6
{
ÑÑ6 7
procedureName
ÑÑ7 D
}
ÑÑD E
$str
ÑÑE ^
{
ÑÑ^ _
ex
ÑÑ_ a
.
ÑÑa b
Message
ÑÑb i
}
ÑÑi j
"
ÑÑj k
;
ÑÑk l
result
ÖÖ 
.
ÖÖ 
Severity
ÖÖ 
=
ÖÖ  
Enum_ErrorSeverity
ÖÖ 0
.
ÖÖ0 1
Error
ÖÖ1 6
;
ÖÖ6 7
result
ÜÜ 
.
ÜÜ 
ExecutionTimeMs
ÜÜ "
=
ÜÜ# $
	stopwatch
ÜÜ% .
.
ÜÜ. /!
ElapsedMilliseconds
ÜÜ/ B
;
ÜÜB C
result
áá 
.
áá 
	Exception
áá 
=
áá 
ex
áá !
;
áá! "
return
àà 
result
àà 
;
àà 
}
ââ 	
}
ää 
private
åå 
static
åå 
void
åå 
AddParameters
åå %
(
åå% &
MySqlCommand
åå& 2
command
åå3 :
,
åå: ;

Dictionary
åå< F
<
ååF G
string
ååG M
,
ååM N
object
ååO U
>
ååU V
?
ååV W

parameters
ååX b
)
ååb c
{
çç 
if
éé 

(
éé 

parameters
éé 
!=
éé 
null
éé 
)
éé 
{
èè 	
foreach
êê 
(
êê 
var
êê 
param
êê 
in
êê !

parameters
êê" ,
)
êê, -
{
ëë 
string
ìì 
	paramName
ìì  
=
ìì! "
param
ìì# (
.
ìì( )
Key
ìì) ,
.
ìì, -

StartsWith
ìì- 7
(
ìì7 8
$str
ìì8 <
)
ìì< =
?
ìì> ?
$str
ìì@ C
+
ììD E
param
ììF K
.
ììK L
Key
ììL O
:
ììP Q
$str
ììR W
+
ììX Y
param
ììZ _
.
ìì_ `
Key
ìì` c
;
ììc d
string
õõ 
	cleanName
õõ  
=
õõ! "
param
õõ# (
.
õõ( )
Key
õõ) ,
.
õõ, -
	TrimStart
õõ- 6
(
õõ6 7
$char
õõ7 :
)
õõ: ;
;
õõ; <
string
úú 
	finalName
úú  
=
úú! "
	cleanName
úú# ,
.
úú, -

StartsWith
úú- 7
(
úú7 8
$str
úú8 <
)
úú< =
?
úú> ?
$str
úú@ C
+
úúD E
	cleanName
úúF O
:
úúP Q
$str
úúR W
+
úúX Y
	cleanName
úúZ c
;
úúc d
command
ûû 
.
ûû 

Parameters
ûû "
.
ûû" #
AddWithValue
ûû# /
(
ûû/ 0
	finalName
ûû0 9
,
ûû9 :
param
ûû; @
.
ûû@ A
Value
ûûA F
??
ûûG I
DBNull
ûûJ P
.
ûûP Q
Value
ûûQ V
)
ûûV W
;
ûûW X
}
üü 
}
†† 	
}
°° 
private
¶¶ 
static
¶¶ 
bool
¶¶ 
IsTransientError
¶¶ (
(
¶¶( )
MySqlException
¶¶) 7
ex
¶¶8 :
)
¶¶: ;
{
ßß 
return
≠≠ 
ex
≠≠ 
.
≠≠ 
Number
≠≠ 
==
≠≠ 
$num
≠≠  
||
≠≠! #
ex
≠≠$ &
.
≠≠& '
Number
≠≠' -
==
≠≠. 0
$num
≠≠1 5
||
≠≠6 8
ex
ÆÆ 
.
ÆÆ 
Number
ÆÆ 
==
ÆÆ 
$num
ÆÆ  
||
ÆÆ! #
ex
ÆÆ$ &
.
ÆÆ& '
Number
ÆÆ' -
==
ÆÆ. 0
$num
ÆÆ1 5
;
ÆÆ5 6
}
ØØ 
}∞∞ •m
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Data\InforVisual\Dao_InforVisualPart.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Data$ (
.( )
InforVisual) 4
;4 5
public

 
class

 
Dao_InforVisualPart

  
{ 
private 
readonly 
string 
_connectionString -
;- .
public 

Dao_InforVisualPart 
( 
string %'
inforVisualConnectionString& A
)A B
{ &
ValidateReadOnlyConnection "
(" #'
inforVisualConnectionString# >
)> ?
;? @
_connectionString 
= '
inforVisualConnectionString 7
;7 8
} 
private 
static 
void &
ValidateReadOnlyConnection 2
(2 3
string3 9
connectionString: J
)J K
{ 
if 

( 
string 
. 
IsNullOrWhiteSpace %
(% &
connectionString& 6
)6 7
)7 8
throw 
new !
ArgumentNullException +
(+ ,
nameof, 2
(2 3
connectionString3 C
)C D
)D E
;E F
try 
{ 	
var 
builder 
= 
new &
SqlConnectionStringBuilder 8
(8 9
connectionString9 I
)I J
;J K
if 
( 
builder 
. 
ApplicationIntent )
!=* ,
ApplicationIntent- >
.> ?
ReadOnly? G
)G H
{ 
throw 
new %
InvalidOperationException 3
(3 4
$"   
$str   f
"  f g
+  h i
$"!! 
$str!! 1
{!!1 2
builder!!2 9
.!!9 :
ApplicationIntent!!: K
}!!K L
$str!!L N
"!!N O
+!!P Q
$""" 
$str"" S
"""S T
+""U V
$str## R
)##R S
;##S T
}$$ 
}%% 	
catch&& 
(&& 
ArgumentException&&  
ex&&! #
)&&# $
{'' 	
throw(( 
new(( %
InvalidOperationException(( /
(((/ 0
$")) 
$str)) A
{))A B
ex))B D
.))D E
Message))E L
}))L M
"))M N
,))N O
ex))P R
)))R S
;))S T
}** 	
}++ 
public-- 

async-- 
Task-- 
<-- 
Model_Dao_Result-- &
<--& '!
Model_InforVisualPart--' <
>--< =
>--= > 
GetByPartNumberAsync--? S
(--S T
string--T Z

partNumber--[ e
)--e f
{.. 
try// 
{00 	
using11 
var11 

connection11  
=11! "
new11# &
SqlConnection11' 4
(114 5
_connectionString115 F
)11F G
;11G H
await22 

connection22 
.22 
	OpenAsync22 &
(22& '
)22' (
;22( )
var44 
query44 
=44 
$str4C .
;CC. /
usingEE 
varEE 
commandEE 
=EE 
newEE  #

SqlCommandEE$ .
(EE. /
queryEE/ 4
,EE4 5

connectionEE6 @
)EE@ A
;EEA B
commandFF 
.FF 

ParametersFF 
.FF 
AddWithValueFF +
(FF+ ,
$strFF, 9
,FF9 :

partNumberFF; E
)FFE F
;FFF G
usingHH 
varHH 
readerHH 
=HH 
awaitHH $
commandHH% ,
.HH, -
ExecuteReaderAsyncHH- ?
(HH? @
)HH@ A
;HHA B
ifII 
(II 
awaitII 
readerII 
.II 
	ReadAsyncII &
(II& '
)II' (
)II( )
{JJ 
varKK 
partKK 
=KK 
newKK !
Model_InforVisualPartKK 4
{LL 

PartNumberMM 
=MM  
readerMM! '
[MM' (
$strMM( 4
]MM4 5
.MM5 6
ToStringMM6 >
(MM> ?
)MM? @
??MMA C
stringMMD J
.MMJ K
EmptyMMK P
,MMP Q
DescriptionNN 
=NN  !
readerNN" (
[NN( )
$strNN) 6
]NN6 7
.NN7 8
ToStringNN8 @
(NN@ A
)NNA B
??NNC E
stringNNF L
.NNL M
EmptyNNM R
,NNR S
PartTypeOO 
=OO 
readerOO %
[OO% &
$strOO& 0
]OO0 1
.OO1 2
ToStringOO2 :
(OO: ;
)OO; <
??OO= ?
stringOO@ F
.OOF G
EmptyOOG L
,OOL M
UnitCostPP 
=PP 
ConvertPP &
.PP& '
	ToDecimalPP' 0
(PP0 1
readerPP1 7
[PP7 8
$strPP8 B
]PPB C
)PPC D
,PPD E

PrimaryUomQQ 
=QQ  
readerQQ! '
[QQ' (
$strQQ( 4
]QQ4 5
.QQ5 6
ToStringQQ6 >
(QQ> ?
)QQ? @
??QQA C
$strQQD H
,QQH I
	OnHandQtyRR 
=RR 
ConvertRR  '
.RR' (
	ToDecimalRR( 1
(RR1 2
readerRR2 8
[RR8 9
$strRR9 D
]RRD E
)RRE F
,RRF G
AllocatedQtySS  
=SS! "
ConvertSS# *
.SS* +
	ToDecimalSS+ 4
(SS4 5
readerSS5 ;
[SS; <
$strSS< J
]SSJ K
)SSK L
,SSL M
AvailableQtyTT  
=TT! "
ConvertTT# *
.TT* +
	ToDecimalTT+ 4
(TT4 5
readerTT5 ;
[TT; <
$strTT< J
]TTJ K
)TTK L
,TTL M
DefaultSiteUU 
=UU  !
readerUU" (
[UU( )
$strUU) 6
]UU6 7
.UU7 8
ToStringUU8 @
(UU@ A
)UUA B
??UUC E
$strUUF K
,UUK L

PartStatusVV 
=VV  
readerVV! '
[VV' (
$strVV( 4
]VV4 5
.VV5 6
ToStringVV6 >
(VV> ?
)VV? @
??VVA C
$strVVD L
,VVL M
ProductLineWW 
=WW  !
readerWW" (
[WW( )
$strWW) 6
]WW6 7
.WW7 8
ToStringWW8 @
(WW@ A
)WWA B
??WWC E
stringWWF L
.WWL M
EmptyWWM R
}XX 
;XX 
returnYY $
Model_Dao_Result_FactoryYY /
.YY/ 0
SuccessYY0 7
(YY7 8
partYY8 <
)YY< =
;YY= >
}ZZ 
return\\ $
Model_Dao_Result_Factory\\ +
.\\+ ,
Failure\\, 3
<\\3 4!
Model_InforVisualPart\\4 I
>\\I J
(\\J K
$str\\K [
)\\[ \
;\\\ ]
}]] 	
catch^^ 
(^^ 
	Exception^^ 
ex^^ 
)^^ 
{__ 	
return`` $
Model_Dao_Result_Factory`` +
.``+ ,
Failure``, 3
<``3 4!
Model_InforVisualPart``4 I
>``I J
(``J K
$"aa 
$straa (
{aa( )

partNumberaa) 3
}aa3 4
$straa4 6
{aa6 7
exaa7 9
.aa9 :
Messageaa: A
}aaA B
"aaB C
,aaC D
exbb 
)bb 
;bb 
}cc 	
}dd 
publicff 

asyncff 
Taskff 
<ff 
Model_Dao_Resultff &
<ff& '
Listff' +
<ff+ ,!
Model_InforVisualPartff, A
>ffA B
>ffB C
>ffC D)
SearchPartsByDescriptionAsyncffE b
(ffb c
stringgg 

searchTermgg 
,gg 
inthh 

maxResultshh 
=hh 
$numhh 
)hh 
{ii 
tryjj 
{kk 	
usingll 
varll 

connectionll  
=ll! "
newll# &
SqlConnectionll' 4
(ll4 5
_connectionStringll5 F
)llF G
;llG H
awaitmm 

connectionmm 
.mm 
	OpenAsyncmm &
(mm& '
)mm' (
;mm( )
varoo 
queryoo 
=oo 
$stro #
;# $
using
ÅÅ 
var
ÅÅ 
command
ÅÅ 
=
ÅÅ 
new
ÅÅ  #

SqlCommand
ÅÅ$ .
(
ÅÅ. /
query
ÅÅ/ 4
,
ÅÅ4 5

connection
ÅÅ6 @
)
ÅÅ@ A
;
ÅÅA B
command
ÇÇ 
.
ÇÇ 

Parameters
ÇÇ 
.
ÇÇ 
AddWithValue
ÇÇ +
(
ÇÇ+ ,
$str
ÇÇ, 9
,
ÇÇ9 :

searchTerm
ÇÇ; E
)
ÇÇE F
;
ÇÇF G
command
ÉÉ 
.
ÉÉ 

Parameters
ÉÉ 
.
ÉÉ 
AddWithValue
ÉÉ +
(
ÉÉ+ ,
$str
ÉÉ, 9
,
ÉÉ9 :

maxResults
ÉÉ; E
)
ÉÉE F
;
ÉÉF G
var
ÖÖ 
list
ÖÖ 
=
ÖÖ 
new
ÖÖ 
List
ÖÖ 
<
ÖÖ  #
Model_InforVisualPart
ÖÖ  5
>
ÖÖ5 6
(
ÖÖ6 7
)
ÖÖ7 8
;
ÖÖ8 9
using
ÜÜ 
var
ÜÜ 
reader
ÜÜ 
=
ÜÜ 
await
ÜÜ $
command
ÜÜ% ,
.
ÜÜ, - 
ExecuteReaderAsync
ÜÜ- ?
(
ÜÜ? @
)
ÜÜ@ A
;
ÜÜA B
while
áá 
(
áá 
await
áá 
reader
áá 
.
áá  
	ReadAsync
áá  )
(
áá) *
)
áá* +
)
áá+ ,
{
àà 
list
ââ 
.
ââ 
Add
ââ 
(
ââ 
new
ââ #
Model_InforVisualPart
ââ 2
{
ää 

PartNumber
ãã 
=
ãã  
reader
ãã! '
[
ãã' (
$str
ãã( 4
]
ãã4 5
.
ãã5 6
ToString
ãã6 >
(
ãã> ?
)
ãã? @
??
ããA C
string
ããD J
.
ããJ K
Empty
ããK P
,
ããP Q
Description
åå 
=
åå  !
reader
åå" (
[
åå( )
$str
åå) 6
]
åå6 7
.
åå7 8
ToString
åå8 @
(
åå@ A
)
ååA B
??
ååC E
string
ååF L
.
ååL M
Empty
ååM R
,
ååR S
PartType
çç 
=
çç 
reader
çç %
[
çç% &
$str
çç& 0
]
çç0 1
.
çç1 2
ToString
çç2 :
(
çç: ;
)
çç; <
??
çç= ?
string
çç@ F
.
ççF G
Empty
ççG L
,
ççL M
UnitCost
éé 
=
éé 
Convert
éé &
.
éé& '
	ToDecimal
éé' 0
(
éé0 1
reader
éé1 7
[
éé7 8
$str
éé8 B
]
ééB C
)
ééC D
,
ééD E

PrimaryUom
èè 
=
èè  
reader
èè! '
[
èè' (
$str
èè( 4
]
èè4 5
.
èè5 6
ToString
èè6 >
(
èè> ?
)
èè? @
??
èèA C
$str
èèD H
,
èèH I
	OnHandQty
êê 
=
êê 
Convert
êê  '
.
êê' (
	ToDecimal
êê( 1
(
êê1 2
reader
êê2 8
[
êê8 9
$str
êê9 D
]
êêD E
)
êêE F
,
êêF G
AllocatedQty
ëë  
=
ëë! "
Convert
ëë# *
.
ëë* +
	ToDecimal
ëë+ 4
(
ëë4 5
reader
ëë5 ;
[
ëë; <
$str
ëë< J
]
ëëJ K
)
ëëK L
,
ëëL M
AvailableQty
íí  
=
íí! "
Convert
íí# *
.
íí* +
	ToDecimal
íí+ 4
(
íí4 5
reader
íí5 ;
[
íí; <
$str
íí< J
]
ííJ K
)
ííK L
,
ííL M
DefaultSite
ìì 
=
ìì  !
reader
ìì" (
[
ìì( )
$str
ìì) 6
]
ìì6 7
.
ìì7 8
ToString
ìì8 @
(
ìì@ A
)
ììA B
??
ììC E
$str
ììF K
,
ììK L

PartStatus
îî 
=
îî  
reader
îî! '
[
îî' (
$str
îî( 4
]
îî4 5
.
îî5 6
ToString
îî6 >
(
îî> ?
)
îî? @
??
îîA C
$str
îîD L
,
îîL M
ProductLine
ïï 
=
ïï  !
reader
ïï" (
[
ïï( )
$str
ïï) 6
]
ïï6 7
.
ïï7 8
ToString
ïï8 @
(
ïï@ A
)
ïïA B
??
ïïC E
string
ïïF L
.
ïïL M
Empty
ïïM R
}
ññ 
)
ññ 
;
ññ 
}
óó 
return
ôô &
Model_Dao_Result_Factory
ôô +
.
ôô+ ,
Success
ôô, 3
(
ôô3 4
list
ôô4 8
)
ôô8 9
;
ôô9 :
}
öö 	
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ 
{
úú 	
return
ùù &
Model_Dao_Result_Factory
ùù +
.
ùù+ ,
Failure
ùù, 3
<
ùù3 4
List
ùù4 8
<
ùù8 9#
Model_InforVisualPart
ùù9 N
>
ùùN O
>
ùùO P
(
ùùP Q
$"
ûû 
$str
ûû )
{
ûû) *
ex
ûû* ,
.
ûû, -
Message
ûû- 4
}
ûû4 5
"
ûû5 6
,
ûû6 7
ex
üü 
)
üü 
;
üü 
}
†† 	
}
°° 
}¢¢ úg
UC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Dunnage\Dao_DunnageType.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Data$ (
.( )
Dunnage) 0
;0 1
public 
class 
Dao_DunnageType 
{ 
private 
readonly 
string 
_connectionString -
;- .
public 

Dao_DunnageType 
( 
string !
connectionString" 2
)2 3
{ 
_connectionString 
= 
connectionString ,
;, -
} 
public 

virtual 
async 
Task 
< 
Model_Dao_Result .
<. /
List/ 3
<3 4
Model_DunnageType4 E
>E F
>F G
>G H
GetAllAsyncI T
(T U
)U V
{ 
Console 
. 
	WriteLine 
( 
$" 
$str @
"@ A
)A B
;B C
Console 
. 
	WriteLine 
( 
$" 
$str A
{A B
_connectionStringB S
}S T
"T U
)U V
;V W
var 
result 
= 
await +
Helper_Database_StoredProcedure :
.: ;
ExecuteListAsync; K
<K L
Model_DunnageTypeL ]
>] ^
(^ _
_connectionString 
, 
$str &
,& '
MapFromReader 
) 	
;	 

Console!! 
.!! 
	WriteLine!! 
(!! 
$"!! 
$str!! B
{!!B C
result!!C I
.!!I J
	IsSuccess!!J S
}!!S T
$str!!T b
{!!b c
result!!c i
.!!i j
Data!!j n
?!!n o
.!!o p
Count!!p u
??!!v x
$num!!y z
}!!z {
$str	!!{ Ñ
{
!!Ñ Ö
result
!!Ö ã
.
!!ã å
ErrorMessage
!!å ò
}
!!ò ô
"
!!ô ö
)
!!ö õ
;
!!õ ú
return## 
result## 
;## 
}$$ 
public&& 

virtual&& 
async&& 
Task&& 
<&& 
Model_Dao_Result&& .
<&&. /
Model_DunnageType&&/ @
>&&@ A
>&&A B
GetByIdAsync&&C O
(&&O P
int&&P S
id&&T V
)&&V W
{'' 
var(( 

parameters(( 
=(( 
new(( 

Dictionary(( '
<((' (
string((( .
,((. /
object((0 6
>((6 7
{)) 	
{** 
$str** 
,** 
id** 
}** 
}++ 	
;++	 

return-- 
await-- +
Helper_Database_StoredProcedure-- 4
.--4 5
ExecuteSingleAsync--5 G
<--G H
Model_DunnageType--H Y
>--Y Z
(--Z [
_connectionString.. 
,.. 
$str// (
,//( )
MapFromReader00 
,00 

parameters11 
)22 	
;22	 

}33 
public55 

virtual55 
async55 
Task55 
<55 
Model_Dao_Result55 .
<55. /
int55/ 2
>552 3
>553 4
InsertAsync555 @
(55@ A
string55A G
typeName55H P
,55P Q
string55R X
user55Y ]
)55] ^
{66 
var77 
pNewId77 
=77 
new77 
MySqlParameter77 '
(77' (
$str77( 3
,773 4
MySqlDbType775 @
.77@ A
Int3277A F
)77F G
{88 	
	Direction99 
=99 
ParameterDirection99 *
.99* +
Output99+ 1
}:: 	
;::	 

var<< 

parameters<< 
=<< 
new<< 
MySqlParameter<< +
[<<+ ,
]<<, -
{== 	
new>> 
MySqlParameter>> 
(>> 
$str>> -
,>>- .
typeName>>/ 7
)>>7 8
,>>8 9
new?? 
MySqlParameter?? 
(?? 
$str?? (
,??( )
user??* .
)??. /
,??/ 0
pNewId@@ 
}AA 	
;AA	 

varCC 
resultCC 
=CC 
awaitCC +
Helper_Database_StoredProcedureCC :
.CC: ;
ExecuteAsyncCC; G
(CCG H
$strDD %
,DD% &

parametersEE 
,EE 
_connectionStringFF 
)GG 	
;GG	 

ifII 

(II 
resultII 
.II 
	IsSuccessII 
)II 
{JJ 	
ifKK 
(KK 
pNewIdKK 
.KK 
ValueKK 
!=KK 
nullKK  $
&&KK% '
pNewIdKK( .
.KK. /
ValueKK/ 4
!=KK5 7
DBNullKK8 >
.KK> ?
ValueKK? D
)KKD E
{LL 
returnMM $
Model_Dao_Result_FactoryMM /
.MM/ 0
SuccessMM0 7
<MM7 8
intMM8 ;
>MM; <
(MM< =
ConvertMM= D
.MMD E
ToInt32MME L
(MML M
pNewIdMMM S
.MMS T
ValueMMT Y
)MMY Z
)MMZ [
;MM[ \
}NN 
returnOO $
Model_Dao_Result_FactoryOO +
.OO+ ,
FailureOO, 3
<OO3 4
intOO4 7
>OO7 8
(OO8 9
$strOO9 T
)OOT U
;OOU V
}PP 	
returnRR $
Model_Dao_Result_FactoryRR '
.RR' (
FailureRR( /
<RR/ 0
intRR0 3
>RR3 4
(RR4 5
resultRR5 ;
.RR; <
ErrorMessageRR< H
,RRH I
resultRRJ P
.RRP Q
	ExceptionRRQ Z
)RRZ [
;RR[ \
}SS 
publicUU 

virtualUU 
asyncUU 
TaskUU 
<UU 
Model_Dao_ResultUU .
>UU. /
UpdateAsyncUU0 ;
(UU; <
intUU< ?
idUU@ B
,UUB C
stringUUD J
typeNameUUK S
,UUS T
stringUUU [
userUU\ `
)UU` a
{VV 
varWW 

parametersWW 
=WW 
newWW 

DictionaryWW '
<WW' (
stringWW( .
,WW. /
objectWW0 6
>WW6 7
{XX 	
{YY 
$strYY 
,YY 
idYY 
}YY 
,YY 
{ZZ 
$strZZ 
,ZZ 
typeNameZZ #
}ZZ$ %
,ZZ% &
{[[ 
$str[[ 
,[[ 
user[[ 
}[[ 
}\\ 	
;\\	 

return^^ 
await^^ +
Helper_Database_StoredProcedure^^ 4
.^^4 5 
ExecuteNonQueryAsync^^5 I
(^^I J
_connectionString__ 
,__ 
$str`` %
,``% &

parametersaa 
)bb 	
;bb	 

}cc 
publicee 

virtualee 
asyncee 
Taskee 
<ee 
Model_Dao_Resultee .
>ee. /
DeleteAsyncee0 ;
(ee; <
intee< ?
idee@ B
)eeB C
{ff 
vargg 

parametersgg 
=gg 
newgg 

Dictionarygg '
<gg' (
stringgg( .
,gg. /
objectgg0 6
>gg6 7
{hh 	
{ii 
$strii 
,ii 
idii 
}ii 
}jj 	
;jj	 

returnll 
awaitll +
Helper_Database_StoredProcedurell 4
.ll4 5 
ExecuteNonQueryAsyncll5 I
(llI J
_connectionStringmm 
,mm 
$strnn %
,nn% &

parametersoo 
)pp 	
;pp	 

}qq 
publicss 

virtualss 
asyncss 
Taskss 
<ss 
Model_Dao_Resultss .
<ss. /
intss/ 2
>ss2 3
>ss3 4
CountPartsAsyncss5 D
(ssD E
intssE H
typeIdssI O
)ssO P
{tt 
varuu 

parametersuu 
=uu 
newuu 

Dictionaryuu '
<uu' (
stringuu( .
,uu. /
objectuu0 6
>uu6 7
{vv 	
{ww 
$strww 
,ww 
typeIdww 
}ww  !
}xx 	
;xx	 

returnzz 
awaitzz +
Helper_Database_StoredProcedurezz 4
.zz4 5
ExecuteSingleAsynczz5 G
<zzG H
intzzH K
>zzK L
(zzL M
_connectionString{{ 
,{{ 
$str|| *
,||* +
reader}} 
=>}} 
reader}} 
.}} 
GetInt32}} %
(}}% &
reader}}& ,
.}}, -

GetOrdinal}}- 7
(}}7 8
$str}}8 D
)}}D E
)}}E F
,}}F G

parameters~~ 
) 	
;	 

}
ÄÄ 
public
ÇÇ 

virtual
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
<
ÇÇ 
Model_Dao_Result
ÇÇ .
<
ÇÇ. /
int
ÇÇ/ 2
>
ÇÇ2 3
>
ÇÇ3 4$
CountTransactionsAsync
ÇÇ5 K
(
ÇÇK L
int
ÇÇL O
typeId
ÇÇP V
)
ÇÇV W
{
ÉÉ 
var
ÑÑ 

parameters
ÑÑ 
=
ÑÑ 
new
ÑÑ 

Dictionary
ÑÑ '
<
ÑÑ' (
string
ÑÑ( .
,
ÑÑ. /
object
ÑÑ0 6
>
ÑÑ6 7
{
ÖÖ 	
{
ÜÜ 
$str
ÜÜ 
,
ÜÜ 
typeId
ÜÜ 
}
ÜÜ  !
}
áá 	
;
áá	 

return
ââ 
await
ââ -
Helper_Database_StoredProcedure
ââ 4
.
ââ4 5 
ExecuteSingleAsync
ââ5 G
<
ââG H
int
ââH K
>
ââK L
(
ââL M
_connectionString
ää 
,
ää 
$str
ãã 1
,
ãã1 2
reader
åå 
=>
åå 
reader
åå 
.
åå 
GetInt32
åå %
(
åå% &
reader
åå& ,
.
åå, -

GetOrdinal
åå- 7
(
åå7 8
$str
åå8 K
)
ååK L
)
ååL M
,
ååM N

parameters
çç 
)
éé 	
;
éé	 

}
èè 
private
ëë 
Model_DunnageType
ëë 
MapFromReader
ëë +
(
ëë+ ,
IDataReader
ëë, 7
reader
ëë8 >
)
ëë> ?
{
íí 
return
ìì 
new
ìì 
Model_DunnageType
ìì $
{
îî 	
Id
ïï 
=
ïï 
reader
ïï 
.
ïï 
GetInt32
ïï  
(
ïï  !
reader
ïï! '
.
ïï' (

GetOrdinal
ïï( 2
(
ïï2 3
$str
ïï3 7
)
ïï7 8
)
ïï8 9
,
ïï9 :
TypeName
ññ 
=
ññ 
reader
ññ 
.
ññ 
	GetString
ññ '
(
ññ' (
reader
ññ( .
.
ññ. /

GetOrdinal
ññ/ 9
(
ññ9 :
$str
ññ: E
)
ññE F
)
ññF G
,
ññG H
	CreatedBy
óó 
=
óó 
reader
óó 
.
óó 
	GetString
óó (
(
óó( )
reader
óó) /
.
óó/ 0

GetOrdinal
óó0 :
(
óó: ;
$str
óó; G
)
óóG H
)
óóH I
,
óóI J
CreatedDate
òò 
=
òò 
reader
òò  
.
òò  !
GetDateTime
òò! ,
(
òò, -
reader
òò- 3
.
òò3 4

GetOrdinal
òò4 >
(
òò> ?
$str
òò? M
)
òòM N
)
òòN O
,
òòO P

ModifiedBy
ôô 
=
ôô 
reader
ôô 
.
ôô  
IsDBNull
ôô  (
(
ôô( )
reader
ôô) /
.
ôô/ 0

GetOrdinal
ôô0 :
(
ôô: ;
$str
ôô; H
)
ôôH I
)
ôôI J
?
ôôK L
null
ôôM Q
:
ôôR S
reader
ôôT Z
.
ôôZ [
	GetString
ôô[ d
(
ôôd e
reader
ôôe k
.
ôôk l

GetOrdinal
ôôl v
(
ôôv w
$strôôw Ñ
)ôôÑ Ö
)ôôÖ Ü
,ôôÜ á
ModifiedDate
öö 
=
öö 
reader
öö !
.
öö! "
IsDBNull
öö" *
(
öö* +
reader
öö+ 1
.
öö1 2

GetOrdinal
öö2 <
(
öö< =
$str
öö= L
)
ööL M
)
ööM N
?
ööO P
null
ööQ U
:
ööV W
reader
ööX ^
.
öö^ _
GetDateTime
öö_ j
(
ööj k
reader
öök q
.
ööq r

GetOrdinal
öör |
(
öö| }
$ströö} å
)ööå ç
)ööç é
}
õõ 	
;
õõ	 

}
úú 
}ùù ™p
UC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Dunnage\Dao_DunnageSpec.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Data$ (
.( )
Dunnage) 0
;0 1
public 
class 
Dao_DunnageSpec 
{ 
private 
readonly 
string 
_connectionString -
;- .
public 

Dao_DunnageSpec 
( 
string !
connectionString" 2
)2 3
{ 
_connectionString 
= 
connectionString ,
;, -
} 
public 

virtual 
async 
Task 
< 
Model_Dao_Result .
<. /
List/ 3
<3 4
Model_DunnageSpec4 E
>E F
>F G
>G H
GetByTypeAsyncI W
(W X
intX [
typeId\ b
)b c
{ 
var 

parameters 
= 
new 

Dictionary '
<' (
string( .
,. /
object0 6
>6 7
{ 	
{ 
$str 
, 
typeId 
}  !
} 	
;	 

return 
await +
Helper_Database_StoredProcedure 4
.4 5
ExecuteListAsync5 E
<E F
Model_DunnageSpecF W
>W X
(X Y
_connectionString 
, 
$str *
,* +
MapFromReader   
,   

parameters!! 
)"" 	
;""	 

}## 
public%% 

virtual%% 
async%% 
Task%% 
<%% 
Model_Dao_Result%% .
<%%. /
List%%/ 3
<%%3 4
Model_DunnageSpec%%4 E
>%%E F
>%%F G
>%%G H
GetAllAsync%%I T
(%%T U
)%%U V
{&& 
return'' 
await'' +
Helper_Database_StoredProcedure'' 4
.''4 5
ExecuteListAsync''5 E
<''E F
Model_DunnageSpec''F W
>''W X
(''X Y
_connectionString(( 
,(( 
$str)) &
,))& '
MapFromReader** 
)++ 	
;++	 

},, 
public.. 

virtual.. 
async.. 
Task.. 
<.. 
Model_Dao_Result.. .
<... /
Model_DunnageSpec../ @
>..@ A
>..A B
GetByIdAsync..C O
(..O P
int..P S
id..T V
)..V W
{// 
var00 

parameters00 
=00 
new00 

Dictionary00 '
<00' (
string00( .
,00. /
object000 6
>006 7
{11 	
{22 
$str22 
,22 
id22 
}22 
}33 	
;33	 

return55 
await55 +
Helper_Database_StoredProcedure55 4
.554 5
ExecuteSingleAsync555 G
<55G H
Model_DunnageSpec55H Y
>55Y Z
(55Z [
_connectionString66 
,66 
$str77 (
,77( )
MapFromReader88 
,88 

parameters99 
):: 	
;::	 

};; 
public== 

virtual== 
async== 
Task== 
<== 
Model_Dao_Result== .
<==. /
int==/ 2
>==2 3
>==3 4
InsertAsync==5 @
(==@ A
int==A D
typeId==E K
,==K L
string==M S
specKey==T [
,==[ \
string==] c
	specValue==d m
,==m n
string==o u
user==v z
)==z {
{>> 
var?? 
pNewId?? 
=?? 
new?? 
MySqlParameter?? '
(??' (
$str??( 3
,??3 4
MySqlDbType??5 @
.??@ A
Int32??A F
)??F G
{@@ 	
	DirectionAA 
=AA 
ParameterDirectionAA *
.AA* +
OutputAA+ 1
}BB 	
;BB	 

varDD 

parametersDD 
=DD 
newDD 
MySqlParameterDD +
[DD+ ,
]DD, -
{EE 	
newFF 
MySqlParameterFF 
(FF 
$strFF +
,FF+ ,
typeIdFF- 3
)FF3 4
,FF4 5
newGG 
MySqlParameterGG 
(GG 
$strGG ,
,GG, -
specKeyGG. 5
)GG5 6
,GG6 7
newHH 
MySqlParameterHH 
(HH 
$strHH .
,HH. /
	specValueHH0 9
)HH9 :
,HH: ;
newII 
MySqlParameterII 
(II 
$strII (
,II( )
userII* .
)II. /
,II/ 0
pNewIdJJ 
}KK 	
;KK	 

varMM 
resultMM 
=MM 
awaitMM +
Helper_Database_StoredProcedureMM :
.MM: ;
ExecuteAsyncMM; G
(MMG H
$strNN %
,NN% &

parametersOO 
,OO 
_connectionStringPP 
)QQ 	
;QQ	 

ifSS 

(SS 
resultSS 
.SS 
	IsSuccessSS 
)SS 
{TT 	
ifUU 
(UU 
pNewIdUU 
.UU 
ValueUU 
!=UU 
nullUU  $
&&UU% '
pNewIdUU( .
.UU. /
ValueUU/ 4
!=UU5 7
DBNullUU8 >
.UU> ?
ValueUU? D
)UUD E
{VV 
returnWW $
Model_Dao_Result_FactoryWW /
.WW/ 0
SuccessWW0 7
<WW7 8
intWW8 ;
>WW; <
(WW< =
ConvertWW= D
.WWD E
ToInt32WWE L
(WWL M
pNewIdWWM S
.WWS T
ValueWWT Y
)WWY Z
)WWZ [
;WW[ \
}XX 
returnYY $
Model_Dao_Result_FactoryYY +
.YY+ ,
FailureYY, 3
<YY3 4
intYY4 7
>YY7 8
(YY8 9
$strYY9 T
)YYT U
;YYU V
}ZZ 	
return\\ $
Model_Dao_Result_Factory\\ '
.\\' (
Failure\\( /
<\\/ 0
int\\0 3
>\\3 4
(\\4 5
result\\5 ;
.\\; <
ErrorMessage\\< H
,\\H I
result\\J P
.\\P Q
	Exception\\Q Z
)\\Z [
;\\[ \
}]] 
public__ 

virtual__ 
async__ 
Task__ 
<__ 
Model_Dao_Result__ .
>__. /
UpdateAsync__0 ;
(__; <
int__< ?
id__@ B
,__B C
string__D J
	specValue__K T
,__T U
string__V \
user__] a
)__a b
{`` 
varaa 

parametersaa 
=aa 
newaa 

Dictionaryaa '
<aa' (
stringaa( .
,aa. /
objectaa0 6
>aa6 7
{bb 	
{cc 
$strcc 
,cc 
idcc 
}cc 
,cc 
{dd 
$strdd 
,dd 
	specValuedd %
}dd& '
,dd' (
{ee 
$stree 
,ee 
useree 
}ee 
}ff 	
;ff	 

returnhh 
awaithh +
Helper_Database_StoredProcedurehh 4
.hh4 5 
ExecuteNonQueryAsynchh5 I
(hhI J
_connectionStringii 
,ii 
$strjj %
,jj% &

parameterskk 
)ll 	
;ll	 

}mm 
publicoo 

virtualoo 
asyncoo 
Taskoo 
<oo 
Model_Dao_Resultoo .
>oo. /
DeleteByIdAsyncoo0 ?
(oo? @
intoo@ C
idooD F
)ooF G
{pp 
varqq 

parametersqq 
=qq 
newqq 

Dictionaryqq '
<qq' (
stringqq( .
,qq. /
objectqq0 6
>qq6 7
{rr 	
{ss 
$strss 
,ss 
idss 
}ss 
}tt 	
;tt	 

returnvv 
awaitvv +
Helper_Database_StoredProcedurevv 4
.vv4 5 
ExecuteNonQueryAsyncvv5 I
(vvI J
_connectionStringww 
,ww 
$strxx +
,xx+ ,

parametersyy 
)zz 	
;zz	 

}{{ 
public}} 

virtual}} 
async}} 
Task}} 
<}} 
Model_Dao_Result}} .
>}}. /
DeleteByTypeAsync}}0 A
(}}A B
int}}B E
typeId}}F L
)}}L M
{~~ 
var 

parameters 
= 
new 

Dictionary '
<' (
string( .
,. /
object0 6
>6 7
{
ÄÄ 	
{
ÅÅ 
$str
ÅÅ 
,
ÅÅ 
typeId
ÅÅ 
}
ÅÅ  !
}
ÇÇ 	
;
ÇÇ	 

return
ÑÑ 
await
ÑÑ -
Helper_Database_StoredProcedure
ÑÑ 4
.
ÑÑ4 5"
ExecuteNonQueryAsync
ÑÑ5 I
(
ÑÑI J
_connectionString
ÖÖ 
,
ÖÖ 
$str
ÜÜ -
,
ÜÜ- .

parameters
áá 
)
àà 	
;
àà	 

}
ââ 
public
ãã 

virtual
ãã 
async
ãã 
Task
ãã 
<
ãã 
Model_Dao_Result
ãã .
<
ãã. /
int
ãã/ 2
>
ãã2 3
>
ãã3 4&
CountPartsUsingSpecAsync
ãã5 M
(
ããM N
int
ããN Q
typeId
ããR X
,
ããX Y
string
ããZ `
specKey
ããa h
)
ããh i
{
åå 
var
çç 

parameters
çç 
=
çç 
new
çç 

Dictionary
çç '
<
çç' (
string
çç( .
,
çç. /
object
çç0 6
>
çç6 7
{
éé 	
{
èè 
$str
èè 
,
èè 
typeId
èè 
}
èè  !
,
èè! "
{
êê 
$str
êê 
,
êê 
specKey
êê !
}
êê" #
}
ëë 	
;
ëë	 

return
ìì 
await
ìì -
Helper_Database_StoredProcedure
ìì 4
.
ìì4 5 
ExecuteSingleAsync
ìì5 G
<
ììG H
int
ììH K
>
ììK L
(
ììL M
_connectionString
îî 
,
îî 
$str
ïï 5
,
ïï5 6
reader
ññ 
=>
ññ 
reader
ññ 
.
ññ 
GetInt32
ññ %
(
ññ% &
reader
ññ& ,
.
ññ, -

GetOrdinal
ññ- 7
(
ññ7 8
$str
ññ8 D
)
ññD E
)
ññE F
,
ññF G

parameters
óó 
)
òò 	
;
òò	 

}
ôô 
private
õõ 
Model_DunnageSpec
õõ 
MapFromReader
õõ +
(
õõ+ ,
IDataReader
õõ, 7
reader
õõ8 >
)
õõ> ?
{
úú 
return
ùù 
new
ùù 
Model_DunnageSpec
ùù $
{
ûû 	
Id
üü 
=
üü 
reader
üü 
.
üü 
GetInt32
üü  
(
üü  !
reader
üü! '
.
üü' (

GetOrdinal
üü( 2
(
üü2 3
$str
üü3 7
)
üü7 8
)
üü8 9
,
üü9 :
TypeId
†† 
=
†† 
reader
†† 
.
†† 
GetInt32
†† $
(
††$ %
reader
††% +
.
††+ ,

GetOrdinal
††, 6
(
††6 7
$str
††7 @
)
††@ A
)
††A B
,
††B C
SpecKey
°° 
=
°° 
reader
°° 
.
°° 
	GetString
°° &
(
°°& '
reader
°°' -
.
°°- .

GetOrdinal
°°. 8
(
°°8 9
$str
°°9 C
)
°°C D
)
°°D E
,
°°E F
	SpecValue
¢¢ 
=
¢¢ 
reader
¢¢ 
.
¢¢ 
IsDBNull
¢¢ '
(
¢¢' (
reader
¢¢( .
.
¢¢. /

GetOrdinal
¢¢/ 9
(
¢¢9 :
$str
¢¢: F
)
¢¢F G
)
¢¢G H
?
¢¢I J
$str
¢¢K O
:
¢¢P Q
reader
¢¢R X
.
¢¢X Y
	GetString
¢¢Y b
(
¢¢b c
reader
¢¢c i
.
¢¢i j

GetOrdinal
¢¢j t
(
¢¢t u
$str¢¢u Å
)¢¢Å Ç
)¢¢Ç É
,¢¢É Ñ
	CreatedBy
££ 
=
££ 
reader
££ 
.
££ 
	GetString
££ (
(
££( )
reader
££) /
.
££/ 0

GetOrdinal
££0 :
(
££: ;
$str
££; G
)
££G H
)
££H I
,
££I J
CreatedDate
§§ 
=
§§ 
reader
§§  
.
§§  !
GetDateTime
§§! ,
(
§§, -
reader
§§- 3
.
§§3 4

GetOrdinal
§§4 >
(
§§> ?
$str
§§? M
)
§§M N
)
§§N O
,
§§O P

ModifiedBy
•• 
=
•• 
reader
•• 
.
••  
IsDBNull
••  (
(
••( )
reader
••) /
.
••/ 0

GetOrdinal
••0 :
(
••: ;
$str
••; H
)
••H I
)
••I J
?
••K L
null
••M Q
:
••R S
reader
••T Z
.
••Z [
	GetString
••[ d
(
••d e
reader
••e k
.
••k l

GetOrdinal
••l v
(
••v w
$str••w Ñ
)••Ñ Ö
)••Ö Ü
,••Ü á
ModifiedDate
¶¶ 
=
¶¶ 
reader
¶¶ !
.
¶¶! "
IsDBNull
¶¶" *
(
¶¶* +
reader
¶¶+ 1
.
¶¶1 2

GetOrdinal
¶¶2 <
(
¶¶< =
$str
¶¶= L
)
¶¶L M
)
¶¶M N
?
¶¶O P
null
¶¶Q U
:
¶¶V W
reader
¶¶X ^
.
¶¶^ _
GetDateTime
¶¶_ j
(
¶¶j k
reader
¶¶k q
.
¶¶q r

GetOrdinal
¶¶r |
(
¶¶| }
$str¶¶} å
)¶¶å ç
)¶¶ç é
}
ßß 	
;
ßß	 

}
®® 
}©© “1
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Receiving\Dao_CarrierDeliveryLabel.cs
	namespace		 	%
MTM_Receiving_Application		
 #
.		# $
Data		$ (
.		( )
	Receiving		) 2
;		2 3
public 
static 
class $
Dao_CarrierDeliveryLabel ,
{ 
private 
static !
IService_ErrorHandler (
?( )
_errorHandler* 7
;7 8
public 

static 
void 
SetErrorHandler &
(& '!
IService_ErrorHandler' <
errorHandler= I
)I J
{ 
_errorHandler 
= 
errorHandler $
;$ %
} 
public!! 

static!! 
async!! 
Task!! 
<!! 
Model_Dao_Result!! -
>!!- .+
InsertCarrierDeliveryLabelAsync!!/ N
(!!N O&
Model_CarrierDeliveryLabel!!O i
label!!j o
)!!o p
{"" 
try## 
{$$ 	
string&& 
connectionString&& #
=&&$ %%
Helper_Database_Variables&&& ?
.&&? @
GetConnectionString&&@ S
(&&S T
useProduction&&T a
:&&a b
true&&c g
)&&g h
;&&h i
var)) 

parameters)) 
=)) 
new))  
MySqlParameter))! /
[))/ 0
]))0 1
{** 
new++ 
MySqlParameter++ "
(++" #
$str++# 1
,++1 2
label++3 8
.++8 9
	DeliverTo++9 B
??++C E
string++F L
.++L M
Empty++M R
)++R S
,++S T
new,, 
MySqlParameter,, "
(,," #
$str,,# 2
,,,2 3
label,,4 9
.,,9 :

Department,,: D
??,,E G
string,,H N
.,,N O
Empty,,O T
),,T U
,,,U V
new-- 
MySqlParameter-- "
(--" #
$str--# :
,--: ;
label--< A
.--A B
PackageDescription--B T
??--U W
string--X ^
.--^ _
Empty--_ d
)--d e
,--e f
new.. 
MySqlParameter.. "
(.." #
$str..# 0
,..0 1
(..2 3
object..3 9
?..9 :
)..: ;
label..; @
...@ A
PONumber..A I
??..J L
DBNull..M S
...S T
Value..T Y
)..Y Z
,..Z [
new// 
MySqlParameter// "
(//" #
$str//# 7
,//7 8
label//9 >
.//> ?
WorkOrderNumber//? N
??//O Q
string//R X
.//X Y
Empty//Y ^
)//^ _
,//_ `
new00 
MySqlParameter00 "
(00" #
$str00# 6
,006 7
label008 =
.00= >
EmployeeNumber00> L
)00L M
,00M N
new11 
MySqlParameter11 "
(11" #
$str11# ,
,11, -
label11. 3
.113 4
Date114 8
)118 9
,119 :
new22 
MySqlParameter22 "
(22" #
$str22# .
,22. /
MySqlDbType220 ;
.22; <
Int3222< A
)22A B
{22C D
	Direction22E N
=22O P
System22Q W
.22W X
Data22X \
.22\ ]
ParameterDirection22] o
.22o p
Output22p v
}22w x
,22x y
new33 
MySqlParameter33 "
(33" #
$str33# 0
,330 1
MySqlDbType332 =
.33= >
VarChar33> E
,33E F
$num33G J
)33J K
{33L M
	Direction33N W
=33X Y
System33Z `
.33` a
Data33a e
.33e f
ParameterDirection33f x
.33x y
Output33y 
}
33Ä Å
}44 
;44 
if77 
(77 
!77 +
Helper_Database_StoredProcedure77 0
.770 1
ValidateParameters771 C
(77C D

parameters77D N
)77N O
)77O P
{88 
return99 
new99 
Model_Dao_Result99 +
{:: 
Success;; 
=;; 
false;; #
,;;# $
ErrorMessage<<  
=<<! "
$str<<# O
,<<O P
Severity== 
=== 
Models== %
.==% &
Enums==& +
.==+ ,
Enum_ErrorSeverity==, >
.==> ?
Warning==? F
}>> 
;>> 
}?? 
varBB 
resultBB 
=BB 
awaitBB +
Helper_Database_StoredProcedureBB >
.BB> ?
ExecuteAsyncBB? K
(BBK L
$strCC /
,CC/ 0

parametersDD 
,DD 
connectionStringEE  
)FF 
;FF 
returnHH 
resultHH 
;HH 
}II 	
catchJJ 
(JJ 
	ExceptionJJ 
exJJ 
)JJ 
{KK 	
varLL 
errorResultLL 
=LL 
newLL !
Model_Dao_ResultLL" 2
{MM 
SuccessNN 
=NN 
falseNN 
,NN  
ErrorMessageOO 
=OO 
$"OO !
$strOO! T
{OOT U
exOOU W
.OOW X
MessageOOX _
}OO_ `
"OO` a
,OOa b
SeverityPP 
=PP 
ModelsPP !
.PP! "
EnumsPP" '
.PP' (
Enum_ErrorSeverityPP( :
.PP: ;
ErrorPP; @
}QQ 
;QQ 
ifTT 
(TT 
_errorHandlerTT 
!=TT  
nullTT! %
)TT% &
{UU 
awaitVV 
_errorHandlerVV #
.VV# $
HandleErrorAsyncVV$ 4
(VV4 5
errorResultWW 
.WW  
ErrorMessageWW  ,
,WW, -
errorResultXX 
.XX  
SeverityXX  (
,XX( )
exYY 
,YY 

showDialogZZ 
:ZZ 
falseZZ  %
)[[ 
;[[ 
}\\ 
return^^ 
errorResult^^ 
;^^ 
}__ 	
}`` 
}aa r
UC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Dunnage\Dao_DunnagePart.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Data$ (
.( )
Dunnage) 0
;0 1
public 
class 
Dao_DunnagePart 
{ 
private 
readonly 
string 
_connectionString -
;- .
public 

Dao_DunnagePart 
( 
string !
connectionString" 2
)2 3
{ 
_connectionString 
= 
connectionString ,
;, -
} 
public 

virtual 
async 
Task 
< 
Model_Dao_Result .
<. /
List/ 3
<3 4
Model_DunnagePart4 E
>E F
>F G
>G H
GetAllAsyncI T
(T U
)U V
{ 
return 
await +
Helper_Database_StoredProcedure 4
.4 5
ExecuteListAsync5 E
<E F
Model_DunnagePartF W
>W X
(X Y
_connectionString 
, 
$str &
,& '
MapFromReader 
) 	
;	 

} 
public 

virtual 
async 
Task 
< 
Model_Dao_Result .
<. /
List/ 3
<3 4
Model_DunnagePart4 E
>E F
>F G
>G H
GetByTypeAsyncI W
(W X
intX [
typeId\ b
)b c
{   
var!! 

parameters!! 
=!! 
new!! 

Dictionary!! '
<!!' (
string!!( .
,!!. /
object!!0 6
>!!6 7
{"" 	
{## 
$str## 
,## 
typeId## 
}##  !
}$$ 	
;$$	 

return&& 
await&& +
Helper_Database_StoredProcedure&& 4
.&&4 5
ExecuteListAsync&&5 E
<&&E F
Model_DunnagePart&&F W
>&&W X
(&&X Y
_connectionString'' 
,'' 
$str(( *
,((* +
MapFromReader)) 
,)) 

parameters** 
)++ 	
;++	 

},, 
public.. 

virtual.. 
async.. 
Task.. 
<.. 
Model_Dao_Result.. .
<... /
Model_DunnagePart../ @
>..@ A
>..A B
GetByIdAsync..C O
(..O P
string..P V
partId..W ]
)..] ^
{// 
var00 

parameters00 
=00 
new00 

Dictionary00 '
<00' (
string00( .
,00. /
object000 6
>006 7
{11 	
{22 
$str22 
,22 
partId22 
}22  !
}33 	
;33	 

return55 
await55 +
Helper_Database_StoredProcedure55 4
.554 5
ExecuteSingleAsync555 G
<55G H
Model_DunnagePart55H Y
>55Y Z
(55Z [
_connectionString66 
,66 
$str77 (
,77( )
MapFromReader88 
,88 

parameters99 
):: 	
;::	 

};; 
public== 

virtual== 
async== 
Task== 
<== 
Model_Dao_Result== .
<==. /
int==/ 2
>==2 3
>==3 4
InsertAsync==5 @
(==@ A
string==A G
partId==H N
,==N O
int==P S
typeId==T Z
,==Z [
string==\ b

specValues==c m
,==m n
string==o u
user==v z
)==z {
{>> 
var?? 
pNewId?? 
=?? 
new?? 
MySqlParameter?? '
(??' (
$str??( 3
,??3 4
MySqlDbType??5 @
.??@ A
Int32??A F
)??F G
{@@ 	
	DirectionAA 
=AA 
ParameterDirectionAA *
.AA* +
OutputAA+ 1
}BB 	
;BB	 

varDD 

parametersDD 
=DD 
newDD 
MySqlParameterDD +
[DD+ ,
]DD, -
{EE 	
newFF 
MySqlParameterFF 
(FF 
$strFF +
,FF+ ,
partIdFF- 3
)FF3 4
,FF4 5
newGG 
MySqlParameterGG 
(GG 
$strGG +
,GG+ ,
typeIdGG- 3
)GG3 4
,GG4 5
newHH 
MySqlParameterHH 
(HH 
$strHH /
,HH/ 0

specValuesHH1 ;
)HH; <
,HH< =
newII 
MySqlParameterII 
(II 
$strII (
,II( )
userII* .
)II. /
,II/ 0
pNewIdJJ 
}KK 	
;KK	 

varMM 
resultMM 
=MM 
awaitMM +
Helper_Database_StoredProcedureMM :
.MM: ;
ExecuteAsyncMM; G
(MMG H
$strNN %
,NN% &

parametersOO 
,OO 
_connectionStringPP 
)QQ 	
;QQ	 

ifSS 

(SS 
resultSS 
.SS 
	IsSuccessSS 
)SS 
{TT 	
ifUU 
(UU 
pNewIdUU 
.UU 
ValueUU 
!=UU 
nullUU  $
&&UU% '
pNewIdUU( .
.UU. /
ValueUU/ 4
!=UU5 7
DBNullUU8 >
.UU> ?
ValueUU? D
)UUD E
{VV 
returnWW $
Model_Dao_Result_FactoryWW /
.WW/ 0
SuccessWW0 7
<WW7 8
intWW8 ;
>WW; <
(WW< =
ConvertWW= D
.WWD E
ToInt32WWE L
(WWL M
pNewIdWWM S
.WWS T
ValueWWT Y
)WWY Z
)WWZ [
;WW[ \
}XX 
returnYY $
Model_Dao_Result_FactoryYY +
.YY+ ,
FailureYY, 3
<YY3 4
intYY4 7
>YY7 8
(YY8 9
$strYY9 T
)YYT U
;YYU V
}ZZ 	
return\\ $
Model_Dao_Result_Factory\\ '
.\\' (
Failure\\( /
<\\/ 0
int\\0 3
>\\3 4
(\\4 5
result\\5 ;
.\\; <
ErrorMessage\\< H
,\\H I
result\\J P
.\\P Q
	Exception\\Q Z
)\\Z [
;\\[ \
}]] 
public__ 

virtual__ 
async__ 
Task__ 
<__ 
Model_Dao_Result__ .
>__. /
UpdateAsync__0 ;
(__; <
int__< ?
id__@ B
,__B C
string__D J

specValues__K U
,__U V
string__W ]
user__^ b
)__b c
{`` 
varaa 

parametersaa 
=aa 
newaa 

Dictionaryaa '
<aa' (
stringaa( .
,aa. /
objectaa0 6
>aa6 7
{bb 	
{cc 
$strcc 
,cc 
idcc 
}cc 
,cc 
{dd 
$strdd 
,dd 

specValuesdd '
}dd( )
,dd) *
{ee 
$stree 
,ee 
useree 
}ee 
}ff 	
;ff	 

returnhh 
awaithh +
Helper_Database_StoredProcedurehh 4
.hh4 5 
ExecuteNonQueryAsynchh5 I
(hhI J
_connectionStringii 
,ii 
$strjj %
,jj% &

parameterskk 
)ll 	
;ll	 

}mm 
publicoo 

virtualoo 
asyncoo 
Taskoo 
<oo 
Model_Dao_Resultoo .
>oo. /
DeleteAsyncoo0 ;
(oo; <
intoo< ?
idoo@ B
)ooB C
{pp 
varqq 

parametersqq 
=qq 
newqq 

Dictionaryqq '
<qq' (
stringqq( .
,qq. /
objectqq0 6
>qq6 7
{rr 	
{ss 
$strss 
,ss 
idss 
}ss 
}tt 	
;tt	 

returnvv 
awaitvv +
Helper_Database_StoredProcedurevv 4
.vv4 5 
ExecuteNonQueryAsyncvv5 I
(vvI J
_connectionStringww 
,ww 
$strxx %
,xx% &

parametersyy 
)zz 	
;zz	 

}{{ 
public}} 

virtual}} 
async}} 
Task}} 
<}} 
Model_Dao_Result}} .
<}}. /
int}}/ 2
>}}2 3
>}}3 4"
CountTransactionsAsync}}5 K
(}}K L
string}}L R
partId}}S Y
)}}Y Z
{~~ 
var 

parameters 
= 
new 

Dictionary '
<' (
string( .
,. /
object0 6
>6 7
{
ÄÄ 	
{
ÅÅ 
$str
ÅÅ 
,
ÅÅ 
partId
ÅÅ 
}
ÅÅ  !
}
ÇÇ 	
;
ÇÇ	 

return
ÑÑ 
await
ÑÑ -
Helper_Database_StoredProcedure
ÑÑ 4
.
ÑÑ4 5 
ExecuteSingleAsync
ÑÑ5 G
<
ÑÑG H
int
ÑÑH K
>
ÑÑK L
(
ÑÑL M
_connectionString
ÖÖ 
,
ÖÖ 
$str
ÜÜ 1
,
ÜÜ1 2
reader
áá 
=>
áá 
reader
áá 
.
áá 
GetInt32
áá %
(
áá% &
reader
áá& ,
.
áá, -

GetOrdinal
áá- 7
(
áá7 8
$str
áá8 K
)
ááK L
)
ááL M
,
ááM N

parameters
àà 
)
ââ 	
;
ââ	 

}
ää 
public
åå 

virtual
åå 
async
åå 
Task
åå 
<
åå 
Model_Dao_Result
åå .
<
åå. /
List
åå/ 3
<
åå3 4
Model_DunnagePart
åå4 E
>
ååE F
>
ååF G
>
ååG H
SearchAsync
ååI T
(
ååT U
string
ååU [

searchText
åå\ f
,
ååf g
int
ååh k
?
ååk l
typeId
ååm s
=
ååt u
null
ååv z
)
ååz {
{
çç 
var
éé 

parameters
éé 
=
éé 
new
éé 

Dictionary
éé '
<
éé' (
string
éé( .
,
éé. /
object
éé0 6
>
éé6 7
{
èè 	
{
êê 
$str
êê 
,
êê 

searchText
êê '
}
êê( )
,
êê) *
{
ëë 
$str
ëë 
,
ëë 
typeId
ëë 
??
ëë  "
$num
ëë# $
}
ëë% &
}
íí 	
;
íí	 

return
îî 
await
îî -
Helper_Database_StoredProcedure
îî 4
.
îî4 5
ExecuteListAsync
îî5 E
<
îîE F
Model_DunnagePart
îîF W
>
îîW X
(
îîX Y
_connectionString
ïï 
,
ïï 
$str
ññ %
,
ññ% &
MapFromReader
óó 
,
óó 

parameters
òò 
)
ôô 	
;
ôô	 

}
öö 
private
úú 
Model_DunnagePart
úú 
MapFromReader
úú +
(
úú+ ,
IDataReader
úú, 7
reader
úú8 >
)
úú> ?
{
ùù 
return
ûû 
new
ûû 
Model_DunnagePart
ûû $
{
üü 	
Id
†† 
=
†† 
reader
†† 
.
†† 
GetInt32
††  
(
††  !
reader
††! '
.
††' (

GetOrdinal
††( 2
(
††2 3
$str
††3 7
)
††7 8
)
††8 9
,
††9 :
PartId
°° 
=
°° 
reader
°° 
.
°° 
	GetString
°° %
(
°°% &
reader
°°& ,
.
°°, -

GetOrdinal
°°- 7
(
°°7 8
$str
°°8 A
)
°°A B
)
°°B C
,
°°C D
TypeId
¢¢ 
=
¢¢ 
reader
¢¢ 
.
¢¢ 
GetInt32
¢¢ $
(
¢¢$ %
reader
¢¢% +
.
¢¢+ ,

GetOrdinal
¢¢, 6
(
¢¢6 7
$str
¢¢7 @
)
¢¢@ A
)
¢¢A B
,
¢¢B C

SpecValues
££ 
=
££ 
reader
££ 
.
££  
IsDBNull
££  (
(
££( )
reader
££) /
.
££/ 0

GetOrdinal
££0 :
(
££: ;
$str
££; H
)
££H I
)
££I J
?
££K L
$str
££M Q
:
££R S
reader
££T Z
.
££Z [
	GetString
££[ d
(
££d e
reader
££e k
.
££k l

GetOrdinal
££l v
(
££v w
$str££w Ñ
)££Ñ Ö
)££Ö Ü
,££Ü á
	CreatedBy
§§ 
=
§§ 
reader
§§ 
.
§§ 
	GetString
§§ (
(
§§( )
reader
§§) /
.
§§/ 0

GetOrdinal
§§0 :
(
§§: ;
$str
§§; G
)
§§G H
)
§§H I
,
§§I J
CreatedDate
•• 
=
•• 
reader
••  
.
••  !
GetDateTime
••! ,
(
••, -
reader
••- 3
.
••3 4

GetOrdinal
••4 >
(
••> ?
$str
••? M
)
••M N
)
••N O
,
••O P

ModifiedBy
¶¶ 
=
¶¶ 
reader
¶¶ 
.
¶¶  
IsDBNull
¶¶  (
(
¶¶( )
reader
¶¶) /
.
¶¶/ 0

GetOrdinal
¶¶0 :
(
¶¶: ;
$str
¶¶; H
)
¶¶H I
)
¶¶I J
?
¶¶K L
null
¶¶M Q
:
¶¶R S
reader
¶¶T Z
.
¶¶Z [
	GetString
¶¶[ d
(
¶¶d e
reader
¶¶e k
.
¶¶k l

GetOrdinal
¶¶l v
(
¶¶v w
$str¶¶w Ñ
)¶¶Ñ Ö
)¶¶Ö Ü
,¶¶Ü á
ModifiedDate
ßß 
=
ßß 
reader
ßß !
.
ßß! "
IsDBNull
ßß" *
(
ßß* +
reader
ßß+ 1
.
ßß1 2

GetOrdinal
ßß2 <
(
ßß< =
$str
ßß= L
)
ßßL M
)
ßßM N
?
ßßO P
null
ßßQ U
:
ßßV W
reader
ßßX ^
.
ßß^ _
GetDateTime
ßß_ j
(
ßßj k
reader
ßßk q
.
ßßq r

GetOrdinal
ßßr |
(
ßß| }
$strßß} å
)ßßå ç
)ßßç é
}
®® 	
;
®®	 

}
©© 
}™™ ƒa
UC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Dunnage\Dao_DunnageLoad.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Data$ (
.( )
Dunnage) 0
;0 1
public 
class 
Dao_DunnageLoad 
{ 
private 
readonly 
string 
_connectionString -
;- .
public 

Dao_DunnageLoad 
( 
string !
connectionString" 2
)2 3
{ 
_connectionString 
= 
connectionString ,
;, -
} 
public 

virtual 
async 
Task 
< 
Model_Dao_Result .
<. /
List/ 3
<3 4
Model_DunnageLoad4 E
>E F
>F G
>G H
GetAllAsyncI T
(T U
)U V
{ 
return 
await +
Helper_Database_StoredProcedure 4
.4 5
ExecuteListAsync5 E
<E F
Model_DunnageLoadF W
>W X
(X Y
_connectionString 
, 
$str &
,& '
MapFromReader 
) 	
;	 

} 
public   

virtual   
async   
Task   
<   
Model_Dao_Result   .
<  . /
List  / 3
<  3 4
Model_DunnageLoad  4 E
>  E F
>  F G
>  G H
GetByDateRangeAsync  I \
(  \ ]
DateTime  ] e
	startDate  f o
,  o p
DateTime  q y
endDate	  z Å
)
  Å Ç
{!! 
var"" 

parameters"" 
="" 
new"" 

Dictionary"" '
<""' (
string""( .
,"". /
object""0 6
>""6 7
{## 	
{$$ 
$str$$ 
,$$ 
	startDate$$ %
}$$& '
,$$' (
{%% 
$str%% 
,%% 
endDate%% !
}%%" #
}&& 	
;&&	 

return(( 
await(( +
Helper_Database_StoredProcedure(( 4
.((4 5
ExecuteListAsync((5 E
<((E F
Model_DunnageLoad((F W
>((W X
(((X Y
_connectionString)) 
,)) 
$str** 0
,**0 1
MapFromReader++ 
,++ 

parameters,, 
)-- 	
;--	 

}.. 
public00 

virtual00 
async00 
Task00 
<00 
Model_Dao_Result00 .
<00. /
Model_DunnageLoad00/ @
>00@ A
>00A B
GetByIdAsync00C O
(00O P
Guid00P T
loadUuid00U ]
)00] ^
{11 
var22 

parameters22 
=22 
new22 

Dictionary22 '
<22' (
string22( .
,22. /
object220 6
>226 7
{33 	
{44 
$str44 
,44 
loadUuid44 #
.44# $
ToString44$ ,
(44, -
)44- .
}44/ 0
}55 	
;55	 

return77 
await77 +
Helper_Database_StoredProcedure77 4
.774 5
ExecuteSingleAsync775 G
<77G H
Model_DunnageLoad77H Y
>77Y Z
(77Z [
_connectionString88 
,88 
$str99 (
,99( )
MapFromReader:: 
,:: 

parameters;; 
)<< 	
;<<	 

}== 
public?? 

virtual?? 
async?? 
Task?? 
<?? 
Model_Dao_Result?? .
>??. /
InsertAsync??0 ;
(??; <
Guid??< @
loadUuid??A I
,??I J
string??K Q
partId??R X
,??X Y
decimal??Z a
quantity??b j
,??j k
string??l r
user??s w
)??w x
{@@ 
varAA 

parametersAA 
=AA 
newAA 

DictionaryAA '
<AA' (
stringAA( .
,AA. /
objectAA0 6
>AA6 7
{BB 	
{CC 
$strCC 
,CC 
loadUuidCC #
.CC# $
ToStringCC$ ,
(CC, -
)CC- .
}CC/ 0
,CC0 1
{DD 
$strDD 
,DD 
partIdDD 
}DD  !
,DD! "
{EE 
$strEE 
,EE 
quantityEE "
}EE# $
,EE$ %
{FF 
$strFF 
,FF 
userFF 
}FF 
}GG 	
;GG	 

returnII 
awaitII +
Helper_Database_StoredProcedureII 4
.II4 5 
ExecuteNonQueryAsyncII5 I
(III J
_connectionStringJJ 
,JJ 
$strKK %
,KK% &

parametersLL 
)MM 	
;MM	 

}NN 
publicPP 

virtualPP 
asyncPP 
TaskPP 
<PP 
Model_Dao_ResultPP .
>PP. /
InsertBatchAsyncPP0 @
(PP@ A
ListPPA E
<PPE F
Model_DunnageLoadPPF W
>PPW X
loadsPPY ^
,PP^ _
stringPP` f
userPPg k
)PPk l
{QQ 
varTT 
loadDataTT 
=TT 
newTT 
ListTT 
<TT  
objectTT  &
>TT& '
(TT' (
)TT( )
;TT) *
foreachUU 
(UU 
varUU 
loadUU 
inUU 
loadsUU "
)UU" #
{VV 	
loadDataWW 
.WW 
AddWW 
(WW 
newWW 
{XX 
	load_uuidYY 
=YY 
loadYY  
.YY  !
LoadUuidYY! )
.YY) *
ToStringYY* 2
(YY2 3
)YY3 4
,YY4 5
part_idZZ 
=ZZ 
loadZZ 
.ZZ 
PartIdZZ %
,ZZ% &
quantity[[ 
=[[ 
load[[ 
.[[  
Quantity[[  (
}\\ 
)\\ 
;\\ 
}]] 	
string__ 
json__ 
=__ 
JsonSerializer__ $
.__$ %
	Serialize__% .
(__. /
loadData__/ 7
)__7 8
;__8 9
varaa 

parametersaa 
=aa 
newaa 

Dictionaryaa '
<aa' (
stringaa( .
,aa. /
objectaa0 6
>aa6 7
{bb 	
{cc 
$strcc 
,cc 
jsoncc 
}cc  !
,cc! "
{dd 
$strdd 
,dd 
userdd 
}dd 
}ee 	
;ee	 

returngg 
awaitgg +
Helper_Database_StoredProceduregg 4
.gg4 5 
ExecuteNonQueryAsyncgg5 I
(ggI J
_connectionStringhh 
,hh 
$strii +
,ii+ ,

parametersjj 
)kk 	
;kk	 

}ll 
publicnn 

virtualnn 
asyncnn 
Tasknn 
<nn 
Model_Dao_Resultnn .
>nn. /
UpdateAsyncnn0 ;
(nn; <
Guidnn< @
loadUuidnnA I
,nnI J
decimalnnK R
quantitynnS [
,nn[ \
stringnn] c
usernnd h
)nnh i
{oo 
varpp 

parameterspp 
=pp 
newpp 

Dictionarypp '
<pp' (
stringpp( .
,pp. /
objectpp0 6
>pp6 7
{qq 	
{rr 
$strrr 
,rr 
loadUuidrr #
.rr# $
ToStringrr$ ,
(rr, -
)rr- .
}rr/ 0
,rr0 1
{ss 
$strss 
,ss 
quantityss "
}ss# $
,ss$ %
{tt 
$strtt 
,tt 
usertt 
}tt 
}uu 	
;uu	 

returnww 
awaitww +
Helper_Database_StoredProcedureww 4
.ww4 5 
ExecuteNonQueryAsyncww5 I
(wwI J
_connectionStringxx 
,xx 
$stryy %
,yy% &

parameterszz 
){{ 	
;{{	 

}|| 
public~~ 

virtual~~ 
async~~ 
Task~~ 
<~~ 
Model_Dao_Result~~ .
>~~. /
DeleteAsync~~0 ;
(~~; <
Guid~~< @
loadUuid~~A I
)~~I J
{ 
var
ÄÄ 

parameters
ÄÄ 
=
ÄÄ 
new
ÄÄ 

Dictionary
ÄÄ '
<
ÄÄ' (
string
ÄÄ( .
,
ÄÄ. /
object
ÄÄ0 6
>
ÄÄ6 7
{
ÅÅ 	
{
ÇÇ 
$str
ÇÇ 
,
ÇÇ 
loadUuid
ÇÇ #
.
ÇÇ# $
ToString
ÇÇ$ ,
(
ÇÇ, -
)
ÇÇ- .
}
ÇÇ/ 0
}
ÉÉ 	
;
ÉÉ	 

return
ÖÖ 
await
ÖÖ -
Helper_Database_StoredProcedure
ÖÖ 4
.
ÖÖ4 5"
ExecuteNonQueryAsync
ÖÖ5 I
(
ÖÖI J
_connectionString
ÜÜ 
,
ÜÜ 
$str
áá %
,
áá% &

parameters
àà 
)
ââ 	
;
ââ	 

}
ää 
private
åå 
Model_DunnageLoad
åå 
MapFromReader
åå +
(
åå+ ,
IDataReader
åå, 7
reader
åå8 >
)
åå> ?
{
çç 
return
éé 
new
éé 
Model_DunnageLoad
éé $
{
èè 	
LoadUuid
êê 
=
êê 
(
êê 
Guid
êê 
)
êê 
reader
êê #
[
êê# $
reader
êê$ *
.
êê* +

GetOrdinal
êê+ 5
(
êê5 6
$str
êê6 A
)
êêA B
]
êêB C
,
êêC D
PartId
ëë 
=
ëë 
reader
ëë 
.
ëë 
	GetString
ëë %
(
ëë% &
reader
ëë& ,
.
ëë, -

GetOrdinal
ëë- 7
(
ëë7 8
$str
ëë8 A
)
ëëA B
)
ëëB C
,
ëëC D
Quantity
íí 
=
íí 
reader
íí 
.
íí 

GetDecimal
íí (
(
íí( )
reader
íí) /
.
íí/ 0

GetOrdinal
íí0 :
(
íí: ;
$str
íí; E
)
ííE F
)
ííF G
,
ííG H
ReceivedDate
ìì 
=
ìì 
reader
ìì !
.
ìì! "
GetDateTime
ìì" -
(
ìì- .
reader
ìì. 4
.
ìì4 5

GetOrdinal
ìì5 ?
(
ìì? @
$str
ìì@ O
)
ììO P
)
ììP Q
,
ììQ R
	CreatedBy
îî 
=
îî 
reader
îî 
.
îî 
	GetString
îî (
(
îî( )
reader
îî) /
.
îî/ 0

GetOrdinal
îî0 :
(
îî: ;
$str
îî; G
)
îîG H
)
îîH I
,
îîI J
CreatedDate
ïï 
=
ïï 
reader
ïï  
.
ïï  !
GetDateTime
ïï! ,
(
ïï, -
reader
ïï- 3
.
ïï3 4

GetOrdinal
ïï4 >
(
ïï> ?
$str
ïï? M
)
ïïM N
)
ïïN O
,
ïïO P

ModifiedBy
ññ 
=
ññ 
reader
ññ 
.
ññ  
IsDBNull
ññ  (
(
ññ( )
reader
ññ) /
.
ññ/ 0

GetOrdinal
ññ0 :
(
ññ: ;
$str
ññ; H
)
ññH I
)
ññI J
?
ññK L
null
ññM Q
:
ññR S
reader
ññT Z
.
ññZ [
	GetString
ññ[ d
(
ññd e
reader
ññe k
.
ññk l

GetOrdinal
ññl v
(
ññv w
$strññw Ñ
)ññÑ Ö
)ññÖ Ü
,ññÜ á
ModifiedDate
óó 
=
óó 
reader
óó !
.
óó! "
IsDBNull
óó" *
(
óó* +
reader
óó+ 1
.
óó1 2

GetOrdinal
óó2 <
(
óó< =
$str
óó= L
)
óóL M
)
óóM N
?
óóO P
null
óóQ U
:
óóV W
reader
óóX ^
.
óó^ _
GetDateTime
óó_ j
(
óój k
reader
óók q
.
óóq r

GetOrdinal
óór |
(
óó| }
$stróó} å
)óóå ç
)óóç é
}
òò 	
;
òò	 

}
ôô 
}öö …b
\C:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Dunnage\Dao_InventoriedDunnage.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Data$ (
.( )
Dunnage) 0
;0 1
public 
class "
Dao_InventoriedDunnage #
{ 
private 
readonly 
string 
_connectionString -
;- .
public 
"
Dao_InventoriedDunnage !
(! "
string" (
connectionString) 9
)9 :
{ 
_connectionString 
= 
connectionString ,
;, -
} 
public 

virtual 
async 
Task 
< 
Model_Dao_Result .
<. /
List/ 3
<3 4$
Model_InventoriedDunnage4 L
>L M
>M N
>N O
GetAllAsyncP [
([ \
)\ ]
{ 
return 
await +
Helper_Database_StoredProcedure 4
.4 5
ExecuteListAsync5 E
<E F$
Model_InventoriedDunnageF ^
>^ _
(_ `
_connectionString 
, 
$str ,
,, -
MapFromReader 
) 	
;	 

} 
public 

virtual 
async 
Task 
< 
Model_Dao_Result .
<. /
bool/ 3
>3 4
>4 5

CheckAsync6 @
(@ A
stringA G
partIdH N
)N O
{   
var!! 

parameters!! 
=!! 
new!! 

Dictionary!! '
<!!' (
string!!( .
,!!. /
object!!0 6
>!!6 7
{"" 	
{## 
$str## 
,## 
partId## 
}##  !
}$$ 	
;$$	 

return&& 
await&& +
Helper_Database_StoredProcedure&& 4
.&&4 5
ExecuteSingleAsync&&5 G
<&&G H
bool&&H L
>&&L M
(&&M N
_connectionString'' 
,'' 
$str(( *
,((* +
reader)) 
=>)) 
reader)) 
.)) 

GetBoolean)) '
())' (
reader))( .
.)). /

GetOrdinal))/ 9
())9 :
$str)): N
)))N O
)))O P
,))P Q

parameters** 
)++ 	
;++	 

},, 
public.. 

virtual.. 
async.. 
Task.. 
<.. 
Model_Dao_Result.. .
<... /$
Model_InventoriedDunnage../ G
>..G H
>..H I
GetByPartAsync..J X
(..X Y
string..Y _
partId..` f
)..f g
{// 
var00 

parameters00 
=00 
new00 

Dictionary00 '
<00' (
string00( .
,00. /
object000 6
>006 7
{11 	
{22 
$str22 
,22 
partId22 
}22  !
}33 	
;33	 

return55 
await55 +
Helper_Database_StoredProcedure55 4
.554 5
ExecuteSingleAsync555 G
<55G H$
Model_InventoriedDunnage55H `
>55` a
(55a b
_connectionString66 
,66 
$str77 0
,770 1
MapFromReader88 
,88 

parameters99 
):: 	
;::	 

};; 
public== 

virtual== 
async== 
Task== 
<== 
Model_Dao_Result== .
<==. /
int==/ 2
>==2 3
>==3 4
InsertAsync==5 @
(==@ A
string==A G
partId==H N
,==N O
string==P V
inventoryMethod==W f
,==f g
string==h n
notes==o t
,==t u
string==v |
user	==} Å
)
==Å Ç
{>> 
var?? 
pNewId?? 
=?? 
new?? 
MySqlParameter?? '
(??' (
$str??( 3
,??3 4
MySqlDbType??5 @
.??@ A
Int32??A F
)??F G
{@@ 	
	DirectionAA 
=AA 
ParameterDirectionAA *
.AA* +
OutputAA+ 1
}BB 	
;BB	 

varDD 

parametersDD 
=DD 
newDD 
MySqlParameterDD +
[DD+ ,
]DD, -
{EE 	
newFF 
MySqlParameterFF 
(FF 
$strFF +
,FF+ ,
partIdFF- 3
)FF3 4
,FF4 5
newGG 
MySqlParameterGG 
(GG 
$strGG 4
,GG4 5
inventoryMethodGG6 E
)GGE F
,GGF G
newHH 
MySqlParameterHH 
(HH 
$strHH )
,HH) *
notesHH+ 0
)HH0 1
,HH1 2
newII 
MySqlParameterII 
(II 
$strII (
,II( )
userII* .
)II. /
,II/ 0
pNewIdJJ 
}KK 	
;KK	 

varMM 
resultMM 
=MM 
awaitMM +
Helper_Database_StoredProcedureMM :
.MM: ;
ExecuteAsyncMM; G
(MMG H
$strNN +
,NN+ ,

parametersOO 
,OO 
_connectionStringPP 
)QQ 	
;QQ	 

ifSS 

(SS 
resultSS 
.SS 
	IsSuccessSS 
)SS 
{TT 	
ifUU 
(UU 
pNewIdUU 
.UU 
ValueUU 
!=UU 
nullUU  $
&&UU% '
pNewIdUU( .
.UU. /
ValueUU/ 4
!=UU5 7
DBNullUU8 >
.UU> ?
ValueUU? D
)UUD E
{VV 
returnWW $
Model_Dao_Result_FactoryWW /
.WW/ 0
SuccessWW0 7
<WW7 8
intWW8 ;
>WW; <
(WW< =
ConvertWW= D
.WWD E
ToInt32WWE L
(WWL M
pNewIdWWM S
.WWS T
ValueWWT Y
)WWY Z
)WWZ [
;WW[ \
}XX 
returnYY $
Model_Dao_Result_FactoryYY +
.YY+ ,
FailureYY, 3
<YY3 4
intYY4 7
>YY7 8
(YY8 9
$strYY9 T
)YYT U
;YYU V
}ZZ 	
return\\ $
Model_Dao_Result_Factory\\ '
.\\' (
Failure\\( /
<\\/ 0
int\\0 3
>\\3 4
(\\4 5
result\\5 ;
.\\; <
ErrorMessage\\< H
,\\H I
result\\J P
.\\P Q
	Exception\\Q Z
)\\Z [
;\\[ \
}]] 
public__ 

virtual__ 
async__ 
Task__ 
<__ 
Model_Dao_Result__ .
>__. /
UpdateAsync__0 ;
(__; <
int__< ?
id__@ B
,__B C
string__D J
inventoryMethod__K Z
,__Z [
string__\ b
notes__c h
,__h i
string__j p
user__q u
)__u v
{`` 
varaa 

parametersaa 
=aa 
newaa 

Dictionaryaa '
<aa' (
stringaa( .
,aa. /
objectaa0 6
>aa6 7
{bb 	
{cc 
$strcc 
,cc 
idcc 
}cc 
,cc 
{dd 
$strdd  
,dd  !
inventoryMethoddd" 1
}dd2 3
,dd3 4
{ee 
$stree 
,ee 
notesee 
}ee 
,ee 
{ff 
$strff 
,ff 
userff 
}ff 
}gg 	
;gg	 

returnii 
awaitii +
Helper_Database_StoredProcedureii 4
.ii4 5 
ExecuteNonQueryAsyncii5 I
(iiI J
_connectionStringjj 
,jj 
$strkk +
,kk+ ,

parametersll 
)mm 	
;mm	 

}nn 
publicpp 

virtualpp 
asyncpp 
Taskpp 
<pp 
Model_Dao_Resultpp .
>pp. /
DeleteAsyncpp0 ;
(pp; <
intpp< ?
idpp@ B
)ppB C
{qq 
varrr 

parametersrr 
=rr 
newrr 

Dictionaryrr '
<rr' (
stringrr( .
,rr. /
objectrr0 6
>rr6 7
{ss 	
{tt 
$strtt 
,tt 
idtt 
}tt 
}uu 	
;uu	 

returnww 
awaitww +
Helper_Database_StoredProcedureww 4
.ww4 5 
ExecuteNonQueryAsyncww5 I
(wwI J
_connectionStringxx 
,xx 
$stryy +
,yy+ ,

parameterszz 
){{ 	
;{{	 

}|| 
private~~ $
Model_InventoriedDunnage~~ $
MapFromReader~~% 2
(~~2 3
IDataReader~~3 >
reader~~? E
)~~E F
{ 
return
ÄÄ 
new
ÄÄ &
Model_InventoriedDunnage
ÄÄ +
{
ÅÅ 	
Id
ÇÇ 
=
ÇÇ 
reader
ÇÇ 
.
ÇÇ 
GetInt32
ÇÇ  
(
ÇÇ  !
reader
ÇÇ! '
.
ÇÇ' (

GetOrdinal
ÇÇ( 2
(
ÇÇ2 3
$str
ÇÇ3 7
)
ÇÇ7 8
)
ÇÇ8 9
,
ÇÇ9 :
PartId
ÉÉ 
=
ÉÉ 
reader
ÉÉ 
.
ÉÉ 
	GetString
ÉÉ %
(
ÉÉ% &
reader
ÉÉ& ,
.
ÉÉ, -

GetOrdinal
ÉÉ- 7
(
ÉÉ7 8
$str
ÉÉ8 A
)
ÉÉA B
)
ÉÉB C
,
ÉÉC D
InventoryMethod
ÑÑ 
=
ÑÑ 
reader
ÑÑ $
.
ÑÑ$ %
IsDBNull
ÑÑ% -
(
ÑÑ- .
reader
ÑÑ. 4
.
ÑÑ4 5

GetOrdinal
ÑÑ5 ?
(
ÑÑ? @
$str
ÑÑ@ R
)
ÑÑR S
)
ÑÑS T
?
ÑÑU V
null
ÑÑW [
:
ÑÑ\ ]
reader
ÑÑ^ d
.
ÑÑd e
	GetString
ÑÑe n
(
ÑÑn o
reader
ÑÑo u
.
ÑÑu v

GetOrdinalÑÑv Ä
(ÑÑÄ Å
$strÑÑÅ ì
)ÑÑì î
)ÑÑî ï
,ÑÑï ñ
Notes
ÖÖ 
=
ÖÖ 
reader
ÖÖ 
.
ÖÖ 
IsDBNull
ÖÖ #
(
ÖÖ# $
reader
ÖÖ$ *
.
ÖÖ* +

GetOrdinal
ÖÖ+ 5
(
ÖÖ5 6
$str
ÖÖ6 =
)
ÖÖ= >
)
ÖÖ> ?
?
ÖÖ@ A
null
ÖÖB F
:
ÖÖG H
reader
ÖÖI O
.
ÖÖO P
	GetString
ÖÖP Y
(
ÖÖY Z
reader
ÖÖZ `
.
ÖÖ` a

GetOrdinal
ÖÖa k
(
ÖÖk l
$str
ÖÖl s
)
ÖÖs t
)
ÖÖt u
,
ÖÖu v
	CreatedBy
ÜÜ 
=
ÜÜ 
reader
ÜÜ 
.
ÜÜ 
	GetString
ÜÜ (
(
ÜÜ( )
reader
ÜÜ) /
.
ÜÜ/ 0

GetOrdinal
ÜÜ0 :
(
ÜÜ: ;
$str
ÜÜ; G
)
ÜÜG H
)
ÜÜH I
,
ÜÜI J
CreatedDate
áá 
=
áá 
reader
áá  
.
áá  !
GetDateTime
áá! ,
(
áá, -
reader
áá- 3
.
áá3 4

GetOrdinal
áá4 >
(
áá> ?
$str
áá? M
)
ááM N
)
ááN O
,
ááO P

ModifiedBy
àà 
=
àà 
reader
àà 
.
àà  
IsDBNull
àà  (
(
àà( )
reader
àà) /
.
àà/ 0

GetOrdinal
àà0 :
(
àà: ;
$str
àà; H
)
ààH I
)
ààI J
?
ààK L
null
ààM Q
:
ààR S
reader
ààT Z
.
ààZ [
	GetString
àà[ d
(
ààd e
reader
ààe k
.
ààk l

GetOrdinal
ààl v
(
ààv w
$strààw Ñ
)ààÑ Ö
)ààÖ Ü
,ààÜ á
ModifiedDate
ââ 
=
ââ 
reader
ââ !
.
ââ! "
IsDBNull
ââ" *
(
ââ* +
reader
ââ+ 1
.
ââ1 2

GetOrdinal
ââ2 <
(
ââ< =
$str
ââ= L
)
ââL M
)
ââM N
?
ââO P
null
ââQ U
:
ââV W
reader
ââX ^
.
ââ^ _
GetDateTime
ââ_ j
(
ââj k
reader
ââk q
.
ââq r

GetOrdinal
ââr |
(
ââ| }
$strââ} å
)ââå ç
)ââç é
}
ää 	
;
ää	 

}
ãã 
}åå  Ÿ
UC:\Users\johnk\source\repos\MTM_Receiving_Application\Data\Authentication\Dao_User.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Data$ (
.( )
Authentication) 7
{ 
public 

class 
Dao_User 
{ 
private 
readonly 
string 
_connectionString  1
;1 2
public 
Dao_User 
( 
string 
connectionString /
)/ 0
{ 	
_connectionString 
= 
connectionString  0
??1 3
throw4 9
new: =!
ArgumentNullException> S
(S T
nameofT Z
(Z [
connectionString[ k
)k l
)l m
;m n
} 	
public'' 
async'' 
Task'' 
<'' 
Model_Dao_Result'' *
<''* +

Model_User''+ 5
>''5 6
>''6 7)
GetUserByWindowsUsernameAsync''8 U
(''U V
string''V \
windowsUsername''] l
)''l m
{(( 	
var)) 

parameters)) 
=)) 
new))  

Dictionary))! +
<))+ ,
string)), 2
,))2 3
object))4 :
>)): ;
{** 
{++ 
$str++ '
,++' (
windowsUsername++) 8
}++9 :
},, 
;,, 
return.. 
await.. +
Helper_Database_StoredProcedure.. 8
...8 9
ExecuteSingleAsync..9 K
(..K L
_connectionString// !
,//! "
$str00 -
,00- .
MapReaderToUser11 
,11  

parameters22 
)33 
;33 
}44 	
public<< 
async<< 
Task<< 
<<< 
Model_Dao_Result<< *
<<<* +

Model_User<<+ 5
><<5 6
><<6 7 
ValidateUserPinAsync<<8 L
(<<L M
string<<M S
username<<T \
,<<\ ]
string<<^ d
pin<<e h
)<<h i
{== 	
var>> 

parameters>> 
=>> 
new>>  

Dictionary>>! +
<>>+ ,
string>>, 2
,>>2 3
object>>4 :
>>>: ;
{?? 
{@@ 
$str@@ 
,@@  
username@@! )
}@@* +
,@@+ ,
{AA 
$strAA 
,AA 
pinAA 
}AA  !
}BB 
;BB 
returnDD 
awaitDD +
Helper_Database_StoredProcedureDD 8
.DD8 9
ExecuteSingleAsyncDD9 K
(DDK L
_connectionStringEE !
,EE! "
$strFF $
,FF$ %
MapReaderToUserGG 
,GG  

parametersHH 
)II 
;II 
}JJ 	
publicVV 
asyncVV 
TaskVV 
<VV 
Model_Dao_ResultVV *
<VV* +
intVV+ .
>VV. /
>VV/ 0
CreateNewUserAsyncVV1 C
(VVC D

Model_UserVVD N
userVVO S
,VVS T
stringVVU [
	createdByVV\ e
)VVe f
{WW 	
tryXX 
{YY 
usingZZ 
varZZ 

connectionZZ $
=ZZ% &
newZZ' *
MySqlConnectionZZ+ :
(ZZ: ;
_connectionStringZZ; L
)ZZL M
;ZZM N
await[[ 

connection[[  
.[[  !
	OpenAsync[[! *
([[* +
)[[+ ,
;[[, -
using]] 
var]] 
command]] !
=]]" #
new]]$ '
MySqlCommand]]( 4
(]]4 5
$str]]5 G
,]]G H

connection]]I S
)]]S T
{^^ 
CommandType__ 
=__  !
CommandType__" -
.__- .
StoredProcedure__. =
}`` 
;`` 
commandcc 
.cc 

Parameterscc "
.cc" #
AddWithValuecc# /
(cc/ 0
$strcc0 D
,ccD E
userccF J
.ccJ K
EmployeeNumberccK Y
)ccY Z
;ccZ [
commanddd 
.dd 

Parametersdd "
.dd" #
AddWithValuedd# /
(dd/ 0
$strdd0 E
,ddE F
userddG K
.ddK L
WindowsUsernameddL [
)dd[ \
;dd\ ]
commandee 
.ee 

Parametersee "
.ee" #
AddWithValueee# /
(ee/ 0
$stree0 >
,ee> ?
useree@ D
.eeD E
FullNameeeE M
)eeM N
;eeN O
commandff 
.ff 

Parametersff "
.ff" #
AddWithValueff# /
(ff/ 0
$strff0 8
,ff8 9
userff: >
.ff> ?
Pinff? B
)ffB C
;ffC D
commandgg 
.gg 

Parametersgg "
.gg" #
AddWithValuegg# /
(gg/ 0
$strgg0 ?
,gg? @
userggA E
.ggE F

DepartmentggF P
)ggP Q
;ggQ R
commandhh 
.hh 

Parametershh "
.hh" #
AddWithValuehh# /
(hh/ 0
$strhh0 :
,hh: ;
userhh< @
.hh@ A
ShifthhA F
)hhF G
;hhG H
commandii 
.ii 

Parametersii "
.ii" #
AddWithValueii# /
(ii/ 0
$strii0 ?
,ii? @
	createdByiiA J
)iiJ K
;iiK L
commandjj 
.jj 

Parametersjj "
.jj" #
AddWithValuejj# /
(jj/ 0
$strjj0 D
,jjD E
userjjF J
.jjJ K
VisualUsernamejjK Y
??jjZ \
(jj] ^
objectjj^ d
)jjd e
DBNulljje k
.jjk l
Valuejjl q
)jjq r
;jjr s
commandkk 
.kk 

Parameterskk "
.kk" #
AddWithValuekk# /
(kk/ 0
$strkk0 D
,kkD E
userkkF J
.kkJ K
VisualPasswordkkK Y
??kkZ \
(kk] ^
objectkk^ d
)kkd e
DBNullkke k
.kkk l
Valuekkl q
)kkq r
;kkr s
varnn 
errorMessageParamnn %
=nn& '
newnn( +
MySqlParameternn, :
(nn: ;
$strnn; M
,nnM N
MySqlDbTypennO Z
.nnZ [
VarCharnn[ b
,nnb c
$numnnd g
)nng h
{oo 
	Directionpp 
=pp 
ParameterDirectionpp  2
.pp2 3
Outputpp3 9
}qq 
;qq 
commandrr 
.rr 

Parametersrr "
.rr" #
Addrr# &
(rr& '
errorMessageParamrr' 8
)rr8 9
;rr9 :
awaittt 
commandtt 
.tt  
ExecuteNonQueryAsynctt 2
(tt2 3
)tt3 4
;tt4 5
varww 
errorMessageww  
=ww! "
errorMessageParamww# 4
.ww4 5
Valueww5 :
?ww: ;
.ww; <
ToStringww< D
(wwD E
)wwE F
;wwF G
ifxx 
(xx 
!xx 
stringxx 
.xx 
IsNullOrEmptyxx )
(xx) *
errorMessagexx* 6
)xx6 7
)xx7 8
{yy 
returnzz $
Model_Dao_Result_Factoryzz 3
.zz3 4
Failurezz4 ;
<zz; <
intzz< ?
>zz? @
(zz@ A
errorMessagezzA M
)zzM N
;zzN O
}{{ 
return~~ $
Model_Dao_Result_Factory~~ /
.~~/ 0
Success~~0 7
<~~7 8
int~~8 ;
>~~; <
(~~< =
user~~= A
.~~A B
EmployeeNumber~~B P
)~~P Q
;~~Q R
} 
catch
ÄÄ 
(
ÄÄ 
MySqlException
ÄÄ !
ex
ÄÄ" $
)
ÄÄ$ %
{
ÅÅ 
return
ÇÇ &
Model_Dao_Result_Factory
ÇÇ /
.
ÇÇ/ 0
Failure
ÇÇ0 7
<
ÇÇ7 8
int
ÇÇ8 ;
>
ÇÇ; <
(
ÇÇ< =
$"
ÇÇ= ?
$str
ÇÇ? O
{
ÇÇO P
ex
ÇÇP R
.
ÇÇR S
Message
ÇÇS Z
}
ÇÇZ [
"
ÇÇ[ \
,
ÇÇ\ ]
ex
ÇÇ^ `
)
ÇÇ` a
;
ÇÇa b
}
ÉÉ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
ex
ÑÑ 
)
ÑÑ  
{
ÖÖ 
return
ÜÜ &
Model_Dao_Result_Factory
ÜÜ /
.
ÜÜ/ 0
Failure
ÜÜ0 7
<
ÜÜ7 8
int
ÜÜ8 ;
>
ÜÜ; <
(
ÜÜ< =
$"
ÜÜ= ?
$str
ÜÜ? Q
{
ÜÜQ R
ex
ÜÜR T
.
ÜÜT U
Message
ÜÜU \
}
ÜÜ\ ]
"
ÜÜ] ^
,
ÜÜ^ _
ex
ÜÜ` b
)
ÜÜb c
;
ÜÜc d
}
áá 
}
àà 	
public
îî 
async
îî 
Task
îî 
<
îî 
Model_Dao_Result
îî *
<
îî* +
bool
îî+ /
>
îî/ 0
>
îî0 1
IsPinUniqueAsync
îî2 B
(
îîB C
string
îîC I
pin
îîJ M
,
îîM N
int
îîO R
?
îîR S#
excludeEmployeeNumber
îîT i
=
îîj k
null
îîl p
)
îîp q
{
ïï 	
try
ññ 
{
óó 
using
òò 
var
òò 

connection
òò $
=
òò% &
new
òò' *
MySqlConnection
òò+ :
(
òò: ;
_connectionString
òò; L
)
òòL M
;
òòM N
await
ôô 

connection
ôô  
.
ôô  !
	OpenAsync
ôô! *
(
ôô* +
)
ôô+ ,
;
ôô, -
var
õõ 
query
õõ 
=
õõ #
excludeEmployeeNumber
õõ 1
.
õõ1 2
HasValue
õõ2 :
?
úú 
$str
úú e
:
ùù 
$str
ùù C
;
ùùC D
using
üü 
var
üü 
command
üü !
=
üü" #
new
üü$ '
MySqlCommand
üü( 4
(
üü4 5
query
üü5 :
,
üü: ;

connection
üü< F
)
üüF G
;
üüG H
command
†† 
.
†† 

Parameters
†† "
.
††" #
AddWithValue
††# /
(
††/ 0
$str
††0 6
,
††6 7
pin
††8 ;
)
††; <
;
††< =
if
¢¢ 
(
¢¢ #
excludeEmployeeNumber
¢¢ )
.
¢¢) *
HasValue
¢¢* 2
)
¢¢2 3
{
££ 
command
§§ 
.
§§ 

Parameters
§§ &
.
§§& '
AddWithValue
§§' 3
(
§§3 4
$str
§§4 @
,
§§@ A#
excludeEmployeeNumber
§§B W
.
§§W X
Value
§§X ]
)
§§] ^
;
§§^ _
}
•• 
var
ßß 
count
ßß 
=
ßß 
Convert
ßß #
.
ßß# $
ToInt32
ßß$ +
(
ßß+ ,
await
ßß, 1
command
ßß2 9
.
ßß9 : 
ExecuteScalarAsync
ßß: L
(
ßßL M
)
ßßM N
)
ßßN O
;
ßßO P
var
®® 
isUnique
®® 
=
®® 
count
®® $
==
®®% '
$num
®®( )
;
®®) *
return
™™ &
Model_Dao_Result_Factory
™™ /
.
™™/ 0
Success
™™0 7
<
™™7 8
bool
™™8 <
>
™™< =
(
™™= >
isUnique
™™> F
)
™™F G
;
™™G H
}
´´ 
catch
¨¨ 
(
¨¨ 
MySqlException
¨¨ !
ex
¨¨" $
)
¨¨$ %
{
≠≠ 
return
ÆÆ &
Model_Dao_Result_Factory
ÆÆ /
.
ÆÆ/ 0
Failure
ÆÆ0 7
<
ÆÆ7 8
bool
ÆÆ8 <
>
ÆÆ< =
(
ÆÆ= >
$"
ÆÆ> @
$str
ÆÆ@ P
{
ÆÆP Q
ex
ÆÆQ S
.
ÆÆS T
Message
ÆÆT [
}
ÆÆ[ \
"
ÆÆ\ ]
,
ÆÆ] ^
ex
ÆÆ_ a
)
ÆÆa b
;
ÆÆb c
}
ØØ 
catch
∞∞ 
(
∞∞ 
	Exception
∞∞ 
ex
∞∞ 
)
∞∞  
{
±± 
return
≤≤ &
Model_Dao_Result_Factory
≤≤ /
.
≤≤/ 0
Failure
≤≤0 7
<
≤≤7 8
bool
≤≤8 <
>
≤≤< =
(
≤≤= >
$"
≤≤> @
$str
≤≤@ R
{
≤≤R S
ex
≤≤S U
.
≤≤U V
Message
≤≤V ]
}
≤≤] ^
"
≤≤^ _
,
≤≤_ `
ex
≤≤a c
)
≤≤c d
;
≤≤d e
}
≥≥ 
}
¥¥ 	
public
ºº 
async
ºº 
Task
ºº 
<
ºº 
Model_Dao_Result
ºº *
<
ºº* +
bool
ºº+ /
>
ºº/ 0
>
ºº0 1*
IsWindowsUsernameUniqueAsync
ºº2 N
(
ººN O
string
ººO U
username
ººV ^
,
ºº^ _
int
ºº` c
?
ººc d#
excludeEmployeeNumber
ººe z
=
ºº{ |
nullºº} Å
)ººÅ Ç
{
ΩΩ 	
try
ææ 
{
øø 
using
¿¿ 
var
¿¿ 

connection
¿¿ $
=
¿¿% &
new
¿¿' *
MySqlConnection
¿¿+ :
(
¿¿: ;
_connectionString
¿¿; L
)
¿¿L M
;
¿¿M N
await
¡¡ 

connection
¡¡  
.
¡¡  !
	OpenAsync
¡¡! *
(
¡¡* +
)
¡¡+ ,
;
¡¡, -
var
√√ 
query
√√ 
=
√√ #
excludeEmployeeNumber
√√ 1
.
√√1 2
HasValue
√√2 :
?
ƒƒ 
$str
ƒƒ w
:
≈≈ 
$str
≈≈ U
;
≈≈U V
using
«« 
var
«« 
command
«« !
=
««" #
new
««$ '
MySqlCommand
««( 4
(
««4 5
query
««5 :
,
««: ;

connection
««< F
)
««F G
;
««G H
command
»» 
.
»» 

Parameters
»» "
.
»»" #
AddWithValue
»»# /
(
»»/ 0
$str
»»0 ;
,
»»; <
username
»»= E
)
»»E F
;
»»F G
if
   
(
   #
excludeEmployeeNumber
   )
.
  ) *
HasValue
  * 2
)
  2 3
{
ÀÀ 
command
ÃÃ 
.
ÃÃ 

Parameters
ÃÃ &
.
ÃÃ& '
AddWithValue
ÃÃ' 3
(
ÃÃ3 4
$str
ÃÃ4 @
,
ÃÃ@ A#
excludeEmployeeNumber
ÃÃB W
.
ÃÃW X
Value
ÃÃX ]
)
ÃÃ] ^
;
ÃÃ^ _
}
ÕÕ 
var
œœ 
count
œœ 
=
œœ 
Convert
œœ #
.
œœ# $
ToInt32
œœ$ +
(
œœ+ ,
await
œœ, 1
command
œœ2 9
.
œœ9 : 
ExecuteScalarAsync
œœ: L
(
œœL M
)
œœM N
)
œœN O
;
œœO P
var
–– 
isUnique
–– 
=
–– 
count
–– $
==
––% '
$num
––( )
;
––) *
return
““ &
Model_Dao_Result_Factory
““ /
.
““/ 0
Success
““0 7
<
““7 8
bool
““8 <
>
““< =
(
““= >
isUnique
““> F
)
““F G
;
““G H
}
”” 
catch
‘‘ 
(
‘‘ 
MySqlException
‘‘ !
ex
‘‘" $
)
‘‘$ %
{
’’ 
return
÷÷ &
Model_Dao_Result_Factory
÷÷ /
.
÷÷/ 0
Failure
÷÷0 7
<
÷÷7 8
bool
÷÷8 <
>
÷÷< =
(
÷÷= >
$"
÷÷> @
$str
÷÷@ P
{
÷÷P Q
ex
÷÷Q S
.
÷÷S T
Message
÷÷T [
}
÷÷[ \
"
÷÷\ ]
,
÷÷] ^
ex
÷÷_ a
)
÷÷a b
;
÷÷b c
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
ŸŸ 
return
⁄⁄ &
Model_Dao_Result_Factory
⁄⁄ /
.
⁄⁄/ 0
Failure
⁄⁄0 7
<
⁄⁄7 8
bool
⁄⁄8 <
>
⁄⁄< =
(
⁄⁄= >
$"
⁄⁄> @
$str
⁄⁄@ R
{
⁄⁄R S
ex
⁄⁄S U
.
⁄⁄U V
Message
⁄⁄V ]
}
⁄⁄] ^
"
⁄⁄^ _
,
⁄⁄_ `
ex
⁄⁄a c
)
⁄⁄c d
;
⁄⁄d e
}
€€ 
}
‹‹ 	
public
ÍÍ 
async
ÍÍ 
Task
ÍÍ 
<
ÍÍ 
Model_Dao_Result
ÍÍ *
<
ÍÍ* +
bool
ÍÍ+ /
>
ÍÍ/ 0
>
ÍÍ0 1"
LogUserActivityAsync
ÍÍ2 F
(
ÍÍF G
string
ÎÎ 
	eventType
ÎÎ 
,
ÎÎ 
string
ÏÏ 
username
ÏÏ 
,
ÏÏ 
string
ÌÌ 
workstationName
ÌÌ "
,
ÌÌ" #
string
ÓÓ 
details
ÓÓ 
)
ÓÓ 
{
ÔÔ 	
var
 

parameters
 
=
 
new
  

Dictionary
! +
<
+ ,
string
, 2
,
2 3
object
4 :
>
: ;
{
ÒÒ 
{
ÚÚ 
$str
ÚÚ !
,
ÚÚ! "
	eventType
ÚÚ# ,
}
ÚÚ- .
,
ÚÚ. /
{
ÛÛ 
$str
ÛÛ 
,
ÛÛ  
username
ÛÛ! )
??
ÛÛ* ,
(
ÛÛ- .
object
ÛÛ. 4
)
ÛÛ4 5
DBNull
ÛÛ5 ;
.
ÛÛ; <
Value
ÛÛ< A
}
ÛÛB C
,
ÛÛC D
{
ÙÙ 
$str
ÙÙ '
,
ÙÙ' (
workstationName
ÙÙ) 8
??
ÙÙ9 ;
(
ÙÙ< =
object
ÙÙ= C
)
ÙÙC D
DBNull
ÙÙD J
.
ÙÙJ K
Value
ÙÙK P
}
ÙÙQ R
,
ÙÙR S
{
ıı 
$str
ıı 
,
ıı 
details
ıı  '
??
ıı( *
(
ıı+ ,
object
ıı, 2
)
ıı2 3
DBNull
ıı3 9
.
ıı9 :
Value
ıı: ?
}
ıı@ A
}
ˆˆ 
;
ˆˆ 
var
¯¯ 
result
¯¯ 
=
¯¯ 
await
¯¯ -
Helper_Database_StoredProcedure
¯¯ >
.
¯¯> ?"
ExecuteNonQueryAsync
¯¯? S
(
¯¯S T
_connectionString
˘˘ !
,
˘˘! "
$str
˙˙ $
,
˙˙$ %

parameters
˚˚ 
)
¸¸ 
;
¸¸ 
if
˛˛ 
(
˛˛ 
result
˛˛ 
.
˛˛ 
Success
˛˛ 
)
˛˛ 
{
ˇˇ 
return
ÄÄ &
Model_Dao_Result_Factory
ÄÄ /
.
ÄÄ/ 0
Success
ÄÄ0 7
<
ÄÄ7 8
bool
ÄÄ8 <
>
ÄÄ< =
(
ÄÄ= >
true
ÄÄ> B
)
ÄÄB C
;
ÄÄC D
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 
return
ÑÑ &
Model_Dao_Result_Factory
ÑÑ /
.
ÑÑ/ 0
Failure
ÑÑ0 7
<
ÑÑ7 8
bool
ÑÑ8 <
>
ÑÑ< =
(
ÑÑ= >
result
ÑÑ> D
.
ÑÑD E
ErrorMessage
ÑÑE Q
,
ÑÑQ R
result
ÑÑS Y
.
ÑÑY Z
	Exception
ÑÑZ c
)
ÑÑc d
;
ÑÑd e
}
ÖÖ 
}
ÜÜ 	
public
êê 
async
êê 
Task
êê 
<
êê 
Model_Dao_Result
êê *
<
êê* +
List
êê+ /
<
êê/ 0
string
êê0 6
>
êê6 7
>
êê7 8
>
êê8 9)
GetSharedTerminalNamesAsync
êê: U
(
êêU V
)
êêV W
{
ëë 	
return
íí 
await
íí -
Helper_Database_StoredProcedure
íí 8
.
íí8 9
ExecuteListAsync
íí9 I
(
ííI J
_connectionString
ìì !
,
ìì! "
$str
îî +
,
îî+ ,
reader
ïï 
=>
ïï 
reader
ïï  
.
ïï  !
	GetString
ïï! *
(
ïï* +
reader
ïï+ 1
.
ïï1 2

GetOrdinal
ïï2 <
(
ïï< =
$str
ïï= O
)
ïïO P
)
ïïP Q
)
ññ 
;
ññ 
}
óó 	
public
ùù 
async
ùù 
Task
ùù 
<
ùù 
Model_Dao_Result
ùù *
<
ùù* +
List
ùù+ /
<
ùù/ 0
string
ùù0 6
>
ùù6 7
>
ùù7 8
>
ùù8 9'
GetActiveDepartmentsAsync
ùù: S
(
ùùS T
)
ùùT U
{
ûû 	
return
üü 
await
üü -
Helper_Database_StoredProcedure
üü 8
.
üü8 9
ExecuteListAsync
üü9 I
(
üüI J
_connectionString
†† !
,
††! "
$str
°° #
,
°°# $
reader
¢¢ 
=>
¢¢ 
reader
¢¢  
.
¢¢  !
	GetString
¢¢! *
(
¢¢* +
reader
¢¢+ 1
.
¢¢1 2

GetOrdinal
¢¢2 <
(
¢¢< =
$str
¢¢= N
)
¢¢N O
)
¢¢O P
)
££ 
;
££ 
}
§§ 	
private
≠≠ 

Model_User
≠≠ 
MapReaderToUser
≠≠ *
(
≠≠* +
IDataReader
≠≠+ 6
reader
≠≠7 =
)
≠≠= >
{
ÆÆ 	
return
ØØ 
new
ØØ 

Model_User
ØØ !
{
∞∞ 
EmployeeNumber
±± 
=
±±  
reader
±±! '
.
±±' (
GetInt32
±±( 0
(
±±0 1
reader
±±1 7
.
±±7 8

GetOrdinal
±±8 B
(
±±B C
$str
±±C T
)
±±T U
)
±±U V
,
±±V W
WindowsUsername
≤≤ 
=
≤≤  !
reader
≤≤" (
.
≤≤( )
	GetString
≤≤) 2
(
≤≤2 3
reader
≤≤3 9
.
≤≤9 :

GetOrdinal
≤≤: D
(
≤≤D E
$str
≤≤E W
)
≤≤W X
)
≤≤X Y
,
≤≤Y Z
FullName
≥≥ 
=
≥≥ 
reader
≥≥ !
.
≥≥! "
	GetString
≥≥" +
(
≥≥+ ,
reader
≥≥, 2
.
≥≥2 3

GetOrdinal
≥≥3 =
(
≥≥= >
$str
≥≥> I
)
≥≥I J
)
≥≥J K
,
≥≥K L
Pin
¥¥ 
=
¥¥ 
reader
¥¥ 
.
¥¥ 
	GetString
¥¥ &
(
¥¥& '
reader
¥¥' -
.
¥¥- .

GetOrdinal
¥¥. 8
(
¥¥8 9
$str
¥¥9 >
)
¥¥> ?
)
¥¥? @
,
¥¥@ A

Department
µµ 
=
µµ 
reader
µµ #
.
µµ# $
	GetString
µµ$ -
(
µµ- .
reader
µµ. 4
.
µµ4 5

GetOrdinal
µµ5 ?
(
µµ? @
$str
µµ@ L
)
µµL M
)
µµM N
,
µµN O
Shift
∂∂ 
=
∂∂ 
reader
∂∂ 
.
∂∂ 
	GetString
∂∂ (
(
∂∂( )
reader
∂∂) /
.
∂∂/ 0

GetOrdinal
∂∂0 :
(
∂∂: ;
$str
∂∂; B
)
∂∂B C
)
∂∂C D
,
∂∂D E
IsActive
∑∑ 
=
∑∑ 
reader
∑∑ !
.
∑∑! "

GetBoolean
∑∑" ,
(
∑∑, -
reader
∑∑- 3
.
∑∑3 4

GetOrdinal
∑∑4 >
(
∑∑> ?
$str
∑∑? J
)
∑∑J K
)
∑∑K L
,
∑∑L M
VisualUsername
∏∏ 
=
∏∏  
reader
∏∏! '
.
∏∏' (
IsDBNull
∏∏( 0
(
∏∏0 1
reader
∏∏1 7
.
∏∏7 8

GetOrdinal
∏∏8 B
(
∏∏B C
$str
∏∏C T
)
∏∏T U
)
∏∏U V
?
ππ 
null
ππ 
:
∫∫ 
reader
∫∫ 
.
∫∫ 
	GetString
∫∫ &
(
∫∫& '
reader
∫∫' -
.
∫∫- .

GetOrdinal
∫∫. 8
(
∫∫8 9
$str
∫∫9 J
)
∫∫J K
)
∫∫K L
,
∫∫L M
VisualPassword
ªª 
=
ªª  
reader
ªª! '
.
ªª' (
IsDBNull
ªª( 0
(
ªª0 1
reader
ªª1 7
.
ªª7 8

GetOrdinal
ªª8 B
(
ªªB C
$str
ªªC T
)
ªªT U
)
ªªU V
?
ºº 
null
ºº 
:
ΩΩ 
reader
ΩΩ 
.
ΩΩ 
	GetString
ΩΩ &
(
ΩΩ& '
reader
ΩΩ' -
.
ΩΩ- .

GetOrdinal
ΩΩ. 8
(
ΩΩ8 9
$str
ΩΩ9 J
)
ΩΩJ K
)
ΩΩK L
,
ΩΩL M"
DefaultReceivingMode
ææ $
=
ææ% &(
TryGetDefaultReceivingMode
ææ' A
(
ææA B
reader
ææB H
)
ææH I
,
ææI J
CreatedDate
øø 
=
øø 
reader
øø $
.
øø$ %
GetDateTime
øø% 0
(
øø0 1
reader
øø1 7
.
øø7 8

GetOrdinal
øø8 B
(
øøB C
$str
øøC Q
)
øøQ R
)
øøR S
,
øøS T
	CreatedBy
¿¿ 
=
¿¿ 
reader
¿¿ "
.
¿¿" #
IsDBNull
¿¿# +
(
¿¿+ ,
reader
¿¿, 2
.
¿¿2 3

GetOrdinal
¿¿3 =
(
¿¿= >
$str
¿¿> J
)
¿¿J K
)
¿¿K L
?
¡¡ 
null
¡¡ 
:
¬¬ 
reader
¬¬ 
.
¬¬ 
	GetString
¬¬ &
(
¬¬& '
reader
¬¬' -
.
¬¬- .

GetOrdinal
¬¬. 8
(
¬¬8 9
$str
¬¬9 E
)
¬¬E F
)
¬¬F G
,
¬¬G H
ModifiedDate
√√ 
=
√√ 
reader
√√ %
.
√√% &
GetDateTime
√√& 1
(
√√1 2
reader
√√2 8
.
√√8 9

GetOrdinal
√√9 C
(
√√C D
$str
√√D S
)
√√S T
)
√√T U
}
ƒƒ 
;
ƒƒ 
}
≈≈ 	
public
   
async
   
Task
   
<
   
Model_Dao_Result
   *
>
  * +$
UpdateDefaultModeAsync
  , B
(
  B C
int
  C F
userId
  G M
,
  M N
string
  O U
?
  U V
defaultMode
  W b
)
  b c
{
ÀÀ 	
var
ÃÃ 

parameters
ÃÃ 
=
ÃÃ 
new
ÃÃ  

Dictionary
ÃÃ! +
<
ÃÃ+ ,
string
ÃÃ, 2
,
ÃÃ2 3
object
ÃÃ4 :
>
ÃÃ: ;
{
ÕÕ 
{
ŒŒ 
$str
ŒŒ 
,
ŒŒ 
userId
ŒŒ  &
}
ŒŒ' (
,
ŒŒ( )
{
œœ 
$str
œœ #
,
œœ# $
(
œœ% &
object
œœ& ,
?
œœ, -
)
œœ- .
defaultMode
œœ. 9
??
œœ: <
DBNull
œœ= C
.
œœC D
Value
œœD I
}
œœJ K
}
–– 
;
–– 
return
““ 
await
““ -
Helper_Database_StoredProcedure
““ 8
.
““8 9"
ExecuteNonQueryAsync
““9 M
(
““M N
_connectionString
”” !
,
””! "
$str
‘‘ -
,
‘‘- .

parameters
’’ 
)
÷÷ 
;
÷÷ 
}
◊◊ 	
private
‹‹ 
static
‹‹ 
string
‹‹ 
?
‹‹ (
TryGetDefaultReceivingMode
‹‹ 9
(
‹‹9 :
IDataReader
‹‹: E
reader
‹‹F L
)
‹‹L M
{
›› 	
try
ﬁﬁ 
{
ﬂﬂ 
var
‡‡ 
ordinal
‡‡ 
=
‡‡ 
reader
‡‡ $
.
‡‡$ %

GetOrdinal
‡‡% /
(
‡‡/ 0
$str
‡‡0 H
)
‡‡H I
;
‡‡I J
return
·· 
reader
·· 
.
·· 
IsDBNull
·· &
(
··& '
ordinal
··' .
)
··. /
?
··0 1
null
··2 6
:
··7 8
reader
··9 ?
.
··? @
	GetString
··@ I
(
··I J
ordinal
··J Q
)
··Q R
;
··R S
}
‚‚ 
catch
„„ 
(
„„ &
IndexOutOfRangeException
„„ +
)
„„+ ,
{
‰‰ 
return
ÊÊ 
null
ÊÊ 
;
ÊÊ 
}
ÁÁ 
}
ËË 	
}
ÈÈ 
}ÍÍ Ør
cC:\Users\johnk\source\repos\MTM_Receiving_Application\Database\Deploy\DeployAuthenticationSchema.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
Database$ ,
., -
Deploy- 3
{ 
public 

class &
DeployAuthenticationSchema +
{ 
private 
const 
string 
ConnectionString -
=. /
$str	0 Ç
;
Ç É
public 
static 
async 
Task  
DeployAsync! ,
(, -
)- .
{ 	
Console 
. 
	WriteLine 
( 
$str !
.! "
PadRight" *
(* +
$num+ -
,- .
$char/ 2
)2 3
)3 4
;4 5
Console 
. 
	WriteLine 
( 
$str @
)@ A
;A B
Console 
. 
	WriteLine 
( 
$str !
.! "
PadRight" *
(* +
$num+ -
,- .
$char/ 2
)2 3
)3 4
;4 5
Console 
. 
	WriteLine 
( 
) 
;  
try 
{ 
Console 
. 
	WriteLine !
(! "
$str" C
)C D
;D E
await 
DeploySchemaAsync '
(' (
)( )
;) *
Console 
. 
	WriteLine !
(! "
$str" E
)E F
;F G
Console 
. 
	WriteLine !
(! "
)" #
;# $
Console   
.   
	WriteLine   !
(  ! "
$str  " E
)  E F
;  F G
await!! &
DeployStoredProcedureAsync!! 0
(!!0 1
$str!!1 R
)!!R S
;!!S T
await"" &
DeployStoredProcedureAsync"" 0
(""0 1
$str""1 I
)""I J
;""J K
await## &
DeployStoredProcedureAsync## 0
(##0 1
$str##1 G
)##G H
;##H I
await$$ &
DeployStoredProcedureAsync$$ 0
($$0 1
$str$$1 I
)$$I J
;$$J K
await%% &
DeployStoredProcedureAsync%% 0
(%%0 1
$str%%1 P
)%%P Q
;%%Q R
await&& &
DeployStoredProcedureAsync&& 0
(&&0 1
$str&&1 H
)&&H I
;&&I J
Console'' 
.'' 
	WriteLine'' !
(''! "
$str''" T
)''T U
;''U V
Console(( 
.(( 
	WriteLine(( !
(((! "
)((" #
;((# $
Console++ 
.++ 
	WriteLine++ !
(++! "
$str++" >
)++> ?
;++? @
await,, !
VerifyDeploymentAsync,, +
(,,+ ,
),,, -
;,,- .
Console-- 
.-- 
	WriteLine-- !
(--! "
)--" #
;--# $
Console// 
.// 
	WriteLine// !
(//! "
$str//" %
.//% &
PadRight//& .
(//. /
$num/// 1
,//1 2
$char//3 6
)//6 7
)//7 8
;//8 9
Console00 
.00 
	WriteLine00 !
(00! "
$str00" H
)00H I
;00I J
Console11 
.11 
	WriteLine11 !
(11! "
$str11" %
.11% &
PadRight11& .
(11. /
$num11/ 1
,111 2
$char113 6
)116 7
)117 8
;118 9
}22 
catch33 
(33 
	Exception33 
ex33 
)33  
{44 
Console55 
.55 
	WriteLine55 !
(55! "
)55" #
;55# $
Console66 
.66 
	WriteLine66 !
(66! "
$str66" 8
)668 9
;669 :
Console77 
.77 
	WriteLine77 !
(77! "
$"77" $
$str77$ +
{77+ ,
ex77, .
.77. /
Message77/ 6
}776 7
"777 8
)778 9
;779 :
Console88 
.88 
	WriteLine88 !
(88! "
$"88" $
$str88$ -
{88- .
ex88. 0
}880 1
"881 2
)882 3
;883 4
Environment99 
.99 
Exit99  
(99  !
$num99! "
)99" #
;99# $
}:: 
};; 	
private== 
static== 
async== 
Task== !
DeploySchemaAsync==" 3
(==3 4
)==4 5
{>> 	
string?? 

schemaPath?? 
=?? 
Path??  $
.??$ %
Combine??% ,
(??, -
GetProjectRoot??- ;
(??; <
)??< =
,??= >
$str??? I
,??I J
$str??K T
,??T U
$str??V {
)??{ |
;??| }
string@@ 
sql@@ 
=@@ 
await@@ 
File@@ #
.@@# $
ReadAllTextAsync@@$ 4
(@@4 5

schemaPath@@5 ?
)@@? @
;@@@ A
awaitBB 
ExecuteSqlAsyncBB !
(BB! "
sqlBB" %
)BB% &
;BB& '
}CC 	
privateEE 
staticEE 
asyncEE 
TaskEE !&
DeployStoredProcedureAsyncEE" <
(EE< =
stringEE= C
fileNameEED L
)EEL M
{FF 	
ConsoleGG 
.GG 
	WriteLineGG 
(GG 
$"GG  
$strGG  /
{GG/ 0
fileNameGG0 8
}GG8 9
$strGG9 <
"GG< =
)GG= >
;GG> ?
stringHH 
procPathHH 
=HH 
PathHH "
.HH" #
CombineHH# *
(HH* +
GetProjectRootHH+ 9
(HH9 :
)HH: ;
,HH; <
$strHH= G
,HHG H
$strHHI [
,HH[ \
$strHH] m
,HHm n
fileNameHHo w
)HHw x
;HHx y
stringII 
sqlII 
=II 
awaitII 
FileII #
.II# $
ReadAllTextAsyncII$ 4
(II4 5
procPathII5 =
)II= >
;II> ?
awaitKK 
ExecuteSqlAsyncKK !
(KK! "
sqlKK" %
)KK% &
;KK& '
}LL 	
privateNN 
staticNN 
asyncNN 
TaskNN !
ExecuteSqlAsyncNN" 1
(NN1 2
stringNN2 8
sqlNN9 <
)NN< =
{OO 	
usingPP 
varPP 

connectionPP  
=PP! "
newPP# &
MySqlConnectionPP' 6
(PP6 7
ConnectionStringPP7 G
)PPG H
;PPH I
awaitQQ 

connectionQQ 
.QQ 
	OpenAsyncQQ &
(QQ& '
)QQ' (
;QQ( )
varTT 
batchesTT 
=TT 
sqlTT 
.TT 
SplitTT #
(TT# $
newTT$ '
[TT' (
]TT( )
{TT* +
$strTT, :
,TT: ;
$strTT< I
}TTJ K
,TTK L
StringSplitOptionsTTM _
.TT_ `
RemoveEmptyEntriesTT` r
)TTr s
;TTs t
foreachVV 
(VV 
varVV 
batchVV 
inVV !
batchesVV" )
)VV) *
{WW 
varXX 

cleanBatchXX 
=XX  
batchXX! &
.XX& '
TrimXX' +
(XX+ ,
)XX, -
;XX- .
ifYY 
(YY 
stringYY 
.YY 
IsNullOrWhiteSpaceYY -
(YY- .

cleanBatchYY. 8
)YY8 9
||YY: <

cleanBatchYY= G
.YYG H

StartsWithYYH R
(YYR S
$strYYS W
)YYW X
)YYX Y
continueYYZ b
;YYb c
using[[ 
var[[ 
command[[ !
=[[" #
new[[$ '
MySqlCommand[[( 4
([[4 5

cleanBatch[[5 ?
,[[? @

connection[[A K
)[[K L
;[[L M
command\\ 
.\\ 
CommandTimeout\\ &
=\\' (
$num\\) +
;\\+ ,
await]] 
command]] 
.]]  
ExecuteNonQueryAsync]] 2
(]]2 3
)]]3 4
;]]4 5
}^^ 
}__ 	
privateaa 
staticaa 
asyncaa 
Taskaa !!
VerifyDeploymentAsyncaa" 7
(aa7 8
)aa8 9
{bb 	
usingcc 
varcc 

connectioncc  
=cc! "
newcc# &
MySqlConnectioncc' 6
(cc6 7
ConnectionStringcc7 G
)ccG H
;ccH I
awaitdd 

connectiondd 
.dd 
	OpenAsyncdd &
(dd& '
)dd' (
;dd( )
vargg 
	tablesSqlgg 
=gg 
$strgj f
;jjf g
usingll 
varll 
cmd1ll 
=ll 
newll  
MySqlCommandll! -
(ll- .
	tablesSqlll. 7
,ll7 8

connectionll9 C
)llC D
;llD E
varmm 

tableCountmm 
=mm 
Convertmm $
.mm$ %
ToInt32mm% ,
(mm, -
awaitmm- 2
cmd1mm3 7
.mm7 8
ExecuteScalarAsyncmm8 J
(mmJ K
)mmK L
)mmL M
;mmM N
Consolenn 
.nn 
	WriteLinenn 
(nn 
$"nn  
$strnn  5
{nn5 6

tableCountnn6 @
}nn@ A
$strnnA C
"nnC D
)nnD E
;nnE F
varqq 
procsSqlqq 
=qq 
$strqv W
;vvW X
usingxx 
varxx 
cmd2xx 
=xx 
newxx  
MySqlCommandxx! -
(xx- .
procsSqlxx. 6
,xx6 7

connectionxx8 B
)xxB C
;xxC D
varyy 
	procCountyy 
=yy 
Convertyy #
.yy# $
ToInt32yy$ +
(yy+ ,
awaityy, 1
cmd2yy2 6
.yy6 7
ExecuteScalarAsyncyy7 I
(yyI J
)yyJ K
)yyK L
;yyL M
Consolezz 
.zz 
	WriteLinezz 
(zz 
$"zz  
$strzz  @
{zz@ A
	procCountzzA J
}zzJ K
$strzzK M
"zzM N
)zzN O
;zzO P
using}} 
var}} 
cmd3}} 
=}} 
new}}  
MySqlCommand}}! -
(}}- .
$str}}. P
,}}P Q

connection}}R \
)}}\ ]
;}}] ^
var~~ 
	deptCount~~ 
=~~ 
Convert~~ #
.~~# $
ToInt32~~$ +
(~~+ ,
await~~, 1
cmd3~~2 6
.~~6 7
ExecuteScalarAsync~~7 I
(~~I J
)~~J K
)~~K L
;~~L M
Console 
. 
	WriteLine 
( 
$"  
$str  2
{2 3
	deptCount3 <
}< =
"= >
)> ?
;? @
using
ÅÅ 
var
ÅÅ 
cmd4
ÅÅ 
=
ÅÅ 
new
ÅÅ  
MySqlCommand
ÅÅ! -
(
ÅÅ- .
$str
ÅÅ. W
,
ÅÅW X

connection
ÅÅY c
)
ÅÅc d
;
ÅÅd e
var
ÇÇ 
wsCount
ÇÇ 
=
ÇÇ 
Convert
ÇÇ !
.
ÇÇ! "
ToInt32
ÇÇ" )
(
ÇÇ) *
await
ÇÇ* /
cmd4
ÇÇ0 4
.
ÇÇ4 5 
ExecuteScalarAsync
ÇÇ5 G
(
ÇÇG H
)
ÇÇH I
)
ÇÇI J
;
ÇÇJ K
Console
ÉÉ 
.
ÉÉ 
	WriteLine
ÉÉ 
(
ÉÉ 
$"
ÉÉ  
$str
ÉÉ  >
{
ÉÉ> ?
wsCount
ÉÉ? F
}
ÉÉF G
"
ÉÉG H
)
ÉÉH I
;
ÉÉI J
using
ÖÖ 
var
ÖÖ 
cmd5
ÖÖ 
=
ÖÖ 
new
ÖÖ  
MySqlCommand
ÖÖ! -
(
ÖÖ- .
$str
ÖÖ. J
,
ÖÖJ K

connection
ÖÖL V
)
ÖÖV W
;
ÖÖW X
var
ÜÜ 
	userCount
ÜÜ 
=
ÜÜ 
Convert
ÜÜ #
.
ÜÜ# $
ToInt32
ÜÜ$ +
(
ÜÜ+ ,
await
ÜÜ, 1
cmd5
ÜÜ2 6
.
ÜÜ6 7 
ExecuteScalarAsync
ÜÜ7 I
(
ÜÜI J
)
ÜÜJ K
)
ÜÜK L
;
ÜÜL M
Console
áá 
.
áá 
	WriteLine
áá 
(
áá 
$"
áá  
$str
áá  1
{
áá1 2
	userCount
áá2 ;
}
áá; <
"
áá< =
)
áá= >
;
áá> ?
if
ââ 
(
ââ 

tableCount
ââ 
!=
ââ 
$num
ââ 
||
ââ  "
	procCount
ââ# ,
!=
ââ- /
$num
ââ0 1
)
ââ1 2
{
ää 
throw
ãã 
new
ãã 
	Exception
ãã #
(
ãã# $
$str
ãã$ ^
)
ãã^ _
;
ãã_ `
}
åå 
}
çç 	
private
èè 
static
èè 
string
èè 
GetProjectRoot
èè ,
(
èè, -
)
èè- .
{
êê 	
string
ëë 
?
ëë 

currentDir
ëë 
=
ëë  
	Directory
ëë! *
.
ëë* +!
GetCurrentDirectory
ëë+ >
(
ëë> ?
)
ëë? @
;
ëë@ A
while
íí 
(
íí 

currentDir
íí 
!=
íí  
null
íí! %
&&
íí& (
!
íí) *
File
íí* .
.
íí. /
Exists
íí/ 5
(
íí5 6
Path
íí6 :
.
íí: ;
Combine
íí; B
(
ííB C

currentDir
ííC M
,
ííM N
$str
ííO q
)
ííq r
)
íír s
)
íís t
{
ìì 

currentDir
îî 
=
îî 
	Directory
îî &
.
îî& '
	GetParent
îî' 0
(
îî0 1

currentDir
îî1 ;
)
îî; <
?
îî< =
.
îî= >
FullName
îî> F
;
îîF G
}
ïï 
return
ññ 

currentDir
ññ 
??
ññ  
throw
ññ! &
new
ññ' *
	Exception
ññ+ 4
(
ññ4 5
$str
ññ5 R
)
ññR S
;
ññS T
}
óó 	
}
òò 
}ôô ˇ
ZC:\Users\johnk\source\repos\MTM_Receiving_Application\Converters\Converter_StringFormat.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

Converters$ .
{ 
public 

class "
Converter_StringFormat '
:( )
IValueConverter* 9
{ 
public 
object 
Convert 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{		 	
if

 
(

 
	parameter

 
is

 
string

 #
format

$ *
)

* +
{ 
return 
string 
. 
Format $
($ %
format% +
,+ ,
value- 2
)2 3
;3 4
} 
return 
value 
; 
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
stringS Y
languageZ b
)b c
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
} 
} €
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Converters\Converter_IntToVisibility.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

Converters$ .
{ 
public 

class %
Converter_IntToVisibility *
:+ ,
IValueConverter- <
{ 
public		 
object		 
Convert		 
(		 
object		 $
value		% *
,		* +
Type		, 0

targetType		1 ;
,		; <
object		= C
	parameter		D M
,		M N
string		O U
language		V ^
)		^ _
{

 	
int 
intValue 
= 
value  
is! #
int$ '
i( )
?* +
i, -
:. /
$num0 1
;1 2
bool 
	isVisible 
= 
intValue %
>& '
$num( )
;) *
if 
( 
	parameter 
is 
string #
s$ %
&&& (
s) *
.* +
Equals+ 1
(1 2
$str2 ;
,; <
StringComparison= M
.M N
OrdinalIgnoreCaseN _
)_ `
)` a
{ 
	isVisible 
= 
! 
	isVisible &
;& '
} 
return 
	isVisible 
? 

Visibility )
.) *
Visible* 1
:2 3

Visibility4 >
.> ?
	Collapsed? H
;H I
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
stringS Y
languageZ b
)b c
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
} 
} ˙
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Converters\Converter_DoubleToDecimal.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

Converters$ .
{ 
public 

class %
Converter_DoubleToDecimal *
:+ ,
IValueConverter- <
{ 
public 
object 
Convert 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{		 	
if

 
(

 
value

 
is

 
decimal

  
d

! "
)

" #
{ 
return 
System 
. 
Convert %
.% &
ToDouble& .
(. /
d/ 0
)0 1
;1 2
} 
return 
$num 
; 
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
stringS Y
languageZ b
)b c
{ 	
if 
( 
value 
is 
double 
d  !
)! "
{ 
return 
System 
. 
Convert %
.% &
	ToDecimal& /
(/ 0
d0 1
)1 2
;2 3
} 
return 
$num 
; 
} 	
} 
} Û
]C:\Users\johnk\source\repos\MTM_Receiving_Application\Converters\Converter_DecimalToString.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

Converters$ .
{ 
public 

class %
Converter_DecimalToString *
:+ ,
IValueConverter- <
{ 
public 
object 
Convert 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{		 	
if

 
(

 
value

 
is

 
decimal

  
d

! "
)

" #
{ 
return 
d 
== 
$num 
? 
string  &
.& '
Empty' ,
:- .
d/ 0
.0 1
ToString1 9
(9 :
$str: ?
)? @
;@ A
} 
return 
string 
. 
Empty 
;  
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
stringS Y
languageZ b
)b c
{ 	
if 
( 
value 
is 
string 
s  !
)! "
{ 
if 
( 
string 
. 
IsNullOrWhiteSpace -
(- .
s. /
)/ 0
)0 1
{ 
return 
$num 
; 
} 
if 
( 
decimal 
. 
TryParse $
($ %
s% &
,& '
out( +
decimal, 3
result4 :
): ;
); <
{ 
return 
result !
;! "
} 
} 
return 
$num 
; 
} 	
}   
}!! í
ZC:\Users\johnk\source\repos\MTM_Receiving_Application\Converters\Converter_DecimalToInt.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

Converters$ .
{ 
public		 

class		 "
Converter_DecimalToInt		 '
:		( )
IValueConverter		* 9
{

 
public 
object 
Convert 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{ 	
if 
( 
value 
is 
decimal  
decimalValue! -
)- .
{ 
return 
( 
( 
int 
) 
decimalValue )
)) *
.* +
ToString+ 3
(3 4
$str4 8
)8 9
;9 :
} 
if 
( 
value 
is 
double 
doubleValue  +
)+ ,
{ 
return 
( 
( 
int 
) 
doubleValue (
)( )
.) *
ToString* 2
(2 3
$str3 7
)7 8
;8 9
} 
if 
( 
value 
is 
float 

floatValue )
)) *
{ 
return 
( 
( 
int 
) 

floatValue '
)' (
.( )
ToString) 1
(1 2
$str2 6
)6 7
;7 8
} 
return 
value 
? 
. 
ToString "
(" #
)# $
??% '
string( .
.. /
Empty/ 4
;4 5
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
stringS Y
languageZ b
)b c
{ 	
if 
( 
value 
is 
string 
strValue  (
&&) +
decimal, 3
.3 4
TryParse4 <
(< =
strValue= E
,E F
outG J
decimalK R
resultS Y
)Y Z
)Z [
{ 
return   
result   
;   
}!! 
return"" 
$num"" 
;"" 
}## 	
}$$ 
}%% »
aC:\Users\johnk\source\repos\MTM_Receiving_Application\Converters\Converter_BooleanToVisibility.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

Converters$ .
{ 
public 

class )
Converter_BooleanToVisibility .
:/ 0
IValueConverter1 @
{ 
public		 
object		 
Convert		 
(		 
object		 $
value		% *
,		* +
Type		, 0

targetType		1 ;
,		; <
object		= C
	parameter		D M
,		M N
string		O U
language		V ^
)		^ _
{

 	
bool 
	boolValue 
= 
value "
is# %
bool& *
b+ ,
&&- /
b0 1
;1 2
if 
( 
	parameter 
is 
string #
s$ %
&&& (
s) *
.* +
Equals+ 1
(1 2
$str2 ;
,; <
StringComparison= M
.M N
OrdinalIgnoreCaseN _
)_ `
)` a
{ 
	boolValue 
= 
! 
	boolValue &
;& '
} 
return 
	boolValue 
? 

Visibility )
.) *
Visible* 1
:2 3

Visibility4 >
.> ?
	Collapsed? H
;H I
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
stringS Y
languageZ b
)b c
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
} 
} ˙
ZC:\Users\johnk\source\repos\MTM_Receiving_Application\Converters\Converter_BoolToString.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $

Converters$ .
{ 
public 

class "
Converter_BoolToString '
:( )
IValueConverter* 9
{ 
public 
object 
Convert 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
stringO U
languageV ^
)^ _
{		 	
if

 
(

 
value

 
is

 
bool

 
	boolValue

 '
&&

( *
	parameter

+ 4
is

5 7
string

8 >
paramString

? J
)

J K
{ 
var 
parts 
= 
paramString '
.' (
Split( -
(- .
$char. 1
)1 2
;2 3
if 
( 
parts 
. 
Length  
==! #
$num$ %
)% &
{ 
return 
	boolValue $
?% &
parts' ,
[, -
$num- .
]. /
:0 1
parts2 7
[7 8
$num8 9
]9 :
;: ;
} 
} 
return 
value 
? 
. 
ToString "
(" #
)# $
??% '
string( .
.. /
Empty/ 4
;4 5
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
stringS Y
languageZ b
)b c
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
} 
} Ω
ZC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IWindowService.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
;6 7
public 
	interface 
IService_Window  
{ 
XamlRoot 
? 
GetXamlRoot 
( 
) 
; 
} Å
RC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\ITimer.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public		 

	interface		 $
IService_DispatcherTimer		 -
{

 
TimeSpan 
Interval 
{ 
get 
;  
set! $
;$ %
}& '
bool 
IsRepeating 
{ 
get 
; 
set  #
;# $
}% &
bool 
	IsRunning 
{ 
get 
; 
} 
event 
EventHandler 
< 
object !
>! "
Tick# '
;' (
void"" 
Start"" 
("" 
)"" 
;"" 
void'' 
Stop'' 
('' 
)'' 
;'' 
}(( 
})) Ë
gC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_UserSessionManager.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public

 

	interface

 '
IService_UserSessionManager

 0
{ 
Model_UserSession 
? 
CurrentSession )
{* +
get, /
;/ 0
}1 2
Model_UserSession 
CreateSession '
(' (

Model_User 
user 
, #
Model_WorkstationConfig #
workstationConfig$ 5
,5 6
string  
authenticationMethod '
)' (
;( )
void   
UpdateLastActivity   
(    
)    !
;  ! "
void%% "
StartTimeoutMonitoring%% #
(%%# $
)%%$ %
;%%% &
void** !
StopTimeoutMonitoring** "
(**" #
)**# $
;**$ %
bool00 
IsSessionTimedOut00 
(00 
)00  
;00  !
Task66 
EndSessionAsync66 
(66 
string66 #
reason66$ *
)66* +
;66+ ,
event;; 
EventHandler;; 
<;; $
SessionTimedOutEventArgs;; 3
>;;3 4
SessionTimedOut;;5 D
;;;D E
}<< 
public>> 

class>> $
SessionTimedOutEventArgs>> )
:>>* +
	EventArgs>>, 5
{?? 
public@@ 
Model_UserSession@@  
Session@@! (
{@@) *
get@@+ .
;@@. /
set@@0 3
;@@3 4
}@@5 6
=@@7 8
null@@9 =
!@@= >
;@@> ?
publicAA 
TimeSpanAA 
IdleDurationAA $
{AA% &
getAA' *
;AA* +
setAA, /
;AA/ 0
}AA1 2
}BB 
}CC ˘
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_UserPreferences.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
;6 7
public 
	interface $
IService_UserPreferences )
{ 
Task

 
<

 	
Model_Dao_Result

	 
<

  
Model_UserPreference

 .
>

. /
>

/ 0(
GetLatestUserPreferenceAsync

1 M
(

M N
string

N T
username

U ]
)

] ^
;

^ _
Task 
< 	
Model_Dao_Result	 
> "
UpdateDefaultModeAsync 1
(1 2
string2 8
username9 A
,A B
stringC I
defaultModeJ U
)U V
;V W
} Å
cC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_SessionManager.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface #
IService_SessionManager ,
{ 
Task 
SaveSessionAsync 
( "
Model_ReceivingSession 4
session5 <
)< =
;= >
Task 
< "
Model_ReceivingSession #
?# $
>$ %
LoadSessionAsync& 6
(6 7
)7 8
;8 9
Task$$ 
<$$ 
bool$$ 
>$$ 
ClearSessionAsync$$ $
($$$ %
)$$% &
;$$& '
bool** 
SessionExists** 
(** 
)** 
;** 
string00 
GetSessionFilePath00 !
(00! "
)00" #
;00# $
}11 
}22 ±D
fC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_ReceivingWorkflow.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface &
IService_ReceivingWorkflow /
{ 
event 
EventHandler 
< 
string !
>! "
StatusMessageRaised# 6
;6 7
void 
RaiseStatusMessage 
(  
string  &
message' .
). /
;/ 0
event 
EventHandler 
StepChanged &
;& '
WorkflowStep!! 
CurrentStep!!  
{!!! "
get!!# &
;!!& '
}!!( )"
Model_ReceivingSession&& 
CurrentSession&& -
{&&. /
get&&0 3
;&&3 4
}&&5 6
string++ 
?++ 
CurrentPONumber++ 
{++  !
get++" %
;++% &
set++' *
;++* +
}++, -!
Model_InforVisualPart00 
?00 
CurrentPart00 *
{00+ ,
get00- 0
;000 1
set002 5
;005 6
}007 8
bool55 
IsNonPOItem55 
{55 
get55 
;55 
set55  #
;55# $
}55% &
int:: 
NumberOfLoads:: 
{:: 
get:: 
;::  
set::! $
;::$ %
}::& '
TaskAA 
<AA 
boolAA 
>AA 
StartWorkflowAsyncAA %
(AA% &
)AA& '
;AA' (
TaskGG 
<GG 
WorkflowStepResultGG 
>GG  "
AdvanceToNextStepAsyncGG! 7
(GG7 8
)GG8 9
;GG9 :
WorkflowStepResultMM 
GoToPreviousStepMM +
(MM+ ,
)MM, -
;MM- .
WorkflowStepResultTT 
GoToStepTT #
(TT# $
WorkflowStepTT$ 0
stepTT1 5
)TT5 6
;TT6 7
TaskYY (
AddCurrentPartToSessionAsyncYY )
(YY) *
)YY* +
;YY+ ,
Taskaa 
<aa 

SaveResultaa 
>aa 
SaveSessionAsyncaa )
(aa) *
	IProgressaa* 3
<aa3 4
stringaa4 :
>aa: ;
?aa; <
messageProgressaa= L
=aaM N
nullaaO S
,aaS T
	IProgressaaU ^
<aa^ _
intaa_ b
>aab c
?aac d
percentProgressaae t
=aau v
nullaaw {
)aa{ |
;aa| }
Taskff 
ResetWorkflowAsyncff 
(ff  
)ff  !
;ff! "
Taskkk 
<kk 
CSVDeleteResultkk 
>kk 
ResetCSVFilesAsynckk 0
(kk0 1
)kk1 2
;kk2 3
Taskpp 
PersistSessionAsyncpp  
(pp  !
)pp! "
;pp" #
}qq 
publicvv 

enumvv 
WorkflowStepvv 
{ww 
ModeSelectionxx 
=xx 
$numxx 
,xx 
ManualEntryyy 
=yy 
$numyy 
,yy 
EditModezz 
=zz 
$numzz 
,zz 
POEntry{{ 
={{ 
$num{{ 
,{{ 
PartSelection|| 
=|| 
$num|| 
,|| 
	LoadEntry}} 
=}} 
$num}} 
,}} 
WeightQuantityEntry~~ 
=~~ 
$num~~ 
,~~  
HeatLotEntry 
= 
$num 
, 
PackageTypeEntry
ÄÄ 
=
ÄÄ 
$num
ÄÄ 
,
ÄÄ 
Review
ÅÅ 
=
ÅÅ 
$num
ÅÅ 
,
ÅÅ 
Saving
ÇÇ 
=
ÇÇ 
$num
ÇÇ 
,
ÇÇ 
Complete
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
}
ÑÑ 
public
ââ 

class
ââ  
WorkflowStepResult
ââ #
{
ää 
public
ãã 
bool
ãã 
Success
ãã 
{
ãã 
get
ãã !
;
ãã! "
set
ãã# &
;
ãã& '
}
ãã( )
public
åå 
WorkflowStep
åå 
NewStep
åå #
{
åå$ %
get
åå& )
;
åå) *
set
åå+ .
;
åå. /
}
åå0 1
public
çç 
string
çç 
Message
çç 
{
çç 
get
çç  #
;
çç# $
set
çç% (
;
çç( )
}
çç* +
=
çç, -
string
çç. 4
.
çç4 5
Empty
çç5 :
;
çç: ;
public
éé 
List
éé 
<
éé 
string
éé 
>
éé 
ValidationErrors
éé ,
{
éé- .
get
éé/ 2
;
éé2 3
set
éé4 7
;
éé7 8
}
éé9 :
=
éé; <
new
éé= @
(
éé@ A
)
ééA B
;
ééB C
public
êê 
static
êê  
WorkflowStepResult
êê (
SuccessResult
êê) 6
(
êê6 7
WorkflowStep
êê7 C
newStep
êêD K
,
êêK L
string
êêM S
message
êêT [
=
êê\ ]
$str
êê^ `
)
êê` a
=>
êêb d
new
êêe h
(
êêh i
)
êêi j
{
ëë 	
Success
íí 
=
íí 
true
íí 
,
íí 
NewStep
ìì 
=
ìì 
newStep
ìì 
,
ìì 
Message
îî 
=
îî 
message
îî 
}
ïï 	
;
ïï	 

public
óó 
static
óó  
WorkflowStepResult
óó (
ErrorResult
óó) 4
(
óó4 5
List
óó5 9
<
óó9 :
string
óó: @
>
óó@ A
errors
óóB H
)
óóH I
=>
óóJ L
new
óóM P
(
óóP Q
)
óóQ R
{
òò 	
Success
ôô 
=
ôô 
false
ôô 
,
ôô 
ValidationErrors
öö 
=
öö 
errors
öö %
}
õõ 	
;
õõ	 

}
úú 
public
°° 

class
°° 

SaveResult
°° 
{
¢¢ 
public
££ 
bool
££ 
Success
££ 
{
££ 
get
££ !
;
££! "
set
££# &
;
££& '
}
££( )
public
§§ 
int
§§ 

LoadsSaved
§§ 
{
§§ 
get
§§  #
;
§§# $
set
§§% (
;
§§( )
}
§§* +
public
•• 
bool
•• 
LocalCSVSuccess
•• #
{
••$ %
get
••& )
;
••) *
set
••+ .
;
••. /
}
••0 1
public
¶¶ 
bool
¶¶ 
NetworkCSVSuccess
¶¶ %
{
¶¶& '
get
¶¶( +
;
¶¶+ ,
set
¶¶- 0
;
¶¶0 1
}
¶¶2 3
public
ßß 
bool
ßß 
DatabaseSuccess
ßß #
{
ßß$ %
get
ßß& )
;
ßß) *
set
ßß+ .
;
ßß. /
}
ßß0 1
public
®® 
string
®® 
?
®® 
LocalCSVPath
®® #
{
®®$ %
get
®®& )
;
®®) *
set
®®+ .
;
®®. /
}
®®0 1
public
©© 
string
©© 
?
©© 
NetworkCSVPath
©© %
{
©©& '
get
©©( +
;
©©+ ,
set
©©- 0
;
©©0 1
}
©©2 3
public
™™ 
List
™™ 
<
™™ 
string
™™ 
>
™™ 
Errors
™™ "
{
™™# $
get
™™% (
;
™™( )
set
™™* -
;
™™- .
}
™™/ 0
=
™™1 2
new
™™3 6
(
™™6 7
)
™™7 8
;
™™8 9
public
´´ 
List
´´ 
<
´´ 
string
´´ 
>
´´ 
Warnings
´´ $
{
´´% &
get
´´' *
;
´´* +
set
´´, /
;
´´/ 0
}
´´1 2
=
´´3 4
new
´´5 8
(
´´8 9
)
´´9 :
;
´´: ;
public
≠≠ 
bool
≠≠ 
IsFullSuccess
≠≠ !
=>
≠≠" $
LocalCSVSuccess
≠≠% 4
&&
≠≠5 7
NetworkCSVSuccess
≠≠8 I
&&
≠≠J L
DatabaseSuccess
≠≠M \
;
≠≠\ ]
public
ÆÆ 
bool
ÆÆ 
IsPartialSuccess
ÆÆ $
=>
ÆÆ% '
(
ÆÆ( )
LocalCSVSuccess
ÆÆ) 8
||
ÆÆ9 ;
DatabaseSuccess
ÆÆ< K
)
ÆÆK L
&&
ÆÆM O
!
ÆÆP Q
IsFullSuccess
ÆÆQ ^
;
ÆÆ^ _
}
ØØ 
}∞∞ ü*
hC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_ReceivingValidation.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface (
IService_ReceivingValidation 1
{ %
ReceivingValidationResult !
ValidatePONumber" 2
(2 3
string3 9
poNumber: B
)B C
;C D%
ReceivingValidationResult !
ValidatePartID" 0
(0 1
string1 7
partID8 >
)> ?
;? @%
ReceivingValidationResult   !!
ValidateNumberOfLoads  " 7
(  7 8
int  8 ;
numLoads  < D
)  D E
;  E F%
ReceivingValidationResult'' !"
ValidateWeightQuantity''" 8
(''8 9
decimal''9 @
weightQuantity''A O
)''O P
;''P Q%
ReceivingValidationResult.. ! 
ValidatePackageCount.." 6
(..6 7
int..7 :
packagesPerLoad..; J
)..J K
;..K L%
ReceivingValidationResult55 !!
ValidateHeatLotNumber55" 7
(557 8
string558 >
heatLotNumber55? L
)55L M
;55M N
Task?? 
<?? %
ReceivingValidationResult?? &
>??& '*
ValidateAgainstPOQuantityAsync??( F
(??F G
decimal@@ 
totalQuantity@@ !
,@@! "
decimalAA 
orderedQuantityAA #
,AA# $
stringBB 
partIDBB 
)BB 
;BB 
TaskLL 
<LL %
ReceivingValidationResultLL &
>LL& '&
CheckSameDayReceivingAsyncLL( B
(LLB C
stringMM 
poNumberMM 
,MM 
stringNN 
partIDNN 
,NN 
decimalOO 
userEnteredQuantityOO '
)OO' (
;OO( )%
ReceivingValidationResultVV !!
ValidateReceivingLoadVV" 7
(VV7 8
Model_ReceivingLoadVV8 K
loadVVL P
)VVP Q
;VVQ R%
ReceivingValidationResult]] !
ValidateSession]]" 1
(]]1 2
List]]2 6
<]]6 7
Model_ReceivingLoad]]7 J
>]]J K
loads]]L Q
)]]Q R
;]]R S
Taskdd 
<dd %
ReceivingValidationResultdd &
>dd& '+
ValidatePartExistsInVisualAsyncdd( G
(ddG H
stringddH N
partIDddO U
)ddU V
;ddV W
}ee 
publicjj 

classjj %
ReceivingValidationResultjj *
{kk 
publicll 
boolll 
IsValidll 
{ll 
getll !
;ll! "
setll# &
;ll& '
}ll( )
publicmm 
ValidationSeveritymm !
Severitymm" *
{mm+ ,
getmm- 0
;mm0 1
setmm2 5
;mm5 6
}mm7 8
=mm9 :
ValidationSeveritymm; M
.mmM N
ErrormmN S
;mmS T
publicnn 
stringnn 
Messagenn 
{nn 
getnn  #
;nn# $
setnn% (
;nn( )
}nn* +
=nn, -
stringnn. 4
.nn4 5
Emptynn5 :
;nn: ;
publicoo 
Listoo 
<oo 
stringoo 
>oo 
Errorsoo "
{oo# $
getoo% (
;oo( )
setoo* -
;oo- .
}oo/ 0
=oo1 2
newoo3 6
(oo6 7
)oo7 8
;oo8 9
publicqq 
staticqq %
ReceivingValidationResultqq /
Successqq0 7
(qq7 8
)qq8 9
=>qq: <
newqq= @
(qq@ A
)qqA B
{qqC D
IsValidqqE L
=qqM N
trueqqO S
}qqT U
;qqU V
publicrr 
staticrr %
ReceivingValidationResultrr /
Errorrr0 5
(rr5 6
stringrr6 <
messagerr= D
)rrD E
=>rrF H
newrrI L
(rrL M
)rrM N
{ss 	
IsValidtt 
=tt 
falsett 
,tt 
Severityuu 
=uu 
ValidationSeverityuu )
.uu) *
Erroruu* /
,uu/ 0
Messagevv 
=vv 
messagevv 
,vv 
Errorsww 
=ww 
newww 
Listww 
<ww 
stringww $
>ww$ %
{ww& '
messageww( /
}ww0 1
}xx 	
;xx	 

publicyy 
staticyy %
ReceivingValidationResultyy /
Warningyy0 7
(yy7 8
stringyy8 >
messageyy? F
)yyF G
=>yyH J
newyyK N
(yyN O
)yyO P
{zz 	
IsValid{{ 
={{ 
true{{ 
,{{ 
Severity|| 
=|| 
ValidationSeverity|| )
.||) *
Warning||* 1
,||1 2
Message}} 
=}} 
message}} 
}~~ 	
;~~	 

} 
public
ÑÑ 

enum
ÑÑ  
ValidationSeverity
ÑÑ "
{
ÖÖ 
Info
ÜÜ 
,
ÜÜ 
Warning
áá 
,
áá 
Error
àà 
}
ââ 
}ää «
_C:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_Pagination.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface 
IService_Pagination (
{ 
int 
CurrentPage 
{ 
get 
; 
}  
int 

TotalPages 
{ 
get 
; 
} 
int 
PageSize 
{ 
get 
; 
set 
;  
}! "
int 

TotalItems 
{ 
get 
; 
} 
bool 
HasNextPage 
{ 
get 
; 
}  !
bool$$ 
HasPreviousPage$$ 
{$$ 
get$$ "
;$$" #
}$$$ %
event)) 
EventHandler)) 
PageChanged)) &
;))& '
void00 
	SetSource00 
<00 
T00 
>00 
(00 
IEnumerable00 %
<00% &
T00& '
>00' (
source00) /
)00/ 0
;000 1
IEnumerable77 
<77 
T77 
>77 
GetCurrentPageItems77 *
<77* +
T77+ ,
>77, -
(77- .
)77. /
;77/ 0
void<< 
NextPage<< 
(<< 
)<< 
;<< 
voidAA 
PreviousPageAA 
(AA 
)AA 
;AA 
voidFF 
	FirstPageFF 
(FF 
)FF 
;FF 
voidKK 
LastPageKK 
(KK 
)KK 
;KK 
voidQQ 
GoToPageQQ 
(QQ 
intQQ 

pageNumberQQ $
)QQ$ %
;QQ% &
}RR 
}SS €
kC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_OnStartup_AppLifecycle.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface +
IService_OnStartup_AppLifecycle 4
{ 
Task 

StartAsync 
( 
) 
; 
} 
}		 …
`C:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_InforVisual.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface  
IService_InforVisual )
{ 
Task 
< 
Model_Dao_Result 
< 
Model_InforVisualPO 1
?1 2
>2 3
>3 4
GetPOWithPartsAsync5 H
(H I
stringI O
poNumberP X
)X Y
;Y Z
Task 
< 
Model_Dao_Result 
< !
Model_InforVisualPart 3
?3 4
>4 5
>5 6
GetPartByIDAsync7 G
(G H
stringH N
partIDO U
)U V
;V W
Task$$ 
<$$ 
Model_Dao_Result$$ 
<$$ 
decimal$$ %
>$$% &
>$$& ',
 GetSameDayReceivingQuantityAsync$$( H
($$H I
string$$I O
poNumber$$P X
,$$X Y
string$$Z `
partID$$a g
,$$g h
DateTime$$i q
date$$r v
)$$v w
;$$w x
Task.. 
<.. 
Model_Dao_Result.. 
<.. 
int.. !
>..! "
>.." #%
GetRemainingQuantityAsync..$ =
(..= >
string..> D
poNumber..E M
,..M N
string..O U
partID..V \
)..\ ]
;..] ^
Task44 
<44 
bool44 
>44 
TestConnectionAsync44 &
(44& '
)44' (
;44( )
}55 
}66 ¡
hC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_MySQL_ReceivingLine.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
;6 7
public 
	interface (
IService_MySQL_ReceivingLine -
{		 
Task 
< 	
Model_Dao_Result	 
> $
InsertReceivingLineAsync 3
(3 4
Model_ReceivingLine4 G
lineH L
)L M
;M N
} ﬂ
aC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_ErrorHandler.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
;6 7
public 
	interface !
IService_ErrorHandler &
{ 
Task 
HandleErrorAsync	 
( 
string 
errorMessage 
, 
Enum_ErrorSeverity 
severity #
,# $
	Exception 
? 
	exception 
= 
null #
,# $
bool 

showDialog 
= 
true 
) 
; 
Task%% 
LogErrorAsync%%	 
(%% 
string&& 
errorMessage&& 
,&& 
Enum_ErrorSeverity'' 
severity'' #
,''# $
	Exception(( 
?(( 
	exception(( 
=(( 
null(( #
))) 
;)) 
Task22  
ShowErrorDialogAsync22	 
(22 
string33 
title33 
,33 
string44 
message44 
,44 
Enum_ErrorSeverity55 
severity55 #
)66 
;66 
Task?? 
HandleDaoErrorAsync??	 
(?? 
Model_Dao_Result@@ 
result@@ 
,@@  
stringAA 
operationNameAA 
,AA 
boolBB 

showDialogBB 
=BB 
trueBB 
)CC 
;CC 
}DD Ÿ
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_MySQL_Receiving.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface $
IService_MySQL_Receiving -
{ 
Task 
< 
int 
> #
SaveReceivingLoadsAsync )
() *
List* .
<. /
Model_ReceivingLoad/ B
>B C
loadsD I
)I J
;J K
Task 
< 
List 
< 
Model_ReceivingLoad %
>% &
>& '$
GetReceivingHistoryAsync( @
(@ A
stringA G
partIDH N
,N O
DateTimeP X
	startDateY b
,b c
DateTimed l
endDatem t
)t u
;u v
Task'' 
<'' 
Model_Dao_Result'' 
<'' 
List'' "
<''" #
Model_ReceivingLoad''# 6
>''6 7
>''7 8
>''8 9%
GetAllReceivingLoadsAsync'': S
(''S T
DateTime''T \
	startDate''] f
,''f g
DateTime''h p
endDate''q x
)''x y
;''y z
Task.. 
<.. 
int.. 
>.. %
UpdateReceivingLoadsAsync.. +
(..+ ,
List.., 0
<..0 1
Model_ReceivingLoad..1 D
>..D E
loads..F K
)..K L
;..L M
Task55 
<55 
int55 
>55 %
DeleteReceivingLoadsAsync55 +
(55+ ,
List55, 0
<550 1
Model_ReceivingLoad551 D
>55D E
loads55F K
)55K L
;55L M
Task;; 
<;; 
bool;; 
>;; 
TestConnectionAsync;; &
(;;& '
);;' (
;;;( )
}<< 
}== ¿
mC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_MySQL_PackagePreferences.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface -
!IService_MySQL_PackagePreferences 6
{ 
Task 
< '
Model_PackageTypePreference (
?( )
>) *
GetPreferenceAsync+ =
(= >
string> D
partIDE K
)K L
;L M
Task 
SavePreferenceAsync  
(  !'
Model_PackageTypePreference! <

preference= G
)G H
;H I
Task$$ 
<$$ 
bool$$ 
>$$ !
DeletePreferenceAsync$$ (
($$( )
string$$) /
partID$$0 6
)$$6 7
;$$7 8
}%% 
}&& Œ@
bC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_MySQL_Dunnage.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface "
IService_MySQL_Dunnage +
{ 
Task 
< 
Model_Dao_Result 
< 
List "
<" #
Model_DunnageType# 4
>4 5
>5 6
>6 7
GetAllTypesAsync8 H
(H I
)I J
;J K
Task 
< 
Model_Dao_Result 
< 
Model_DunnageType /
>/ 0
>0 1
GetTypeByIdAsync2 B
(B C
intC F
typeIdG M
)M N
;N O
Task 
< 
Model_Dao_Result 
> 
InsertTypeAsync .
(. /
Model_DunnageType/ @
typeA E
)E F
;F G
Task 
< 
Model_Dao_Result 
> 
UpdateTypeAsync .
(. /
Model_DunnageType/ @
typeA E
)E F
;F G
Task 
< 
Model_Dao_Result 
> 
DeleteTypeAsync .
(. /
int/ 2
typeId3 9
)9 :
;: ;
Task 
< 
Model_Dao_Result 
< 
List "
<" #
Model_DunnageSpec# 4
>4 5
>5 6
>6 7 
GetSpecsForTypeAsync8 L
(L M
intM P
typeIdQ W
)W X
;X Y
Task 
< 
Model_Dao_Result 
> 
InsertSpecAsync .
(. /
Model_DunnageSpec/ @
specA E
)E F
;F G
Task 
< 
Model_Dao_Result 
> 
UpdateSpecAsync .
(. /
Model_DunnageSpec/ @
specA E
)E F
;F G
Task 
< 
Model_Dao_Result 
> 
DeleteSpecAsync .
(. /
int/ 2
specId3 9
)9 :
;: ;
Task 
< 
Model_Dao_Result 
> $
DeleteSpecsByTypeIdAsync 7
(7 8
int8 ;
typeId< B
)B C
;C D
Task 
< 
List 
< 
string 
> 
> 
GetAllSpecKeysAsync .
(. /
)/ 0
;0 1
Task"" 
<"" 
Model_Dao_Result"" 
<"" 
List"" "
<""" #
Model_DunnagePart""# 4
>""4 5
>""5 6
>""6 7
GetAllPartsAsync""8 H
(""H I
)""I J
;""J K
Task## 
<## 
Model_Dao_Result## 
<## 
List## "
<##" #
Model_DunnagePart### 4
>##4 5
>##5 6
>##6 7
GetPartsByTypeAsync##8 K
(##K L
int##L O
typeId##P V
)##V W
;##W X
Task$$ 
<$$ 
Model_Dao_Result$$ 
<$$ 
Model_DunnagePart$$ /
>$$/ 0
>$$0 1
GetPartByIdAsync$$2 B
($$B C
string$$C I
partId$$J P
)$$P Q
;$$Q R
Task%% 
<%% 
Model_Dao_Result%% 
>%% 
InsertPartAsync%% .
(%%. /
Model_DunnagePart%%/ @
part%%A E
)%%E F
;%%F G
Task&& 
<&& 
Model_Dao_Result&& 
>&& 
UpdatePartAsync&& .
(&&. /
Model_DunnagePart&&/ @
part&&A E
)&&E F
;&&F G
Task'' 
<'' 
Model_Dao_Result'' 
>'' 
DeletePartAsync'' .
(''. /
string''/ 5
partId''6 <
)''< =
;''= >
Task(( 
<(( 
Model_Dao_Result(( 
<(( 
List(( "
<((" #
Model_DunnagePart((# 4
>((4 5
>((5 6
>((6 7
SearchPartsAsync((8 H
(((H I
string((I O

searchText((P Z
,((Z [
int((\ _
?((_ `
typeId((a g
)((g h
;((h i
Task,, 
<,, 
Model_Dao_Result,, 
>,, 
SaveLoadsAsync,, -
(,,- .
List,,. 2
<,,2 3
Model_DunnageLoad,,3 D
>,,D E
loads,,F K
),,K L
;,,L M
Task-- 
<-- 
Model_Dao_Result-- 
<-- 
List-- "
<--" #
Model_DunnageLoad--# 4
>--4 5
>--5 6
>--6 7$
GetLoadsByDateRangeAsync--8 P
(--P Q
DateTime--Q Y
start--Z _
,--_ `
DateTime--a i
end--j m
)--m n
;--n o
Task.. 
<.. 
Model_Dao_Result.. 
<.. 
List.. "
<.." #
Model_DunnageLoad..# 4
>..4 5
>..5 6
>..6 7
GetAllLoadsAsync..8 H
(..H I
)..I J
;..J K
Task// 
<// 
Model_Dao_Result// 
<// 
Model_DunnageLoad// /
>/// 0
>//0 1
GetLoadByIdAsync//2 B
(//B C
string//C I
loadUuid//J R
)//R S
;//S T
Task00 
<00 
Model_Dao_Result00 
>00 
UpdateLoadAsync00 .
(00. /
Model_DunnageLoad00/ @
load00A E
)00E F
;00F G
Task11 
<11 
Model_Dao_Result11 
>11 
DeleteLoadAsync11 .
(11. /
string11/ 5
loadUuid116 >
)11> ?
;11? @
Task55 
<55 
bool55 
>55 "
IsPartInventoriedAsync55 )
(55) *
string55* 0
partId551 7
)557 8
;558 9
Task66 
<66 
Model_Dao_Result66 
<66 $
Model_InventoriedDunnage66 6
>666 7
>667 8$
GetInventoryDetailsAsync669 Q
(66Q R
string66R X
partId66Y _
)66_ `
;66` a
Task77 
<77 
Model_Dao_Result77 
<77 
List77 "
<77" #$
Model_InventoriedDunnage77# ;
>77; <
>77< =
>77= >'
GetAllInventoriedPartsAsync77? Z
(77Z [
)77[ \
;77\ ]
Task88 
<88 
Model_Dao_Result88 
>88 %
AddToInventoriedListAsync88 8
(888 9$
Model_InventoriedDunnage889 Q
item88R V
)88V W
;88W X
Task99 
<99 
Model_Dao_Result99 
>99 *
RemoveFromInventoriedListAsync99 =
(99= >
string99> D
partId99E K
)99K L
;99L M
Task:: 
<:: 
Model_Dao_Result:: 
>:: &
UpdateInventoriedPartAsync:: 9
(::9 :$
Model_InventoriedDunnage::: R
item::S W
)::W X
;::X Y
Task>> 
<>> 
int>> 
>>> %
GetPartCountByTypeIdAsync>> +
(>>+ ,
int>>, /
typeId>>0 6
)>>6 7
;>>7 8
Task?? 
<?? 
int?? 
>?? ,
 GetTransactionCountByPartIdAsync?? 2
(??2 3
string??3 9
partId??: @
)??@ A
;??A B
Task@@ 
<@@ 
int@@ 
>@@ ,
 GetTransactionCountByTypeIdAsync@@ 2
(@@2 3
int@@3 6
typeId@@7 =
)@@= >
;@@> ?
TaskAA 
<AA 
intAA 
>AA &
GetPartCountBySpecKeyAsyncAA ,
(AA, -
intAA- 0
typeIdAA1 7
,AA7 8
stringAA9 ?
specKeyAA@ G
)AAG H
;AAH I
}BB 
}CC ô
cC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_LoggingUtility.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
;6 7
public		 
	interface		 #
IService_LoggingUtility		 (
{

 
void 
LogInfo	 
( 
string 
message 
,  
string! '
?' (
context) 0
=1 2
null3 7
)7 8
;8 9
void 

LogWarning	 
( 
string 
message "
," #
string$ *
?* +
context, 3
=4 5
null6 :
): ;
;; <
void 
LogError	 
( 
string 
message  
,  !
	Exception" +
?+ ,
	exception- 6
=7 8
null9 =
,= >
string? E
?E F
contextG N
=O P
nullQ U
)U V
;V W
void'' 
LogCritical''	 
('' 
string'' 
message'' #
,''# $
	Exception''% .
?''. /
	exception''0 9
='': ;
null''< @
,''@ A
string''B H
?''H I
context''J Q
=''R S
null''T X
)''X Y
;''Y Z
void00 
LogFatal00	 
(00 
string00 
message00  
,00  !
	Exception00" +
?00+ ,
	exception00- 6
=007 8
null009 =
,00= >
string00? E
?00E F
context00G N
=00O P
null00Q U
)00U V
;00V W
string66 
!
GetCurrentLogFilePath66  
(66  !
)66! "
;66" #
bool<< $
EnsureLogDirectoryExists<<	 !
(<<! "
)<<" #
;<<# $
intCC 
ArchiveOldLogsCC 
(CC 
intCC 

daysToKeepCC %
=CC& '
$numCC( *
)CC* +
;CC+ ,
}DD Ÿ
_C:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_Dispatcher.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public		 

	interface		 
IService_Dispatcher		 (
{

 $
IService_DispatcherTimer  
CreateTimer! ,
(, -
)- .
;. /
bool 

TryEnqueue 
( 
Action 
callback '
)' (
;( )
} 
} à
dC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_DunnageWorkflow.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{		 
public

 

	interface

 $
IService_DunnageWorkflow

 -
{ $
Enum_DunnageWorkflowStep  
CurrentStep! ,
{- .
get/ 2
;2 3
}4 5 
Model_DunnageSession 
CurrentSession +
{, -
get. 1
;1 2
}3 4
event 
EventHandler 
StepChanged &
;& '
event 
EventHandler 
< 
string !
>! "
StatusMessageRaised# 6
;6 7
Task 
< 
bool 
> 
StartWorkflowAsync %
(% &
)& '
;' (
Task 
< $
Model_WorkflowStepResult %
>% &"
AdvanceToNextStepAsync' =
(= >
)> ?
;? @
void 
GoToStep 
( $
Enum_DunnageWorkflowStep .
step/ 3
)3 4
;4 5
Task 
< 
Model_SaveResult 
> 
SaveSessionAsync /
(/ 0
)0 1
;1 2
void 
ClearSession 
( 
) 
; 
} 
} ˆ
eC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_DunnageCSVWriter.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public		 

	interface		 %
IService_DunnageCSVWriter		 .
{

 
Task 
<  
Model_CSVWriteResult !
>! "
WriteToCSVAsync# 2
(2 3
List3 7
<7 8
Model_DunnageLoad8 I
>I J
loadsK P
)P Q
;Q R
} 
} ‚"
^C:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_CSVWriter.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface 
IService_CSVWriter '
{ 
Task 
< 
CSVWriteResult 
> 
WriteToCSVAsync ,
(, -
List- 1
<1 2
Model_ReceivingLoad2 E
>E F
loadsG L
)L M
;M N
Task!! 
WriteToFileAsync!! 
(!! 
string!! $
filePath!!% -
,!!- .
List!!/ 3
<!!3 4
Model_ReceivingLoad!!4 G
>!!G H
loads!!I N
,!!N O
bool!!P T
append!!U [
=!!\ ]
true!!^ b
)!!b c
;!!c d
Task** 
<** 
List** 
<** 
Model_ReceivingLoad** %
>**% &
>**& '
ReadFromCSVAsync**( 8
(**8 9
string**9 ?
filePath**@ H
)**H I
;**I J
Task00 
<00 
CSVDeleteResult00 
>00 
DeleteCSVFilesAsync00 1
(001 2
)002 3
;003 4
Task66 
<66 
CSVExistenceResult66 
>66  #
CheckCSVFilesExistAsync66! 8
(668 9
)669 :
;66: ;
string<< 
GetLocalCSVPath<< 
(<< 
)<<  
;<<  !
stringBB 
GetNetworkCSVPathBB  
(BB  !
)BB! "
;BB" #
}CC 
publicHH 

classHH 
CSVWriteResultHH 
{II 
publicJJ 
boolJJ 
LocalSuccessJJ  
{JJ! "
getJJ# &
;JJ& '
setJJ( +
;JJ+ ,
}JJ- .
publicKK 
boolKK 
NetworkSuccessKK "
{KK# $
getKK% (
;KK( )
setKK* -
;KK- .
}KK/ 0
publicLL 
stringLL 
?LL 

LocalErrorLL !
{LL" #
getLL$ '
;LL' (
setLL) ,
;LL, -
}LL. /
publicMM 
stringMM 
?MM 
NetworkErrorMM #
{MM$ %
getMM& )
;MM) *
setMM+ .
;MM. /
}MM0 1
publicNN 
intNN 
RecordsWrittenNN !
{NN" #
getNN$ '
;NN' (
setNN) ,
;NN, -
}NN. /
publicPP 
boolPP 
IsFullSuccessPP !
=>PP" $
LocalSuccessPP% 1
&&PP2 4
NetworkSuccessPP5 C
;PPC D
publicQQ 
boolQQ 
IsPartialSuccessQQ $
=>QQ% '
LocalSuccessQQ( 4
&&QQ5 7
!QQ8 9
NetworkSuccessQQ9 G
;QQG H
publicRR 
boolRR 
	IsFailureRR 
=>RR  
!RR! "
LocalSuccessRR" .
;RR. /
}SS 
publicXX 

classXX 
CSVDeleteResultXX  
{YY 
publicZZ 
boolZZ 
LocalDeletedZZ  
{ZZ! "
getZZ# &
;ZZ& '
setZZ( +
;ZZ+ ,
}ZZ- .
public[[ 
bool[[ 
NetworkDeleted[[ "
{[[# $
get[[% (
;[[( )
set[[* -
;[[- .
}[[/ 0
public\\ 
string\\ 
?\\ 

LocalError\\ !
{\\" #
get\\$ '
;\\' (
set\\) ,
;\\, -
}\\. /
public]] 
string]] 
?]] 
NetworkError]] #
{]]$ %
get]]& )
;]]) *
set]]+ .
;]]. /
}]]0 1
}^^ 
publiccc 

classcc 
CSVExistenceResultcc #
{dd 
publicee 
boolee 
LocalExistsee 
{ee  !
getee" %
;ee% &
setee' *
;ee* +
}ee, -
publicff 
boolff 
NetworkExistsff !
{ff" #
getff$ '
;ff' (
setff) ,
;ff, -
}ff. /
publicgg 
boolgg 
NetworkAccessiblegg %
{gg& '
getgg( +
;gg+ ,
setgg- 0
;gg0 1
}gg2 3
}hh 
}ii ö6
cC:\Users\johnk\source\repos\MTM_Receiving_Application\Contracts\Services\IService_Authentication.cs
	namespace 	%
MTM_Receiving_Application
 #
.# $
	Contracts$ -
.- .
Services. 6
{ 
public 

	interface #
IService_Authentication ,
{ 
Task 
<  
AuthenticationResult !
>! ".
"AuthenticateByWindowsUsernameAsync# E
(E F
string 
windowsUsername "
," #
	IProgress 
< 
string 
> 
? 
progress '
=( )
null* .
). /
;/ 0
Task 
<  
AuthenticationResult !
>! ""
AuthenticateByPinAsync# 9
(9 :
string   
username   
,   
string!! 
pin!! 
,!! 
	IProgress"" 
<"" 
string"" 
>"" 
?"" 
progress"" '
=""( )
null""* .
)"". /
;""/ 0
Task++ 
<++ 
CreateUserResult++ 
>++ 
CreateNewUserAsync++ 1
(++1 2

Model_User,, 
user,, 
,,, 
string-- 
	createdBy-- 
,-- 
	IProgress.. 
<.. 
string.. 
>.. 
?.. 
progress.. '
=..( )
null..* .
)... /
;../ 0
Task66 
<66 
ValidationResult66 
>66 
ValidatePinAsync66 /
(66/ 0
string660 6
pin667 :
,66: ;
int66< ?
?66? @!
excludeEmployeeNumber66A V
=66W X
null66Y ]
)66] ^
;66^ _
Task>> 
<>> #
Model_WorkstationConfig>> $
>>>$ %&
DetectWorkstationTypeAsync>>& @
(>>@ A
string>>A G
?>>G H
computerName>>I U
=>>V W
null>>X \
)>>\ ]
;>>] ^
TaskDD 
<DD 
ListDD 
<DD 
stringDD 
>DD 
>DD %
GetActiveDepartmentsAsyncDD 4
(DD4 5
)DD5 6
;DD6 7
TaskMM  
LogUserActivityAsyncMM !
(MM! "
stringMM" (
	eventTypeMM) 2
,MM2 3
stringMM4 :
usernameMM; C
,MMC D
stringMME K
workstationNameMML [
,MM[ \
stringMM] c
detailsMMd k
)MMk l
;MMl m
}NN 
publicSS 

classSS  
AuthenticationResultSS %
{TT 
publicUU 
boolUU 
SuccessUU 
{UU 
getUU !
;UU! "
setUU# &
;UU& '
}UU( )
publicVV 

Model_UserVV 
?VV 
UserVV 
{VV  !
getVV" %
;VV% &
setVV' *
;VV* +
}VV, -
publicWW 
stringWW 
ErrorMessageWW "
{WW# $
getWW% (
;WW( )
setWW* -
;WW- .
}WW/ 0
=WW1 2
stringWW3 9
.WW9 :
EmptyWW: ?
;WW? @
publicYY 
staticYY  
AuthenticationResultYY *
SuccessResultYY+ 8
(YY8 9

Model_UserYY9 C
userYYD H
)YYH I
=>YYJ L
newYYM P
(YYP Q
)YYQ R
{ZZ 	
Success[[ 
=[[ 
true[[ 
,[[ 
User\\ 
=\\ 
user\\ 
}]] 	
;]]	 

public__ 
static__  
AuthenticationResult__ *
ErrorResult__+ 6
(__6 7
string__7 =
message__> E
)__E F
=>__G I
new__J M
(__M N
)__N O
{`` 	
Successaa 
=aa 
falseaa 
,aa 
ErrorMessagebb 
=bb 
messagebb "
}cc 	
;cc	 

}dd 
publicii 

classii 
CreateUserResultii !
{jj 
publickk 
boolkk 
Successkk 
{kk 
getkk !
;kk! "
setkk# &
;kk& '
}kk( )
publicll 
intll 
EmployeeNumberll !
{ll" #
getll$ '
;ll' (
setll) ,
;ll, -
}ll. /
publicmm 
stringmm 
ErrorMessagemm "
{mm# $
getmm% (
;mm( )
setmm* -
;mm- .
}mm/ 0
=mm1 2
stringmm3 9
.mm9 :
Emptymm: ?
;mm? @
publicoo 
staticoo 
CreateUserResultoo &
SuccessResultoo' 4
(oo4 5
intoo5 8
employeeNumberoo9 G
)ooG H
=>ooI K
newooL O
(ooO P
)ooP Q
{pp 	
Successqq 
=qq 
trueqq 
,qq 
EmployeeNumberrr 
=rr 
employeeNumberrr +
}ss 	
;ss	 

publicuu 
staticuu 
CreateUserResultuu &
ErrorResultuu' 2
(uu2 3
stringuu3 9
messageuu: A
)uuA B
=>uuC E
newuuF I
(uuI J
)uuJ K
{vv 	
Successww 
=ww 
falseww 
,ww 
ErrorMessagexx 
=xx 
messagexx "
}yy 	
;yy	 

}zz 
public 

class 
ValidationResult !
{
ÄÄ 
public
ÅÅ 
bool
ÅÅ 
IsValid
ÅÅ 
{
ÅÅ 
get
ÅÅ !
;
ÅÅ! "
set
ÅÅ# &
;
ÅÅ& '
}
ÅÅ( )
public
ÇÇ 
string
ÇÇ 
ErrorMessage
ÇÇ "
{
ÇÇ# $
get
ÇÇ% (
;
ÇÇ( )
set
ÇÇ* -
;
ÇÇ- .
}
ÇÇ/ 0
=
ÇÇ1 2
string
ÇÇ3 9
.
ÇÇ9 :
Empty
ÇÇ: ?
;
ÇÇ? @
public
ÑÑ 
static
ÑÑ 
ValidationResult
ÑÑ &
Valid
ÑÑ' ,
(
ÑÑ, -
)
ÑÑ- .
=>
ÑÑ/ 1
new
ÑÑ2 5
(
ÑÑ5 6
)
ÑÑ6 7
{
ÑÑ8 9
IsValid
ÑÑ: A
=
ÑÑB C
true
ÑÑD H
}
ÑÑI J
;
ÑÑJ K
public
ÖÖ 
static
ÖÖ 
ValidationResult
ÖÖ &
Invalid
ÖÖ' .
(
ÖÖ. /
string
ÖÖ/ 5
message
ÖÖ6 =
)
ÖÖ= >
=>
ÖÖ? A
new
ÖÖB E
(
ÖÖE F
)
ÖÖF G
{
ÜÜ 	
IsValid
áá 
=
áá 
false
áá 
,
áá 
ErrorMessage
àà 
=
àà 
message
àà "
}
ââ 	
;
ââ	 

}
ää 
}ãã àØ
AC:\Users\johnk\source\repos\MTM_Receiving_Application\App.xaml.cs
	namespace 	%
MTM_Receiving_Application
 #
;# $
public 
partial 
class 
App 
: 
Application &
{ 
private 
IHost 
_host 
; 
public## 

static## 
Window## 
?## 

MainWindow## $
{##% &
get##' *
;##* +
internal##, 4
set##5 8
;##8 9
}##: ;
public(( 

App(( 
((( 
)(( 
{)) 
InitializeComponent** 
(** 
)** 
;** 
_host,, 
=,, 
Host,, 
.,,  
CreateDefaultBuilder,, )
(,,) *
),,* +
.-- 
ConfigureServices-- 
(-- 
(--  
context--  '
,--' (
services--) 1
)--1 2
=>--3 5
{.. 
services00 
.00 
AddSingleton00 %
<00% &!
IService_ErrorHandler00& ;
,00; < 
Service_ErrorHandler00= Q
>00Q R
(00R S
)00S T
;00T U
services11 
.11 
AddSingleton11 %
<11% &#
IService_LoggingUtility11& =
,11= >"
Service_LoggingUtility11? U
>11U V
(11V W
)11W X
;11X Y
var44 !
mySqlConnectionString44 )
=44* +%
Helper_Database_Variables44, E
.44E F
GetConnectionString44F Y
(44Y Z
)44Z [
;44[ \
var55 '
inforVisualConnectionString55 /
=550 1%
Helper_Database_Variables552 K
.55K L*
GetInforVisualConnectionString55L j
(55j k
)55k l
;55l m
services77 
.77 
AddSingleton77 %
(77% &
sp77& (
=>77) +
new77, /
Dao_User770 8
(778 9!
mySqlConnectionString779 N
)77N O
)77O P
;77P Q
services:: 
.:: 
AddSingleton:: %
(::% &
sp::& (
=>::) +
new::, /
Dao_ReceivingLoad::0 A
(::A B!
mySqlConnectionString::B W
)::W X
)::X Y
;::Y Z
services;; 
.;; 
AddSingleton;; %
(;;% &
sp;;& (
=>;;) +
new;;, /
Dao_ReceivingLine;;0 A
(;;A B!
mySqlConnectionString;;B W
);;W X
);;X Y
;;;Y Z
services<< 
.<< 
AddSingleton<< %
(<<% &
sp<<& (
=><<) +
new<<, /%
Dao_PackageTypePreference<<0 I
(<<I J!
mySqlConnectionString<<J _
)<<_ `
)<<` a
;<<a b
services?? 
.?? 
AddSingleton?? %
(??% &
sp??& (
=>??) +
new??, /
Dao_DunnageLoad??0 ?
(??? @!
mySqlConnectionString??@ U
)??U V
)??V W
;??W X
services@@ 
.@@ 
AddSingleton@@ %
(@@% &
sp@@& (
=>@@) +
new@@, /
Dao_DunnageType@@0 ?
(@@? @!
mySqlConnectionString@@@ U
)@@U V
)@@V W
;@@W X
servicesAA 
.AA 
AddSingletonAA %
(AA% &
spAA& (
=>AA) +
newAA, /
Dao_DunnagePartAA0 ?
(AA? @!
mySqlConnectionStringAA@ U
)AAU V
)AAV W
;AAW X
servicesBB 
.BB 
AddSingletonBB %
(BB% &
spBB& (
=>BB) +
newBB, /
Dao_DunnageSpecBB0 ?
(BB? @!
mySqlConnectionStringBB@ U
)BBU V
)BBV W
;BBW X
servicesCC 
.CC 
AddSingletonCC %
(CC% &
spCC& (
=>CC) +
newCC, /"
Dao_InventoriedDunnageCC0 F
(CCF G!
mySqlConnectionStringCCG \
)CC\ ]
)CC] ^
;CC^ _
servicesFF 
.FF 
AddSingletonFF %
(FF% &
spFF& (
=>FF) +
newFF, /
Dao_InforVisualPOFF0 A
(FFA B'
inforVisualConnectionStringFFB ]
)FF] ^
)FF^ _
;FF_ `
servicesGG 
.GG 
AddSingletonGG %
(GG% &
spGG& (
=>GG) +
newGG, /
Dao_InforVisualPartGG0 C
(GGC D'
inforVisualConnectionStringGGD _
)GG_ `
)GG` a
;GGa b
servicesHH 
.HH 
AddSingletonHH %
<HH% &
IService_DispatcherHH& 9
>HH9 :
(HH: ;
spHH; =
=>HH> @
{II 
varJJ 
dispatcherQueueJJ '
=JJ( )
	MicrosoftJJ* 3
.JJ3 4
UIJJ4 6
.JJ6 7
DispatchingJJ7 B
.JJB C
DispatcherQueueJJC R
.JJR S
GetForCurrentThreadJJS f
(JJf g
)JJg h
;JJh i
returnKK 
newKK 
Service_DispatcherKK 1
(KK1 2
dispatcherQueueKK2 A
)KKA B
;KKB C
}LL 
)LL 
;LL 
servicesMM 
.MM 
AddSingletonMM %
<MM% &
IService_WindowMM& 5
,MM5 6
Service_WindowMM7 E
>MME F
(MMF G
)MMG H
;MMH I
servicesNN 
.NN 
AddSingletonNN %
<NN% &#
IService_AuthenticationNN& =
>NN= >
(NN> ?
spNN? A
=>NNB D
{OO 
varPP 
daoUserPP 
=PP  !
spPP" $
.PP$ %
GetRequiredServicePP% 7
<PP7 8
Dao_UserPP8 @
>PP@ A
(PPA B
)PPB C
;PPC D
varQQ 
errorHandlerQQ $
=QQ% &
spQQ' )
.QQ) *
GetRequiredServiceQQ* <
<QQ< =!
IService_ErrorHandlerQQ= R
>QQR S
(QQS T
)QQT U
;QQU V
returnRR 
newRR "
Service_AuthenticationRR 5
(RR5 6
daoUserRR6 =
,RR= >
errorHandlerRR? K
)RRK L
;RRL M
}SS 
)SS 
;SS 
servicesTT 
.TT 
AddSingletonTT %
<TT% &'
IService_UserSessionManagerTT& A
>TTA B
(TTB C
spTTC E
=>TTF H
{UU 
varVV 
daoUserVV 
=VV  !
spVV" $
.VV$ %
GetRequiredServiceVV% 7
<VV7 8
Dao_UserVV8 @
>VV@ A
(VVA B
)VVB C
;VVC D
varWW 
dispatcherServiceWW )
=WW* +
spWW, .
.WW. /
GetRequiredServiceWW/ A
<WWA B
IService_DispatcherWWB U
>WWU V
(WWV W
)WWW X
;WWX Y
returnXX 
newXX &
Service_UserSessionManagerXX 9
(XX9 :
daoUserXX: A
,XXA B
dispatcherServiceXXC T
)XXT U
;XXU V
}YY 
)YY 
;YY 
servicesZZ 
.ZZ 
AddTransientZZ %
<ZZ% &$
IService_UserPreferencesZZ& >
,ZZ> ?#
Service_UserPreferencesZZ@ W
>ZZW X
(ZZX Y
)ZZY Z
;ZZZ [
services]] 
.]] 
AddTransient]] %
<]]% &+
IService_OnStartup_AppLifecycle]]& E
,]]E F*
Service_OnStartup_AppLifecycle]]G e
>]]e f
(]]f g
)]]g h
;]]h i
services`` 
.`` 
AddSingleton`` %
<``% & 
IService_InforVisual``& :
,``: ;
Service_InforVisual``< O
>``O P
(``P Q
)``Q R
;``R S
servicesaa 
.aa 
AddSingletonaa %
<aa% &$
IService_MySQL_Receivingaa& >
>aa> ?
(aa? @
spaa@ B
=>aaC E
{aaF G
varaaH K
loggeraaL R
=aaS T
spaaU W
.aaW X
GetRequiredServiceaaX j
<aaj k$
IService_LoggingUtility	aak Ç
>
aaÇ É
(
aaÉ Ñ
)
aaÑ Ö
;
aaÖ Ü
return
aaá ç
new
aaé ë%
Service_MySQL_Receiving
aaí ©
(
aa© ™'
Helper_Database_Variables
aa™ √
.
aa√ ƒ!
GetConnectionString
aaƒ ◊
(
aa◊ ÿ
)
aaÿ Ÿ
,
aaŸ ⁄
logger
aa€ ·
)
aa· ‚
;
aa‚ „
}
aa‰ Â
)
aaÂ Ê
;
aaÊ Á
servicesbb 
.bb 
AddTransientbb %
<bb% &(
IService_MySQL_ReceivingLinebb& B
,bbB C'
Service_MySQL_ReceivingLinebbD _
>bb_ `
(bb` a
)bba b
;bbb c
servicescc 
.cc 
AddSingletoncc %
<cc% &-
!IService_MySQL_PackagePreferencescc& G
>ccG H
(ccH I
spccI K
=>ccL N
newccO R,
 Service_MySQL_PackagePreferencesccS s
(ccs t&
Helper_Database_Variables	cct ç
.
ccç é!
GetConnectionString
ccé °
(
cc° ¢
)
cc¢ £
)
cc£ §
)
cc§ •
;
cc• ¶
servicesdd 
.dd 
AddSingletondd %
<dd% &#
IService_SessionManagerdd& =
>dd= >
(dd> ?
spdd? A
=>ddB D
{ddE F
varddG J
loggerddK Q
=ddR S
spddT V
.ddV W
GetRequiredServiceddW i
<ddi j$
IService_LoggingUtility	ddj Å
>
ddÅ Ç
(
ddÇ É
)
ddÉ Ñ
;
ddÑ Ö
return
ddÜ å
new
ddç ê$
Service_SessionManager
ddë ß
(
ddß ®
logger
dd® Æ
)
ddÆ Ø
;
ddØ ∞
}
dd± ≤
)
dd≤ ≥
;
dd≥ ¥
servicesee 
.ee 
AddSingletonee %
<ee% &
IService_CSVWriteree& 8
>ee8 9
(ee9 :
spee: <
=>ee= ?
{ee@ A
vareeB E
sessionManagereeF T
=eeU V
speeW Y
.eeY Z
GetRequiredServiceeeZ l
<eel m(
IService_UserSessionManager	eem à
>
eeà â
(
eeâ ä
)
eeä ã
;
eeã å
var
eeç ê
logger
eeë ó
=
eeò ô
sp
eeö ú
.
eeú ù 
GetRequiredService
eeù Ø
<
eeØ ∞%
IService_LoggingUtility
ee∞ «
>
ee« »
(
ee» …
)
ee…  
;
ee  À
return
eeÃ “
new
ee” ÷
Service_CSVWriter
ee◊ Ë
(
eeË È
sessionManager
eeÈ ˜
,
ee˜ ¯
logger
ee˘ ˇ
)
eeˇ Ä
;
eeÄ Å
}
eeÇ É
)
eeÉ Ñ
;
eeÑ Ö
servicesff 
.ff 
AddSingletonff %
<ff% &(
IService_ReceivingValidationff& B
,ffB C'
Service_ReceivingValidationffD _
>ff_ `
(ff` a
)ffa b
;ffb c
servicesgg 
.gg 
AddSingletongg %
<gg% &&
IService_ReceivingWorkflowgg& @
,gg@ A%
Service_ReceivingWorkflowggB [
>gg[ \
(gg\ ]
)gg] ^
;gg^ _
serviceshh 
.hh 
AddTransienthh %
<hh% &
IService_Paginationhh& 9
,hh9 :
Service_Paginationhh; M
>hhM N
(hhN O
)hhO P
;hhP Q
serviceskk 
.kk 
AddTransientkk %
<kk% &"
IService_MySQL_Dunnagekk& <
,kk< =!
Service_MySQL_Dunnagekk> S
>kkS T
(kkT U
)kkU V
;kkV W
servicesll 
.ll 
AddTransientll %
<ll% &%
IService_DunnageCSVWriterll& ?
,ll? @$
Service_DunnageCSVWriterllA Y
>llY Z
(llZ [
)ll[ \
;ll\ ]
servicesmm 
.mm 
AddSingletonmm %
<mm% &$
IService_DunnageWorkflowmm& >
,mm> ?#
Service_DunnageWorkflowmm@ W
>mmW X
(mmX Y
)mmY Z
;mmZ [
servicespp 
.pp 
AddTransientpp %
<pp% &&
Shared_MainWindowViewModelpp& @
>pp@ A
(ppA B
)ppB C
;ppC D
servicesqq 
.qq 
AddTransientqq %
<qq% &(
Shared_SplashScreenViewModelqq& B
>qqB C
(qqC D
)qqD E
;qqE F
servicesrr 
.rr 
AddTransientrr %
<rr% &/
#Shared_SharedTerminalLoginViewModelrr& I
>rrI J
(rrJ K
)rrK L
;rrL M
servicesss 
.ss 
AddTransientss %
<ss% &(
Shared_NewUserSetupViewModelss& B
>ssB C
(ssC D
)ssD E
;ssE F
servicestt 
.tt 
AddTransienttt %
<tt% &(
Main_ReceivingLabelViewModeltt& B
>ttB C
(ttC D
)ttD E
;ttE F
servicesuu 
.uu 
AddTransientuu %
<uu% &&
Main_DunnageLabelViewModeluu& @
>uu@ A
(uuA B
)uuB C
;uuC D
servicesvv 
.vv 
AddTransientvv %
<vv% &.
"Main_CarrierDeliveryLabelViewModelvv& H
>vvH I
(vvI J
)vvJ K
;vvK L
servicesyy 
.yy 
AddTransientyy %
<yy% &0
$Receiving_ReceivingWorkflowViewModelyy& J
>yyJ K
(yyK L
)yyL M
;yyM N
serviceszz 
.zz 
AddTransientzz %
<zz% &5
)Receiving_ReceivingModeSelectionViewModelzz& O
>zzO P
(zzP Q
)zzQ R
;zzR S
services{{ 
.{{ 
AddTransient{{ %
<{{% &*
Receiving_ManualEntryViewModel{{& D
>{{D E
({{E F
){{F G
;{{G H
services|| 
.|| 
AddTransient|| %
<||% &'
Receiving_EditModeViewModel||& A
>||A B
(||B C
)||C D
;||D E
services}} 
.}} 
AddTransient}} %
<}}% &&
Receiving_POEntryViewModel}}& @
>}}@ A
(}}A B
)}}B C
;}}C D
services~~ 
.~~ 
AddTransient~~ %
<~~% &(
Receiving_LoadEntryViewModel~~& B
>~~B C
(~~C D
)~~D E
;~~E F
services 
. 
AddTransient %
<% &-
!Receiving_WeightQuantityViewModel& G
>G H
(H I
)I J
;J K
services
ÄÄ 
.
ÄÄ 
AddTransient
ÄÄ %
<
ÄÄ% &(
Receiving_HeatLotViewModel
ÄÄ& @
>
ÄÄ@ A
(
ÄÄA B
)
ÄÄB C
;
ÄÄC D
services
ÅÅ 
.
ÅÅ 
AddTransient
ÅÅ %
<
ÅÅ% &,
Receiving_PackageTypeViewModel
ÅÅ& D
>
ÅÅD E
(
ÅÅE F
)
ÅÅF G
;
ÅÅG H
services
ÇÇ 
.
ÇÇ 
AddTransient
ÇÇ %
<
ÇÇ% &+
Receiving_ReviewGridViewModel
ÇÇ& C
>
ÇÇC D
(
ÇÇD E
)
ÇÇE F
;
ÇÇF G
services
ÖÖ 
.
ÖÖ 
AddTransient
ÖÖ %
<
ÖÖ% &,
Dunnage_ModeSelectionViewModel
ÖÖ& D
>
ÖÖD E
(
ÖÖE F
)
ÖÖF G
;
ÖÖG H
services
ÜÜ 
.
ÜÜ 
AddTransient
ÜÜ %
<
ÜÜ% &,
Dunnage_TypeSelectionViewModel
ÜÜ& D
>
ÜÜD E
(
ÜÜE F
)
ÜÜF G
;
ÜÜG H
services
áá 
.
áá 
AddTransient
áá %
<
áá% &,
Dunnage_PartSelectionViewModel
áá& D
>
ááD E
(
ááE F
)
ááF G
;
ááG H
services
àà 
.
àà 
AddTransient
àà %
<
àà% &,
Dunnage_QuantityEntryViewModel
àà& D
>
ààD E
(
ààE F
)
ààF G
;
ààG H
services
ââ 
.
ââ 
AddTransient
ââ %
<
ââ% &+
Dunnage_DetailsEntryViewModel
ââ& C
>
ââC D
(
ââD E
)
ââE F
;
ââF G
services
ää 
.
ää 
AddTransient
ää %
<
ää% &%
Dunnage_ReviewViewModel
ää& =
>
ää= >
(
ää> ?
)
ää? @
;
ää@ A
services
ãã 
.
ãã 
AddTransient
ãã %
<
ãã% &*
Dunnage_ManualEntryViewModel
ãã& B
>
ããB C
(
ããC D
)
ããD E
;
ããE F
services
åå 
.
åå 
AddTransient
åå %
<
åå% &'
Dunnage_EditModeViewModel
åå& ?
>
åå? @
(
åå@ A
)
ååA B
;
ååB C
services
èè 
.
èè 
AddTransient
èè %
<
èè% &%
Main_ReceivingLabelPage
èè& =
>
èè= >
(
èè> ?
)
èè? @
;
èè@ A
services
êê 
.
êê 
AddTransient
êê %
<
êê% &#
Main_DunnageLabelPage
êê& ;
>
êê; <
(
êê< =
)
êê= >
;
êê> ?
services
ëë 
.
ëë 
AddTransient
ëë %
<
ëë% &+
Main_CarrierDeliveryLabelPage
ëë& C
>
ëëC D
(
ëëD E
)
ëëE F
;
ëëF G
services
îî 
.
îî 
AddTransient
îî %
<
îî% &
Views
îî& +
.
îî+ ,
Shared
îî, 2
.
îî2 3'
Shared_SplashScreenWindow
îî3 L
>
îîL M
(
îîM N
)
îîN O
;
îîO P
services
ïï 
.
ïï 
AddTransient
ïï %
<
ïï% &
Views
ïï& +
.
ïï+ ,
Shared
ïï, 2
.
ïï2 3.
 Shared_SharedTerminalLoginDialog
ïï3 S
>
ïïS T
(
ïïT U
)
ïïU V
;
ïïV W
services
ññ 
.
ññ 
AddTransient
ññ %
<
ññ% &
Views
ññ& +
.
ññ+ ,
Shared
ññ, 2
.
ññ2 3'
Shared_NewUserSetupDialog
ññ3 L
>
ññL M
(
ññM N
)
ññN O
;
ññO P
services
óó 
.
óó 
AddSingleton
óó %
<
óó% &

MainWindow
óó& 0
>
óó0 1
(
óó1 2
)
óó2 3
;
óó3 4
}
òò 
)
òò 
.
ôô 
Build
ôô 
(
ôô 
)
ôô 
;
ôô 
}
öö 
	protected
üü 
override
üü 
async
üü 
void
üü !

OnLaunched
üü" ,
(
üü, -&
LaunchActivatedEventArgs
üü- E
args
üüF J
)
üüJ K
{
†† 
var
°° 
startupService
°° 
=
°° 
_host
°° "
.
°°" #
Services
°°# +
.
°°+ , 
GetRequiredService
°°, >
<
°°> ?-
IService_OnStartup_AppLifecycle
°°? ^
>
°°^ _
(
°°_ `
)
°°` a
;
°°a b
await
¢¢ 
startupService
¢¢ 
.
¢¢ 

StartAsync
¢¢ '
(
¢¢' (
)
¢¢( )
;
¢¢) *
var
•• 
sessionManager
•• 
=
•• 
_host
•• "
.
••" #
Services
••# +
.
••+ , 
GetRequiredService
••, >
<
••> ?)
IService_UserSessionManager
••? Z
>
••Z [
(
••[ \
)
••\ ]
;
••] ^
sessionManager
¶¶ 
.
¶¶ 
SessionTimedOut
¶¶ &
+=
¶¶' )
OnSessionTimedOut
¶¶* ;
;
¶¶; <
if
®® 

(
®® 

MainWindow
®® 
!=
®® 
null
®® 
)
®® 
{
©© 	

MainWindow
™™ 
.
™™ 
Closed
™™ 
+=
™™   
OnMainWindowClosed
™™! 3
;
™™3 4
}
´´ 	
}
¨¨ 
private
ÆÆ 
void
ÆÆ 
OnSessionTimedOut
ÆÆ "
(
ÆÆ" #
object
ÆÆ# )
?
ÆÆ) *
sender
ÆÆ+ 1
,
ÆÆ1 2&
SessionTimedOutEventArgs
ÆÆ3 K
e
ÆÆL M
)
ÆÆM N
{
ØØ 

MainWindow
≤≤ 
?
≤≤ 
.
≤≤ 
Close
≤≤ 
(
≤≤ 
)
≤≤ 
;
≤≤ 
}
≥≥ 
private
µµ 
async
µµ 
void
µµ  
OnMainWindowClosed
µµ )
(
µµ) *
object
µµ* 0
sender
µµ1 7
,
µµ7 8
WindowEventArgs
µµ9 H
args
µµI M
)
µµM N
{
∂∂ 
var
∑∑ 
sessionManager
∑∑ 
=
∑∑ 
_host
∑∑ "
.
∑∑" #
Services
∑∑# +
.
∑∑+ , 
GetRequiredService
∑∑, >
<
∑∑> ?)
IService_UserSessionManager
∑∑? Z
>
∑∑Z [
(
∑∑[ \
)
∑∑\ ]
;
∑∑] ^
await
∏∏ 
sessionManager
∏∏ 
.
∏∏ 
EndSessionAsync
∏∏ ,
(
∏∏, -
$str
∏∏- ;
)
∏∏; <
;
∏∏< =
}
ππ 
public
ææ 

static
ææ 
T
ææ 

GetService
ææ 
<
ææ 
T
ææ  
>
ææ  !
(
ææ! "
)
ææ" #
where
ææ$ )
T
ææ* +
:
ææ, -
class
ææ. 3
{
øø 
return
¿¿ 
(
¿¿ 
(
¿¿ 
App
¿¿ 
)
¿¿ 
Current
¿¿ 
)
¿¿ 
.
¿¿ 
_host
¿¿ #
.
¿¿# $
Services
¿¿$ ,
.
¿¿, -

GetService
¿¿- 7
<
¿¿7 8
T
¿¿8 9
>
¿¿9 :
(
¿¿: ;
)
¿¿; <
??
¡¡ 
throw
¡¡ 
new
¡¡ '
InvalidOperationException
¡¡ 2
(
¡¡2 3
$"
¡¡3 5
$str
¡¡5 =
{
¡¡= >
typeof
¡¡> D
(
¡¡D E
T
¡¡E F
)
¡¡F G
}
¡¡G H
$str
¡¡H R
"
¡¡R S
)
¡¡S T
;
¡¡T U
}
¬¬ 
}√√ 