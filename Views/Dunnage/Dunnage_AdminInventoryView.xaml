<Page
    x:Class="MTM_Receiving_Application.Views.Dunnage.Dunnage_AdminInventoryView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:MTM_Receiving_Application.Models.Dunnage"
    xmlns:converters="using:MTM_Receiving_Application.Converters"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <converters:Converter_IntToVisibility x:Key="IntToVisibilityConverter"/>
    </Page.Resources>

    <Grid Padding="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="12" Margin="0,0,0,16">
            <Button Content="â† Back to Hub" 
                    Command="{x:Bind ViewModel.BackToHubCommand}"
                    Style="{StaticResource AccentButtonStyle}"/>
            <TextBlock Text="Manage Inventoried Parts" 
                       Style="{StaticResource TitleTextBlockStyle}"
                       VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Toolbar -->
        <CommandBar Grid.Row="1" DefaultLabelPosition="Right" Margin="0,0,0,12">
            <AppBarButton Icon="Add" Label="Add Part to List" Command="{x:Bind ViewModel.ShowAddToListCommand}"/>
            <AppBarButton Icon="Edit" Label="Edit Entry" Command="{x:Bind ViewModel.ShowEditEntryCommand}"/>
            <AppBarButton Icon="Delete" Label="Remove from List" Command="{x:Bind ViewModel.ShowRemoveConfirmationCommand}"/>
            <AppBarSeparator/>
            <AppBarButton Icon="Refresh" Label="Refresh" Command="{x:Bind ViewModel.LoadInventoriedPartsCommand}"/>
        </CommandBar>

        <!-- Data Grid -->
        <Grid Grid.Row="2">
            <ListView
                x:Name="InventoryListView"
                ItemsSource="{x:Bind ViewModel.InventoriedParts, Mode=OneWay}"
                SelectedItem="{x:Bind ViewModel.SelectedInventoriedPart, Mode=TwoWay}"
                SelectionMode="Single">
                
                <ListView.HeaderTemplate>
                    <DataTemplate>
                        <Grid Padding="12,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="120"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Part ID" FontWeight="Bold"/>
                            <TextBlock Grid.Column="1" Text="Inventory Method" FontWeight="Bold"/>
                            <TextBlock Grid.Column="2" Text="Notes" FontWeight="Bold"/>
                            <TextBlock Grid.Column="3" Text="Date Added" FontWeight="Bold"/>
                            <TextBlock Grid.Column="4" Text="Added By" FontWeight="Bold"/>
                            <TextBlock Grid.Column="5" Text="Last Modified" FontWeight="Bold"/>
                            <TextBlock Grid.Column="6" Text="Modified By" FontWeight="Bold"/>
                        </Grid>
                    </DataTemplate>
                </ListView.HeaderTemplate>
                
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="models:Model_InventoriedDunnage">
                        <Grid Padding="12,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="120"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="{x:Bind PartId, Mode=OneWay}"/>
                            <TextBlock Grid.Column="1" Text="{x:Bind InventoryMethod, Mode=OneWay}"/>
                            <TextBlock Grid.Column="2" Text="{x:Bind Notes, Mode=OneWay}" TextWrapping="Wrap"/>
                            <TextBlock Grid.Column="3" Text="{x:Bind CreatedDate, Mode=OneWay}"/>
                            <TextBlock Grid.Column="4" Text="{x:Bind CreatedBy, Mode=OneWay}"/>
                            <TextBlock Grid.Column="5" Text="{x:Bind ModifiedDate, Mode=OneWay}"/>
                            <TextBlock Grid.Column="6" Text="{x:Bind ModifiedBy, Mode=OneWay}"/>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <!-- Empty state -->
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center"
                        Visibility="{x:Bind ViewModel.InventoriedParts.Count, Mode=OneWay, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=Inverse}">
                <TextBlock Text="No inventoried parts configured" 
                           Style="{StaticResource SubtitleTextBlockStyle}"
                           HorizontalAlignment="Center"
                           Foreground="{ThemeResource SystemControlDisabledBaseMediumLowBrush}"/>
                <TextBlock Text="Click 'Add Part to List' to configure parts that require inventory tracking"
                           HorizontalAlignment="Center"
                           Margin="0,8,0,0"
                           Foreground="{ThemeResource SystemControlDisabledBaseMediumLowBrush}"/>
            </StackPanel>
        </Grid>

        <!-- Status Bar -->
        <Grid Grid.Row="3" Margin="0,12,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <ProgressRing Grid.Column="0"
                          IsActive="{x:Bind ViewModel.IsBusy, Mode=OneWay}"
                          Width="20" Height="20"
                          Margin="0,0,8,0"/>

            <TextBlock Grid.Column="1"
                       Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}"
                       VerticalAlignment="Center"
                       Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
        </Grid>
    </Grid>
</Page>
