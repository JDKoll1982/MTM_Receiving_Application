<UserControl
    x:Class="MTM_Receiving_Application.Views.Receiving.ReviewGridView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,16">
            <TextBlock Text="Review and Edit Loads" Style="{StaticResource SubtitleTextBlockStyle}"/>
            <TextBlock Text="Edit values in the grid below. Changes to PO or Part # will update all loads." 
                       Style="{StaticResource CaptionTextBlockStyle}" 
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
        </StackPanel>

        <controls:DataGrid Grid.Row="1"
                          x:Name="ReviewDataGrid"
                          ItemsSource="{x:Bind ViewModel.Loads, Mode=OneWay}"
                          AutoGenerateColumns="False"
                          GridLinesVisibility="All"
                          HeadersVisibility="Column"
                          CanUserSortColumns="False"
                          SelectionMode="Single"
                          CellEditEnding="ReviewDataGrid_CellEditEnding">
            <controls:DataGrid.Columns>
                <controls:DataGridTextColumn Header="Load #" Binding="{Binding LoadNumber}" IsReadOnly="True"/>
                <controls:DataGridTextColumn Header="PO Number" Binding="{Binding PoNumber, TargetNullValue='N/A'}"/>
                <controls:DataGridTextColumn Header="Part ID" Binding="{Binding PartID}"/>
                <controls:DataGridTextColumn Header="Weight/Qty" Binding="{Binding WeightQuantity}"/>
                <controls:DataGridTextColumn Header="Heat/Lot #" Binding="{Binding HeatLotNumber}"/>
                <controls:DataGridTextColumn Header="Pkgs" Binding="{Binding PackagesPerLoad}"/>
                <controls:DataGridTextColumn Header="Pkg Type" Binding="{Binding PackageTypeName}"/>
                <controls:DataGridTextColumn Header="Weight/Pkg" Binding="{Binding WeightPerPackageDisplay}" IsReadOnly="True"/>
            </controls:DataGrid.Columns>
        </controls:DataGrid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="12" Margin="0,16,0,0" HorizontalAlignment="Right">
            <Button Content="Add Another Part/PO" 
                    Command="{x:Bind ViewModel.AddAnotherPartCommand}"
                    Style="{StaticResource DefaultButtonStyle}"/>
            
            <Button Content="Save to CSV &amp; Database" 
                    Command="{x:Bind ViewModel.SaveCommand}"
                    Style="{StaticResource AccentButtonStyle}"/>
        </StackPanel>
    </Grid>
</UserControl>
