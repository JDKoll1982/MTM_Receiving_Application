<UserControl
x:Class="MTM_Receiving_Application.Module_Receiving.Views.Wizard.Step1.View_Receiving_Wizard_Display_PartSelection"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:converters="using:MTM_Receiving_Application.Module_Core.Converters"
mc:Ignorable="d">

<UserControl.Resources>
    <converters:Converter_BooleanToVisibility x:Key="BoolToVisibilityConverter" />
    <converters:Converter_EmptyStringToVisibility x:Key="NullToVisibilityConverter" />
</UserControl.Resources>

    <StackPanel Spacing="12">
        <!-- Part Number Entry TextBox -->
        <TextBox
            x:Name="PartNumberTextBox"
            Text="{x:Bind ViewModel.PartNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
            PlaceholderText="{x:Bind ViewModel.PartNumberPlaceholder, Mode=OneWay}"
            Width="300" />

        <!-- Validation Indicators -->
        <StackPanel Orientation="Horizontal" Spacing="10">
            <!-- Validation Success Indicator -->
            <FontIcon
                Glyph="&#xE73E;"
                Foreground="Green"
                FontSize="20"
                Visibility="{x:Bind ViewModel.IsPartValid, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}" />

            <!-- Validation Error Message -->
            <TextBlock
                Text="{x:Bind ViewModel.PartValidationMessage, Mode=OneWay}"
                TextWrapping="Wrap"
                Foreground="{ThemeResource SystemFillColorCriticalBrush}"
                Visibility="{x:Bind ViewModel.IsPartValid, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}" />

            <!-- Loading Indicator -->
            <ProgressRing
                Width="20"
                Height="20"
                IsActive="{x:Bind ViewModel.IsLoadingPartDetails, Mode=OneWay}" />
        </StackPanel>

        <!-- Part Type Selection -->
        <ComboBox
            Header="Part Type"
            ItemsSource="{x:Bind ViewModel.AvailablePartTypes, Mode=OneWay}"
            SelectedItem="{x:Bind ViewModel.SelectedPartType, Mode=TwoWay}"
            DisplayMemberPath="TypeName"
            Width="300"
            Visibility="{x:Bind ViewModel.IsPartValid, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}" />

        <!-- Part Details Display Panel -->
        <Border
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="1"
            CornerRadius="8"
            Padding="16"
            Visibility="{x:Bind ViewModel.SelectedPartType, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}">
            <StackPanel Spacing="8">
                <TextBlock>
                    <Run Text="Description: " FontWeight="SemiBold" />
                    <Run Text="{x:Bind ViewModel.PartDescription, Mode=OneWay}" />
                </TextBlock>
                <TextBlock>
                    <Run Text="Default Package Type: " FontWeight="SemiBold" />
                    <Run Text="{x:Bind ViewModel.DefaultPackageType, Mode=OneWay}" />
                </TextBlock>
                <TextBlock>
                    <Run Text="Default Location: " FontWeight="SemiBold" />
                    <Run Text="{x:Bind ViewModel.DefaultReceivingLocation, Mode=OneWay}" />
                </TextBlock>
            </StackPanel>
        </Border>

        <!-- Help Text -->
        <TextBlock
            Text="Enter the part number. Auto-padding will format it to 6 digits. Part type will be detected automatically."
            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
            FontSize="12"
            TextWrapping="Wrap" />
    </StackPanel>
</UserControl>
