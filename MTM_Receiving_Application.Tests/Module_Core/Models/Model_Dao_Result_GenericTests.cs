// <auto-generated>
// This test file was generated by GitHub Copilot
// Generation Date: 2025-01-19
// Source File: Module_Core/Models/Core/Model_Dao_Result_Generic.cs
// </auto-generated>

using FluentAssertions;
using MTM_Receiving_Application.Module_Core.Models.Core;
using MTM_Receiving_Application.Module_Core.Models.Enums;
using Xunit;

namespace MTM_Receiving_Application.Tests.Module_Core.Models;

/// <summary>
/// Unit tests for <see cref="Model_Dao_Result{T}"/>.
/// Tests the generic version of Model_Dao_Result that returns typed data.
/// </summary>
[Trait("Category", "Unit")]
[Trait("Layer", "Model")]
[Trait("Module", "Module_Core")]
public class Model_Dao_Result_GenericTests
{
    [Fact]
    public void Constructor_DefaultValues_AreSetCorrectly()
    {
        var sut = new Model_Dao_Result<string>();

        sut.Success.Should().BeFalse();
        sut.IsSuccess.Should().BeFalse();
        sut.ErrorMessage.Should().BeEmpty();
        sut.Severity.Should().Be(Enum_ErrorSeverity.Info);
        sut.AffectedRows.Should().Be(0);
        sut.ExecutionTimeMs.Should().Be(0);
        sut.ReturnValue.Should().BeNull();
        sut.Exception.Should().BeNull();
        sut.Data.Should().BeNull();
    }

    [Fact]
    public void Data_CanBeSetToString()
    {
        var sut = new Model_Dao_Result<string>
        {
            Data = "Test data"
        };

        sut.Data.Should().Be("Test data");
    }

    [Fact]
    public void Data_CanBeSetToInt()
    {
        var sut = new Model_Dao_Result<int>
        {
            Data = 42
        };

        sut.Data.Should().Be(42);
    }

    [Fact]
    public void Data_CanBeSetToComplexObject()
    {
        var testObject = new TestModel { Id = 1, Name = "Test" };
        var sut = new Model_Dao_Result<TestModel>
        {
            Data = testObject
        };

        sut.Data.Should().Be(testObject);
        sut.Data!.Id.Should().Be(1);
        sut.Data.Name.Should().Be("Test");
    }

    [Fact]
    public void Data_CanBeSetToList()
    {
        var testList = new List<string> { "Item1", "Item2", "Item3" };
        var sut = new Model_Dao_Result<List<string>>
        {
            Data = testList
        };

        sut.Data.Should().BeEquivalentTo(testList);
        sut.Data.Should().HaveCount(3);
    }

    [Fact]
    public void InheritsFromBaseModel_Dao_Result()
    {
        var sut = new Model_Dao_Result<string>();

        sut.Should().BeAssignableTo<Model_Dao_Result>();
    }

    [Fact]
    public void SuccessResultWithData_HasAllPropertiesSet()
    {
        var sut = new Model_Dao_Result<int>
        {
            Success = true,
            Data = 42,
            AffectedRows = 1,
            ExecutionTimeMs = 50
        };

        sut.Success.Should().BeTrue();
        sut.IsSuccess.Should().BeTrue();
        sut.Data.Should().Be(42);
        sut.AffectedRows.Should().Be(1);
        sut.ExecutionTimeMs.Should().Be(50);
    }

    [Fact]
    public void FailureResultWithoutData_HasErrorProperties()
    {
        var exception = new InvalidOperationException("Test exception");
        var sut = new Model_Dao_Result<string>
        {
            Success = false,
            ErrorMessage = "Operation failed",
            Severity = Enum_ErrorSeverity.Error,
            Exception = exception
        };

        sut.Success.Should().BeFalse();
        sut.IsSuccess.Should().BeFalse();
        sut.Data.Should().BeNull();
        sut.ErrorMessage.Should().Be("Operation failed");
        sut.Severity.Should().Be(Enum_ErrorSeverity.Error);
        sut.Exception.Should().Be(exception);
    }

    [Fact]
    public void Data_CanBeNull()
    {
        var sut = new Model_Dao_Result<string>
        {
            Success = true,
            Data = null
        };

        sut.Data.Should().BeNull();
    }

    #region Test Types

    private class TestModel
    {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
    }

    #endregion
}
