// <auto-generated>
// This test file was generated by GitHub Copilot
// Generation Date: 2025-01-19
// Source File: Module_Core/Models/Core/Model_Dao_Result_Factory.cs
// </auto-generated>

using FluentAssertions;
using MTM_Receiving_Application.Module_Core.Models.Core;
using MTM_Receiving_Application.Module_Core.Models.Enums;
using Xunit;

namespace MTM_Receiving_Application.Tests.Module_Core.Models;

/// <summary>
/// Unit tests for <see cref="Model_Dao_Result_Factory"/>.
/// Tests factory methods for creating Model_Dao_Result instances.
/// </summary>
[Trait("Category", "Unit")]
[Trait("Layer", "Model")]
[Trait("Module", "Module_Core")]
public class Model_Dao_Result_FactoryTests
{
    [Fact]
    public void Failure_WithMessage_ReturnsFailureResult()
    {
        var result = Model_Dao_Result_Factory.Failure("Test error");

        result.Success.Should().BeFalse();
        result.IsSuccess.Should().BeFalse();
        result.ErrorMessage.Should().Be("Test error");
        result.Severity.Should().Be(Enum_ErrorSeverity.Error);
        result.Exception.Should().BeNull();
    }

    [Fact]
    public void Failure_WithMessageAndException_ReturnsFailureResultWithException()
    {
        var exception = new InvalidOperationException("Test exception");
        var result = Model_Dao_Result_Factory.Failure("Test error", exception);

        result.Success.Should().BeFalse();
        result.ErrorMessage.Should().Be("Test error");
        result.Exception.Should().Be(exception);
        result.Severity.Should().Be(Enum_ErrorSeverity.Error);
    }

    [Fact]
    public void Failure_WithNullMessage_UsesDefaultMessage()
    {
        var result = Model_Dao_Result_Factory.Failure(null);

        result.Success.Should().BeFalse();
        result.ErrorMessage.Should().Be("Operation failed.");
    }

    [Fact]
    public void Failure_WithEmptyMessage_UsesDefaultMessage()
    {
        var result = Model_Dao_Result_Factory.Failure(string.Empty);

        result.Success.Should().BeFalse();
        result.ErrorMessage.Should().Be("Operation failed.");
    }

    [Fact]
    public void Failure_WithWhitespaceMessage_UsesDefaultMessage()
    {
        var result = Model_Dao_Result_Factory.Failure("   ");

        result.Success.Should().BeFalse();
        result.ErrorMessage.Should().Be("Operation failed.");
    }

    [Fact]
    public void Success_WithoutAffectedRows_ReturnsSuccessResult()
    {
        var result = Model_Dao_Result_Factory.Success();

        result.Success.Should().BeTrue();
        result.IsSuccess.Should().BeTrue();
        result.ErrorMessage.Should().BeEmpty();
        result.AffectedRows.Should().Be(0);
    }

    [Fact]
    public void Success_WithAffectedRows_ReturnsSuccessResultWithCount()
    {
        var result = Model_Dao_Result_Factory.Success(affectedRows: 5);

        result.Success.Should().BeTrue();
        result.AffectedRows.Should().Be(5);
        result.ErrorMessage.Should().BeEmpty();
    }

    [Fact]
    public void Success_WithNegativeAffectedRows_ReturnsZero()
    {
        var result = Model_Dao_Result_Factory.Success(affectedRows: -5);

        result.AffectedRows.Should().Be(0);
    }

    [Fact]
    public void FailureGeneric_WithMessage_ReturnsFailureResult()
    {
        var result = Model_Dao_Result_Factory.Failure<string>("Test error");

        result.Success.Should().BeFalse();
        result.IsSuccess.Should().BeFalse();
        result.ErrorMessage.Should().Be("Test error");
        result.Severity.Should().Be(Enum_ErrorSeverity.Error);
        result.Data.Should().BeNull();
        result.Exception.Should().BeNull();
    }

    [Fact]
    public void FailureGeneric_WithMessageAndException_ReturnsFailureResultWithException()
    {
        var exception = new InvalidOperationException("Test exception");
        var result = Model_Dao_Result_Factory.Failure<int>("Test error", exception);

        result.Success.Should().BeFalse();
        result.ErrorMessage.Should().Be("Test error");
        result.Exception.Should().Be(exception);
        result.Data.Should().Be(0);
    }

    [Fact]
    public void FailureGeneric_WithNullMessage_UsesDefaultMessage()
    {
        var result = Model_Dao_Result_Factory.Failure<string>(null);

        result.Success.Should().BeFalse();
        result.ErrorMessage.Should().Be("Operation failed.");
    }

    [Fact]
    public void SuccessGeneric_WithData_ReturnsSuccessResultWithData()
    {
        var result = Model_Dao_Result_Factory.Success("Test data");

        result.Success.Should().BeTrue();
        result.IsSuccess.Should().BeTrue();
        result.Data.Should().Be("Test data");
        result.ErrorMessage.Should().BeEmpty();
        result.AffectedRows.Should().Be(0);
    }

    [Fact]
    public void SuccessGeneric_WithDataAndAffectedRows_ReturnsSuccessResultWithBoth()
    {
        var result = Model_Dao_Result_Factory.Success(42, affectedRows: 3);

        result.Success.Should().BeTrue();
        result.Data.Should().Be(42);
        result.AffectedRows.Should().Be(3);
        result.ErrorMessage.Should().BeEmpty();
    }

    [Fact]
    public void SuccessGeneric_WithNegativeAffectedRows_ReturnsZero()
    {
        var result = Model_Dao_Result_Factory.Success("data", affectedRows: -10);

        result.AffectedRows.Should().Be(0);
    }

    [Fact]
    public void SuccessGeneric_WithComplexObject_ReturnsSuccessResultWithObject()
    {
        var testObject = new TestModel { Id = 1, Name = "Test" };
        var result = Model_Dao_Result_Factory.Success(testObject);

        result.Success.Should().BeTrue();
        result.Data.Should().Be(testObject);
        result.Data!.Id.Should().Be(1);
        result.Data.Name.Should().Be("Test");
    }

    [Fact]
    public void SuccessGeneric_WithList_ReturnsSuccessResultWithList()
    {
        var testList = new List<string> { "Item1", "Item2" };
        var result = Model_Dao_Result_Factory.Success(testList, affectedRows: 2);

        result.Success.Should().BeTrue();
        result.Data.Should().BeEquivalentTo(testList);
        result.AffectedRows.Should().Be(2);
    }

    #region Test Types

    private class TestModel
    {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
    }

    #endregion
}
