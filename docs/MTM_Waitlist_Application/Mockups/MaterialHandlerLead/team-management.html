<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MH Lead - Team Management | MTM Waitlist</title>
    <link rel="stylesheet" href="../Shared/winui3-theme.css">
    <link rel="stylesheet" href="../Shared/styles.css">
</head>
<body>
    <div class="app-shell">
        <nav class="nav-pane">
            <div class="nav-pane-header">
                <h1>MTM Waitlist</h1>
                <div class="subtitle">MH Lead</div>
                <div class="subtitle" style="margin-top: 4px;">
                    <strong>Lead Name</strong> â€¢ Expo Drive
                </div>
            </div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="waitlist.html" class="nav-item-link">
                        <span class="nav-item-icon fluent-icon icon-home"></span>
                        <span class="nav-item-text">Waitlist & Analytics</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="analytics.html" class="nav-item-link">
                        <span class="nav-item-icon fluent-icon icon-analytics"></span>
                        <span class="nav-item-text">Full Analytics</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="team-management.html" class="nav-item-link selected">
                        <span class="nav-item-icon fluent-icon icon-people"></span>
                        <span class="nav-item-text">Team Management</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="controls.html" class="nav-item-link">
                        <span class="nav-item-icon fluent-icon icon-settings"></span>
                        <span class="nav-item-text">Controls</span>
                    </a>
                </li>
            </ul>

            <div class="nav-separator"></div>

            <ul class="nav-menu nav-footer">
                <li class="nav-item">
                    <a href="../Login/login.html" class="nav-item-link">
                        <span class="nav-item-icon fluent-icon icon-logout"></span>
                        <span class="nav-item-text">Logout</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="content-area">
            <div class="command-bar">
                <div class="command-bar-left">
                    <h2 class="page-title">Material Handler Team</h2>
                </div>
                <div class="command-bar-right">
                    <select class="form-select" id="statusFilter" style="width: 150px; margin-right: 12px;">
                        <option value="All">All Statuses</option>
                        <option value="Active">Active</option>
                        <option value="On Break">On Break</option>
                        <option value="Offline">Offline</option>
                    </select>
                    <div class="search-box">
                        <input type="text" placeholder="Search handlers..." id="searchInput" />
                    </div>
                </div>
            </div>

            <div class="main-content">
                <!-- Team Status Overview -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px;">
                    <div class="card">
                        <div class="card-content">
                            <div style="font-size: 32px; font-weight: 600; color: var(--success-color);">3</div>
                            <div style="font-size: 12px; color: var(--text-secondary); text-transform: uppercase; margin-top: 4px;">Active</div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div style="font-size: 32px; font-weight: 600; color: var(--warning-color);">1</div>
                            <div style="font-size: 12px; color: var(--text-secondary); text-transform: uppercase; margin-top: 4px;">On Break</div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div style="font-size: 32px; font-weight: 600; color: var(--text-secondary);">4</div>
                            <div style="font-size: 12px; color: var(--text-secondary); text-transform: uppercase; margin-top: 4px;">Total Handlers</div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div style="font-size: 32px; font-weight: 600; color: var(--accent-default);">46</div>
                            <div style="font-size: 12px; color: var(--text-secondary); text-transform: uppercase; margin-top: 4px;">Team Tasks Today</div>
                        </div>
                    </div>
                </div>

                <!-- Team Roster Table -->
                <!-- WinUI3 Equivalent: ListView with GridView ItemTemplate -->
                <table class="winui-table">
                    <thead>
                        <tr>
                            <th>HANDLER NAME</th>
                            <th style="width: 120px;">ASSIGNED ZONE</th>
                            <th style="width: 120px;">STATUS</th>
                            <th style="width: 140px;">TASKS TODAY</th>
                            <th style="width: 140px;">LAST ACTIVITY</th>
                            <th style="width: 200px;">ACTIONS</th>
                        </tr>
                    </thead>
                    <tbody id="teamTableBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>

                <!-- Zone Assignment Panel -->
                <div class="card" style="margin-top: 24px;">
                    <div class="card-header">
                        <h3 class="card-title">Quick Zone Reassignment</h3>
                    </div>
                    <div class="card-content">
                        <p style="margin-bottom: 16px; color: var(--text-secondary);">
                            Select a handler and assign them to a different zone. This will update their task filters immediately.
                        </p>
                        <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 12px; align-items: end;">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label class="form-label" for="reassignHandler">Handler</label>
                                <select class="form-select" id="reassignHandler">
                                    <option value="">Select handler...</option>
                                    <option value="1">Tom Handler</option>
                                    <option value="2">Sarah MH</option>
                                    <option value="3">Mike MH</option>
                                    <option value="4">Lisa MH</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label class="form-label" for="reassignZone">New Zone</label>
                                <select class="form-select" id="reassignZone">
                                    <option value="">Select zone...</option>
                                    <option value="Zone A">Zone A</option>
                                    <option value="Zone B">Zone B</option>
                                    <option value="Zone C">Zone C</option>
                                    <option value="Zone D">Zone D</option>
                                </select>
                            </div>
                            <button class="btn btn-accent" onclick="reassignZone()">
                                <span class="fluent-icon icon-checkmark"></span>
                                Reassign
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="status-bar">
            <div class="status-indicators">
                <div class="status-item">
                    <span class="fluent-icon icon-people"></span>
                    <span>Team Management</span>
                </div>
            </div>
            <div>
                <span id="currentTime"></span>
            </div>
        </div>
    </div>

    <!-- Reassign Task Dialog -->
    <!-- WinUI3 Equivalent: ContentDialog -->
    <div class="dialog-overlay hidden" id="reassignTaskDialog">
        <div class="dialog">
            <div class="dialog-header">
                <h3 class="dialog-title">Reassign Task</h3>
            </div>
            <div class="dialog-content">
                <p style="margin-bottom: 16px; color: var(--text-secondary);">
                    Manually assign a specific task to this handler.
                </p>
                <form id="reassignTaskForm">
                    <div class="form-group">
                        <label class="form-label" for="taskSelect">Select Task</label>
                        <select class="form-select" id="taskSelect" required>
                            <option value="">Choose from waitlist...</option>
                            <option value="1">Press 6 - Spot Weld (41m wait)</option>
                            <option value="2">Receiving Dock 2 (25m wait)</option>
                            <option value="3">Press 3 Transfer (18m wait)</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="dialog-footer">
                <button type="button" class="btn" onclick="closeReassignDialog()">Cancel</button>
                <button type="button" class="btn btn-accent" onclick="submitReassignTask()">
                    <span class="fluent-icon icon-checkmark"></span>
                    Assign Task
                </button>
            </div>
        </div>
    </div>

    <script src="../Shared/mock-data.js"></script>
    <script>
        function populateTeamTable() {
            const tbody = document.getElementById('teamTableBody');
            const handlers = MockData.materialHandlers;

            tbody.innerHTML = handlers.map(handler => {
                const statusClass = handler.status === 'Active' ? 'priority-low' : 
                                  handler.status === 'On Break' ? 'priority-medium' : 'priority-high';
                
                return `
                    <tr>
                        <td>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background-color: var(--accent-default); color: #FFFFFF; display: flex; align-items: center; justify-content: center; font-weight: 600;">
                                    ${handler.name.charAt(0)}
                                </div>
                                <strong>${handler.name}</strong>
                            </div>
                        </td>
                        <td>
                            <span class="priority-badge priority-low">${handler.zone}</span>
                        </td>
                        <td>
                            <span class="status-badge ${statusClass}">${handler.status}</span>
                        </td>
                        <td>
                            <strong>${handler.tasksToday}</strong> tasks
                        </td>
                        <td>
                            <small style="color: var(--text-secondary);">2 min ago</small>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="changeZone(${handler.id})">
                                    <span class="fluent-icon icon-location"></span>
                                    Change Zone
                                </button>
                                <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="assignTask(${handler.id})">
                                    <span class="fluent-icon">&#xE73A;</span>
                                    Assign Task
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function reassignZone() {
            const handlerId = document.getElementById('reassignHandler').value;
            const zone = document.getElementById('reassignZone').value;
            
            if (!handlerId || !zone) {
                alert('Please select both a handler and a zone');
                return;
            }

            console.log('Reassigning handler', handlerId, 'to', zone);
            alert(`Handler reassigned to ${zone} successfully!`);
            
            // Reset form
            document.getElementById('reassignHandler').value = '';
            document.getElementById('reassignZone').value = '';
            
            // In real app, would refresh table
        }

        function changeZone(handlerId) {
            const handler = MockData.materialHandlers.find(h => h.id === handlerId);
            const newZone = prompt(`Change zone for ${handler.name}\nCurrent: ${handler.zone}\nEnter new zone (A, B, C, or D):`);
            
            if (newZone) {
                console.log('Changing zone for', handlerId, 'to Zone', newZone);
                alert(`Zone changed to Zone ${newZone}`);
            }
        }

        function assignTask(handlerId) {
            document.getElementById('reassignTaskDialog').classList.remove('hidden');
        }

        function closeReassignDialog() {
            document.getElementById('reassignTaskDialog').classList.add('hidden');
        }

        function submitReassignTask() {
            const taskId = document.getElementById('taskSelect').value;
            if (!taskId) {
                alert('Please select a task');
                return;
            }

            console.log('Assigning task', taskId);
            alert('Task assigned successfully!');
            closeReassignDialog();
        }

        function updateClock() {
            document.getElementById('currentTime').textContent = new Date().toLocaleTimeString();
        }

        window.addEventListener('load', () => {
            populateTeamTable();
            updateClock();
            setInterval(updateClock, 1000);
        });
    </script>
</body>
</html>
