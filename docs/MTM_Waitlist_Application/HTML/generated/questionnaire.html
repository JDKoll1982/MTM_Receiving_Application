<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTM Waitlist Questionnaire</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .wizard-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .wizard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .wizard-header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .wizard-header .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px 30px;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.3);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            background: #4CAF50;
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-text {
            color: white;
            font-size: 14px;
            text-align: center;
            font-weight: 500;
        }

        .question-container {
            padding: 40px;
            min-height: 500px;
        }

        .question {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .question.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .question-header {
            margin-bottom: 25px;
        }

        .question-number {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .question-title {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .question-description {
            font-size: 16px;
            color: #555;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .info-box {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid;
        }

        .info-box.why-matters {
            background: #e3f2fd;
            border-color: #2196F3;
        }

        .info-box.example {
            background: #f1f8e9;
            border-color: #8bc34a;
        }

        .info-box.note {
            background: #fff3e0;
            border-color: #ff9800;
        }

        .info-box strong {
            display: block;
            margin-bottom: 8px;
            color: #333;
        }

        .question-type-radio .option {
            display: block;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-type-radio .option:hover {
            background: #e9ecef;
            border-color: #667eea;
        }

        .question-type-radio .option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .question-type-radio .option.selected {
            background: #e8eaf6;
            border-color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        }

        .question-type-checkbox .option {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-type-checkbox .option:hover {
            background: #e9ecef;
            border-color: #667eea;
        }

        .question-type-checkbox .option input[type="checkbox"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .question-type-checkbox .option.selected {
            background: #e8f5e9;
            border-color: #4caf50;
        }

        .question-type-dropdown select {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        .question-type-dropdown select:focus {
            outline: none;
            border-color: #667eea;
        }

        .question-type-text input[type="text"],
        .question-type-number input[type="number"],
        .question-type-date input[type="date"] {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            transition: border-color 0.3s ease;
        }

        .question-type-text input:focus,
        .question-type-number input:focus,
        .question-type-date input:focus {
            outline: none;
            border-color: #667eea;
        }

        .question-type-textarea textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .question-type-textarea textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .question-type-range {
            padding: 20px 0;
        }

        .question-type-range input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e9ecef;
            outline: none;
        }

        .question-type-range input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .range-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }

        .range-value {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-top: 10px;
        }

        .question-type-rating {
            text-align: center;
            padding: 20px 0;
        }

        .stars {
            font-size: 48px;
            cursor: pointer;
        }

        .stars .star {
            color: #ddd;
            transition: color 0.2s ease;
        }

        .stars .star.filled {
            color: #ffc107;
        }

        .stars .star:hover,
        .stars .star:hover~.star {
            color: #ffc107;
        }

        .decision-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .decision-section h4 {
            margin-bottom: 15px;
            color: #333;
        }

        .decision-inputs {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 15px;
        }

        .decision-inputs input {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
        }

        .wizard-navigation {
            display: flex;
            justify-content: space-between;
            padding: 30px 40px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }

        .nav-btn {
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .btn-previous {
            background: #6c757d;
            color: white;
        }

        .btn-previous:hover:not(:disabled) {
            background: #5a6268;
        }

        .btn-next {
            background: #667eea;
            color: white;
        }

        .btn-next:hover:not(:disabled) {
            background: #5568d3;
        }

        .btn-review {
            background: #ff9800;
            color: white;
        }

        .btn-review:hover {
            background: #f57c00;
        }

        .btn-finish {
            background: #4caf50;
            color: white;
        }

        .btn-finish:hover {
            background: #45a049;
        }

        .review-container {
            display: none;
        }

        .review-container.active {
            display: block;
        }

        .review-section {
            margin-bottom: 30px;
        }

        .review-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .review-item {
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .review-item .question-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .review-item .answer-value {
            color: #555;
        }

        .edit-btn {
            margin-top: 10px;
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .edit-btn:hover {
            background: #5568d3;
        }

        .success-message {
            display: none;
            text-align: center;
            padding: 60px 40px;
        }

        .success-message.active {
            display: block;
        }

        .success-icon {
            font-size: 80px;
            color: #4caf50;
            margin-bottom: 20px;
        }

        .success-message h2 {
            color: #333;
            margin-bottom: 15px;
        }

        .success-message p {
            color: #666;
            font-size: 16px;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .wizard-container {
                box-shadow: none;
            }

            .wizard-navigation,
            .nav-btn,
            .edit-btn {
                display: none;
            }
        }
    </style>
</head>

<body>
    <div class="wizard-container">
        <div class="wizard-header">
            <h1 id="wizard-title">MTM Waitlist Questionnaire</h1>
            <p class="subtitle" id="wizard-subtitle">Please answer all questions thoughtfully</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Question 1 of 10</div>
        </div>

        <div class="wizard-navigation">
            <button class="nav-btn btn-previous" id="btnPrevious" onclick="previousQuestion()">&larr; Previous</button>
            <button class="nav-btn btn-review" id="btnReview" onclick="showReview()" style="display: none;">Review
                Answers</button>
            <div style="flex: 1;"></div>
            <button class="nav-btn btn-next" id="btnNext" onclick="nextQuestion()">Next &rarr;</button>
            <button class="nav-btn btn-finish" id="btnFinish" onclick="finishQuestionnaire()"
                style="display: none;">Finish & Export</button>
        </div>

        <div class="question-container" id="questionContainer"></div>

        <div class="review-container" id="reviewContainer">
            <div style="padding: 40px;">
                <h2 style="color: #667eea; margin-bottom: 30px;">Review Your Answers</h2>
                <div id="reviewContent"></div>
            </div>
        </div>

        <div class="success-message" id="successMessage">
            <div class="success-icon">âœ“</div>
            <h2>Thank You!</h2>
            <p>Your answers have been submitted successfully.</p>
            <p style="margin-top: 20px;">A copy has been downloaded to your device.</p>
        </div>
    </div>

    <script>
        // Embedded question data (no fetch needed - avoids CORS issues)
        const EMBEDDED_DATA = {
            core: {
                "title": "MTM Waitlist - Core Questions",
                "subtitle": "Building a Custom Waitlist Solution",
                "questions": [
                    {
                        "id": "user_info",
                        "type": "text",
                        "question": "Your Name",
                        "description": "Help us know who provided this feedback",
                        "placeholder": "First Last",
                        "required": true
                    },
                    {
                        "id": "department",
                        "type": "dropdown",
                        "question": "Which department do you work in?",
                        "description": "This helps us show you relevant questions",
                        "options": [
                            {
                                "value": "Production",
                                "label": "Production"
                            },
                            {
                                "value": "Material Handling",
                                "label": "Material Handling"
                            },
                            {
                                "value": "Die Shop",
                                "label": "Die Shop"
                            },
                            {
                                "value": "Fabrication & Welding",
                                "label": "Fabrication & Welding"
                            },
                            {
                                "value": "Assembly",
                                "label": "Assembly"
                            },
                            {
                                "value": "Quality Control",
                                "label": "Quality Control"
                            },
                            {
                                "value": "Maintenance",
                                "label": "Maintenance"
                            },
                            {
                                "value": "Setup Technicians",
                                "label": "Setup Technicians"
                            },
                            {
                                "value": "Inventory Specialist",
                                "label": "Inventory Specialist"
                            },
                            {
                                "value": "Outside Service Coordinator",
                                "label": "Outside Service Coordinator"
                            },
                            {
                                "value": "IT Department",
                                "label": "IT Department"
                            },
                            {
                                "value": "Management",
                                "label": "Management"
                            },
                            {
                                "value": "Other",
                                "label": "Other (please specify below)"
                            }
                        ],
                        "allowOther": true,
                        "required": true
                    },
                    {
                        "id": "shift",
                        "type": "dropdown",
                        "question": "Which shift do you typically work?",
                        "options": [
                            {
                                "value": "1st Shift (Day)",
                                "label": "1st Shift (Day)"
                            },
                            {
                                "value": "2nd Shift (Afternoon)",
                                "label": "2nd Shift (Afternoon)"
                            },
                            {
                                "value": "3rd Shift (Night)",
                                "label": "3rd Shift (Night)"
                            },
                            {
                                "value": "Rotating",
                                "label": "Rotating Shifts"
                            },
                            {
                                "value": "Other",
                                "label": "Other"
                            }
                        ],
                        "required": true
                    },
                    {
                        "id": "satisfaction",
                        "type": "rating",
                        "question": "Overall, how satisfied are you with the IDEA of a custom MTM waitlist system?",
                        "whyMatters": "Helps us understand enthusiasm for this project."
                    },
                    {
                        "id": "works_current",
                        "type": "textarea",
                        "question": "What works WELL with the current tablesready.com system?",
                        "placeholder": "Tell us what features or workflows you like and want to keep...",
                        "rows": 4,
                        "required": false
                    },
                    {
                        "id": "doesnt_work_current",
                        "type": "textarea",
                        "question": "What DOESN'T work well with tablesready.com?",
                        "placeholder": "Tell us pain points, frustrations, or limitations...",
                        "rows": 4,
                        "required": false
                    },
                    {
                        "id": "must_have_features",
                        "type": "textarea",
                        "question": "What features are MUST-HAVES for you in the new system?",
                        "description": "Think about your daily workflow - what would make your job easier?",
                        "placeholder": "List any features that would be critical for you...",
                        "rows": 5
                    },
                    {
                        "id": "completion_date",
                        "type": "date",
                        "question": "Date Completed",
                        "required": true
                    }
                ]
            },
            "production": {
                "departmentName": "Production",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Production workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple production tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a production task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "machine_cell",
                                "label": "Machine/Cell Number"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "setup_instructions",
                                "label": "Setup Instructions"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can production workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, quantity)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' production tasks to save?",
                        "description": "For frequently run jobs",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for production kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 10,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Production workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "parts_completed_today",
                                "label": "Parts Completed Today"
                            },
                            {
                                "value": "current_job_progress",
                                "label": "Current Job Progress"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality/Scrap Rate"
                            },
                            {
                                "value": "cycle_time",
                                "label": "Average Cycle Time"
                            },
                            {
                                "value": "downtime",
                                "label": "Machine Downtime"
                            },
                            {
                                "value": "efficiency",
                                "label": "Efficiency Score"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Production workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "andon_light",
                                "label": "Andon light system"
                            },
                            {
                                "value": "mobile_device",
                                "label": "Mobile device notification"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "material-handling": {
                "departmentName": "Material Handling",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Material Handlers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple roles/tasks at once?",
                        "description": "Example: Material Handler + Forklift Operator",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple roles"
                            },
                            {
                                "value": "no",
                                "label": "No - One role at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "location",
                                "label": "Location/Cell"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "equipment",
                                "label": "Equipment/Forklift ID"
                            },
                            {
                                "value": "notes",
                                "label": "Notes/Instructions"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, status)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' tasks to save?",
                        "description": "For frequently repeated assignments",
                        "placeholder": "5",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "30",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for kiosk mode (forklift/mobile)?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Material Handlers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "tasks_completed_today",
                                "label": "Tasks Completed Today"
                            },
                            {
                                "value": "pending_tasks",
                                "label": "Pending Tasks"
                            },
                            {
                                "value": "avg_task_time",
                                "label": "Average Task Time"
                            },
                            {
                                "value": "equipment_status",
                                "label": "Equipment/Forklift Status"
                            },
                            {
                                "value": "safety_incidents",
                                "label": "Safety Incidents"
                            },
                            {
                                "value": "efficiency_score",
                                "label": "Efficiency Score"
                            },
                            {
                                "value": "priority_tasks",
                                "label": "High Priority Tasks"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Material Handlers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            },
                            {
                                "value": "sms",
                                "label": "Text message (SMS)"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_digital",
                        "type": "radio",
                        "question": "Should forklift pre-shift inspections be DIGITAL (in the waitlist app)?",
                        "description": "Instead of paper checklists",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Digital inspections in app"
                            },
                            {
                                "value": "no",
                                "label": "No - Keep paper checklists"
                            },
                            {
                                "value": "optional",
                                "label": "Make it optional (both methods available)"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_frequency",
                        "type": "radio",
                        "question": "How often should forklift inspections be required?",
                        "options": [
                            {
                                "value": "every_shift",
                                "label": "Every shift (before each use)"
                            },
                            {
                                "value": "daily",
                                "label": "Once per day"
                            },
                            {
                                "value": "weekly",
                                "label": "Weekly"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_prompting",
                        "type": "radio",
                        "question": "Should the system BLOCK forklift task assignment without a completed inspection?",
                        "options": [
                            {
                                "value": "block",
                                "label": "Yes - Block task assignment (hard requirement)"
                            },
                            {
                                "value": "warn",
                                "label": "Warn but allow override"
                            },
                            {
                                "value": "none",
                                "label": "No - Just remind/suggest"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "it-department": {
                "departmentName": "IT Department",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "Preferred login method for IT staff?",
                        "options": [
                            {
                                "value": "sso",
                                "label": "Single Sign-On (SSO)"
                            },
                            {
                                "value": "active_directory",
                                "label": "Active Directory"
                            },
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan"
                            },
                            {
                                "value": "username_password",
                                "label": "Username/Password"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should IT staff be able to access multiple system roles?",
                        "description": "For testing and administration purposes",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Full multi-role access"
                            },
                            {
                                "value": "limited",
                                "label": "Limited - Only admin roles"
                            },
                            {
                                "value": "no",
                                "label": "No - Single role only"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "timeout_office",
                        "type": "range",
                        "question": "Auto-logout timeout for office/desktop mode?",
                        "description": "Longer timeout for desk work",
                        "min": 15,
                        "max": 120,
                        "default": 60,
                        "minLabel": "15 min",
                        "maxLabel": "2 hrs"
                    },
                    {
                        "id": "admin_dashboard",
                        "type": "checkbox",
                        "question": "What should IT admins see on their dashboard?",
                        "options": [
                            {
                                "value": "system_health",
                                "label": "System Health Status"
                            },
                            {
                                "value": "active_users",
                                "label": "Active Users Count"
                            },
                            {
                                "value": "error_logs",
                                "label": "Recent Error Logs"
                            },
                            {
                                "value": "database_status",
                                "label": "Database Connection Status"
                            },
                            {
                                "value": "api_performance",
                                "label": "API Performance Metrics"
                            },
                            {
                                "value": "user_activity",
                                "label": "User Activity Log"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "management": {
                "departmentName": "Management",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "Preferred login method for Management?",
                        "options": [
                            {
                                "value": "sso",
                                "label": "Single Sign-On (SSO)"
                            },
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan"
                            },
                            {
                                "value": "username_password",
                                "label": "Username/Password"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should managers be able to view multiple department dashboards?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - All departments"
                            },
                            {
                                "value": "assigned_only",
                                "label": "Only assigned departments"
                            },
                            {
                                "value": "no",
                                "label": "No - Single view only"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "timeout_office",
                        "type": "range",
                        "question": "Auto-logout timeout for management workstations?",
                        "min": 15,
                        "max": 120,
                        "default": 30,
                        "minLabel": "15 min",
                        "maxLabel": "2 hrs"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should managers see on their dashboard?",
                        "description": "Select most important KPIs",
                        "options": [
                            {
                                "value": "overall_efficiency",
                                "label": "Overall Department Efficiency"
                            },
                            {
                                "value": "labor_utilization",
                                "label": "Labor Utilization %"
                            },
                            {
                                "value": "task_completion_rate",
                                "label": "Task Completion Rate"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality Metrics"
                            },
                            {
                                "value": "safety_incidents",
                                "label": "Safety Incidents"
                            },
                            {
                                "value": "overtime_hours",
                                "label": "Overtime Hours"
                            },
                            {
                                "value": "attendance",
                                "label": "Attendance/Absenteeism"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should managers receive critical notifications?",
                        "options": [
                            {
                                "value": "email",
                                "label": "Email"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile Push Notification"
                            },
                            {
                                "value": "sms",
                                "label": "Text Message (SMS)"
                            },
                            {
                                "value": "dashboard_alert",
                                "label": "Dashboard Alert Banner"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "reporting_frequency",
                        "type": "radio",
                        "question": "How often should automated reports be generated?",
                        "options": [
                            {
                                "value": "realtime",
                                "label": "Real-time (continuous)"
                            },
                            {
                                "value": "hourly",
                                "label": "Every hour"
                            },
                            {
                                "value": "shift",
                                "label": "End of each shift"
                            },
                            {
                                "value": "daily",
                                "label": "Daily summary"
                            },
                            {
                                "value": "weekly",
                                "label": "Weekly summary"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "maintenance": {
                "departmentName": "Maintenance",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Maintenance staff log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple maintenance tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a maintenance task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "equipment_id",
                                "label": "Equipment/Machine ID"
                            },
                            {
                                "value": "task_type",
                                "label": "Task Type (PM, Repair, Breakdown)"
                            },
                            {
                                "value": "location",
                                "label": "Location/Area"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "parts_needed",
                                "label": "Parts/Materials Needed"
                            },
                            {
                                "value": "estimated_time",
                                "label": "Estimated Time"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can maintenance workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, parts used)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' maintenance tasks to save?",
                        "description": "For frequently performed preventive maintenance",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for maintenance kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Maintenance staff see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "tasks_completed_today",
                                "label": "Tasks Completed Today"
                            },
                            {
                                "value": "pending_pm",
                                "label": "Pending Preventive Maintenance"
                            },
                            {
                                "value": "emergency_repairs",
                                "label": "Emergency Repairs Open"
                            },
                            {
                                "value": "avg_repair_time",
                                "label": "Average Repair Time"
                            },
                            {
                                "value": "equipment_downtime",
                                "label": "Equipment Downtime"
                            },
                            {
                                "value": "parts_inventory",
                                "label": "Parts Inventory Status"
                            },
                            {
                                "value": "safety_incidents",
                                "label": "Safety Incidents"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Maintenance staff receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            },
                            {
                                "value": "sms",
                                "label": "Text message (SMS)"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "quality-control": {
                "departmentName": "Quality Control",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Quality Control staff log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple inspection tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning an inspection task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "inspection_type",
                                "label": "Inspection Type (First Article, In-Process, Final)"
                            },
                            {
                                "value": "quantity",
                                "label": "Sample Size/Quantity"
                            },
                            {
                                "value": "location",
                                "label": "Location/Cell"
                            },
                            {
                                "value": "specifications",
                                "label": "Specifications/Standards"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can QC staff edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, findings)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' inspection tasks to save?",
                        "description": "For frequently inspected parts",
                        "placeholder": "15",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_office",
                        "type": "range",
                        "question": "Auto-logout timeout for QC workstations?",
                        "description": "Longer timeout for inspection documentation",
                        "min": 15,
                        "max": 120,
                        "default": 30,
                        "minLabel": "15 min",
                        "maxLabel": "2 hrs"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should QC staff see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "inspections_completed",
                                "label": "Inspections Completed Today"
                            },
                            {
                                "value": "pending_inspections",
                                "label": "Pending Inspections"
                            },
                            {
                                "value": "defect_rate",
                                "label": "Defect Rate"
                            },
                            {
                                "value": "first_pass_yield",
                                "label": "First Pass Yield"
                            },
                            {
                                "value": "holds_rejections",
                                "label": "Holds/Rejections"
                            },
                            {
                                "value": "customer_complaints",
                                "label": "Customer Complaints"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should QC staff receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "die-shop": {
                "departmentName": "Die Shop",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Die Shop workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple die jobs at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a die job?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "die_number",
                                "label": "Die Number/ID"
                            },
                            {
                                "value": "job_type",
                                "label": "Job Type (Build, Repair, Modify)"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "estimated_hours",
                                "label": "Estimated Hours"
                            },
                            {
                                "value": "materials_needed",
                                "label": "Materials Needed"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can die shop workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, hours)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' die jobs to save?",
                        "description": "For frequently serviced dies",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "90",
                        "min": 1,
                        "max": 180
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for die shop kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Die Shop workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "jobs_completed_today",
                                "label": "Jobs Completed Today"
                            },
                            {
                                "value": "active_jobs",
                                "label": "Active Jobs"
                            },
                            {
                                "value": "avg_repair_time",
                                "label": "Average Repair Time"
                            },
                            {
                                "value": "dies_in_queue",
                                "label": "Dies in Queue"
                            },
                            {
                                "value": "emergency_repairs",
                                "label": "Emergency Repairs"
                            },
                            {
                                "value": "efficiency",
                                "label": "Efficiency Score"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Die Shop workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "fabrication-welding": {
                "departmentName": "Fabrication & Welding",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Fabrication & Welding workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple fabrication/welding tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a fabrication/welding task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "job_type",
                                "label": "Job Type (Fabrication, Welding, Both)"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "material_type",
                                "label": "Material Type"
                            },
                            {
                                "value": "welding_process",
                                "label": "Welding Process (MIG, TIG, Stick)"
                            },
                            {
                                "value": "certifications",
                                "label": "Required Certifications"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can Fab/Welding workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, quantity)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' fabrication tasks to save?",
                        "description": "For frequently fabricated parts",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for fabrication/welding kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Fab/Welding workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "parts_completed_today",
                                "label": "Parts Completed Today"
                            },
                            {
                                "value": "current_job_progress",
                                "label": "Current Job Progress"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality/Rework Rate"
                            },
                            {
                                "value": "avg_cycle_time",
                                "label": "Average Cycle Time"
                            },
                            {
                                "value": "material_usage",
                                "label": "Material Usage"
                            },
                            {
                                "value": "efficiency",
                                "label": "Efficiency Score"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Fab/Welding workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "andon_light",
                                "label": "Andon light system"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "assembly": {
                "departmentName": "Assembly",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Assembly workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple assembly tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning an assembly task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "assembly_type",
                                "label": "Assembly Type/Station"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "location",
                                "label": "Assembly Cell/Line"
                            },
                            {
                                "value": "takt_time",
                                "label": "Takt Time/Target Rate"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can assembly workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, quantity)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' assembly tasks to save?",
                        "description": "For frequently assembled parts",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for assembly kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Assembly workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "units_completed_today",
                                "label": "Units Completed Today"
                            },
                            {
                                "value": "current_job_progress",
                                "label": "Current Job Progress"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality/Rework Rate"
                            },
                            {
                                "value": "takt_time_performance",
                                "label": "Takt Time Performance"
                            },
                            {
                                "value": "line_efficiency",
                                "label": "Line Efficiency"
                            },
                            {
                                "value": "downtime",
                                "label": "Downtime/Stops"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Assembly workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "andon_light",
                                "label": "Andon light system"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "setup-technicians": {
                "departmentName": "Setup Technicians",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Setup Technicians log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one Setup Tech be able to sign up for multiple setup tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a setup task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "machine_number",
                                "label": "Machine Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "setup_type",
                                "label": "Setup Type (New Job, Changeover, Tool Change)"
                            },
                            {
                                "value": "tooling_list",
                                "label": "Tooling/Fixture List"
                            },
                            {
                                "value": "program_number",
                                "label": "Program Number"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can Setup Techs edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, actual time)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' setup tasks to save?",
                        "description": "For frequently run jobs",
                        "placeholder": "15",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "90",
                        "min": 1,
                        "max": 180
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for setup kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 20,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Setup Techs see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "setups_completed_today",
                                "label": "Setups Completed Today"
                            },
                            {
                                "value": "avg_setup_time",
                                "label": "Average Setup Time"
                            },
                            {
                                "value": "pending_setups",
                                "label": "Pending Setups"
                            },
                            {
                                "value": "machines_down",
                                "label": "Machines Down Waiting for Setup"
                            },
                            {
                                "value": "first_piece_approval",
                                "label": "First Piece Approval Rate"
                            },
                            {
                                "value": "efficiency",
                                "label": "Setup Efficiency"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Setup Techs receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "two_way_radio",
                                "label": "Two-way radio call"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            }
        };
    </script>
    <script>
        // Embedded question data (no fetch needed - avoids CORS issues)
        const EMBEDDED_DATA = {
            core: {
                "title": "MTM Waitlist - Core Questions",
                "subtitle": "Building a Custom Waitlist Solution",
                "questions": [
                    {
                        "id": "user_info",
                        "type": "text",
                        "question": "Your Name",
                        "description": "Help us know who provided this feedback",
                        "placeholder": "First Last",
                        "required": true
                    },
                    {
                        "id": "department",
                        "type": "dropdown",
                        "question": "Which department do you work in?",
                        "description": "This helps us show you relevant questions",
                        "options": [
                            {
                                "value": "Production",
                                "label": "Production"
                            },
                            {
                                "value": "Material Handling",
                                "label": "Material Handling"
                            },
                            {
                                "value": "Die Shop",
                                "label": "Die Shop"
                            },
                            {
                                "value": "Fabrication & Welding",
                                "label": "Fabrication & Welding"
                            },
                            {
                                "value": "Assembly",
                                "label": "Assembly"
                            },
                            {
                                "value": "Quality Control",
                                "label": "Quality Control"
                            },
                            {
                                "value": "Maintenance",
                                "label": "Maintenance"
                            },
                            {
                                "value": "Setup Technicians",
                                "label": "Setup Technicians"
                            },
                            {
                                "value": "Inventory Specialist",
                                "label": "Inventory Specialist"
                            },
                            {
                                "value": "Outside Service Coordinator",
                                "label": "Outside Service Coordinator"
                            },
                            {
                                "value": "IT Department",
                                "label": "IT Department"
                            },
                            {
                                "value": "Management",
                                "label": "Management"
                            },
                            {
                                "value": "Other",
                                "label": "Other (please specify below)"
                            }
                        ],
                        "allowOther": true,
                        "required": true
                    },
                    {
                        "id": "shift",
                        "type": "dropdown",
                        "question": "Which shift do you typically work?",
                        "options": [
                            {
                                "value": "1st Shift (Day)",
                                "label": "1st Shift (Day)"
                            },
                            {
                                "value": "2nd Shift (Afternoon)",
                                "label": "2nd Shift (Afternoon)"
                            },
                            {
                                "value": "3rd Shift (Night)",
                                "label": "3rd Shift (Night)"
                            },
                            {
                                "value": "Rotating",
                                "label": "Rotating Shifts"
                            },
                            {
                                "value": "Other",
                                "label": "Other"
                            }
                        ],
                        "required": true
                    },
                    {
                        "id": "satisfaction",
                        "type": "rating",
                        "question": "Overall, how satisfied are you with the IDEA of a custom MTM waitlist system?",
                        "whyMatters": "Helps us understand enthusiasm for this project."
                    },
                    {
                        "id": "works_current",
                        "type": "textarea",
                        "question": "What works WELL with the current tablesready.com system?",
                        "placeholder": "Tell us what features or workflows you like and want to keep...",
                        "rows": 4,
                        "required": false
                    },
                    {
                        "id": "doesnt_work_current",
                        "type": "textarea",
                        "question": "What DOESN'T work well with tablesready.com?",
                        "placeholder": "Tell us pain points, frustrations, or limitations...",
                        "rows": 4,
                        "required": false
                    },
                    {
                        "id": "must_have_features",
                        "type": "textarea",
                        "question": "What features are MUST-HAVES for you in the new system?",
                        "description": "Think about your daily workflow - what would make your job easier?",
                        "placeholder": "List any features that would be critical for you...",
                        "rows": 5
                    },
                    {
                        "id": "completion_date",
                        "type": "date",
                        "question": "Date Completed",
                        "required": true
                    }
                ]
            },
            "production": {
                "departmentName": "Production",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Production workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple production tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a production task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "machine_cell",
                                "label": "Machine/Cell Number"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "setup_instructions",
                                "label": "Setup Instructions"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can production workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, quantity)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' production tasks to save?",
                        "description": "For frequently run jobs",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for production kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 10,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Production workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "parts_completed_today",
                                "label": "Parts Completed Today"
                            },
                            {
                                "value": "current_job_progress",
                                "label": "Current Job Progress"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality/Scrap Rate"
                            },
                            {
                                "value": "cycle_time",
                                "label": "Average Cycle Time"
                            },
                            {
                                "value": "downtime",
                                "label": "Machine Downtime"
                            },
                            {
                                "value": "efficiency",
                                "label": "Efficiency Score"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Production workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "andon_light",
                                "label": "Andon light system"
                            },
                            {
                                "value": "mobile_device",
                                "label": "Mobile device notification"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "material-handling": {
                "departmentName": "Material Handling",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Material Handlers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple roles/tasks at once?",
                        "description": "Example: Material Handler + Forklift Operator",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple roles"
                            },
                            {
                                "value": "no",
                                "label": "No - One role at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "location",
                                "label": "Location/Cell"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "equipment",
                                "label": "Equipment/Forklift ID"
                            },
                            {
                                "value": "notes",
                                "label": "Notes/Instructions"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, status)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' tasks to save?",
                        "description": "For frequently repeated assignments",
                        "placeholder": "5",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "30",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for kiosk mode (forklift/mobile)?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Material Handlers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "tasks_completed_today",
                                "label": "Tasks Completed Today"
                            },
                            {
                                "value": "pending_tasks",
                                "label": "Pending Tasks"
                            },
                            {
                                "value": "avg_task_time",
                                "label": "Average Task Time"
                            },
                            {
                                "value": "equipment_status",
                                "label": "Equipment/Forklift Status"
                            },
                            {
                                "value": "safety_incidents",
                                "label": "Safety Incidents"
                            },
                            {
                                "value": "efficiency_score",
                                "label": "Efficiency Score"
                            },
                            {
                                "value": "priority_tasks",
                                "label": "High Priority Tasks"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Material Handlers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            },
                            {
                                "value": "sms",
                                "label": "Text message (SMS)"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_digital",
                        "type": "radio",
                        "question": "Should forklift pre-shift inspections be DIGITAL (in the waitlist app)?",
                        "description": "Instead of paper checklists",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Digital inspections in app"
                            },
                            {
                                "value": "no",
                                "label": "No - Keep paper checklists"
                            },
                            {
                                "value": "optional",
                                "label": "Make it optional (both methods available)"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_frequency",
                        "type": "radio",
                        "question": "How often should forklift inspections be required?",
                        "options": [
                            {
                                "value": "every_shift",
                                "label": "Every shift (before each use)"
                            },
                            {
                                "value": "daily",
                                "label": "Once per day"
                            },
                            {
                                "value": "weekly",
                                "label": "Weekly"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_prompting",
                        "type": "radio",
                        "question": "Should the system BLOCK forklift task assignment without a completed inspection?",
                        "options": [
                            {
                                "value": "block",
                                "label": "Yes - Block task assignment (hard requirement)"
                            },
                            {
                                "value": "warn",
                                "label": "Warn but allow override"
                            },
                            {
                                "value": "none",
                                "label": "No - Just remind/suggest"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "it-department": {
                "departmentName": "IT Department",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "Preferred login method for IT staff?",
                        "options": [
                            {
                                "value": "sso",
                                "label": "Single Sign-On (SSO)"
                            },
                            {
                                "value": "active_directory",
                                "label": "Active Directory"
                            },
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan"
                            },
                            {
                                "value": "username_password",
                                "label": "Username/Password"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should IT staff be able to access multiple system roles?",
                        "description": "For testing and administration purposes",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Full multi-role access"
                            },
                            {
                                "value": "limited",
                                "label": "Limited - Only admin roles"
                            },
                            {
                                "value": "no",
                                "label": "No - Single role only"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "timeout_office",
                        "type": "range",
                        "question": "Auto-logout timeout for office/desktop mode?",
                        "description": "Longer timeout for desk work",
                        "min": 15,
                        "max": 120,
                        "default": 60,
                        "minLabel": "15 min",
                        "maxLabel": "2 hrs"
                    },
                    {
                        "id": "admin_dashboard",
                        "type": "checkbox",
                        "question": "What should IT admins see on their dashboard?",
                        "options": [
                            {
                                "value": "system_health",
                                "label": "System Health Status"
                            },
                            {
                                "value": "active_users",
                                "label": "Active Users Count"
                            },
                            {
                                "value": "error_logs",
                                "label": "Recent Error Logs"
                            },
                            {
                                "value": "database_status",
                                "label": "Database Connection Status"
                            },
                            {
                                "value": "api_performance",
                                "label": "API Performance Metrics"
                            },
                            {
                                "value": "user_activity",
                                "label": "User Activity Log"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "management": {
                "departmentName": "Management",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "Preferred login method for Management?",
                        "options": [
                            {
                                "value": "sso",
                                "label": "Single Sign-On (SSO)"
                            },
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan"
                            },
                            {
                                "value": "username_password",
                                "label": "Username/Password"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should managers be able to view multiple department dashboards?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - All departments"
                            },
                            {
                                "value": "assigned_only",
                                "label": "Only assigned departments"
                            },
                            {
                                "value": "no",
                                "label": "No - Single view only"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "timeout_office",
                        "type": "range",
                        "question": "Auto-logout timeout for management workstations?",
                        "min": 15,
                        "max": 120,
                        "default": 30,
                        "minLabel": "15 min",
                        "maxLabel": "2 hrs"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should managers see on their dashboard?",
                        "description": "Select most important KPIs",
                        "options": [
                            {
                                "value": "overall_efficiency",
                                "label": "Overall Department Efficiency"
                            },
                            {
                                "value": "labor_utilization",
                                "label": "Labor Utilization %"
                            },
                            {
                                "value": "task_completion_rate",
                                "label": "Task Completion Rate"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality Metrics"
                            },
                            {
                                "value": "safety_incidents",
                                "label": "Safety Incidents"
                            },
                            {
                                "value": "overtime_hours",
                                "label": "Overtime Hours"
                            },
                            {
                                "value": "attendance",
                                "label": "Attendance/Absenteeism"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should managers receive critical notifications?",
                        "options": [
                            {
                                "value": "email",
                                "label": "Email"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile Push Notification"
                            },
                            {
                                "value": "sms",
                                "label": "Text Message (SMS)"
                            },
                            {
                                "value": "dashboard_alert",
                                "label": "Dashboard Alert Banner"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "reporting_frequency",
                        "type": "radio",
                        "question": "How often should automated reports be generated?",
                        "options": [
                            {
                                "value": "realtime",
                                "label": "Real-time (continuous)"
                            },
                            {
                                "value": "hourly",
                                "label": "Every hour"
                            },
                            {
                                "value": "shift",
                                "label": "End of each shift"
                            },
                            {
                                "value": "daily",
                                "label": "Daily summary"
                            },
                            {
                                "value": "weekly",
                                "label": "Weekly summary"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            }
        };
    </script>
    <script>
        // Embedded question data (no fetch needed - avoids CORS issues)
        const EMBEDDED_DATA = {
            core: {
                "title": "MTM Waitlist - Core Questions",
                "subtitle": "Building a Custom Waitlist Solution",
                "questions": [
                    {
                        "id": "user_info",
                        "type": "text",
                        "question": "Your Name",
                        "description": "Help us know who provided this feedback",
                        "placeholder": "First Last",
                        "required": true
                    },
                    {
                        "id": "department",
                        "type": "dropdown",
                        "question": "Which department do you work in?",
                        "description": "This helps us show you relevant questions",
                        "options": [
                            {
                                "value": "Production",
                                "label": "Production"
                            },
                            {
                                "value": "Material Handling",
                                "label": "Material Handling"
                            },
                            {
                                "value": "Die Shop",
                                "label": "Die Shop"
                            },
                            {
                                "value": "Fabrication & Welding",
                                "label": "Fabrication & Welding"
                            },
                            {
                                "value": "Assembly",
                                "label": "Assembly"
                            },
                            {
                                "value": "Quality Control",
                                "label": "Quality Control"
                            },
                            {
                                "value": "Maintenance",
                                "label": "Maintenance"
                            },
                            {
                                "value": "Setup Technicians",
                                "label": "Setup Technicians"
                            },
                            {
                                "value": "Inventory Specialist",
                                "label": "Inventory Specialist"
                            },
                            {
                                "value": "Outside Service Coordinator",
                                "label": "Outside Service Coordinator"
                            },
                            {
                                "value": "IT Department",
                                "label": "IT Department"
                            },
                            {
                                "value": "Management",
                                "label": "Management"
                            },
                            {
                                "value": "Other",
                                "label": "Other (please specify below)"
                            }
                        ],
                        "allowOther": true,
                        "required": true
                    },
                    {
                        "id": "shift",
                        "type": "dropdown",
                        "question": "Which shift do you typically work?",
                        "options": [
                            {
                                "value": "1st Shift (Day)",
                                "label": "1st Shift (Day)"
                            },
                            {
                                "value": "2nd Shift (Afternoon)",
                                "label": "2nd Shift (Afternoon)"
                            },
                            {
                                "value": "3rd Shift (Night)",
                                "label": "3rd Shift (Night)"
                            },
                            {
                                "value": "Rotating",
                                "label": "Rotating Shifts"
                            },
                            {
                                "value": "Other",
                                "label": "Other"
                            }
                        ],
                        "required": true
                    },
                    {
                        "id": "satisfaction",
                        "type": "rating",
                        "question": "Overall, how satisfied are you with the IDEA of a custom MTM waitlist system?",
                        "whyMatters": "Helps us understand enthusiasm for this project."
                    },
                    {
                        "id": "works_current",
                        "type": "textarea",
                        "question": "What works WELL with the current tablesready.com system?",
                        "placeholder": "Tell us what features or workflows you like and want to keep...",
                        "rows": 4,
                        "required": false
                    },
                    {
                        "id": "doesnt_work_current",
                        "type": "textarea",
                        "question": "What DOESN'T work well with tablesready.com?",
                        "placeholder": "Tell us pain points, frustrations, or limitations...",
                        "rows": 4,
                        "required": false
                    },
                    {
                        "id": "must_have_features",
                        "type": "textarea",
                        "question": "What features are MUST-HAVES for you in the new system?",
                        "description": "Think about your daily workflow - what would make your job easier?",
                        "placeholder": "List any features that would be critical for you...",
                        "rows": 5
                    },
                    {
                        "id": "completion_date",
                        "type": "date",
                        "question": "Date Completed",
                        "required": true
                    }
                ]
            },
            "production": {
                "departmentName": "Production",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Production workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple production tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a production task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "machine_cell",
                                "label": "Machine/Cell Number"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "setup_instructions",
                                "label": "Setup Instructions"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can production workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, quantity)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' production tasks to save?",
                        "description": "For frequently run jobs",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for production kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 10,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Production workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "parts_completed_today",
                                "label": "Parts Completed Today"
                            },
                            {
                                "value": "current_job_progress",
                                "label": "Current Job Progress"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality/Scrap Rate"
                            },
                            {
                                "value": "cycle_time",
                                "label": "Average Cycle Time"
                            },
                            {
                                "value": "downtime",
                                "label": "Machine Downtime"
                            },
                            {
                                "value": "efficiency",
                                "label": "Efficiency Score"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Production workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "andon_light",
                                "label": "Andon light system"
                            },
                            {
                                "value": "mobile_device",
                                "label": "Mobile device notification"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "material-handling": {
                "departmentName": "Material Handling",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Material Handlers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple roles/tasks at once?",
                        "description": "Example: Material Handler + Forklift Operator",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple roles"
                            },
                            {
                                "value": "no",
                                "label": "No - One role at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "location",
                                "label": "Location/Cell"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "equipment",
                                "label": "Equipment/Forklift ID"
                            },
                            {
                                "value": "notes",
                                "label": "Notes/Instructions"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, status)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' tasks to save?",
                        "description": "For frequently repeated assignments",
                        "placeholder": "5",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "30",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for kiosk mode (forklift/mobile)?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Material Handlers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "tasks_completed_today",
                                "label": "Tasks Completed Today"
                            },
                            {
                                "value": "pending_tasks",
                                "label": "Pending Tasks"
                            },
                            {
                                "value": "avg_task_time",
                                "label": "Average Task Time"
                            },
                            {
                                "value": "equipment_status",
                                "label": "Equipment/Forklift Status"
                            },
                            {
                                "value": "safety_incidents",
                                "label": "Safety Incidents"
                            },
                            {
                                "value": "efficiency_score",
                                "label": "Efficiency Score"
                            },
                            {
                                "value": "priority_tasks",
                                "label": "High Priority Tasks"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Material Handlers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            },
                            {
                                "value": "sms",
                                "label": "Text message (SMS)"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_digital",
                        "type": "radio",
                        "question": "Should forklift pre-shift inspections be DIGITAL (in the waitlist app)?",
                        "description": "Instead of paper checklists",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Digital inspections in app"
                            },
                            {
                                "value": "no",
                                "label": "No - Keep paper checklists"
                            },
                            {
                                "value": "optional",
                                "label": "Make it optional (both methods available)"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_frequency",
                        "type": "radio",
                        "question": "How often should forklift inspections be required?",
                        "options": [
                            {
                                "value": "every_shift",
                                "label": "Every shift (before each use)"
                            },
                            {
                                "value": "daily",
                                "label": "Once per day"
                            },
                            {
                                "value": "weekly",
                                "label": "Weekly"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "forklift_inspection_prompting",
                        "type": "radio",
                        "question": "Should the system BLOCK forklift task assignment without a completed inspection?",
                        "options": [
                            {
                                "value": "block",
                                "label": "Yes - Block task assignment (hard requirement)"
                            },
                            {
                                "value": "warn",
                                "label": "Warn but allow override"
                            },
                            {
                                "value": "none",
                                "label": "No - Just remind/suggest"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "it-department": {
                "departmentName": "IT Department",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "Preferred login method for IT staff?",
                        "options": [
                            {
                                "value": "sso",
                                "label": "Single Sign-On (SSO)"
                            },
                            {
                                "value": "active_directory",
                                "label": "Active Directory"
                            },
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan"
                            },
                            {
                                "value": "username_password",
                                "label": "Username/Password"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should IT staff be able to access multiple system roles?",
                        "description": "For testing and administration purposes",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Full multi-role access"
                            },
                            {
                                "value": "limited",
                                "label": "Limited - Only admin roles"
                            },
                            {
                                "value": "no",
                                "label": "No - Single role only"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "timeout_office",
                        "type": "range",
                        "question": "Auto-logout timeout for office/desktop mode?",
                        "description": "Longer timeout for desk work",
                        "min": 15,
                        "max": 120,
                        "default": 60,
                        "minLabel": "15 min",
                        "maxLabel": "2 hrs"
                    },
                    {
                        "id": "admin_dashboard",
                        "type": "checkbox",
                        "question": "What should IT admins see on their dashboard?",
                        "options": [
                            {
                                "value": "system_health",
                                "label": "System Health Status"
                            },
                            {
                                "value": "active_users",
                                "label": "Active Users Count"
                            },
                            {
                                "value": "error_logs",
                                "label": "Recent Error Logs"
                            },
                            {
                                "value": "database_status",
                                "label": "Database Connection Status"
                            },
                            {
                                "value": "api_performance",
                                "label": "API Performance Metrics"
                            },
                            {
                                "value": "user_activity",
                                "label": "User Activity Log"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "management": {
                "departmentName": "Management",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "Preferred login method for Management?",
                        "options": [
                            {
                                "value": "sso",
                                "label": "Single Sign-On (SSO)"
                            },
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan"
                            },
                            {
                                "value": "username_password",
                                "label": "Username/Password"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should managers be able to view multiple department dashboards?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - All departments"
                            },
                            {
                                "value": "assigned_only",
                                "label": "Only assigned departments"
                            },
                            {
                                "value": "no",
                                "label": "No - Single view only"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "timeout_office",
                        "type": "range",
                        "question": "Auto-logout timeout for management workstations?",
                        "min": 15,
                        "max": 120,
                        "default": 30,
                        "minLabel": "15 min",
                        "maxLabel": "2 hrs"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should managers see on their dashboard?",
                        "description": "Select most important KPIs",
                        "options": [
                            {
                                "value": "overall_efficiency",
                                "label": "Overall Department Efficiency"
                            },
                            {
                                "value": "labor_utilization",
                                "label": "Labor Utilization %"
                            },
                            {
                                "value": "task_completion_rate",
                                "label": "Task Completion Rate"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality Metrics"
                            },
                            {
                                "value": "safety_incidents",
                                "label": "Safety Incidents"
                            },
                            {
                                "value": "overtime_hours",
                                "label": "Overtime Hours"
                            },
                            {
                                "value": "attendance",
                                "label": "Attendance/Absenteeism"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should managers receive critical notifications?",
                        "options": [
                            {
                                "value": "email",
                                "label": "Email"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile Push Notification"
                            },
                            {
                                "value": "sms",
                                "label": "Text Message (SMS)"
                            },
                            {
                                "value": "dashboard_alert",
                                "label": "Dashboard Alert Banner"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "reporting_frequency",
                        "type": "radio",
                        "question": "How often should automated reports be generated?",
                        "options": [
                            {
                                "value": "realtime",
                                "label": "Real-time (continuous)"
                            },
                            {
                                "value": "hourly",
                                "label": "Every hour"
                            },
                            {
                                "value": "shift",
                                "label": "End of each shift"
                            },
                            {
                                "value": "daily",
                                "label": "Daily summary"
                            },
                            {
                                "value": "weekly",
                                "label": "Weekly summary"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "maintenance": {
                "departmentName": "Maintenance",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Maintenance staff log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple maintenance tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a maintenance task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "equipment_id",
                                "label": "Equipment/Machine ID"
                            },
                            {
                                "value": "task_type",
                                "label": "Task Type (PM, Repair, Breakdown)"
                            },
                            {
                                "value": "location",
                                "label": "Location/Area"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "parts_needed",
                                "label": "Parts/Materials Needed"
                            },
                            {
                                "value": "estimated_time",
                                "label": "Estimated Time"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can maintenance workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, parts used)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' maintenance tasks to save?",
                        "description": "For frequently performed preventive maintenance",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for maintenance kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Maintenance staff see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "tasks_completed_today",
                                "label": "Tasks Completed Today"
                            },
                            {
                                "value": "pending_pm",
                                "label": "Pending Preventive Maintenance"
                            },
                            {
                                "value": "emergency_repairs",
                                "label": "Emergency Repairs Open"
                            },
                            {
                                "value": "avg_repair_time",
                                "label": "Average Repair Time"
                            },
                            {
                                "value": "equipment_downtime",
                                "label": "Equipment Downtime"
                            },
                            {
                                "value": "parts_inventory",
                                "label": "Parts Inventory Status"
                            },
                            {
                                "value": "safety_incidents",
                                "label": "Safety Incidents"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Maintenance staff receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            },
                            {
                                "value": "sms",
                                "label": "Text message (SMS)"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "quality-control": {
                "departmentName": "Quality Control",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Quality Control staff log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple inspection tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning an inspection task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "inspection_type",
                                "label": "Inspection Type (First Article, In-Process, Final)"
                            },
                            {
                                "value": "quantity",
                                "label": "Sample Size/Quantity"
                            },
                            {
                                "value": "location",
                                "label": "Location/Cell"
                            },
                            {
                                "value": "specifications",
                                "label": "Specifications/Standards"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can QC staff edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, findings)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' inspection tasks to save?",
                        "description": "For frequently inspected parts",
                        "placeholder": "15",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_office",
                        "type": "range",
                        "question": "Auto-logout timeout for QC workstations?",
                        "description": "Longer timeout for inspection documentation",
                        "min": 15,
                        "max": 120,
                        "default": 30,
                        "minLabel": "15 min",
                        "maxLabel": "2 hrs"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should QC staff see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "inspections_completed",
                                "label": "Inspections Completed Today"
                            },
                            {
                                "value": "pending_inspections",
                                "label": "Pending Inspections"
                            },
                            {
                                "value": "defect_rate",
                                "label": "Defect Rate"
                            },
                            {
                                "value": "first_pass_yield",
                                "label": "First Pass Yield"
                            },
                            {
                                "value": "holds_rejections",
                                "label": "Holds/Rejections"
                            },
                            {
                                "value": "customer_complaints",
                                "label": "Customer Complaints"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should QC staff receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "die-shop": {
                "departmentName": "Die Shop",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Die Shop workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple die jobs at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a die job?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "die_number",
                                "label": "Die Number/ID"
                            },
                            {
                                "value": "job_type",
                                "label": "Job Type (Build, Repair, Modify)"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            },
                            {
                                "value": "estimated_hours",
                                "label": "Estimated Hours"
                            },
                            {
                                "value": "materials_needed",
                                "label": "Materials Needed"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can die shop workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, hours)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' die jobs to save?",
                        "description": "For frequently serviced dies",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "90",
                        "min": 1,
                        "max": 180
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for die shop kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Die Shop workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "jobs_completed_today",
                                "label": "Jobs Completed Today"
                            },
                            {
                                "value": "active_jobs",
                                "label": "Active Jobs"
                            },
                            {
                                "value": "avg_repair_time",
                                "label": "Average Repair Time"
                            },
                            {
                                "value": "dies_in_queue",
                                "label": "Dies in Queue"
                            },
                            {
                                "value": "emergency_repairs",
                                "label": "Emergency Repairs"
                            },
                            {
                                "value": "efficiency",
                                "label": "Efficiency Score"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Die Shop workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "email",
                                "label": "Email"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "fabrication-welding": {
                "departmentName": "Fabrication & Welding",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Fabrication & Welding workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple fabrication/welding tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a fabrication/welding task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "job_type",
                                "label": "Job Type (Fabrication, Welding, Both)"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "material_type",
                                "label": "Material Type"
                            },
                            {
                                "value": "welding_process",
                                "label": "Welding Process (MIG, TIG, Stick)"
                            },
                            {
                                "value": "certifications",
                                "label": "Required Certifications"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can Fab/Welding workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, quantity)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' fabrication tasks to save?",
                        "description": "For frequently fabricated parts",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for fabrication/welding kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Fab/Welding workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "parts_completed_today",
                                "label": "Parts Completed Today"
                            },
                            {
                                "value": "current_job_progress",
                                "label": "Current Job Progress"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality/Rework Rate"
                            },
                            {
                                "value": "avg_cycle_time",
                                "label": "Average Cycle Time"
                            },
                            {
                                "value": "material_usage",
                                "label": "Material Usage"
                            },
                            {
                                "value": "efficiency",
                                "label": "Efficiency Score"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Fab/Welding workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "andon_light",
                                "label": "Andon light system"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "assembly": {
                "departmentName": "Assembly",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Assembly workers log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one person be able to sign up for multiple assembly tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning an assembly task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "assembly_type",
                                "label": "Assembly Type/Station"
                            },
                            {
                                "value": "quantity",
                                "label": "Quantity"
                            },
                            {
                                "value": "location",
                                "label": "Assembly Cell/Line"
                            },
                            {
                                "value": "takt_time",
                                "label": "Takt Time/Target Rate"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can assembly workers edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, quantity)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' assembly tasks to save?",
                        "description": "For frequently assembled parts",
                        "placeholder": "10",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "60",
                        "min": 1,
                        "max": 90
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for assembly kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 15,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Assembly workers see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "units_completed_today",
                                "label": "Units Completed Today"
                            },
                            {
                                "value": "current_job_progress",
                                "label": "Current Job Progress"
                            },
                            {
                                "value": "quality_metrics",
                                "label": "Quality/Rework Rate"
                            },
                            {
                                "value": "takt_time_performance",
                                "label": "Takt Time Performance"
                            },
                            {
                                "value": "line_efficiency",
                                "label": "Line Efficiency"
                            },
                            {
                                "value": "downtime",
                                "label": "Downtime/Stops"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Assembly workers receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "andon_light",
                                "label": "Andon light system"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            },
            "setup-technicians": {
                "departmentName": "Setup Technicians",
                "questions": [
                    {
                        "id": "login_method",
                        "type": "radio",
                        "question": "How should Setup Technicians log in?",
                        "options": [
                            {
                                "value": "badge_scan",
                                "label": "Badge Scan (fastest, hands-free)"
                            },
                            {
                                "value": "employee_number",
                                "label": "Employee Number + PIN"
                            },
                            {
                                "value": "touchscreen_name",
                                "label": "Touchscreen Name Selection"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "multi_role",
                        "type": "radio",
                        "question": "Should one Setup Tech be able to sign up for multiple setup tasks at once?",
                        "options": [
                            {
                                "value": "yes",
                                "label": "Yes - Allow multiple tasks"
                            },
                            {
                                "value": "no",
                                "label": "No - One task at a time"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "required_fields",
                        "type": "checkbox",
                        "question": "What information should be REQUIRED when assigning a setup task?",
                        "options": [
                            {
                                "value": "work_order",
                                "label": "Work Order Number"
                            },
                            {
                                "value": "machine_number",
                                "label": "Machine Number"
                            },
                            {
                                "value": "part_number",
                                "label": "Part Number"
                            },
                            {
                                "value": "setup_type",
                                "label": "Setup Type (New Job, Changeover, Tool Change)"
                            },
                            {
                                "value": "tooling_list",
                                "label": "Tooling/Fixture List"
                            },
                            {
                                "value": "program_number",
                                "label": "Program Number"
                            },
                            {
                                "value": "priority",
                                "label": "Priority Level"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "post_assignment_edit",
                        "type": "radio",
                        "question": "Can Setup Techs edit task details AFTER assignment?",
                        "options": [
                            {
                                "value": "yes_all",
                                "label": "Yes - Edit all details"
                            },
                            {
                                "value": "yes_some",
                                "label": "Yes - But only certain fields (notes, actual time)"
                            },
                            {
                                "value": "no",
                                "label": "No - Supervisor must edit"
                            }
                        ],
                        "requiresDecision": true
                    },
                    {
                        "id": "favorites_count",
                        "type": "number",
                        "question": "Maximum number of 'favorite' setup tasks to save?",
                        "description": "For frequently run jobs",
                        "placeholder": "15",
                        "min": 0,
                        "max": 50
                    },
                    {
                        "id": "favorites_duration",
                        "type": "number",
                        "question": "How many days should favorites be kept?",
                        "placeholder": "90",
                        "min": 1,
                        "max": 180
                    },
                    {
                        "id": "timeout_kiosk",
                        "type": "range",
                        "question": "Auto-logout timeout for setup kiosks?",
                        "description": "How long before the system automatically logs out an inactive user?",
                        "min": 5,
                        "max": 60,
                        "default": 20,
                        "minLabel": "5 min",
                        "maxLabel": "60 min"
                    },
                    {
                        "id": "top_metrics",
                        "type": "checkbox",
                        "question": "What metrics should Setup Techs see on their dashboard?",
                        "description": "Select top 3-5 most important",
                        "options": [
                            {
                                "value": "setups_completed_today",
                                "label": "Setups Completed Today"
                            },
                            {
                                "value": "avg_setup_time",
                                "label": "Average Setup Time"
                            },
                            {
                                "value": "pending_setups",
                                "label": "Pending Setups"
                            },
                            {
                                "value": "machines_down",
                                "label": "Machines Down Waiting for Setup"
                            },
                            {
                                "value": "first_piece_approval",
                                "label": "First Piece Approval Rate"
                            },
                            {
                                "value": "efficiency",
                                "label": "Setup Efficiency"
                            }
                        ],
                        "allowOther": true,
                        "requiresDecision": true
                    },
                    {
                        "id": "notification_methods",
                        "type": "checkbox",
                        "question": "How should Setup Techs receive task notifications?",
                        "options": [
                            {
                                "value": "screen_popup",
                                "label": "On-screen popup"
                            },
                            {
                                "value": "sound_alert",
                                "label": "Sound alert"
                            },
                            {
                                "value": "mobile_push",
                                "label": "Mobile device push notification"
                            },
                            {
                                "value": "two_way_radio",
                                "label": "Two-way radio call"
                            }
                        ],
                        "requiresDecision": true
                    }
                ]
            }
        };
    </script>
    <script>
        // Check if data is embedded (for standalone use without server)
        const USE_EMBEDDED_DATA = typeof EMBEDDED_DATA !== 'undefined';

        // Dynamic JSON loading
        let coreQuestions = [];
        let departmentQuestions = [];
        let QUESTIONNAIRE_DATA = {
            title: "MTM Waitlist Questionnaire",
            subtitle: "Building a Custom Solution",
            questions: []
        };

        let currentQuestionIndex = 0;
        let answers = {};
        let departmentSelected = false;

        // Load core questions
        async function loadCoreQuestions() {
            try {
                let data;

                if (USE_EMBEDDED_DATA) {
                    // Use embedded data (no fetch needed)
                    data = EMBEDDED_DATA.core;
                    console.log('Using embedded core questions');
                } else {
                    // Fetch from external file (requires web server)
                    const response = await fetch('../questions/core.json');
                    data = await response.json();
                }

                coreQuestions = data.questions;
                QUESTIONNAIRE_DATA.title = data.title;
                QUESTIONNAIRE_DATA.subtitle = data.subtitle;

                // Update header
                document.getElementById('wizard-title').textContent = QUESTIONNAIRE_DATA.title;
                document.getElementById('wizard-subtitle').textContent = QUESTIONNAIRE_DATA.subtitle;

                // Start with ALL core questions (department questions will be inserted later)
                QUESTIONNAIRE_DATA.questions = [...coreQuestions];

                renderQuestion(0);
                updateProgress();
                updateNavigation();
            } catch (error) {
                console.error('Error loading core questions:', error);
                alert('Error loading questionnaire. Please refresh the page.');
            }
        }

        // Load department-specific questions
        async function loadDepartmentQuestions(department) {
            const departmentMap = {
                "Production": "production",
                "Material Handling": "material-handling",
                "Die Shop": "die-shop",
                "Fabrication & Welding": "fabrication-welding",
                "Assembly": "assembly",
                "Quality Control": "quality-control",
                "Maintenance": "maintenance",
                "Setup Technicians": "setup-technicians",
                "Inventory Specialist": "management",
                "Outside Service Coordinator": "management",
                "IT Department": "it-department",
                "Management": "management",
                "Other": "management"
            };

            const fileName = departmentMap[department] || "management";

            try {
                let data;

                if (USE_EMBEDDED_DATA) {
                    // Use embedded data (no fetch needed)
                    data = EMBEDDED_DATA[fileName];
                    console.log(`Using embedded ${fileName} questions`);

                    if (!data) {
                        throw new Error(`Embedded data for ${fileName} not found`);
                    }
                } else {
                    // Fetch from external file (requires web server)
                    const response = await fetch(`../questions/${fileName}.json`);
                    data = await response.json();
                }

                departmentQuestions = data.questions;

                // Rebuild questions array:
                // 1. First 3 core (Name, Department, Shift)
                // 2. Department-specific questions
                // 3. Remaining core questions (satisfaction, feedback, etc.)
                QUESTIONNAIRE_DATA.questions = [
                    ...coreQuestions.slice(0, 3),
                    ...departmentQuestions,
                    ...coreQuestions.slice(3)
                ];

                departmentSelected = true;

                console.log(`Loaded ${departmentQuestions.length} questions for ${department}`);
                console.log(`Total questions now: ${QUESTIONNAIRE_DATA.questions.length}`);
            } catch (error) {
                console.error('Error loading department questions:', error);
                // Continue with just core questions if department file not found
                QUESTIONNAIRE_DATA.questions = coreQuestions;
            }
        }

        function renderQuestion(index) {
            const container = document.getElementById('questionContainer');
            container.innerHTML = '';

            if (index < 0 || index >= QUESTIONNAIRE_DATA.questions.length) return;

            const q = QUESTIONNAIRE_DATA.questions[index];
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question active';
            questionDiv.id = `question-${index}`;

            let html = `
                <div class="question-header">
                    <span class="question-number">Question ${index + 1} of ${QUESTIONNAIRE_DATA.questions.length}</span>
                    <h2 class="question-title">${q.question}${q.required ? ' <span style="color: #e74c3c;">*</span>' : ''}</h2>
                    ${q.description ? `<p class="question-description">${q.description}</p>` : ''}
                    ${q.required ? '<p style="color: #e74c3c; font-size: 14px; margin-top: 5px;"><em>* Required</em></p>' : ''}
                </div>
            `;

            if (q.whyMatters) {
                html += `<div class="info-box why-matters"><strong>Why This Matters:</strong> ${q.whyMatters}</div>`;
            }

            if (q.example) {
                html += `<div class="info-box example"><strong>Example:</strong> ${q.example}</div>`;
            }

            if (q.note) {
                html += `<div class="info-box note"><strong>Note:</strong> ${q.note}</div>`;
            }

            html += `<div class="question-type-${q.type}">`;

            switch (q.type) {
                case 'radio':
                    html += renderRadio(q, index);
                    break;
                    break;
                case 'checkbox':
                    html += renderCheckbox(q, index);
                    break;
                case 'dropdown':
                    html += renderDropdown(q, index);
                    break;
                case 'text':
                case 'number':
                case 'date':
                    html += renderInput(q, index);
                    break;
                case 'textarea':
                    html += renderTextarea(q, index);
                    break;
                case 'range':
                    html += renderRange(q, index);
                    break;
                case 'rating':
                    html += renderRating(q, index);
                    break;
            }

            html += `</div>`;

            if (q.requiresDecision) {
                html += `
                    <div class="decision-section">
                        <h4>Decision Information</h4>
                        <div class="decision-inputs">
                            <input type="text" placeholder="Decided By (Name/Role)" id="decided-by-${index}" value="${answers[q.id]?.decidedBy || ''}">
                            <input type="date" id="decision-date-${index}" value="${answers[q.id]?.decisionDate || ''}">
                        </div>
                    </div>
                `;
            }

            questionDiv.innerHTML = html;
            container.appendChild(questionDiv);

            restoreAnswer(index);
        }

        function renderRadio(q, index) {
            let html = '';
            q.options.forEach((option, i) => {
                const optionId = `q${index}_option${i}`;
                html += `
                    <label class="option" for="${optionId}" onclick="selectOption(this)">
                        <input type="radio" name="q${index}" id="${optionId}" value="${option.value || option}">
                        <span>${option.label || option}</span>
                    </label>
                `;
            });
            if (q.allowOther) {
                html += `
                    <label class="option" for="q${index}_other" onclick="selectOption(this)">
                        <input type="radio" name="q${index}" id="q${index}_other" value="__other__">
                        <span>Other: <input type="text" id="q${index}_other_text" placeholder="Please specify..." style="margin-left: 10px; padding: 5px;"></span>
                    </label>
                `;
            }
            return html;
        }

        function renderCheckbox(q, index) {
            let html = '';
            q.options.forEach((option, i) => {
                const optionId = `q${index}_option${i}`;
                html += `
                    <label class="option" for="${optionId}" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="${optionId}" value="${option.value || option}">
                        <span>${option.label || option}</span>
                    </label>
                `;
            });
            if (q.allowOther) {
                html += `
                    <label class="option" for="q${index}_other">
                        <input type="checkbox" id="q${index}_other" value="__other__">
                        <span>Other: <input type="text" id="q${index}_other_text" placeholder="Please specify..." style="margin-left: 10px; padding: 5px;"></span>
                    </label>
                `;
            }
            return html;
        }

        function renderDropdown(q, index) {
            let html = `<select id="q${index}_select" onchange="handleDropdownChange(${index}, this.value)">`;
            html += `<option value="">-- Please Select --</option>`;
            q.options.forEach(option => {
                html += `<option value="${option.value || option}">${option.label || option}</option>`;
            });
            html += `</select>`;
            if (q.allowOther) {
                html += `<div id="q${index}_other_container" style="display: none; margin-top: 15px;">
                    <input type="text" id="q${index}_other_text" placeholder="Please specify your department..." 
                           style="width: 100%; padding: 15px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 8px;">
                </div>`;
            }
            return html;
        }

        function handleDropdownChange(index, value) {
            const q = QUESTIONNAIRE_DATA.questions[index];
            if (q.allowOther) {
                const otherContainer = document.getElementById(`q${index}_other_container`);
                if (value === 'Other') {
                    otherContainer.style.display = 'block';
                    document.getElementById(`q${index}_other_text`).focus();
                } else {
                    otherContainer.style.display = 'none';
                }
            }
        }

        function renderInput(q, index) {
            return `<input type="${q.type}" id="q${index}_input" placeholder="${q.placeholder || ''}" ${q.min ? `min="${q.min}"` : ''} ${q.max ? `max="${q.max}"` : ''}>`;
        }

        function renderTextarea(q, index) {
            return `<textarea id="q${index}_textarea" placeholder="${q.placeholder || 'Enter your answer here...'}" rows="${q.rows || 5}"></textarea>`;
        }

        function renderRange(q, index) {
            return `
                <input type="range" id="q${index}_range" min="${q.min || 0}" max="${q.max || 100}" value="${q.default || 50}" oninput="updateRangeValue(${index})">
                <div class="range-labels">
                    <span>${q.minLabel || q.min}</span>
                    <span>${q.maxLabel || q.max}</span>
                </div>
                <div class="range-value" id="q${index}_range_value">${q.default || 50}</div>
            `;
        }

        function renderRating(q, index) {
            let html = `<div class="stars" id="q${index}_stars" onclick="setRating(event, ${index})">`;
            for (let i = 5; i >= 1; i--) {
                html += `<span class="star" data-value="${i}">â˜…</span>`;
            }
            html += `</div>`;
            return html;
        }

        function selectOption(element) {
            const parent = element.parentElement;
            parent.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
        }

        function toggleCheckbox(element) {
            element.classList.toggle('selected');
        }

        function updateRangeValue(index) {
            const range = document.getElementById(`q${index}_range`);
            const display = document.getElementById(`q${index}_range_value`);
            display.textContent = range.value;
        }

        function setRating(event, index) {
            if (event.target.classList.contains('star')) {
                const value = parseInt(event.target.dataset.value);
                const stars = document.getElementById(`q${index}_stars`).querySelectorAll('.star');
                stars.forEach(star => {
                    star.classList.toggle('filled', parseInt(star.dataset.value) <= value);
                });
            }
        }

        function saveAnswer(index) {
            const q = QUESTIONNAIRE_DATA.questions[index];
            const answer = { questionId: q.id, question: q.question };

            switch (q.type) {
                case 'radio':
                    const radioChecked = document.querySelector(`input[name="q${index}"]:checked`);
                    if (radioChecked) {
                        answer.value = radioChecked.value;
                        if (radioChecked.value === '__other__') {
                            answer.otherText = document.getElementById(`q${index}_other_text`).value;
                        }
                    }
                    break;

                case 'checkbox':
                    const checkboxes = document.querySelectorAll(`#question-${index} input[type="checkbox"]:checked`);
                    answer.value = Array.from(checkboxes).map(cb => {
                        if (cb.value === '__other__') {
                            return { value: '__other__', text: document.getElementById(`q${index}_other_text`).value };
                        }
                        return cb.value;
                    });
                    break;

                case 'dropdown':
                    answer.value = document.getElementById(`q${index}_select`).value;
                    if (answer.value === 'Other' && q.allowOther) {
                        answer.otherText = document.getElementById(`q${index}_other_text`).value;
                    }
                    break;

                case 'text':
                case 'number':
                case 'date':
                    answer.value = document.getElementById(`q${index}_input`).value;
                    break;

                case 'textarea':
                    answer.value = document.getElementById(`q${index}_textarea`).value;
                    break;

                case 'range':
                    answer.value = document.getElementById(`q${index}_range`).value;
                    break;

                case 'rating':
                    const filled = document.querySelectorAll(`#q${index}_stars .star.filled`);
                    answer.value = filled.length;
                    break;
            }

            if (q.requiresDecision) {
                answer.decidedBy = document.getElementById(`decided-by-${index}`).value;
                answer.decisionDate = document.getElementById(`decision-date-${index}`).value;
            }

            answers[q.id] = answer;
            localStorage.setItem('mtm_wizard_answers', JSON.stringify(answers));
        }

        function restoreAnswer(index) {
            const q = QUESTIONNAIRE_DATA.questions[index];
            const answer = answers[q.id];
            if (!answer) return;

            setTimeout(() => {
                switch (q.type) {
                    case 'radio':
                        const radio = document.querySelector(`input[name="q${index}"][value="${answer.value}"]`);
                        if (radio) {
                            radio.checked = true;
                            radio.parentElement.classList.add('selected');
                            if (answer.value === '__other__' && answer.otherText) {
                                document.getElementById(`q${index}_other_text`).value = answer.otherText;
                            }
                        }
                        break;

                    case 'checkbox':
                        if (Array.isArray(answer.value)) {
                            answer.value.forEach(val => {
                                if (typeof val === 'object' && val.value === '__other__') {
                                    const checkbox = document.getElementById(`q${index}_other`);
                                    checkbox.checked = true;
                                    checkbox.parentElement.classList.add('selected');
                                    document.getElementById(`q${index}_other_text`).value = val.text;
                                } else {
                                    const checkbox = document.querySelector(`#question-${index} input[type="checkbox"][value="${val}"]`);
                                    if (checkbox) {
                                        checkbox.checked = true;
                                        checkbox.parentElement.classList.add('selected');
                                    }
                                }
                            });
                        }
                        break;

                    case 'dropdown':
                        document.getElementById(`q${index}_select`).value = answer.value;
                        if (answer.value === 'Other' && answer.otherText && q.allowOther) {
                            const otherContainer = document.getElementById(`q${index}_other_container`);
                            otherContainer.style.display = 'block';
                            document.getElementById(`q${index}_other_text`).value = answer.otherText;
                        }
                        break;

                    case 'text':
                    case 'number':
                    case 'date':
                        document.getElementById(`q${index}_input`).value = answer.value;
                        break;

                    case 'textarea':
                        document.getElementById(`q${index}_textarea`).value = answer.value;
                        break;

                    case 'range':
                        document.getElementById(`q${index}_range`).value = answer.value;
                        updateRangeValue(index);
                        break;

                    case 'rating':
                        const stars = document.getElementById(`q${index}_stars`).querySelectorAll('.star');
                        stars.forEach(star => {
                            star.classList.toggle('filled', parseInt(star.dataset.value) <= answer.value);
                        });
                        break;
                }
            }, 100);
        }

        function validateCurrentQuestion() {
            const q = QUESTIONNAIRE_DATA.questions[currentQuestionIndex];

            const index = currentQuestionIndex;
            let hasValue = false;

            switch (q.type) {
                case 'radio':
                    hasValue = document.querySelector(`input[name="q${index}"]:checked`) !== null;
                    break;

                case 'checkbox':
                    hasValue = document.querySelectorAll(`#question-${index} input[type="checkbox"]:checked`).length > 0;
                    break;

                case 'dropdown':
                    const dropdown = document.getElementById(`q${index}_select`);
                    hasValue = dropdown && dropdown.value !== '';
                    if (hasValue && dropdown.value === 'Other' && q.allowOther) {
                        const otherText = document.getElementById(`q${index}_other_text`);
                        hasValue = otherText && otherText.value.trim() !== '';
                    }
                    break;

                case 'text':
                case 'number':
                case 'date':
                    const input = document.getElementById(`q${index}_input`);
                    hasValue = input && input.value.trim() !== '';
                    break;

                case 'textarea':
                    const textarea = document.getElementById(`q${index}_textarea`);
                    hasValue = textarea && textarea.value.trim() !== '';
                    break;

                case 'range':
                    hasValue = true;
                    break;

                case 'rating':
                    hasValue = document.querySelectorAll(`#q${index}_stars .star.filled`).length > 0;
                    break;
            }

            if (!hasValue) {
                alert('This question is required. Please provide an answer before continuing.');
                return false;
            }

            return true;
        }

        async function nextQuestion() {
            if (!validateCurrentQuestion()) return;

            saveAnswer(currentQuestionIndex);

            // Load department questions AFTER shift question
            const q = QUESTIONNAIRE_DATA.questions[currentQuestionIndex];
            if (q.id === 'shift' && !departmentSelected) {
                const departmentAnswer = answers['department'];
                if (departmentAnswer && departmentAnswer.value) {
                    const departmentValue = departmentAnswer.otherText || departmentAnswer.value;
                    await loadDepartmentQuestions(departmentValue);
                    // After loading, questions array has been rebuilt
                    // Continue to next question (which is now a department question)
                }
            }

            // Check length AFTER potential department questions load
            if (currentQuestionIndex < QUESTIONNAIRE_DATA.questions.length - 1) {
                currentQuestionIndex++;
                renderQuestion(currentQuestionIndex);
                updateProgress();
                updateNavigation();
            }
        }

        function previousQuestion() {
            saveAnswer(currentQuestionIndex);
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion(currentQuestionIndex);
                updateProgress();
                updateNavigation();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / QUESTIONNAIRE_DATA.questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Question ${currentQuestionIndex + 1} of ${QUESTIONNAIRE_DATA.questions.length}`;
        }

        function updateNavigation() {
            document.getElementById('btnPrevious').disabled = currentQuestionIndex === 0;

            const isLastQuestion = currentQuestionIndex === QUESTIONNAIRE_DATA.questions.length - 1;
            document.getElementById('btnNext').style.display = isLastQuestion ? 'none' : 'inline-block';
            document.getElementById('btnReview').style.display = isLastQuestion ? 'inline-block' : 'none';
        }

        function showReview() {
            saveAnswer(currentQuestionIndex);
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('reviewContainer').classList.add('active');
            document.getElementById('btnPrevious').style.display = 'none';
            document.getElementById('btnReview').style.display = 'none';
            document.getElementById('btnFinish').style.display = 'inline-block';

            renderReview();
        }

        function renderReview() {
            const reviewContent = document.getElementById('reviewContent');
            let html = '';

            QUESTIONNAIRE_DATA.questions.forEach((q, index) => {
                const answer = answers[q.id];
                if (!answer) return;

                html += `
                    <div class="review-item">
                        <div class="question-label">Q${index + 1}: ${q.question}</div>
                        <div class="answer-value">${formatAnswer(answer, q)}</div>
                        ${answer.decidedBy ? `<div style="margin-top: 10px; font-size: 14px; color: #666;">Decided by: ${answer.decidedBy} on ${answer.decisionDate}</div>` : ''}
                        <button class="edit-btn" onclick="editQuestion(${index})">Edit Answer</button>
                    </div>
                `;
            });

            reviewContent.innerHTML = html;
        }

        function formatAnswer(answer, question) {
            if (!answer.value) return '<em>No answer provided</em>';

            switch (question.type) {
                case 'checkbox':
                    if (Array.isArray(answer.value)) {
                        return answer.value.map(v => {
                            if (typeof v === 'object') return v.text;
                            return v;
                        }).join(', ');
                    }
                    return answer.value;

                case 'radio':
                    return answer.value === '__other__' ? `Other: ${answer.otherText}` : answer.value;

                case 'dropdown':
                    return answer.value === 'Other' && answer.otherText ? `Other: ${answer.otherText}` : answer.value;

                case 'rating':
                    return 'â˜…'.repeat(answer.value) + 'â˜†'.repeat(5 - answer.value);

                default:
                    return answer.value;
            }
        }

        function editQuestion(index) {
            currentQuestionIndex = index;
            document.getElementById('reviewContainer').classList.remove('active');
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('btnPrevious').style.display = 'inline-block';
            document.getElementById('btnFinish').style.display = 'none';
            renderQuestion(index);
            updateProgress();
            updateNavigation();
        }

        function finishQuestionnaire() {
            const exportData = {
                questionnaire: QUESTIONNAIRE_DATA.title,
                submittedAt: new Date().toISOString(),
                answers: answers
            };

            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            const fileName = `MTM_Waitlist_${QUESTIONNAIRE_DATA.title.replace(/[^a-z0-9]/gi, '_')}_${new Date().toISOString().split('T')[0]}.json`;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);

            document.getElementById('reviewContainer').classList.remove('active');
            document.querySelector('.wizard-navigation').style.display = 'none';
            document.getElementById('successMessage').classList.add('active');

            localStorage.removeItem('mtm_wizard_answers');
        }

        // Initialize
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('mtm_wizard_answers');
            if (saved) {
                answers = JSON.parse(saved);
            }

            loadCoreQuestions();
        });
    </script>
</body>

</html>